/*! For license information please see showcase.js.LICENSE.txt */
(()=>{var e,t,n,i,s={87207:(e,t,n)=>{"use strict";e.exports=n.p+"images/chrome.png"},75673:(e,t,n)=>{"use strict";e.exports=n.p+"images/edge.png"},68472:(e,t,n)=>{"use strict";e.exports=n.p+"images/firefox.png"},81826:(e,t,n)=>{"use strict";e.exports=n.p+"images/safari.png"},24877:(e,t,n)=>{"use strict";e.exports=n.p+"images/showcase-password-background.jpg"},90831:(e,t,n)=>{"use strict";e.exports=n.p+"images/matterport-logo-light.svg"},89992:e=>{"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHg9IjAiIHk9IjAiIHZpZXdCb3g9IjAgMCAyMzAuMDUgNDkuNzUiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxzdHlsZT4uc3Qwe2ZpbGw6I2Y1ZjRmM30uc3Qye2ZpbGw6I2ZmZn0uc3Qze2ZpbGw6Izk5OX08L3N0eWxlPjxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik02MS4yOCAzNi4xNHYtOC44MmwtLjI0LTUuMDkuMTktLjA0IDIuMDUgNC41NCA0LjgyIDguODYgNC44Mi04Ljg2IDIuMDYtNC41NC4xOC4wNC0uMjQgNS4wOXY4LjgyaDUuMTRWMTQuNGgtNS44MWwtNi4xMSAxMS43N2gtLjA3TDYxLjk1IDE0LjRoLTUuODF2MjEuNzR6TTIxMi42OSAzMC42M2MwIDMuNiAxLjk0IDUuNSA1LjYxIDUuNWgzLjE3di00LjQ1aC0zLjQ1di05LjQ5aDMuNzR2LTQuMzZoLTQuMTV2LTQuMjFoLTQuOTF2MTcuMDF6TTIxMS4yNiAxNy44M2gtLjg3Yy0zLjAxIDAtNC40NCAyLjAzLTQuODkgMy40M2gtLjE4di0zLjQzSDIwMHYxOC4zMWg1LjMyVjI1LjcyYzAtMS4wOC40MS0xLjg0LjkzLTIuMzMuODktLjg2IDIuNzktMS4xMSA1LjAxLTEuMTF2LTQuNDV6TTE1OC42MyAxNy44M2gtLjg3Yy0zLjAxIDAtNC40NCAyLjAzLTQuODkgMy40M2gtLjE4di0zLjQzaC01LjMydjE4LjMxaDUuMzJWMjUuNzJjMC0xLjA4LjQxLTEuODQuOTMtMi4zMy44OS0uODYgMi43OS0xLjExIDUuMDEtMS4xMXYtNC40NXpNMTI3LjQ4IDI3LjI1YzAtNS45NyAzLjE3LTkuODYgOC44NS05Ljg2IDYuMjYgMCA4Ljc4IDQuNTMgOC43OCA5LjY0djEuNThoLTEyLjEydi4xOGMwIDIuMTIgMS4xNCAzLjYgNC4xNyAzLjYgMi4yMyAwIDMuNDUtMS4wNCA0LjY0LTIuMjdsMi42NiAzLjMxYy0xLjY5IDEuOTQtNC40NiAzLjEzLTcuOTEgMy4xMy01LjguMDEtOS4wNy0zLjI3LTkuMDctOS4zMXptNS41LTIuMDV2LjI5aDYuNjJ2LS4zMmMwLTIuMy0xLjA0LTMuODUtMy4xNy0zLjg1cy0zLjQ1IDEuNTQtMy40NSAzLjg4ek0xODAuMDQgMjcuMjVjMC02LjA4IDMuMzEtOS44NiA4Ljg1LTkuODYgNS41NCAwIDguODUgMy43OCA4Ljg1IDkuODZzLTMuMzEgOS4zMi04Ljg1IDkuMzJjLTUuNTUgMC04Ljg1LTMuMjQtOC44NS05LjMyem0xMi4xNSAxLjM3di0zLjI3YzAtMi4zNy0xLjIyLTMuNzQtMy4zMS0zLjc0cy0zLjMxIDEuMzctMy4zMSAzLjc0djMuMjdjMCAyLjM3IDEuMjIgMy43NCAzLjMxIDMuNzRzMy4zMS0xLjM3IDMuMzEtMy43NHpNMTIyLjQyIDEzLjYyaC00Ljc4djIuMTljMCAxLjMtLjQzIDIuMDEtMS44NyAyLjAxaC0xLjMzdjQuMzZoMi42NnY4LjQ0YzAgMy42IDEuOTQgNS41IDUuNjEgNS41aDMuMTd2LTQuNDVoLTMuNDV2LTkuNDloMy43NHYtNC4zNmgtMy43NHYtNC4yek0xMDkuMTcgMTMuNjJoLTQuNzh2Mi4xOWMwIDEuMy0uNDMgMi4wMS0xLjg3IDIuMDFoLTEuMzN2NC4zNmgyLjY2djguNDRjMCAzLjYgMS45NCA1LjUgNS42MSA1LjVoMy4xN3YtNC40NWgtMy40NXYtOS40OWgzLjc0di00LjM2aC0zLjc0di00LjJ6TTE3MC45IDE3LjM5Yy0yLjQ1IDAtNC41MyAxLjUxLTUuMDcgMy42aC0uMTh2LTMuMTdoLTUuMzJ2MjMuODJoNS4zMnYtOC42N2guMThjLjU0IDIuMDUgMi42MyAzLjYgNS4wNyAzLjYgNC43OCAwIDcuMjctMi45MSA3LjI3LTkuMzItLjAxLTYuNC0yLjQ5LTkuODYtNy4yNy05Ljg2em0xLjcyIDExLjUyYzAgMi4zNy0xLjQ4IDMuMzUtMy40OSAzLjM1LTIuMDEgMC0zLjQ5LTEuMDQtMy40OS0yLjc3di01YzAtMS43MyAxLjQ4LTIuNzcgMy40OS0yLjc3IDIuMDEgMCAzLjQ5IDEuNTUgMy40OSAzLjkydjMuMjd6TTk3LjgzIDM2LjE0Yy0xLjkxIDAtMy4yNy0xLjMtMy42LTMuMzFoLS4yMmMtLjU4IDIuNDUtMi42NiAzLjc0LTUuNTQgMy43NC0zLjc4IDAtNS44Ni0yLjIzLTUuODYtNS41IDAtMy45OSAzLjA5LTUuOSA4LjA5LTUuOWgyLjk5di0uNjFjMC0xLjgzLS45LTIuOTktMy4xMy0yLjk5LTIuMTIgMC0zLjI0IDEuMDgtNC4wNiAyLjIzbC0zLjE3LTIuODFjMS41MS0yLjIzIDMuNjctMy42IDcuNjMtMy42IDUuMzIgMCA4LjA2IDIuNDUgOC4wNiA2LjkxdjcuMzhoMS43NnY0LjQ1aC0yLjk1em0tNC4xMy01Ljcydi0yLjIzaC0yLjU5Yy0yLjA1IDAtMy4xMy43Ni0zLjEzIDIuMTJ2LjU0YzAgMS4zNy45IDIuMDEgMi40OCAyLjAxIDEuNzYgMCAzLjI0LS43MiAzLjI0LTIuNDR6Ii8+PGc+PHBhdGggZD0iTTM5LjA1IDYuOTFMMjYuMjQgMTAuNSAxMy40MiA2LjkxIDguMyA4LjM1djMzLjA2bDUuMTMgMS40NCAxMi44Mi0zLjU5IDEyLjgyIDMuNTkgNS4xMy0xLjQ0VjguMzVsLTUuMTUtMS40NHptLTUuMTIgMjQuNjdsLTcuNjktMi4xNS03LjY5IDIuMTV2LTEzLjRsNy42OSAyLjE1IDcuNjktMi4xNXYxMy40eiIgZmlsbD0iI2I3YmFiYiIvPjxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0yNi4yNCAxMy4zN3Y2Ljk2bC0xMi44Mi0zLjU5djI2LjFMOC4zIDQxLjQxVjguMzV6TTMzLjkzIDM0LjQ1bC03LjY5LTIuMTZ2Ni45NmwxMi44MSAzLjU5di0yNi4xbC01LjEyIDEuNDR6Ii8+PGc+PHBhdGggY2xhc3M9InN0MyIgZD0iTTM5LjA1IDYuOTFsNS4xMyAxLjQ0LTE3Ljk0IDUuMDJMOC4zIDguMzVsNS4xMi0xLjQ0IDEyLjgyIDMuNTl6TTI2LjI0IDI5LjQybDcuNjkgMi4xNnYyLjg3bC03LjY5LTIuMTYtNy42OSAyLjE2di0yLjg3eiIvPjwvZz48L2c+PC9zdmc+"},31896:e=>{"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODQiIGhlaWdodD0iODQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNDIgMEMxOC43OSAwIDAgMTguNzkgMCA0MnMxOC43OSA0MiA0MiA0MiA0Mi0xOC43OSA0Mi00MlM2NS4yMSAwIDQyIDB6IiBmaWxsLW9wYWNpdHk9Ii4yNSIgZmlsbD0iIzAwMCIgZmlsbC1ydWxlPSJub256ZXJvIi8+PHBhdGggZD0iTTUxLjUgNTdoLTJhLjUuNSAwIDAxLS41LS41di0yOGEuNS41IDAgMDEuNS0uNWgyYS41LjUgMCAwMS41LjV2MjhhLjUuNSAwIDAxLS41LjV6TTM0LjUgNTdoLTJhLjUuNSAwIDAxLS41LS41di0yOGEuNS41IDAgMDEuNS0uNWgyYS41LjUgMCAwMS41LjV2MjhhLjUuNSAwIDAxLS41LjV6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg=="},78899:(e,t,n)=>{"use strict";e.exports=n.p+"images/escape.png"},49529:(e,t,n)=>{"use strict";e.exports=n.p+"images/headset-quest-2.png"},57494:(e,t,n)=>{"use strict";e.exports=n.p+"images/MP-logo_H_lock-RGB_color-black.svg"},17111:(e,t,n)=>{"use strict";e.exports=n.p+"images/matterport-app-icon.svg"},31891:(e,t,n)=>{"use strict";e.exports=n.p+"images/Desktop-help-play-button.svg"},71002:(e,t,n)=>{"use strict";e.exports=n.p+"images/Desktop-help-spacebar.png"},14653:(e,t,n)=>{"use strict";e.exports=n.p+"images/mattertag-disc-128-free.v1.png"},94874:(e,t,n)=>{"use strict";e.exports=n.p+"images/mobile-help-play-button.svg"},86533:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_360.png"},70626:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_click_inside.png"},72145:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_gesture_drag.png"},12742:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_gesture_drag_two_finger.png"},5435:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_gesture_pinch.png"},67649:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_gesture_position.png"},2433:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_gesture_position_two_finger.png"},24367:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_gesture_tap.png"},64549:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_inside_key.png"},76064:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_keyboard_all.png"},81202:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_keyboard_left_right.png"},42135:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_keyboard_up_down.png"},41891:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_mouse_click.png"},73993:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_mouse_drag_left.png"},26668:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_mouse_drag_right.png"},82906:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_mouse_position_left.png"},64991:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_mouse_position_right.png"},12136:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_mouse_zoom.png"},90619:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_tap_inside.png"},26407:(e,t,n)=>{"use strict";e.exports=n.p+"images/nav_help_zoom_keys.png"},22016:e=>{"use strict";e.exports=JSON.parse('{"v":"4.8.0","meta":{"g":"LottieFiles AE 1.0.0","a":"","k":"","d":"","tc":""},"fr":60,"ip":0,"op":60,"w":876,"h":744,"nm":"Rating Modal","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"Vector 2","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":0,"s":[0]},{"t":4,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.833,"y":0.833},"o":{"x":0.167,"y":0.167},"t":0,"s":[437.969,578.877,0],"to":[0,-8.167,0],"ti":[0,8.167,0]},{"i":{"x":0.833,"y":0.833},"o":{"x":0.167,"y":0.167},"t":18,"s":[437.969,529.877,0],"to":[0,0,0],"ti":[0,0,0]},{"t":25,"s":[437.969,529.877,0]}],"ix":2},"a":{"a":0,"k":[0,51.205,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.83,0.808,0.833],"y":[1.233,0.833,0.35]},"o":{"x":[0.283,0.284,0],"y":[-0.056,-0.064,0]},"t":0,"s":[176.81,195.773,100]},{"i":{"x":[0.564,0.562,0.794],"y":[3.244,0.849,2.131]},"o":{"x":[0.466,0.473,0.167],"y":[-4.295,-0.161,0.141]},"t":23,"s":[207.791,222.842,100]},{"t":28,"s":[207.791,207.791,100]}],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[2.52,0.008],[0,0],[0,0],[0.001,-0.183],[-8.335,-0.035],[-1.024,7.367],[-0.728,2.537],[0,0],[2.38,0.806],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[2.516,0.006],[0,0],[0,0],[0.432,0.025],[0,0],[2.518,0.008],[0,0],[0,0],[0.409,-0.037],[0,0],[2.516,0.006],[0,0],[0,0],[0.401,-0.185],[0,0]],"o":[[-2.516,-0.006],[0,0],[0,0],[-0.027,8.335],[7.643,0.021],[0.358,-2.606],[0,0],[0,0],[-2.387,-0.816],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[-2.514,-0.01],[0,0],[-0.415,-0.039],[0,0],[0,0],[-2.518,-0.01],[0,0],[-0.423,0.021],[0,0],[0,0],[-2.514,-0.008],[0,0],[-0.44,0.144],[0,0],[0,0]],"v":[[-33.701,-15.143],[-36.223,-12.631],[-36.281,6.241],[-36.285,7.503],[-21.234,22.652],[-6.23,9.641],[-4.465,1.945],[-2.629,-4.438],[-4.202,-7.63],[-7.4,-6.064],[-11.102,2.545],[-12.356,1.279],[-12.356,0.023],[-12.35,-1.377],[-12.3,-18.852],[-14.806,-21.374],[-17.328,-18.866],[-17.38,-2.341],[-18.642,-2.448],[-18.584,-20.126],[-21.092,-22.652],[-23.616,-20.144],[-23.674,-2.463],[-24.928,-2.376],[-24.885,-17.628],[-27.394,-20.155],[-29.917,-17.645],[-29.968,-1.429],[-31.228,-0.933],[-31.189,-12.617]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[-2.52,0.008],[0,0],[0,0],[-0.001,-0.183],[8.335,-0.035],[1.024,7.367],[0.728,2.537],[0,0],[-2.378,0.806],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[-2.516,0.006],[0,0],[0,0],[-0.432,0.025],[0,0],[-2.518,0.008],[0,0],[0,0],[-0.407,-0.037],[0,0],[-2.518,0.006],[0,0],[0,0],[-0.399,-0.185],[0,0]],"o":[[2.516,-0.006],[0,0],[0,0],[0.029,8.335],[-7.645,0.021],[-0.358,-2.606],[0,0],[0,0],[2.389,-0.816],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[2.514,-0.01],[0,0],[0.415,-0.039],[0,0],[0,0],[2.518,-0.01],[0,0],[0.426,0.021],[0,0],[0,0],[2.514,-0.008],[0,0],[0.438,0.144],[0,0],[0,0]],"v":[[33.701,-15.143],[36.223,-12.631],[36.281,6.241],[36.285,7.503],[21.234,22.652],[6.23,9.641],[4.465,1.945],[2.629,-4.438],[4.202,-7.63],[7.4,-6.064],[11.102,2.545],[12.354,1.279],[12.354,0.023],[12.348,-1.377],[12.298,-18.852],[14.804,-21.374],[17.328,-18.866],[17.38,-2.341],[18.642,-2.448],[18.584,-20.126],[21.092,-22.652],[23.618,-20.144],[23.674,-2.463],[24.928,-2.376],[24.882,-17.628],[27.394,-20.155],[29.917,-17.645],[29.968,-1.429],[31.226,-0.933],[31.187,-12.617]],"c":true},"ix":2},"nm":"Path 2","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[0,0],[3.333,-0.333]],"o":[[-1.2,-5.2],[0,0]],"v":[[22.51,8.041],[11.01,2.541]],"c":false},"ix":2},"nm":"Path 3","mn":"ADBE Vector Shape - Group","hd":false},{"ind":3,"ty":"sh","ix":4,"ks":{"a":0,"k":{"i":[[0,0],[-3.333,-0.333]],"o":[[1.2,-5.2],[0,0]],"v":[[-21.99,7.614],[-10.49,2.114]],"c":false},"ix":2},"nm":"Path 4","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"mm","mm":1,"nm":"Merge Paths 1","mn":"ADBE Vector Filter - Merge","hd":false},{"ty":"st","c":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":2,"s":[1,0.192156862745,0.345098039216,1]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":19,"s":[1,0.192156862745,0.345098039216,1]},{"t":26,"s":[0.133333333333,0.133333333333,0.133333333333,1]}],"ix":3},"o":{"a":0,"k":100,"ix":4},"w":{"a":0,"k":2,"ix":5},"lc":1,"lj":1,"ml":4,"bm":0,"nm":"Stroke 1","mn":"ADBE Vector Graphic - Stroke","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Vector","np":6,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"Vector","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":23,"s":[0]},{"t":27,"s":[100]}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[435.195,196.412,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":1,"k":[{"i":{"x":[0.833,0.833,0.833],"y":[0.833,0.833,0.833]},"o":{"x":[0.167,0.167,0.167],"y":[0.167,0.167,0.167]},"t":23,"s":[209.366,209.366,100]},{"i":{"x":[0.833,0.833,0.833],"y":[0.833,0.833,0.833]},"o":{"x":[0.167,0.167,0.167],"y":[0.167,0.167,0.167]},"t":31,"s":[257.214,257.214,100]},{"t":35,"s":[209.366,209.366,100]}],"ix":6}},"ao":0,"hasMask":true,"masksProperties":[{"inv":false,"mode":"a","pt":{"a":1,"k":[{"i":{"x":0.833,"y":0.833},"o":{"x":0.167,"y":0.167},"t":23,"s":[{"i":[[33.137,0],[0,-33.137],[-33.137,0],[0,33.137]],"o":[[-33.137,0],[0,33.137],[33.137,0],[0,-33.137]],"v":[[-0.955,14.988],[-60.955,74.988],[-0.955,134.988],[59.045,74.988]],"c":true}]},{"t":31,"s":[{"i":[[47.354,0],[0,-47.354],[-47.354,0],[0,47.354]],"o":[[-47.354,0],[0,47.354],[47.354,0],[0,-47.354]],"v":[[0.906,-36.975],[-84.837,48.768],[0.906,134.511],[86.648,48.768]],"c":true}]}],"ix":1},"o":{"a":0,"k":100,"ix":3},"x":{"a":0,"k":0,"ix":4},"nm":"Mask 1"}],"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.9,-0.695],[-0.438,0],[-0.403,0.524],[0,0],[0.9,0.695],[0.689,-0.896],[0,0]],"o":[[0.372,0.288],[0.617,0],[0,0],[0.695,-0.898],[-0.898,-0.699],[0,0],[-0.695,0.898]],"v":[[10.071,7.71],[11.325,8.137],[12.953,7.34],[19.076,-0.584],[18.706,-3.468],[15.825,-3.098],[9.701,4.826]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[0,0],[-0.615,0],[-0.376,0.29],[0.693,0.898],[0,0],[0.898,-0.693],[-0.693,-0.898]],"o":[[0.405,0.524],[0.44,0],[0.898,-0.695],[0,0],[-0.697,-0.898],[-0.898,0.695],[0,0]],"v":[[-12.955,7.338],[-11.327,8.137],[-10.069,7.71],[-9.699,4.826],[-15.823,-3.098],[-18.707,-3.468],[-19.079,-0.584]],"c":true},"ix":2},"nm":"Path 2","mn":"ADBE Vector Shape - Group","hd":false},{"ind":2,"ty":"sh","ix":3,"ks":{"a":0,"k":{"i":[[0,0],[-1.135,0],[0,1.135],[0,0],[1.137,0],[0,-1.135]],"o":[[0,1.135],[1.137,0],[0,0],[0,-1.135],[-1.135,0],[0,0]],"v":[[-2.12,2.14],[-0.065,4.196],[1.991,2.14],[1.991,-6.082],[-0.065,-8.137],[-2.12,-6.082]],"c":true},"ix":2},"nm":"Path 3","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"mm","mm":1,"nm":"Merge Paths 1","mn":"ADBE Vector Filter - Merge","hd":false},{"ty":"fl","c":{"a":0,"k":[0.131453797221,0.131453797221,0.131453797221,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Vector","np":5,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":23,"op":253,"st":-47,"bm":0}],"markers":[]}')},10105:e=>{"use strict";e.exports=JSON.parse('{"v":"4.8.0","meta":{"g":"LottieFiles AE 1.0.0","a":"","k":"","d":"","tc":""},"fr":60,"ip":0,"op":120,"w":250,"h":250,"nm":"Comp 1","ddd":0,"assets":[{"id":"comp_0","layers":[{"ddd":0,"ind":1,"ty":3,"nm":"▽ phone","sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[125,106.5,0],"ix":2},"a":{"a":0,"k":[55.5,106.5,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":3,"nm":"▽ Group 2","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[55.5,20.039,0],"ix":2},"a":{"a":0,"k":[10.091,2.506,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":3,"ty":4,"nm":"Vector","parent":2,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[10.091,2.506,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.462,0],[0,0],[0,0.459],[0.462,0],[0,0],[0,-0.459]],"o":[[0,0],[0.462,0],[0,-0.459],[0,0],[-0.462,0],[0,0.459]],"v":[[-2.523,0.835],[2.523,0.835],[3.364,0],[2.523,-0.835],[-2.523,-0.835],[-3.364,0]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Vector","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":3,"nm":"▽ Group 2","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[55.5,192.952,0],"ix":2},"a":{"a":0,"k":[22.705,2.506,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":5,"ty":4,"nm":"Vector","parent":4,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[22.705,2.506,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-0.462,0],[0,0],[0,0.459],[0.462,0],[0,0],[0,-0.459]],"o":[[0,0],[0.462,0],[0,-0.459],[0,0],[-0.462,0],[0,0.459]],"v":[[-6.727,0.835],[6.727,0.835],[7.568,0],[6.727,-0.835],[-6.727,-0.835],[-7.568,0]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Vector","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":6,"ty":3,"nm":"▽ Group","parent":1,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[55.5,106.5,0],"ix":2},"a":{"a":0,"k":[55.5,106.5,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":7,"ty":4,"nm":"Vector","parent":6,"sr":1,"ks":{"o":{"a":0,"k":100,"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":0,"k":[55.5,106.5,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-3.246,0],[0,0],[0,3.224],[0,0],[3.246,0],[0,0],[0,-3.224],[0,0]],"o":[[0,0],[3.246,0],[0,0],[0,-3.224],[0,0],[-3.246,0],[0,0],[0,3.224]],"v":[[-12.614,35.5],[12.614,35.5],[18.5,29.653],[18.5,-29.653],[12.614,-35.5],[-12.614,-35.5],[-18.5,-29.653],[-18.5,29.653]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ind":1,"ty":"sh","ix":2,"ks":{"a":0,"k":{"i":[[0,0],[-2.321,0],[0,0],[0,-2.305],[0,0],[2.321,0],[0,0],[0,2.305]],"o":[[0,-2.305],[0,0],[2.321,0],[0,0],[0,2.305],[0,0],[-2.321,0],[0,0]],"v":[[-16.818,-29.653],[-12.614,-33.829],[12.614,-33.829],[16.818,-29.653],[16.818,29.653],[12.614,33.829],[-12.614,33.829],[-16.818,29.653]],"c":true},"ix":2},"nm":"Path 2","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"mm","mm":1,"nm":"Merge Paths 1","mn":"ADBE Vector Filter - Merge","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Vector","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":300,"st":0,"bm":0}]},{"id":"comp_1","layers":[{"ddd":0,"ind":3,"ty":4,"nm":"Ellipse 19 (Stroke) 2","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":1,"s":[0]},{"t":4,"s":[100]}],"ix":11},"r":{"a":0,"k":270,"ix":10},"p":{"a":0,"k":[40.962,100.923,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-3.155,0.911],[-3.096,-1.097],[-1.899,-2.704],[-0.392,-2.375],[0,0],[0.391,-0.391],[-0.391,-0.391],[0,0],[-0.391,0.391],[0,0],[0.391,0.391],[0.391,-0.391],[0,0],[1.7,2.42],[3.49,1.237],[3.557,-1.027],[2.311,-2.91],[-0.432,-0.344],[-0.344,0.432]],"o":[[3.155,-0.911],[3.097,1.097],[1.392,1.982],[0,0],[-0.391,-0.391],[-0.391,0.391],[0,0],[0.391,0.391],[0,0],[0.391,-0.391],[-0.391,-0.391],[0,0],[-0.368,-2.918],[-2.137,-3.042],[-3.49,-1.237],[-3.557,1.027],[-0.344,0.432],[0.432,0.344],[2.054,-2.586]],"v":[[-9.391,-6.883],[0.218,-6.597],[7.898,-0.754],[10.602,5.87],[6.161,1.429],[4.747,1.429],[4.747,2.843],[11.111,9.207],[12.525,9.207],[18.889,2.843],[18.889,1.429],[17.475,1.429],[12.675,6.228],[9.534,-1.904],[0.886,-8.482],[-9.946,-8.805],[-18.965,-2.753],[-18.804,-1.348],[-17.399,-1.509]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":-15,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 19 (Stroke)","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":300,"st":0,"bm":0},{"ddd":0,"ind":4,"ty":4,"nm":"Ellipse 19 (Stroke)","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":1,"s":[0]},{"t":4,"s":[100]}],"ix":11},"r":{"a":0,"k":90,"ix":10},"p":{"a":0,"k":[213.962,108.423,0],"ix":2},"a":{"a":0,"k":[0,0,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[-3.155,0.911],[-3.096,-1.097],[-1.899,-2.704],[-0.392,-2.375],[0,0],[0.391,-0.391],[-0.391,-0.391],[0,0],[-0.391,0.391],[0,0],[0.391,0.391],[0.391,-0.391],[0,0],[1.7,2.42],[3.49,1.237],[3.557,-1.027],[2.311,-2.91],[-0.432,-0.344],[-0.344,0.432]],"o":[[3.155,-0.911],[3.097,1.097],[1.392,1.982],[0,0],[-0.391,-0.391],[-0.391,0.391],[0,0],[0.391,0.391],[0,0],[0.391,-0.391],[-0.391,-0.391],[0,0],[-0.368,-2.918],[-2.137,-3.042],[-3.49,-1.237],[-3.557,1.027],[-0.344,0.432],[0.432,0.344],[2.054,-2.586]],"v":[[-9.391,-6.883],[0.218,-6.597],[7.898,-0.754],[10.602,5.87],[6.161,1.429],[4.747,1.429],[4.747,2.843],[11.111,9.207],[12.525,9.207],[18.889,2.843],[18.889,1.429],[17.475,1.429],[12.675,6.228],[9.534,-1.904],[0.886,-8.482],[-9.946,-8.805],[-18.965,-2.753],[-18.804,-1.348],[-17.399,-1.509]],"c":true},"ix":2},"nm":"Path 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,1,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"Fill 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[0,0],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[300,300],"ix":3},"r":{"a":0,"k":-15,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"Transform"}],"nm":"Ellipse 19 (Stroke)","np":2,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":300,"st":0,"bm":0}]}],"layers":[{"ddd":0,"ind":1,"ty":0,"nm":"Phone","refId":"comp_0","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":0,"s":[5]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":3,"s":[100]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":74,"s":[100]},{"t":79,"s":[0]}],"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":7,"s":[-90]},{"t":46,"s":[0]}],"ix":10},"p":{"a":0,"k":[127.49999999999999,131,0],"ix":2},"a":{"a":0,"k":[125,106.5,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"w":250,"h":213,"ip":0,"op":80,"st":0,"bm":0},{"ddd":0,"ind":2,"ty":0,"nm":"Rotate","refId":"comp_1","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":3,"s":[5]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":7,"s":[100]},{"i":{"x":[0.833],"y":[0.833]},"o":{"x":[0.167],"y":[0.167]},"t":51,"s":[100]},{"t":57,"s":[0]}],"ix":11},"r":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":7,"s":[-90]},{"t":46,"s":[0]}],"ix":10},"p":{"a":0,"k":[127.49999999999999,131,0],"ix":2},"a":{"a":0,"k":[125,106.5,0],"ix":1},"s":{"a":0,"k":[100,100,100],"ix":6}},"ao":0,"w":250,"h":213,"ip":0,"op":80,"st":0,"bm":0}],"markers":[]}')},63064:e=>{"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQyIiBoZWlnaHQ9IjE0MiIgdmlld0JveD0iMCAwIDE0MiAxNDIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik04MiA4Mi41MDAxQzg1LjMzMzMgODIuMTY2NyA5Mi4zIDgyLjgwMDEgOTMuNSA4OC4wMDAxTTYwLjUgODIuMDczM0M1Ny4xNjY3IDgxLjc0IDUwLjIgODIuMzczMyA0OSA4Ny41NzMzTTM0Ljc2NjggNjcuMzI3NUMzNC43NjY4IDY3LjMyNzUgMzQuNzczIDY0LjgwOTQgMzcuMjg5IDY0LjgxNTZDMzkuODA5MSA2NC44MjM4IDM5LjgwMDkgNjcuMzQxOSAzOS44MDA5IDY3LjM0MTlMMzkuNzYxOCA3OS4wMjU3QzQwLjE2MjcgNzguODQwNyA0MC41ODIgNzguNjc0MiA0MS4wMjE5IDc4LjUzMDNMNDEuMDczMyA2Mi4zMTRDNDEuMDczMyA2Mi4zMTQgNDEuMDgxNSA1OS43OTYgNDMuNTk1NCA1OS44MDQyQzQ2LjExMTQgNTkuODEwMyA0Ni4xMDUzIDYyLjMzMDUgNDYuMTA1MyA2Mi4zMzA1TDQ2LjA2MjEgNzcuNTgyN0M0Ni40NzEyIDc3LjU0NTcgNDYuODkyNSA3Ny41MTY5IDQ3LjMxNiA3Ny40OTYzTDQ3LjM3MzUgNTkuODE0NUM0Ny4zNzM1IDU5LjgxNDUgNDcuMzc5NyA1Ny4yOTY0IDQ5Ljg5NzggNTcuMzA2N0M1Mi40MTU4IDU3LjMxNDkgNTIuNDA1NSA1OS44MzI5IDUyLjQwNTUgNTkuODMyOUw1Mi4zNDggNzcuNTEwN0M1Mi43Nzk3IDc3LjUzNTQgNTMuMTk0OSA3Ny41Nzg2IDUzLjYxMDEgNzcuNjE3Nkw1My42NjE1IDYxLjA5M0M1My42NjE1IDYxLjA5MyA1My42Njk3IDU4LjU3NDkgNTYuMTgzNyA1OC41ODUyQzU4LjY5OTcgNTguNTkxNCA1OC42ODk0IDYxLjEwNzQgNTguNjg5NCA2MS4xMDc0TDU4LjY0IDc4LjU4MTdMNTguNjMzOSA3OS45ODE1VjgxLjIzNzRMNTkuODg3OCA4Mi41MDM3TDYzLjU4OTggNzMuODk1QzYzLjU4OTggNzMuODk1IDY0LjQwMTggNzEuNTEyNiA2Ni43ODgzIDcyLjMyODdDNjkuMTY4NiA3My4xMzQ0IDY4LjM2MDggNzUuNTIxIDY4LjM2MDggNzUuNTIxTDY2LjUyNTIgODEuOTAzNUM2NS43OTc1IDg0LjQ0IDY1LjExNzEgODYuOTkzIDY0Ljc1OTQgODkuNTk5NEM2My43MzU4IDk2Ljk2NjYgNTcuMzk4NSAxMDIuNjMyIDQ5Ljc1NTkgMTAyLjYxMUM0MS40MjA3IDEwMi41NzYgMzQuNjc4NCA5NS43OTY5IDM0LjcwNTIgODcuNDYxN0MzNC43MDYgODcuMjc4NyAzNC43MDkzIDg2LjE5OTYgMzQuNzA5MyA4Ni4xOTk2TDM0Ljc2NjggNjcuMzI3NVpNMTA3LjIxMyA2Ny4zMjc1QzEwNy4yMTMgNjcuMzI3NSAxMDcuMjA3IDY0LjgwOTQgMTA0LjY5MSA2NC44MTU2QzEwMi4xNzEgNjQuODIzOCAxMDIuMTc3IDY3LjM0MTkgMTAyLjE3NyA2Ny4zNDE5TDEwMi4yMTYgNzkuMDI1N0MxMDEuODE3IDc4Ljg0MDcgMTAxLjM5NiA3OC42NzQyIDEwMC45NTggNzguNTMwM0wxMDAuOTA2IDYyLjMxNEMxMDAuOTA2IDYyLjMxNCAxMDAuODk4IDU5Ljc5NiA5OC4zODQyIDU5LjgwNDJDOTUuODY2MSA1OS44MTAzIDk1Ljg3MjMgNjIuMzMwNSA5NS44NzIzIDYyLjMzMDVMOTUuOTE3NSA3Ny41ODI3Qzk1LjUxMDUgNzcuNTQ1NyA5NS4wODkxIDc3LjUxNjkgOTQuNjYzNiA3Ny40OTYzTDk0LjYwODIgNTkuODE0NUM5NC42MDgyIDU5LjgxNDUgOTQuNTk5OSA1Ny4yOTY0IDkyLjA4MTkgNTcuMzA2N0M4OS41NjM4IDU3LjMxNDkgODkuNTc0MSA1OS44MzI5IDg5LjU3NDEgNTkuODMyOUw4OS42MzE2IDc3LjUxMDdDODkuMiA3Ny41MzU0IDg4Ljc4NDggNzcuNTc4NiA4OC4zNjk1IDc3LjYxNzZMODguMzE4MSA2MS4wOTNDODguMzE4MSA2MS4wOTMgODguMzA3OSA1OC41NzQ5IDg1Ljc5MzkgNTguNTg1MkM4My4yNzc5IDU4LjU5MTQgODMuMjg4MiA2MS4xMDc0IDgzLjI4ODIgNjEuMTA3NEw4My4zMzc1IDc4LjU4MTdMODMuMzQzNyA3OS45ODE1VjgxLjIzNzRMODIuMDkxOSA4Mi41MDM3TDc4LjM4OTggNzMuODk1Qzc4LjM4OTggNzMuODk1IDc3LjU3OTkgNzEuNTEyNiA3NS4xOTE0IDcyLjMyODdDNzIuODEzMSA3My4xMzQ0IDczLjYxODkgNzUuNTIxIDczLjYxODkgNzUuNTIxTDc1LjQ1NDUgODEuOTAzNUM3Ni4xODIxIDg0LjQ0IDc2Ljg2MjUgODYuOTkzIDc3LjIyMDIgODkuNTk5NEM3OC4yNDM5IDk2Ljk2NjYgODQuNTc5MSAxMDIuNjMyIDkyLjIyMzcgMTAyLjYxMUMxMDAuNTU5IDEwMi41NzYgMTA3LjMwMyA5NS43OTY5IDEwNy4yNzQgODcuNDYxN0MxMDcuMjc0IDg3LjI3ODcgMTA3LjI3IDg2LjE5OTYgMTA3LjI3IDg2LjE5OTZMMTA3LjIxMyA2Ny4zMjc1WiIgc3Ryb2tlPSIjMjIyMjIyIiBzdHJva2Utd2lkdGg9IjIiLz4KPHBhdGggZD0iTTgyLjM4OTkgNTYuMjc0OEM4MS45NTIxIDU2LjI3NDggODEuNTA4MSA1Ni4xMzUgODEuMTM2IDU1Ljg0NzJDODAuMjM1NyA1NS4xNTI0IDgwLjA3MTMgNTMuODYxNiA4MC43NjYgNTIuOTYzM0w4Ni44ODk1IDQ1LjAzOTFDODcuNTc4MSA0NC4xNDI5IDg4Ljg3MzEgNDMuOTcwMiA4OS43NzE0IDQ0LjY2OTFDOTAuNjcxOCA0NS4zNjM5IDkwLjgzNjIgNDYuNjU0OCA5MC4xNDE0IDQ3LjU1MzFMODQuMDE3OSA1NS40NzcyQzgzLjYxNSA1Ni4wMDE0IDgzLjAwNjYgNTYuMjc0OCA4Mi4zODk5IDU2LjI3NDhaTTU5LjczNzcgNTYuMjc0OEM1OS4xMjMxIDU2LjI3NDggNTguNTE0NyA1NS45OTkzIDU4LjEwOTcgNTUuNDc1Mkw1MS45ODYyIDQ3LjU1MzFDNTEuMjkzNSA0Ni42NTQ4IDUxLjQ2IDQ1LjM2MzkgNTIuMzU4MyA0NC42NjkxQzUzLjI1NjUgNDMuOTc2NCA1NC41NDU0IDQ0LjE0MDggNTUuMjQyMiA0NS4wMzkxTDYxLjM2NTcgNTIuOTYzM0M2Mi4wNTg0IDUzLjg2MTYgNjEuODk0IDU1LjE1MjQgNjAuOTk1NyA1NS44NDcyQzYwLjYxOTUgNTYuMTM3MSA2MC4xNzc2IDU2LjI3NDggNTkuNzM3NyA1Ni4yNzQ4Wk03MS4wMDAxIDUyLjMzMzNDNjkuODY1NCA1Mi4zMzMzIDY4Ljk0NDUgNTEuNDEyNCA2OC45NDQ1IDUwLjI3NzhWNDIuMDU1NkM2OC45NDQ1IDQwLjkyMDkgNjkuODY1NCA0MCA3MS4wMDAxIDQwQzcyLjEzNjggNDAgNzMuMDU1NiA0MC45MjA5IDczLjA1NTYgNDIuMDU1NlY1MC4yNzc4QzczLjA1NTYgNTEuNDEyNCA3Mi4xMzY4IDUyLjMzMzMgNzEuMDAwMSA1Mi4zMzMzWiIgZmlsbD0iIzIyMjIyMiIvPgo8L3N2Zz4K"},34458:e=>{"use strict";e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iMTI3Ljk4MzI1bW0iCiAgIGhlaWdodD0iMTI1Ljg3MDg0bW0iCiAgIHZpZXdCb3g9IjAgMCAxMjcuOTgzMjUgMTI1Ljg3MDg0IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmczOSIKICAgc29kaXBvZGk6ZG9jbmFtZT0icm90YXRlLXBob25lLWZhbGxiYWNrLnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4xLjIgKGI4ZTI1YmU4LCAyMDIyLTAyLTA1KSIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9Im5hbWVkdmlldzQxIgogICAgIHBhZ2Vjb2xvcj0iIzUwNTA1MCIKICAgICBib3JkZXJjb2xvcj0iI2VlZWVlZSIKICAgICBib3JkZXJvcGFjaXR5PSIxIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAiCiAgICAgaW5rc2NhcGU6cGFnZWNoZWNrZXJib2FyZD0iMCIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0ibW0iCiAgICAgc2hvd2dyaWQ9ImZhbHNlIgogICAgIGlua3NjYXBlOnNuYXAtcGFnZT0iZmFsc2UiCiAgICAgaW5rc2NhcGU6em9vbT0iMC4zMTUxMjI4MSIKICAgICBpbmtzY2FwZTpjeD0iMTc5LjI5NTE4IgogICAgIGlua3NjYXBlOmN5PSI4MDcuNjIxNjMiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxODY0IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjEzODciCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjI1IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIGZpdC1tYXJnaW4tdG9wPSIwIgogICAgIGZpdC1tYXJnaW4tbGVmdD0iMCIKICAgICBmaXQtbWFyZ2luLXJpZ2h0PSIwIgogICAgIGZpdC1tYXJnaW4tYm90dG9tPSIwIiAvPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMzNiIgLz4KICA8ZwogICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiCiAgICAgaWQ9ImxheWVyMSIKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC4yOTI2NzM1LC00LjM5MzAzMTgpIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI2NDU4MyIKICAgICAgIGQ9Im0gNzIuODIwNTc2LDEyOC4yOTE4IGMgMTEuNzczNzksLTEuMDg5ODggMjEuODgzMTQsLTIuMDUzIDIyLjQ2NTIyLC0yLjE0MDI4IDIuNzI3MzIsLTAuNDA4OTEgNS41ODUwNTQsLTIuNDkxMTIgNi45MzU4NDQsLTUuMDUzNjIgMS42NTQ0MiwtMy4xMzg1MyAxLjkwMTYxLDAuOTY5MTcgLTMuMzYyNTI0LC01NS44NzY4NCAtMi42MjI4MSwtMjguMzIzMTM0IC00Ljg4OTU0LC01Mi4wODEwODggLTUuMDM3MTYsLTUyLjc5NTQ1MyAtMC40MjQwNiwtMi4wNTIwNjEgLTEuMTc3NjcsLTMuNDgzMTc4IC0yLjY1ODk4LC01LjA0OTQ0MyAtMS44Nzk1OCwtMS45ODczNzMgLTMuNzI1MjUsLTIuODM4OTAyIC02LjQ2MDUxLC0yLjk4MDY1NSAtMi4xODE4MiwtMC4xMTMwNyAtNDQuMzU4MzA4LDMuNjc5NjUyIC00Ni42ODc4ODgsNC4xOTg0MTMgLTMuNjY2OSwwLjgxNjU1NCAtNi42MTY4MSw0LjAxNTg5MyAtNy40Mjk1LDguMDU3NjkyIC0wLjI4NjMsMS40MjM4NzEgMC4xMzMwOSw2LjQwNzcwMiA0LjQ4NDkzLDUzLjI5Njc4NiAyLjc3MDM3LDI5Ljg0OTQ4IDQuOTYzNzUsNTIuMjg1NTUgNS4xODYxNCw1My4wNDg5NiAxLjI2OTk5LDQuMzU5NzEgNS4wMDQzNCw3LjI0MjM3IDkuNDEzMzksNy4yNjY0OSAwLjk1OTI4LDAuMDA1IDExLjM3NzI0OCwtMC44ODIxNyAyMy4xNTEwMzgsLTEuOTcyMDUgeiBtIC0yMy43MDQ1NjgsLTAuOTYwNTMgYyAtMC44MDAzNywtMC4wOTQgLTEuNzY5NCwtMC4yOTU5NSAtMi4xNTM0MiwtMC40NDg3NiAtMS42NjUxMiwtMC42NjI1OCAtMy42ODM1LC0zLjEzNTk2IC00LjAzNDA3LC00Ljk0MzQ4IC0wLjA4NDcsLTAuNDM2NTcgLTIuMzA2NDgsLTI0LjA0NCAtNC45MzczNywtNTIuNDYwOTcgLTQuNjUxMjQsLTUwLjIzOTQwNiAtNC43NzIwNCwtNTEuNzA2MzkzIC00LjM3MTI4LC01My4wODQ5NTcgMC41MzgyMSwtMS44NTEzOTUgMi4zMTU1MywtMy44NTE5NDQgNC4xMDY2NywtNC42MjI0NzIgMS4xNTI0MiwtMC40OTU3NTggNC4xNTk3MSwtMC44MzE3MSAyMi45NjAzODgsLTIuNTY0OTY5IDExLjkzMzE4LC0xLjEwMDEzNCAyMi41MzM0MiwtMS45NTc4ODIgMjMuNjM5NDMsLTEuOTEyODUgMS42ODU5NSwwLjA2ODY0IDIuMjEyNDIsMC4yMDkyMjIgMy4zMDcyOSwwLjg4MzEgMS40MjIzMSwwLjg3NTQxNiAyLjg2MzMsMi43NzY4NDQgMy4yNzEwNyw0LjMxNjI4NSAwLjM0Mzk4LDEuMjk4NTg5IDkuNTQwNDY0LDEwMS4yODQzMDMgOS41NDA0NjQsMTAzLjcyNTUwMyAwLDMuMjUwMzcgLTEuMzQxODg0LDUuMzM3MDggLTQuMjYyOTk0LDYuNjI5MjIgLTAuOTk3MjksMC40NDExNSAtNC42OTc5NiwwLjg1MTA3IC0yMi43Mzk2LDIuNTE4ODYgLTExLjg1MTY1LDEuMDk1NTggLTIxLjg0NjEwOCwyLjAyNDQ3IC0yMi4yMDk5MDgsMi4wNjQxOSAtMC4zNjM4MSwwLjAzOTcgLTEuMzE2MzEsLTAuMDA1IC0yLjExNjY3LC0wLjA5ODcgeiBtIDIzLjU0NzkxOCwtOS4xMDY2OSBjIDUuNzQ4MDcsLTAuNTE1OTQgMTAuNzE1NjUsLTEuMDQ4MDcgMTEuMDM5MDUsLTEuMTgyNTEgMC44NzI2MywtMC4zNjI3MyAxLjA2OTAxLC0xLjUwMTExIDAuMzc4MTQsLTIuMTkxOTkgbCAtMC41NTg1LC0wLjU1ODUgLTExLjkxMzY3LDEuMTAzNTIgYyAtNi41NTI1MiwwLjYwNjk0IC0xMi4xNTA4OCwxLjIzMDQ3IC0xMi40NDA4LDEuMzg1NjQgLTAuMzI5ODYsMC4xNzY1MyAtMC41MjU2MiwwLjU1MDkzIC0wLjUyMzA5LDEuMDAwNDEgMC4wMDcsMS4zMjg2NSAwLjU2NDk5LDEuNjgwNDMgMi4zNzcyLDEuNTAwMDQgMC42NTQ4NCwtMC4wNjUyIDUuODkzNTksLTAuNTQwNjYgMTEuNjQxNjcsLTEuMDU2NjEgeiBtIC04Ljc0ODQ5LC05OS4xOTMyMjIgYyAyLjg0NjU2LC0wLjI4NDQ4NyAzLjYyMzk1LC0wLjQ1MDA0NSAzLjkwMjYsLTAuODMxMTI3IDAuNDkzMywtMC42NzQ2MzIgMC40MzE5OCwtMS4yNzUwMzMgLTAuMTg3NSwtMS44MzU2NSAtMC41MDQxMywtMC40NTYyMzIgLTAuNzcxMjMsLTAuNDY1NTY5IC00LjU2NDA2LC0wLjE1OTU0NyAtMi4yMTU3MywwLjE3ODc3NCAtNC40MjIzMiwwLjM5MjkwNyAtNC45MDM1NCwwLjQ3NTg1NCAtMS41OTkzOCwwLjI3NTY3NyAtMi4xMzE1MiwyLjE5MjgxMyAtMC43NTU0MywyLjcyMTYxOCAwLjMxNDYyLDAuMTIwOSAxLjEwNzgyLDAuMTY2NzggMS43NjI2NywwLjEwMTk2IDAuNjU0ODQsLTAuMDY0OCAyLjc5MDIxLC0wLjI3NzcxOCA0Ljc0NTI2LC0wLjQ3MzEwOCB6IE0gMjcuMzI1NjQ4LDEwMC4yMjI2OSBjIDAuNTYyNDUsLTAuODU4NDEgMC4yNDY0LC0xLjkzNzk1IC0wLjcwMjcyLC0yLjQwMDMzIEMgMjYuMjYxMDQ4LDk3LjY0NjA3IDI0LjU5NTc0OCw5Ni44NDc2IDIyLjkyMjI1OCw5Ni4wNDggMTUuMDI1NDQ4LDkyLjI3NDg0IDkuODgwOTc4Miw4NS41NTcyOCA4LjIwMjc2ODIsNzYuODI3NTcgYyAtMC41MDMwOSwtMi42MTY5NyAtMC40ODYzMSwtNy44ODYwMiAwLjAzMzEsLTEwLjQwMDczIDEuMzM1MTUsLTYuNDYzODUgNC45Njk3ODk4LC0xMi4zMzI3ODUgOS45ODc4Mzk4LC0xNi4xMjc1NjUgMy42OTUyNiwtMi43OTQ0NSAzLjYwNDczLC0yLjg3NDE1IDEuNjIzNzgsMS40Mjk1MSAtMi43OTc4Nyw2LjA3ODQ4IC0zLjA2MDU4LDYuNzg0MDcgLTIuNzQ1MjUsNy4zNzMyNiAwLjU3MDI4LDEuMDY1NTg1IDIuMDA4NTMsMS4zODAzMzUgMi43MTMyMSwwLjU5Mzc1NSAwLjU1MTg1LC0wLjYxNTk4NSA3LjA3NTU0LC0xNC44MzcwMTUgNy4wNzU1NCwtMTUuNDI0MDA1IDAsLTAuMjUyMTggLTAuMjA4MzYsLTAuNzAxNzIgLTAuNDYzMDIsLTAuOTk4OTggLTAuNDc1OTcsLTAuNTU1NTY5IC0xNC43MjQ2MywtNy4xOTEwNjkgLTE1LjQ0MTY2LC03LjE5MTA2OSAtMS4yMDEwNTk4LDAgLTIuMDU4NTg5OCwyLjE2NTQzIC0xLjE1NDYyOTgsMi45MTU2NSAwLjIyMTc0OTgsMC4xODQwNCAyLjc5MTUwOTgsMS40MzQ4MiA1LjcxMDU3OTgsMi43Nzk1MSA0LjE3Mzk0LDEuOTIyNzQ5IDUuMjMyMDUsMi41MTAxNzkgNC45NTQ2MiwyLjc1MDYxOSAtMC4xOTQwMiwwLjE2ODE2IC0xLjI1OTUzLDAuODkyODUgLTIuMzY3OCwxLjYxMDQyIC02LjczOTI0LDQuMzYzNDMgLTExLjY0NTcxOTgsMTEuNjUyMjggLTEzLjM2NDg0OTgsMTkuODU0MjU1IC0wLjU3MjkxLDIuNzMzMzggLTAuNjM0OTUsOC4yNTQwNCAtMC4xMjQ3NCwxMS4wOTk5NSAxLjY3Mjg0LDkuMzMwODEgNy43NzI3ODk4LDE3LjYwMDM5IDE2LjEwNTE4OTgsMjEuODMzNDcgNC4yMjAzNywyLjE0NDA1IDUuODE5NDcsMi40NTkyMiA2LjU4MDk1LDEuMjk3MDcgeiBtIDk5LjMxMzI4MiwtNC42MDk3MSBjIDAuNzIwMTIsLTAuNzIwMTEgMC42NjkwNywtMS43NTIwOSAtMC4xMjE2OCwtMi40NjAwMiAtMC4zNTc5NiwtMC4zMjA0OCAtMi44NTgyNywtMS41ODUzMiAtNS41NTYyNSwtMi44MTA3OCAtMi42OTc5NywtMS4yMjU0NSAtNC45MDU0MSwtMi4zMTgzMiAtNC45MDU0MSwtMi40Mjg2IDAsLTAuMTEwMjcgMC45MjI3NCwtMC43NzI0OCAyLjA1MDUzLC0xLjQ3MTU2IDIuNDEyNTQsLTEuNDk1NDYgNy4zOTk2NiwtNi4zMzg2MiA4LjkxMjg3LC04LjY1NTU3IDIuMzI0NTIsLTMuNTU5MiAzLjkxNDQ2LC03LjQxNjc4IDQuODExNzUsLTExLjY3NDUxIDAuNTM4NTcsLTIuNTU1NTUgMC42MDAwMiwtNy45MjM5NTUgMC4xMjExNCwtMTAuNTgzMzI1IC0xLjgwNDAyLC0xMC4wMTgzOSAtNy44NDI5NSwtMTguMDk4ODk5IC0xNi44OTM3NiwtMjIuNjA1MDY5IC0zLjY0Mzg4LC0xLjgxNDIgLTUuMTYwNzcsLTIuMDE5NzEgLTUuODQ3MzksLTAuNzkyMjIgLTAuNzMxNCwxLjMwNzU2IC0wLjI4MDQ4LDEuOTA2OTQgMi4yNzQ2NSwzLjAyMzU1IDYuMTI1NzQsMi42NzY5OCAxMC4wMDMzNCw1LjkwNDc1IDEzLjIxMTM5LDEwLjk5NzMzOSAyLjYwOTc2LDQuMTQyODQgMy43OTcyMyw4LjEyNDU1IDMuOTg3NjYsMTMuMzcxMDcgMC4xOTUxMiw1LjM3NTY2NSAtMC41NzcyLDguODY3NDE1IC0zLjAxNjE2LDEzLjYzNjM4NSAtMS4yMTkzNCwyLjM4NDIxIC00LjYzOTU0LDYuNzQ0OTkgLTYuMjU4OSw3Ljk4MDEzIC0wLjUwOTcsMC4zODg3NiAtMS4wODU4NSwwLjg1NzY4IC0xLjI4MDM1LDEuMDQyMDQgLTAuNjc2NjksMC42NDE0MiAtMi42NTIxMSwxLjgyODE1IC0yLjc5ODg2LDEuNjgxNDEgLTAuMDgxMiwtMC4wODEyIDAuODgxOTEsLTIuMzY2NDcgMi4xNDAzNCwtNS4wNzgyOSAyLjA5Nzg3LC00LjUyMDc1IDIuMjYwNTYsLTQuOTg3OTMgMS45NTczMSwtNS42MjA2NCAtMC40ODk2MywtMS4wMjE1OSAtMS42MTA5MSwtMS4zMzQ1NyAtMi40NjI5OSwtMC42ODc0OSAtMC43NjM0NSwwLjU3OTc4IC03LjI1OTIzLDE0LjUwNDE1IC03LjI1OTIzLDE1LjU2MDkxIDAsMC4zMzc3NCAwLjIyNjIxLDAuODE4NzggMC41MDI2OSwxLjA2ODk4IDAuNzA2NzMsMC42Mzk1OSAxNC41ODE5OCw3LjAwNDc1IDE1LjMwNjE3LDcuMDIxNTkgMC4zMjc0MiwwLjAwOCAwLjgzMzQ0LC0wLjIyNDI4IDEuMTI0NDgsLTAuNTE1MzMgeiIKICAgICAgIGlkPSJwYXRoMTA5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJzc3Nzc3Nzc3NzY2NzY3Nzc3Nzc3Nzc3Nzc3Njc3NzY3NzY3Nzc3Nzc3Nzc3Nzc2NzY3Nzc3Nzc3Nzc3Nzc2Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3NzY3MiIC8+CiAgPC9nPgo8L3N2Zz4K"},91975:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAJ1BMVEUAAAD///////////////////////////////////////////////+uPUo5AAAADHRSTlMA4ZNBI+fLwLSGYE5aqgIgAAAAlUlEQVQoz2MAAy91mYNFSxjgwEjmDBAcVIbxPWPOgMHRKRA+c88ZKDhhABbYdgYOssEKchACx0BKPM4ggRagwBxkgZNAHTHIAkcNGJjOoAAFBkdUARGGNagCpxh0UAUOMdSgChxnkEEVOMhwBg1gCGBowTAUw1oMh2E4HcNzGN5HDyCMIMQIZPRowIgozKjEjGyM5AAACSg5ooJJElsAAAAASUVORK5CYII="},40886:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAD/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/AVL/////+fr/5er/0tv/ytX/iaH/dJL/cpA84uD/AAAAC3RSTlMA45NBI8vAtIZgTrS8MGcAAAC5SURBVDjLhVPtDoQgDBuICPKpvP+7Xs4t6LlL2j9GWtYCG91w0XqTkvE2OtJYrEkTxi4v2gWhpyS4n+1bUtgeRfY1/cG6z/3Ma8Ui/rP+6LWU2sd04RxBfs+WBe2UpXAZSP4jP3DIWb4m9ua1whI5w/XzC+xiHEWWtreg8XoUh5EVhnj469u1oF+EJ45QtaByCGKrogWFGSiAFjAkPCa8KHjV6LHgc6OGgS2Hmha2PR4cPHp4eOH4fwAGdiPh+RS0GAAAAABJRU5ErkJggg=="},71370:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAIBAMAAABqq+CcAAAAD1BMVEUAAAD///////////////+PQt5oAAAABHRSTlMAy4AzqjrmZgAAABRJREFUCNdjAAMjERcXR2Uwc4AEAIn2CZHn9cAcAAAAAElFTkSuQmCC"},88296:e=>{"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAIBAMAAABqq+CcAAAAGFBMVEUAAAD/AVL/AVL/AVL/////AVL/r7//OWiicYg+AAAABHRSTlMAy4AzqjrmZgAAABlJREFUCNdjYGBgVgwtcwGC9FAhAyB3YAQAVg4X6a0jaXAAAAAASUVORK5CYII="},92759:(e,t,n)=>{"use strict";e.exports=n.p+"images/login-screen-background.jpg"},64366:(e,t,n)=>{"use strict";e.exports=n.p+"images/tagbg.png"},78947:(e,t,n)=>{"use strict";e.exports=n.p+"images/tagmask.png"},28636:(e,t,n)=>{"use strict";e.exports=n.p+"images/NoteColor.png"},27314:(e,t,n)=>{"use strict";e.exports=n.p+"images/NoteIcon.png"},48072:(e,t,n)=>{"use strict";e.exports=n.p+"images/360_placement_pin_mask.png"},68444:(e,t,n)=>{"use strict";e.exports=n.p+"images/exterior.png"},85089:(e,t,n)=>{"use strict";e.exports=n.p+"images/exterior_hover.png"},45545:(e,t,n)=>{"use strict";e.exports=n.p+"images/interior.png"},64293:(e,t,n)=>{"use strict";e.exports=n.p+"images/interior_hover.png"},35367:()=>{},29474:(e,t,n)=>{"use strict";n.d(t,{fe:()=>ut,cA:()=>O,h4:()=>tt,createHttpLink:()=>p,Ps:()=>dn});var i=n(23564),s=n(5419),r=n(81707),o=n(80496),a=n(84913),l=Object.prototype.hasOwnProperty;var c=function(e,t){var n;try{n=JSON.stringify(e)}catch(e){var i=new s.ej(23);throw i.parseError=e,i}return n},d=n(90778),u={http:{includeQuery:!0,includeExtensions:!1},headers:{accept:"*/*","content-type":"application/json"},options:{method:"POST"}},h=n(80285);var p=function(e){void 0===e&&(e={});var t=e.uri,n=void 0===t?"/graphql":t,p=e.fetch,m=e.includeExtensions,f=e.useGETForQueries,g=e.includeUnusedVariables,v=void 0!==g&&g,y=(0,i._T)(e,["uri","fetch","includeExtensions","useGETForQueries","includeUnusedVariables"]);!function(e){if(!e&&"undefined"==typeof fetch)throw new s.ej(22)}(p),p||(p=fetch);var b={http:{includeExtensions:m},options:y.fetchOptions,credentials:y.credentials,headers:y.headers};return new r.i0((function(e){var t=function(e,t){return e.getContext().uri||("function"==typeof t?t(e):t||"/graphql")}(e,n),s=e.getContext(),r={};if(s.clientAwareness){var m=s.clientAwareness,g=m.name,y=m.version;g&&(r["apollographql-client-name"]=g),y&&(r["apollographql-client-version"]=y)}var S,E=(0,i.pi)((0,i.pi)({},r),s.headers),T={http:s.http,options:s.fetchOptions,credentials:s.credentials,headers:E},w=function(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var r=(0,i.pi)((0,i.pi)({},t.options),{headers:t.headers,credentials:t.credentials}),o=t.http||{};n.forEach((function(e){r=(0,i.pi)((0,i.pi)((0,i.pi)({},r),e.options),{headers:(0,i.pi)((0,i.pi)({},r.headers),e.headers)}),e.credentials&&(r.credentials=e.credentials),o=(0,i.pi)((0,i.pi)({},o),e.http)}));var a=e.operationName,l=e.extensions,c=e.variables,u=e.query,h={operationName:a,variables:c};return o.includeExtensions&&(h.extensions=l),o.includeQuery&&(h.query=(0,d.S)(u)),{options:r,body:h}}(e,u,b,T),x=w.options,_=w.body;if(_.variables&&!v){var M=new Set(Object.keys(_.variables));(0,h.Vn)(e.query,{Variable:function(e,t,n){n&&"VariableDefinition"!==n.kind&&M.delete(e.name.value)}}),M.size&&(_.variables=(0,i.pi)({},_.variables),M.forEach((function(e){delete _.variables[e]})))}if(!x.signal){var O=function(){if("undefined"==typeof AbortController)return{controller:!1,signal:!1};var e=new AbortController;return{controller:e,signal:e.signal}}(),A=O.controller,C=O.signal;(S=A)&&(x.signal=C)}if(f&&!e.query.definitions.some((function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation}))&&(x.method="GET"),"GET"===x.method){var N=function(e,t){var n=[],i=function(e,t){n.push(e+"="+encodeURIComponent(t))};if("query"in t&&i("query",t.query),t.operationName&&i("operationName",t.operationName),t.variables){var s=void 0;try{s=c(t.variables)}catch(e){return{parseError:e}}i("variables",s)}if(t.extensions){var r=void 0;try{r=c(t.extensions)}catch(e){return{parseError:e}}i("extensions",r)}var o="",a=e,l=e.indexOf("#");-1!==l&&(o=e.substr(l),a=e.substr(0,l));var d=-1===a.indexOf("?")?"?":"&";return{newURI:a+d+n.join("&")+o}}(t,_),D=N.newURI,I=N.parseError;if(I)return(0,a.Qc)(I);t=D}else try{x.body=c(_)}catch(I){return(0,a.Qc)(I)}return new o.y$((function(n){var i;return p(t,x).then((function(t){return e.setContext({response:t}),t})).then((i=e,function(e){return e.text().then((function(t){try{return JSON.parse(t)}catch(i){var n=i;throw n.name="ServerParseError",n.response=e,n.statusCode=e.status,n.bodyText=t,n}})).then((function(t){return e.status>=300&&(0,a.PW)(e,t,"Response not successful: Received status code "+e.status),Array.isArray(t)||l.call(t,"data")||l.call(t,"errors")||(0,a.PW)(e,t,"Server response was missing for query '"+(Array.isArray(i)?i.map((function(e){return e.operationName})):i.operationName)+"'."),t}))})).then((function(e){return n.next(e),n.complete(),e})).catch((function(e){"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&n.next(e.result),n.error(e))})),function(){S&&S.abort()}}))}))},m=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,p(t).request)||this;return n.options=t,n}return(0,i.ZT)(t,e),t}(r.i0),f=Object.prototype,g=f.toString,v=f.hasOwnProperty,y=Function.prototype.toString,b=new Map;function S(e,t){try{return E(e,t)}finally{b.clear()}}function E(e,t){if(e===t)return!0;var n,i,s,r=g.call(e);if(r!==g.call(t))return!1;switch(r){case"[object Array]":if(e.length!==t.length)return!1;case"[object Object]":if(_(e,t))return!0;var o=T(e),a=T(t),l=o.length;if(l!==a.length)return!1;for(var c=0;c<l;++c)if(!v.call(t,o[c]))return!1;for(c=0;c<l;++c){var d=o[c];if(!E(e[d],t[d]))return!1}return!0;case"[object Error]":return e.name===t.name&&e.message===t.message;case"[object Number]":if(e!=e)return t!=t;case"[object Boolean]":case"[object Date]":return+e==+t;case"[object RegExp]":case"[object String]":return e==""+t;case"[object Map]":case"[object Set]":if(e.size!==t.size)return!1;if(_(e,t))return!0;for(var u=e.entries(),h="[object Map]"===r;;){var p=u.next();if(p.done)break;var m=p.value,f=m[0],b=m[1];if(!t.has(f))return!1;if(h&&!E(b,t.get(f)))return!1}return!0;case"[object Function]":var S=y.call(e);return S===y.call(t)&&(i=x,!((s=(n=S).length-i.length)>=0&&n.indexOf(i,s)===s))}return!1}function T(e){return Object.keys(e).filter(w,e)}function w(e){return void 0!==this[e]}var x="{ [native code] }";function _(e,t){var n=b.get(e);if(n){if(n.has(t))return!0}else b.set(e,n=new Set);return n.add(t),!1}var M,O=function(e){function t(n){var i,s,r=n.graphQLErrors,a=n.networkError,l=n.errorMessage,c=n.extraInfo,d=e.call(this,l)||this;return d.graphQLErrors=r||[],d.networkError=a||null,d.message=l||(i=d,s="",(0,o.Of)(i.graphQLErrors)&&i.graphQLErrors.forEach((function(e){var t=e?e.message:"Error message not found.";s+=t+"\n"})),i.networkError&&(s+=i.networkError.message+"\n"),s=s.replace(/\n$/,"")),d.extraInfo=c,d.__proto__=t.prototype,d}return(0,i.ZT)(t,e),t}(Error);function A(e){return!!e&&e<7}!function(e){e[e.loading=1]="loading",e[e.setVariables=2]="setVariables",e[e.fetchMore=3]="fetchMore",e[e.refetch=4]="refetch",e[e.poll=6]="poll",e[e.ready=7]="ready",e[e.error=8]="error"}(M||(M={}));var C=function(){function e(e,t,n,i){this.observer=e,this.options=t,this.fetch=n,this.shouldFetch=i}return e.prototype.reobserve=function(e,t){e?this.updateOptions(e):this.updatePolling();var n=this.fetch(this.options,t);return this.concast&&this.concast.removeObserver(this.observer,!0),n.addObserver(this.observer),(this.concast=n).promise},e.prototype.updateOptions=function(e){return Object.assign(this.options,(0,o.oA)(e)),this.updatePolling(),this},e.prototype.stop=function(){this.concast&&(this.concast.removeObserver(this.observer),delete this.concast),this.pollingInfo&&(clearTimeout(this.pollingInfo.timeout),this.options.pollInterval=0,this.updatePolling())},e.prototype.updatePolling=function(){var e=this,t=this.pollingInfo,n=this.options.pollInterval;if(n){if((!t||t.interval!==n)&&((0,s.kG)(n,20),!1!==this.shouldFetch)){(t||(this.pollingInfo={})).interval=n;var i=function(){e.pollingInfo&&(e.shouldFetch&&e.shouldFetch()?e.reobserve({fetchPolicy:"network-only",nextFetchPolicy:e.options.fetchPolicy||"cache-first"},M.poll).then(r,r):r())},r=function(){var t=e.pollingInfo;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(i,t.interval))};r()}}else t&&(clearTimeout(t.timeout),delete this.pollingInfo)},e}(),N=function(e){function t(t){var n=t.queryManager,s=t.queryInfo,r=t.options,a=e.call(this,(function(e){return a.onSubscribe(e)}))||this;a.observers=new Set,a.subscriptions=new Set,a.observer={next:function(e){(a.lastError||a.isDifferentFromLastResult(e))&&(a.updateLastResult(e),(0,o.pM)(a.observers,"next",e))},error:function(e){a.updateLastResult((0,i.pi)((0,i.pi)({},a.lastResult),{error:e,errors:e.graphQLErrors,networkStatus:M.error,loading:!1})),(0,o.pM)(a.observers,"error",a.lastError=e)}},a.isTornDown=!1,a.options=r,a.queryId=n.generateQueryId();var l=(0,o.$H)(r.query);return a.queryName=l&&l.name&&l.name.value,a.queryManager=n,a.queryInfo=s,a}return(0,i.ZT)(t,e),Object.defineProperty(t.prototype,"variables",{get:function(){return this.options.variables},enumerable:!1,configurable:!0}),t.prototype.result=function(){var e=this;return new Promise((function(t,n){var i={next:function(n){t(n),e.observers.delete(i),e.observers.size||e.queryManager.removeQuery(e.queryId),setTimeout((function(){s.unsubscribe()}),0)},error:n},s=e.subscribe(i)}))},t.prototype.getCurrentResult=function(e){void 0===e&&(e=!0);var t=this.lastResult,n=this.queryInfo.networkStatus||t&&t.networkStatus||M.ready,s=(0,i.pi)((0,i.pi)({},t),{loading:A(n),networkStatus:n});if(this.isTornDown)return s;var r=this.options.fetchPolicy,o=void 0===r?"cache-first":r;if("no-cache"===o||"network-only"===o)delete s.partial;else if(!s.data||!this.queryManager.transform(this.options.query).hasForcedResolvers){var a=this.queryInfo.getDiff();s.data=a.complete||this.options.returnPartialData?a.result:void 0,a.complete?(s.networkStatus!==M.loading||"cache-first"!==o&&"cache-only"!==o||(s.networkStatus=M.ready,s.loading=!1),delete s.partial):s.partial=!0}return e&&this.updateLastResult(s),s},t.prototype.isDifferentFromLastResult=function(e){return!S(this.lastResultSnapshot,e)},t.prototype.getLastResult=function(){return this.lastResult},t.prototype.getLastError=function(){return this.lastError},t.prototype.resetLastResults=function(){delete this.lastResult,delete this.lastResultSnapshot,delete this.lastError,this.isTornDown=!1},t.prototype.resetQueryStoreErrors=function(){this.queryManager.resetErrors(this.queryId)},t.prototype.refetch=function(e){var t={pollInterval:0},n=this.options.fetchPolicy;return"no-cache"!==n&&"cache-and-network"!==n&&(t.fetchPolicy="network-only",t.nextFetchPolicy=n||"cache-first"),e&&!S(this.options.variables,e)&&(t.variables=this.options.variables=(0,i.pi)((0,i.pi)({},this.options.variables),e)),this.newReobserver(!1).reobserve(t,M.refetch)},t.prototype.fetchMore=function(e){var t=this,n=(0,i.pi)((0,i.pi)({},e.query?e:(0,i.pi)((0,i.pi)((0,i.pi)({},this.options),e),{variables:(0,i.pi)((0,i.pi)({},this.options.variables),e.variables)})),{fetchPolicy:"no-cache"}),s=this.queryManager.generateQueryId();return n.notifyOnNetworkStatusChange&&(this.queryInfo.networkStatus=M.fetchMore,this.observe()),this.queryManager.fetchQuery(s,n,M.fetchMore).then((function(i){var s=i.data,r=e.updateQuery;return r?t.updateQuery((function(e){return r(e,{fetchMoreResult:s,variables:n.variables})})):t.queryManager.cache.writeQuery({query:n.query,variables:n.variables,data:s}),i})).finally((function(){t.queryManager.stopQuery(s),t.reobserve()}))},t.prototype.subscribeToMore=function(e){var t=this,n=this.queryManager.startGraphQLSubscription({query:e.document,variables:e.variables,context:e.context}).subscribe({next:function(n){var i=e.updateQuery;i&&t.updateQuery((function(e,t){var s=t.variables;return i(e,{subscriptionData:n,variables:s})}))},error:function(t){e.onError&&e.onError(t)}});return this.subscriptions.add(n),function(){t.subscriptions.delete(n)&&n.unsubscribe()}},t.prototype.setOptions=function(e){return this.reobserve(e)},t.prototype.setVariables=function(e){if(S(this.variables,e))return this.observers.size?this.result():Promise.resolve();if(this.options.variables=e,!this.observers.size)return Promise.resolve();var t=this.options.fetchPolicy,n=void 0===t?"cache-first":t,i={fetchPolicy:n,variables:e};return"cache-first"!==n&&"no-cache"!==n&&"network-only"!==n&&(i.fetchPolicy="cache-and-network",i.nextFetchPolicy=n),this.reobserve(i,M.setVariables)},t.prototype.updateQuery=function(e){var t,n=this.queryManager,i=e(n.cache.diff({query:this.options.query,variables:this.variables,previousResult:null===(t=this.lastResult)||void 0===t?void 0:t.data,returnPartialData:!0,optimistic:!1}).result,{variables:this.variables});i&&(n.cache.writeQuery({query:this.options.query,data:i,variables:this.variables}),n.broadcastQueries())},t.prototype.startPolling=function(e){this.getReobserver().updateOptions({pollInterval:e})},t.prototype.stopPolling=function(){this.reobserver&&this.reobserver.updateOptions({pollInterval:0})},t.prototype.updateLastResult=function(e){var t=this.lastResult;return this.lastResult=e,this.lastResultSnapshot=this.queryManager.assumeImmutableResults?e:(0,o.Xh)(e),(0,o.Of)(e.errors)||delete this.lastError,t},t.prototype.onSubscribe=function(e){var t=this;if(e===this.observer)return function(){};try{var n=e._subscription._observer;n&&!n.error&&(n.error=D)}catch(e){}var i=!this.observers.size;return this.observers.add(e),this.lastError?e.error&&e.error(this.lastError):this.lastResult&&e.next&&e.next(this.lastResult),i&&this.reobserve().catch((function(e){})),function(){t.observers.delete(e)&&!t.observers.size&&t.tearDownQuery()}},t.prototype.getReobserver=function(){return this.reobserver||(this.reobserver=this.newReobserver(!0))},t.prototype.newReobserver=function(e){var t=this,n=this.queryManager,s=this.queryId;return n.setObservableQuery(this),new C(this.observer,e?this.options:(0,i.pi)({},this.options),(function(e,i){return n.setObservableQuery(t),n.fetchQueryObservable(s,e,i)}),!n.ssrMode&&function(){return!A(t.queryInfo.networkStatus)})},t.prototype.reobserve=function(e,t){return this.isTornDown=!1,this.getReobserver().reobserve(e,t)},t.prototype.observe=function(){this.observer.next(this.getCurrentResult(!1))},t.prototype.hasObservers=function(){return this.observers.size>0},t.prototype.tearDownQuery=function(){this.isTornDown||(this.reobserver&&(this.reobserver.stop(),delete this.reobserver),this.subscriptions.forEach((function(e){return e.unsubscribe()})),this.subscriptions.clear(),this.queryManager.stopQuery(this.queryId),this.observers.clear(),this.isTornDown=!0)},t}(o.y$);function D(e){}(0,o.Dy)(N);var I=n(27636),L=function(){return Object.create(null)},P=Array.prototype,R=P.forEach,k=P.slice,U=function(){function e(e,t){void 0===e&&(e=!0),void 0===t&&(t=L),this.weakness=e,this.makeData=t}return e.prototype.lookup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.lookupArray(e)},e.prototype.lookupArray=function(e){var t=this;return R.call(e,(function(e){return t=t.getChildTrie(e)})),t.data||(t.data=this.makeData(k.call(e)))},e.prototype.getChildTrie=function(t){var n=this.weakness&&function(e){switch(typeof e){case"object":if(null===e)break;case"function":return!0}return!1}(t)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map),i=n.get(t);return i||n.set(t,i=new e(this.weakness,this.makeData)),i},e}();var B=null,F={},V=1,H="@wry/context:Slot",j=Array,G=j[H]||function(){var e=function(){function e(){this.id=["slot",V++,Date.now(),Math.random().toString(36).slice(2)].join(":")}return e.prototype.hasValue=function(){for(var e=B;e;e=e.parent)if(this.id in e.slots){var t=e.slots[this.id];if(t===F)break;return e!==B&&(B.slots[this.id]=t),!0}return B&&(B.slots[this.id]=F),!1},e.prototype.getValue=function(){if(this.hasValue())return B.slots[this.id]},e.prototype.withValue=function(e,t,n,i){var s,r=((s={__proto__:null})[this.id]=e,s),o=B;B={parent:o,slots:r};try{return t.apply(i,n)}finally{B=o}},e.bind=function(e){var t=B;return function(){var n=B;try{return B=t,e.apply(this,arguments)}finally{B=n}}},e.noContext=function(e,t,n){if(!B)return e.apply(n,t);var i=B;try{return B=null,e.apply(n,t)}finally{B=i}},e}();try{Object.defineProperty(j,H,{value:j[H]=e,enumerable:!1,writable:!1,configurable:!1})}finally{return e}}();G.bind,G.noContext;function z(){}var W=function(){function e(e,t){void 0===e&&(e=1/0),void 0===t&&(t=z),this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.get=function(e){var t=this.getEntry(e);return t&&t.value},e.prototype.getEntry=function(e){var t=this.map.get(e);if(t&&t!==this.newest){var n=t.older,i=t.newer;i&&(i.older=n),n&&(n.newer=i),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=i)}return t},e.prototype.set=function(e,t){var n=this.getEntry(e);return n?n.value=t:(n={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=n),this.newest=n,this.oldest=this.oldest||n,this.map.set(e,n),n.value)},e.prototype.clean=function(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)},e.prototype.delete=function(e){var t=this.map.get(e);return!!t&&(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0)},e}(),K=new G;function Y(e){var t=e.unsubscribe;"function"==typeof t&&(e.unsubscribe=void 0,t())}var q=[];function Z(e,t){if(!e)throw new Error(t||"assertion failure")}function $(e){switch(e.length){case 0:throw new Error("unknown value");case 1:return e[0];case 2:throw e[1]}}var Q=function(){function e(t){this.fn=t,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=[],this.deps=null,++e.count}return e.prototype.peek=function(){if(1===this.value.length&&!J(this))return this.value[0]},e.prototype.recompute=function(e){return Z(!this.recomputing,"already recomputing"),function(e){var t=K.getValue();if(t)e.parents.add(t),t.childValues.has(e)||t.childValues.set(e,[]),J(e)?ne(t,e):ie(t,e)}(this),J(this)?function(e,t){re(e),K.withValue(e,X,[e,t]),function(e,t){if("function"==typeof e.subscribe)try{Y(e),e.unsubscribe=e.subscribe.apply(null,t)}catch(t){return e.setDirty(),!1}return!0}(e,t)&&function(e){if(e.dirty=!1,J(e))return;te(e)}(e);return $(e.value)}(this,e):$(this.value)},e.prototype.setDirty=function(){this.dirty||(this.dirty=!0,this.value.length=0,ee(this),re(this),Y(this))},e.prototype.dispose=function(){var e=this;re(this),Y(this),this.parents.forEach((function(t){t.setDirty(),oe(t,e)}))},e.prototype.dependOn=function(e){e.add(this),this.deps||(this.deps=q.pop()||new Set),this.deps.add(e)},e.prototype.forgetDeps=function(){var e=this;this.deps&&(this.deps.forEach((function(t){return t.delete(e)})),this.deps.clear(),q.push(this.deps),this.deps=null)},e.count=0,e}();function X(e,t){e.recomputing=!0,e.value.length=0;try{e.value[0]=e.fn.apply(null,t)}catch(t){e.value[1]=t}e.recomputing=!1}function J(e){return e.dirty||!(!e.dirtyChildren||!e.dirtyChildren.size)}function ee(e){e.parents.forEach((function(t){return ne(t,e)}))}function te(e){e.parents.forEach((function(t){return ie(t,e)}))}function ne(e,t){if(Z(e.childValues.has(t)),Z(J(t)),e.dirtyChildren){if(e.dirtyChildren.has(t))return}else e.dirtyChildren=q.pop()||new Set;e.dirtyChildren.add(t),ee(e)}function ie(e,t){Z(e.childValues.has(t)),Z(!J(t));var n,i,s,r=e.childValues.get(t);0===r.length?e.childValues.set(t,t.value.slice(0)):(n=r,i=t.value,(s=n.length)>0&&s===i.length&&n[s-1]===i[s-1]||e.setDirty()),se(e,t),J(e)||te(e)}function se(e,t){var n=e.dirtyChildren;n&&(n.delete(t),0===n.size&&(q.length<100&&q.push(n),e.dirtyChildren=null))}function re(e){e.childValues.size>0&&e.childValues.forEach((function(t,n){oe(e,n)})),e.forgetDeps(),Z(null===e.dirtyChildren)}function oe(e,t){t.parents.delete(e),e.childValues.delete(t),se(e,t)}function ae(e){var t=new Map,n=e&&e.subscribe;function i(e){var i=K.getValue();if(i){var s=t.get(e);s||t.set(e,s=new Set),i.dependOn(s),"function"==typeof n&&(Y(s),s.unsubscribe=n(e))}}return i.dirty=function(e){var n=t.get(e);n&&(n.forEach((function(e){return e.setDirty()})),t.delete(e),Y(n))},i}var le=new U("function"==typeof WeakMap);function ce(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return le.lookupArray(e)}var de=new Set;function ue(e,t){void 0===t&&(t=Object.create(null));var n=new W(t.max||Math.pow(2,16),(function(e){return e.dispose()})),i=t.keyArgs||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},s=t.makeCacheKey||ce;function r(){var r=s.apply(null,i.apply(null,arguments));if(void 0===r)return e.apply(null,arguments);var o=n.get(r);o||(n.set(r,o=new Q(e)),o.subscribe=t.subscribe);var a=o.recompute(Array.prototype.slice.call(arguments));return n.set(r,o),de.add(n),K.hasValue()||(de.forEach((function(e){return e.clean()})),de.clear()),a}function o(){var e=s.apply(null,arguments);if(void 0!==e)return n.get(e)}return r.dirty=function(){var e=o.apply(null,arguments);e&&e.setDirty()},r.peek=function(){var e=o.apply(null,arguments);if(e)return e.peek()},r.forget=function(){var e=s.apply(null,arguments);return void 0!==e&&n.delete(e)},r}var he,pe=function(){function e(){this.getFragmentDoc=ue(o.Yk)}return e.prototype.recordOptimisticTransaction=function(e,t){this.performTransaction(e,t)},e.prototype.transformDocument=function(e){return e},e.prototype.identify=function(e){},e.prototype.gc=function(){return[]},e.prototype.modify=function(e){return!1},e.prototype.transformForLink=function(e){return e},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!!e.optimistic),this.read({rootId:e.id||"ROOT_QUERY",query:e.query,variables:e.variables,returnPartialData:e.returnPartialData,optimistic:t})},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!!e.optimistic),this.read({query:this.getFragmentDoc(e.fragment,e.fragmentName),variables:e.variables,rootId:e.id,returnPartialData:e.returnPartialData,optimistic:t})},e.prototype.writeQuery=function(e){return this.write({dataId:e.id||"ROOT_QUERY",result:e.data,query:e.query,variables:e.variables,broadcast:e.broadcast})},e.prototype.writeFragment=function(e){return this.write({dataId:e.id,result:e.data,variables:e.variables,query:this.getFragmentDoc(e.fragment,e.fragmentName),broadcast:e.broadcast})},e}();he||(he={});var me=function(e,t,n,i,s){this.message=e,this.path=t,this.query=n,this.clientOnly=i,this.variables=s},fe=Object.prototype.hasOwnProperty;var ge=/^[_a-z][_0-9a-z]*/i;function ve(e){var t=e.match(ge);return t?t[0]:e}function ye(e,t,n){return!(!t||"object"!=typeof t)&&(Array.isArray(t)?t.every((function(t){return ye(e,t,n)})):e.selections.every((function(e){if((0,o.My)(e)&&(0,o.LZ)(e,n)){var i=(0,o.u2)(e);return fe.call(t,i)&&(!e.selectionSet||ye(e.selectionSet,t[i],n))}return!0})))}function be(e){return null!==e&&"object"==typeof e&&!(0,o.hh)(e)&&!Array.isArray(e)}var Se=Object.create(null),Ee=function(){return Se},Te=Object.create(null),we=function(){function e(e,t){var n=this;this.policies=e,this.group=t,this.data=Object.create(null),this.rootIds=Object.create(null),this.refs=Object.create(null),this.getFieldValue=function(e,t){return(0,o.Jv)((0,o.hh)(e)?n.get(e.__ref,t):e&&e[t])},this.canRead=function(e){return(0,o.hh)(e)?n.has(e.__ref):"object"==typeof e},this.toReference=function(e,t){if("string"==typeof e)return(0,o.kQ)(e);if((0,o.hh)(e))return e;var i=n.policies.identify(e)[0];if(i){var s=(0,o.kQ)(i);return t&&n.merge(i,e),s}}}return e.prototype.toObject=function(){return(0,i.pi)({},this.data)},e.prototype.has=function(e){return void 0!==this.lookup(e,!0)},e.prototype.get=function(e,t){if(this.group.depend(e,t),fe.call(this.data,e)){var n=this.data[e];if(n&&fe.call(n,t))return n[t]}return"__typename"===t&&fe.call(this.policies.rootTypenamesById,e)?this.policies.rootTypenamesById[e]:this instanceof Me?this.parent.get(e,t):void 0},e.prototype.lookup=function(e,t){return t&&this.group.depend(e,"__exists"),fe.call(this.data,e)?this.data[e]:this instanceof Me?this.parent.lookup(e,t):this.policies.rootTypenamesById[e]?Object.create(null):void 0},e.prototype.merge=function(e,t){var n=this,i=this.lookup(e),s=new o.w0(Oe).merge(i,t);if(this.data[e]=s,s!==i&&(delete this.refs[e],this.group.caching)){var r=Object.create(null);i||(r.__exists=1),Object.keys(t).forEach((function(e){if(!i||i[e]!==s[e]){r[e]=1;var t=ve(e);t===e||n.policies.hasKeyArgs(s.__typename,t)||(r[t]=1),void 0!==s[e]||n instanceof Me||delete s[e]}})),Object.keys(r).forEach((function(t){return n.group.dirty(e,t)}))}},e.prototype.modify=function(e,t){var n=this,s=this.lookup(e);if(s){var r=Object.create(null),a=!1,l=!0,c={DELETE:Se,INVALIDATE:Te,isReference:o.hh,toReference:this.toReference,canRead:this.canRead,readField:function(t,i){return n.policies.readField("string"==typeof t?{fieldName:t,from:i||(0,o.kQ)(e)}:t,{store:n})}};if(Object.keys(s).forEach((function(d){var u=ve(d),h=s[d];if(void 0!==h){var p="function"==typeof t?t:t[d]||t[u];if(p){var m=p===Ee?Se:p((0,o.Jv)(h),(0,i.pi)((0,i.pi)({},c),{fieldName:u,storeFieldName:d,storage:n.getStorage(e,d)}));m===Te?n.group.dirty(e,d):(m===Se&&(m=void 0),m!==h&&(r[d]=m,a=!0,h=m))}void 0!==h&&(l=!1)}})),a)return this.merge(e,r),l&&(this instanceof Me?this.data[e]=void 0:delete this.data[e],this.group.dirty(e,"__exists")),!0}return!1},e.prototype.delete=function(e,t,n){var i,s=this.lookup(e);if(s){var r=this.getFieldValue(s,"__typename"),o=t&&n?this.policies.getStoreFieldName({typename:r,fieldName:t,args:n}):t;return this.modify(e,o?((i={})[o]=Ee,i):Ee)}return!1},e.prototype.evict=function(e){var t=!1;return e.id&&(fe.call(this.data,e.id)&&(t=this.delete(e.id,e.fieldName,e.args)),this instanceof Me&&(t=this.parent.evict(e)||t),(e.fieldName||t)&&this.group.dirty(e.id,e.fieldName||"__exists")),t},e.prototype.clear=function(){this.replace(null)},e.prototype.extract=function(){var e=this,t=this.toObject(),n=[];return this.getRootIdSet().forEach((function(t){fe.call(e.policies.rootTypenamesById,t)||n.push(t)})),n.length&&(t.__META={extraRootIds:n.sort()}),t},e.prototype.replace=function(e){var t=this;if(Object.keys(this.data).forEach((function(n){e&&fe.call(e,n)||t.delete(n)})),e){var n=e.__META,s=(0,i._T)(e,["__META"]);Object.keys(s).forEach((function(e){t.merge(e,s[e])})),n&&n.extraRootIds.forEach(this.retain,this)}},e.prototype.retain=function(e){return this.rootIds[e]=(this.rootIds[e]||0)+1},e.prototype.release=function(e){if(this.rootIds[e]>0){var t=--this.rootIds[e];return t||delete this.rootIds[e],t}return 0},e.prototype.getRootIdSet=function(e){return void 0===e&&(e=new Set),Object.keys(this.rootIds).forEach(e.add,e),this instanceof Me?this.parent.getRootIdSet(e):Object.keys(this.policies.rootTypenamesById).forEach(e.add,e),e},e.prototype.gc=function(){var e=this,t=this.getRootIdSet(),n=this.toObject();t.forEach((function(i){fe.call(n,i)&&(Object.keys(e.findChildRefIds(i)).forEach(t.add,t),delete n[i])}));var i=Object.keys(n);if(i.length){for(var s=this;s instanceof Me;)s=s.parent;i.forEach((function(e){return s.delete(e)}))}return i},e.prototype.findChildRefIds=function(e){if(!fe.call(this.refs,e)){var t=this.refs[e]=Object.create(null),n=new Set([this.data[e]]),i=function(e){return null!==e&&"object"==typeof e};n.forEach((function(e){(0,o.hh)(e)?t[e.__ref]=!0:i(e)&&Object.values(e).filter(i).forEach(n.add,n)}))}return this.refs[e]},e.prototype.makeCacheKey=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.group.keyMaker.lookupArray(e)},e}(),xe=function(){function e(e){this.caching=e,this.d=null,this.keyMaker=new U(o.mr),this.d=e?ae():null}return e.prototype.depend=function(e,t){if(this.d){this.d(_e(e,t));var n=ve(t);n!==t&&this.d(_e(e,n))}},e.prototype.dirty=function(e,t){this.d&&this.d.dirty(_e(e,t))},e}();function _e(e,t){return t+"#"+e}!function(e){var t=function(e){function t(t){var n=t.policies,i=t.resultCaching,s=void 0===i||i,r=t.seed,a=e.call(this,n,new xe(s))||this;return a.storageTrie=new U(o.mr),a.sharedLayerGroup=new xe(s),r&&a.replace(r),a}return(0,i.ZT)(t,e),t.prototype.addLayer=function(e,t){return new Me(e,this,t,this.sharedLayerGroup)},t.prototype.removeLayer=function(){return this},t.prototype.getStorage=function(){return this.storageTrie.lookupArray(arguments)},t}(e);e.Root=t}(we||(we={}));var Me=function(e){function t(t,n,i,s){var r=e.call(this,n.policies,s)||this;return r.id=t,r.parent=n,r.replay=i,r.group=s,i(r),r}return(0,i.ZT)(t,e),t.prototype.addLayer=function(e,n){return new t(e,this,n,this.group)},t.prototype.removeLayer=function(e){var t=this,n=this.parent.removeLayer(e);return e===this.id?(this.group.caching&&Object.keys(this.data).forEach((function(e){t.data[e]!==n.lookup(e)&&t.delete(e)})),n):n===this.parent?this:n.addLayer(this.id,this.replay)},t.prototype.toObject=function(){return(0,i.pi)((0,i.pi)({},this.parent.toObject()),this.data)},t.prototype.findChildRefIds=function(t){var n=this.parent.findChildRefIds(t);return fe.call(this.data,t)?(0,i.pi)((0,i.pi)({},n),e.prototype.findChildRefIds.call(this,t)):n},t.prototype.getStorage=function(){for(var e=this.parent;e.parent;)e=e.parent;return e.getStorage.apply(e,arguments)},t}(we);function Oe(e,t,n){var i=e[n],s=t[n];return S(i,s)?i:s}function Ae(e){return!!(e instanceof we&&e.group.caching)}function Ce(e,t){return new me(e.message,t.path.slice(),t.query,t.clientOnly,t.variables)}var Ne=function(){function e(e){var t=this;this.config=e,this.executeSelectionSet=ue((function(e){return t.execSelectionSetImpl(e)}),{keyArgs:function(e){return[e.selectionSet,e.objectOrReference,e.context]},makeCacheKey:function(e,t,n){if(Ae(n.store))return n.store.makeCacheKey(e,(0,o.hh)(t)?t.__ref:t,n.varString)}}),this.knownResults=new WeakMap,this.executeSubSelectedArray=ue((function(e){return t.execSubSelectedArrayImpl(e)}),{makeCacheKey:function(e){var t=e.field,n=e.array,i=e.context;if(Ae(i.store))return i.store.makeCacheKey(t,n,i.varString)}}),this.config=(0,i.pi)({addTypename:!0},e)}return e.prototype.diffQueryAgainstStore=function(e){var t=e.store,n=e.query,s=e.rootId,r=void 0===s?"ROOT_QUERY":s,a=e.variables,l=e.returnPartialData,c=void 0===l||l,d=this.config.cache.policies;a=(0,i.pi)((0,i.pi)({},(0,o.O4)((0,o.iW)(n))),a);var u=this.executeSelectionSet({selectionSet:(0,o.p$)(n).selectionSet,objectOrReference:(0,o.kQ)(r),context:{store:t,query:n,policies:d,variables:a,varString:JSON.stringify(a),fragmentMap:(0,o.F)((0,o.kU)(n)),path:[],clientOnly:!1}}),h=u.missing&&u.missing.length>0;if(h&&!c)throw u.missing[0];return{result:u.result,missing:u.missing,complete:!h}},e.prototype.isFresh=function(e,t,n,i){if(Ae(i.store)&&this.knownResults.get(e)===n){var s=this.executeSelectionSet.peek(n,t,i);if(s&&e===s.result)return!0}return!1},e.prototype.execSelectionSetImpl=function(e){var t=this,n=e.selectionSet,i=e.objectOrReference,r=e.context;if((0,o.hh)(i)&&!r.policies.rootTypenamesById[i.__ref]&&!r.store.has(i.__ref))return{result:{},missing:[Ce(new s.ej(4),r)]};var a=r.variables,l=r.policies,c=r.store,d=[],u={result:null},h=c.getFieldValue(i,"__typename");function p(){return u.missing||(u.missing=[])}function m(e){var t;return e.missing&&(t=p()).push.apply(t,e.missing),e.result}this.config.addTypename&&"string"==typeof h&&!l.rootIdsByTypename[h]&&d.push({__typename:h});var f=new Set(n.selections);return f.forEach((function(e){var n;if((0,o.LZ)(e,a))if((0,o.My)(e)){var c=l.readField({fieldName:e.name.value,field:e,variables:r.variables,from:i},r),u=(0,o.u2)(e);r.path.push(u);var g=r.clientOnly;r.clientOnly=g||!(!e.directives||!e.directives.some((function(e){return"client"===e.name.value}))),void 0===c?o.Gw.added(e)||p().push(Ce(new s.ej(5),r)):Array.isArray(c)?c=m(t.executeSubSelectedArray({field:e,array:c,context:r})):e.selectionSet&&null!=c&&(c=m(t.executeSelectionSet({selectionSet:e.selectionSet,objectOrReference:c,context:r}))),void 0!==c&&d.push(((n={})[u]=c,n)),r.clientOnly=g,(0,s.kG)(r.path.pop()===u)}else{var v=(0,o.hi)(e,r.fragmentMap);v&&l.fragmentMatches(v,h)&&v.selectionSet.selections.forEach(f.add,f)}})),u.result=(0,o.bw)(d),this.knownResults.set(u.result,n),u},e.prototype.execSubSelectedArrayImpl=function(e){var t,n=this,i=e.field,r=e.array,o=e.context;function a(e,n){return e.missing&&(t=t||[]).push.apply(t,e.missing),(0,s.kG)(o.path.pop()===n),e.result}return i.selectionSet&&(r=r.filter(o.store.canRead)),{result:r=r.map((function(e,t){return null===e?null:(o.path.push(t),Array.isArray(e)?a(n.executeSubSelectedArray({field:i,array:e,context:o}),t):i.selectionSet?a(n.executeSelectionSet({selectionSet:i.selectionSet,objectOrReference:e,context:o}),t):((0,s.kG)(o.path.pop()===t),e))})),missing:t}},e}();var De=function(){function e(e,t){this.cache=e,this.reader=t}return e.prototype.writeToStore=function(e){var t=e.query,n=e.result,r=e.dataId,a=e.store,l=e.variables,c=(0,o.$H)(t),d=new o.w0;l=(0,i.pi)((0,i.pi)({},(0,o.O4)(c)),l);var u=this.processSelectionSet({result:n||Object.create(null),dataId:r,selectionSet:c.selectionSet,mergeTree:{map:new Map},context:{store:a,written:Object.create(null),merge:function(e,t){return d.merge(e,t)},variables:l,varString:JSON.stringify(l),fragmentMap:(0,o.F)((0,o.kU)(t))}});if(!(0,o.hh)(u))throw new s.ej(7);return a.retain(u.__ref),u},e.prototype.processSelectionSet=function(e){var t=this,n=e.dataId,i=e.result,r=e.selectionSet,a=e.context,l=e.mergeTree,c=this.cache.policies,d=c.identify(i,r,a.fragmentMap),u=d[0],h=d[1];if("string"==typeof(n=n||u)){var p=a.written[n]||(a.written[n]=[]),m=(0,o.kQ)(n);if(p.indexOf(r)>=0)return m;if(p.push(r),this.reader&&this.reader.isFresh(i,m,r,a))return m}var f=Object.create(null);h&&(f=a.merge(f,h));var g=n&&c.rootTypenamesById[n]||(0,o.qw)(i,r,a.fragmentMap)||n&&a.store.get(n,"__typename");"string"==typeof g&&(f.__typename=g);var v=new Set(r.selections);if(v.forEach((function(e){var n;if((0,o.LZ)(e,a.variables))if((0,o.My)(e)){var r=(0,o.u2)(e),d=i[r];if(void 0!==d){var u=c.getStoreFieldName({typename:g,fieldName:e.name.value,field:e,variables:a.variables}),h=Le(l,u),p=t.processFieldValue(d,e,a,h),m=e.selectionSet&&a.store.getFieldValue(p,"__typename")||void 0,y=c.getMergeFunction(g,e.name.value,m);y?h.info={field:e,typename:g,merge:y}:Pe(l,u),f=a.merge(f,((n={})[u]=p,n))}else if(c.usingPossibleTypes&&!(0,o.FS)(["defer","client"],e))throw new s.ej(8)}else{var b=(0,o.hi)(e,a.fragmentMap);b&&c.fragmentMatches(b,g,i,a.variables)&&b.selectionSet.selections.forEach(v.add,v)}})),"string"==typeof n){var y=(0,o.kQ)(n);return l.map.size&&(f=this.applyMerges(l,y,f,a)),a.store.merge(n,f),y}return f},e.prototype.processFieldValue=function(e,t,n,i){var s=this;return t.selectionSet&&null!==e?Array.isArray(e)?e.map((function(e,r){var o=s.processFieldValue(e,t,n,Le(i,r));return Pe(i,r),o})):this.processSelectionSet({result:e,selectionSet:t.selectionSet,context:n,mergeTree:i}):e},e.prototype.applyMerges=function(e,t,n,r,a){var l,c=this;if(e.map.size&&!(0,o.hh)(n)){var d,u=Array.isArray(n)||!(0,o.hh)(t)&&!be(t)?void 0:t,h=n;u&&!a&&(a=[(0,o.hh)(u)?u.__ref:u]);var p=function(e,t){return Array.isArray(e)?"number"==typeof t?e[t]:void 0:r.store.getFieldValue(e,String(t))};e.map.forEach((function(e,t){a&&a.push(t);var n=p(u,t),i=p(h,t),o=c.applyMerges(e,n,i,r,a);o!==i&&(d=d||new Map).set(t,o),a&&(0,s.kG)(a.pop()===t)})),d&&(n=Array.isArray(h)?h.slice(0):(0,i.pi)({},h),d.forEach((function(e,t){n[t]=e})))}return e.info?this.cache.policies.runMergeFunction(t,n,e.info,r,a&&(l=r.store).getStorage.apply(l,a)):n},e}(),Ie=[];function Le(e,t){var n=e.map;return n.has(t)||n.set(t,Ie.pop()||{map:new Map}),n.get(t)}function Pe(e,t){var n=e.map,i=n.get(t);!i||i.info||i.map.size||(Ie.push(i),n.delete(t))}new Set;var Re=new G;function ke(e,t){if(e.size){var n=[];e.forEach((function(e){return n.push(e)})),e.clear(),n.forEach(t)}}var Ue=new WeakMap;function Be(e){var t=Ue.get(e);return t||Ue.set(e,t={vars:new Set,dep:ae()}),t}function Fe(e){var t=new Set,n=new Set,i=function(r){if(arguments.length>0)e!==r&&(e=r,t.forEach((function(e){Be(e).dep.dirty(i),Ve(e)})),ke(n,(function(t){return t(e)})));else{var o=Re.getValue();o&&(s(o),Be(o).dep(i))}return e};i.onNextChange=function(e){return n.add(e),function(){n.delete(e)}};var s=i.attachCache=function(e){return t.add(e),Be(e).vars.add(i),i};return i.forgetCache=function(e){return t.delete(e)},i}function Ve(e){e.broadcastWatches&&e.broadcastWatches()}function He(e){return void 0!==e.args?e.args:e.field?(0,o.NC)(e.field,e.variables):null}var je=function(e,t){var n=e.__typename,i=e.id,s=e._id;if("string"==typeof n&&(t&&(t.keyObject=void 0!==i?{id:i}:void 0!==s?{_id:s}:void 0),void 0===i&&(i=s),void 0!==i))return n+":"+("number"==typeof i||"string"==typeof i?i:JSON.stringify(i))},Ge=function(){},ze=function(e,t){return t.fieldName},We=function(e,t,n){return(0,n.mergeObjects)(e,t)},Ke=function(e,t){return t},Ye=function(){function e(e){this.config=e,this.typePolicies=Object.create(null),this.toBeAdded=Object.create(null),this.supertypeMap=new Map,this.fuzzySubtypes=new Map,this.rootIdsByTypename=Object.create(null),this.rootTypenamesById=Object.create(null),this.usingPossibleTypes=!1,this.config=(0,i.pi)({dataIdFromObject:je},e),this.cache=this.config.cache,this.setRootTypename("Query"),this.setRootTypename("Mutation"),this.setRootTypename("Subscription"),e.possibleTypes&&this.addPossibleTypes(e.possibleTypes),e.typePolicies&&this.addTypePolicies(e.typePolicies)}return e.prototype.identify=function(e,t,n){var i=t&&n?(0,o.qw)(e,t,n):e.__typename;if(i===this.rootTypenamesById.ROOT_QUERY)return["ROOT_QUERY"];for(var s,r={typename:i,selectionSet:t,fragmentMap:n},a=i&&this.getTypePolicy(i),l=a&&a.keyFn||this.config.dataIdFromObject;l;){var c=l(e,r);if(!Array.isArray(c)){s=c;break}l=Qe(c)}return s=s&&String(s),r.keyObject?[s,r.keyObject]:[s]},e.prototype.addTypePolicies=function(e){var t=this;Object.keys(e).forEach((function(n){var s=e[n],r=s.queryType,o=s.mutationType,a=s.subscriptionType,l=(0,i._T)(s,["queryType","mutationType","subscriptionType"]);r&&t.setRootTypename("Query",n),o&&t.setRootTypename("Mutation",n),a&&t.setRootTypename("Subscription",n),fe.call(t.toBeAdded,n)?t.toBeAdded[n].push(l):t.toBeAdded[n]=[l]}))},e.prototype.updateTypePolicy=function(e,t){var n=this,i=this.getTypePolicy(e),s=t.keyFields,r=t.fields;function o(e,t){e.merge="function"==typeof t?t:!0===t?We:!1===t?Ke:e.merge}o(i,t.merge),i.keyFn=!1===s?Ge:Array.isArray(s)?Qe(s):"function"==typeof s?s:i.keyFn,r&&Object.keys(r).forEach((function(t){var i=n.getFieldPolicy(e,t,!0),s=r[t];if("function"==typeof s)i.read=s;else{var a=s.keyArgs,l=s.read,c=s.merge;i.keyFn=!1===a?ze:Array.isArray(a)?$e(a):"function"==typeof a?a:i.keyFn,"function"==typeof l&&(i.read=l),o(i,c)}i.read&&i.merge&&(i.keyFn=i.keyFn||ze)}))},e.prototype.setRootTypename=function(e,t){void 0===t&&(t=e);var n="ROOT_"+e.toUpperCase(),i=this.rootTypenamesById[n];t!==i&&((0,s.kG)(!i||i===e,1),i&&delete this.rootIdsByTypename[i],this.rootIdsByTypename[t]=n,this.rootTypenamesById[n]=t)},e.prototype.addPossibleTypes=function(e){var t=this;this.usingPossibleTypes=!0,Object.keys(e).forEach((function(n){t.getSupertypeSet(n,!0),e[n].forEach((function(e){t.getSupertypeSet(e,!0).add(n);var i=e.match(ge);i&&i[0]===e||t.fuzzySubtypes.set(e,new RegExp(e))}))}))},e.prototype.getTypePolicy=function(e){var t=this;if(!fe.call(this.typePolicies,e)){var n=this.typePolicies[e]=Object.create(null);n.fields=Object.create(null);var s=this.supertypeMap.get(e);s&&s.size&&s.forEach((function(e){var s=t.getTypePolicy(e),r=s.fields,o=(0,i._T)(s,["fields"]);Object.assign(n,o),Object.assign(n.fields,r)}))}var r=this.toBeAdded[e];return r&&r.length&&this.updateTypePolicy(e,o.oA.apply(void 0,r.splice(0))),this.typePolicies[e]},e.prototype.getFieldPolicy=function(e,t,n){if(e){var i=this.getTypePolicy(e).fields;return i[t]||n&&(i[t]=Object.create(null))}},e.prototype.getSupertypeSet=function(e,t){var n=this.supertypeMap.get(e);return!n&&t&&this.supertypeMap.set(e,n=new Set),n},e.prototype.fragmentMatches=function(e,t,n,i){var s=this;if(!e.typeCondition)return!0;if(!t)return!1;var r=e.typeCondition.name.value;if(t===r)return!0;if(this.usingPossibleTypes&&this.supertypeMap.has(r))for(var o=this.getSupertypeSet(t,!0),a=[o],l=function(e){var t=s.getSupertypeSet(e,!1);t&&t.size&&a.indexOf(t)<0&&a.push(t)},c=!(!n||!this.fuzzySubtypes.size),d=0;d<a.length;++d){var u=a[d];if(u.has(r))return o.has(r)||o.add(r),!0;u.forEach(l),c&&d===a.length-1&&ye(e.selectionSet,n,i)&&(c=!1,!0,this.fuzzySubtypes.forEach((function(e,n){var i=t.match(e);i&&i[0]===t&&l(n)})))}return!1},e.prototype.hasKeyArgs=function(e,t){var n=this.getFieldPolicy(e,t,!1);return!(!n||!n.keyFn)},e.prototype.getStoreFieldName=function(e){var t,n=e.typename,i=e.fieldName,s=this.getFieldPolicy(n,i,!1),r=s&&s.keyFn;if(r&&n)for(var a={typename:n,fieldName:i,field:e.field||null,variables:e.variables},l=He(e);r;){var c=r(l,a);if(!Array.isArray(c)){t=c||i;break}r=$e(c)}return void 0===t&&(t=e.field?(0,o.vf)(e.field,e.variables):(0,o.PT)(i,He(e))),i===ve(t)?t:i+":"+t},e.prototype.readField=function(e,t){var n=e.from;if(n&&(e.field||e.fieldName)){if(void 0===e.typename){var i=t.store.getFieldValue(n,"__typename");i&&(e.typename=i)}var s=this.getStoreFieldName(e),r=ve(s),a=t.store.getFieldValue(n,s),l=this.getFieldPolicy(e.typename,r,!1),c=l&&l.read;if(c){var d=qe(this,n,e,t,t.store.getStorage((0,o.hh)(n)?n.__ref:n,s));return Re.withValue(this.cache,c,[a,d])}return a}},e.prototype.getMergeFunction=function(e,t,n){var i=this.getFieldPolicy(e,t,!1),s=i&&i.merge;return!s&&n&&(s=(i=this.getTypePolicy(n))&&i.merge),s},e.prototype.runMergeFunction=function(e,t,n,i,s){var r=n.field,o=n.typename,a=n.merge;return a===We?Ze(i.store.getFieldValue)(e,t):a===Ke?t:a(e,t,qe(this,void 0,{typename:o,fieldName:r.name.value,field:r,variables:i.variables},i,s||Object.create(null)))},e}();function qe(e,t,n,s,r){var a=e.getStoreFieldName(n),l=ve(a),c=n.variables||s.variables,d=s.store,u=d.getFieldValue,h=d.toReference,p=d.canRead;return{args:He(n),field:n.field||null,fieldName:l,storeFieldName:a,variables:c,isReference:o.hh,toReference:h,storage:r,cache:e.cache,canRead:p,readField:function(n,r){var o="string"==typeof n?{fieldName:n,from:r}:(0,i.pi)({},n);return void 0===o.from&&(o.from=t),void 0===o.variables&&(o.variables=c),e.readField(o,s)},mergeObjects:Ze(u)}}function Ze(e){return function(t,n){if(Array.isArray(t)||Array.isArray(n))throw new s.ej(2);if(t&&"object"==typeof t&&n&&"object"==typeof n){var r=e(t,"__typename"),o=e(n,"__typename");return!(r&&o&&r!==o)&&be(t)&&be(n)?(0,i.pi)((0,i.pi)({},t),n):n}return n}}function $e(e){return function(t,n){return t?n.fieldName+":"+JSON.stringify(Je(t,e,!1)):n.fieldName}}function Qe(e){var t=new U(o.mr);return function(n,i){var s;if(i.selectionSet&&i.fragmentMap){var r=t.lookupArray([i.selectionSet,i.fragmentMap]);s=r.aliasMap||(r.aliasMap=Xe(i.selectionSet,i.fragmentMap))}var o=i.keyObject=Je(n,e,!0,s);return i.typename+":"+JSON.stringify(o)}}function Xe(e,t){var n=Object.create(null),i=new Set([e]);return i.forEach((function(e){e.selections.forEach((function(e){if((0,o.My)(e)){if(e.alias){var s=e.alias.value,r=e.name.value;if(r!==s)(n.aliases||(n.aliases=Object.create(null)))[r]=s}if(e.selectionSet)(n.subsets||(n.subsets=Object.create(null)))[e.name.value]=Xe(e.selectionSet,t)}else{var a=(0,o.hi)(e,t);a&&i.add(a.selectionSet)}}))})),n}function Je(e,t,n,i){var r,o=Object.create(null);return t.forEach((function(t){if(Array.isArray(t)){if("string"==typeof r){var a=i&&i.subsets,l=a&&a[r];o[r]=Je(e[r],t,n,l)}}else{var c=i&&i.aliases,d=c&&c[t]||t;fe.call(e,d)?o[r=t]=e[d]:((0,s.kG)(!n,3),r=void 0)}})),o}var et={dataIdFromObject:je,addTypename:!0,resultCaching:!0,typePolicies:{}},tt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return n.watches=new Set,n.typenameDocumentCache=new Map,n.makeVar=Fe,n.txCount=0,n.maybeBroadcastWatch=ue((function(e,t){return n.broadcastWatch.call(n,e,!!t)}),{makeCacheKey:function(e){var t=e.optimistic?n.optimisticData:n.data;if(Ae(t)){var i=e.optimistic,s=e.rootId,r=e.variables;return t.makeCacheKey(e.query,e.callback,JSON.stringify({optimistic:i,rootId:s,variables:r}))}}}),n.watchDep=ae(),n.config=(0,i.pi)((0,i.pi)({},et),t),n.addTypename=!!n.config.addTypename,n.policies=new Ye({cache:n,dataIdFromObject:n.config.dataIdFromObject,possibleTypes:n.config.possibleTypes,typePolicies:n.config.typePolicies}),n.data=new we.Root({policies:n.policies,resultCaching:n.config.resultCaching}),n.optimisticData=n.data,n.storeWriter=new De(n,n.storeReader=new Ne({cache:n,addTypename:n.addTypename})),n}return(0,i.ZT)(t,e),t.prototype.restore=function(e){return e&&this.data.replace(e),this},t.prototype.extract=function(e){return void 0===e&&(e=!1),(e?this.optimisticData:this.data).extract()},t.prototype.read=function(e){var t=e.returnPartialData,n=void 0!==t&&t;try{return this.storeReader.diffQueryAgainstStore({store:e.optimistic?this.optimisticData:this.data,query:e.query,variables:e.variables,rootId:e.rootId,config:this.config,returnPartialData:n}).result||null}catch(e){if(e instanceof me)return null;throw e}},t.prototype.write=function(e){try{return++this.txCount,this.storeWriter.writeToStore({store:this.data,query:e.query,result:e.result,dataId:e.dataId,variables:e.variables})}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.modify=function(e){if(fe.call(e,"id")&&!e.id)return!1;var t=e.optimistic?this.optimisticData:this.data;try{return++this.txCount,t.modify(e.id||"ROOT_QUERY",e.fields)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.diff=function(e){return this.storeReader.diffQueryAgainstStore({store:e.optimistic?this.optimisticData:this.data,rootId:e.id||"ROOT_QUERY",query:e.query,variables:e.variables,returnPartialData:e.returnPartialData,config:this.config})},t.prototype.watch=function(e){var t,n=this;return this.watches.size||Be(t=this).vars.forEach((function(e){return e.attachCache(t)})),this.watches.add(e),e.immediate&&this.maybeBroadcastWatch(e),function(){n.watches.delete(e)&&!n.watches.size&&function(e){Be(e).vars.forEach((function(t){return t.forgetCache(e)}))}(n),n.watchDep.dirty(e),n.maybeBroadcastWatch.forget(e)}},t.prototype.gc=function(){return this.optimisticData.gc()},t.prototype.retain=function(e,t){return(t?this.optimisticData:this.data).retain(e)},t.prototype.release=function(e,t){return(t?this.optimisticData:this.data).release(e)},t.prototype.identify=function(e){return(0,o.hh)(e)?e.__ref:this.policies.identify(e)[0]},t.prototype.evict=function(e){if(!e.id){if(fe.call(e,"id"))return!1;e=(0,i.pi)((0,i.pi)({},e),{id:"ROOT_QUERY"})}try{return++this.txCount,this.optimisticData.evict(e)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.reset=function(){return this.data.clear(),this.optimisticData=this.data,this.broadcastWatches(),Promise.resolve()},t.prototype.removeOptimistic=function(e){var t=this.optimisticData.removeLayer(e);t!==this.optimisticData&&(this.optimisticData=t,this.broadcastWatches())},t.prototype.performTransaction=function(e,t){var n=this,i=function(t){var i=n,s=i.data,r=i.optimisticData;++n.txCount,t&&(n.data=n.optimisticData=t);try{e(n)}finally{--n.txCount,n.data=s,n.optimisticData=r}},s=!1;"string"==typeof t?(this.optimisticData=this.optimisticData.addLayer(t,i),s=!0):null===t?i(this.data):i(),this.broadcastWatches(s)},t.prototype.transformDocument=function(e){if(this.addTypename){var t=this.typenameDocumentCache.get(e);return t||(t=(0,o.Gw)(e),this.typenameDocumentCache.set(e,t),this.typenameDocumentCache.set(t,t)),t}return e},t.prototype.broadcastWatches=function(e){var t=this;this.txCount||this.watches.forEach((function(n){return t.maybeBroadcastWatch(n,e)}))},t.prototype.broadcastWatch=function(e,t){this.watchDep.dirty(e),this.watchDep(e);var n=this.diff({query:e.query,variables:e.variables,optimistic:e.optimistic});e.optimistic&&t&&(n.fromOptimisticTransaction=!0),e.callback(n)},t}(pe),nt=function(){function e(e){var t=e.cache,n=e.client,i=e.resolvers,s=e.fragmentMatcher;this.cache=t,n&&(this.client=n),i&&this.addResolvers(i),s&&this.setFragmentMatcher(s)}return e.prototype.addResolvers=function(e){var t=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach((function(e){t.resolvers=(0,o.Ee)(t.resolvers,e)})):this.resolvers=(0,o.Ee)(this.resolvers,e)},e.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},e.prototype.getResolvers=function(){return this.resolvers||{}},e.prototype.runResolvers=function(e){var t=e.document,n=e.remoteResult,s=e.context,r=e.variables,o=e.onlyRunForcedResolvers,a=void 0!==o&&o;return(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){return t?[2,this.resolveDocument(t,n.data,s,r,this.fragmentMatcher,a).then((function(e){return(0,i.pi)((0,i.pi)({},n),{data:e.result})}))]:[2,n]}))}))},e.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},e.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},e.prototype.clientQuery=function(e){return(0,o.FS)(["client"],e)&&this.resolvers?e:null},e.prototype.serverQuery=function(e){return(0,o.ob)(e)},e.prototype.prepareContext=function(e){var t=this.cache;return(0,i.pi)((0,i.pi)({},e),{cache:t,getCacheKey:function(e){return t.identify(e)}})},e.prototype.addExportedVariables=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),(0,i.mG)(this,void 0,void 0,(function(){return(0,i.Jh)(this,(function(s){return e?[2,this.resolveDocument(e,this.buildRootValueFromCache(e,t)||{},this.prepareContext(n),t).then((function(e){return(0,i.pi)((0,i.pi)({},t),e.exportedVariables)}))]:[2,(0,i.pi)({},t)]}))}))},e.prototype.shouldForceResolvers=function(e){var t=!1;return(0,I.Vn)(e,{Directive:{enter:function(e){if("client"===e.name.value&&e.arguments&&(t=e.arguments.some((function(e){return"always"===e.name.value&&"BooleanValue"===e.value.kind&&!0===e.value.value}))))return I.$_}}}),t},e.prototype.buildRootValueFromCache=function(e,t){return this.cache.diff({query:(0,o.aL)(e),variables:t,returnPartialData:!0,optimistic:!1}).result},e.prototype.resolveDocument=function(e,t,n,s,r,a){return void 0===n&&(n={}),void 0===s&&(s={}),void 0===r&&(r=function(){return!0}),void 0===a&&(a=!1),(0,i.mG)(this,void 0,void 0,(function(){var l,c,d,u,h,p,m,f,g;return(0,i.Jh)(this,(function(v){return l=(0,o.p$)(e),c=(0,o.kU)(e),d=(0,o.F)(c),u=l.operation,h=u?u.charAt(0).toUpperCase()+u.slice(1):"Query",m=(p=this).cache,f=p.client,g={fragmentMap:d,context:(0,i.pi)((0,i.pi)({},n),{cache:m,client:f}),variables:s,fragmentMatcher:r,defaultOperationType:h,exportedVariables:{},onlyRunForcedResolvers:a},[2,this.resolveSelectionSet(l.selectionSet,t,g).then((function(e){return{result:e,exportedVariables:g.exportedVariables}}))]}))}))},e.prototype.resolveSelectionSet=function(e,t,n){return(0,i.mG)(this,void 0,void 0,(function(){var r,a,l,c,d,u=this;return(0,i.Jh)(this,(function(h){return r=n.fragmentMap,a=n.context,l=n.variables,c=[t],d=function(e){return(0,i.mG)(u,void 0,void 0,(function(){var d,u;return(0,i.Jh)(this,(function(i){return(0,o.LZ)(e,l)?(0,o.My)(e)?[2,this.resolveField(e,t,n).then((function(t){var n;void 0!==t&&c.push(((n={})[(0,o.u2)(e)]=t,n))}))]:((0,o.Ao)(e)?d=e:(d=r[e.name.value],(0,s.kG)(d,11)),d&&d.typeCondition&&(u=d.typeCondition.name.value,n.fragmentMatcher(t,u,a))?[2,this.resolveSelectionSet(d.selectionSet,t,n).then((function(e){c.push(e)}))]:[2]):[2]}))}))},[2,Promise.all(e.selections.map(d)).then((function(){return(0,o.bw)(c)}))]}))}))},e.prototype.resolveField=function(e,t,n){return(0,i.mG)(this,void 0,void 0,(function(){var s,r,a,l,c,d,u,h,p,m=this;return(0,i.Jh)(this,(function(i){return s=n.variables,r=e.name.value,a=(0,o.u2)(e),l=r!==a,c=t[a]||t[r],d=Promise.resolve(c),n.onlyRunForcedResolvers&&!this.shouldForceResolvers(e)||(u=t.__typename||n.defaultOperationType,(h=this.resolvers&&this.resolvers[u])&&(p=h[l?r:a])&&(d=Promise.resolve(Re.withValue(this.cache,p,[t,(0,o.NC)(e,s),n.context,{field:e,fragmentMap:n.fragmentMap}])))),[2,d.then((function(t){return void 0===t&&(t=c),e.directives&&e.directives.forEach((function(e){"export"===e.name.value&&e.arguments&&e.arguments.forEach((function(e){"as"===e.name.value&&"StringValue"===e.value.kind&&(n.exportedVariables[e.value.value]=t)}))})),e.selectionSet?null==t?t:Array.isArray(t)?m.resolveSubSelectedArray(e,t,n):e.selectionSet?m.resolveSelectionSet(e.selectionSet,t,n):void 0:t}))]}))}))},e.prototype.resolveSubSelectedArray=function(e,t,n){var i=this;return Promise.all(t.map((function(t){return null===t?null:Array.isArray(t)?i.resolveSubSelectedArray(e,t,n):e.selectionSet?i.resolveSelectionSet(e.selectionSet,t,n):void 0})))},e}(),it=new(o.mr?WeakMap:Map);function st(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){return it.set(e,(it.get(e)+1)%1e15),n.apply(this,arguments)})}function rt(e){e.notifyTimeout&&(clearTimeout(e.notifyTimeout),e.notifyTimeout=void 0)}var ot=function(){function e(e){this.cache=e,this.listeners=new Set,this.document=null,this.lastRequestId=1,this.subscriptions=new Set,this.stopped=!1,this.dirty=!1,this.diff=null,this.observableQuery=null,it.has(e)||(it.set(e,0),st(e,"evict"),st(e,"modify"),st(e,"reset"))}return e.prototype.init=function(e){var t=e.networkStatus||M.loading;return this.variables&&this.networkStatus!==M.loading&&!S(this.variables,e.variables)&&(t=M.setVariables),S(e.variables,this.variables)||(this.diff=null),Object.assign(this,{document:e.document,variables:e.variables,networkError:null,graphQLErrors:this.graphQLErrors||[],networkStatus:t}),e.observableQuery&&this.setObservableQuery(e.observableQuery),e.lastRequestId&&(this.lastRequestId=e.lastRequestId),this},e.prototype.reset=function(){rt(this),this.diff=null,this.dirty=!1},e.prototype.getDiff=function(e){return void 0===e&&(e=this.variables),this.diff&&S(e,this.variables)?this.diff:(this.updateWatch(this.variables=e),this.diff=this.cache.diff({query:this.document,variables:e,returnPartialData:!0,optimistic:!0}))},e.prototype.setDiff=function(e){var t=this,n=this.diff;this.diff=e,this.dirty||(e&&e.result)===(n&&n.result)||(this.dirty=!0,this.notifyTimeout||(this.notifyTimeout=setTimeout((function(){return t.notify()}),0)))},e.prototype.setObservableQuery=function(e){var t=this;e!==this.observableQuery&&(this.oqListener&&this.listeners.delete(this.oqListener),this.observableQuery=e,e?(e.queryInfo=this,this.listeners.add(this.oqListener=function(){t.getDiff().fromOptimisticTransaction?e.observe():e.reobserve()})):delete this.oqListener)},e.prototype.notify=function(){var e=this;rt(this),this.shouldNotify()&&this.listeners.forEach((function(t){return t(e)})),this.dirty=!1},e.prototype.shouldNotify=function(){if(!this.dirty||!this.listeners.size)return!1;if(A(this.networkStatus)&&this.observableQuery){var e=this.observableQuery.options.fetchPolicy;if("cache-only"!==e&&"cache-and-network"!==e)return!1}return!0},e.prototype.stop=function(){if(!this.stopped){this.stopped=!0,this.cancel(),delete this.cancel,this.subscriptions.forEach((function(e){return e.unsubscribe()}));var e=this.observableQuery;e&&e.stopPolling()}},e.prototype.cancel=function(){},e.prototype.updateWatch=function(e){var t=this;void 0===e&&(e=this.variables);var n=this.observableQuery;n&&"no-cache"===n.options.fetchPolicy||this.lastWatch&&this.lastWatch.query===this.document&&S(e,this.lastWatch.variables)||(this.cancel(),this.cancel=this.cache.watch(this.lastWatch={query:this.document,variables:e,optimistic:!0,callback:function(e){return t.setDiff(e)}}))},e.prototype.shouldWrite=function(e,t){var n=this.lastWrite;return!(n&&n.dmCount===it.get(this.cache)&&S(t,n.variables)&&S(e.data,n.result.data))},e.prototype.markResult=function(e,t,n){var i=this;this.graphQLErrors=(0,o.Of)(e.errors)?e.errors:[],this.reset(),"no-cache"===t.fetchPolicy?this.diff={result:e.data,complete:!0}:!this.stopped&&n&&(at(e,t.errorPolicy)?this.cache.performTransaction((function(n){if(i.shouldWrite(e,t.variables))n.writeQuery({query:i.document,data:e.data,variables:t.variables}),i.lastWrite={result:e,variables:t.variables,dmCount:it.get(i.cache)};else if(i.diff&&i.diff.complete)return void(e.data=i.diff.result);var s=n.diff({query:i.document,variables:t.variables,returnPartialData:!0,optimistic:!0});i.stopped||i.updateWatch(t.variables),i.diff=s,s.complete&&(e.data=s.result)})):this.lastWrite=void 0)},e.prototype.markReady=function(){return this.networkError=null,this.networkStatus=M.ready},e.prototype.markError=function(e){return this.networkStatus=M.error,this.lastWrite=void 0,this.reset(),e.graphQLErrors&&(this.graphQLErrors=e.graphQLErrors),e.networkError&&(this.networkError=e.networkError),e},e}();function at(e,t){void 0===t&&(t="none");var n="ignore"===t||"all"===t,i=!(0,o.d2)(e);return!i&&n&&e.data&&(i=!0),i}var lt=Object.prototype.hasOwnProperty,ct=function(){function e(e){var t=e.cache,n=e.link,i=e.queryDeduplication,s=void 0!==i&&i,r=e.onBroadcast,a=e.ssrMode,l=void 0!==a&&a,c=e.clientAwareness,d=void 0===c?{}:c,u=e.localState,h=e.assumeImmutableResults;this.clientAwareness={},this.queries=new Map,this.fetchCancelFns=new Map,this.transformCache=new(o.mr?WeakMap:Map),this.queryIdCounter=1,this.requestIdCounter=1,this.mutationIdCounter=1,this.inFlightLinkObservables=new Map,this.cache=t,this.link=n,this.queryDeduplication=s,this.clientAwareness=d,this.localState=u||new nt({cache:t}),this.ssrMode=l,this.assumeImmutableResults=!!h,(this.onBroadcast=r)&&(this.mutationStore=Object.create(null))}return e.prototype.stop=function(){var e=this;this.queries.forEach((function(t,n){e.stopQueryNoBroadcast(n)})),this.cancelPendingFetches(new s.ej(12))},e.prototype.cancelPendingFetches=function(e){this.fetchCancelFns.forEach((function(t){return t(e)})),this.fetchCancelFns.clear()},e.prototype.mutate=function(e){var t=e.mutation,n=e.variables,r=e.optimisticResponse,a=e.updateQueries,l=e.refetchQueries,c=void 0===l?[]:l,d=e.awaitRefetchQueries,u=void 0!==d&&d,h=e.update,p=e.errorPolicy,m=void 0===p?"none":p,f=e.fetchPolicy,g=e.context,v=void 0===g?{}:g;return(0,i.mG)(this,void 0,void 0,(function(){var e,l,d;return(0,i.Jh)(this,(function(p){switch(p.label){case 0:return(0,s.kG)(t,13),(0,s.kG)(!f||"no-cache"===f,14),e=this.generateMutationId(),t=this.transform(t).document,n=this.getVariables(t,n),this.transform(t).hasClientExports?[4,this.localState.addExportedVariables(t,n,v)]:[3,2];case 1:n=p.sent(),p.label=2;case 2:return l=this.mutationStore&&(this.mutationStore[e]={mutation:t,variables:n,loading:!0,error:null}),r&&this.markMutationOptimistic(r,{mutationId:e,document:t,variables:n,errorPolicy:m,updateQueries:a,update:h}),this.broadcastQueries(),d=this,[2,new Promise((function(s,p){var g,y;d.getObservableFromLink(t,(0,i.pi)((0,i.pi)({},v),{optimisticResponse:r}),n,!1).subscribe({next:function(i){if((0,o.d2)(i)&&"none"===m)y=new O({graphQLErrors:i.errors});else{if(l&&(l.loading=!1,l.error=null),"no-cache"!==f)try{d.markMutationResult({mutationId:e,result:i,document:t,variables:n,errorPolicy:m,updateQueries:a,update:h})}catch(e){return void(y=new O({networkError:e}))}g=i}},error:function(t){l&&(l.loading=!1,l.error=t),r&&d.cache.removeOptimistic(e),d.broadcastQueries(),p(new O({networkError:t}))},complete:function(){if(y&&l&&(l.loading=!1,l.error=y),r&&d.cache.removeOptimistic(e),d.broadcastQueries(),y)p(y);else{"function"==typeof c&&(c=c(g));var t=[];(0,o.Of)(c)&&c.forEach((function(e){if("string"==typeof e)d.queries.forEach((function(n){var i=n.observableQuery;i&&i.queryName===e&&t.push(i.refetch())}));else{var n={query:e.query,variables:e.variables,fetchPolicy:"network-only"};e.context&&(n.context=e.context),t.push(d.query(n))}})),Promise.all(u?t:[]).then((function(){"ignore"===m&&g&&(0,o.d2)(g)&&delete g.errors,s(g)}),p)}}})}))]}}))}))},e.prototype.markMutationResult=function(e,t){var n=this;if(void 0===t&&(t=this.cache),at(e.result,e.errorPolicy)){var i=[{result:e.result.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}],s=e.updateQueries;s&&this.queries.forEach((function(r,a){var l=r.observableQuery,c=l&&l.queryName;if(c&&lt.call(s,c)){var d=s[c],u=n.queries.get(a),h=u.document,p=u.variables,m=t.diff({query:h,variables:p,returnPartialData:!0,optimistic:!1}),f=m.result;if(m.complete&&f){var g=d(f,{mutationResult:e.result,queryName:h&&(0,o.rY)(h)||void 0,queryVariables:p});g&&i.push({result:g,dataId:"ROOT_QUERY",query:h,variables:p})}}})),t.performTransaction((function(t){i.forEach((function(e){return t.write(e)}));var n=e.update;n&&n(t,e.result)}),null)}},e.prototype.markMutationOptimistic=function(e,t){var n=this,s="function"==typeof e?e(t.variables):e;return this.cache.recordOptimisticTransaction((function(e){try{n.markMutationResult((0,i.pi)((0,i.pi)({},t),{result:{data:s}}),e)}catch(e){}}),t.mutationId)},e.prototype.fetchQuery=function(e,t,n){return this.fetchQueryObservable(e,t,n).promise},e.prototype.getQueryStore=function(){var e=Object.create(null);return this.queries.forEach((function(t,n){e[n]={variables:t.variables,networkStatus:t.networkStatus,networkError:t.networkError,graphQLErrors:t.graphQLErrors}})),e},e.prototype.resetErrors=function(e){var t=this.queries.get(e);t&&(t.networkError=void 0,t.graphQLErrors=[])},e.prototype.transform=function(e){var t=this.transformCache;if(!t.has(e)){var n=this.cache.transformDocument(e),i=(0,o.Fo)(this.cache.transformForLink(n)),s=this.localState.clientQuery(n),r=i&&this.localState.serverQuery(i),a={document:n,hasClientExports:(0,o.mj)(n),hasForcedResolvers:this.localState.shouldForceResolvers(n),clientQuery:s,serverQuery:r,defaultVars:(0,o.O4)((0,o.$H)(n))},l=function(e){e&&!t.has(e)&&t.set(e,a)};l(e),l(n),l(s),l(r)}return t.get(e)},e.prototype.getVariables=function(e,t){return(0,i.pi)((0,i.pi)({},this.transform(e).defaultVars),t)},e.prototype.watchQuery=function(e){void 0===(e=(0,i.pi)((0,i.pi)({},e),{variables:this.getVariables(e.query,e.variables)})).notifyOnNetworkStatusChange&&(e.notifyOnNetworkStatusChange=!1);var t=new ot(this.cache),n=new N({queryManager:this,queryInfo:t,options:e});return this.queries.set(n.queryId,t),t.init({document:e.query,observableQuery:n,variables:e.variables}),n},e.prototype.query=function(e){var t=this;(0,s.kG)(e.query,15),(0,s.kG)("Document"===e.query.kind,16),(0,s.kG)(!e.returnPartialData,17),(0,s.kG)(!e.pollInterval,18);var n=this.generateQueryId();return this.fetchQuery(n,e).finally((function(){return t.stopQuery(n)}))},e.prototype.generateQueryId=function(){return String(this.queryIdCounter++)},e.prototype.generateRequestId=function(){return this.requestIdCounter++},e.prototype.generateMutationId=function(){return String(this.mutationIdCounter++)},e.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryInStoreNoBroadcast=function(e){var t=this.queries.get(e);t&&t.stop()},e.prototype.clearStore=function(){return this.cancelPendingFetches(new s.ej(19)),this.queries.forEach((function(e){e.observableQuery?e.networkStatus=M.loading:e.stop()})),this.mutationStore&&(this.mutationStore=Object.create(null)),this.cache.reset()},e.prototype.resetStore=function(){var e=this;return this.clearStore().then((function(){return e.reFetchObservableQueries()}))},e.prototype.reFetchObservableQueries=function(e){var t=this;void 0===e&&(e=!1);var n=[];return this.queries.forEach((function(i,s){var r=i.observableQuery;if(r&&r.hasObservers()){var o=r.options.fetchPolicy;r.resetLastResults(),"cache-only"===o||!e&&"standby"===o||n.push(r.refetch()),t.getQuery(s).setDiff(null)}})),this.broadcastQueries(),Promise.all(n)},e.prototype.setObservableQuery=function(e){this.getQuery(e.queryId).setObservableQuery(e)},e.prototype.startGraphQLSubscription=function(e){var t=this,n=e.query,i=e.fetchPolicy,s=e.errorPolicy,r=e.variables,a=e.context,l=void 0===a?{}:a;n=this.transform(n).document,r=this.getVariables(n,r);var c=function(e){return t.getObservableFromLink(n,l,e,!1).map((function(r){if("no-cache"!==i&&(at(r,s)&&t.cache.write({query:n,result:r.data,dataId:"ROOT_SUBSCRIPTION",variables:e}),t.broadcastQueries()),(0,o.d2)(r))throw new O({graphQLErrors:r.errors});return r}))};if(this.transform(n).hasClientExports){var d=this.localState.addExportedVariables(n,r,l).then(c);return new o.y$((function(e){var t=null;return d.then((function(n){return t=n.subscribe(e)}),e.error),function(){return t&&t.unsubscribe()}}))}return c(r)},e.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},e.prototype.removeQuery=function(e){this.fetchCancelFns.delete(e),this.getQuery(e).stop(),this.queries.delete(e)},e.prototype.broadcastQueries=function(){this.onBroadcast&&this.onBroadcast(),this.queries.forEach((function(e){return e.notify()}))},e.prototype.getLocalState=function(){return this.localState},e.prototype.getObservableFromLink=function(e,t,n,s){var a,l,c=this;void 0===s&&(s=null!==(a=null==t?void 0:t.queryDeduplication)&&void 0!==a?a:this.queryDeduplication);var d=this.transform(e).serverQuery;if(d){var u=this.inFlightLinkObservables,h=this.link,p={query:d,variables:n,operationName:(0,o.rY)(d)||void 0,context:this.prepareContext((0,i.pi)((0,i.pi)({},t),{forceFetch:!s}))};if(t=p.context,s){var m=u.get(d)||new Map;u.set(d,m);var f=JSON.stringify(n);if(!(l=m.get(f))){var g=new o.X_([(0,r.ht)(h,p)]);m.set(f,l=g),g.cleanup((function(){m.delete(f)&&m.size<1&&u.delete(d)}))}}else l=new o.X_([(0,r.ht)(h,p)])}else l=new o.X_([o.y$.of({data:{}})]),t=this.prepareContext(t);var v=this.transform(e).clientQuery;return v&&(l=(0,o.sz)(l,(function(e){return c.localState.runResolvers({document:v,remoteResult:e,context:t,variables:n})}))),l},e.prototype.getResultsFromLink=function(e,t,n){var i=e.lastRequestId;return(0,o.sz)(this.getObservableFromLink(e.document,n.context,n.variables),(function(s){var r=(0,o.Of)(s.errors);if(i>=e.lastRequestId){if(r&&"none"===n.errorPolicy)throw e.markError(new O({graphQLErrors:s.errors}));e.markResult(s,n,t),e.markReady()}var a={data:s.data,loading:!1,networkStatus:e.networkStatus||M.ready};return r&&"ignore"!==n.errorPolicy&&(a.errors=s.errors),a}),(function(t){var n=t.hasOwnProperty("graphQLErrors")?t:new O({networkError:t});throw i>=e.lastRequestId&&e.markError(n),n}))},e.prototype.fetchQueryObservable=function(e,t,n){var i=this;void 0===n&&(n=M.loading);var s=this.transform(t.query).document,r=this.getVariables(s,t.variables),a=this.getQuery(e),l=a.networkStatus,c=t.fetchPolicy,d=void 0===c?"cache-first":c,u=t.errorPolicy,h=void 0===u?"none":u,p=t.returnPartialData,m=void 0!==p&&p,f=t.notifyOnNetworkStatusChange,g=void 0!==f&&f,v=t.context,y=void 0===v?{}:v;("cache-first"===d||"cache-and-network"===d||"network-only"===d||"no-cache"===d)&&g&&"number"==typeof l&&l!==n&&A(n)&&("cache-first"!==d&&(d="cache-and-network"),m=!0);var b=Object.assign({},t,{query:s,variables:r,fetchPolicy:d,errorPolicy:h,returnPartialData:m,notifyOnNetworkStatusChange:g,context:y}),S=function(e){return b.variables=e,i.fetchQueryByPolicy(a,b,n)};this.fetchCancelFns.set(e,(function(e){Promise.resolve().then((function(){return E.cancel(e)}))}));var E=new o.X_(this.transform(b.query).hasClientExports?this.localState.addExportedVariables(b.query,b.variables,b.context).then(S):S(b.variables));return E.cleanup((function(){i.fetchCancelFns.delete(e);var n=t.nextFetchPolicy;n&&(t.nextFetchPolicy=void 0,t.fetchPolicy="function"==typeof n?n.call(t,t.fetchPolicy||"cache-first"):n)})),E},e.prototype.fetchQueryByPolicy=function(e,t,n){var s=this,r=t.query,a=t.variables,l=t.fetchPolicy,c=t.errorPolicy,d=t.returnPartialData,u=t.context;e.init({document:r,variables:a,lastRequestId:this.generateRequestId(),networkStatus:n});var h=function(){return e.getDiff(a)},p=function(t,n){void 0===n&&(n=e.networkStatus||M.loading);var l=t.result;var c=function(e){return o.y$.of((0,i.pi)({data:e,loading:A(n),networkStatus:n},t.complete?null:{partial:!0}))};return s.transform(r).hasForcedResolvers?s.localState.runResolvers({document:r,remoteResult:{data:l},context:u,variables:a,onlyRunForcedResolvers:!0}).then((function(e){return c(e.data)})):c(l)},m=function(t){return s.getResultsFromLink(e,t,{variables:a,context:u,fetchPolicy:l,errorPolicy:c})};switch(l){default:case"cache-first":return(f=h()).complete?[p(f,e.markReady())]:d?[p(f),m(!0)]:[m(!0)];case"cache-and-network":var f;return(f=h()).complete||d?[p(f),m(!0)]:[m(!0)];case"cache-only":return[p(h(),e.markReady())];case"network-only":return[m(!0)];case"no-cache":return[m(!1)];case"standby":return[]}},e.prototype.getQuery=function(e){return e&&!this.queries.has(e)&&this.queries.set(e,new ot(this.cache)),this.queries.get(e)},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.localState.prepareContext(e);return(0,i.pi)((0,i.pi)({},t),{clientAwareness:this.clientAwareness})},e}();function dt(e,t){return(0,o.oA)(e,t,t.variables&&{variables:(0,i.pi)((0,i.pi)({},e.variables),t.variables)})}var ut=function(){function e(e){var t=this;this.defaultOptions={},this.resetStoreCallbacks=[],this.clearStoreCallbacks=[];var n=e.uri,i=e.credentials,o=e.headers,a=e.cache,l=e.ssrMode,c=void 0!==l&&l,d=e.ssrForceFetchDelay,u=void 0===d?0:d,h=e.connectToDevTools,p=void 0===h?"object"==typeof window&&!window.__APOLLO_CLIENT__&&!1:h,f=e.queryDeduplication,g=void 0===f||f,v=e.defaultOptions,y=e.assumeImmutableResults,b=void 0!==y&&y,S=e.resolvers,E=e.typeDefs,T=e.fragmentMatcher,w=e.name,x=e.version,_=e.link;if(_||(_=n?new m({uri:n,credentials:i,headers:o}):r.i0.empty()),!a)throw new s.ej(9);this.link=_,this.cache=a,this.disableNetworkFetches=c||u>0,this.queryDeduplication=g,this.defaultOptions=v||{},this.typeDefs=E,u&&setTimeout((function(){return t.disableNetworkFetches=!1}),u),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this),p&&"object"==typeof window&&(window.__APOLLO_CLIENT__=this),this.version="3.3.11",this.localState=new nt({cache:a,client:this,resolvers:S,fragmentMatcher:T}),this.queryManager=new ct({cache:this.cache,link:this.link,queryDeduplication:g,ssrMode:c,clientAwareness:{name:w,version:x},localState:this.localState,assumeImmutableResults:b,onBroadcast:p?function(){t.devToolsHookCb&&t.devToolsHookCb({action:{},state:{queries:t.queryManager.getQueryStore(),mutations:t.queryManager.mutationStore||{}},dataWithOptimisticResults:t.cache.extract(!0)})}:void 0})}return e.prototype.stop=function(){this.queryManager.stop()},e.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=dt(this.defaultOptions.watchQuery,e)),!this.disableNetworkFetches||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e=(0,i.pi)((0,i.pi)({},e),{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},e.prototype.query=function(e){return this.defaultOptions.query&&(e=dt(this.defaultOptions.query,e)),(0,s.kG)("cache-and-network"!==e.fetchPolicy,10),this.disableNetworkFetches&&"network-only"===e.fetchPolicy&&(e=(0,i.pi)((0,i.pi)({},e),{fetchPolicy:"cache-first"})),this.queryManager.query(e)},e.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=dt(this.defaultOptions.mutate,e)),this.queryManager.mutate(e)},e.prototype.subscribe=function(e){return this.queryManager.startGraphQLSubscription(e)},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.cache.readQuery(e,t)},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.cache.readFragment(e,t)},e.prototype.writeQuery=function(e){this.cache.writeQuery(e),this.queryManager.broadcastQueries()},e.prototype.writeFragment=function(e){this.cache.writeFragment(e),this.queryManager.broadcastQueries()},e.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},e.prototype.__requestRaw=function(e){return(0,r.ht)(this.link,e)},e.prototype.resetStore=function(){var e=this;return Promise.resolve().then((function(){return e.queryManager.clearStore()})).then((function(){return Promise.all(e.resetStoreCallbacks.map((function(e){return e()})))})).then((function(){return e.reFetchObservableQueries()}))},e.prototype.clearStore=function(){var e=this;return Promise.resolve().then((function(){return e.queryManager.clearStore()})).then((function(){return Promise.all(e.clearStoreCallbacks.map((function(e){return e()})))}))},e.prototype.onResetStore=function(e){var t=this;return this.resetStoreCallbacks.push(e),function(){t.resetStoreCallbacks=t.resetStoreCallbacks.filter((function(t){return t!==e}))}},e.prototype.onClearStore=function(e){var t=this;return this.clearStoreCallbacks.push(e),function(){t.clearStoreCallbacks=t.clearStoreCallbacks.filter((function(t){return t!==e}))}},e.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},e.prototype.extract=function(e){return this.cache.extract(e)},e.prototype.restore=function(e){return this.cache.restore(e)},e.prototype.addResolvers=function(e){this.localState.addResolvers(e)},e.prototype.setResolvers=function(e){this.localState.setResolvers(e)},e.prototype.getResolvers=function(){return this.localState.getResolvers()},e.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},e.prototype.setLink=function(e){this.link=this.queryManager.link=e},e}();n(72191),n(35367);var ht=function(){return(ht=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}"function"==typeof Symbol&&null!=Symbol.iterator&&Symbol.iterator,"function"==typeof Symbol&&null!=Symbol.asyncIterator&&Symbol.asyncIterator;var mt="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag";function ft(e,t){for(var n,i=/\r\n|[\n\r]/g,s=1,r=t+1;(n=i.exec(e.body))&&n.index<t;)s+=1,r=t+1-(n.index+n[0].length);return{line:s,column:r}}function gt(e){return vt(e.source,ft(e.source,e.start))}function vt(e,t){var n=e.locationOffset.column-1,i=bt(n)+e.body,s=t.line-1,r=e.locationOffset.line-1,o=t.line+r,a=1===t.line?n:0,l=t.column+a,c="".concat(e.name,":").concat(o,":").concat(l,"\n"),d=i.split(/\r\n|[\n\r]/g),u=d[s];if(u.length>120){for(var h=Math.floor(l/80),p=l%80,m=[],f=0;f<u.length;f+=80)m.push(u.slice(f,f+80));return c+yt([["".concat(o),m[0]]].concat(m.slice(1,h+1).map((function(e){return["",e]})),[[" ",bt(p-1)+"^"],["",m[h+1]]]))}return c+yt([["".concat(o-1),d[s-1]],["".concat(o),u],["",bt(l-1)+"^"],["".concat(o+1),d[s+1]]])}function yt(e){var t=e.filter((function(e){e[0];return void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,i=e[0],s=e[1];return bt(n-(t=i).length)+t+(s?" | "+s:" |")})).join("\n")}function bt(e){return Array(e+1).join(" ")}function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Et(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tt(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?wt(e):t}function wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xt(e){var t="function"==typeof Map?new Map:void 0;return(xt=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return _t(e,arguments,At(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Ot(i,e)})(e)}function _t(e,t,n){return(_t=Mt()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var s=new(Function.bind.apply(e,i));return n&&Ot(s,n.prototype),s}).apply(null,arguments)}function Mt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function Ot(e,t){return(Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(e){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}(a,e);var t,n,i,s,r,o=(t=a,n=Mt(),function(){var e,i=At(t);if(n){var s=At(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return Tt(this,e)});function a(e,t,n,i,s,r,l){var c,d,u,h,p;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),p=o.call(this,e);var m,f=Array.isArray(t)?0!==t.length?t:void 0:t?[t]:void 0,g=n;!g&&f&&(g=null===(m=f[0].loc)||void 0===m?void 0:m.source);var v,y=i;!y&&f&&(y=f.reduce((function(e,t){return t.loc&&e.push(t.loc.start),e}),[])),y&&0===y.length&&(y=void 0),i&&n?v=i.map((function(e){return ft(n,e)})):f&&(v=f.reduce((function(e,t){return t.loc&&e.push(ft(t.loc.source,t.loc.start)),e}),[]));var b,S=l;if(null==S&&null!=r){var E=r.extensions;"object"==pt(b=E)&&null!==b&&(S=E)}return Object.defineProperties(wt(p),{name:{value:"GraphQLError"},message:{value:e,enumerable:!0,writable:!0},locations:{value:null!==(c=v)&&void 0!==c?c:void 0,enumerable:null!=v},path:{value:null!=s?s:void 0,enumerable:null!=s},nodes:{value:null!=f?f:void 0},source:{value:null!==(d=g)&&void 0!==d?d:void 0},positions:{value:null!==(u=y)&&void 0!==u?u:void 0},originalError:{value:r},extensions:{value:null!==(h=S)&&void 0!==h?h:void 0,enumerable:null!=S}}),null!=r&&r.stack?(Object.defineProperty(wt(p),"stack",{value:r.stack,writable:!0,configurable:!0}),Tt(p)):(Error.captureStackTrace?Error.captureStackTrace(wt(p),a):Object.defineProperty(wt(p),"stack",{value:Error().stack,writable:!0,configurable:!0}),p)}return i=a,(s=[{key:"toString",value:function(){return function(e){var t=e.message;if(e.nodes)for(var n=0,i=e.nodes;n<i.length;n++){var s=i[n];s.loc&&(t+="\n\n"+gt(s.loc))}else if(e.source&&e.locations)for(var r=0,o=e.locations;r<o.length;r++){var a=o[r];t+="\n\n"+vt(e.source,a)}return t}(this)}},{key:mt,get:function(){return"Object"}}])&&Et(i.prototype,s),r&&Et(i,r),a}(xt(Error));function Nt(e,t,n){return new Ct("Syntax Error: ".concat(n),void 0,e,[t])}var Dt=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"}),It=n(83059),Lt=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"}),Pt=n(6589);function Rt(e,t){if(!Boolean(e))throw new Error(t)}const kt=function(e,t){return e instanceof t};function Ut(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bt=function(){function e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GraphQL request",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{line:1,column:1};"string"==typeof e||Rt(0,"Body must be a string. Received: ".concat((0,Pt.Z)(e),".")),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||Rt(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Rt(0,"column in locationOffset is 1-indexed and must be positive.")}var t,n,i;return t=e,(n=[{key:mt,get:function(){return"Source"}}])&&Ut(t.prototype,n),i&&Ut(t,i),e}();var Ft=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"}),Vt=n(7420),Ht=function(){function e(e){var t=new It.WU(Lt.SOF,0,0,0,0,null);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){return this.lastToken=this.token,this.token=this.lookahead()},t.lookahead=function(){var e=this.token;if(e.kind!==Lt.EOF)do{var t;e=null!==(t=e.next)&&void 0!==t?t:e.next=Gt(this,e)}while(e.kind===Lt.COMMENT);return e},e}();function jt(e){return isNaN(e)?Lt.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function Gt(e,t){for(var n=e.source,i=n.body,s=i.length,r=t.end;r<s;){var o=i.charCodeAt(r),a=e.line,l=1+r-e.lineStart;switch(o){case 65279:case 9:case 32:case 44:++r;continue;case 10:++r,++e.line,e.lineStart=r;continue;case 13:10===i.charCodeAt(r+1)?r+=2:++r,++e.line,e.lineStart=r;continue;case 33:return new It.WU(Lt.BANG,r,r+1,a,l,t);case 35:return Wt(n,r,a,l,t);case 36:return new It.WU(Lt.DOLLAR,r,r+1,a,l,t);case 38:return new It.WU(Lt.AMP,r,r+1,a,l,t);case 40:return new It.WU(Lt.PAREN_L,r,r+1,a,l,t);case 41:return new It.WU(Lt.PAREN_R,r,r+1,a,l,t);case 46:if(46===i.charCodeAt(r+1)&&46===i.charCodeAt(r+2))return new It.WU(Lt.SPREAD,r,r+3,a,l,t);break;case 58:return new It.WU(Lt.COLON,r,r+1,a,l,t);case 61:return new It.WU(Lt.EQUALS,r,r+1,a,l,t);case 64:return new It.WU(Lt.AT,r,r+1,a,l,t);case 91:return new It.WU(Lt.BRACKET_L,r,r+1,a,l,t);case 93:return new It.WU(Lt.BRACKET_R,r,r+1,a,l,t);case 123:return new It.WU(Lt.BRACE_L,r,r+1,a,l,t);case 124:return new It.WU(Lt.PIPE,r,r+1,a,l,t);case 125:return new It.WU(Lt.BRACE_R,r,r+1,a,l,t);case 34:return 34===i.charCodeAt(r+1)&&34===i.charCodeAt(r+2)?Zt(n,r,a,l,t,e):qt(n,r,a,l,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return Kt(n,r,o,a,l,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return Qt(n,r,a,l,t)}throw Nt(n,r,zt(o))}var c=e.line,d=1+r-e.lineStart;return new It.WU(Lt.EOF,s,s,c,d,t)}function zt(e){return e<32&&9!==e&&10!==e&&13!==e?"Cannot contain the invalid character ".concat(jt(e),"."):39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character ".concat(jt(e),".")}function Wt(e,t,n,i,s){var r,o=e.body,a=t;do{r=o.charCodeAt(++a)}while(!isNaN(r)&&(r>31||9===r));return new It.WU(Lt.COMMENT,t,a,n,i,s,o.slice(t+1,a))}function Kt(e,t,n,i,s,r){var o=e.body,a=n,l=t,c=!1;if(45===a&&(a=o.charCodeAt(++l)),48===a){if((a=o.charCodeAt(++l))>=48&&a<=57)throw Nt(e,l,"Invalid number, unexpected digit after 0: ".concat(jt(a),"."))}else l=Yt(e,l,a),a=o.charCodeAt(l);if(46===a&&(c=!0,a=o.charCodeAt(++l),l=Yt(e,l,a),a=o.charCodeAt(l)),69!==a&&101!==a||(c=!0,43!==(a=o.charCodeAt(++l))&&45!==a||(a=o.charCodeAt(++l)),l=Yt(e,l,a),a=o.charCodeAt(l)),46===a||function(e){return 95===e||e>=65&&e<=90||e>=97&&e<=122}(a))throw Nt(e,l,"Invalid number, expected digit but got: ".concat(jt(a),"."));return new It.WU(c?Lt.FLOAT:Lt.INT,t,l,i,s,r,o.slice(t,l))}function Yt(e,t,n){var i=e.body,s=t,r=n;if(r>=48&&r<=57){do{r=i.charCodeAt(++s)}while(r>=48&&r<=57);return s}throw Nt(e,s,"Invalid number, expected digit but got: ".concat(jt(r),"."))}function qt(e,t,n,i,s){for(var r,o,a,l,c=e.body,d=t+1,u=d,h=0,p="";d<c.length&&!isNaN(h=c.charCodeAt(d))&&10!==h&&13!==h;){if(34===h)return p+=c.slice(u,d),new It.WU(Lt.STRING,t,d+1,n,i,s,p);if(h<32&&9!==h)throw Nt(e,d,"Invalid character within String: ".concat(jt(h),"."));if(++d,92===h){switch(p+=c.slice(u,d-1),h=c.charCodeAt(d)){case 34:p+='"';break;case 47:p+="/";break;case 92:p+="\\";break;case 98:p+="\b";break;case 102:p+="\f";break;case 110:p+="\n";break;case 114:p+="\r";break;case 116:p+="\t";break;case 117:var m=(r=c.charCodeAt(d+1),o=c.charCodeAt(d+2),a=c.charCodeAt(d+3),l=c.charCodeAt(d+4),$t(r)<<12|$t(o)<<8|$t(a)<<4|$t(l));if(m<0){var f=c.slice(d+1,d+5);throw Nt(e,d,"Invalid character escape sequence: \\u".concat(f,"."))}p+=String.fromCharCode(m),d+=4;break;default:throw Nt(e,d,"Invalid character escape sequence: \\".concat(String.fromCharCode(h),"."))}u=++d}}throw Nt(e,d,"Unterminated string.")}function Zt(e,t,n,i,s,r){for(var o=e.body,a=t+3,l=a,c=0,d="";a<o.length&&!isNaN(c=o.charCodeAt(a));){if(34===c&&34===o.charCodeAt(a+1)&&34===o.charCodeAt(a+2))return d+=o.slice(l,a),new It.WU(Lt.BLOCK_STRING,t,a+3,n,i,s,(0,Vt.W7)(d));if(c<32&&9!==c&&10!==c&&13!==c)throw Nt(e,a,"Invalid character within String: ".concat(jt(c),"."));10===c?(++a,++r.line,r.lineStart=a):13===c?(10===o.charCodeAt(a+1)?a+=2:++a,++r.line,r.lineStart=a):92===c&&34===o.charCodeAt(a+1)&&34===o.charCodeAt(a+2)&&34===o.charCodeAt(a+3)?(d+=o.slice(l,a)+'"""',l=a+=4):++a}throw Nt(e,a,"Unterminated string.")}function $t(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function Qt(e,t,n,i,s){for(var r=e.body,o=r.length,a=t+1,l=0;a!==o&&!isNaN(l=r.charCodeAt(a))&&(95===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122);)++a;return new It.WU(Lt.NAME,t,a,n,i,s,r.slice(t,a))}var Xt=function(){function e(e,t){var n=function(e){return kt(e,Bt)}(e)?e:new Bt(e);this._lexer=new Ht(n),this._options=t}var t=e.prototype;return t.parseName=function(){var e=this.expectToken(Lt.NAME);return{kind:Dt.NAME,value:e.value,loc:this.loc(e)}},t.parseDocument=function(){var e=this._lexer.token;return{kind:Dt.DOCUMENT,definitions:this.many(Lt.SOF,this.parseDefinition,Lt.EOF),loc:this.loc(e)}},t.parseDefinition=function(){if(this.peek(Lt.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(Lt.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var e=this._lexer.token;if(this.peek(Lt.BRACE_L))return{kind:Dt.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(e)};var t,n=this.parseOperationType();return this.peek(Lt.NAME)&&(t=this.parseName()),{kind:Dt.OPERATION_DEFINITION,operation:n,name:t,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseOperationType=function(){var e=this.expectToken(Lt.NAME);switch(e.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(e)},t.parseVariableDefinitions=function(){return this.optionalMany(Lt.PAREN_L,this.parseVariableDefinition,Lt.PAREN_R)},t.parseVariableDefinition=function(){var e=this._lexer.token;return{kind:Dt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(Lt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(Lt.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(e)}},t.parseVariable=function(){var e=this._lexer.token;return this.expectToken(Lt.DOLLAR),{kind:Dt.VARIABLE,name:this.parseName(),loc:this.loc(e)}},t.parseSelectionSet=function(){var e=this._lexer.token;return{kind:Dt.SELECTION_SET,selections:this.many(Lt.BRACE_L,this.parseSelection,Lt.BRACE_R),loc:this.loc(e)}},t.parseSelection=function(){return this.peek(Lt.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var e,t,n=this._lexer.token,i=this.parseName();return this.expectOptionalToken(Lt.COLON)?(e=i,t=this.parseName()):t=i,{kind:Dt.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(Lt.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(n)}},t.parseArguments=function(e){var t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(Lt.PAREN_L,t,Lt.PAREN_R)},t.parseArgument=function(){var e=this._lexer.token,t=this.parseName();return this.expectToken(Lt.COLON),{kind:Dt.ARGUMENT,name:t,value:this.parseValueLiteral(!1),loc:this.loc(e)}},t.parseConstArgument=function(){var e=this._lexer.token;return{kind:Dt.ARGUMENT,name:this.parseName(),value:(this.expectToken(Lt.COLON),this.parseValueLiteral(!0)),loc:this.loc(e)}},t.parseFragment=function(){var e=this._lexer.token;this.expectToken(Lt.SPREAD);var t=this.expectOptionalKeyword("on");return!t&&this.peek(Lt.NAME)?{kind:Dt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(e)}:{kind:Dt.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseFragmentDefinition=function(){var e,t=this._lexer.token;return this.expectKeyword("fragment"),!0===(null===(e=this._options)||void 0===e?void 0:e.experimentalFragmentVariables)?{kind:Dt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}:{kind:Dt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}},t.parseFragmentName=function(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(e){var t=this._lexer.token;switch(t.kind){case Lt.BRACKET_L:return this.parseList(e);case Lt.BRACE_L:return this.parseObject(e);case Lt.INT:return this._lexer.advance(),{kind:Dt.INT,value:t.value,loc:this.loc(t)};case Lt.FLOAT:return this._lexer.advance(),{kind:Dt.FLOAT,value:t.value,loc:this.loc(t)};case Lt.STRING:case Lt.BLOCK_STRING:return this.parseStringLiteral();case Lt.NAME:switch(this._lexer.advance(),t.value){case"true":return{kind:Dt.BOOLEAN,value:!0,loc:this.loc(t)};case"false":return{kind:Dt.BOOLEAN,value:!1,loc:this.loc(t)};case"null":return{kind:Dt.NULL,loc:this.loc(t)};default:return{kind:Dt.ENUM,value:t.value,loc:this.loc(t)}}case Lt.DOLLAR:if(!e)return this.parseVariable()}throw this.unexpected()},t.parseStringLiteral=function(){var e=this._lexer.token;return this._lexer.advance(),{kind:Dt.STRING,value:e.value,block:e.kind===Lt.BLOCK_STRING,loc:this.loc(e)}},t.parseList=function(e){var t=this,n=this._lexer.token;return{kind:Dt.LIST,values:this.any(Lt.BRACKET_L,(function(){return t.parseValueLiteral(e)}),Lt.BRACKET_R),loc:this.loc(n)}},t.parseObject=function(e){var t=this,n=this._lexer.token;return{kind:Dt.OBJECT,fields:this.any(Lt.BRACE_L,(function(){return t.parseObjectField(e)}),Lt.BRACE_R),loc:this.loc(n)}},t.parseObjectField=function(e){var t=this._lexer.token,n=this.parseName();return this.expectToken(Lt.COLON),{kind:Dt.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e),loc:this.loc(t)}},t.parseDirectives=function(e){for(var t=[];this.peek(Lt.AT);)t.push(this.parseDirective(e));return t},t.parseDirective=function(e){var t=this._lexer.token;return this.expectToken(Lt.AT),{kind:Dt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e),loc:this.loc(t)}},t.parseTypeReference=function(){var e,t=this._lexer.token;return this.expectOptionalToken(Lt.BRACKET_L)?(e=this.parseTypeReference(),this.expectToken(Lt.BRACKET_R),e={kind:Dt.LIST_TYPE,type:e,loc:this.loc(t)}):e=this.parseNamedType(),this.expectOptionalToken(Lt.BANG)?{kind:Dt.NON_NULL_TYPE,type:e,loc:this.loc(t)}:e},t.parseNamedType=function(){var e=this._lexer.token;return{kind:Dt.NAMED_TYPE,name:this.parseName(),loc:this.loc(e)}},t.parseTypeSystemDefinition=function(){var e=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(e.kind===Lt.NAME)switch(e.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(e)},t.peekDescription=function(){return this.peek(Lt.STRING)||this.peek(Lt.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");var n=this.parseDirectives(!0),i=this.many(Lt.BRACE_L,this.parseOperationTypeDefinition,Lt.BRACE_R);return{kind:Dt.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:i,loc:this.loc(e)}},t.parseOperationTypeDefinition=function(){var e=this._lexer.token,t=this.parseOperationType();this.expectToken(Lt.COLON);var n=this.parseNamedType();return{kind:Dt.OPERATION_TYPE_DEFINITION,operation:t,type:n,loc:this.loc(e)}},t.parseScalarTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");var n=this.parseName(),i=this.parseDirectives(!0);return{kind:Dt.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:i,loc:this.loc(e)}},t.parseObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");var n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseDirectives(!0),r=this.parseFieldsDefinition();return{kind:Dt.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:i,directives:s,fields:r,loc:this.loc(e)}},t.parseImplementsInterfaces=function(){var e;if(!this.expectOptionalKeyword("implements"))return[];if(!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLImplementsInterfaces)){var t=[];this.expectOptionalToken(Lt.AMP);do{t.push(this.parseNamedType())}while(this.expectOptionalToken(Lt.AMP)||this.peek(Lt.NAME));return t}return this.delimitedMany(Lt.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var e;return!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLEmptyFields)&&this.peek(Lt.BRACE_L)&&this._lexer.lookahead().kind===Lt.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(Lt.BRACE_L,this.parseFieldDefinition,Lt.BRACE_R)},t.parseFieldDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),i=this.parseArgumentDefs();this.expectToken(Lt.COLON);var s=this.parseTypeReference(),r=this.parseDirectives(!0);return{kind:Dt.FIELD_DEFINITION,description:t,name:n,arguments:i,type:s,directives:r,loc:this.loc(e)}},t.parseArgumentDefs=function(){return this.optionalMany(Lt.PAREN_L,this.parseInputValueDef,Lt.PAREN_R)},t.parseInputValueDef=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(Lt.COLON);var i,s=this.parseTypeReference();this.expectOptionalToken(Lt.EQUALS)&&(i=this.parseValueLiteral(!0));var r=this.parseDirectives(!0);return{kind:Dt.INPUT_VALUE_DEFINITION,description:t,name:n,type:s,defaultValue:i,directives:r,loc:this.loc(e)}},t.parseInterfaceTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");var n=this.parseName(),i=this.parseImplementsInterfaces(),s=this.parseDirectives(!0),r=this.parseFieldsDefinition();return{kind:Dt.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:i,directives:s,fields:r,loc:this.loc(e)}},t.parseUnionTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");var n=this.parseName(),i=this.parseDirectives(!0),s=this.parseUnionMemberTypes();return{kind:Dt.UNION_TYPE_DEFINITION,description:t,name:n,directives:i,types:s,loc:this.loc(e)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(Lt.EQUALS)?this.delimitedMany(Lt.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");var n=this.parseName(),i=this.parseDirectives(!0),s=this.parseEnumValuesDefinition();return{kind:Dt.ENUM_TYPE_DEFINITION,description:t,name:n,directives:i,values:s,loc:this.loc(e)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(Lt.BRACE_L,this.parseEnumValueDefinition,Lt.BRACE_R)},t.parseEnumValueDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),i=this.parseDirectives(!0);return{kind:Dt.ENUM_VALUE_DEFINITION,description:t,name:n,directives:i,loc:this.loc(e)}},t.parseInputObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");var n=this.parseName(),i=this.parseDirectives(!0),s=this.parseInputFieldsDefinition();return{kind:Dt.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:i,fields:s,loc:this.loc(e)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(Lt.BRACE_L,this.parseInputValueDef,Lt.BRACE_R)},t.parseTypeSystemExtension=function(){var e=this._lexer.lookahead();if(e.kind===Lt.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)},t.parseSchemaExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var t=this.parseDirectives(!0),n=this.optionalMany(Lt.BRACE_L,this.parseOperationTypeDefinition,Lt.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return{kind:Dt.SCHEMA_EXTENSION,directives:t,operationTypes:n,loc:this.loc(e)}},t.parseScalarTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var t=this.parseName(),n=this.parseDirectives(!0);if(0===n.length)throw this.unexpected();return{kind:Dt.SCALAR_TYPE_EXTENSION,name:t,directives:n,loc:this.loc(e)}},t.parseObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var t=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseDirectives(!0),s=this.parseFieldsDefinition();if(0===n.length&&0===i.length&&0===s.length)throw this.unexpected();return{kind:Dt.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:i,fields:s,loc:this.loc(e)}},t.parseInterfaceTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var t=this.parseName(),n=this.parseImplementsInterfaces(),i=this.parseDirectives(!0),s=this.parseFieldsDefinition();if(0===n.length&&0===i.length&&0===s.length)throw this.unexpected();return{kind:Dt.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:i,fields:s,loc:this.loc(e)}},t.parseUnionTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var t=this.parseName(),n=this.parseDirectives(!0),i=this.parseUnionMemberTypes();if(0===n.length&&0===i.length)throw this.unexpected();return{kind:Dt.UNION_TYPE_EXTENSION,name:t,directives:n,types:i,loc:this.loc(e)}},t.parseEnumTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var t=this.parseName(),n=this.parseDirectives(!0),i=this.parseEnumValuesDefinition();if(0===n.length&&0===i.length)throw this.unexpected();return{kind:Dt.ENUM_TYPE_EXTENSION,name:t,directives:n,values:i,loc:this.loc(e)}},t.parseInputObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var t=this.parseName(),n=this.parseDirectives(!0),i=this.parseInputFieldsDefinition();if(0===n.length&&0===i.length)throw this.unexpected();return{kind:Dt.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:i,loc:this.loc(e)}},t.parseDirectiveDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(Lt.AT);var n=this.parseName(),i=this.parseArgumentDefs(),s=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var r=this.parseDirectiveLocations();return{kind:Dt.DIRECTIVE_DEFINITION,description:t,name:n,arguments:i,repeatable:s,locations:r,loc:this.loc(e)}},t.parseDirectiveLocations=function(){return this.delimitedMany(Lt.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var e=this._lexer.token,t=this.parseName();if(void 0!==Ft[t.value])return t;throw this.unexpected(e)},t.loc=function(e){var t;if(!0!==(null===(t=this._options)||void 0===t?void 0:t.noLocation))return new It.Ye(e,this._lexer.lastToken,this._lexer.source)},t.peek=function(e){return this._lexer.token.kind===e},t.expectToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t;throw Nt(this._lexer.source,t.start,"Expected ".concat(en(e),", found ").concat(Jt(t),"."))},t.expectOptionalToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t},t.expectKeyword=function(e){var t=this._lexer.token;if(t.kind!==Lt.NAME||t.value!==e)throw Nt(this._lexer.source,t.start,'Expected "'.concat(e,'", found ').concat(Jt(t),"."));this._lexer.advance()},t.expectOptionalKeyword=function(e){var t=this._lexer.token;return t.kind===Lt.NAME&&t.value===e&&(this._lexer.advance(),!0)},t.unexpected=function(e){var t=null!=e?e:this._lexer.token;return Nt(this._lexer.source,t.start,"Unexpected ".concat(Jt(t),"."))},t.any=function(e,t,n){this.expectToken(e);for(var i=[];!this.expectOptionalToken(n);)i.push(t.call(this));return i},t.optionalMany=function(e,t,n){if(this.expectOptionalToken(e)){var i=[];do{i.push(t.call(this))}while(!this.expectOptionalToken(n));return i}return[]},t.many=function(e,t,n){this.expectToken(e);var i=[];do{i.push(t.call(this))}while(!this.expectOptionalToken(n));return i},t.delimitedMany=function(e,t){this.expectOptionalToken(e);var n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n},e}();function Jt(e){var t=e.value;return en(e.kind)+(null!=t?' "'.concat(t,'"'):"")}function en(e){return function(e){return e===Lt.BANG||e===Lt.DOLLAR||e===Lt.AMP||e===Lt.PAREN_L||e===Lt.PAREN_R||e===Lt.SPREAD||e===Lt.COLON||e===Lt.EQUALS||e===Lt.AT||e===Lt.BRACKET_L||e===Lt.BRACKET_R||e===Lt.BRACE_L||e===Lt.PIPE||e===Lt.BRACE_R}(e)?'"'.concat(e,'"'):e}var tn=new Map,nn=new Map,sn=!0,rn=!1;function on(e){return e.replace(/[\s,]+/g," ").trim()}function an(e){var t=new Set,n=[];return e.definitions.forEach((function(e){if("FragmentDefinition"===e.kind){var i=e.name.value,s=on((o=e.loc).source.body.substring(o.start,o.end)),r=nn.get(i);r&&!r.has(s)?sn&&console.warn("Warning: fragment with name "+i+" already exists.\ngraphql-tag enforces all fragment names across your application to be unique; read more about\nthis in the docs: http://dev.apollodata.com/core/fragments.html#unique-names"):r||nn.set(i,r=new Set),r.add(s),t.has(s)||(t.add(s),n.push(e))}else n.push(e);var o})),ht(ht({},e),{definitions:n})}function ln(e){var t=on(e);if(!tn.has(t)){var n=function(e,t){return new Xt(e,t).parseDocument()}(e,{experimentalFragmentVariables:rn});if(!n||"Document"!==n.kind)throw new Error("Not a valid GraphQL document.");tn.set(t,function(e){var t=new Set(e.definitions);t.forEach((function(e){e.loc&&delete e.loc,Object.keys(e).forEach((function(n){var i=e[n];i&&"object"==typeof i&&t.add(i)}))}));var n=e.loc;return n&&(delete n.startToken,delete n.endToken),e}(an(n)))}return tn.get(t)}function cn(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"string"==typeof e&&(e=[e]);var i=e[0];return t.forEach((function(t,n){t&&"Document"===t.kind?i+=t.loc.source.body:i+=t,i+=e[n+1]})),ln(i)}const dn=Object.assign(cn,{gql:cn,default:cn,resetCaches:function(){tn.clear(),nn.clear()},disableFragmentWarnings:function(){sn=!1},enableExperimentalFragmentVariables:function(){rn=!0},disableExperimentalFragmentVariables:function(){rn=!1}});(0,s.U6)("log");dn.resetCaches,dn.disableFragmentWarnings,dn.enableExperimentalFragmentVariables,dn.disableExperimentalFragmentVariables},72191:()=>{},97222:(e,t,n)=>{"use strict";n.d(t,{i:()=>d});var i=n(23564),s=n(5419),r=n(80496),o=n(84913);function a(e,t){return t?t(e):r.y$.of()}function l(e){return"function"==typeof e?new d(e):e}function c(e){return e.request.length<=1}!function(e){function t(t,n){var i=e.call(this,t)||this;return i.link=n,i}(0,i.ZT)(t,e)}(Error);var d=function(){function e(e){e&&(this.request=e)}return e.empty=function(){return new e((function(){return r.y$.of()}))},e.from=function(t){return 0===t.length?e.empty():t.map(l).reduce((function(e,t){return e.concat(t)}))},e.split=function(t,n,i){var s=l(n),o=l(i||new e(a));return c(s)&&c(o)?new e((function(e){return t(e)?s.request(e)||r.y$.of():o.request(e)||r.y$.of()})):new e((function(e,n){return t(e)?s.request(e,n)||r.y$.of():o.request(e,n)||r.y$.of()}))},e.execute=function(e,t){return e.request((0,o.zi)(t.context,(0,o.DQ)((0,o.Ak)(t))))||r.y$.of()},e.concat=function(t,n){var i=l(t);if(c(i))return i;var s=l(n);return c(s)?new e((function(e){return i.request(e,(function(e){return s.request(e)||r.y$.of()}))||r.y$.of()})):new e((function(e,t){return i.request(e,(function(e){return s.request(e,t)||r.y$.of()}))||r.y$.of()}))},e.prototype.split=function(t,n,i){return this.concat(e.split(t,n,i||new e(a)))},e.prototype.concat=function(t){return e.concat(this,t)},e.prototype.request=function(e,t){throw new s.ej(21)},e.prototype.onError=function(e,t){if(t&&t.error)return t.error(e),!1;throw e},e.prototype.setOnError=function(e){return this.onError=e,this},e}()},24957:(e,t,n)=>{"use strict";n(97222).i.concat},67325:(e,t,n)=>{"use strict";n(97222).i.empty},2550:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var i=n(97222).i.execute},34674:(e,t,n)=>{"use strict";n(97222).i.from},81707:(e,t,n)=>{"use strict";n.d(t,{ht:()=>i.h,i0:()=>s.i});n(67325),n(34674),n(64738),n(24957);var i=n(2550),s=n(97222),r=n(79875);n.o(r,"createHttpLink")&&n.d(t,{createHttpLink:function(){return r.createHttpLink}})},64738:(e,t,n)=>{"use strict";n(97222).i.split},79875:()=>{},84913:(e,t,n)=>{"use strict";n.d(t,{zi:()=>c,Qc:()=>s,PW:()=>o,DQ:()=>d,Ak:()=>a});var i=n(80496);function s(e){return new i.y$((function(t){t.error(e)}))}var r=n(5419);var o=function(e,t,n){var i=new Error(n);throw i.name="ServerError",i.response=e,i.statusCode=e.status,i.result=t,i};function a(e){for(var t=["query","operationName","variables","extensions","context"],n=0,i=Object.keys(e);n<i.length;n++){var s=i[n];if(t.indexOf(s)<0)throw new r.ej(26)}return e}var l=n(23564);function c(e,t){var n=(0,l.pi)({},e);return Object.defineProperty(t,"setContext",{enumerable:!1,value:function(e){n="function"==typeof e?(0,l.pi)((0,l.pi)({},n),e(n)):(0,l.pi)((0,l.pi)({},n),e)}}),Object.defineProperty(t,"getContext",{enumerable:!1,value:function(){return(0,l.pi)({},n)}}),t}function d(e){var t={variables:e.variables||{},extensions:e.extensions||{},operationName:e.operationName,query:e.query};return t.operationName||(t.operationName="string"!=typeof t.query?(0,i.rY)(t.query)||void 0:""),t}},23564:(e,t,n)=>{"use strict";n.d(t,{ZT:()=>s,pi:()=>r,_T:()=>o,mG:()=>a,Jh:()=>l,pr:()=>c});var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}function a(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}function l(e,t){var n,i,s,r,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(s=2&r[0]?i.return:r[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,r[1])).done)return s;switch(i=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(s=o.trys,(s=s.length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){o.label=r[1];break}if(6===r[0]&&o.label<s[1]){o.label=s[1],s=r;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(r);break}s[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],i=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function c(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),s=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,a=r.length;o<a;o++,s++)i[s]=r[o];return i}},80496:(e,t,n)=>{"use strict";n.d(t,{X_:()=>oe,w0:()=>Z,y$:()=>Q(),Gw:()=>B,NC:()=>S,sz:()=>ie,aL:()=>j,mr:()=>ce,Xh:()=>J,oA:()=>de,F:()=>d,Dy:()=>se,O4:()=>D,kU:()=>A,hi:()=>u,Yk:()=>c,p$:()=>N,$H:()=>M,rY:()=>O,iW:()=>C,PT:()=>b,qw:()=>T,d2:()=>le,mj:()=>a,FS:()=>o,My:()=>w,Ao:()=>x,Of:()=>ae,hh:()=>f,pM:()=>ne,kQ:()=>m,Jv:()=>te,Ee:()=>W,bw:()=>K,ob:()=>G,Fo:()=>V,u2:()=>E,LZ:()=>r,vf:()=>v});var i=n(27636),s=n(5419);function r(e,t){var n=e.directives;return!n||!n.length||function(e){var t=[];e&&e.length&&e.forEach((function(e){if(function(e){var t=e.name.value;return"skip"===t||"include"===t}(e)){var n=e.arguments;e.name.value;(0,s.kG)(n&&1===n.length,39);var i=n[0];(0,s.kG)(i.name&&"if"===i.name.value,40);var r=i.value;(0,s.kG)(r&&("Variable"===r.kind||"BooleanValue"===r.kind),41),t.push({directive:e,ifArgument:i})}}));return t}(n).every((function(e){var n=e.directive,i=e.ifArgument,r=!1;return"Variable"===i.value.kind?(r=t&&t[i.value.name.value],(0,s.kG)(void 0!==r,38)):r=i.value.value,"skip"===n.name.value?!r:r}))}function o(e,t){return function(e){var t=[];return(0,i.Vn)(e,{Directive:function(e){t.push(e.name.value)}}),t}(t).some((function(t){return e.indexOf(t)>-1}))}function a(e){return e&&o(["client"],e)&&o(["export"],e)}var l=n(23564);function c(e,t){var n=t,i=[];return e.definitions.forEach((function(e){if("OperationDefinition"===e.kind)throw new s.ej(42);"FragmentDefinition"===e.kind&&i.push(e)})),void 0===n&&((0,s.kG)(1===i.length,43),n=i[0].name.value),(0,l.pi)((0,l.pi)({},e),{definitions:(0,l.pr)([{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:n}}]}}],e.definitions)})}function d(e){void 0===e&&(e=[]);var t={};return e.forEach((function(e){t[e.name.value]=e})),t}function u(e,t){switch(e.kind){case"InlineFragment":return e;case"FragmentSpread":var n=t&&t[e.name.value];return(0,s.kG)(n,44),n;default:return null}}var h=n(35035),p=n.n(h);function m(e){return{__ref:String(e)}}function f(e){return Boolean(e&&"object"==typeof e&&"string"==typeof e.__ref)}function g(e,t,n,i){if(function(e){return"IntValue"===e.kind}(n)||function(e){return"FloatValue"===e.kind}(n))e[t.value]=Number(n.value);else if(function(e){return"BooleanValue"===e.kind}(n)||function(e){return"StringValue"===e.kind}(n))e[t.value]=n.value;else if(function(e){return"ObjectValue"===e.kind}(n)){var r={};n.fields.map((function(e){return g(r,e.name,e.value,i)})),e[t.value]=r}else if(function(e){return"Variable"===e.kind}(n)){var o=(i||{})[n.name.value];e[t.value]=o}else if(function(e){return"ListValue"===e.kind}(n))e[t.value]=n.values.map((function(e){var n={};return g(n,t,e,i),n[t.value]}));else if(function(e){return"EnumValue"===e.kind}(n))e[t.value]=n.value;else{if(!function(e){return"NullValue"===e.kind}(n))throw new s.ej(53);e[t.value]=null}}function v(e,t){var n=null;e.directives&&(n={},e.directives.forEach((function(e){n[e.name.value]={},e.arguments&&e.arguments.forEach((function(i){var s=i.name,r=i.value;return g(n[e.name.value],s,r,t)}))})));var i=null;return e.arguments&&e.arguments.length&&(i={},e.arguments.forEach((function(e){var n=e.name,s=e.value;return g(i,n,s,t)}))),b(e.name.value,i,n)}var y=["connection","include","skip","client","rest","export"];function b(e,t,n){if(t&&n&&n.connection&&n.connection.key){if(n.connection.filter&&n.connection.filter.length>0){var i=n.connection.filter?n.connection.filter:[];i.sort();var s={};return i.forEach((function(e){s[e]=t[e]})),n.connection.key+"("+JSON.stringify(s)+")"}return n.connection.key}var r=e;if(t){var o=p()(t);r+="("+o+")"}return n&&Object.keys(n).forEach((function(e){-1===y.indexOf(e)&&(n[e]&&Object.keys(n[e]).length?r+="@"+e+"("+JSON.stringify(n[e])+")":r+="@"+e)})),r}function S(e,t){if(e.arguments&&e.arguments.length){var n={};return e.arguments.forEach((function(e){var i=e.name,s=e.value;return g(n,i,s,t)})),n}return null}function E(e){return e.alias?e.alias.value:e.name.value}function T(e,t,n){if("string"==typeof e.__typename)return e.__typename;for(var i=0,s=t.selections;i<s.length;i++){var r=s[i];if(w(r)){if("__typename"===r.name.value)return e[E(r)]}else{var o=T(e,u(r,n).selectionSet,n);if("string"==typeof o)return o}}}function w(e){return"Field"===e.kind}function x(e){return"InlineFragment"===e.kind}function _(e){(0,s.kG)(e&&"Document"===e.kind,45);var t=e.definitions.filter((function(e){return"FragmentDefinition"!==e.kind})).map((function(e){if("OperationDefinition"!==e.kind)throw new s.ej(46);return e}));return(0,s.kG)(t.length<=1,47),e}function M(e){return _(e),e.definitions.filter((function(e){return"OperationDefinition"===e.kind}))[0]}function O(e){return e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&e.name})).map((function(e){return e.name.value}))[0]||null}function A(e){return e.definitions.filter((function(e){return"FragmentDefinition"===e.kind}))}function C(e){var t=M(e);return(0,s.kG)(t&&"query"===t.operation,48),t}function N(e){var t;_(e);for(var n=0,i=e.definitions;n<i.length;n++){var r=i[n];if("OperationDefinition"===r.kind){var o=r.operation;if("query"===o||"mutation"===o||"subscription"===o)return r}"FragmentDefinition"!==r.kind||t||(t=r)}if(t)return t;throw new s.ej(52)}function D(e){var t=Object.create(null),n=e&&e.variableDefinitions;return n&&n.length&&n.forEach((function(e){e.defaultValue&&g(t,e.variable.name,e.defaultValue)})),t}function I(e,t,n){var i=0;return e.forEach((function(n,s){t.call(this,n,s,e)&&(e[i++]=n)}),n),e.length=i,e}var L={kind:"Field",name:{kind:"Name",value:"__typename"}};function P(e,t){return e.selectionSet.selections.every((function(e){return"FragmentSpread"===e.kind&&P(t[e.name.value],t)}))}function R(e){return P(M(e)||function(e){(0,s.kG)("Document"===e.kind,49),(0,s.kG)(e.definitions.length<=1,50);var t=e.definitions[0];return(0,s.kG)("FragmentDefinition"===t.kind,51),t}(e),d(A(e)))?null:e}function k(e){return function(t){return e.some((function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)}))}}function U(e,t){var n=Object.create(null),s=[],r=Object.create(null),o=[],a=R((0,i.Vn)(t,{Variable:{enter:function(e,t,i){"VariableDefinition"!==i.kind&&(n[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some((function(e){return e.remove}))&&t.directives&&t.directives.some(k(e))))return t.arguments&&t.arguments.forEach((function(e){"Variable"===e.value.kind&&s.push({name:e.value.name.value})})),t.selectionSet&&H(t.selectionSet).forEach((function(e){o.push({name:e.name.value})})),null}},FragmentSpread:{enter:function(e){r[e.name.value]=!0}},Directive:{enter:function(t){if(k(e)(t))return null}}}));return a&&I(s,(function(e){return!!e.name&&!n[e.name]})).length&&(a=function(e,t){var n=function(e){return function(t){return e.some((function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))}))}}(e);return R((0,i.Vn)(t,{OperationDefinition:{enter:function(t){return(0,l.pi)((0,l.pi)({},t),{variableDefinitions:t.variableDefinitions?t.variableDefinitions.filter((function(t){return!e.some((function(e){return e.name===t.variable.name.value}))})):[]})}},Field:{enter:function(t){if(e.some((function(e){return e.remove}))){var i=0;if(t.arguments&&t.arguments.forEach((function(e){n(e)&&(i+=1)})),1===i)return null}}},Argument:{enter:function(e){if(n(e))return null}}}))}(s,a)),a&&I(o,(function(e){return!!e.name&&!r[e.name]})).length&&(a=function(e,t){function n(t){if(e.some((function(e){return e.name===t.name.value})))return null}return R((0,i.Vn)(t,{FragmentSpread:{enter:n},FragmentDefinition:{enter:n}}))}(o,a)),a}function B(e){return(0,i.Vn)(_(e),{SelectionSet:{enter:function(e,t,n){if(!n||"OperationDefinition"!==n.kind){var i=e.selections;if(i)if(!i.some((function(e){return w(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))}))){var s=n;if(!(w(s)&&s.directives&&s.directives.some((function(e){return"export"===e.name.value}))))return(0,l.pi)((0,l.pi)({},e),{selections:(0,l.pr)(i,[L])})}}}}})}B.added=function(e){return e===L};var F={test:function(e){var t="connection"===e.name.value;return t&&(!e.arguments||e.arguments.some((function(e){return"key"===e.name.value}))),t}};function V(e){return U([F],_(e))}function H(e){var t=[];return e.selections.forEach((function(e){(w(e)||x(e))&&e.selectionSet?H(e.selectionSet).forEach((function(e){return t.push(e)})):"FragmentSpread"===e.kind&&t.push(e)})),t}function j(e){return"query"===N(e).operation?e:(0,i.Vn)(e,{OperationDefinition:{enter:function(e){return(0,l.pi)((0,l.pi)({},e),{operation:"query"})}}})}function G(e){_(e);var t=U([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=(0,i.Vn)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every((function(e){return w(e)&&"__typename"===e.name.value})))return null}}})),t}var z=Object.prototype.hasOwnProperty;function W(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return K(e)}function K(e){var t=e[0]||{},n=e.length;if(n>1)for(var i=new Z,s=1;s<n;++s)t=i.merge(t,e[s]);return t}function Y(e){return null!==e&&"object"==typeof e}var q=function(e,t,n){return this.merge(e[n],t[n])},Z=function(){function e(e){void 0===e&&(e=q),this.reconciler=e,this.isObject=Y,this.pastCopies=new Set}return e.prototype.merge=function(e,t){for(var n=this,i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];return Y(t)&&Y(e)?(Object.keys(t).forEach((function(s){if(z.call(e,s)){var r=e[s];if(t[s]!==r){var o=n.reconciler.apply(n,(0,l.pr)([e,t,s],i));o!==r&&((e=n.shallowCopyForMerge(e))[s]=o)}}else(e=n.shallowCopyForMerge(e))[s]=t[s]})),e):t},e.prototype.shallowCopyForMerge=function(e){return Y(e)&&!this.pastCopies.has(e)&&(e=Array.isArray(e)?e.slice(0):(0,l.pi)({__proto__:Object.getPrototypeOf(e)},e),this.pastCopies.add(e)),e},e}();var $=n(49329),Q=n.n($);n(67121);Q().prototype["@@observable"]=function(){return this};var X=Object.prototype.toString;function J(e){return ee(e)}function ee(e,t){switch(X.call(e)){case"[object Array]":if((t=t||new Map).has(e))return t.get(e);var n=e.slice(0);return t.set(e,n),n.forEach((function(e,i){n[i]=ee(e,t)})),n;case"[object Object]":if((t=t||new Map).has(e))return t.get(e);var i=Object.create(Object.getPrototypeOf(e));return t.set(e,i),Object.keys(e).forEach((function(n){i[n]=ee(e[n],t)})),i;default:return e}}function te(e){return e}function ne(e,t,n){var i=[];e.forEach((function(e){return e[t]&&i.push(e)})),i.forEach((function(e){return e[t](n)}))}function ie(e,t,n){return new(Q())((function(i){var s=i.next,r=i.error,o=i.complete,a=0,l=!1;function c(e,t){return e?function(t){++a,new Promise((function(n){return n(e(t))})).then((function(e){--a,s&&s.call(i,e),l&&d.complete()}),(function(e){--a,r&&r.call(i,e)}))}:function(e){return t&&t.call(i,e)}}var d={next:c(t,s),error:c(n,r),complete:function(){l=!0,a||o&&o.call(i)}},u=e.subscribe(d);return function(){return u.unsubscribe()}}))}function se(e){function t(t){Object.defineProperty(e,t,{value:Q()})}return"function"==typeof Symbol&&Symbol.species&&t(Symbol.species),t("@@species"),e}function re(e){return e&&"function"==typeof e.then}var oe=function(e){function t(t){var n=e.call(this,(function(e){return n.addObserver(e),function(){return n.removeObserver(e)}}))||this;return n.observers=new Set,n.addCount=0,n.promise=new Promise((function(e,t){n.resolve=e,n.reject=t})),n.handlers={next:function(e){null!==n.sub&&(n.latest=["next",e],ne(n.observers,"next",e))},error:function(e){var t=n.sub;null!==t&&(t&&Promise.resolve().then((function(){return t.unsubscribe()})),n.sub=null,n.latest=["error",e],n.reject(e),ne(n.observers,"error",e))},complete:function(){if(null!==n.sub){var e=n.sources.shift();e?re(e)?e.then((function(e){return n.sub=e.subscribe(n.handlers)})):n.sub=e.subscribe(n.handlers):(n.sub=null,n.latest&&"next"===n.latest[0]?n.resolve(n.latest[1]):n.resolve(),ne(n.observers,"complete"))}}},n.cancel=function(e){n.reject(e),n.sources=[],n.handlers.complete()},n.promise.catch((function(e){})),"function"==typeof t&&(t=[new(Q())(t)]),re(t)?t.then((function(e){return n.start(e)}),n.handlers.error):n.start(t),n}return(0,l.ZT)(t,e),t.prototype.start=function(e){void 0===this.sub&&(this.sources=Array.from(e),this.handlers.complete())},t.prototype.deliverLastMessage=function(e){if(this.latest){var t=this.latest[0],n=e[t];n&&n.call(e,this.latest[1]),null===this.sub&&"next"===t&&e.complete&&e.complete()}},t.prototype.addObserver=function(e){this.observers.has(e)||(this.deliverLastMessage(e),this.observers.add(e),++this.addCount)},t.prototype.removeObserver=function(e,t){this.observers.delete(e)&&--this.addCount<1&&!t&&this.handlers.error(new Error("Observable cancelled prematurely"))},t.prototype.cleanup=function(e){var t=this,n=!1,i=function(){n||(n=!0,t.observers.delete(s),e())},s={next:i,error:i,complete:i},r=this.addCount;this.addObserver(s),this.addCount=r},t}(Q());function ae(e){return Array.isArray(e)&&e.length>0}function le(e){return e.errors&&e.errors.length>0||!1}se(oe);var ce="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product);function de(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object.create(null);return e.forEach((function(e){e&&Object.keys(e).forEach((function(t){var i=e[t];void 0!==i&&(n[t]=i)}))})),n}},85925:(e,t,n)=>{"use strict";n(29469)},57340:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m,A:()=>f});var i=n(67294),s=n(54929);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var s=p(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return h(this,n)}}function h(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(!e.prototype||!e.prototype.render)return e.__scuWrap||(e.__scuWrap=g(e,S));e.prototype.shouldComponentUpdate=y}function f(e){if(!e.prototype||!e.prototype.render)return e.__scuWrap||(e.__scuWrap=g(e,s.NK));e.prototype.shouldComponentUpdate=b}function g(e,t){var n=function(e){c(n,e);var t=u(n);function n(){return l(this,n),t.apply(this,arguments)}return a(n)}(v);return n.prototype.renderChild=e,n.prototype.diffFunc=t,n}var v=function(e){c(n,e);var t=u(n);function n(){return l(this,n),t.apply(this,arguments)}return a(n,[{key:"shouldComponentUpdate",value:function(e){return this.diffFunc(e,this.props)}},{key:"render",value:function(){return this.renderChild(this.props,this.context)}}]),n}(i.Component);function y(e,t){return S(e,this.props)||S(t,this.state)}function b(e,t){return S(e,this.props)||(0,s.NK)(t,this.state)}function S(e,t){for(var n in e)if(e[n]!==t[n])return!0;for(var i in t)if(!(i in e))return!0;return!1}},53825:(e,t,n)=>{"use strict";n.d(t,{_:()=>l,Fx:()=>p,rf:()=>d});var i=n(67294);const s="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;const r=function(e,t,n){var r=(0,i.useRef)(t);s((function(){r.current=t}),[t]),(0,i.useEffect)((function(){var t=(null==n?void 0:n.current)||window;if(t&&t.addEventListener){var i=function(e){return r.current(e)};return t.addEventListener(e,i),function(){t.removeEventListener(e,i)}}}),[e,n])};function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,s,r=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw s}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const l=function(e,t){var n=(0,i.useCallback)((function(){if("undefined"==typeof window)return t;try{var n=window.localStorage.getItem(e);return n?function(e){try{return"undefined"===e?void 0:JSON.parse(null!=e?e:"")}catch(t){return void console.log("parsing error on",{value:e})}}(n):t}catch(n){return console.warn("Error reading localStorage key “".concat(e,"”:"),n),t}}),[t,e]),s=o((0,i.useState)(n),2),a=s[0],l=s[1],c=(0,i.useCallback)((function(t){"undefined"==typeof window&&console.warn("Tried setting localStorage key “".concat(e,"” even though environment is not a client"));try{var n=t instanceof Function?t(a):t;window.localStorage.setItem(e,JSON.stringify(n)),l(n),window.dispatchEvent(new Event("local-storage"))}catch(t){console.warn("Error setting localStorage key “".concat(e,"”:"),t)}}),[e,a]);(0,i.useEffect)((function(){l(n())}),[]);var d=(0,i.useCallback)((function(){l(n())}),[n]);return r("storage",d),r("local-storage",d),[a,c]};const c=function(){var e=(0,i.useRef)(!0);return e.current?(e.current=!1,!0):e.current};const d=function(e,t){var n=c();(0,i.useEffect)((function(){if(!n)return e()}),t)};function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,s,r=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw s}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const p=function(e){var t=(0,i.useCallback)((function(){if("undefined"==typeof window)return null;try{var t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.warn("Error reading localStorage key “".concat(e,"”:"),t),null}}),[e]),n=u((0,i.useState)(t),2),s=n[0],o=n[1];(0,i.useEffect)((function(){o(t())}),[]);var a=(0,i.useCallback)((function(){o(t())}),[t]);return r("storage",a),r("local-storage",a),s}},17403:function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,s,r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Request=t.RequestQueue=t.RequestStatus=t.RequestPriority=void 0,function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e[e.HIGHEST=3]="HIGHEST"}(i=t.RequestPriority||(t.RequestPriority={})),function(e){e[e.PENDING=0]="PENDING",e[e.SENDING=1]="SENDING",e[e.FAILED=2]="FAILED",e[e.DONE=3]="DONE"}(s=t.RequestStatus||(t.RequestStatus={}));var o=new WeakMap;var a=function(){function e(e){var t=void 0===e?{}:e,n=t.retries,i=void 0===n?0:n,s=t.concurrency,r=void 0===s?6:s;this.totalBytesDownloaded=0,this.queue=[],this.retries=i,this.concurrency=r}return e.prototype.get=function(e,t){return this.request("GET",e,t)},e.prototype.head=function(e,t){return this.request("HEAD",e,t)},e.prototype.options=function(e,t){return this.request("OPTIONS",e,t)},e.prototype.post=function(e,t){return this.request("GET",e,t)},e.prototype.put=function(e,t){return this.request("PUT",e,t)},e.prototype.patch=function(e,t){return this.request("PATCH",e,t)},e.prototype.delete=function(e,t){return this.request("DELETE",e,t)},e.prototype.request=function(e,t,n){var i=this,r=new l(e,t,n);if(null==n?void 0:n.signal){var a=function(){i.queue.includes(r)&&(r.status===s.SENDING&&r.abort(),i.dequeue(r),r.onFail(new DOMException("Aborted","AbortError")))};n.signal.addEventListener("abort",a),o.set(r,(function(){n.signal.removeEventListener("abort",a),o.delete(r)}))}return this.enqueue(r),r.promise},e.prototype.update=function(){for(var e;e=this.getNextPendingRequest();)this.sendRequest(e);for(;e=this.getNextOverflowingGet();)e.abort(),e.status=s.PENDING;this.updateTimeout=null},e.prototype.enqueue=function(e){var t=this,n=0;for(n=0;n<this.queue.length;n++){if(this.queue[n].priority<e.priority)break}this.queue.splice(n,0,e),this.updateTimeout||(this.updateTimeout=window.setTimeout((function(){t.update()}),1))},e.prototype.dequeue=function(e){var t;null===(t=o.get(e))||void 0===t||t();var n=this.queue.indexOf(e);if(-1===n)throw new Error("Can't dequeue request not in queue");this.queue.splice(n,1),this.update()},e.prototype.getNextPendingRequest=function(){for(var e=0;e<this.queue.length&&e<this.concurrency;e++){var t=this.queue[e];if(t.status===s.PENDING)return t}return null},e.prototype.getNextOverflowingGet=function(){for(var e=this.concurrency;e<this.queue.length;e++){var t=this.queue[e];if(t.status===s.SENDING&&t.priority!==i.HIGHEST&&"GET"===t.method)return t}return null},e.prototype.shouldRetryStatusCode=function(t){return!e.doNotRetryStatusCodes[t]},e.prototype.sendRequest=function(e){var t=this;e.status=s.SENDING,e.send().then((function(n){e.status=s.DONE,t.dequeue(e),e.contentLength&&e.contentLength>0&&(t.totalBytesDownloaded+=Number(e.contentLength)),e.onDone(n)})).catch((function(i){var r=null!==e.maxRetries?e.maxRetries:t.retries,o=e.sendAttempts<r;if("object"===n(i)){var a=i.status_code||0;o=o&&t.shouldRetryStatusCode(a)}o?(e.status=s.PENDING,t.update(),console.warn("Retried ".concat(e.url)),console.warn(i)):(e.status=s.FAILED,t.dequeue(e),console.warn("Failed ".concat(e.url)),e.onFail(i))}))},e.doNotRetryStatusCodes={400:!0,401:!0,403:!0,404:!0,405:!0,406:!0,410:!0,411:!0,414:!0,415:!0,421:!0,431:!0,451:!0},e}();t.RequestQueue=a;var l=function(){function e(e,t,n){void 0===n&&(n={});var r=this;this.sendAttempts=0,this.status=s.PENDING,this.contentLength=0,this.url=t,this.method=e,this.auth=n.auth||null,this.withCredentials=n.withCredentials||!1,this.priority=n.priority||i.MEDIUM,this.responseType=n.responseType||null,this.body=n.body||null,this.headers=n.headers||{},this.maxRetries=n.maxRetries||null,this.onProgress=n.onProgress,this.promise=new Promise((function(e,t){r.onDone=e,r.onFail=t}))}return e.prototype.send=function(){var e=this,t=this.xhr=function(e,t,n){var i;if("undefined"!=typeof XMLHttpRequest)(i=new XMLHttpRequest).withCredentials=n;else{if("undefined"==typeof XDomainRequest)throw new Error("No XMLHTTPRequest or XDomainRequest... are you trying to run me in node? :(");i=new XDomainRequest}return i.open(e,t,!0),i}(this.method,this.url,this.withCredentials);if(this.responseType)if("arraybuffer"===this.responseType||"text"===this.responseType||"json"===this.responseType||"blob"===this.responseType)t.responseType=this.responseType;else{if("image"!==this.responseType)throw new Error('reponseType can only be one of "arraybuffer", "text", "json", "blob", "image"');t.responseType="blob"}for(var i in"json"===this.responseType&&t.setRequestHeader("Accept","application/json"),this.auth&&"string"==typeof this.auth&&t.setRequestHeader("Authorization",this.auth),this.headers)t.setRequestHeader(i,this.headers[i]);return this.body&&"object"===n(this.body)&&(this.body instanceof FormData||(this.body=JSON.stringify(this.body),t.setRequestHeader("Content-Type","application/json"))),this.onProgress&&(t.onprogress=this.onProgress),new Promise((function(n,i){t.onreadystatechange=function(s){if(4===t.readyState){if(200===t.status||201===t.status||204===t.status)return e.parseResponse(e.xhr).then((function(e){n(e)}));if(0!==t.status)return e.parseResponse(e.xhr).then((function(e){i(r({status_code:t.status},e))})).catch((function(){i({status_code:t.status})}))}},t.onerror=function(e){i(e)},t.send(e.body),e.sendAttempts++}))},e.prototype.parseResponse=function(e){var t=this;return new Promise((function(i,s){try{var r=e.response;if(t.contentLength=e.getResponseHeader("Content-Length"),"json"===t.responseType&&"object"!==n(r))i(JSON.parse(e.responseText));else if(200!==e.status&&201!==e.status&&204!==e.status||"image"!==t.responseType)i(r);else{var o=URL.createObjectURL(r);(r=new Image).src=o,r.crossOrigin="Anonymous",r.onload=function(){URL.revokeObjectURL(o),i(r)}}}catch(e){s({error:"Payload was not valid JSON"})}}))},e.prototype.abort=function(){if(null===this.xhr)throw new Error("Cannot abort unsent Request");this.xhr.abort()},e}();t.Request=l},21924:(e,t,n)=>{"use strict";var i=n(10492),s=n(55559),r=s(i("String.prototype.indexOf"));e.exports=function(e,t){var n=i(e,!!t);return"function"==typeof n&&r(e,".prototype.")>-1?s(n):n}},55559:(e,t,n)=>{"use strict";var i=n(58612),s=n(10492),r=s("%Function.prototype.apply%"),o=s("%Function.prototype.call%"),a=s("%Reflect.apply%",!0)||i.call(o,r),l=s("%Object.getOwnPropertyDescriptor%",!0),c=s("%Object.defineProperty%",!0),d=s("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=a(i,o,arguments);if(l&&c){var n=l(t,"length");n.configurable&&c(t,"length",{value:1+d(0,e.length-(arguments.length-1))})}return t};var u=function(){return a(i,r,arguments)};c?c(e.exports,"apply",{value:u}):e.exports.apply=u},10492:(e,t,n)=>{"use strict";var i,s=SyntaxError,r=Function,o=TypeError,a=function(e){try{return Function('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var c=function(){throw new o},d=l?function(){try{return c}catch(e){try{return l(arguments,"callee").get}catch(e){return c}}}():c,u=n(41405)(),h=Object.getPrototypeOf||function(e){return e.__proto__},p=a("async function* () {}"),m=p?p.prototype:i,f=m?m.prototype:i,g="undefined"==typeof Uint8Array?i:h(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":u?h([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":a("async function () {}"),"%AsyncGenerator%":m,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":f?h(f):i,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":r,"%GeneratorFunction%":a("function* () {}"),"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?h(h([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?h((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?h((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?h(""[Symbol.iterator]()):i,"%Symbol%":u?Symbol:i,"%SyntaxError%":s,"%ThrowTypeError%":d,"%TypedArray%":g,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=n(58612),S=n(17642),E=b.call(Function.call,Array.prototype.concat),T=b.call(Function.apply,Array.prototype.splice),w=b.call(Function.call,String.prototype.replace),x=b.call(Function.call,String.prototype.slice),_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M=/\\(\\)?/g,O=function(e){var t=x(e,0,1),n=x(e,-1);if("%"===t&&"%"!==n)throw new s("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new s("invalid intrinsic syntax, expected opening `%`");var i=[];return w(e,_,(function(e,t,n,s){i[i.length]=n?w(s,M,"$1"):t||e})),i},A=function(e,t){var n,i=e;if(S(y,i)&&(i="%"+(n=y[i])[0]+"%"),S(v,i)){var r=v[i];if(void 0===r&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:r}}throw new s("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');var n=O(e),i=n.length>0?n[0]:"",r=A("%"+i+"%",t),a=r.name,c=r.value,d=!1,u=r.alias;u&&(i=u[0],T(n,E([0,1],u)));for(var h=1,p=!0;h<n.length;h+=1){var m=n[h],f=x(m,0,1),g=x(m,-1);if(('"'===f||"'"===f||"`"===f||'"'===g||"'"===g||"`"===g)&&f!==g)throw new s("property names with quotes must have matching quotes");if("constructor"!==m&&p||(d=!0),S(v,a="%"+(i+="."+m)+"%"))c=v[a];else if(null!=c){if(!(m in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&h+1>=n.length){var y=l(c,m);c=(p=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:c[m]}else p=S(c,m),c=c[m];p&&!d&&(v[a]=c)}}return c}},94184:(e,t)=>{var n;!function(){"use strict";var i={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if("string"===r||"number"===r)e.push(n);else if(Array.isArray(n)){if(n.length){var o=s.apply(null,n);o&&e.push(o)}}else if("object"===r)if(n.toString===Object.prototype.toString)for(var a in n)i.call(n,a)&&n[a]&&e.push(a);else e.push(n.toString())}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(n=function(){return s}.apply(t,[]))||(e.exports=n)}()},5220:(e,t,n)=>{var i=n(8492);e.exports=i},1939:(e,t,n)=>{var i=n(5220);e.exports=i},19662:(e,t,n)=>{var i=n(17854),s=n(60614),r=n(66330),o=i.TypeError;e.exports=function(e){if(s(e))return e;throw o(r(e)+" is not a function")}},96077:(e,t,n)=>{var i=n(17854),s=n(60614),r=i.String,o=i.TypeError;e.exports=function(e){if("object"==typeof e||s(e))return e;throw o("Can't set "+r(e)+" as a prototype")}},51223:(e,t,n)=>{var i=n(5112),s=n(70030),r=n(3070),o=i("unscopables"),a=Array.prototype;null==a[o]&&r.f(a,o,{configurable:!0,value:s(null)}),e.exports=function(e){a[o][e]=!0}},25787:(e,t,n)=>{var i=n(17854),s=n(47976),r=i.TypeError;e.exports=function(e,t){if(s(t,e))return e;throw r("Incorrect invocation")}},19670:(e,t,n)=>{var i=n(17854),s=n(70111),r=i.String,o=i.TypeError;e.exports=function(e){if(s(e))return e;throw o(r(e)+" is not an object")}},41318:(e,t,n)=>{var i=n(45656),s=n(51400),r=n(26244),o=function(e){return function(t,n,o){var a,l=i(t),c=r(l),d=s(o,c);if(e&&n!=n){for(;c>d;)if((a=l[d++])!=a)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},41589:(e,t,n)=>{var i=n(17854),s=n(51400),r=n(26244),o=n(86135),a=i.Array,l=Math.max;e.exports=function(e,t,n){for(var i=r(e),c=s(t,i),d=s(void 0===n?i:n,i),u=a(l(d-c,0)),h=0;c<d;c++,h++)o(u,h,e[c]);return u.length=h,u}},94362:(e,t,n)=>{var i=n(41589),s=Math.floor,r=function(e,t){var n=e.length,l=s(n/2);return n<8?o(e,t):a(e,r(i(e,0,l),t),r(i(e,l),t),t)},o=function(e,t){for(var n,i,s=e.length,r=1;r<s;){for(i=r,n=e[r];i&&t(e[i-1],n)>0;)e[i]=e[--i];i!==r++&&(e[i]=n)}return e},a=function(e,t,n,i){for(var s=t.length,r=n.length,o=0,a=0;o<s||a<r;)e[o+a]=o<s&&a<r?i(t[o],n[a])<=0?t[o++]:n[a++]:o<s?t[o++]:n[a++];return e};e.exports=r},84326:(e,t,n)=>{var i=n(1702),s=i({}.toString),r=i("".slice);e.exports=function(e){return r(s(e),8,-1)}},70648:(e,t,n)=>{var i=n(17854),s=n(51694),r=n(60614),o=n(84326),a=n(5112)("toStringTag"),l=i.Object,c="Arguments"==o(function(){return arguments}());e.exports=s?o:function(e){var t,n,i;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=l(e),a))?n:c?o(t):"Object"==(i=o(t))&&r(t.callee)?"Arguments":i}},99920:(e,t,n)=>{var i=n(92597),s=n(53887),r=n(31236),o=n(3070);e.exports=function(e,t,n){for(var a=s(t),l=o.f,c=r.f,d=0;d<a.length;d++){var u=a[d];i(e,u)||n&&i(n,u)||l(e,u,c(t,u))}}},49920:(e,t,n)=>{var i=n(47293);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},24994:(e,t,n)=>{"use strict";var i=n(13383).IteratorPrototype,s=n(70030),r=n(79114),o=n(58003),a=n(97497),l=function(){return this};e.exports=function(e,t,n,c){var d=t+" Iterator";return e.prototype=s(i,{next:r(+!c,n)}),o(e,d,!1,!0),a[d]=l,e}},68880:(e,t,n)=>{var i=n(19781),s=n(3070),r=n(79114);e.exports=i?function(e,t,n){return s.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},79114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},86135:(e,t,n)=>{"use strict";var i=n(34948),s=n(3070),r=n(79114);e.exports=function(e,t,n){var o=i(t);o in e?s.f(e,o,r(0,n)):e[o]=n}},70654:(e,t,n)=>{"use strict";var i=n(82109),s=n(46916),r=n(31913),o=n(76530),a=n(60614),l=n(24994),c=n(79518),d=n(27674),u=n(58003),h=n(68880),p=n(31320),m=n(5112),f=n(97497),g=n(13383),v=o.PROPER,y=o.CONFIGURABLE,b=g.IteratorPrototype,S=g.BUGGY_SAFARI_ITERATORS,E=m("iterator"),T="keys",w="values",x="entries",_=function(){return this};e.exports=function(e,t,n,o,m,g,M){l(n,t,o);var O,A,C,N=function(e){if(e===m&&R)return R;if(!S&&e in L)return L[e];switch(e){case T:case w:case x:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",I=!1,L=e.prototype,P=L[E]||L["@@iterator"]||m&&L[m],R=!S&&P||N(m),k="Array"==t&&L.entries||P;if(k&&(O=c(k.call(new e)))!==Object.prototype&&O.next&&(r||c(O)===b||(d?d(O,b):a(O[E])||p(O,E,_)),u(O,D,!0,!0),r&&(f[D]=_)),v&&m==w&&P&&P.name!==w&&(!r&&y?h(L,"name",w):(I=!0,R=function(){return s(P,this)})),m)if(A={values:N(w),keys:g?R:N(T),entries:N(x)},M)for(C in A)(S||I||!(C in L))&&p(L,C,A[C]);else i({target:t,proto:!0,forced:S||I},A);return r&&!M||L[E]===R||p(L,E,R,{name:m}),f[t]=R,A}},19781:(e,t,n)=>{var i=n(47293);e.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},80317:(e,t,n)=>{var i=n(17854),s=n(70111),r=i.document,o=s(r)&&s(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},48324:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},98509:(e,t,n)=>{var i=n(80317)("span").classList,s=i&&i.constructor&&i.constructor.prototype;e.exports=s===Object.prototype?void 0:s},88113:(e,t,n)=>{var i=n(35005);e.exports=i("navigator","userAgent")||""},7392:(e,t,n)=>{var i,s,r=n(17854),o=n(88113),a=r.process,l=r.Deno,c=a&&a.versions||l&&l.version,d=c&&c.v8;d&&(s=(i=d.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!s&&o&&(!(i=o.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=o.match(/Chrome\/(\d+)/))&&(s=+i[1]),e.exports=s},80748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},82109:(e,t,n)=>{var i=n(17854),s=n(31236).f,r=n(68880),o=n(31320),a=n(83505),l=n(99920),c=n(54705);e.exports=function(e,t){var n,d,u,h,p,m=e.target,f=e.global,g=e.stat;if(n=f?i:g?i[m]||a(m,{}):(i[m]||{}).prototype)for(d in t){if(h=t[d],u=e.noTargetGet?(p=s(n,d))&&p.value:n[d],!c(f?d:m+(g?".":"#")+d,e.forced)&&void 0!==u){if(typeof h==typeof u)continue;l(h,u)}(e.sham||u&&u.sham)&&r(h,"sham",!0),o(n,d,h,e)}}},47293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},49974:(e,t,n)=>{var i=n(1702),s=n(19662),r=i(i.bind);e.exports=function(e,t){return s(e),void 0===t?e:r?r(e,t):function(){return e.apply(t,arguments)}}},46916:e=>{var t=Function.prototype.call;e.exports=t.bind?t.bind(t):function(){return t.apply(t,arguments)}},76530:(e,t,n)=>{var i=n(19781),s=n(92597),r=Function.prototype,o=i&&Object.getOwnPropertyDescriptor,a=s(r,"name"),l=a&&"something"===function(){}.name,c=a&&(!i||i&&o(r,"name").configurable);e.exports={EXISTS:a,PROPER:l,CONFIGURABLE:c}},1702:e=>{var t=Function.prototype,n=t.bind,i=t.call,s=n&&n.bind(i,i);e.exports=n?function(e){return e&&s(e)}:function(e){return e&&function(){return i.apply(e,arguments)}}},35005:(e,t,n)=>{var i=n(17854),s=n(60614),r=function(e){return s(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?r(i[e]):i[e]&&i[e][t]}},71246:(e,t,n)=>{var i=n(70648),s=n(58173),r=n(97497),o=n(5112)("iterator");e.exports=function(e){if(null!=e)return s(e,o)||s(e,"@@iterator")||r[i(e)]}},18554:(e,t,n)=>{var i=n(17854),s=n(46916),r=n(19662),o=n(19670),a=n(66330),l=n(71246),c=i.TypeError;e.exports=function(e,t){var n=arguments.length<2?l(e):t;if(r(n))return o(s(n,e));throw c(a(e)+" is not iterable")}},58173:(e,t,n)=>{var i=n(19662);e.exports=function(e,t){var n=e[t];return null==n?void 0:i(n)}},17854:(e,t,n)=>{var i=function(e){return e&&e.Math==Math&&e};e.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},92597:(e,t,n)=>{var i=n(1702),s=n(47908),r=i({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return r(s(e),t)}},3501:e=>{e.exports={}},60490:(e,t,n)=>{var i=n(35005);e.exports=i("document","documentElement")},64664:(e,t,n)=>{var i=n(19781),s=n(47293),r=n(80317);e.exports=!i&&!s((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},68361:(e,t,n)=>{var i=n(17854),s=n(1702),r=n(47293),o=n(84326),a=i.Object,l=s("".split);e.exports=r((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?l(e,""):a(e)}:a},42788:(e,t,n)=>{var i=n(1702),s=n(60614),r=n(5465),o=i(Function.toString);s(r.inspectSource)||(r.inspectSource=function(e){return o(e)}),e.exports=r.inspectSource},29909:(e,t,n)=>{var i,s,r,o=n(68536),a=n(17854),l=n(1702),c=n(70111),d=n(68880),u=n(92597),h=n(5465),p=n(6200),m=n(3501),f="Object already initialized",g=a.TypeError,v=a.WeakMap;if(o||h.state){var y=h.state||(h.state=new v),b=l(y.get),S=l(y.has),E=l(y.set);i=function(e,t){if(S(y,e))throw new g(f);return t.facade=e,E(y,e,t),t},s=function(e){return b(y,e)||{}},r=function(e){return S(y,e)}}else{var T=p("state");m[T]=!0,i=function(e,t){if(u(e,T))throw new g(f);return t.facade=e,d(e,T,t),t},s=function(e){return u(e,T)?e[T]:{}},r=function(e){return u(e,T)}}e.exports={set:i,get:s,has:r,enforce:function(e){return r(e)?s(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=s(t)).type!==e)throw g("Incompatible receiver, "+e+" required");return n}}}},60614:e=>{e.exports=function(e){return"function"==typeof e}},54705:(e,t,n)=>{var i=n(47293),s=n(60614),r=/#|\.prototype\./,o=function(e,t){var n=l[a(e)];return n==d||n!=c&&(s(t)?i(t):!!t)},a=o.normalize=function(e){return String(e).replace(r,".").toLowerCase()},l=o.data={},c=o.NATIVE="N",d=o.POLYFILL="P";e.exports=o},70111:(e,t,n)=>{var i=n(60614);e.exports=function(e){return"object"==typeof e?null!==e:i(e)}},31913:e=>{e.exports=!1},52190:(e,t,n)=>{var i=n(17854),s=n(35005),r=n(60614),o=n(47976),a=n(43307),l=i.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=s("Symbol");return r(t)&&o(t.prototype,l(e))}},13383:(e,t,n)=>{"use strict";var i,s,r,o=n(47293),a=n(60614),l=n(70030),c=n(79518),d=n(31320),u=n(5112),h=n(31913),p=u("iterator"),m=!1;[].keys&&("next"in(r=[].keys())?(s=c(c(r)))!==Object.prototype&&(i=s):m=!0),null==i||o((function(){var e={};return i[p].call(e)!==e}))?i={}:h&&(i=l(i)),a(i[p])||d(i,p,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:m}},97497:e=>{e.exports={}},26244:(e,t,n)=>{var i=n(17466);e.exports=function(e){return i(e.length)}},30133:(e,t,n)=>{var i=n(7392),s=n(47293);e.exports=!!Object.getOwnPropertySymbols&&!s((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&i&&i<41}))},590:(e,t,n)=>{var i=n(47293),s=n(5112),r=n(31913),o=s("iterator");e.exports=!i((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,i){t.delete("b"),n+=i+e})),r&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[o]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},68536:(e,t,n)=>{var i=n(17854),s=n(60614),r=n(42788),o=i.WeakMap;e.exports=s(o)&&/native code/.test(r(o))},70030:(e,t,n)=>{var i,s=n(19670),r=n(36048),o=n(80748),a=n(3501),l=n(60490),c=n(80317),d=n(6200),u=d("IE_PROTO"),h=function(){},p=function(e){return"<script>"+e+"</"+"script>"},m=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{i=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&i?m(i):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F):m(i);for(var n=o.length;n--;)delete f.prototype[o[n]];return f()};a[u]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(h.prototype=s(e),n=new h,h.prototype=null,n[u]=e):n=f(),void 0===t?n:r.f(n,t)}},36048:(e,t,n)=>{var i=n(19781),s=n(3353),r=n(3070),o=n(19670),a=n(45656),l=n(81956);t.f=i&&!s?Object.defineProperties:function(e,t){o(e);for(var n,i=a(t),s=l(t),c=s.length,d=0;c>d;)r.f(e,n=s[d++],i[n]);return e}},3070:(e,t,n)=>{var i=n(17854),s=n(19781),r=n(64664),o=n(3353),a=n(19670),l=n(34948),c=i.TypeError,d=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",p="configurable",m="writable";t.f=s?o?function(e,t,n){if(a(e),t=l(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&m in n&&!n.writable){var i=u(e,t);i&&i.writable&&(e[t]=n.value,n={configurable:p in n?n.configurable:i.configurable,enumerable:h in n?n.enumerable:i.enumerable,writable:!1})}return d(e,t,n)}:d:function(e,t,n){if(a(e),t=l(t),a(n),r)try{return d(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},31236:(e,t,n)=>{var i=n(19781),s=n(46916),r=n(55296),o=n(79114),a=n(45656),l=n(34948),c=n(92597),d=n(64664),u=Object.getOwnPropertyDescriptor;t.f=i?u:function(e,t){if(e=a(e),t=l(t),d)try{return u(e,t)}catch(e){}if(c(e,t))return o(!s(r.f,e,t),e[t])}},8006:(e,t,n)=>{var i=n(16324),s=n(80748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,s)}},25181:(e,t)=>{t.f=Object.getOwnPropertySymbols},79518:(e,t,n)=>{var i=n(17854),s=n(92597),r=n(60614),o=n(47908),a=n(6200),l=n(49920),c=a("IE_PROTO"),d=i.Object,u=d.prototype;e.exports=l?d.getPrototypeOf:function(e){var t=o(e);if(s(t,c))return t[c];var n=t.constructor;return r(n)&&t instanceof n?n.prototype:t instanceof d?u:null}},47976:(e,t,n)=>{var i=n(1702);e.exports=i({}.isPrototypeOf)},16324:(e,t,n)=>{var i=n(1702),s=n(92597),r=n(45656),o=n(41318).indexOf,a=n(3501),l=i([].push);e.exports=function(e,t){var n,i=r(e),c=0,d=[];for(n in i)!s(a,n)&&s(i,n)&&l(d,n);for(;t.length>c;)s(i,n=t[c++])&&(~o(d,n)||l(d,n));return d}},81956:(e,t,n)=>{var i=n(16324),s=n(80748);e.exports=Object.keys||function(e){return i(e,s)}},55296:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!n.call({1:2},1);t.f=s?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},27674:(e,t,n)=>{var i=n(1702),s=n(19670),r=n(96077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=i(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,i){return s(n),r(i),t?e(n,i):n.__proto__=i,n}}():void 0)},92140:(e,t,n)=>{var i=n(17854),s=n(46916),r=n(60614),o=n(70111),a=i.TypeError;e.exports=function(e,t){var n,i;if("string"===t&&r(n=e.toString)&&!o(i=s(n,e)))return i;if(r(n=e.valueOf)&&!o(i=s(n,e)))return i;if("string"!==t&&r(n=e.toString)&&!o(i=s(n,e)))return i;throw a("Can't convert object to primitive value")}},53887:(e,t,n)=>{var i=n(35005),s=n(1702),r=n(8006),o=n(25181),a=n(19670),l=s([].concat);e.exports=i("Reflect","ownKeys")||function(e){var t=r.f(a(e)),n=o.f;return n?l(t,n(e)):t}},40857:(e,t,n)=>{var i=n(17854);e.exports=i},12248:(e,t,n)=>{var i=n(31320);e.exports=function(e,t,n){for(var s in t)i(e,s,t[s],n);return e}},31320:(e,t,n)=>{var i=n(17854),s=n(60614),r=n(92597),o=n(68880),a=n(83505),l=n(42788),c=n(29909),d=n(76530).CONFIGURABLE,u=c.get,h=c.enforce,p=String(String).split("String");(e.exports=function(e,t,n,l){var c,u=!!l&&!!l.unsafe,m=!!l&&!!l.enumerable,f=!!l&&!!l.noTargetGet,g=l&&void 0!==l.name?l.name:t;s(n)&&("Symbol("===String(g).slice(0,7)&&(g="["+String(g).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!r(n,"name")||d&&n.name!==g)&&o(n,"name",g),(c=h(n)).source||(c.source=p.join("string"==typeof g?g:""))),e!==i?(u?!f&&e[t]&&(m=!0):delete e[t],m?e[t]=n:o(e,t,n)):m?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return s(this)&&u(this).source||l(this)}))},84488:(e,t,n)=>{var i=n(17854).TypeError;e.exports=function(e){if(null==e)throw i("Can't call method on "+e);return e}},83505:(e,t,n)=>{var i=n(17854),s=Object.defineProperty;e.exports=function(e,t){try{s(i,e,{value:t,configurable:!0,writable:!0})}catch(n){i[e]=t}return t}},58003:(e,t,n)=>{var i=n(3070).f,s=n(92597),r=n(5112)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!s(e,r)&&i(e,r,{configurable:!0,value:t})}},6200:(e,t,n)=>{var i=n(72309),s=n(69711),r=i("keys");e.exports=function(e){return r[e]||(r[e]=s(e))}},5465:(e,t,n)=>{var i=n(17854),s=n(83505),r="__core-js_shared__",o=i[r]||s(r,{});e.exports=o},72309:(e,t,n)=>{var i=n(31913),s=n(5465);(e.exports=function(e,t){return s[e]||(s[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.2",mode:i?"pure":"global",copyright:"© 2022 Denis Pushkarev (zloirock.ru)"})},51400:(e,t,n)=>{var i=n(19303),s=Math.max,r=Math.min;e.exports=function(e,t){var n=i(e);return n<0?s(n+t,0):r(n,t)}},45656:(e,t,n)=>{var i=n(68361),s=n(84488);e.exports=function(e){return i(s(e))}},19303:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var i=+e;return i!=i||0===i?0:(i>0?n:t)(i)}},17466:(e,t,n)=>{var i=n(19303),s=Math.min;e.exports=function(e){return e>0?s(i(e),9007199254740991):0}},47908:(e,t,n)=>{var i=n(17854),s=n(84488),r=i.Object;e.exports=function(e){return r(s(e))}},57593:(e,t,n)=>{var i=n(17854),s=n(46916),r=n(70111),o=n(52190),a=n(58173),l=n(92140),c=n(5112),d=i.TypeError,u=c("toPrimitive");e.exports=function(e,t){if(!r(e)||o(e))return e;var n,i=a(e,u);if(i){if(void 0===t&&(t="default"),n=s(i,e,t),!r(n)||o(n))return n;throw d("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},34948:(e,t,n)=>{var i=n(57593),s=n(52190);e.exports=function(e){var t=i(e,"string");return s(t)?t:t+""}},51694:(e,t,n)=>{var i={};i[n(5112)("toStringTag")]="z",e.exports="[object z]"===String(i)},41340:(e,t,n)=>{var i=n(17854),s=n(70648),r=i.String;e.exports=function(e){if("Symbol"===s(e))throw TypeError("Cannot convert a Symbol value to a string");return r(e)}},66330:(e,t,n)=>{var i=n(17854).String;e.exports=function(e){try{return i(e)}catch(e){return"Object"}}},69711:(e,t,n)=>{var i=n(1702),s=0,r=Math.random(),o=i(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++s+r,36)}},43307:(e,t,n)=>{var i=n(30133);e.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(e,t,n)=>{var i=n(19781),s=n(47293);e.exports=i&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},5112:(e,t,n)=>{var i=n(17854),s=n(72309),r=n(92597),o=n(69711),a=n(30133),l=n(43307),c=s("wks"),d=i.Symbol,u=d&&d.for,h=l?d:d&&d.withoutSetter||o;e.exports=function(e){if(!r(c,e)||!a&&"string"!=typeof c[e]){var t="Symbol."+e;a&&r(d,e)?c[e]=d[e]:c[e]=l&&u?u(t):h(t)}return c[e]}},66992:(e,t,n)=>{"use strict";var i=n(45656),s=n(51223),r=n(97497),o=n(29909),a=n(3070).f,l=n(70654),c=n(31913),d=n(19781),u="Array Iterator",h=o.set,p=o.getterFor(u);e.exports=l(Array,"Array",(function(e,t){h(this,{type:u,target:i(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values");var m=r.Arguments=r.Array;if(s("keys"),s("values"),s("entries"),!c&&d&&"values"!==m.name)try{a(m,"name",{value:"values"})}catch(e){}},33948:(e,t,n)=>{var i=n(17854),s=n(48324),r=n(98509),o=n(66992),a=n(68880),l=n(5112),c=l("iterator"),d=l("toStringTag"),u=o.values,h=function(e,t){if(e){if(e[c]!==u)try{a(e,c,u)}catch(t){e[c]=u}if(e[d]||a(e,d,t),s[t])for(var n in o)if(e[n]!==o[n])try{a(e,n,o[n])}catch(t){e[n]=o[n]}}};for(var p in s)h(i[p]&&i[p].prototype,p);h(r,"DOMTokenList")},41637:(e,t,n)=>{"use strict";n(66992);var i=n(82109),s=n(17854),r=n(35005),o=n(46916),a=n(1702),l=n(590),c=n(31320),d=n(12248),u=n(58003),h=n(24994),p=n(29909),m=n(25787),f=n(60614),g=n(92597),v=n(49974),y=n(70648),b=n(19670),S=n(70111),E=n(41340),T=n(70030),w=n(79114),x=n(18554),_=n(71246),M=n(5112),O=n(94362),A=M("iterator"),C="URLSearchParams",N="URLSearchParamsIterator",D=p.set,I=p.getterFor(C),L=p.getterFor(N),P=r("fetch"),R=r("Request"),k=r("Headers"),U=R&&R.prototype,B=k&&k.prototype,F=s.RegExp,V=s.TypeError,H=s.decodeURIComponent,j=s.encodeURIComponent,G=a("".charAt),z=a([].join),W=a([].push),K=a("".replace),Y=a([].shift),q=a([].splice),Z=a("".split),$=a("".slice),Q=/\+/g,X=Array(4),J=function(e){return X[e-1]||(X[e-1]=F("((?:%[\\da-f]{2}){"+e+"})","gi"))},ee=function(e){try{return H(e)}catch(t){return e}},te=function(e){var t=K(e,Q," "),n=4;try{return H(t)}catch(e){for(;n;)t=K(t,J(n--),ee);return t}},ne=/[!'()~]|%20/g,ie={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},se=function(e){return ie[e]},re=function(e){return K(j(e),ne,se)},oe=function(e,t){if(e<t)throw V("Not enough arguments")},ae=h((function(e,t){D(this,{type:N,iterator:x(I(e).entries),kind:t})}),"Iterator",(function(){var e=L(this),t=e.kind,n=e.iterator.next(),i=n.value;return n.done||(n.value="keys"===t?i.key:"values"===t?i.value:[i.key,i.value]),n}),!0),le=function(e){this.entries=[],this.url=null,void 0!==e&&(S(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===G(e,0)?$(e,1):e:E(e)))};le.prototype={type:C,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,i,s,r,a,l,c=_(e);if(c)for(n=(t=x(e,c)).next;!(i=o(n,t)).done;){if(r=(s=x(b(i.value))).next,(a=o(r,s)).done||(l=o(r,s)).done||!o(r,s).done)throw V("Expected sequence with length 2");W(this.entries,{key:E(a.value),value:E(l.value)})}else for(var d in e)g(e,d)&&W(this.entries,{key:d,value:E(e[d])})},parseQuery:function(e){if(e)for(var t,n,i=Z(e,"&"),s=0;s<i.length;)(t=i[s++]).length&&(n=Z(t,"="),W(this.entries,{key:te(Y(n)),value:te(z(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],i=0;i<t.length;)e=t[i++],W(n,re(e.key)+"="+re(e.value));return z(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var ce=function(){m(this,de);var e=arguments.length>0?arguments[0]:void 0;D(this,new le(e))},de=ce.prototype;if(d(de,{append:function(e,t){oe(arguments.length,2);var n=I(this);W(n.entries,{key:E(e),value:E(t)}),n.updateURL()},delete:function(e){oe(arguments.length,1);for(var t=I(this),n=t.entries,i=E(e),s=0;s<n.length;)n[s].key===i?q(n,s,1):s++;t.updateURL()},get:function(e){oe(arguments.length,1);for(var t=I(this).entries,n=E(e),i=0;i<t.length;i++)if(t[i].key===n)return t[i].value;return null},getAll:function(e){oe(arguments.length,1);for(var t=I(this).entries,n=E(e),i=[],s=0;s<t.length;s++)t[s].key===n&&W(i,t[s].value);return i},has:function(e){oe(arguments.length,1);for(var t=I(this).entries,n=E(e),i=0;i<t.length;)if(t[i++].key===n)return!0;return!1},set:function(e,t){oe(arguments.length,1);for(var n,i=I(this),s=i.entries,r=!1,o=E(e),a=E(t),l=0;l<s.length;l++)(n=s[l]).key===o&&(r?q(s,l--,1):(r=!0,n.value=a));r||W(s,{key:o,value:a}),i.updateURL()},sort:function(){var e=I(this);O(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=I(this).entries,i=v(e,arguments.length>1?arguments[1]:void 0),s=0;s<n.length;)i((t=n[s++]).value,t.key,this)},keys:function(){return new ae(this,"keys")},values:function(){return new ae(this,"values")},entries:function(){return new ae(this,"entries")}},{enumerable:!0}),c(de,A,de.entries,{name:"entries"}),c(de,"toString",(function(){return I(this).serialize()}),{enumerable:!0}),u(ce,C),i({global:!0,forced:!l},{URLSearchParams:ce}),!l&&f(k)){var ue=a(B.has),he=a(B.set),pe=function(e){if(S(e)){var t,n=e.body;if(y(n)===C)return t=e.headers?new k(e.headers):new k,ue(t,"content-type")||he(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),T(e,{body:w(0,E(n)),headers:w(0,t)})}return e};if(f(P)&&i({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return P(e,arguments.length>1?pe(arguments[1]):{})}}),f(R)){var me=function(e){return m(this,U),new R(e,arguments.length>1?pe(arguments[1]):{})};U.constructor=me,me.prototype=U,i({global:!0,forced:!0},{Request:me})}}e.exports={URLSearchParams:ce,getState:I}},8492:(e,t,n)=>{var i=n(98504);n(33948),e.exports=i},98504:(e,t,n)=>{n(41637);var i=n(40857);e.exports=i.URLSearchParams},4289:(e,t,n)=>{"use strict";var i=n(82215),s="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),r=Object.prototype.toString,o=Array.prototype.concat,a=Object.defineProperty,l=a&&function(){var e={};try{for(var t in a(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}(),c=function(e,t,n,i){var s;(!(t in e)||"function"==typeof(s=i)&&"[object Function]"===r.call(s)&&i())&&(l?a(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},d=function(e,t){var n=arguments.length>2?arguments[2]:{},r=i(t);s&&(r=o.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)c(e,r[a],t[r[a]],n[r[a]])};d.supportsDescriptors=!!l,e.exports=d},35035:e=>{"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,i="boolean"==typeof t.cycles&&t.cycles,s=t.cmp&&(n=t.cmp,function(e){return function(t,i){var s={key:t,value:e[t]},r={key:i,value:e[i]};return n(s,r)}}),r=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==r.indexOf(t)){if(i)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=r.push(t)-1,l=Object.keys(t).sort(s&&s(t));for(o="",n=0;n<l.length;n++){var c=l[n],d=e(t[c]);d&&(o&&(o+=","),o+=JSON.stringify(c)+":"+d)}return r.splice(a,1),"{"+o+"}"}}(e)}},94029:(e,t,n)=>{"use strict";var i=n(95320),s=Object.prototype.toString,r=Object.prototype.hasOwnProperty,o=function(e,t,n){for(var i=0,s=e.length;i<s;i++)r.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))},a=function(e,t,n){for(var i=0,s=e.length;i<s;i++)null==n?t(e.charAt(i),i,e):t.call(n,e.charAt(i),i,e)},l=function(e,t,n){for(var i in e)r.call(e,i)&&(null==n?t(e[i],i,e):t.call(n,e[i],i,e))};e.exports=function(e,t,n){if(!i(t))throw new TypeError("iterator must be a function");var r;arguments.length>=3&&(r=n),"[object Array]"===s.call(e)?o(e,t,r):"string"==typeof e?a(e,t,r):l(e,t,r)}},17648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,i=Object.prototype.toString,s="[object Function]";e.exports=function(e){var r=this;if("function"!=typeof r||i.call(r)!==s)throw new TypeError(t+r);for(var o,a=n.call(arguments,1),l=function(){if(this instanceof o){var t=r.apply(this,a.concat(n.call(arguments)));return Object(t)===t?t:this}return r.apply(e,a.concat(n.call(arguments)))},c=Math.max(0,r.length-a.length),d=[],u=0;u<c;u++)d.push("$"+u);if(o=Function("binder","return function ("+d.join(",")+"){ return binder.apply(this,arguments); }")(l),r.prototype){var h=function(){};h.prototype=r.prototype,o.prototype=new h,h.prototype=null}return o}},58612:(e,t,n)=>{"use strict";var i=n(17648);e.exports=Function.prototype.bind||i},50972:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.prototype.toJSON;"function"==typeof t||(0,i.default)(0),e.prototype.inspect=t,s.default&&(e.prototype[s.default]=t)};var i=r(n(7706)),s=r(n(79466));function r(e){return e&&e.__esModule?e:{default:e}}},8002:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return o(e,[])};var i,s=(i=n(79466))&&i.__esModule?i:{default:i};function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){switch(r(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var n=[].concat(t,[e]),i=function(e){var t=e[String(s.default)];if("function"==typeof t)return t;if("function"==typeof e.inspect)return e.inspect}(e);if(void 0!==i){var r=i.call(e);if(r!==e)return"string"==typeof r?r:o(r,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";for(var n=Math.min(10,e.length),i=e.length-n,s=[],r=0;r<n;++r)s.push(o(e[r],t));1===i?s.push("... 1 more item"):i>1&&s.push("... ".concat(i," more items"));return"["+s.join(", ")+"]"}(e,n);return function(e,t){var n=Object.keys(e);if(0===n.length)return"{}";if(t.length>2)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return t}(e)+"]";return"{ "+n.map((function(n){return n+": "+o(e[n],t)})).join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}},6589:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(97986);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return o(e,[])}function o(e,t){switch(s(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var n=[].concat(t,[e]),s=function(e){var t=e[String(i.Z)];if("function"==typeof t)return t;if("function"==typeof e.inspect)return e.inspect}(e);if(void 0!==s){var r=s.call(e);if(r!==e)return"string"==typeof r?r:o(r,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";for(var n=Math.min(10,e.length),i=e.length-n,s=[],r=0;r<n;++r)s.push(o(e[r],t));1===i?s.push("... 1 more item"):i>1&&s.push("... ".concat(i," more items"));return"["+s.join(", ")+"]"}(e,n);return function(e,t){var n=Object.keys(e);if(0===n.length)return"{}";if(t.length>2)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return t}(e)+"]";return"{ "+n.map((function(n){return n+": "+o(e[n],t)})).join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}},7706:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!Boolean(e))throw new Error(null!=t?t:"Unexpected invariant triggered.")}},79466:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;t.default=n},97986:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0},91807:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNode=function(e){return null!=e&&"string"==typeof e.kind},t.Token=t.Location=void 0;var i,s=(i=n(50972))&&i.__esModule?i:{default:i};var r=function(){function e(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}return e.prototype.toJSON=function(){return{start:this.start,end:this.end}},e}();t.Location=r,(0,s.default)(r);var o=function(){function e(e,t,n,i,s,r,o){this.kind=e,this.start=t,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=r,this.next=null}return e.prototype.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();t.Token=o,(0,s.default)(o)},83059:(e,t,n)=>{"use strict";n.d(t,{Ye:()=>r,WU:()=>o,UG:()=>a});var i=n(97986);function s(e){var t=e.prototype.toJSON;"function"==typeof t||function(e,t){if(!Boolean(e))throw new Error(null!=t?t:"Unexpected invariant triggered.")}(0),e.prototype.inspect=t,i.Z&&(e.prototype[i.Z]=t)}var r=function(){function e(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}return e.prototype.toJSON=function(){return{start:this.start,end:this.end}},e}();s(r);var o=function(){function e(e,t,n,i,s,r,o){this.kind=e,this.start=t,this.end=n,this.line=i,this.column=s,this.value=o,this.prev=r,this.next=null}return e.prototype.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();function a(e){return null!=e&&"string"==typeof e.kind}s(o)},7420:(e,t,n)=>{"use strict";function i(e){var t=e.split(/\r\n|[\n\r]/g),n=function(e){for(var t,n=!0,i=!0,s=0,r=null,o=0;o<e.length;++o)switch(e.charCodeAt(o)){case 13:10===e.charCodeAt(o+1)&&++o;case 10:n=!1,i=!0,s=0;break;case 9:case 32:++s;break;default:i&&!n&&(null===r||s<r)&&(r=s),i=!1}return null!==(t=r)&&void 0!==t?t:0}(e);if(0!==n)for(var i=1;i<t.length;i++)t[i]=t[i].slice(n);for(var r=0;r<t.length&&s(t[r]);)++r;for(var o=t.length;o>r&&s(t[o-1]);)--o;return t.slice(r,o).join("\n")}function s(e){for(var t=0;t<e.length;++t)if(" "!==e[t]&&"\t"!==e[t])return!1;return!0}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=-1===e.indexOf("\n"),s=" "===e[0]||"\t"===e[0],r='"'===e[e.length-1],o="\\"===e[e.length-1],a=!i||r||o||n,l="";return!a||i&&s||(l+="\n"+t),l+=t?e.replace(/\n/g,"\n"+t):e,a&&(l+="\n"),'"""'+l.replace(/"""/g,'\\"""')+'"""'}n.d(t,{W7:()=>i,LZ:()=>r})},90778:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});var i=n(27636),s=n(7420);function r(e){return(0,i.Vn)(e,{leave:o})}var o={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return l(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,n=e.name,i=d("(",l(e.variableDefinitions,", "),")"),s=l(e.directives," "),r=e.selectionSet;return n||s||i||"query"!==t?l([t,l([n,i]),s,r]," "):r},VariableDefinition:function(e){var t=e.variable,n=e.type,i=e.defaultValue,s=e.directives;return t+": "+n+d(" = ",i)+d(" ",l(s," "))},SelectionSet:function(e){return c(e.selections)},Field:function(e){var t=e.alias,n=e.name,i=e.arguments,s=e.directives,r=e.selectionSet,o=d("",t,": ")+n,a=o+d("(",l(i,", "),")");return a.length>80&&(a=o+d("(\n",u(l(i,"\n")),"\n)")),l([a,l(s," "),r]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+d(" ",l(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,n=e.directives,i=e.selectionSet;return l(["...",d("on ",t),l(n," "),i]," ")},FragmentDefinition:function(e){var t=e.name,n=e.typeCondition,i=e.variableDefinitions,s=e.directives,r=e.selectionSet;return"fragment ".concat(t).concat(d("(",l(i,", "),")")," ")+"on ".concat(n," ").concat(d("",l(s," ")," "))+r},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var n=e.value;return e.block?(0,s.LZ)(n,"description"===t?"":"  "):JSON.stringify(n)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+l(e.values,", ")+"]"},ObjectValue:function(e){return"{"+l(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+d("(",l(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:a((function(e){var t=e.directives,n=e.operationTypes;return l(["schema",l(t," "),c(n)]," ")})),OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:a((function(e){return l(["scalar",e.name,l(e.directives," ")]," ")})),ObjectTypeDefinition:a((function(e){var t=e.name,n=e.interfaces,i=e.directives,s=e.fields;return l(["type",t,d("implements ",l(n," & ")),l(i," "),c(s)]," ")})),FieldDefinition:a((function(e){var t=e.name,n=e.arguments,i=e.type,s=e.directives;return t+(p(n)?d("(\n",u(l(n,"\n")),"\n)"):d("(",l(n,", "),")"))+": "+i+d(" ",l(s," "))})),InputValueDefinition:a((function(e){var t=e.name,n=e.type,i=e.defaultValue,s=e.directives;return l([t+": "+n,d("= ",i),l(s," ")]," ")})),InterfaceTypeDefinition:a((function(e){var t=e.name,n=e.interfaces,i=e.directives,s=e.fields;return l(["interface",t,d("implements ",l(n," & ")),l(i," "),c(s)]," ")})),UnionTypeDefinition:a((function(e){var t=e.name,n=e.directives,i=e.types;return l(["union",t,l(n," "),i&&0!==i.length?"= "+l(i," | "):""]," ")})),EnumTypeDefinition:a((function(e){var t=e.name,n=e.directives,i=e.values;return l(["enum",t,l(n," "),c(i)]," ")})),EnumValueDefinition:a((function(e){return l([e.name,l(e.directives," ")]," ")})),InputObjectTypeDefinition:a((function(e){var t=e.name,n=e.directives,i=e.fields;return l(["input",t,l(n," "),c(i)]," ")})),DirectiveDefinition:a((function(e){var t=e.name,n=e.arguments,i=e.repeatable,s=e.locations;return"directive @"+t+(p(n)?d("(\n",u(l(n,"\n")),"\n)"):d("(",l(n,", "),")"))+(i?" repeatable":"")+" on "+l(s," | ")})),SchemaExtension:function(e){var t=e.directives,n=e.operationTypes;return l(["extend schema",l(t," "),c(n)]," ")},ScalarTypeExtension:function(e){return l(["extend scalar",e.name,l(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,n=e.interfaces,i=e.directives,s=e.fields;return l(["extend type",t,d("implements ",l(n," & ")),l(i," "),c(s)]," ")},InterfaceTypeExtension:function(e){var t=e.name,n=e.interfaces,i=e.directives,s=e.fields;return l(["extend interface",t,d("implements ",l(n," & ")),l(i," "),c(s)]," ")},UnionTypeExtension:function(e){var t=e.name,n=e.directives,i=e.types;return l(["extend union",t,l(n," "),i&&0!==i.length?"= "+l(i," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,n=e.directives,i=e.values;return l(["extend enum",t,l(n," "),c(i)]," ")},InputObjectTypeExtension:function(e){var t=e.name,n=e.directives,i=e.fields;return l(["extend input",t,l(n," "),c(i)]," ")}};function a(e){return function(t){return l([t.description,e(t)],"\n")}}function l(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(t=null==e?void 0:e.filter((function(e){return e})).join(n))&&void 0!==t?t:""}function c(e){return d("{\n",u(l(e,"\n")),"\n}")}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return null!=t&&""!==t?e+t+n:""}function u(e){return d("  ",e.replace(/\n/g,"\n  "))}function h(e){return-1!==e.indexOf("\n")}function p(e){return null!=e&&e.some(h)}},80285:(e,t,n)=>{"use strict";t.Vn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,i=void 0,c=Array.isArray(e),d=[e],u=-1,h=[],p=void 0,m=void 0,f=void 0,g=[],v=[],y=e;do{var b=++u===d.length,S=b&&0!==h.length;if(b){if(m=0===v.length?void 0:g[g.length-1],p=f,f=v.pop(),S){if(c)p=p.slice();else{for(var E={},T=0,w=Object.keys(p);T<w.length;T++){var x=w[T];E[x]=p[x]}p=E}for(var _=0,M=0;M<h.length;M++){var O=h[M][0],A=h[M][1];c&&(O-=_),c&&null===A?(p.splice(O,1),_++):p[O]=A}}u=i.index,d=i.keys,h=i.edits,c=i.inArray,i=i.prev}else{if(m=f?c?u:d[u]:void 0,null==(p=f?f[m]:y))continue;f&&g.push(m)}var C,N=void 0;if(!Array.isArray(p)){if(!(0,r.isNode)(p))throw new Error("Invalid AST Node: ".concat((0,s.default)(p),"."));var D=l(t,p.kind,b);if(D){if((N=D.call(t,p,m,f,g,v))===a)break;if(!1===N){if(!b){g.pop();continue}}else if(void 0!==N&&(h.push([m,N]),!b)){if(!(0,r.isNode)(N)){g.pop();continue}p=N}}}if(void 0===N&&S&&h.push([m,p]),b)g.pop();else i={inArray:c,index:u,keys:d,edits:h,prev:i},c=Array.isArray(p),d=c?p:null!==(C=n[p.kind])&&void 0!==C?C:[],u=-1,h=[],f&&v.push(f),f=p}while(void 0!==i);0!==h.length&&(y=h[h.length-1][1]);return y};var i,s=(i=n(8002))&&i.__esModule?i:{default:i},r=n(91807);var o={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]};var a=Object.freeze({});function l(e,t,n){var i=e[t];if(i){if(!n&&"function"==typeof i)return i;var s=n?i.leave:i.enter;if("function"==typeof s)return s}else{var r=n?e.leave:e.enter;if(r){if("function"==typeof r)return r;var o=r[t];if("function"==typeof o)return o}}}},27636:(e,t,n)=>{"use strict";n.d(t,{$_:()=>o,Vn:()=>a});var i=n(6589),s=n(83059),r={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},o=Object.freeze({});function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,a=void 0,c=Array.isArray(e),d=[e],u=-1,h=[],p=void 0,m=void 0,f=void 0,g=[],v=[],y=e;do{var b=++u===d.length,S=b&&0!==h.length;if(b){if(m=0===v.length?void 0:g[g.length-1],p=f,f=v.pop(),S){if(c)p=p.slice();else{for(var E={},T=0,w=Object.keys(p);T<w.length;T++){var x=w[T];E[x]=p[x]}p=E}for(var _=0,M=0;M<h.length;M++){var O=h[M][0],A=h[M][1];c&&(O-=_),c&&null===A?(p.splice(O,1),_++):p[O]=A}}u=a.index,d=a.keys,h=a.edits,c=a.inArray,a=a.prev}else{if(m=f?c?u:d[u]:void 0,null==(p=f?f[m]:y))continue;f&&g.push(m)}var C,N=void 0;if(!Array.isArray(p)){if(!(0,s.UG)(p))throw new Error("Invalid AST Node: ".concat((0,i.Z)(p),"."));var D=l(t,p.kind,b);if(D){if((N=D.call(t,p,m,f,g,v))===o)break;if(!1===N){if(!b){g.pop();continue}}else if(void 0!==N&&(h.push([m,N]),!b)){if(!(0,s.UG)(N)){g.pop();continue}p=N}}}if(void 0===N&&S&&h.push([m,p]),b)g.pop();else a={inArray:c,index:u,keys:d,edits:h,prev:a},d=(c=Array.isArray(p))?p:null!==(C=n[p.kind])&&void 0!==C?C:[],u=-1,h=[],f&&v.push(f),f=p}while(void 0!==a);return 0!==h.length&&(y=h[h.length-1][1]),y}function l(e,t,n){var i=e[t];if(i){if(!n&&"function"==typeof i)return i;var s=n?i.leave:i.enter;if("function"==typeof s)return s}else{var r=n?e.leave:e.enter;if(r){if("function"==typeof r)return r;var o=r[t];if("function"==typeof o)return o}}}},41405:(e,t,n)=>{"use strict";var i=n.g.Symbol,s=n(55419);e.exports=function(){return"function"==typeof i&&("function"==typeof Symbol&&("symbol"==typeof i("foo")&&("symbol"==typeof Symbol("bar")&&s())))}},55419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var s=Object.getOwnPropertyDescriptor(e,t);if(42!==s.value||!0!==s.enumerable)return!1}return!0}},17642:(e,t,n)=>{"use strict";var i=n(58612);e.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},95320:e=>{"use strict";var t,n,i=Function.prototype.toString,s="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof s&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},s((function(){throw 42}),null,t)}catch(e){e!==n&&(s=null)}else s=null;var r=/^\s*class\b/,o=function(e){try{var t=i.call(e);return r.test(t)}catch(e){return!1}},a=Object.prototype.toString,l="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;e.exports=s?function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{s(e,null,t)}catch(e){if(e!==n)return!1}return!o(e)}:function(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(l)return function(e){try{return!o(e)&&(i.call(e),!0)}catch(e){return!1}}(e);if(o(e))return!1;var t=a.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},9706:()=>{},79071:()=>{},43479:()=>{},37067:()=>{},29469:(e,t,n)=>{"use strict";n.r(t)},54078:(e,t,n)=>{"use strict";var i=n(94029),s=n(42473),r=n(17642),o=n(46057),a=function(e){s(!1,e)},l=String.prototype.replace,c=String.prototype.split,d="||||",u=function(e){var t=e%100,n=t%10;return 11!==t&&1===n?0:2<=n&&n<=4&&!(t>=12&&t<=14)?1:2},h={pluralTypes:{arabic:function(e){if(e<3)return e;var t=e%100;return t>=3&&t<=10?3:t>=11?4:5},bosnian_serbian:u,chinese:function(){return 0},croatian:u,french:function(e){return e>1?1:0},german:function(e){return 1!==e?1:0},russian:u,lithuanian:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=9&&(e%100<11||e%100>19)?1:2},czech:function(e){return 1===e?0:e>=2&&e<=4?1:2},polish:function(e){if(1===e)return 0;var t=e%10;return 2<=t&&t<=4&&(e%100<10||e%100>=20)?1:2},icelandic:function(e){return e%10!=1||e%100==11?1:0},slovenian:function(e){var t=e%100;return 1===t?0:2===t?1:3===t||4===t?2:3}},pluralTypeToLanguages:{arabic:["ar"],bosnian_serbian:["bs-Latn-BA","bs-Cyrl-BA","srl-RS","sr-RS"],chinese:["id","id-ID","ja","ko","ko-KR","lo","ms","th","th-TH","zh"],croatian:["hr","hr-HR"],german:["fa","da","de","en","es","fi","el","he","hi-IN","hu","hu-HU","it","nl","no","pt","sv","tr"],french:["fr","tl","pt-br"],russian:["ru","ru-RU"],lithuanian:["lt"],czech:["cs","cs-CZ","sk"],polish:["pl"],icelandic:["is"],slovenian:["sl-SL"]}};function p(e,t){var n,s,r=(n=e.pluralTypeToLanguages,s={},i(n,(function(e,t){i(e,(function(e){s[e]=t}))})),s);return r[t]||r[c.call(t,/-/,1)[0]]||r.en}function m(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var f=/%\{(.*?)\}/g;function g(e,t,n,i,s){if("string"!=typeof e)throw new TypeError("Polyglot.transformPhrase expects argument #1 to be string");if(null==t)return e;var a=e,u=i||f,m=s||h,g="number"==typeof t?{smart_count:t}:t;if(null!=g.smart_count&&a){var v=c.call(a,d);a=o(v[function(e,t,n){return e.pluralTypes[p(e,t)](n)}(m,n||"en",g.smart_count)]||v[0])}return a=l.call(a,u,(function(e,t){return r(g,t)&&null!=g[t]?g[t]:e}))}function v(e){var t=e||{};this.phrases={},this.extend(t.phrases||{}),this.currentLocale=t.locale||"en";var n=t.allowMissing?g:null;this.onMissingKey="function"==typeof t.onMissingKey?t.onMissingKey:n,this.warn=t.warn||a,this.tokenRegex=function(e){var t=e&&e.prefix||"%{",n=e&&e.suffix||"}";if(t===d||n===d)throw new RangeError('"||||" token is reserved for pluralization');return new RegExp(m(t)+"(.*?)"+m(n),"g")}(t.interpolation),this.pluralRules=t.pluralRules||h}v.prototype.locale=function(e){return e&&(this.currentLocale=e),this.currentLocale},v.prototype.extend=function(e,t){i(e,(function(e,n){var i=t?t+"."+n:n;"object"==typeof e?this.extend(e,i):this.phrases[i]=e}),this)},v.prototype.unset=function(e,t){"string"==typeof e?delete this.phrases[e]:i(e,(function(e,n){var i=t?t+"."+n:n;"object"==typeof e?this.unset(e,i):delete this.phrases[i]}),this)},v.prototype.clear=function(){this.phrases={}},v.prototype.replace=function(e){this.clear(),this.extend(e)},v.prototype.t=function(e,t){var n,i,s=null==t?{}:t;if("string"==typeof this.phrases[e])n=this.phrases[e];else if("string"==typeof s._)n=s._;else if(this.onMissingKey){i=(0,this.onMissingKey)(e,s,this.currentLocale,this.tokenRegex,this.pluralRules)}else this.warn('Missing translation for key: "'+e+'"'),i=e;return"string"==typeof n&&(i=g(n,s,this.currentLocale,this.tokenRegex,this.pluralRules)),i},v.prototype.has=function(e){return r(this.phrases,e)},v.transformPhrase=function(e,t,n){return g(e,t,n)},e.exports=v},18987:(e,t,n)=>{"use strict";var i;if(!Object.keys){var s=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=n(21414),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),c=a.call((function(){}),"prototype"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(e){var t=e.constructor;return t&&t.prototype===e},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&s.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{u(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();i=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===r.call(e),i=o(e),a=t&&"[object String]"===r.call(e),h=[];if(!t&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var m=c&&n;if(a&&e.length>0&&!s.call(e,0))for(var f=0;f<e.length;++f)h.push(String(f));if(i&&e.length>0)for(var g=0;g<e.length;++g)h.push(String(g));else for(var v in e)m&&"prototype"===v||!s.call(e,v)||h.push(String(v));if(l)for(var y=function(e){if("undefined"==typeof window||!p)return u(e);try{return u(e)}catch(e){return!1}}(e),b=0;b<d.length;++b)y&&"constructor"===d[b]||!s.call(e,d[b])||h.push(d[b]);return h}}e.exports=i},82215:(e,t,n)=>{"use strict";var i=Array.prototype.slice,s=n(21414),r=Object.keys,o=r?function(e){return r(e)}:n(18987),a=Object.keys;o.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return s(e)?a(i.call(e)):a(e)}):Object.keys=o;return Object.keys||o},e.exports=o},21414:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var n=t.call(e),i="[object Arguments]"===n;return i||(i="[object Array]"!==n&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),i}},17141:(e,t,n)=>{var i;!function(s,r){var o={};function a(e){return function(){var t={method:e},n=Array.prototype.slice.call(arguments);/^get/.test(e)?(o.assert(n.length>0,"Get methods require a callback."),n.unshift(t)):(/^set/.test(e)&&(o.assert(0!==n.length,"Set methods require a value."),t.value=n[0]),n=[t]),this.send.apply(this,n)}}o.DEBUG=!1,o.VERSION="0.0.11",o.CONTEXT="player.js",o.POST_MESSAGE=!!s.postMessage,o.origin=function(e){return"//"===e.substr(0,2)&&(e=s.location.protocol+e),e.split("/").slice(0,3).join("/")},o.addEvent=function(e,t,n){e&&(e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)},o.log=function(){o.log.history=o.log.history||[],o.log.history.push(arguments),s.console&&o.DEBUG&&s.console.log(Array.prototype.slice.call(arguments))},o.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},o.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},o.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},o.isNone=function(e){return null==e},o.has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.indexOf=function(e,t){if(null==e)return-1;var n=0,i=e.length;if(Array.prototype.IndexOf&&e.indexOf===Array.prototype.IndexOf)return e.indexOf(t);for(;n<i;n++)if(e[n]===t)return n;return-1},o.assert=function(e,t){if(!e)throw t||"Player.js Assert Failed"},o.Keeper=function(){this.init()},o.Keeper.prototype.init=function(){this.data={}},o.Keeper.prototype.getUUID=function(){return"listener-xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},o.Keeper.prototype.has=function(e,t){if(!this.data.hasOwnProperty(e))return!1;if(o.isNone(t))return!0;for(var n=this.data[e],i=0;i<n.length;i++)if(n[i].id===t)return!0;return!1},o.Keeper.prototype.add=function(e,t,n,i,s){var r={id:e,event:t,cb:n,ctx:i,one:s};this.has(t)?this.data[t].push(r):this.data[t]=[r]},o.Keeper.prototype.execute=function(e,t,n,i){if(!this.has(e,t))return!1;for(var s=[],r=[],a=0;a<this.data[e].length;a++){var l=this.data[e][a];o.isNone(t)||!o.isNone(t)&&l.id===t?(r.push({cb:l.cb,ctx:l.ctx?l.ctx:i,data:n}),!1===l.one&&s.push(l)):s.push(l)}0===s.length?delete this.data[e]:this.data[e]=s;for(var c=0;c<r.length;c++){var d=r[c];d.cb.call(d.ctx,d.data)}},o.Keeper.prototype.on=function(e,t,n,i){this.add(e,t,n,i,!1)},o.Keeper.prototype.one=function(e,t,n,i){this.add(e,t,n,i,!0)},o.Keeper.prototype.off=function(e,t){var n=[];if(!this.data.hasOwnProperty(e))return n;for(var i=[],s=0;s<this.data[e].length;s++){var r=this.data[e][s];o.isNone(t)||r.cb===t?o.isNone(r.id)||n.push(r.id):i.push(r)}return 0===i.length?delete this.data[e]:this.data[e]=i,n},o.Player=function(e,t){if(!(this instanceof o.Player))return new o.Player(e,t);this.init(e,t)},o.EVENTS={READY:"ready",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",PROGRESS:"progress",ERROR:"error"},o.EVENTS.all=function(){var e=[];for(var t in o.EVENTS)o.has(o.EVENTS,t)&&o.isString(o.EVENTS[t])&&e.push(o.EVENTS[t]);return e},o.METHODS={PLAY:"play",PAUSE:"pause",GETPAUSED:"getPaused",MUTE:"mute",UNMUTE:"unmute",GETMUTED:"getMuted",SETVOLUME:"setVolume",GETVOLUME:"getVolume",GETDURATION:"getDuration",SETCURRENTTIME:"setCurrentTime",GETCURRENTTIME:"getCurrentTime",SETLOOP:"setLoop",GETLOOP:"getLoop",REMOVEEVENTLISTENER:"removeEventListener",ADDEVENTLISTENER:"addEventListener"},o.METHODS.all=function(){var e=[];for(var t in o.METHODS)o.has(o.METHODS,t)&&o.isString(o.METHODS[t])&&e.push(o.METHODS[t]);return e},o.READIED=[],o.Player.prototype.init=function(e,t){var n=this;o.isString(e)&&(e=r.getElementById(e)),this.elem=e,o.assert("IFRAME"===e.nodeName,'playerjs.Player constructor requires an Iframe, got "'+e.nodeName+'"'),o.assert(e.src,"playerjs.Player constructor requires a Iframe with a 'src' attribute."),this.origin=o.origin(e.src),this.keeper=new o.Keeper,this.isReady=!1,this.queue=[],this.events=o.EVENTS.all(),this.methods=o.METHODS.all(),o.POST_MESSAGE?o.addEvent(s,"message",(function(e){n.receive(e)})):o.log("Post Message is not Available."),o.indexOf(o.READIED,e.src)>-1?n.loaded=!0:this.elem.onload=function(){n.loaded=!0}},o.Player.prototype.send=function(e,t,n){if(e.context=o.CONTEXT,e.version=o.VERSION,t){var i=this.keeper.getUUID();e.listener=i,this.keeper.one(i,e.method,t,n)}return this.isReady||"ready"===e.value?(o.log("Player.send",e,this.origin),!0===this.loaded&&this.elem.contentWindow.postMessage(JSON.stringify(e),this.origin),!0):(o.log("Player.queue",e),this.queue.push(e),!1)},o.Player.prototype.receive=function(e){if(o.log("Player.receive",e),e.origin!==this.origin)return!1;var t;try{t=JSON.parse(e.data)}catch(e){return!1}if(t.context!==o.CONTEXT)return!1;"ready"===t.event&&t.value&&t.value.src===this.elem.src&&this.ready(t),this.keeper.has(t.event,t.listener)&&this.keeper.execute(t.event,t.listener,t.value,this)},o.Player.prototype.ready=function(e){if(!0===this.isReady)return!1;e.value.events&&(this.events=e.value.events),e.value.methods&&(this.methods=e.value.methods),this.isReady=!0,this.loaded=!0;for(var t=0;t<this.queue.length;t++){var n=this.queue[t];o.log("Player.dequeue",n),"ready"===e.event&&this.keeper.execute(n.event,n.listener,!0,this),this.send(n)}this.queue=[]},o.Player.prototype.on=function(e,t,n){var i=this.keeper.getUUID();return"ready"===e?this.keeper.one(i,e,t,n):this.keeper.on(i,e,t,n),this.send({method:"addEventListener",value:e,listener:i}),!0},o.Player.prototype.off=function(e,t){var n=this.keeper.off(e,t);if(o.log("Player.off",n),n.length>0)for(var i in n)return this.send({method:"removeEventListener",value:e,listener:n[i]}),!0;return!1},o.Player.prototype.supports=function(e,t){o.assert(o.indexOf(["method","event"],e)>-1,'evtOrMethod needs to be either "event" or "method" got '+e),t=o.isArray(t)?t:[t];for(var n="event"===e?this.events:this.methods,i=0;i<t.length;i++)if(-1===o.indexOf(n,t[i]))return!1;return!0};for(var l=0,c=o.METHODS.all().length;l<c;l++){var d=o.METHODS.all()[l];o.Player.prototype.hasOwnProperty(d)||(o.Player.prototype[d]=a(d))}o.addEvent(s,"message",(function(e){var t;try{t=JSON.parse(e.data)}catch(e){return!1}if(t.context!==o.CONTEXT)return!1;"ready"===t.event&&t.value&&t.value.src&&o.READIED.push(t.value.src)})),o.Receiver=function(e,t){this.init(e,t)},o.Receiver.prototype.init=function(e,t){var n=this;this.isReady=!1,this.origin=o.origin(r.referrer),this.methods={},this.supported={events:e||o.EVENTS.all(),methods:t||o.METHODS.all()},this.eventListeners={},this.reject=!(s.self!==s.top&&o.POST_MESSAGE),this.reject||o.addEvent(s,"message",(function(e){n.receive(e)}))},o.Receiver.prototype.receive=function(e){if(e.origin!==this.origin)return!1;var t={};if(o.isObject(e.data))t=e.data;else try{t=s.JSON.parse(e.data)}catch(e){o.log("JSON Parse Error",e)}if(o.log("Receiver.receive",e,t),!t.method)return!1;if(t.context!==o.CONTEXT)return!1;if(-1===o.indexOf(o.METHODS.all(),t.method))return this.emit("error",{code:2,msg:'Invalid Method "'+t.method+'"'}),!1;var n=o.isNone(t.listener)?null:t.listener;if("addEventListener"===t.method)this.eventListeners.hasOwnProperty(t.value)?-1===o.indexOf(this.eventListeners[t.value],n)&&this.eventListeners[t.value].push(n):this.eventListeners[t.value]=[n],"ready"===t.value&&this.isReady&&this.ready();else if("removeEventListener"===t.method){if(this.eventListeners.hasOwnProperty(t.value)){var i=o.indexOf(this.eventListeners[t.value],n);i>-1&&this.eventListeners[t.value].splice(i,1),0===this.eventListeners[t.value].length&&delete this.eventListeners[t.value]}}else this.get(t.method,t.value,n)},o.Receiver.prototype.get=function(e,t,n){var i=this;if(!this.methods.hasOwnProperty(e))return this.emit("error",{code:3,msg:'Method Not Supported"'+e+'"'}),!1;var s=this.methods[e];if("get"===e.substr(0,3)){s.call(this,(function(t){i.send(e,t,n)}))}else s.call(this,t)},o.Receiver.prototype.on=function(e,t){this.methods[e]=t},o.Receiver.prototype.send=function(e,t,n){if(o.log("Receiver.send",e,t,n),this.reject)return o.log("Receiver.send.reject",e,t,n),!1;var i={context:o.CONTEXT,version:o.VERSION,event:e};o.isNone(t)||(i.value=t),o.isNone(n)||(i.listener=n);var r=JSON.stringify(i);s.parent.postMessage(r,""===this.origin?"*":this.origin)},o.Receiver.prototype.emit=function(e,t){if(!this.eventListeners.hasOwnProperty(e))return!1;o.log("Instance.emit",e,t,this.eventListeners[e]);for(var n=0;n<this.eventListeners[e].length;n++){var i=this.eventListeners[e][n];this.send(e,t,i)}return!0},o.Receiver.prototype.ready=function(){o.log("Receiver.ready"),this.isReady=!0;var e={src:s.location.toString(),events:this.supported.events,methods:this.supported.methods};this.emit("ready",e)||this.send("ready",e)},o.HTML5Adapter=function(e){if(!(this instanceof o.HTML5Adapter))return new o.HTML5Adapter(e);this.init(e)},o.HTML5Adapter.prototype.init=function(e){o.assert(e,"playerjs.HTML5Adapter requires a video element");var t=this.receiver=new o.Receiver;e.addEventListener("playing",(function(){t.emit("play")})),e.addEventListener("pause",(function(){t.emit("pause")})),e.addEventListener("ended",(function(){t.emit("ended")})),e.addEventListener("timeupdate",(function(){t.emit("timeupdate",{seconds:e.currentTime,duration:e.duration})})),e.addEventListener("progress",(function(){t.emit("buffered",{percent:e.buffered.length})})),t.on("play",(function(){e.play()})),t.on("pause",(function(){e.pause()})),t.on("getPaused",(function(t){t(e.paused)})),t.on("getCurrentTime",(function(t){t(e.currentTime)})),t.on("setCurrentTime",(function(t){e.currentTime=t})),t.on("getDuration",(function(t){t(e.duration)})),t.on("getVolume",(function(t){t(100*e.volume)})),t.on("setVolume",(function(t){e.volume=t/100})),t.on("mute",(function(){e.muted=!0})),t.on("unmute",(function(){e.muted=!1})),t.on("getMuted",(function(t){t(e.muted)})),t.on("getLoop",(function(t){t(e.loop)})),t.on("setLoop",(function(t){e.loop=t}))},o.HTML5Adapter.prototype.ready=function(){this.receiver.ready()},o.JWPlayerAdapter=function(e){if(!(this instanceof o.JWPlayerAdapter))return new o.JWPlayerAdapter(e);this.init(e)},o.JWPlayerAdapter.prototype.init=function(e){o.assert(e,"playerjs.JWPlayerAdapter requires a player object");var t=this.receiver=new o.Receiver;this.looped=!1,e.on("pause",(function(){t.emit("pause")})),e.on("play",(function(){t.emit("play")})),e.on("time",(function(e){var n=e.position,i=e.duration;if(!n||!i)return!1;var s={seconds:n,duration:i};t.emit("timeupdate",s)}));var n=this;e.on("complete",(function(){!0===n.looped?e.seek(0):t.emit("ended")})),e.on("error",(function(){t.emit("error")})),t.on("play",(function(){e.play(!0)})),t.on("pause",(function(){e.pause(!0)})),t.on("getPaused",(function(t){t(e.getState().toLowerCase()!=="PLAYING".toLowerCase())})),t.on("getCurrentTime",(function(t){t(e.getPosition())})),t.on("setCurrentTime",(function(t){e.seek(t)})),t.on("getDuration",(function(t){t(e.getDuration())})),t.on("getVolume",(function(t){t(e.getVolume())})),t.on("setVolume",(function(t){e.setVolume(t)})),t.on("mute",(function(){e.setMute(!0)})),t.on("unmute",(function(){e.setMute(!1)})),t.on("getMuted",(function(t){t(!0===e.getMute())})),t.on("getLoop",(function(e){e(this.looped)}),this),t.on("setLoop",(function(e){this.looped=e}),this)},o.JWPlayerAdapter.prototype.ready=function(){this.receiver.ready()},o.MockAdapter=function(){if(!(this instanceof o.MockAdapter))return new o.MockAdapter;this.init()},o.MockAdapter.prototype.init=function(){var e={duration:20,currentTime:0,interval:null,timeupdate:function(){},volume:100,mute:!1,playing:!1,loop:!1,play:function(){e.interval=setInterval((function(){e.currentTime+=.25,e.timeupdate({seconds:e.currentTime,duration:e.duration})}),250),e.playing=!0},pause:function(){clearInterval(e.interval),e.playing=!1}},t=this.receiver=new o.Receiver;t.on("play",(function(){var t=this;e.play(),this.emit("play"),e.timeupdate=function(e){t.emit("timeupdate",e)}})),t.on("pause",(function(){e.pause(),this.emit("pause")})),t.on("getPaused",(function(t){t(!e.playing)})),t.on("getCurrentTime",(function(t){t(e.currentTime)})),t.on("setCurrentTime",(function(t){e.currentTime=t})),t.on("getDuration",(function(t){t(e.duration)})),t.on("getVolume",(function(t){t(e.volume)})),t.on("setVolume",(function(t){e.volume=t})),t.on("mute",(function(){e.mute=!0})),t.on("unmute",(function(){e.mute=!1})),t.on("getMuted",(function(t){t(e.mute)})),t.on("getLoop",(function(t){t(e.loop)})),t.on("setLoop",(function(t){e.loop=t}))},o.MockAdapter.prototype.ready=function(){this.receiver.ready()},o.VideoJSAdapter=function(e){if(!(this instanceof o.VideoJSAdapter))return new o.VideoJSAdapter(e);this.init(e)},o.VideoJSAdapter.prototype.init=function(e){o.assert(e,"playerjs.VideoJSReceiver requires a player object");var t=this.receiver=new o.Receiver;e.on("pause",(function(){t.emit("pause")})),e.on("play",(function(){t.emit("play")})),e.on("timeupdate",(function(n){var i=e.currentTime(),s=e.duration();if(!i||!s)return!1;var r={seconds:i,duration:s};t.emit("timeupdate",r)})),e.on("ended",(function(){t.emit("ended")})),e.on("error",(function(){t.emit("error")})),t.on("play",(function(){e.play()})),t.on("pause",(function(){e.pause()})),t.on("getPaused",(function(t){t(e.paused())})),t.on("getCurrentTime",(function(t){t(e.currentTime())})),t.on("setCurrentTime",(function(t){e.currentTime(t)})),t.on("getDuration",(function(t){t(e.duration())})),t.on("getVolume",(function(t){t(100*e.volume())})),t.on("setVolume",(function(t){e.volume(t/100)})),t.on("mute",(function(){e.volume(0)})),t.on("unmute",(function(){e.volume(1)})),t.on("getMuted",(function(t){t(0===e.volume())})),t.on("getLoop",(function(t){t(e.loop())})),t.on("setLoop",(function(t){e.loop(t)}))},o.VideoJSAdapter.prototype.ready=function(){this.receiver.ready()},void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i)}(window,document)},64448:(e,t,n)=>{"use strict";var i=n(67294),s=n(63840);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,i,s,r,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,i){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:i||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,i)&&(n=null),i||null===s?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,i=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var S=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),T=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),O=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function R(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=P&&e[P]||e["@@iterator"])?e:null}var k,U=Object.assign;function B(e){if(void 0===k)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);k=t&&t[1]||""}return"\n"+k+e}var F=!1;function V(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var i=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){i=e}e.call(t.prototype)}else{try{throw Error()}catch(e){i=e}e()}}catch(t){if(t&&i&&"string"==typeof t.stack){for(var s=t.stack.split("\n"),r=i.stack.split("\n"),o=s.length-1,a=r.length-1;1<=o&&0<=a&&s[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==r[a]){if(1!==o||1!==a)do{if(o--,0>--a||s[o]!==r[a]){var l="\n"+s[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function H(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case w:return"Fragment";case T:return"Portal";case _:return"Profiler";case x:return"StrictMode";case C:return"Suspense";case N:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case O:return(e.displayName||"Context")+".Consumer";case M:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return j(e(t))}catch(e){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function K(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var s=n.get,r=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){i=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(e){i=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=W(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,i=null!=t.checked?t.checked:t.defaultChecked;n=z(null!=t.value?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Q(e,t);var n=z(t.value),i=t.type;if(null!=n)"number"===i?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===i||"reset"===i)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!("submit"!==i&&"reset"!==i||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,i){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&i&&(e[n].defaultSelected=!0)}else{for(n=""+z(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(i&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function ie(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(te(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:z(n)}}function re(e,t){var n=z(t.value),i=z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=i&&(e.defaultValue=""+i)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,i){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},me=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var i=0===n.indexOf("--"),s=fe(n,t[n],i);"float"===n&&(n="cssFloat"),i?e.setProperty(n,s):e[n]=s}}Object.keys(pe).forEach((function(e){me.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ve=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(r(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function Ee(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,we=null,xe=null;function _e(e){if(e=ps(e)){if("function"!=typeof Te)throw Error(r(280));var t=e.stateNode;t&&(t=fs(t),Te(e.stateNode,e.type,t))}}function Me(e){we?xe?xe.push(e):xe=[e]:we=e}function Oe(){if(we){var e=we,t=xe;if(xe=we=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function Ae(e,t){return e(t)}function Ce(){}var Ne=!1;function De(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ae(e,t,n)}finally{Ne=!1,(null!==we||null!==xe)&&(Ce(),Oe())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var i=fs(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var Le=!1;if(d)try{var Pe={};Object.defineProperty(Pe,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Pe,Pe),window.removeEventListener("test",Pe,Pe)}catch(de){Le=!1}function Re(e,t,n,i,s,r,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var ke=!1,Ue=null,Be=!1,Fe=null,Ve={onError:function(e){ke=!0,Ue=e}};function He(e,t,n,i,s,r,o,a,l){ke=!1,Ue=null,Re.apply(Ve,arguments)}function je(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!=(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function ze(e){if(je(e)!==e)throw Error(r(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var s=n.return;if(null===s)break;var o=s.alternate;if(null===o){if(null!==(i=s.return)){n=i;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return ze(s),e;if(o===i)return ze(s),t;o=o.sibling}throw Error(r(188))}if(n.return!==i.return)n=s,i=o;else{for(var a=!1,l=s.child;l;){if(l===n){a=!0,n=s,i=o;break}if(l===i){a=!0,i=s,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,i=s;break}if(l===i){a=!0,i=o,n=s;break}l=l.sibling}if(!a)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ye=s.unstable_scheduleCallback,qe=s.unstable_cancelCallback,Ze=s.unstable_shouldYield,$e=s.unstable_requestPaint,Qe=s.unstable_now,Xe=s.unstable_getCurrentPriorityLevel,Je=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,it=s.unstable_IdlePriority,st=null,rt=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var i=0,s=e.suspendedLanes,r=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~s;0!==a?i=ut(a):0!==(r&=o)&&(i=ut(r))}else 0!==(o=n&~s)?i=ut(o):0!==r&&(i=ut(r));if(0===i)return 0;if(0!==t&&t!==i&&0==(t&s)&&((s=i&-i)>=(r=t&-t)||16===s&&0!=(4194240&r)))return t;if(0!=(4&i)&&(i|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=i;0<t;)s=1<<(n=31-ot(t)),i|=e[n],t&=~s;return i}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:default:return-1}}function mt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ot(n),s=1<<i;s&t|e[i]&t&&(e[i]|=t),n&=~s}}var yt=0;function bt(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var St,Et,Tt,wt,xt,_t=!1,Mt=[],Ot=null,At=null,Ct=null,Nt=new Map,Dt=new Map,It=[],Lt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":Ot=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Ct=null;break;case"pointerover":case"pointerout":Nt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Rt(e,t,n,i,s,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},null!==t&&(null!==(t=ps(t))&&Et(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function kt(e){var t=hs(e.target);if(null!==t){var n=je(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void xt(e.priority,(function(){Tt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ps(n))&&Et(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);Se=i,n.target.dispatchEvent(i),Se=null,t.shift()}return!0}function Bt(e,t,n){Ut(e)&&n.delete(t)}function Ft(){_t=!1,null!==Ot&&Ut(Ot)&&(Ot=null),null!==At&&Ut(At)&&(At=null),null!==Ct&&Ut(Ct)&&(Ct=null),Nt.forEach(Bt),Dt.forEach(Bt)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,Ft)))}function Ht(e){function t(t){return Vt(t,e)}if(0<Mt.length){Vt(Mt[0],e);for(var n=1;n<Mt.length;n++){var i=Mt[n];i.blockedOn===e&&(i.blockedOn=null)}}for(null!==Ot&&Vt(Ot,e),null!==At&&Vt(At,e),null!==Ct&&Vt(Ct,e),Nt.forEach(t),Dt.forEach(t),n=0;n<It.length;n++)(i=It[n]).blockedOn===e&&(i.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)kt(n),null===n.blockedOn&&It.shift()}var jt=S.ReactCurrentBatchConfig;function Gt(e,t,n,i){var s=yt,r=jt.transition;jt.transition=null;try{yt=1,Wt(e,t,n,i)}finally{yt=s,jt.transition=r}}function zt(e,t,n,i){var s=yt,r=jt.transition;jt.transition=null;try{yt=4,Wt(e,t,n,i)}finally{yt=s,jt.transition=r}}function Wt(e,t,n,i){var s=Yt(e,t,n,i);if(null===s)Fi(e,t,i,Kt,n),Pt(e,i);else if(function(e,t,n,i,s){switch(t){case"focusin":return Ot=Rt(Ot,e,t,n,i,s),!0;case"dragenter":return At=Rt(At,e,t,n,i,s),!0;case"mouseover":return Ct=Rt(Ct,e,t,n,i,s),!0;case"pointerover":var r=s.pointerId;return Nt.set(r,Rt(Nt.get(r)||null,e,t,n,i,s)),!0;case"gotpointercapture":return r=s.pointerId,Dt.set(r,Rt(Dt.get(r)||null,e,t,n,i,s)),!0}return!1}(s,e,t,n,i))i.stopPropagation();else if(Pt(e,i),4&t&&-1<Lt.indexOf(e)){for(;null!==s;){var r=ps(s);if(null!==r&&St(r),null===(r=Yt(e,t,n,i))&&Fi(e,t,i,Kt,n),r===s)break;s=r}null!==s&&i.stopPropagation()}else Fi(e,t,i,null,n)}var Kt=null;function Yt(e,t,n,i){if(Kt=null,null!==(e=hs(e=Ee(i))))if(null===(t=je(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case it:return 536870912;default:return 16}default:return 16}}var Zt=null,$t=null,Qt=null;function Xt(){if(Qt)return Qt;var e,t,n=$t,i=n.length,s="value"in Zt?Zt.value:Zt.textContent,r=s.length;for(e=0;e<i&&n[e]===s[e];e++);var o=i-e;for(t=1;t<=o&&n[i-t]===s[r-t];t++);return Qt=s.slice(e,1<t?1-t:void 0)}function Jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function en(){return!0}function tn(){return!1}function nn(e){function t(t,n,i,s,r){for(var o in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?en:tn,this.isPropagationStopped=tn,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=en)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=en)},persist:function(){},isPersistent:en}),t}var sn,rn,on,an={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=nn(an),cn=U({},an,{view:0,detail:0}),dn=nn(cn),un=U({},cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(sn=e.screenX-on.screenX,rn=e.screenY-on.screenY):rn=sn=0,on=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:rn}}),hn=nn(un),pn=nn(U({},un,{dataTransfer:0})),mn=nn(U({},cn,{relatedTarget:0})),fn=nn(U({},an,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=nn(U({},an,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),vn=nn(U({},an,{data:0})),yn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Tn(){return En}var wn=nn(U({},cn,{key:function(e){if(e.key){var t=yn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?Jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),xn=nn(U({},un,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=nn(U({},cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Mn=nn(U({},an,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=nn(U({},un,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),An=[9,13,27,32],Cn=d&&"CompositionEvent"in window,Nn=null;d&&"documentMode"in document&&(Nn=document.documentMode);var Dn=d&&"TextEvent"in window&&!Nn,In=d&&(!Cn||Nn&&8<Nn&&11>=Nn),Ln=String.fromCharCode(32),Pn=!1;function Rn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Vn(e,t,n,i){Me(i),0<(t=Hi(t,"onChange")).length&&(n=new ln("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var Hn=null,jn=null;function Gn(e){Li(e,0)}function zn(e){if(Y(ms(e)))return e}function Wn(e,t){if("change"===e)return t}var Kn=!1;if(d){var Yn;if(d){var qn="oninput"in document;if(!qn){var Zn=document.createElement("div");Zn.setAttribute("oninput","return;"),qn="function"==typeof Zn.oninput}Yn=qn}else Yn=!1;Kn=Yn&&(!document.documentMode||9<document.documentMode)}function $n(){Hn&&(Hn.detachEvent("onpropertychange",Qn),jn=Hn=null)}function Qn(e){if("value"===e.propertyName&&zn(jn)){var t=[];Vn(t,jn,e,Ee(e)),De(Gn,t)}}function Xn(e,t,n){"focusin"===e?($n(),jn=n,(Hn=t).attachEvent("onpropertychange",Qn)):"focusout"===e&&$n()}function Jn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zn(jn)}function ei(e,t){if("click"===e)return zn(t)}function ti(e,t){if("input"===e||"change"===e)return zn(t)}var ni="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function ii(e,t){if(ni(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var s=n[i];if(!u.call(t,s)||!ni(e[s],t[s]))return!1}return!0}function si(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ri(e,t){var n,i=si(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=si(i)}}function oi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?oi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ai(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=q((e=t.contentWindow).document)}return t}function li(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ci(e){var t=ai(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&oi(n.ownerDocument.documentElement,n)){if(null!==i&&li(n))if(t=i.start,void 0===(e=i.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,r=Math.min(i.start,s);i=void 0===i.end?r:Math.min(i.end,s),!e.extend&&r>i&&(s=i,i=r,r=s),s=ri(n,r);var o=ri(n,i);s&&o&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),r>i?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var di=d&&"documentMode"in document&&11>=document.documentMode,ui=null,hi=null,pi=null,mi=!1;function fi(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;mi||null==ui||ui!==q(i)||("selectionStart"in(i=ui)&&li(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},pi&&ii(pi,i)||(pi=i,0<(i=Hi(hi,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ui)))}function gi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var vi={animationend:gi("Animation","AnimationEnd"),animationiteration:gi("Animation","AnimationIteration"),animationstart:gi("Animation","AnimationStart"),transitionend:gi("Transition","TransitionEnd")},yi={},bi={};function Si(e){if(yi[e])return yi[e];if(!vi[e])return e;var t,n=vi[e];for(t in n)if(n.hasOwnProperty(t)&&t in bi)return yi[e]=n[t];return e}d&&(bi=document.createElement("div").style,"AnimationEvent"in window||(delete vi.animationend.animation,delete vi.animationiteration.animation,delete vi.animationstart.animation),"TransitionEvent"in window||delete vi.transitionend.transition);var Ei=Si("animationend"),Ti=Si("animationiteration"),wi=Si("animationstart"),xi=Si("transitionend"),_i=new Map,Mi="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(e,t){_i.set(e,t),l(t,[e])}for(var Ai=0;Ai<Mi.length;Ai++){var Ci=Mi[Ai];Oi(Ci.toLowerCase(),"on"+(Ci[0].toUpperCase()+Ci.slice(1)))}Oi(Ei,"onAnimationEnd"),Oi(Ti,"onAnimationIteration"),Oi(wi,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(xi,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ni="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ni));function Ii(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,s,o,a,l,c){if(He.apply(this,arguments),ke){if(!ke)throw Error(r(198));var d=Ue;ke=!1,Ue=null,Be||(Be=!0,Fe=d)}}(i,t,void 0,e),e.currentTarget=null}function Li(e,t){t=0!=(4&t);for(var n=0;n<e.length;n++){var i=e[n],s=i.event;i=i.listeners;e:{var r=void 0;if(t)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;Ii(s,a,c),r=l}else for(o=0;o<i.length;o++){if(l=(a=i[o]).instance,c=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;Ii(s,a,c),r=l}}}if(Be)throw e=Fe,Be=!1,Fe=null,e}function Pi(e,t){var n=t[cs];void 0===n&&(n=t[cs]=new Set);var i=e+"__bubble";n.has(i)||(Bi(t,e,2,!1),n.add(i))}function Ri(e,t,n){var i=0;t&&(i|=4),Bi(n,e,i,t)}var ki="_reactListening"+Math.random().toString(36).slice(2);function Ui(e){if(!e[ki]){e[ki]=!0,o.forEach((function(t){"selectionchange"!==t&&(Di.has(t)||Ri(t,!1,e),Ri(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ki]||(t[ki]=!0,Ri("selectionchange",!1,t))}}function Bi(e,t,n,i){switch(qt(t)){case 1:var s=Gt;break;case 4:s=zt;break;default:s=Wt}n=s.bind(null,t,n,e),s=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),i?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Fi(e,t,n,i,s){var r=i;if(0==(1&t)&&0==(2&t)&&null!==i)e:for(;;){if(null===i)return;var o=i.tag;if(3===o||4===o){var a=i.stateNode.containerInfo;if(a===s||8===a.nodeType&&a.parentNode===s)break;if(4===o)for(o=i.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;o=o.return}for(;null!==a;){if(null===(o=hs(a)))return;if(5===(l=o.tag)||6===l){i=r=o;continue e}a=a.parentNode}}i=i.return}De((function(){var i=r,s=Ee(n),o=[];e:{var a=_i.get(e);if(void 0!==a){var l=ln,c=e;switch(e){case"keypress":if(0===Jt(n))break e;case"keydown":case"keyup":l=wn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=_n;break;case Ei:case Ti:case wi:l=fn;break;case xi:l=Mn;break;case"scroll":l=dn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=gn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xn}var d=0!=(4&t),u=!d&&"scroll"===e,h=d?null!==a?a+"Capture":null:a;d=[];for(var p,m=i;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Ie(m,h))&&d.push(Vi(m,f,p)))),u)break;m=m.return}0<d.length&&(a=new l(a,c,null,n,s),o.push({event:a,listeners:d}))}}if(0==(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Se||!(c=n.relatedTarget||n.fromElement)||!hs(c)&&!c[ls])&&(l||a)&&(a=s.window===s?s:(a=s.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(c=(c=n.relatedTarget||n.toElement)?hs(c):null)&&(c!==(u=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=i),l!==c)){if(d=hn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=xn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?a:ms(l),p=null==c?a:ms(c),(a=new d(f,m+"leave",l,n,s)).target=u,a.relatedTarget=p,f=null,hs(s)===i&&((d=new d(h,m+"enter",c,n,s)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=ji(p))m++;for(p=0,f=h;f;f=ji(f))p++;for(;0<m-p;)d=ji(d),m--;for(;0<p-m;)h=ji(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=ji(d),h=ji(h)}d=null}else d=null;null!==l&&Gi(o,a,l,d,!1),null!==c&&null!==u&&Gi(o,u,c,d,!0)}if("select"===(l=(a=i?ms(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Wn;else if(Fn(a))if(Kn)g=ti;else{g=Jn;var v=Xn}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=ei);switch(g&&(g=g(e,i))?Vn(o,g,n,s):(v&&v(e,a,i),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=i?ms(i):window,e){case"focusin":(Fn(v)||"true"===v.contentEditable)&&(ui=v,hi=i,pi=null);break;case"focusout":pi=hi=ui=null;break;case"mousedown":mi=!0;break;case"contextmenu":case"mouseup":case"dragend":mi=!1,fi(o,n,s);break;case"selectionchange":if(di)break;case"keydown":case"keyup":fi(o,n,s)}var y;if(Cn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Rn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(In&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=Xt()):($t="value"in(Zt=s)?Zt.value:Zt.textContent,Un=!0)),0<(v=Hi(i,b)).length&&(b=new vn(b,e,null,n,s),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=kn(n))&&(b.data=y))),(y=Dn?function(e,t){switch(e){case"compositionend":return kn(t);case"keypress":return 32!==t.which?null:(Pn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Pn?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!Cn&&Rn(e,t)?(e=Xt(),Qt=$t=Zt=null,Un=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return In&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(i=Hi(i,"onBeforeInput")).length&&(s=new vn("onBeforeInput","beforeinput",null,n,s),o.push({event:s,listeners:i}),s.data=y))}Li(o,t)}))}function Vi(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hi(e,t){for(var n=t+"Capture",i=[];null!==e;){var s=e,r=s.stateNode;5===s.tag&&null!==r&&(s=r,null!=(r=Ie(e,n))&&i.unshift(Vi(e,r,s)),null!=(r=Ie(e,t))&&i.push(Vi(e,r,s))),e=e.return}return i}function ji(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gi(e,t,n,i,s){for(var r=t._reactName,o=[];null!==n&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==c&&(a=c,s?null!=(l=Ie(n,r))&&o.unshift(Vi(n,l,a)):s||null!=(l=Ie(n,r))&&o.push(Vi(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var zi=/\r\n?/g,Wi=/\u0000|\uFFFD/g;function Ki(e){return("string"==typeof e?e:""+e).replace(zi,"\n").replace(Wi,"")}function Yi(e,t,n){if(t=Ki(t),Ki(e)!==t&&n)throw Error(r(425))}function qi(){}var Zi=null;function $i(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Qi="function"==typeof setTimeout?setTimeout:void 0,Xi="function"==typeof clearTimeout?clearTimeout:void 0,Ji="function"==typeof Promise?Promise:void 0,es="function"==typeof queueMicrotask?queueMicrotask:void 0!==Ji?function(e){return Ji.resolve(null).then(e).catch(ts)}:Qi;function ts(e){setTimeout((function(){throw e}))}function ns(e,t){var n=t,i=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===i)return e.removeChild(s),void Ht(t);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=s}while(n);Ht(t)}function is(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ss(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var rs=Math.random().toString(36).slice(2),os="__reactFiber$"+rs,as="__reactProps$"+rs,ls="__reactContainer$"+rs,cs="__reactEvents$"+rs,ds="__reactListeners$"+rs,us="__reactHandles$"+rs;function hs(e){var t=e[os];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ls]||n[os]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ss(e);null!==e;){if(n=e[os])return n;e=ss(e)}return t}n=(e=n).parentNode}return null}function ps(e){return!(e=e[os]||e[ls])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ms(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function fs(e){return e[as]||null}var gs=[],vs=-1;function ys(e){return{current:e}}function bs(e){0>vs||(e.current=gs[vs],gs[vs]=null,vs--)}function Ss(e,t){vs++,gs[vs]=e.current,e.current=t}var Es={},Ts=ys(Es),ws=ys(!1),xs=Es;function _s(e,t){var n=e.type.contextTypes;if(!n)return Es;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var s,r={};for(s in n)r[s]=t[s];return i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ms(e){return null!=(e=e.childContextTypes)}function Os(){bs(ws),bs(Ts)}function As(e,t,n){if(Ts.current!==Es)throw Error(r(168));Ss(Ts,t),Ss(ws,n)}function Cs(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var s in i=i.getChildContext())if(!(s in t))throw Error(r(108,G(e)||"Unknown",s));return U({},n,i)}function Ns(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Es,xs=Ts.current,Ss(Ts,e),Ss(ws,ws.current),!0}function Ds(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Cs(e,t,xs),i.__reactInternalMemoizedMergedChildContext=e,bs(ws),bs(Ts),Ss(Ts,e)):bs(ws),Ss(ws,n)}var Is=null,Ls=!1,Ps=!1;function Rs(e){null===Is?Is=[e]:Is.push(e)}function ks(){if(!Ps&&null!==Is){Ps=!0;var e=0,t=yt;try{var n=Is;for(yt=1;e<n.length;e++){var i=n[e];do{i=i(!0)}while(null!==i)}Is=null,Ls=!1}catch(t){throw null!==Is&&(Is=Is.slice(e+1)),Ye(Je,ks),t}finally{yt=t,Ps=!1}}return null}var Us=S.ReactCurrentBatchConfig;function Bs(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Fs=ys(null),Vs=null,Hs=null,js=null;function Gs(){js=Hs=Vs=null}function zs(e){var t=Fs.current;bs(Fs),e._currentValue=t}function Ws(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Ks(e,t){Vs=e,js=Hs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(ma=!0),e.firstContext=null)}function Ys(e){var t=e._currentValue;if(js!==e)if(e={context:e,memoizedValue:t,next:null},null===Hs){if(null===Vs)throw Error(r(308));Hs=e,Vs.dependencies={lanes:0,firstContext:e}}else Hs=Hs.next=e;return t}var qs=null,Zs=!1;function $s(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Xs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Js(e,t){var n=e.updateQueue;null!==n&&(n=n.shared,null!==fl&&0!=(1&e.mode)&&0==(2&ml)?(null===(e=n.interleaved)?(t.next=t,null===qs?qs=[n]:qs.push(n)):(t.next=e.next,e.next=t),n.interleaved=t):(null===(e=n.pending)?t.next=t:(t.next=e.next,e.next=t),n.pending=t))}function er(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}function tr(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var s=null,r=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===r?s=r=o:r=r.next=o,n=n.next}while(null!==n);null===r?s=r=t:r=r.next=t}else s=r=t;return n={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function nr(e,t,n,i){var s=e.updateQueue;Zs=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?r=c:o.next=c,o=l;var d=e.alternate;null!==d&&((a=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===a?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(null!==r){var u=s.baseState;for(o=0,d=c=l=null,a=r;;){var h=a.lane,p=a.eventTime;if((i&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=e,f=a;switch(h=t,p=n,f.tag){case 1:if("function"==typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=f.payload)?m.call(p,u,h):m))break e;u=U({},u,h);break e;case 2:Zs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,o|=h;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(h=a).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===d&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null!==(t=s.shared.interleaved)){s=t;do{o|=s.lane,s=s.next}while(s!==t)}else null===r&&(s.shared.lanes=0);Tl|=o,e.lanes=o,e.memoizedState=u}}function ir(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],s=i.callback;if(null!==s){if(i.callback=null,i=n,"function"!=typeof s)throw Error(r(191,s));s.call(i)}}}var sr=(new i.Component).refs;function rr(e,t,n,i){n=null==(n=n(i,t=e.memoizedState))?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var or={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Fl(),s=Vl(e),r=Xs(i,s);r.payload=t,null!=n&&(r.callback=n),Js(e,r),null!==(t=Hl(e,s,i))&&er(t,e,s)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Fl(),s=Vl(e),r=Xs(i,s);r.tag=1,r.payload=t,null!=n&&(r.callback=n),Js(e,r),null!==(t=Hl(e,s,i))&&er(t,e,s)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Fl(),i=Vl(e),s=Xs(n,i);s.tag=2,null!=t&&(s.callback=t),Js(e,s),null!==(t=Hl(e,i,n))&&er(t,e,i)}};function ar(e,t,n,i,s,r,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,r,o):!t.prototype||!t.prototype.isPureReactComponent||(!ii(n,i)||!ii(s,r))}function lr(e,t,n){var i=!1,s=Es,r=t.contextType;return"object"==typeof r&&null!==r?r=Ys(r):(s=Ms(t)?xs:Ts.current,r=(i=null!=(i=t.contextTypes))?_s(e,s):Es),t=new t(n,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=or,e.stateNode=t,t._reactInternals=e,i&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=r),t}function cr(e,t,n,i){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&or.enqueueReplaceState(t,t.state,null)}function dr(e,t,n,i){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs=sr,$s(e);var r=t.contextType;"object"==typeof r&&null!==r?s.context=Ys(r):(r=Ms(t)?xs:Ts.current,s.context=_s(e,r)),s.state=e.memoizedState,"function"==typeof(r=t.getDerivedStateFromProps)&&(rr(e,t,r,n),s.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof s.getSnapshotBeforeUpdate||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||(t=s.state,"function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&or.enqueueReplaceState(s,s.state,null),nr(e,n,s,i),s.state=e.memoizedState),"function"==typeof s.componentDidMount&&(e.flags|=4194308)}var ur=[],hr=0,pr=null,mr=0,fr=[],gr=0,vr=null,yr=1,br="";function Sr(e,t){ur[hr++]=mr,ur[hr++]=pr,pr=e,mr=t}function Er(e,t,n){fr[gr++]=yr,fr[gr++]=br,fr[gr++]=vr,vr=e;var i=yr;e=br;var s=32-ot(i)-1;i&=~(1<<s),n+=1;var r=32-ot(t)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,yr=1<<32-ot(t)+s|n<<s|i,br=r+e}else yr=1<<r|n<<s|i,br=e}function Tr(e){null!==e.return&&(Sr(e,1),Er(e,1,0))}function wr(e){for(;e===pr;)pr=ur[--hr],ur[hr]=null,mr=ur[--hr],ur[hr]=null;for(;e===vr;)vr=fr[--gr],fr[gr]=null,br=fr[--gr],fr[gr]=null,yr=fr[--gr],fr[gr]=null}var xr=null,_r=null,Mr=!1,Or=null;function Ar(e,t){var n=vc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function Cr(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,xr=e,_r=is(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,xr=e,_r=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==vr?{id:yr,overflow:br}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=vc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,xr=e,_r=null,!0);default:return!1}}function Nr(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function Dr(e){if(Mr){var t=_r;if(t){var n=t;if(!Cr(e,t)){if(Nr(e))throw Error(r(418));t=is(n.nextSibling);var i=xr;t&&Cr(e,t)?Ar(i,n):(e.flags=-4097&e.flags|2,Mr=!1,xr=e)}}else{if(Nr(e))throw Error(r(418));e.flags=-4097&e.flags|2,Mr=!1,xr=e}}}function Ir(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;xr=e}function Lr(e){if(e!==xr)return!1;if(!Mr)return Ir(e),Mr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!$i(e.type,e.memoizedProps)),t&&(t=_r)){if(Nr(e)){for(e=_r;e;)e=is(e.nextSibling);throw Error(r(418))}for(;t;)Ar(e,t),t=is(t.nextSibling)}if(Ir(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){_r=is(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}_r=null}}else _r=xr?is(e.stateNode.nextSibling):null;return!0}function Pr(){_r=xr=null,Mr=!1}function Rr(e){null===Or?Or=[e]:Or.push(e)}function kr(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var s=i,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=s.refs;t===sr&&(t=s.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function Ur(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Br(e){return(0,e._init)(e._payload)}function Fr(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=bc(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=2,n):i:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,i){return null===t||6!==t.tag?((t=wc(n,e.mode,i)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,i){var r=n.type;return r===w?u(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===I&&Br(r)===t.type)?((i=s(t,n.props)).ref=kr(e,t,n),i.return=e,i):((i=Sc(n.type,n.key,n.props,null,e.mode,i)).ref=kr(e,t,n),i.return=e,i)}function d(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=xc(n,e.mode,i)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function u(e,t,n,i,r){return null===t||7!==t.tag?((t=Ec(n,e.mode,i,r)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=wc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case E:return(n=Sc(t.type,t.key,t.props,null,e.mode,n)).ref=kr(e,null,t),n.return=e,n;case T:return(t=xc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Ec(t,e.mode,n,null)).return=e,t;Ur(e,t)}return null}function p(e,t,n,i){var s=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==s?null:l(e,t,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case E:return n.key===s?c(e,t,n,i):null;case T:return n.key===s?d(e,t,n,i):null;case I:return p(e,t,(s=n._init)(n._payload),i)}if(te(n)||R(n))return null!==s?null:u(e,t,n,i,null);Ur(e,n)}return null}function m(e,t,n,i,s){if("string"==typeof i&&""!==i||"number"==typeof i)return l(t,e=e.get(n)||null,""+i,s);if("object"==typeof i&&null!==i){switch(i.$$typeof){case E:return c(t,e=e.get(null===i.key?n:i.key)||null,i,s);case T:return d(t,e=e.get(null===i.key?n:i.key)||null,i,s);case I:return m(e,t,n,(0,i._init)(i._payload),s)}if(te(i)||R(i))return u(t,e=e.get(n)||null,i,s,null);Ur(t,i)}return null}function f(s,r,a,l){for(var c=null,d=null,u=r,f=r=0,g=null;null!==u&&f<a.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var v=p(s,u,a[f],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(s,u),r=o(v,r,f),null===d?c=v:d.sibling=v,d=v,u=g}if(f===a.length)return n(s,u),Mr&&Sr(s,f),c;if(null===u){for(;f<a.length;f++)null!==(u=h(s,a[f],l))&&(r=o(u,r,f),null===d?c=u:d.sibling=u,d=u);return Mr&&Sr(s,f),c}for(u=i(s,u);f<a.length;f++)null!==(g=m(u,s,f,a[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),r=o(g,r,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach((function(e){return t(s,e)})),Mr&&Sr(s,f),c}function g(s,a,l,c){var d=R(l);if("function"!=typeof d)throw Error(r(150));if(null==(l=d.call(l)))throw Error(r(151));for(var u=d=null,f=a,g=a=0,v=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(v=f,f=null):v=f.sibling;var b=p(s,f,y.value,c);if(null===b){null===f&&(f=v);break}e&&f&&null===b.alternate&&t(s,f),a=o(b,a,g),null===u?d=b:u.sibling=b,u=b,f=v}if(y.done)return n(s,f),Mr&&Sr(s,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=h(s,y.value,c))&&(a=o(y,a,g),null===u?d=y:u.sibling=y,u=y);return Mr&&Sr(s,g),d}for(f=i(s,f);!y.done;g++,y=l.next())null!==(y=m(f,s,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),a=o(y,a,g),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach((function(e){return t(s,e)})),Mr&&Sr(s,g),d}return function e(i,r,o,l){if("object"==typeof o&&null!==o&&o.type===w&&null===o.key&&(o=o.props.children),"object"==typeof o&&null!==o){switch(o.$$typeof){case E:e:{for(var c=o.key,d=r;null!==d;){if(d.key===c){if((c=o.type)===w){if(7===d.tag){n(i,d.sibling),(r=s(d,o.props.children)).return=i,i=r;break e}}else if(d.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===I&&Br(c)===d.type){n(i,d.sibling),(r=s(d,o.props)).ref=kr(i,d,o),r.return=i,i=r;break e}n(i,d);break}t(i,d),d=d.sibling}o.type===w?((r=Ec(o.props.children,i.mode,l,o.key)).return=i,i=r):((l=Sc(o.type,o.key,o.props,null,i.mode,l)).ref=kr(i,r,o),l.return=i,i=l)}return a(i);case T:e:{for(d=o.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(i,r.sibling),(r=s(r,o.children||[])).return=i,i=r;break e}n(i,r);break}t(i,r),r=r.sibling}(r=xc(o,i.mode,l)).return=i,i=r}return a(i);case I:return e(i,r,(d=o._init)(o._payload),l)}if(te(o))return f(i,r,o,l);if(R(o))return g(i,r,o,l);Ur(i,o)}return"string"==typeof o&&""!==o||"number"==typeof o?(o=""+o,null!==r&&6===r.tag?(n(i,r.sibling),(r=s(r,o)).return=i,i=r):(n(i,r),(r=wc(o,i.mode,l)).return=i,i=r),a(i)):n(i,r)}}var Vr=Fr(!0),Hr=Fr(!1),jr={},Gr=ys(jr),zr=ys(jr),Wr=ys(jr);function Kr(e){if(e===jr)throw Error(r(174));return e}function Yr(e,t){switch(Ss(Wr,t),Ss(zr,e),Ss(Gr,jr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}bs(Gr),Ss(Gr,t)}function qr(){bs(Gr),bs(zr),bs(Wr)}function Zr(e){Kr(Wr.current);var t=Kr(Gr.current),n=le(t,e.type);t!==n&&(Ss(zr,e),Ss(Gr,n))}function $r(e){zr.current===e&&(bs(Gr),bs(zr))}var Qr=ys(0);function Xr(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jr=[];function eo(){for(var e=0;e<Jr.length;e++)Jr[e]._workInProgressVersionPrimary=null;Jr.length=0}var to=S.ReactCurrentDispatcher,no=S.ReactCurrentBatchConfig,io=0,so=null,ro=null,oo=null,ao=!1,lo=!1,co=0,uo=0;function ho(){throw Error(r(321))}function po(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ni(e[n],t[n]))return!1;return!0}function mo(e,t,n,i,s,o){if(io=o,so=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,to.current=null===e||null===e.memoizedState?$o:Qo,e=n(i,s),lo){o=0;do{if(lo=!1,co=0,25<=o)throw Error(r(301));o+=1,oo=ro=null,t.updateQueue=null,to.current=Xo,e=n(i,s)}while(lo)}if(to.current=Zo,t=null!==ro&&null!==ro.next,io=0,oo=ro=so=null,ao=!1,t)throw Error(r(300));return e}function fo(){var e=0!==co;return co=0,e}function go(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===oo?so.memoizedState=oo=e:oo=oo.next=e,oo}function vo(){if(null===ro){var e=so.alternate;e=null!==e?e.memoizedState:null}else e=ro.next;var t=null===oo?so.memoizedState:oo.next;if(null!==t)oo=t,ro=e;else{if(null===e)throw Error(r(310));e={memoizedState:(ro=e).memoizedState,baseState:ro.baseState,baseQueue:ro.baseQueue,queue:ro.queue,next:null},null===oo?so.memoizedState=oo=e:oo=oo.next=e}return oo}function yo(e,t){return"function"==typeof t?t(e):t}function bo(e){var t=vo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=ro,s=i.baseQueue,o=n.pending;if(null!==o){if(null!==s){var a=s.next;s.next=o.next,o.next=a}i.baseQueue=s=o,n.pending=null}if(null!==s){o=s.next,i=i.baseState;var l=a=null,c=null,d=o;do{var u=d.lane;if((io&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:e(i,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,a=i):c=c.next=h,so.lanes|=u,Tl|=u}d=d.next}while(null!==d&&d!==o);null===c?a=i:c.next=l,ni(i,t.memoizedState)||(ma=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=c,n.lastRenderedState=i}if(null!==(e=n.interleaved)){s=e;do{o=s.lane,so.lanes|=o,Tl|=o,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function So(e){var t=vo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,s=n.pending,o=t.memoizedState;if(null!==s){n.pending=null;var a=s=s.next;do{o=e(o,a.action),a=a.next}while(a!==s);ni(o,t.memoizedState)||(ma=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Eo(){}function To(e,t){var n=so,i=vo(),s=t(),o=!ni(i.memoizedState,s);if(o&&(i.memoizedState=s,ma=!0),i=i.queue,Lo(_o.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==oo&&1&oo.memoizedState.tag){if(n.flags|=2048,Ao(9,xo.bind(null,n,i,s,t),void 0,null),null===fl)throw Error(r(349));0!=(30&io)||wo(n,t,s)}return s}function wo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=so.updateQueue)?(t={lastEffect:null,stores:null},so.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function xo(e,t,n,i){t.value=n,t.getSnapshot=i,Mo(t)&&Hl(e,1,-1)}function _o(e,t,n){return n((function(){Mo(t)&&Hl(e,1,-1)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ni(e,n)}catch(e){return!0}}function Oo(e){var t=go();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yo,lastRenderedState:e},t.queue=e,e=e.dispatch=zo.bind(null,so,e),[t.memoizedState,e]}function Ao(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},null===(t=so.updateQueue)?(t={lastEffect:null,stores:null},so.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Co(){return vo().memoizedState}function No(e,t,n,i){var s=go();so.flags|=e,s.memoizedState=Ao(1|t,n,void 0,void 0===i?null:i)}function Do(e,t,n,i){var s=vo();i=void 0===i?null:i;var r=void 0;if(null!==ro){var o=ro.memoizedState;if(r=o.destroy,null!==i&&po(i,o.deps))return void(s.memoizedState=Ao(t,n,r,i))}so.flags|=e,s.memoizedState=Ao(1|t,n,r,i)}function Io(e,t){return No(8390656,8,e,t)}function Lo(e,t){return Do(2048,8,e,t)}function Po(e,t){return Do(4,2,e,t)}function Ro(e,t){return Do(4,4,e,t)}function ko(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Uo(e,t,n){return n=null!=n?n.concat([e]):null,Do(4,4,ko.bind(null,t,e),n)}function Bo(){}function Fo(e,t){var n=vo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&po(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Vo(e,t){var n=vo();t=void 0===t?null:t;var i=n.memoizedState;return null!==i&&null!==t&&po(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var i=no.transition;no.transition={};try{e(!1),t()}finally{yt=n,no.transition=i}}function jo(){return vo().memoizedState}function Go(e,t,n){var i=Vl(e);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Wo(e)?Ko(t,n):(Yo(e,t,n),null!==(e=Hl(e,i,n=Fl()))&&qo(e,t,i))}function zo(e,t,n){var i=Vl(e),s={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wo(e))Ko(t,s);else{Yo(e,t,s);var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=r(o,n);if(s.hasEagerState=!0,s.eagerState=a,ni(a,o))return}catch(e){}null!==(e=Hl(e,i,n=Fl()))&&qo(e,t,i)}}function Wo(e){var t=e.alternate;return e===so||null!==t&&t===so}function Ko(e,t){lo=ao=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){null!==fl&&0!=(1&e.mode)&&0==(2&ml)?(null===(e=t.interleaved)?(n.next=n,null===qs?qs=[t]:qs.push(t)):(n.next=e.next,e.next=n),t.interleaved=n):(null===(e=t.pending)?n.next=n:(n.next=e.next,e.next=n),t.pending=n)}function qo(e,t,n){if(0!=(4194240&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Zo={readContext:Ys,useCallback:ho,useContext:ho,useEffect:ho,useImperativeHandle:ho,useInsertionEffect:ho,useLayoutEffect:ho,useMemo:ho,useReducer:ho,useRef:ho,useState:ho,useDebugValue:ho,useDeferredValue:ho,useTransition:ho,useMutableSource:ho,useSyncExternalStore:ho,useId:ho,unstable_isNewReconciler:!1},$o={readContext:Ys,useCallback:function(e,t){return go().memoizedState=[e,void 0===t?null:t],e},useContext:Ys,useEffect:Io,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,No(4194308,4,ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return No(4194308,4,e,t)},useInsertionEffect:function(e,t){return No(4,2,e,t)},useMemo:function(e,t){var n=go();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=go();return t=void 0!==n?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Go.bind(null,so,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},go().memoizedState=e},useState:Oo,useDebugValue:Bo,useDeferredValue:function(e){var t=Oo(e),n=t[0],i=t[1];return Io((function(){var t=no.transition;no.transition={};try{i(e)}finally{no.transition=t}}),[e]),n},useTransition:function(){var e=Oo(!1),t=e[0];return e=Ho.bind(null,e[1]),go().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=so,s=go();if(Mr){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===fl)throw Error(r(349));0!=(30&io)||wo(i,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,Io(_o.bind(null,i,o,e),[e]),i.flags|=2048,Ao(9,xo.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=go(),t=fl.identifierPrefix;if(Mr){var n=br;t=":"+t+"R"+(n=(yr&~(1<<32-ot(yr)-1)).toString(32)+n),0<(n=co++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=uo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qo={readContext:Ys,useCallback:Fo,useContext:Ys,useEffect:Lo,useImperativeHandle:Uo,useInsertionEffect:Po,useLayoutEffect:Ro,useMemo:Vo,useReducer:bo,useRef:Co,useState:function(){return bo(yo)},useDebugValue:Bo,useDeferredValue:function(e){var t=bo(yo),n=t[0],i=t[1];return Lo((function(){var t=no.transition;no.transition={};try{i(e)}finally{no.transition=t}}),[e]),n},useTransition:function(){return[bo(yo)[0],vo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:To,useId:jo,unstable_isNewReconciler:!1},Xo={readContext:Ys,useCallback:Fo,useContext:Ys,useEffect:Lo,useImperativeHandle:Uo,useInsertionEffect:Po,useLayoutEffect:Ro,useMemo:Vo,useReducer:So,useRef:Co,useState:function(){return So(yo)},useDebugValue:Bo,useDeferredValue:function(e){var t=So(yo),n=t[0],i=t[1];return Lo((function(){var t=no.transition;no.transition={};try{i(e)}finally{no.transition=t}}),[e]),n},useTransition:function(){return[So(yo)[0],vo().memoizedState]},useMutableSource:Eo,useSyncExternalStore:To,useId:jo,unstable_isNewReconciler:!1};function Jo(e,t){try{var n="",i=t;do{n+=H(i),i=i.return}while(i);var s=n}catch(e){s="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:s}}function ea(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ta,na,ia,sa="function"==typeof WeakMap?WeakMap:Map;function ra(e,t,n){(n=Xs(-1,n)).tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){Cl||(Cl=!0,Nl=i),ea(0,t)},n}function oa(e,t,n){(n=Xs(-1,n)).tag=3;var i=e.type.getDerivedStateFromError;if("function"==typeof i){var s=t.value;n.payload=function(){return i(s)},n.callback=function(){ea(0,t)}}var r=e.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(n.callback=function(){ea(0,t),"function"!=typeof i&&(null===Dl?Dl=new Set([this]):Dl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function aa(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new sa;var s=new Set;i.set(t,s)}else void 0===(s=i.get(t))&&(s=new Set,i.set(t,s));s.has(n)||(s.add(n),e=uc.bind(null,e,t,n),t.then(e,e))}function la(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ca(e,t,n,i,s){return 0==(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Xs(-1,1)).tag=2,Js(n,t))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}function da(e,t){if(!Mr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ua(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,i|=14680064&s.subtreeFlags,i|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function ha(e,t,n){var i=t.pendingProps;switch(wr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ua(t),null;case 1:return Ms(t.type)&&Os(),ua(t),null;case 3:return i=t.stateNode,qr(),bs(ws),bs(Ts),eo(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(Lr(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0==(256&t.flags)||(t.flags|=1024,null!==Or&&(Kl(Or),Or=null))),ua(t),null;case 5:$r(t);var s=Kr(Wr.current);if(n=t.type,null!==e&&null!=t.stateNode)na(e,t,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(r(166));return ua(t),null}if(e=Kr(Gr.current),Lr(t)){i=t.stateNode,n=t.type;var o=t.memoizedProps;switch(i[os]=t,i[as]=o,e=0!=(1&t.mode),n){case"dialog":Pi("cancel",i),Pi("close",i);break;case"iframe":case"object":case"embed":Pi("load",i);break;case"video":case"audio":for(s=0;s<Ni.length;s++)Pi(Ni[s],i);break;case"source":Pi("error",i);break;case"img":case"image":case"link":Pi("error",i),Pi("load",i);break;case"details":Pi("toggle",i);break;case"input":$(i,o),Pi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Pi("invalid",i);break;case"textarea":se(i,o),Pi("invalid",i)}for(var l in ye(n,o),s=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"==typeof c?i.textContent!==c&&(Yi(i.textContent,c,e),s=["children",c]):"number"==typeof c&&i.textContent!==""+c&&(Yi(i.textContent,c,e),s=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Pi("scroll",i)}switch(n){case"input":K(i),J(i,o,!0);break;case"textarea":K(i),oe(i);break;case"select":case"option":break;default:"function"==typeof o.onClick&&(i.onclick=qi)}i=s,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[os]=t,e[as]=i,ta(e,t),t.stateNode=e;e:{switch(l=be(n,i),n){case"dialog":Pi("cancel",e),Pi("close",e),s=i;break;case"iframe":case"object":case"embed":Pi("load",e),s=i;break;case"video":case"audio":for(s=0;s<Ni.length;s++)Pi(Ni[s],e);s=i;break;case"source":Pi("error",e),s=i;break;case"img":case"image":case"link":Pi("error",e),Pi("load",e),s=i;break;case"details":Pi("toggle",e),s=i;break;case"input":$(e,i),s=Z(e,i),Pi("invalid",e);break;case"option":s=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},s=U({},i,{value:void 0}),Pi("invalid",e);break;case"textarea":se(e,i),s=ie(e,i),Pi("invalid",e);break;default:s=i}for(o in ye(n,s),c=s)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?ge(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===o?"string"==typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"==typeof d&&he(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Pi("scroll",e):null!=d&&b(e,o,d,l))}switch(n){case"input":K(e),J(e,i,!1);break;case"textarea":K(e),oe(e);break;case"option":null!=i.value&&e.setAttribute("value",""+z(i.value));break;case"select":e.multiple=!!i.multiple,null!=(o=i.value)?ne(e,!!i.multiple,o,!1):null!=i.defaultValue&&ne(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof s.onClick&&(e.onclick=qi)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return ua(t),null;case 6:if(e&&null!=t.stateNode)ia(0,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(r(166));if(n=Kr(Wr.current),Kr(Gr.current),Lr(t)){if(i=t.stateNode,n=t.memoizedProps,i[os]=t,(o=i.nodeValue!==n)&&null!==(e=xr))switch(l=0!=(1&e.mode),e.tag){case 3:Yi(i.nodeValue,n,l);break;case 5:!0!==e.memoizedProps[void 0]&&Yi(i.nodeValue,n,l)}o&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[os]=t,t.stateNode=i}return ua(t),null;case 13:if(bs(Qr),i=t.memoizedState,Mr&&null!==_r&&0!=(1&t.mode)&&0==(128&t.flags)){for(i=_r;i;)i=is(i.nextSibling);return Pr(),t.flags|=98560,t}if(null!==i&&null!==i.dehydrated){if(i=Lr(t),null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[os]=t}else Pr(),0==(128&t.flags)&&(t.memoizedState=null),t.flags|=4;return ua(t),null}return null!==Or&&(Kl(Or),Or=null),0!=(128&t.flags)?(t.lanes=n,t):(i=null!==i,n=!1,null===e?Lr(t):n=null!==e.memoizedState,i&&!n&&(t.child.flags|=8192,0!=(1&t.mode)&&(null===e||0!=(1&Qr.current)?0===Sl&&(Sl=3):tc())),null!==t.updateQueue&&(t.flags|=4),ua(t),null);case 4:return qr(),null===e&&Ui(t.stateNode.containerInfo),ua(t),null;case 10:return zs(t.type._context),ua(t),null;case 17:return Ms(t.type)&&Os(),ua(t),null;case 19:if(bs(Qr),null===(o=t.memoizedState))return ua(t),null;if(i=0!=(128&t.flags),null===(l=o.rendering))if(i)da(o,!1);else{if(0!==Sl||null!==e&&0!=(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=Xr(e))){for(t.flags|=128,da(o,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ss(Qr,1&Qr.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>Al&&(t.flags|=128,i=!0,da(o,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Xr(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),da(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!Mr)return ua(t),null}else 2*Qe()-o.renderingStartTime>Al&&1073741824!==n&&(t.flags|=128,i=!0,da(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=Qr.current,Ss(Qr,i?1&n|2:1&n),t):(ua(t),null);case 22:case 23:return Ql(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&0!=(1&t.mode)?0!=(1073741824&yl)&&(ua(t),6&t.subtreeFlags&&(t.flags|=8192)):ua(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}ta=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},na=function(e,t,n,i){var s=e.memoizedProps;if(s!==i){e=t.stateNode,Kr(Gr.current);var r,o=null;switch(n){case"input":s=Z(e,s),i=Z(e,i),o=[];break;case"select":s=U({},s,{value:void 0}),i=U({},i,{value:void 0}),o=[];break;case"textarea":s=ie(e,s),i=ie(e,i),o=[];break;default:"function"!=typeof s.onClick&&"function"==typeof i.onClick&&(e.onclick=qi)}for(d in ye(n,i),n=null,s)if(!i.hasOwnProperty(d)&&s.hasOwnProperty(d)&&null!=s[d])if("style"===d){var l=s[d];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(a.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in i){var c=i[d];if(l=null!=s?s[d]:void 0,i.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!=typeof c&&"number"!=typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(a.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Pi("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},ia=function(e,t,n,i){n!==i&&(t.flags|=4)};var pa=S.ReactCurrentOwner,ma=!1;function fa(e,t,n,i){t.child=null===e?Hr(t,null,n,i):Vr(t,e.child,n,i)}function ga(e,t,n,i,s){n=n.render;var r=t.ref;return Ks(t,s),i=mo(e,t,n,i,r,s),n=fo(),null===e||ma?(Mr&&n&&Tr(t),t.flags|=1,fa(e,t,i,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ka(e,t,s))}function va(e,t,n,i,s){if(null===e){var r=n.type;return"function"!=typeof r||yc(r)||void 0!==r.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Sc(n.type,null,i,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,ya(e,t,r,i,s))}if(r=e.child,0==(e.lanes&s)){var o=r.memoizedProps;if((n=null!==(n=n.compare)?n:ii)(o,i)&&e.ref===t.ref)return ka(e,t,s)}return t.flags|=1,(e=bc(r,i)).ref=t.ref,e.return=t,t.child=e}function ya(e,t,n,i,s){if(null!==e&&ii(e.memoizedProps,i)&&e.ref===t.ref){if(ma=!1,0==(e.lanes&s))return t.lanes=e.lanes,ka(e,t,s);0!=(131072&e.flags)&&(ma=!0)}return Ea(e,t,n,i,s)}function ba(e,t,n){var i=t.pendingProps,s=i.children,r=null!==e?e.memoizedState:null;if("hidden"===i.mode)if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},Ss(bl,yl),yl|=n;else{if(0==(1073741824&n))return e=null!==r?r.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,Ss(bl,yl),yl|=e,null;t.memoizedState={baseLanes:0,cachePool:null},i=null!==r?r.baseLanes:n,Ss(bl,yl),yl|=i}else null!==r?(i=r.baseLanes|n,t.memoizedState=null):i=n,Ss(bl,yl),yl|=i;return fa(e,t,s,n),t.child}function Sa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ea(e,t,n,i,s){var r=Ms(n)?xs:Ts.current;return r=_s(t,r),Ks(t,s),n=mo(e,t,n,i,r,s),i=fo(),null===e||ma?(Mr&&i&&Tr(t),t.flags|=1,fa(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ka(e,t,s))}function Ta(e,t,n,i,s){if(Ms(n)){var r=!0;Ns(t)}else r=!1;if(Ks(t,s),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),lr(t,n,i),dr(t,n,i,s),i=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"==typeof c&&null!==c?c=Ys(c):c=_s(t,c=Ms(n)?xs:Ts.current);var d=n.getDerivedStateFromProps,u="function"==typeof d||"function"==typeof o.getSnapshotBeforeUpdate;u||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==i||l!==c)&&cr(t,o,i,c),Zs=!1;var h=t.memoizedState;o.state=h,nr(t,i,o,s),l=t.memoizedState,a!==i||h!==l||ws.current||Zs?("function"==typeof d&&(rr(t,n,d,i),l=t.memoizedState),(a=Zs||ar(t,n,a,i,h,l,c))?(u||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):("function"==typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,Qs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:Bs(t.type,a),o.props=c,u=t.pendingProps,h=o.context,"object"==typeof(l=n.contextType)&&null!==l?l=Ys(l):l=_s(t,l=Ms(n)?xs:Ts.current);var p=n.getDerivedStateFromProps;(d="function"==typeof p||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(a!==u||h!==l)&&cr(t,o,i,l),Zs=!1,h=t.memoizedState,o.state=h,nr(t,i,o,s);var m=t.memoizedState;a!==u||h!==m||ws.current||Zs?("function"==typeof p&&(rr(t,n,p,i),m=t.memoizedState),(c=Zs||ar(t,n,c,i,h,m,l)||!1)?(d||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(i,m,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,m,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=m),o.props=i,o.state=m,o.context=l,i=c):("function"!=typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return wa(e,t,n,i,r,s)}function wa(e,t,n,i,s,r){Sa(e,t);var o=0!=(128&t.flags);if(!i&&!o)return s&&Ds(t,n,!1),ka(e,t,r);i=t.stateNode,pa.current=t;var a=o&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return t.flags|=1,null!==e&&o?(t.child=Vr(t,e.child,null,r),t.child=Vr(t,null,a,r)):fa(e,t,a,r),t.memoizedState=i.state,s&&Ds(t,n,!0),t.child}function xa(e){var t=e.stateNode;t.pendingContext?As(0,t.pendingContext,t.pendingContext!==t.context):t.context&&As(0,t.context,!1),Yr(e,t.containerInfo)}function _a(e,t,n,i,s){return Pr(),Rr(s),t.flags|=256,fa(e,t,n,i),t.child}var Ma={dehydrated:null,treeContext:null,retryLane:0};function Oa(e){return{baseLanes:e,cachePool:null}}function Aa(e,t,n){var i,s=t.pendingProps,o=Qr.current,a=!1,l=0!=(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!=(2&o)),i?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ss(Qr,1&o),null===e)return Dr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0==(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=s.children,e=s.fallback,a?(s=t.mode,a=t.child,o={mode:"hidden",children:o},0==(1&s)&&null!==a?(a.childLanes=0,a.pendingProps=o):a=Tc(o,s,0,null),e=Ec(e,s,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Oa(n),t.memoizedState=Ma,e):Ca(t,o));if(null!==(o=e.memoizedState)){if(null!==(i=o.dehydrated)){if(l)return 256&t.flags?(t.flags&=-257,Ia(e,t,n,Error(r(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=s.fallback,o=t.mode,s=Tc({mode:"visible",children:s.children},o,0,null),(a=Ec(a,o,n,null)).flags|=2,s.return=t,a.return=t,s.sibling=a,t.child=s,0!=(1&t.mode)&&Vr(t,e.child,null,n),t.child.memoizedState=Oa(n),t.memoizedState=Ma,a);if(0==(1&t.mode))t=Ia(e,t,n,null);else if("$!"===i.data)t=Ia(e,t,n,Error(r(419)));else if(s=0!=(n&e.childLanes),ma||s){if(null!==(s=fl)){switch(n&-n){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(s=0!=(a&(s.suspendedLanes|n))?0:a)&&s!==o.retryLane&&(o.retryLane=s,Hl(e,s,-1))}tc(),t=Ia(e,t,n,Error(r(421)))}else"$?"===i.data?(t.flags|=128,t.child=e.child,t=pc.bind(null,e),i._reactRetry=t,t=null):(n=o.treeContext,_r=is(i.nextSibling),xr=t,Mr=!0,Or=null,null!==n&&(fr[gr++]=yr,fr[gr++]=br,fr[gr++]=vr,yr=n.id,br=n.overflow,vr=t),(t=Ca(t,t.pendingProps.children)).flags|=4096);return t}return a?(s=Da(e,t,s.children,s.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?Oa(n):{baseLanes:o.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Ma,s):(n=Na(e,t,s.children,n),t.memoizedState=null,n)}return a?(s=Da(e,t,s.children,s.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?Oa(n):{baseLanes:o.baseLanes|n,cachePool:null},a.childLanes=e.childLanes&~n,t.memoizedState=Ma,s):(n=Na(e,t,s.children,n),t.memoizedState=null,n)}function Ca(e,t){return(t=Tc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Na(e,t,n,i){var s=e.child;return e=s.sibling,n=bc(s,{mode:"visible",children:n}),0==(1&t.mode)&&(n.lanes=i),n.return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n}function Da(e,t,n,i,s){var r=t.mode,o=(e=e.child).sibling,a={mode:"hidden",children:n};return 0==(1&r)&&t.child!==e?((n=t.child).childLanes=0,n.pendingProps=a,t.deletions=null):(n=bc(e,a)).subtreeFlags=14680064&e.subtreeFlags,null!==o?i=bc(o,i):(i=Ec(i,r,s,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,i}function Ia(e,t,n,i){return null!==i&&Rr(i),Vr(t,e.child,null,n),(e=Ca(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function La(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Ws(e.return,t,n)}function Pa(e,t,n,i,s){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:s}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=n,r.tailMode=s)}function Ra(e,t,n){var i=t.pendingProps,s=i.revealOrder,r=i.tail;if(fa(e,t,i.children,n),0!=(2&(i=Qr.current)))i=1&i|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&La(e,n,t);else if(19===e.tag)La(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Ss(Qr,i),0==(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===Xr(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Pa(t,!1,s,n,r);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===Xr(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Pa(t,!0,n,null,r);break;case"together":Pa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ka(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Tl|=t.lanes,0==(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=bc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=bc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ua(e,t){switch(wr(t),t.tag){case 1:return Ms(t.type)&&Os(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return qr(),bs(ws),bs(Ts),eo(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $r(t),null;case 13:if(bs(Qr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));Pr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return bs(Qr),null;case 4:return qr(),null;case 10:return zs(t.type._context),null;case 22:case 23:return Ql(),null;case 24:default:return null}}var Ba=!1,Fa=!1,Va="function"==typeof WeakSet?WeakSet:Set,Ha=null;function ja(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){dc(e,t,n)}else n.current=null}function Ga(e,t,n){try{n()}catch(n){dc(e,t,n)}}var za=!1;function Wa(e,t,n){var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var s=i=i.next;do{if((s.tag&e)===e){var r=s.destroy;s.destroy=void 0,void 0!==r&&Ga(t,n,r)}s=s.next}while(s!==i)}}function Ka(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function Ya(e){var t=e.ref;if(null!==t){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}"function"==typeof t?t(e):t.current=e}}function qa(e,t,n){if(rt&&"function"==typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(st,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var s=i,r=s.destroy;s=s.tag,void 0!==r&&(0!=(2&s)||0!=(4&s))&&Ga(t,n,r),i=i.next}while(i!==e)}break;case 1:if(ja(t,n),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){dc(t,n,e)}break;case 5:ja(t,n);break;case 4:tl(e,t,n)}}function Za(e){var t=e.alternate;null!==t&&(e.alternate=null,Za(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[os],delete t[as],delete t[cs],delete t[ds],delete t[us])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $a(e){return 5===e.tag||3===e.tag||4===e.tag}function Qa(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||$a(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Xa(e){e:{for(var t=e.return;null!==t;){if($a(t))break e;t=t.return}throw Error(r(160))}var n=t;switch(n.tag){case 5:t=n.stateNode,32&n.flags&&(he(t,""),n.flags&=-33),el(e,n=Qa(e),t);break;case 3:case 4:t=n.stateNode.containerInfo,Ja(e,n=Qa(e),t);break;default:throw Error(r(161))}}function Ja(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=qi));else if(4!==i&&null!==(e=e.child))for(Ja(e,t,n),e=e.sibling;null!==e;)Ja(e,t,n),e=e.sibling}function el(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&null!==(e=e.child))for(el(e,t,n),e=e.sibling;null!==e;)el(e,t,n),e=e.sibling}function tl(e,t,n){for(var i,s,o=t,a=!1;;){if(!a){a=o.return;e:for(;;){if(null===a)throw Error(r(160));switch(i=a.stateNode,a.tag){case 5:s=!1;break e;case 3:case 4:i=i.containerInfo,s=!0;break e}a=a.return}a=!0}if(5===o.tag||6===o.tag){e:for(var l=e,c=o,d=n,u=c;;)if(qa(l,u,d),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===c)break e;for(;null===u.sibling;){if(null===u.return||u.return===c)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}s?(l=i,c=o.stateNode,8===l.nodeType?l.parentNode.removeChild(c):l.removeChild(c)):i.removeChild(o.stateNode)}else if(18===o.tag)s?(l=i,c=o.stateNode,8===l.nodeType?ns(l.parentNode,c):1===l.nodeType&&ns(l,c),Ht(l)):ns(i,o.stateNode);else if(4===o.tag){if(null!==o.child){i=o.stateNode.containerInfo,s=!0,o.child.return=o,o=o.child;continue}}else if(qa(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(a=!1)}o.sibling.return=o.return,o=o.sibling}}function nl(e,t){switch(t.tag){case 0:case 11:case 14:case 15:return Wa(3,t,t.return),Ka(3,t),void Wa(5,t,t.return);case 1:return;case 5:var n=t.stateNode;if(null!=n){var i=t.memoizedProps,s=null!==e?e.memoizedProps:i;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for("input"===e&&"radio"===i.type&&null!=i.name&&Q(n,i),be(e,s),t=be(e,i),s=0;s<o.length;s+=2){var a=o[s],l=o[s+1];"style"===a?ge(n,l):"dangerouslySetInnerHTML"===a?ue(n,l):"children"===a?he(n,l):b(n,a,l,t)}switch(e){case"input":X(n,i);break;case"textarea":re(n,i);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!i.multiple,null!=(o=i.value)?ne(n,!!i.multiple,o,!1):e!==!!i.multiple&&(null!=i.defaultValue?ne(n,!!i.multiple,i.defaultValue,!0):ne(n,!!i.multiple,i.multiple?[]:"",!1))}n[as]=i}}return;case 6:if(null===t.stateNode)throw Error(r(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void(null!==e&&e.memoizedState.isDehydrated&&Ht(t.stateNode.containerInfo));case 12:return;case 13:case 19:return void il(t);case 17:return}throw Error(r(163))}function il(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Va),t.forEach((function(t){var i=mc.bind(null,e,t);n.has(t)||(n.add(t),t.then(i,i))}))}}function sl(e,t,n){Ha=e,rl(e,t,n)}function rl(e,t,n){for(var i=0!=(1&e.mode);null!==Ha;){var s=Ha,r=s.child;if(22===s.tag&&i){var o=null!==s.memoizedState||Ba;if(!o){var a=s.alternate,l=null!==a&&null!==a.memoizedState||Fa;a=Ba;var c=Fa;if(Ba=o,(Fa=l)&&!c)for(Ha=s;null!==Ha;)l=(o=Ha).child,22===o.tag&&null!==o.memoizedState?ll(s):null!==l?(l.return=o,Ha=l):ll(s);for(;null!==r;)Ha=r,rl(r,t,n),r=r.sibling;Ha=s,Ba=a,Fa=c}ol(e)}else 0!=(8772&s.subtreeFlags)&&null!==r?(r.return=s,Ha=r):ol(e)}}function ol(e){for(;null!==Ha;){var t=Ha;if(0!=(8772&t.flags)){var n=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Fa||Ka(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Fa)if(null===n)i.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Bs(t.type,n.memoizedProps);i.componentDidUpdate(s,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ir(t,o,i);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}ir(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Ht(h)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(r(163))}Fa||512&t.flags&&Ya(t)}catch(e){dc(t,t.return,e)}}if(t===e){Ha=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ha=n;break}Ha=t.return}}function al(e){for(;null!==Ha;){var t=Ha;if(t===e){Ha=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ha=n;break}Ha=t.return}}function ll(e){for(;null!==Ha;){var t=Ha;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ka(4,t)}catch(e){dc(t,n,e)}break;case 1:var i=t.stateNode;if("function"==typeof i.componentDidMount){var s=t.return;try{i.componentDidMount()}catch(e){dc(t,s,e)}}var r=t.return;try{Ya(t)}catch(e){dc(t,r,e)}break;case 5:var o=t.return;try{Ya(t)}catch(e){dc(t,o,e)}}}catch(e){dc(t,t.return,e)}if(t===e){Ha=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Ha=a;break}Ha=t.return}}var cl,dl=Math.ceil,ul=S.ReactCurrentDispatcher,hl=S.ReactCurrentOwner,pl=S.ReactCurrentBatchConfig,ml=0,fl=null,gl=null,vl=0,yl=0,bl=ys(0),Sl=0,El=null,Tl=0,wl=0,xl=0,_l=null,Ml=null,Ol=0,Al=1/0,Cl=!1,Nl=null,Dl=null,Il=!1,Ll=null,Pl=0,Rl=0,kl=null,Ul=-1,Bl=0;function Fl(){return 0!=(6&ml)?Qe():-1!==Ul?Ul:Ul=Qe()}function Vl(e){return 0==(1&e.mode)?1:0!=(2&ml)&&0!==vl?vl&-vl:null!==Us.transition?(0===Bl&&(e=ct,0==(4194240&(ct<<=1))&&(ct=64),Bl=e),Bl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:qt(e.type)}function Hl(e,t,n){if(50<Rl)throw Rl=0,kl=null,Error(r(185));var i=jl(e,t);return null===i?null:(gt(i,t,n),0!=(2&ml)&&i===fl||(i===fl&&(0==(2&ml)&&(wl|=t),4===Sl&&Yl(i,vl)),Gl(i,n),1===t&&0===ml&&0==(1&e.mode)&&(Al=Qe()+500,Ls&&ks())),i)}function jl(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Gl(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,s=e.expirationTimes,r=e.pendingLanes;0<r;){var o=31-ot(r),a=1<<o,l=s[o];-1===l?0!=(a&n)&&0==(a&i)||(s[o]=pt(a,t)):l<=t&&(e.expiredLanes|=a),r&=~a}}(e,t);var i=ht(e,e===fl?vl:0);if(0===i)null!==n&&qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(null!=n&&qe(n),1===t)0===e.tag?function(e){Ls=!0,Rs(e)}(ql.bind(null,e)):Rs(ql.bind(null,e)),es((function(){0===ml&&ks()})),n=null;else{switch(bt(i)){case 1:n=Je;break;case 4:n=et;break;case 16:n=tt;break;case 536870912:n=it;break;default:n=tt}n=fc(n,zl.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function zl(e,t){if(Ul=-1,Bl=0,0!=(6&ml))throw Error(r(327));var n=e.callbackNode;if(lc()&&e.callbackNode!==n)return null;var i=ht(e,e===fl?vl:0);if(0===i)return null;if(0!=(30&i)||0!=(i&e.expiredLanes)||t)t=nc(e,i);else{t=i;var s=ml;ml|=2;var o=ec();for(fl===e&&vl===t||(Al=Qe()+500,Xl(e,t));;)try{sc();break}catch(t){Jl(e,t)}Gs(),ul.current=o,ml=s,null!==gl?t=0:(fl=null,vl=0,t=Sl)}if(0!==t){if(2===t&&(0!==(s=mt(e))&&(i=s,t=Wl(e,s))),1===t)throw n=El,Xl(e,0),Yl(e,i),Gl(e,Qe()),n;if(6===t)Yl(e,i);else{if(s=e.current.alternate,0==(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var s=n[i],r=s.getSnapshot;s=s.value;try{if(!ni(r(),s))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=nc(e,i))&&(0!==(o=mt(e))&&(i=o,t=Wl(e,o))),1===t))throw n=El,Xl(e,0),Yl(e,i),Gl(e,Qe()),n;switch(e.finishedWork=s,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:ac(e,Ml);break;case 3:if(Yl(e,i),(130023424&i)===i&&10<(t=Ol+500-Qe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&i)!==i){Fl(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Qi(ac.bind(null,e,Ml),t);break}ac(e,Ml);break;case 4:if(Yl(e,i),(4194240&i)===i)break;for(t=e.eventTimes,s=-1;0<i;){var a=31-ot(i);o=1<<a,(a=t[a])>s&&(s=a),i&=~o}if(i=s,10<(i=(120>(i=Qe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*dl(i/1960))-i)){e.timeoutHandle=Qi(ac.bind(null,e,Ml),i);break}ac(e,Ml);break;case 5:ac(e,Ml);break;default:throw Error(r(329))}}}return Gl(e,Qe()),e.callbackNode===n?zl.bind(null,e):null}function Wl(e,t){var n=_l;return e.current.memoizedState.isDehydrated&&(Xl(e,t).flags|=256),2!==(e=nc(e,t))&&(t=Ml,Ml=n,null!==t&&Kl(t)),e}function Kl(e){null===Ml?Ml=e:Ml.push.apply(Ml,e)}function Yl(e,t){for(t&=~xl,t&=~wl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),i=1<<n;e[n]=-1,t&=~i}}function ql(e){if(0!=(6&ml))throw Error(r(327));lc();var t=ht(e,0);if(0==(1&t))return Gl(e,Qe()),null;var n=nc(e,t);if(0!==e.tag&&2===n){var i=mt(e);0!==i&&(t=i,n=Wl(e,i))}if(1===n)throw n=El,Xl(e,0),Yl(e,t),Gl(e,Qe()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ac(e,Ml),Gl(e,Qe()),null}function Zl(e,t){var n=ml;ml|=1;try{return e(t)}finally{0===(ml=n)&&(Al=Qe()+500,Ls&&ks())}}function $l(e){null!==Ll&&0===Ll.tag&&0==(6&ml)&&lc();var t=ml;ml|=1;var n=pl.transition,i=yt;try{if(pl.transition=null,yt=1,e)return e()}finally{yt=i,pl.transition=n,0==(6&(ml=t))&&ks()}}function Ql(){yl=bl.current,bs(bl)}function Xl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Xi(n)),null!==gl)for(n=gl.return;null!==n;){var i=n;switch(wr(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Os();break;case 3:qr(),bs(ws),bs(Ts),eo();break;case 5:$r(i);break;case 4:qr();break;case 13:case 19:bs(Qr);break;case 10:zs(i.type._context);break;case 22:case 23:Ql()}n=n.return}if(fl=e,gl=e=bc(e.current,null),vl=yl=t,Sl=0,El=null,xl=wl=Tl=0,Ml=_l=null,null!==qs){for(t=0;t<qs.length;t++)if(null!==(i=(n=qs[t]).interleaved)){n.interleaved=null;var s=i.next,r=n.pending;if(null!==r){var o=r.next;r.next=s,i.next=o}n.pending=i}qs=null}return e}function Jl(e,t){for(;;){var n=gl;try{if(Gs(),to.current=Zo,ao){for(var i=so.memoizedState;null!==i;){var s=i.queue;null!==s&&(s.pending=null),i=i.next}ao=!1}if(io=0,oo=ro=so=null,lo=!1,co=0,hl.current=null,null===n||null===n.return){Sl=1,El=t,gl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=vl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var d=c,u=l,h=u.tag;if(0==(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=la(a);if(null!==m){m.flags&=-257,ca(m,a,l,0,t),1&m.mode&&aa(o,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0==(1&t)){aa(o,d,t),tc();break e}c=Error(r(426))}else if(Mr&&1&l.mode){var v=la(a);if(null!==v){0==(65536&v.flags)&&(v.flags|=256),ca(v,a,l,0,t),Rr(c);break e}}o=c,4!==Sl&&(Sl=2),null===_l?_l=[o]:_l.push(o),c=Jo(c,l),l=a;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,tr(l,ra(0,c,t));break e;case 1:o=c;var y=l.type,b=l.stateNode;if(0==(128&l.flags)&&("function"==typeof y.getDerivedStateFromError||null!==b&&"function"==typeof b.componentDidCatch&&(null===Dl||!Dl.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,tr(l,oa(l,o,t));break e}}l=l.return}while(null!==l)}oc(n)}catch(e){t=e,gl===n&&null!==n&&(gl=n=n.return);continue}break}}function ec(){var e=ul.current;return ul.current=Zo,null===e?Zo:e}function tc(){0!==Sl&&3!==Sl&&2!==Sl||(Sl=4),null===fl||0==(268435455&Tl)&&0==(268435455&wl)||Yl(fl,vl)}function nc(e,t){var n=ml;ml|=2;var i=ec();for(fl===e&&vl===t||Xl(e,t);;)try{ic();break}catch(t){Jl(e,t)}if(Gs(),ml=n,ul.current=i,null!==gl)throw Error(r(261));return fl=null,vl=0,Sl}function ic(){for(;null!==gl;)rc(gl)}function sc(){for(;null!==gl&&!Ze();)rc(gl)}function rc(e){var t=cl(e.alternate,e,yl);e.memoizedProps=e.pendingProps,null===t?oc(e):gl=t,hl.current=null}function oc(e){var t=e;do{var n=t.alternate;if(e=t.return,0==(32768&t.flags)){if(null!==(n=ha(n,t,yl)))return void(gl=n)}else{if(null!==(n=Ua(n,t)))return n.flags&=32767,void(gl=n);if(null===e)return Sl=6,void(gl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(gl=t);gl=t=e}while(null!==t);0===Sl&&(Sl=5)}function ac(e,t){var n=yt,i=pl.transition;try{pl.transition=null,yt=1,function(e,t,n){do{lc()}while(null!==Ll);if(0!=(6&ml))throw Error(r(327));var i=e.finishedWork,s=e.finishedLanes;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var o=i.lanes|i.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-ot(n),r=1<<s;t[s]=0,i[s]=-1,e[s]=-1,n&=~r}}(e,o),e===fl&&(gl=fl=null,vl=0),0==(2064&i.subtreeFlags)&&0==(2064&i.flags)||Il||(Il=!0,fc(tt,(function(){return lc(),null}))),o=0!=(15990&i.flags),0!=(15990&i.subtreeFlags)||o){o=pl.transition,pl.transition=null;var a=yt;yt=1;var l=ml;ml|=4,hl.current=null,function(e,t){if(li(e=ai())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var s=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(e){n=null;break e}var a=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==s&&3!==h.nodeType||(l=a+s),h!==o||0!==i&&3!==h.nodeType||(c=a+i),3===h.nodeType&&(a+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===s&&(l=a),p===o&&++u===i&&(c=a),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Zi={focusedElem:e,selectionRange:n},Ha=t;null!==Ha;)if(e=(t=Ha).child,0!=(1028&t.subtreeFlags)&&null!==e)e.return=t,Ha=e;else for(;null!==Ha;){t=Ha;try{var f=t.alternate;if(0!=(1024&t.flags))switch(t.tag){case 0:case 11:case 15:break;case 1:if(null!==f){var g=f.memoizedProps,v=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:Bs(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=t.stateNode.containerInfo;if(1===S.nodeType)S.textContent="";else if(9===S.nodeType){var E=S.body;null!=E&&(E.textContent="")}break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(e){dc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Ha=e;break}Ha=t.return}f=za,za=!1}(e,i),function(e,t){for(Ha=t;null!==Ha;){var n=(t=Ha).deletions;if(null!==n)for(var i=0;i<n.length;i++){var s=n[i];try{tl(e,s,t);var r=s.alternate;null!==r&&(r.return=null),s.return=null}catch(e){dc(s,t,e)}}if(n=t.child,0!=(12854&t.subtreeFlags)&&null!==n)n.return=t,Ha=n;else for(;null!==Ha;){t=Ha;try{var o=t.flags;if(32&o&&he(t.stateNode,""),512&o){var a=t.alternate;if(null!==a){var l=a.ref;null!==l&&("function"==typeof l?l(null):l.current=null)}}if(8192&o)switch(t.tag){case 13:if(null!==t.memoizedState){var c=t.alternate;null!==c&&null!==c.memoizedState||(Ol=Qe())}break;case 22:var d=null!==t.memoizedState,u=t.alternate,h=null!==u&&null!==u.memoizedState;e:{s=d;for(var p=null,m=i=n=t;;){if(5===m.tag){if(null===p){p=m;var f=m.stateNode;if(s){var g=f.style;"function"==typeof g.setProperty?g.setProperty("display","none","important"):g.display="none"}else{var v=m.stateNode,y=m.memoizedProps.style,b=null!=y&&y.hasOwnProperty("display")?y.display:null;v.style.display=fe("display",b)}}}else if(6===m.tag)null===p&&(m.stateNode.nodeValue=s?"":m.memoizedProps);else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===i)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===i)break;for(;null===m.sibling;){if(null===m.return||m.return===i)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}if(d&&!h&&0!=(1&n.mode)){Ha=n;for(var S=n.child;null!==S;){for(n=Ha=S;null!==Ha;){var E=(i=Ha).child;switch(i.tag){case 0:case 11:case 14:case 15:Wa(4,i,i.return);break;case 1:ja(i,i.return);var T=i.stateNode;if("function"==typeof T.componentWillUnmount){var w=i.return;try{T.props=i.memoizedProps,T.state=i.memoizedState,T.componentWillUnmount()}catch(e){dc(i,w,e)}}break;case 5:ja(i,i.return);break;case 22:if(null!==i.memoizedState){al(n);continue}}null!==E?(E.return=i,Ha=E):al(n)}S=S.sibling}}}switch(4102&o){case 2:Xa(t),t.flags&=-3;break;case 6:Xa(t),t.flags&=-3,nl(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,nl(t.alternate,t);break;case 4:nl(t.alternate,t)}}catch(e){dc(t,t.return,e)}if(null!==(n=t.sibling)){n.return=t.return,Ha=n;break}Ha=t.return}}}(e,i),ci(Zi),Zi=null,e.current=i,sl(i,e,s),$e(),ml=l,yt=a,pl.transition=o}else e.current=i;if(Il&&(Il=!1,Ll=e,Pl=s),0===(o=e.pendingLanes)&&(Dl=null),function(e){if(rt&&"function"==typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(st,e,void 0,128==(128&e.current.flags))}catch(e){}}(i.stateNode),Gl(e,Qe()),null!==t)for(n=e.onRecoverableError,i=0;i<t.length;i++)n(t[i]);if(Cl)throw Cl=!1,e=Nl,Nl=null,e;0!=(1&Pl)&&0!==e.tag&&lc(),0!=(1&(o=e.pendingLanes))?e===kl?Rl++:(Rl=0,kl=e):Rl=0,ks()}(e,t,n)}finally{pl.transition=i,yt=n}return null}function lc(){if(null!==Ll){var e=bt(Pl),t=pl.transition,n=yt;try{if(pl.transition=null,yt=16>e?16:e,null===Ll)var i=!1;else{if(e=Ll,Ll=null,Pl=0,0!=(6&ml))throw Error(r(331));var s=ml;for(ml|=4,Ha=e.current;null!==Ha;){var o=Ha,a=o.child;if(0!=(16&Ha.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Ha=d;null!==Ha;){var u=Ha;switch(u.tag){case 0:case 11:case 15:Wa(8,u,o)}var h=u.child;if(null!==h)h.return=u,Ha=h;else for(;null!==Ha;){var p=(u=Ha).sibling,m=u.return;if(Za(u),u===d){Ha=null;break}if(null!==p){p.return=m,Ha=p;break}Ha=m}}}var f=o.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Ha=o}}if(0!=(2064&o.subtreeFlags)&&null!==a)a.return=o,Ha=a;else e:for(;null!==Ha;){if(0!=(2048&(o=Ha).flags))switch(o.tag){case 0:case 11:case 15:Wa(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Ha=y;break e}Ha=o.return}}var b=e.current;for(Ha=b;null!==Ha;){var S=(a=Ha).child;if(0!=(2064&a.subtreeFlags)&&null!==S)S.return=a,Ha=S;else e:for(a=b;null!==Ha;){if(0!=(2048&(l=Ha).flags))try{switch(l.tag){case 0:case 11:case 15:Ka(9,l)}}catch(e){dc(l,l.return,e)}if(l===a){Ha=null;break e}var E=l.sibling;if(null!==E){E.return=l.return,Ha=E;break e}Ha=l.return}}if(ml=s,ks(),rt&&"function"==typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(st,e)}catch(e){}i=!0}return i}finally{yt=n,pl.transition=t}}return!1}function cc(e,t,n){Js(e,t=ra(0,t=Jo(n,t),1)),t=Fl(),null!==(e=jl(e,1))&&(gt(e,1,t),Gl(e,t))}function dc(e,t,n){if(3===e.tag)cc(e,e,n);else for(;null!==t;){if(3===t.tag){cc(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Dl||!Dl.has(i))){Js(t,e=oa(t,e=Jo(n,e),1)),e=Fl(),null!==(t=jl(t,1))&&(gt(t,1,e),Gl(t,e));break}}t=t.return}}function uc(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),t=Fl(),e.pingedLanes|=e.suspendedLanes&n,fl===e&&(vl&n)===n&&(4===Sl||3===Sl&&(130023424&vl)===vl&&500>Qe()-Ol?Xl(e,0):xl|=n),Gl(e,t)}function hc(e,t){0===t&&(0==(1&e.mode)?t=1:(t=dt,0==(130023424&(dt<<=1))&&(dt=4194304)));var n=Fl();null!==(e=jl(e,t))&&(gt(e,t,n),Gl(e,n))}function pc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),hc(e,n)}function mc(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(t),hc(e,n)}function fc(e,t){return Ye(e,t)}function gc(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vc(e,t,n,i){return new gc(e,t,n,i)}function yc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function bc(e,t){var n=e.alternate;return null===n?((n=vc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Sc(e,t,n,i,s,o){var a=2;if(i=e,"function"==typeof e)yc(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case w:return Ec(n.children,s,o,t);case x:a=8,s|=8;break;case _:return(e=vc(12,n,t,2|s)).elementType=_,e.lanes=o,e;case C:return(e=vc(13,n,t,s)).elementType=C,e.lanes=o,e;case N:return(e=vc(19,n,t,s)).elementType=N,e.lanes=o,e;case L:return Tc(n,s,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case M:a=10;break e;case O:a=9;break e;case A:a=11;break e;case D:a=14;break e;case I:a=16,i=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=vc(a,n,t,s)).elementType=e,t.type=i,t.lanes=o,t}function Ec(e,t,n,i){return(e=vc(7,e,i,t)).lanes=n,e}function Tc(e,t,n,i){return(e=vc(22,e,i,t)).elementType=L,e.lanes=n,e.stateNode={},e}function wc(e,t,n){return(e=vc(6,e,null,t)).lanes=n,e}function xc(e,t,n){return(t=vc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _c(e,t,n,i,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Mc(e,t,n,i,s,r,o,a,l){return e=new _c(e,t,n,a,l),1===t?(t=1,!0===r&&(t|=8)):t=0,r=vc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null},$s(r),e}function Oc(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}function Ac(e){if(!e)return Es;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ms(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ms(n))return Cs(e,n,t)}return t}function Cc(e,t,n,i,s,r,o,a,l){return(e=Mc(n,i,!0,e,0,r,0,a,l)).context=Ac(null),n=e.current,(r=Xs(i=Fl(),s=Vl(n))).callback=null!=t?t:null,Js(n,r),e.current.lanes=s,gt(e,s,i),Gl(e,i),e}function Nc(e,t,n,i){var s=t.current,r=Fl(),o=Vl(s);return n=Ac(n),null===t.context?t.context=n:t.pendingContext=n,(t=Xs(r,o)).payload={element:e},null!==(i=void 0===i?null:i)&&(t.callback=i),Js(s,t),null!==(e=Hl(s,o,r))&&er(e,s,o),o}function Dc(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Ic(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Lc(e,t){Ic(e,t),(e=e.alternate)&&Ic(e,t)}cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||ws.current)ma=!0;else{if(0==(e.lanes&n)&&0==(128&t.flags))return ma=!1,function(e,t,n){switch(t.tag){case 3:xa(t),Pr();break;case 5:Zr(t);break;case 1:Ms(t.type)&&Ns(t);break;case 4:Yr(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,s=t.memoizedProps.value;Ss(Fs,i._currentValue),i._currentValue=s;break;case 13:if(null!==(i=t.memoizedState))return null!==i.dehydrated?(Ss(Qr,1&Qr.current),t.flags|=128,null):0!=(n&t.child.childLanes)?Aa(e,t,n):(Ss(Qr,1&Qr.current),null!==(e=ka(e,t,n))?e.sibling:null);Ss(Qr,1&Qr.current);break;case 19:if(i=0!=(n&t.childLanes),0!=(128&e.flags)){if(i)return Ra(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ss(Qr,Qr.current),i)break;return null;case 22:case 23:return t.lanes=0,ba(e,t,n)}return ka(e,t,n)}(e,t,n);ma=0!=(131072&e.flags)}else ma=!1,Mr&&0!=(1048576&t.flags)&&Er(t,mr,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var s=_s(t,Ts.current);Ks(t,n),s=mo(null,t,i,e,s,n);var o=fo();return t.flags|=1,"object"==typeof s&&null!==s&&"function"==typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ms(i)?(o=!0,Ns(t)):o=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,$s(t),s.updater=or,t.stateNode=s,s._reactInternals=t,dr(t,i,e,n),t=wa(null,t,i,!0,o,n)):(t.tag=0,Mr&&o&&Tr(t),fa(null,t,s,n),t=t.child),t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(s=i._init)(i._payload),t.type=i,s=t.tag=function(e){if("function"==typeof e)return yc(e)?1:0;if(null!=e){if((e=e.$$typeof)===A)return 11;if(e===D)return 14}return 2}(i),e=Bs(i,e),s){case 0:t=Ea(null,t,i,e,n);break e;case 1:t=Ta(null,t,i,e,n);break e;case 11:t=ga(null,t,i,e,n);break e;case 14:t=va(null,t,i,Bs(i.type,e),n);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,s=t.pendingProps,Ea(e,t,i,s=t.elementType===i?s:Bs(i,s),n);case 1:return i=t.type,s=t.pendingProps,Ta(e,t,i,s=t.elementType===i?s:Bs(i,s),n);case 3:e:{if(xa(t),null===e)throw Error(r(387));i=t.pendingProps,s=(o=t.memoizedState).element,Qs(e,t),nr(t,i,null,n);var a=t.memoizedState;if(i=a.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:a.cache,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=_a(e,t,i,n,s=Error(r(423)));break e}if(i!==s){t=_a(e,t,i,n,s=Error(r(424)));break e}for(_r=is(t.stateNode.containerInfo.firstChild),xr=t,Mr=!0,Or=null,n=Hr(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(Pr(),i===s){t=ka(e,t,n);break e}fa(e,t,i,n)}t=t.child}return t;case 5:return Zr(t),null===e&&Dr(t),i=t.type,s=t.pendingProps,o=null!==e?e.memoizedProps:null,a=s.children,$i(i,s)?a=null:null!==o&&$i(i,o)&&(t.flags|=32),Sa(e,t),fa(e,t,a,n),t.child;case 6:return null===e&&Dr(t),null;case 13:return Aa(e,t,n);case 4:return Yr(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Vr(t,null,i,n):fa(e,t,i,n),t.child;case 11:return i=t.type,s=t.pendingProps,ga(e,t,i,s=t.elementType===i?s:Bs(i,s),n);case 7:return fa(e,t,t.pendingProps,n),t.child;case 8:case 12:return fa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,s=t.pendingProps,o=t.memoizedProps,a=s.value,Ss(Fs,i._currentValue),i._currentValue=a,null!==o)if(ni(o.value,a)){if(o.children===s.children&&!ws.current){t=ka(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===i){if(1===o.tag){(c=Xs(-1,n&-n)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ws(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(r(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ws(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}fa(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,i=t.pendingProps.children,Ks(t,n),i=i(s=Ys(s)),t.flags|=1,fa(e,t,i,n),t.child;case 14:return s=Bs(i=t.type,t.pendingProps),va(e,t,i,s=Bs(i.type,s),n);case 15:return ya(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,s=t.pendingProps,s=t.elementType===i?s:Bs(i,s),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,Ms(i)?(e=!0,Ns(t)):e=!1,Ks(t,n),lr(t,i,s),dr(t,i,s,n),wa(null,t,i,!0,e,n);case 19:return Ra(e,t,n);case 22:return ba(e,t,n)}throw Error(r(156,t.tag))};var Pc="function"==typeof reportError?reportError:function(e){console.error(e)};function Rc(e){this._internalRoot=e}function kc(e){this._internalRoot=e}function Uc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Bc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Fc(){}function Vc(e,t,n,i,s){var r=n._reactRootContainer;if(r){var o=r;if("function"==typeof s){var a=s;s=function(){var e=Dc(o);a.call(e)}}Nc(t,o,e,s)}else o=function(e,t,n,i,s){if(s){if("function"==typeof i){var r=i;i=function(){var e=Dc(o);r.call(e)}}var o=Cc(t,i,e,0,null,!1,0,"",Fc);return e._reactRootContainer=o,e[ls]=o.current,Ui(8===e.nodeType?e.parentNode:e),$l(),o}for(;s=e.lastChild;)e.removeChild(s);if("function"==typeof i){var a=i;i=function(){var e=Dc(l);a.call(e)}}var l=Mc(e,0,!1,null,0,!1,0,"",Fc);return e._reactRootContainer=l,e[ls]=l.current,Ui(8===e.nodeType?e.parentNode:e),$l((function(){Nc(t,l,n,i)})),l}(n,t,e,s,i);return Dc(o)}kc.prototype.render=Rc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Nc(e,t,null,null)},kc.prototype.unmount=Rc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;$l((function(){Nc(null,e,null,null)})),t[ls]=null}},kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&kt(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(vt(t,1|n),Gl(t,Qe()),0==(6&ml)&&(Al=Qe()+500,ks()))}break;case 13:var i=Fl();$l((function(){return Hl(e,1,i)})),Lc(e,1)}},Et=function(e){13===e.tag&&(Hl(e,134217728,Fl()),Lc(e,134217728))},Tt=function(e){if(13===e.tag){var t=Fl(),n=Vl(e);Hl(e,n,t),Lc(e,n)}},wt=function(){return yt},xt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},Te=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var s=fs(i);if(!s)throw Error(r(90));Y(i),X(i,s)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ae=Zl,Ce=$l;var Hc={usingClientEntryPoint:!1,Events:[ps,ms,fs,Me,Oe,Zl]},jc={findFiberByHostInstance:hs,bundleType:0,version:"18.0.0-fc46dba67-20220329",rendererPackageName:"react-dom"},Gc={bundleType:jc.bundleType,version:jc.version,rendererPackageName:jc.rendererPackageName,rendererConfig:jc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:jc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zc.isDisabled&&zc.supportsFiber)try{st=zc.inject(Gc),rt=zc}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Uc(t))throw Error(r(200));return Oc(e,t,null,n)},t.createRoot=function(e,t){if(!Uc(e))throw Error(r(299));var n=!1,i="",s=Pc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=Mc(e,1,!1,null,0,n,0,i,s),e[ls]=t.current,Ui(8===e.nodeType?e.parentNode:e),new Rc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return $l(e)},t.hydrate=function(e,t,n){if(!Bc(t))throw Error(r(200));return Vc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Uc(e))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,s=!1,o="",a=Pc;if(null!=n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Cc(t,null,e,1,null!=n?n:null,s,0,o,a),e[ls]=t.current,Ui(e),i)for(e=0;e<i.length;e++)s=(s=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new kc(t)},t.render=function(e,t,n){if(!Bc(t))throw Error(r(200));return Vc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Bc(e))throw Error(r(40));return!!e._reactRootContainer&&($l((function(){Vc(null,null,e,!1,(function(){e._reactRootContainer=null,e[ls]=null}))})),!0)},t.unstable_batchedUpdates=Zl,t.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Bc(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Vc(e,t,n,!1,i)},t.version="18.0.0-fc46dba67-20220329"},20745:(e,t,n)=>{"use strict";var i=n(73935);t.s=i.createRoot,i.hydrateRoot},73935:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(64448)},69590:e=>{var t="undefined"!=typeof Element,n="function"==typeof Map,i="function"==typeof Set,s="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function r(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){if(e.constructor!==o.constructor)return!1;var a,l,c,d;if(Array.isArray(e)){if((a=e.length)!=o.length)return!1;for(l=a;0!=l--;)if(!r(e[l],o[l]))return!1;return!0}if(n&&e instanceof Map&&o instanceof Map){if(e.size!==o.size)return!1;for(d=e.entries();!(l=d.next()).done;)if(!o.has(l.value[0]))return!1;for(d=e.entries();!(l=d.next()).done;)if(!r(l.value[1],o.get(l.value[0])))return!1;return!0}if(i&&e instanceof Set&&o instanceof Set){if(e.size!==o.size)return!1;for(d=e.entries();!(l=d.next()).done;)if(!o.has(l.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(o)){if((a=e.length)!=o.length)return!1;for(l=a;0!=l--;)if(e[l]!==o[l])return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===o.toString();if((a=(c=Object.keys(e)).length)!==Object.keys(o).length)return!1;for(l=a;0!=l--;)if(!Object.prototype.hasOwnProperty.call(o,c[l]))return!1;if(t&&e instanceof Element)return!1;for(l=a;0!=l--;)if(("_owner"!==c[l]&&"__v"!==c[l]&&"__o"!==c[l]||!e.$$typeof)&&!r(e[c[l]],o[c[l]]))return!1;return!0}return e!=e&&o!=o}e.exports=function(e,t){try{return r(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}}},75251:(e,t,n)=>{"use strict";var i=n(67294),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var i,r={},c=null,d=null;for(i in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,i)&&!l.hasOwnProperty(i)&&(r[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===r[i]&&(r[i]=t[i]);return{$$typeof:s,type:e,key:c,ref:d,props:r,_owner:a.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},72408:(e,t)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var S=b.prototype=new y;S.constructor=b,f(S,v.prototype),S.isPureReactComponent=!0;var E=Array.isArray,T=Object.prototype.hasOwnProperty,w={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,i){var s,r={},o=null,a=null;if(null!=t)for(s in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)T.call(t,s)&&!x.hasOwnProperty(s)&&(r[s]=t[s]);var l=arguments.length-2;if(1===l)r.children=i;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===r[s]&&(r[s]=l[s]);return{$$typeof:n,type:e,key:o,ref:a,props:r,_owner:w.current}}function M(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var O=/\/+/g;function A(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,s,r,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case i:l=!0}}if(l)return o=o(l=e),e=""===r?"."+A(l,0):r,E(o)?(s="",null!=e&&(s=e.replace(O,"$&/")+"/"),C(o,t,s,"",(function(e){return e}))):null!=o&&(M(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,s+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(O,"$&/")+"/")+e)),t.push(o)),1;if(l=0,r=""===r?".":r+":",E(e))for(var c=0;c<e.length;c++){var d=r+A(a=e[c],c);l+=C(a,t,s,d,o)}else if("function"==typeof(d=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e)))for(e=d.call(e),c=0;!(a=e.next()).done;)l+=C(a=a.value,t,s,d=r+A(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var i=[],s=0;return C(e,i,"","",(function(e){return t.call(n,e,s++)})),i}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},L={transition:null},P={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:L,ReactCurrentOwner:w};t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=o,t.PureComponent=b,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=f({},e.props),r=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=w.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T.call(t,c)&&!x.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=i;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:n,type:e.type,key:r,ref:o,props:s,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=M,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.0.0-fc46dba67-20220329"},67294:(e,t,n)=>{"use strict";e.exports=n(72408)},85893:(e,t,n)=>{"use strict";e.exports=n(75251)},91033:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var i=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,i){return e[0]===t&&(n=i,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),i=this.__entries__[n];return i&&i[1]},t.prototype.set=function(t,n){var i=e(this.__entries__,t);~i?this.__entries__[i][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,i=e(n,t);~i&&n.splice(i,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,i=this.__entries__;n<i.length;n++){var s=i[n];e.call(t,s[1],s[0])}},t}()}(),s="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r=void 0!==n.g&&n.g.Math===Math?n.g:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),o="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var a=["top","right","bottom","left","width","height","size","weight"],l="undefined"!=typeof MutationObserver,c=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var n=!1,i=!1,s=0;function r(){n&&(n=!1,e()),i&&l()}function a(){o(r)}function l(){var e=Date.now();if(n){if(e-s<2)return;i=!0}else n=!0,i=!1,setTimeout(a,t);s=e}return l}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){s&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){s&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;a.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),d=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var s=i[n];Object.defineProperty(e,s,{value:t[s],enumerable:!1,writable:!1,configurable:!0})}return e},u=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||r},h=y(0,0,0,0);function p(e){return parseFloat(e)||0}function m(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+p(e["border-"+n+"-width"])}),0)}function f(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return h;var i=u(e).getComputedStyle(e),s=function(e){for(var t={},n=0,i=["top","right","bottom","left"];n<i.length;n++){var s=i[n],r=e["padding-"+s];t[s]=p(r)}return t}(i),r=s.left+s.right,o=s.top+s.bottom,a=p(i.width),l=p(i.height);if("border-box"===i.boxSizing&&(Math.round(a+r)!==t&&(a-=m(i,"left","right")+r),Math.round(l+o)!==n&&(l-=m(i,"top","bottom")+o)),!function(e){return e===u(e).document.documentElement}(e)){var c=Math.round(a+r)-t,d=Math.round(l+o)-n;1!==Math.abs(c)&&(a-=c),1!==Math.abs(d)&&(l-=d)}return y(s.left,s.top,a,l)}var g="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof u(e).SVGGraphicsElement}:function(e){return e instanceof u(e).SVGElement&&"function"==typeof e.getBBox};function v(e){return s?g(e)?function(e){var t=e.getBBox();return y(0,0,t.width,t.height)}(e):f(e):h}function y(e,t,n,i){return{x:e,y:t,width:n,height:i}}var b=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=y(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=v(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),S=function(e,t){var n,i,s,r,o,a,l,c=(i=(n=t).x,s=n.y,r=n.width,o=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),d(l,{x:i,y:s,width:r,height:o,top:s,right:i+r,bottom:o+s,left:i}),l);d(this,{target:e,contentRect:c})},E=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new i,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new b(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof u(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new S(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),T="undefined"!=typeof WeakMap?new WeakMap:new i,w=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=c.getInstance(),i=new E(t,n,this);T.set(this,i)};["observe","unobserve","disconnect"].forEach((function(e){w.prototype[e]=function(){var t;return(t=T.get(this))[e].apply(t,arguments)}}));const x=void 0!==r.ResizeObserver?r.ResizeObserver:w},60053:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,s=e[i];if(!(0<r(s,t)))break e;e[i]=t,e[n]=s,n=i}}function i(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,s=e.length,o=s>>>1;i<o;){var a=2*(i+1)-1,l=e[a],c=a+1,d=e[c];if(0>r(l,n))c<s&&0>r(d,l)?(e[i]=d,e[c]=n,i=c):(e[i]=l,e[a]=n,i=a);else{if(!(c<s&&0>r(d,n)))break e;e[i]=d,e[c]=n,i=c}}}return t}function r(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,v="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function S(e){for(var t=i(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,n(c,t)}t=i(d)}}function E(e){if(g=!1,S(e),!f)if(null!==i(c))f=!0,L(T);else{var t=i(d);null!==t&&P(E,t.startTime-e)}}function T(e,n){f=!1,g&&(g=!1,y(M),M=-1),m=!0;var r=p;try{for(S(n),h=i(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var o=h.callback;if("function"==typeof o){h.callback=null,p=h.priorityLevel;var a=o(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?h.callback=a:h===i(c)&&s(c),S(n)}else s(c);h=i(c)}if(null!==h)var l=!0;else{var u=i(d);null!==u&&P(E,u.startTime-n),l=!1}return l}finally{h=null,p=r,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,x=!1,_=null,M=-1,O=5,A=-1;function C(){return!(t.unstable_now()-A<O)}function N(){if(null!==_){var e=t.unstable_now();A=e;var n=!0;try{n=_(!0,e)}finally{n?w():(x=!1,_=null)}}else x=!1}if("function"==typeof b)w=function(){b(N)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,I=D.port2;D.port1.onmessage=N,w=function(){I.postMessage(null)}}else w=function(){v(N,0)};function L(e){_=e,x||(x=!0,w())}function P(e,n){M=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,L(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return i(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,s,r){var o=t.unstable_now();switch("object"==typeof r&&null!==r?r="number"==typeof(r=r.delay)&&0<r?o+r:o:r=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:u++,callback:s,priorityLevel:e,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>o?(e.sortIndex=r,n(d,e),null===i(c)&&e===i(d)&&(g?(y(M),M=-1):g=!0,P(E,r-o))):(e.sortIndex=a,n(c,e),f||m||(f=!0,L(T))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},63840:(e,t,n)=>{"use strict";e.exports=n(60053)},61040:(e,t,n)=>{"use strict";var i=n(11132),s=n(22566),r=n(21924)("String.prototype.replace"),o=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;e.exports=function(){var e=s(i(this));return r(r(e,o,""),a,"")}},46057:(e,t,n)=>{"use strict";var i=n(55559),s=n(4289),r=n(61040),o=n(30254),a=n(60029),l=i(o());s(l,{getPolyfill:o,implementation:r,shim:a}),e.exports=l},11132:(e,t,n)=>{"use strict";e.exports=n(37981)},22566:(e,t,n)=>{"use strict";var i=n(18989),s=i("%String%"),r=i("%TypeError%");e.exports=function(e){if("symbol"==typeof e)throw new r("Cannot convert a Symbol value to a string");return s(e)}},37981:(e,t,n)=>{"use strict";var i=n(18989)("%TypeError%");e.exports=function(e,t){if(null==e)throw new i(t||"Cannot call method on "+e);return e}},18989:(e,t,n)=>{"use strict";var i,s=SyntaxError,r=Function,o=TypeError,a=function(e){try{return Function('"use strict"; return ('+e+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(e){l=null}var c=function(){throw new o},d=l?function(){try{return c}catch(e){try{return l(arguments,"callee").get}catch(e){return c}}}():c,u=n(41405)(),h=Object.getPrototypeOf||function(e){return e.__proto__},p=a("async function* () {}"),m=p?p.prototype:i,f=m?m.prototype:i,g="undefined"==typeof Uint8Array?i:h(Uint8Array),v={"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":u?h([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":a("async function () {}"),"%AsyncGenerator%":m,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":f?h(f):i,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":r,"%GeneratorFunction%":a("function* () {}"),"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u?h(h([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&u?h((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&u?h((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u?h(""[Symbol.iterator]()):i,"%Symbol%":u?Symbol:i,"%SyntaxError%":s,"%ThrowTypeError%":d,"%TypedArray%":g,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet},y={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=n(58612),S=n(17642),E=b.call(Function.call,Array.prototype.concat),T=b.call(Function.apply,Array.prototype.splice),w=b.call(Function.call,String.prototype.replace),x=b.call(Function.call,String.prototype.slice),_=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M=/\\(\\)?/g,O=function(e){var t=x(e,0,1),n=x(e,-1);if("%"===t&&"%"!==n)throw new s("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new s("invalid intrinsic syntax, expected opening `%`");var i=[];return w(e,_,(function(e,t,n,s){i[i.length]=n?w(s,M,"$1"):t||e})),i},A=function(e,t){var n,i=e;if(S(y,i)&&(i="%"+(n=y[i])[0]+"%"),S(v,i)){var r=v[i];if(void 0===r&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:r}}throw new s("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');var n=O(e),i=n.length>0?n[0]:"",r=A("%"+i+"%",t),a=r.name,c=r.value,d=!1,u=r.alias;u&&(i=u[0],T(n,E([0,1],u)));for(var h=1,p=!0;h<n.length;h+=1){var m=n[h],f=x(m,0,1),g=x(m,-1);if(('"'===f||"'"===f||"`"===f||'"'===g||"'"===g||"`"===g)&&f!==g)throw new s("property names with quotes must have matching quotes");if("constructor"!==m&&p||(d=!0),S(v,a="%"+(i+="."+m)+"%"))c=v[a];else if(null!=c){if(!(m in c)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(l&&h+1>=n.length){var y=l(c,m);c=(p=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:c[m]}else p=S(c,m),c=c[m];p&&!d&&(v[a]=c)}}return c}},30254:(e,t,n)=>{"use strict";var i=n(61040);e.exports=function(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:i}},60029:(e,t,n)=>{"use strict";var i=n(4289),s=n(30254);e.exports=function(){var e=s();return i(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}},67121:(e,t,n)=>{"use strict";e=n.hmd(e);!function(e){var t,n=e.Symbol;if("function"==typeof n)if(n.observable)t=n.observable;else{t=n.for("https://github.com/benlesh/symbol-observable");try{n.observable=t}catch(e){}}else t="@@observable"}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:e)},2212:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ACESFilmicToneMapping:()=>ne,AddEquation:()=>_,AddOperation:()=>Q,AdditiveAnimationBlendMode:()=>At,AdditiveBlending:()=>E,AlphaFormat:()=>Pe,AlwaysDepth:()=>j,AlwaysStencilFunc:()=>nn,AmbientLight:()=>AmbientLight,AmbientLightProbe:()=>AmbientLightProbe,AnimationClip:()=>AnimationClip,AnimationLoader:()=>AnimationLoader,AnimationMixer:()=>AnimationMixer,AnimationObjectGroup:()=>AnimationObjectGroup,AnimationUtils:()=>Il,ArcCurve:()=>ArcCurve,ArrayCamera:()=>ArrayCamera,ArrowHelper:()=>ArrowHelper,Audio:()=>Audio,AudioAnalyser:()=>AudioAnalyser,AudioContext:()=>Yl,AudioListener:()=>AudioListener,AudioLoader:()=>AudioLoader,AxesHelper:()=>AxesHelper,AxisHelper:()=>AxisHelper,BackSide:()=>f,BasicDepthPacking:()=>Pt,BasicShadowMap:()=>d,BinaryTextureLoader:()=>BinaryTextureLoader,Bone:()=>Bone,BooleanKeyframeTrack:()=>BooleanKeyframeTrack,BoundingBoxHelper:()=>BoundingBoxHelper,Box2:()=>Box2,Box3:()=>Box3,Box3Helper:()=>Box3Helper,BoxBufferGeometry:()=>BoxGeometry,BoxGeometry:()=>BoxGeometry,BoxHelper:()=>BoxHelper,BufferAttribute:()=>BufferAttribute,BufferGeometry:()=>BufferGeometry,BufferGeometryLoader:()=>BufferGeometryLoader,ByteType:()=>xe,Cache:()=>Pl,Camera:()=>Camera,CameraHelper:()=>CameraHelper,CanvasRenderer:()=>ed,CanvasTexture:()=>CanvasTexture,CapsuleBufferGeometry:()=>CapsuleGeometry,CapsuleGeometry:()=>CapsuleGeometry,CatmullRomCurve3:()=>CatmullRomCurve3,CineonToneMapping:()=>te,CircleBufferGeometry:()=>CircleGeometry,CircleGeometry:()=>CircleGeometry,ClampToEdgeWrapping:()=>ue,Clock:()=>Clock,Color:()=>Color,ColorKeyframeTrack:()=>ColorKeyframeTrack,ColorManagement:()=>Rn,CompressedTexture:()=>CompressedTexture,CompressedTextureLoader:()=>CompressedTextureLoader,ConeBufferGeometry:()=>ConeGeometry,ConeGeometry:()=>ConeGeometry,CubeCamera:()=>CubeCamera,CubeReflectionMapping:()=>re,CubeRefractionMapping:()=>oe,CubeTexture:()=>CubeTexture,CubeTextureLoader:()=>CubeTextureLoader,CubeUVReflectionMapping:()=>ce,CubicBezierCurve:()=>CubicBezierCurve,CubicBezierCurve3:()=>CubicBezierCurve3,CubicInterpolant:()=>CubicInterpolant,CullFaceBack:()=>a,CullFaceFront:()=>l,CullFaceFrontBack:()=>c,CullFaceNone:()=>o,Curve:()=>Curve,CurvePath:()=>CurvePath,CustomBlending:()=>x,CustomToneMapping:()=>ie,CylinderBufferGeometry:()=>CylinderGeometry,CylinderGeometry:()=>CylinderGeometry,Cylindrical:()=>Cylindrical,Data3DTexture:()=>Data3DTexture,DataArrayTexture:()=>DataArrayTexture,DataTexture:()=>DataTexture,DataTexture2DArray:()=>DataTexture2DArray,DataTexture3D:()=>DataTexture3D,DataTextureLoader:()=>DataTextureLoader,DataUtils:()=>DataUtils,DecrementStencilOp:()=>Wt,DecrementWrapStencilOp:()=>Yt,DefaultLoadingManager:()=>Rl,DepthFormat:()=>Fe,DepthStencilFormat:()=>Ve,DepthTexture:()=>DepthTexture,DirectionalLight:()=>DirectionalLight,DirectionalLightHelper:()=>DirectionalLightHelper,DiscreteInterpolant:()=>DiscreteInterpolant,DodecahedronBufferGeometry:()=>DodecahedronGeometry,DodecahedronGeometry:()=>DodecahedronGeometry,DoubleSide:()=>g,DstAlphaFactor:()=>k,DstColorFactor:()=>B,DynamicBufferAttribute:()=>DynamicBufferAttribute,DynamicCopyUsage:()=>un,DynamicDrawUsage:()=>rn,DynamicReadUsage:()=>ln,EdgesGeometry:()=>EdgesGeometry,EdgesHelper:()=>EdgesHelper,EllipseCurve:()=>EllipseCurve,EqualDepth:()=>W,EqualStencilFunc:()=>Qt,EquirectangularReflectionMapping:()=>ae,EquirectangularRefractionMapping:()=>le,Euler:()=>Euler,EventDispatcher:()=>EventDispatcher,ExtrudeBufferGeometry:()=>ExtrudeGeometry,ExtrudeGeometry:()=>ExtrudeGeometry,FaceColors:()=>$c,FileLoader:()=>FileLoader,FlatShading:()=>v,Float16BufferAttribute:()=>Float16BufferAttribute,Float32Attribute:()=>Float32Attribute,Float32BufferAttribute:()=>Float32BufferAttribute,Float64Attribute:()=>Float64Attribute,Float64BufferAttribute:()=>Float64BufferAttribute,FloatType:()=>Ce,Fog:()=>Fog,FogExp2:()=>FogExp2,Font:()=>rd,FontLoader:()=>sd,FramebufferTexture:()=>FramebufferTexture,FrontSide:()=>m,Frustum:()=>Frustum,GLBufferAttribute:()=>GLBufferAttribute,GLSL1:()=>pn,GLSL3:()=>mn,GreaterDepth:()=>Y,GreaterEqualDepth:()=>K,GreaterEqualStencilFunc:()=>tn,GreaterStencilFunc:()=>Jt,GridHelper:()=>GridHelper,Group:()=>Group,HalfFloatType:()=>Ne,HemisphereLight:()=>HemisphereLight,HemisphereLightHelper:()=>HemisphereLightHelper,HemisphereLightProbe:()=>HemisphereLightProbe,IcosahedronBufferGeometry:()=>IcosahedronGeometry,IcosahedronGeometry:()=>IcosahedronGeometry,ImageBitmapLoader:()=>ImageBitmapLoader,ImageLoader:()=>ImageLoader,ImageUtils:()=>ImageUtils,ImmediateRenderObject:()=>od,IncrementStencilOp:()=>zt,IncrementWrapStencilOp:()=>Kt,InstancedBufferAttribute:()=>InstancedBufferAttribute,InstancedBufferGeometry:()=>InstancedBufferGeometry,InstancedInterleavedBuffer:()=>InstancedInterleavedBuffer,InstancedMesh:()=>InstancedMesh,Int16Attribute:()=>Int16Attribute,Int16BufferAttribute:()=>Int16BufferAttribute,Int32Attribute:()=>Int32Attribute,Int32BufferAttribute:()=>Int32BufferAttribute,Int8Attribute:()=>Int8Attribute,Int8BufferAttribute:()=>Int8BufferAttribute,IntType:()=>Oe,InterleavedBuffer:()=>InterleavedBuffer,InterleavedBufferAttribute:()=>InterleavedBufferAttribute,Interpolant:()=>Interpolant,InterpolateDiscrete:()=>Et,InterpolateLinear:()=>Tt,InterpolateSmooth:()=>wt,InvertStencilOp:()=>qt,JSONLoader:()=>td,KeepStencilOp:()=>jt,KeyframeTrack:()=>KeyframeTrack,LOD:()=>LOD,LatheBufferGeometry:()=>LatheGeometry,LatheGeometry:()=>LatheGeometry,Layers:()=>Layers,LensFlare:()=>id,LessDepth:()=>G,LessEqualDepth:()=>z,LessEqualStencilFunc:()=>Xt,LessStencilFunc:()=>$t,Light:()=>Light,LightProbe:()=>LightProbe,Line:()=>Line,Line3:()=>Line3,LineBasicMaterial:()=>LineBasicMaterial,LineCurve:()=>LineCurve,LineCurve3:()=>LineCurve3,LineDashedMaterial:()=>LineDashedMaterial,LineLoop:()=>LineLoop,LinePieces:()=>qc,LineSegments:()=>LineSegments,LineStrip:()=>Yc,LinearEncoding:()=>It,LinearFilter:()=>ye,LinearInterpolant:()=>LinearInterpolant,LinearMipMapLinearFilter:()=>Te,LinearMipMapNearestFilter:()=>Se,LinearMipmapLinearFilter:()=>Ee,LinearMipmapNearestFilter:()=>be,LinearSRGBColorSpace:()=>Vt,LinearToneMapping:()=>J,Loader:()=>Loader,LoaderUtils:()=>LoaderUtils,LoadingManager:()=>LoadingManager,LoopOnce:()=>yt,LoopPingPong:()=>St,LoopRepeat:()=>bt,LuminanceAlphaFormat:()=>Be,LuminanceFormat:()=>Ue,MOUSE:()=>s,Material:()=>Material,MaterialLoader:()=>MaterialLoader,Math:()=>On,MathUtils:()=>On,Matrix3:()=>Matrix3,Matrix4:()=>Matrix4,MaxEquation:()=>C,Mesh:()=>Mesh,MeshBasicMaterial:()=>MeshBasicMaterial,MeshDepthMaterial:()=>MeshDepthMaterial,MeshDistanceMaterial:()=>MeshDistanceMaterial,MeshFaceMaterial:()=>Xc,MeshLambertMaterial:()=>MeshLambertMaterial,MeshMatcapMaterial:()=>MeshMatcapMaterial,MeshNormalMaterial:()=>MeshNormalMaterial,MeshPhongMaterial:()=>MeshPhongMaterial,MeshPhysicalMaterial:()=>MeshPhysicalMaterial,MeshStandardMaterial:()=>MeshStandardMaterial,MeshToonMaterial:()=>MeshToonMaterial,MinEquation:()=>A,MirroredRepeatWrapping:()=>he,MixOperation:()=>$,MultiMaterial:()=>Jc,MultiplyBlending:()=>w,MultiplyOperation:()=>Z,NearestFilter:()=>pe,NearestMipMapLinearFilter:()=>ve,NearestMipMapNearestFilter:()=>fe,NearestMipmapLinearFilter:()=>ge,NearestMipmapNearestFilter:()=>me,NeverDepth:()=>H,NeverStencilFunc:()=>Zt,NoBlending:()=>b,NoColorSpace:()=>Bt,NoColors:()=>Zc,NoToneMapping:()=>X,NormalAnimationBlendMode:()=>Ot,NormalBlending:()=>S,NotEqualDepth:()=>q,NotEqualStencilFunc:()=>en,NumberKeyframeTrack:()=>NumberKeyframeTrack,Object3D:()=>Object3D,ObjectLoader:()=>ObjectLoader,ObjectSpaceNormalMap:()=>Ut,OctahedronBufferGeometry:()=>OctahedronGeometry,OctahedronGeometry:()=>OctahedronGeometry,OneFactor:()=>D,OneMinusDstAlphaFactor:()=>U,OneMinusDstColorFactor:()=>F,OneMinusSrcAlphaFactor:()=>R,OneMinusSrcColorFactor:()=>L,OrthographicCamera:()=>OrthographicCamera,PCFShadowMap:()=>u,PCFSoftShadowMap:()=>h,PMREMGenerator:()=>PMREMGenerator,ParametricGeometry:()=>ParametricGeometry,Particle:()=>Particle,ParticleBasicMaterial:()=>ParticleBasicMaterial,ParticleSystem:()=>ParticleSystem,ParticleSystemMaterial:()=>ParticleSystemMaterial,Path:()=>Path,PerspectiveCamera:()=>PerspectiveCamera,Plane:()=>Plane,PlaneBufferGeometry:()=>PlaneGeometry,PlaneGeometry:()=>PlaneGeometry,PlaneHelper:()=>PlaneHelper,PointCloud:()=>PointCloud,PointCloudMaterial:()=>PointCloudMaterial,PointLight:()=>PointLight,PointLightHelper:()=>PointLightHelper,Points:()=>Points,PointsMaterial:()=>PointsMaterial,PolarGridHelper:()=>PolarGridHelper,PolyhedronBufferGeometry:()=>PolyhedronGeometry,PolyhedronGeometry:()=>PolyhedronGeometry,PositionalAudio:()=>PositionalAudio,PropertyBinding:()=>PropertyBinding,PropertyMixer:()=>PropertyMixer,QuadraticBezierCurve:()=>QuadraticBezierCurve,QuadraticBezierCurve3:()=>QuadraticBezierCurve3,Quaternion:()=>Quaternion,QuaternionKeyframeTrack:()=>QuaternionKeyframeTrack,QuaternionLinearInterpolant:()=>QuaternionLinearInterpolant,REVISION:()=>i,RGBADepthPacking:()=>Rt,RGBAFormat:()=>ke,RGBAIntegerFormat:()=>We,RGBA_ASTC_10x10_Format:()=>mt,RGBA_ASTC_10x5_Format:()=>ut,RGBA_ASTC_10x6_Format:()=>ht,RGBA_ASTC_10x8_Format:()=>pt,RGBA_ASTC_12x10_Format:()=>ft,RGBA_ASTC_12x12_Format:()=>gt,RGBA_ASTC_4x4_Format:()=>it,RGBA_ASTC_5x4_Format:()=>st,RGBA_ASTC_5x5_Format:()=>rt,RGBA_ASTC_6x5_Format:()=>ot,RGBA_ASTC_6x6_Format:()=>at,RGBA_ASTC_8x5_Format:()=>lt,RGBA_ASTC_8x6_Format:()=>ct,RGBA_ASTC_8x8_Format:()=>dt,RGBA_BPTC_Format:()=>vt,RGBA_ETC2_EAC_Format:()=>nt,RGBA_PVRTC_2BPPV1_Format:()=>Je,RGBA_PVRTC_4BPPV1_Format:()=>Xe,RGBA_S3TC_DXT1_Format:()=>Ye,RGBA_S3TC_DXT3_Format:()=>qe,RGBA_S3TC_DXT5_Format:()=>Ze,RGBFormat:()=>Re,RGB_ETC1_Format:()=>et,RGB_ETC2_Format:()=>tt,RGB_PVRTC_2BPPV1_Format:()=>Qe,RGB_PVRTC_4BPPV1_Format:()=>$e,RGB_S3TC_DXT1_Format:()=>Ke,RGFormat:()=>Ge,RGIntegerFormat:()=>ze,RawShaderMaterial:()=>RawShaderMaterial,Ray:()=>Ray,Raycaster:()=>Raycaster,RectAreaLight:()=>RectAreaLight,RedFormat:()=>He,RedIntegerFormat:()=>je,ReinhardToneMapping:()=>ee,RepeatWrapping:()=>de,ReplaceStencilOp:()=>Gt,ReverseSubtractEquation:()=>O,RingBufferGeometry:()=>RingGeometry,RingGeometry:()=>RingGeometry,SRGBColorSpace:()=>Ft,Scene:()=>Scene,SceneUtils:()=>nd,ShaderChunk:()=>Rs,ShaderLib:()=>Us,ShaderMaterial:()=>ShaderMaterial,ShadowMaterial:()=>ShadowMaterial,Shape:()=>Shape,ShapeBufferGeometry:()=>ShapeGeometry,ShapeGeometry:()=>ShapeGeometry,ShapePath:()=>ShapePath,ShapeUtils:()=>ShapeUtils,ShortType:()=>_e,Skeleton:()=>Skeleton,SkeletonHelper:()=>SkeletonHelper,SkinnedMesh:()=>SkinnedMesh,SmoothShading:()=>y,Source:()=>Source,Sphere:()=>Sphere,SphereBufferGeometry:()=>SphereGeometry,SphereGeometry:()=>SphereGeometry,Spherical:()=>Spherical,SphericalHarmonics3:()=>SphericalHarmonics3,SplineCurve:()=>SplineCurve,SpotLight:()=>SpotLight,SpotLightHelper:()=>SpotLightHelper,Sprite:()=>Sprite,SpriteMaterial:()=>SpriteMaterial,SrcAlphaFactor:()=>P,SrcAlphaSaturateFactor:()=>V,SrcColorFactor:()=>I,StaticCopyUsage:()=>dn,StaticDrawUsage:()=>sn,StaticReadUsage:()=>an,StereoCamera:()=>StereoCamera,StreamCopyUsage:()=>hn,StreamDrawUsage:()=>on,StreamReadUsage:()=>cn,StringKeyframeTrack:()=>StringKeyframeTrack,SubtractEquation:()=>M,SubtractiveBlending:()=>T,TOUCH:()=>r,TangentSpaceNormalMap:()=>kt,TetrahedronBufferGeometry:()=>TetrahedronGeometry,TetrahedronGeometry:()=>TetrahedronGeometry,TextGeometry:()=>TextGeometry,Texture:()=>Texture,TextureLoader:()=>TextureLoader,TorusBufferGeometry:()=>TorusGeometry,TorusGeometry:()=>TorusGeometry,TorusKnotBufferGeometry:()=>TorusKnotGeometry,TorusKnotGeometry:()=>TorusKnotGeometry,Triangle:()=>Triangle,TriangleFanDrawMode:()=>Dt,TriangleStripDrawMode:()=>Nt,TrianglesDrawMode:()=>Ct,TubeBufferGeometry:()=>TubeGeometry,TubeGeometry:()=>TubeGeometry,UVMapping:()=>se,Uint16Attribute:()=>Uint16Attribute,Uint16BufferAttribute:()=>Uint16BufferAttribute,Uint32Attribute:()=>Uint32Attribute,Uint32BufferAttribute:()=>Uint32BufferAttribute,Uint8Attribute:()=>Uint8Attribute,Uint8BufferAttribute:()=>Uint8BufferAttribute,Uint8ClampedAttribute:()=>Uint8ClampedAttribute,Uint8ClampedBufferAttribute:()=>Uint8ClampedBufferAttribute,Uniform:()=>Uniform,UniformsLib:()=>ks,UniformsUtils:()=>Ms,UnsignedByteType:()=>we,UnsignedInt248Type:()=>Le,UnsignedIntType:()=>Ae,UnsignedShort4444Type:()=>De,UnsignedShort5551Type:()=>Ie,UnsignedShortType:()=>Me,VSMShadowMap:()=>p,Vector2:()=>Vector2,Vector3:()=>Vector3,Vector4:()=>Vector4,VectorKeyframeTrack:()=>VectorKeyframeTrack,Vertex:()=>Vertex,VertexColors:()=>Qc,VideoTexture:()=>VideoTexture,WebGL1Renderer:()=>WebGL1Renderer,WebGL3DRenderTarget:()=>WebGL3DRenderTarget,WebGLArrayRenderTarget:()=>WebGLArrayRenderTarget,WebGLCubeRenderTarget:()=>WebGLCubeRenderTarget,WebGLMultipleRenderTargets:()=>WebGLMultipleRenderTargets,WebGLMultisampleRenderTarget:()=>WebGLMultisampleRenderTarget,WebGLRenderTarget:()=>WebGLRenderTarget,WebGLRenderTargetCube:()=>WebGLRenderTargetCube,WebGLRenderer:()=>ta,WebGLUtils:()=>Xo,WireframeGeometry:()=>WireframeGeometry,WireframeHelper:()=>WireframeHelper,WrapAroundEnding:()=>Mt,XHRLoader:()=>XHRLoader,ZeroCurvatureEnding:()=>xt,ZeroFactor:()=>N,ZeroSlopeEnding:()=>_t,ZeroStencilOp:()=>Ht,_SRGBAFormat:()=>fn,sRGBEncoding:()=>Lt});const i="139",s={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},r={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},o=0,a=1,l=2,c=3,d=0,u=1,h=2,p=3,m=0,f=1,g=2,v=1,y=2,b=0,S=1,E=2,T=3,w=4,x=5,_=100,M=101,O=102,A=103,C=104,N=200,D=201,I=202,L=203,P=204,R=205,k=206,U=207,B=208,F=209,V=210,H=0,j=1,G=2,z=3,W=4,K=5,Y=6,q=7,Z=0,$=1,Q=2,X=0,J=1,ee=2,te=3,ne=4,ie=5,se=300,re=301,oe=302,ae=303,le=304,ce=306,de=1e3,ue=1001,he=1002,pe=1003,me=1004,fe=1004,ge=1005,ve=1005,ye=1006,be=1007,Se=1007,Ee=1008,Te=1008,we=1009,xe=1010,_e=1011,Me=1012,Oe=1013,Ae=1014,Ce=1015,Ne=1016,De=1017,Ie=1018,Le=1020,Pe=1021,Re=1022,ke=1023,Ue=1024,Be=1025,Fe=1026,Ve=1027,He=1028,je=1029,Ge=1030,ze=1031,We=1033,Ke=33776,Ye=33777,qe=33778,Ze=33779,$e=35840,Qe=35841,Xe=35842,Je=35843,et=36196,tt=37492,nt=37496,it=37808,st=37809,rt=37810,ot=37811,at=37812,lt=37813,ct=37814,dt=37815,ut=37816,ht=37817,pt=37818,mt=37819,ft=37820,gt=37821,vt=36492,yt=2200,bt=2201,St=2202,Et=2300,Tt=2301,wt=2302,xt=2400,_t=2401,Mt=2402,Ot=2500,At=2501,Ct=0,Nt=1,Dt=2,It=3e3,Lt=3001,Pt=3200,Rt=3201,kt=0,Ut=1,Bt="",Ft="srgb",Vt="srgb-linear",Ht=0,jt=7680,Gt=7681,zt=7682,Wt=7683,Kt=34055,Yt=34056,qt=5386,Zt=512,$t=513,Qt=514,Xt=515,Jt=516,en=517,tn=518,nn=519,sn=35044,rn=35048,on=35040,an=35045,ln=35049,cn=35041,dn=35046,un=35050,hn=35042,pn="100",mn="300 es",fn=1035;class EventDispatcher{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const n=this._listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const n=t.slice(0);for(let t=0,i=n.length;t<i;t++)n[t].call(this,e);e.target=null}}}const gn=[];for(let e=0;e<256;e++)gn[e]=(e<16?"0":"")+e.toString(16);let vn=1234567;const yn=Math.PI/180,bn=180/Math.PI;function Sn(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(gn[255&e]+gn[e>>8&255]+gn[e>>16&255]+gn[e>>24&255]+"-"+gn[255&t]+gn[t>>8&255]+"-"+gn[t>>16&15|64]+gn[t>>24&255]+"-"+gn[63&n|128]+gn[n>>8&255]+"-"+gn[n>>16&255]+gn[n>>24&255]+gn[255&i]+gn[i>>8&255]+gn[i>>16&255]+gn[i>>24&255]).toLowerCase()}function En(e,t,n){return Math.max(t,Math.min(n,e))}function Tn(e,t){return(e%t+t)%t}function wn(e,t,n){return(1-n)*e+n*t}function xn(e){return 0==(e&e-1)&&0!==e}function _n(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Mn(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var On=Object.freeze({__proto__:null,DEG2RAD:yn,RAD2DEG:bn,generateUUID:Sn,clamp:En,euclideanModulo:Tn,mapLinear:function(e,t,n,i,s){return i+(e-t)*(s-i)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:wn,damp:function(e,t,n,i){return wn(e,t,1-Math.exp(-n*i))},pingpong:function(e,t=1){return t-Math.abs(Tn(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(vn=e);let t=vn+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*yn},radToDeg:function(e){return e*bn},isPowerOfTwo:xn,ceilPowerOfTwo:_n,floorPowerOfTwo:Mn,setQuaternionFromProperEuler:function(e,t,n,i,s){const r=Math.cos,o=Math.sin,a=r(n/2),l=o(n/2),c=r((t+i)/2),d=o((t+i)/2),u=r((t-i)/2),h=o((t-i)/2),p=r((i-t)/2),m=o((i-t)/2);switch(s){case"XYX":e.set(a*d,l*u,l*h,a*c);break;case"YZY":e.set(l*h,a*d,l*u,a*c);break;case"ZXZ":e.set(l*u,l*h,a*d,a*c);break;case"XZX":e.set(a*d,l*m,l*p,a*c);break;case"YXY":e.set(l*p,a*d,l*m,a*c);break;case"ZYZ":e.set(l*m,l*p,a*d,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}},normalize:function(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}},denormalize:function(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}});class Vector2{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,r=this.y-e.y;return this.x=s*n-r*i+e.x,this.y=s*i+r*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Vector2.prototype.isVector2=!0;class Matrix3{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,r,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=s,c[5]=a,c[6]=n,c[7]=r,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,r=n[0],o=n[3],a=n[6],l=n[1],c=n[4],d=n[7],u=n[2],h=n[5],p=n[8],m=i[0],f=i[3],g=i[6],v=i[1],y=i[4],b=i[7],S=i[2],E=i[5],T=i[8];return s[0]=r*m+o*v+a*S,s[3]=r*f+o*y+a*E,s[6]=r*g+o*b+a*T,s[1]=l*m+c*v+d*S,s[4]=l*f+c*y+d*E,s[7]=l*g+c*b+d*T,s[2]=u*m+h*v+p*S,s[5]=u*f+h*y+p*E,s[8]=u*g+h*b+p*T,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],r=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*r*c-t*o*l-n*s*c+n*o*a+i*s*l-i*r*a}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],r=e[4],o=e[5],a=e[6],l=e[7],c=e[8],d=c*r-o*l,u=o*a-c*s,h=l*s-r*a,p=t*d+n*u+i*h;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const m=1/p;return e[0]=d*m,e[1]=(i*l-c*n)*m,e[2]=(o*n-i*r)*m,e[3]=u*m,e[4]=(c*t-i*a)*m,e[5]=(i*s-o*t)*m,e[6]=h*m,e[7]=(n*a-l*t)*m,e[8]=(r*t-n*s)*m,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,r,o){const a=Math.cos(s),l=Math.sin(s);return this.set(n*a,n*l,-n*(a*r+l*o)+r+e,-i*l,i*a,-i*(-l*r+a*o)+o+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.elements,s=i[0],r=i[3],o=i[6],a=i[1],l=i[4],c=i[7];return i[0]=t*s+n*a,i[3]=t*r+n*l,i[6]=t*o+n*c,i[1]=-n*s+t*a,i[4]=-n*r+t*l,i[7]=-n*o+t*c,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<9;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function An(e){for(let t=e.length-1;t>=0;--t)if(e[t]>65535)return!0;return!1}Matrix3.prototype.isMatrix3=!0;const Cn={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Nn(e,t){return new Cn[e](t)}function Dn(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function In(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ln(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}const Pn={[Ft]:{[Vt]:In},[Vt]:{[Ft]:Ln}},Rn={legacyMode:!0,get workingColorSpace(){return Vt},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(this.legacyMode||t===n||!t||!n)return e;if(Pn[t]&&void 0!==Pn[t][n]){const i=Pn[t][n];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},kn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Un={r:0,g:0,b:0},Bn={h:0,s:0,l:0},Fn={h:0,s:0,l:0};function Vn(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Hn(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}class Color{constructor(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ft){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Rn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=Vt){return this.r=e,this.g=t,this.b=n,Rn.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=Vt){if(e=Tn(e,1),t=En(t,0,1),n=En(n,0,1),0===t)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+t):n+t-n*t,s=2*n-i;this.r=Vn(s,i,e+1/3),this.g=Vn(s,i,e),this.b=Vn(s,i,e-1/3)}return Rn.toWorkingColorSpace(this,i),this}setStyle(e,t=Ft){function n(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const s=i[1],r=i[2];switch(s){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,Rn.toWorkingColorSpace(this,t),n(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,Rn.toWorkingColorSpace(this,t),n(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(r)){const i=parseFloat(e[1])/360,s=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100;return n(e[4]),this.setHSL(i,s,r,t)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=i[1],n=e.length;if(3===n)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,Rn.toWorkingColorSpace(this,t),this;if(6===n)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,Rn.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Ft){const n=kn[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=In(e.r),this.g=In(e.g),this.b=In(e.b),this}copyLinearToSRGB(e){return this.r=Ln(e.r),this.g=Ln(e.g),this.b=Ln(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ft){return Rn.fromWorkingColorSpace(Hn(this,Un),e),En(255*Un.r,0,255)<<16^En(255*Un.g,0,255)<<8^En(255*Un.b,0,255)<<0}getHexString(e=Ft){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Vt){Rn.fromWorkingColorSpace(Hn(this,Un),t);const n=Un.r,i=Un.g,s=Un.b,r=Math.max(n,i,s),o=Math.min(n,i,s);let a,l;const c=(o+r)/2;if(o===r)a=0,l=0;else{const e=r-o;switch(l=c<=.5?e/(r+o):e/(2-r-o),r){case n:a=(i-s)/e+(i<s?6:0);break;case i:a=(s-n)/e+2;break;case s:a=(n-i)/e+4}a/=6}return e.h=a,e.s=l,e.l=c,e}getRGB(e,t=Vt){return Rn.fromWorkingColorSpace(Hn(this,Un),t),e.r=Un.r,e.g=Un.g,e.b=Un.b,e}getStyle(e=Ft){return Rn.fromWorkingColorSpace(Hn(this,Un),e),e!==Ft?`color(${e} ${Un.r} ${Un.g} ${Un.b})`:`rgb(${255*Un.r|0},${255*Un.g|0},${255*Un.b|0})`}offsetHSL(e,t,n){return this.getHSL(Bn),Bn.h+=e,Bn.s+=t,Bn.l+=n,this.setHSL(Bn.h,Bn.s,Bn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Bn),e.getHSL(Fn);const n=wn(Bn.h,Fn.h,t),i=wn(Bn.s,Fn.s,t),s=wn(Bn.l,Fn.l,t);return this.setHSL(n,i,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}let jn;Color.NAMES=kn,Color.prototype.isColor=!0,Color.prototype.r=1,Color.prototype.g=1,Color.prototype.b=1;class ImageUtils{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===jn&&(jn=Dn("canvas")),jn.width=e.width,jn.height=e.height;const n=jn.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=jn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Dn("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),s=i.data;for(let e=0;e<s.length;e++)s[e]=255*In(s[e]/255);return n.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*In(t[e]/255)):t[e]=In(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Source{constructor(e=null){this.uuid=Sn(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)i[t].isDataTexture?e.push(Gn(i[t].image)):e.push(Gn(i[t]))}else e=Gn(i);n.url=e}return t||(e.images[this.uuid]=n),n}}function Gn(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?ImageUtils.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Source.prototype.isSource=!0;let zn=0;class Texture extends EventDispatcher{constructor(e=Texture.DEFAULT_IMAGE,t=Texture.DEFAULT_MAPPING,n=ue,i=ue,s=ye,r=Ee,o=ke,a=we,l=1,c=It){super(),Object.defineProperty(this,"id",{value:zn++}),this.uuid=Sn(),this.name="",this.source=new Source(e),this.mipmaps=[],this.mapping=t,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=r,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==se)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case de:e.x=e.x-Math.floor(e.x);break;case ue:e.x=e.x<0?0:1;break;case he:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case de:e.y=e.y-Math.floor(e.y);break;case ue:e.y=e.y<0?0:1;break;case he:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}Texture.DEFAULT_IMAGE=null,Texture.DEFAULT_MAPPING=se,Texture.prototype.isTexture=!0;class Vector4{constructor(e=0,t=0,n=0,i=1){this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i+r[12]*s,this.y=r[1]*t+r[5]*n+r[9]*i+r[13]*s,this.z=r[2]*t+r[6]*n+r[10]*i+r[14]*s,this.w=r[3]*t+r[7]*n+r[11]*i+r[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const r=.01,o=.1,a=e.elements,l=a[0],c=a[4],d=a[8],u=a[1],h=a[5],p=a[9],m=a[2],f=a[6],g=a[10];if(Math.abs(c-u)<r&&Math.abs(d-m)<r&&Math.abs(p-f)<r){if(Math.abs(c+u)<o&&Math.abs(d+m)<o&&Math.abs(p+f)<o&&Math.abs(l+h+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(h+1)/2,v=(g+1)/2,y=(c+u)/4,b=(d+m)/4,S=(p+f)/4;return e>a&&e>v?e<r?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(e),i=y/n,s=b/n):a>v?a<r?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(a),n=y/i,s=S/i):v<r?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(v),n=b/s,i=S/s),this.set(n,i,s,t),this}let v=Math.sqrt((f-p)*(f-p)+(d-m)*(d-m)+(u-c)*(u-c));return Math.abs(v)<.001&&(v=1),this.x=(f-p)/v,this.y=(d-m)/v,this.z=(u-c)/v,this.w=Math.acos((l+h+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Vector4.prototype.isVector4=!0;class WebGLRenderTarget extends EventDispatcher{constructor(e,t,n={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Vector4(0,0,e,t),this.scissorTest=!1,this.viewport=new Vector4(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new Texture(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:ye,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}WebGLRenderTarget.prototype.isWebGLRenderTarget=!0;class DataArrayTexture extends Texture{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=pe,this.minFilter=pe,this.wrapR=ue,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}DataArrayTexture.prototype.isDataArrayTexture=!0;class WebGLArrayRenderTarget extends WebGLRenderTarget{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new DataArrayTexture(null,e,t,n),this.texture.isRenderTargetTexture=!0}}WebGLArrayRenderTarget.prototype.isWebGLArrayRenderTarget=!0;class Data3DTexture extends Texture{constructor(e=null,t=1,n=1,i=1){super(null),this.image={data:e,width:t,height:n,depth:i},this.magFilter=pe,this.minFilter=pe,this.wrapR=ue,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Data3DTexture.prototype.isData3DTexture=!0;class WebGL3DRenderTarget extends WebGLRenderTarget{constructor(e,t,n){super(e,t),this.depth=n,this.texture=new Data3DTexture(null,e,t,n),this.texture.isRenderTargetTexture=!0}}WebGL3DRenderTarget.prototype.isWebGL3DRenderTarget=!0;class WebGLMultipleRenderTargets extends WebGLRenderTarget{constructor(e,t,n,i={}){super(e,t,i);const s=this.texture;this.texture=[];for(let e=0;e<n;e++)this.texture[e]=s.clone(),this.texture[e].isRenderTargetTexture=!0}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,n=e.texture.length;t<n;t++)this.texture[t]=e.texture[t].clone();return this}}WebGLMultipleRenderTargets.prototype.isWebGLMultipleRenderTargets=!0;class Quaternion{constructor(e=0,t=0,n=0,i=1){this._x=e,this._y=t,this._z=n,this._w=i}static slerp(e,t,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,i)}static slerpFlat(e,t,n,i,s,r,o){let a=n[i+0],l=n[i+1],c=n[i+2],d=n[i+3];const u=s[r+0],h=s[r+1],p=s[r+2],m=s[r+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=d);if(1===o)return e[t+0]=u,e[t+1]=h,e[t+2]=p,void(e[t+3]=m);if(d!==m||a!==u||l!==h||c!==p){let e=1-o;const t=a*u+l*h+c*p+d*m,n=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const s=Math.sqrt(i),r=Math.atan2(s,t*n);e=Math.sin(e*r)/s,o=Math.sin(o*r)/s}const s=o*n;if(a=a*e+u*s,l=l*e+h*s,c=c*e+p*s,d=d*e+m*s,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+d*d);a*=e,l*=e,c*=e,d*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,i,s,r){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],d=s[r],u=s[r+1],h=s[r+2],p=s[r+3];return e[t]=o*p+c*d+a*h-l*u,e[t+1]=a*p+c*u+l*d-o*h,e[t+2]=l*p+c*h+o*u-a*d,e[t+3]=c*p-o*d-a*u-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,i=e._y,s=e._z,r=e._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),d=o(s/2),u=a(n/2),h=a(i/2),p=a(s/2);switch(r){case"XYZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"YXZ":this._x=u*c*d+l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"ZXY":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d-u*h*p;break;case"ZYX":this._x=u*c*d-l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d+u*h*p;break;case"YZX":this._x=u*c*d+l*h*p,this._y=l*h*d+u*c*p,this._z=l*c*p-u*h*d,this._w=l*c*d-u*h*p;break;case"XZY":this._x=u*c*d-l*h*p,this._y=l*h*d-u*c*p,this._z=l*c*p+u*h*d,this._w=l*c*d+u*h*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+r)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],r=t[1],o=t[5],a=t[9],l=t[2],c=t[6],d=t[10],u=n+o+d;if(u>0){const e=.5/Math.sqrt(u+1);this._w=.25/e,this._x=(c-a)*e,this._y=(s-l)*e,this._z=(r-i)*e}else if(n>o&&n>d){const e=2*Math.sqrt(1+n-o-d);this._w=(c-a)/e,this._x=.25*e,this._y=(i+r)/e,this._z=(s+l)/e}else if(o>d){const e=2*Math.sqrt(1+o-n-d);this._w=(s-l)/e,this._x=(i+r)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+d-n-o);this._w=(r-i)/e,this._x=(s+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(En(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,r=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=n*c+r*o+i*l-s*a,this._y=i*c+r*a+s*o-n*l,this._z=s*c+r*l+n*a-i*o,this._w=r*c-n*o-i*a-s*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,i=this._y,s=this._z,r=this._w;let o=r*e._w+n*e._x+i*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=r,this._x=n,this._y=i,this._z=s,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*r+t*this._w,this._x=e*n+t*this._x,this._y=e*i+t*this._y,this._z=e*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),d=Math.sin((1-t)*c)/l,u=Math.sin(t*c)/l;return this._w=r*d+this._w*u,this._x=n*d+this._x*u,this._y=i*d+this._y*u,this._z=s*d+this._z*u,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(i),n*Math.sin(s),n*Math.cos(s),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Quaternion.prototype.isQuaternion=!0;class Vector3{constructor(e=0,t=0,n=0){this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Kn.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Kn.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,r=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*r,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*r,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*r,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,r=e.y,o=e.z,a=e.w,l=a*t+r*i-o*n,c=a*n+o*t-s*i,d=a*i+s*n-r*t,u=-s*t-r*n-o*i;return this.x=l*a+u*-s+c*-o-d*-r,this.y=c*a+u*-r+d*-s-l*-o,this.z=d*a+u*-o+l*-r-c*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,r=t.x,o=t.y,a=t.z;return this.x=i*a-s*o,this.y=s*r-n*a,this.z=n*o-i*r,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Wn.copy(this).projectOnVector(e),this.sub(Wn)}reflect(e){return this.sub(Wn.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(En(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Vector3.prototype.isVector3=!0;const Wn=new Vector3,Kn=new Quaternion;class Box3{constructor(e=new Vector3(1/0,1/0,1/0),t=new Vector3(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,i=1/0,s=-1/0,r=-1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],d=e[a+2];l<t&&(t=l),c<n&&(n=c),d<i&&(i=d),l>s&&(s=l),c>r&&(r=c),d>o&&(o=d)}return this.min.set(t,n,i),this.max.set(s,r,o),this}setFromBufferAttribute(e){let t=1/0,n=1/0,i=1/0,s=-1/0,r=-1/0,o=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),d=e.getZ(a);l<t&&(t=l),c<n&&(n=c),d<i&&(i=d),l>s&&(s=l),c>r&&(r=c),d>o&&(o=d)}return this.min.set(t,n,i),this.max.set(s,r,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=qn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const t=n.attributes.position;for(let n=0,i=t.count;n<i;n++)qn.fromBufferAttribute(t,n).applyMatrix4(e.matrixWorld),this.expandByPoint(qn)}else null===n.boundingBox&&n.computeBoundingBox(),Zn.copy(n.boundingBox),Zn.applyMatrix4(e.matrixWorld),this.union(Zn);const i=e.children;for(let e=0,n=i.length;e<n;e++)this.expandByObject(i[e],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qn),qn.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ni),ii.subVectors(this.max,ni),$n.subVectors(e.a,ni),Qn.subVectors(e.b,ni),Xn.subVectors(e.c,ni),Jn.subVectors(Qn,$n),ei.subVectors(Xn,Qn),ti.subVectors($n,Xn);let t=[0,-Jn.z,Jn.y,0,-ei.z,ei.y,0,-ti.z,ti.y,Jn.z,0,-Jn.x,ei.z,0,-ei.x,ti.z,0,-ti.x,-Jn.y,Jn.x,0,-ei.y,ei.x,0,-ti.y,ti.x,0];return!!oi(t,$n,Qn,Xn,ii)&&(t=[1,0,0,0,1,0,0,0,1],!!oi(t,$n,Qn,Xn,ii)&&(si.crossVectors(Jn,ei),t=[si.x,si.y,si.z],oi(t,$n,Qn,Xn,ii)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qn.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(qn).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Yn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Yn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Yn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Yn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Yn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Yn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Yn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Yn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Yn)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Box3.prototype.isBox3=!0;const Yn=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],qn=new Vector3,Zn=new Box3,$n=new Vector3,Qn=new Vector3,Xn=new Vector3,Jn=new Vector3,ei=new Vector3,ti=new Vector3,ni=new Vector3,ii=new Vector3,si=new Vector3,ri=new Vector3;function oi(e,t,n,i,s){for(let r=0,o=e.length-3;r<=o;r+=3){ri.fromArray(e,r);const o=s.x*Math.abs(ri.x)+s.y*Math.abs(ri.y)+s.z*Math.abs(ri.z),a=t.dot(ri),l=n.dot(ri),c=i.dot(ri);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const ai=new Box3,li=new Vector3,ci=new Vector3,di=new Vector3;class Sphere{constructor(e=new Vector3,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):ai.setFromPoints(e).getCenter(n);let i=0;for(let t=0,s=e.length;t<s;t++)i=Math.max(i,n.distanceToSquared(e[t]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){di.subVectors(e,this.center);const t=di.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.add(di.multiplyScalar(n/e)),this.radius+=n}return this}union(e){return!0===this.center.equals(e.center)?ci.set(0,0,1).multiplyScalar(e.radius):ci.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(li.copy(e.center).add(ci)),this.expandByPoint(li.copy(e.center).sub(ci)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const ui=new Vector3,hi=new Vector3,pi=new Vector3,mi=new Vector3,fi=new Vector3,gi=new Vector3,vi=new Vector3;class Ray{constructor(e=new Vector3,t=new Vector3(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ui)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ui.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ui.copy(this.direction).multiplyScalar(t).add(this.origin),ui.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){hi.copy(e).add(t).multiplyScalar(.5),pi.copy(t).sub(e).normalize(),mi.copy(this.origin).sub(hi);const s=.5*e.distanceTo(t),r=-this.direction.dot(pi),o=mi.dot(this.direction),a=-mi.dot(pi),l=mi.lengthSq(),c=Math.abs(1-r*r);let d,u,h,p;if(c>0)if(d=r*a-o,u=r*o-a,p=s*c,d>=0)if(u>=-p)if(u<=p){const e=1/c;d*=e,u*=e,h=d*(d+r*u+2*o)+u*(r*d+u+2*a)+l}else u=s,d=Math.max(0,-(r*u+o)),h=-d*d+u*(u+2*a)+l;else u=-s,d=Math.max(0,-(r*u+o)),h=-d*d+u*(u+2*a)+l;else u<=-p?(d=Math.max(0,-(-r*s+o)),u=d>0?-s:Math.min(Math.max(-s,-a),s),h=-d*d+u*(u+2*a)+l):u<=p?(d=0,u=Math.min(Math.max(-s,-a),s),h=u*(u+2*a)+l):(d=Math.max(0,-(r*s+o)),u=d>0?s:Math.min(Math.max(-s,-a),s),h=-d*d+u*(u+2*a)+l);else u=r>0?-s:s,d=Math.max(0,-(r*u+o)),h=-d*d+u*(u+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(d).add(this.origin),i&&i.copy(pi).multiplyScalar(u).add(hi),h}intersectSphere(e,t){ui.subVectors(e.center,this.origin);const n=ui.dot(this.direction),i=ui.dot(ui)-n*n,s=e.radius*e.radius;if(i>s)return null;const r=Math.sqrt(s-i),o=n-r,a=n+r;return o<0&&a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,r,o,a;const l=1/this.direction.x,c=1/this.direction.y,d=1/this.direction.z,u=this.origin;return l>=0?(n=(e.min.x-u.x)*l,i=(e.max.x-u.x)*l):(n=(e.max.x-u.x)*l,i=(e.min.x-u.x)*l),c>=0?(s=(e.min.y-u.y)*c,r=(e.max.y-u.y)*c):(s=(e.max.y-u.y)*c,r=(e.min.y-u.y)*c),n>r||s>i?null:((s>n||n!=n)&&(n=s),(r<i||i!=i)&&(i=r),d>=0?(o=(e.min.z-u.z)*d,a=(e.max.z-u.z)*d):(o=(e.max.z-u.z)*d,a=(e.min.z-u.z)*d),n>a||o>i?null:((o>n||n!=n)&&(n=o),(a<i||i!=i)&&(i=a),i<0?null:this.at(n>=0?n:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,ui)}intersectTriangle(e,t,n,i,s){fi.subVectors(t,e),gi.subVectors(n,e),vi.crossVectors(fi,gi);let r,o=this.direction.dot(vi);if(o>0){if(i)return null;r=1}else{if(!(o<0))return null;r=-1,o=-o}mi.subVectors(this.origin,e);const a=r*this.direction.dot(gi.crossVectors(mi,gi));if(a<0)return null;const l=r*this.direction.dot(fi.cross(mi));if(l<0)return null;if(a+l>o)return null;const c=-r*mi.dot(vi);return c<0?null:this.at(c/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Matrix4{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,i,s,r,o,a,l,c,d,u,h,p,m,f){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=i,g[1]=s,g[5]=r,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=d,g[14]=u,g[3]=h,g[7]=p,g[11]=m,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Matrix4).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/yi.setFromMatrixColumn(e,0).length(),s=1/yi.setFromMatrixColumn(e,1).length(),r=1/yi.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,i=e.y,s=e.z,r=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(s),d=Math.sin(s);if("XYZ"===e.order){const e=r*c,n=r*d,i=o*c,s=o*d;t[0]=a*c,t[4]=-a*d,t[8]=l,t[1]=n+i*l,t[5]=e-s*l,t[9]=-o*a,t[2]=s-e*l,t[6]=i+n*l,t[10]=r*a}else if("YXZ"===e.order){const e=a*c,n=a*d,i=l*c,s=l*d;t[0]=e+s*o,t[4]=i*o-n,t[8]=r*l,t[1]=r*d,t[5]=r*c,t[9]=-o,t[2]=n*o-i,t[6]=s+e*o,t[10]=r*a}else if("ZXY"===e.order){const e=a*c,n=a*d,i=l*c,s=l*d;t[0]=e-s*o,t[4]=-r*d,t[8]=i+n*o,t[1]=n+i*o,t[5]=r*c,t[9]=s-e*o,t[2]=-r*l,t[6]=o,t[10]=r*a}else if("ZYX"===e.order){const e=r*c,n=r*d,i=o*c,s=o*d;t[0]=a*c,t[4]=i*l-n,t[8]=e*l+s,t[1]=a*d,t[5]=s*l+e,t[9]=n*l-i,t[2]=-l,t[6]=o*a,t[10]=r*a}else if("YZX"===e.order){const e=r*a,n=r*l,i=o*a,s=o*l;t[0]=a*c,t[4]=s-e*d,t[8]=i*d+n,t[1]=d,t[5]=r*c,t[9]=-o*c,t[2]=-l*c,t[6]=n*d+i,t[10]=e-s*d}else if("XZY"===e.order){const e=r*a,n=r*l,i=o*a,s=o*l;t[0]=a*c,t[4]=-d,t[8]=l*c,t[1]=e*d+s,t[5]=r*c,t[9]=n*d-i,t[2]=i*d-n,t[6]=o*c,t[10]=s*d+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Si,e,Ei)}lookAt(e,t,n){const i=this.elements;return xi.subVectors(e,t),0===xi.lengthSq()&&(xi.z=1),xi.normalize(),Ti.crossVectors(n,xi),0===Ti.lengthSq()&&(1===Math.abs(n.z)?xi.x+=1e-4:xi.z+=1e-4,xi.normalize(),Ti.crossVectors(n,xi)),Ti.normalize(),wi.crossVectors(xi,Ti),i[0]=Ti.x,i[4]=wi.x,i[8]=xi.x,i[1]=Ti.y,i[5]=wi.y,i[9]=xi.y,i[2]=Ti.z,i[6]=wi.z,i[10]=xi.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,r=n[0],o=n[4],a=n[8],l=n[12],c=n[1],d=n[5],u=n[9],h=n[13],p=n[2],m=n[6],f=n[10],g=n[14],v=n[3],y=n[7],b=n[11],S=n[15],E=i[0],T=i[4],w=i[8],x=i[12],_=i[1],M=i[5],O=i[9],A=i[13],C=i[2],N=i[6],D=i[10],I=i[14],L=i[3],P=i[7],R=i[11],k=i[15];return s[0]=r*E+o*_+a*C+l*L,s[4]=r*T+o*M+a*N+l*P,s[8]=r*w+o*O+a*D+l*R,s[12]=r*x+o*A+a*I+l*k,s[1]=c*E+d*_+u*C+h*L,s[5]=c*T+d*M+u*N+h*P,s[9]=c*w+d*O+u*D+h*R,s[13]=c*x+d*A+u*I+h*k,s[2]=p*E+m*_+f*C+g*L,s[6]=p*T+m*M+f*N+g*P,s[10]=p*w+m*O+f*D+g*R,s[14]=p*x+m*A+f*I+g*k,s[3]=v*E+y*_+b*C+S*L,s[7]=v*T+y*M+b*N+S*P,s[11]=v*w+y*O+b*D+S*R,s[15]=v*x+y*A+b*I+S*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],r=e[1],o=e[5],a=e[9],l=e[13],c=e[2],d=e[6],u=e[10],h=e[14];return e[3]*(+s*a*d-i*l*d-s*o*u+n*l*u+i*o*h-n*a*h)+e[7]*(+t*a*h-t*l*u+s*r*u-i*r*h+i*l*c-s*a*c)+e[11]*(+t*l*d-t*o*h-s*r*d+n*r*h+s*o*c-n*l*c)+e[15]*(-i*o*c-t*a*d+t*o*u+i*r*d-n*r*u+n*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],r=e[4],o=e[5],a=e[6],l=e[7],c=e[8],d=e[9],u=e[10],h=e[11],p=e[12],m=e[13],f=e[14],g=e[15],v=d*f*l-m*u*l+m*a*h-o*f*h-d*a*g+o*u*g,y=p*u*l-c*f*l-p*a*h+r*f*h+c*a*g-r*u*g,b=c*m*l-p*d*l+p*o*h-r*m*h-c*o*g+r*d*g,S=p*d*a-c*m*a-p*o*u+r*m*u+c*o*f-r*d*f,E=t*v+n*y+i*b+s*S;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/E;return e[0]=v*T,e[1]=(m*u*s-d*f*s-m*i*h+n*f*h+d*i*g-n*u*g)*T,e[2]=(o*f*s-m*a*s+m*i*l-n*f*l-o*i*g+n*a*g)*T,e[3]=(d*a*s-o*u*s-d*i*l+n*u*l+o*i*h-n*a*h)*T,e[4]=y*T,e[5]=(c*f*s-p*u*s+p*i*h-t*f*h-c*i*g+t*u*g)*T,e[6]=(p*a*s-r*f*s-p*i*l+t*f*l+r*i*g-t*a*g)*T,e[7]=(r*u*s-c*a*s+c*i*l-t*u*l-r*i*h+t*a*h)*T,e[8]=b*T,e[9]=(p*d*s-c*m*s-p*n*h+t*m*h+c*n*g-t*d*g)*T,e[10]=(r*m*s-p*o*s+p*n*l-t*m*l-r*n*g+t*o*g)*T,e[11]=(c*o*s-r*d*s-c*n*l+t*d*l+r*n*h-t*o*h)*T,e[12]=S*T,e[13]=(c*m*i-p*d*i+p*n*u-t*m*u-c*n*f+t*d*f)*T,e[14]=(p*o*i-r*m*i-p*n*a+t*m*a+r*n*f-t*o*f)*T,e[15]=(r*d*i-c*o*i+c*n*a-t*d*a-r*n*u+t*o*u)*T,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,r=e.x,o=e.y,a=e.z,l=s*r,c=s*o;return this.set(l*r+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*r,0,l*a-i*o,c*a+i*r,s*a*a+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,r){return this.set(1,n,s,0,e,1,r,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,r=t._y,o=t._z,a=t._w,l=s+s,c=r+r,d=o+o,u=s*l,h=s*c,p=s*d,m=r*c,f=r*d,g=o*d,v=a*l,y=a*c,b=a*d,S=n.x,E=n.y,T=n.z;return i[0]=(1-(m+g))*S,i[1]=(h+b)*S,i[2]=(p-y)*S,i[3]=0,i[4]=(h-b)*E,i[5]=(1-(u+g))*E,i[6]=(f+v)*E,i[7]=0,i[8]=(p+y)*T,i[9]=(f-v)*T,i[10]=(1-(u+m))*T,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let s=yi.set(i[0],i[1],i[2]).length();const r=yi.set(i[4],i[5],i[6]).length(),o=yi.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],bi.copy(this);const a=1/s,l=1/r,c=1/o;return bi.elements[0]*=a,bi.elements[1]*=a,bi.elements[2]*=a,bi.elements[4]*=l,bi.elements[5]*=l,bi.elements[6]*=l,bi.elements[8]*=c,bi.elements[9]*=c,bi.elements[10]*=c,t.setFromRotationMatrix(bi),n.x=s,n.y=r,n.z=o,this}makePerspective(e,t,n,i,s,r){void 0===r&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*s/(t-e),l=2*s/(n-i),c=(t+e)/(t-e),d=(n+i)/(n-i),u=-(r+s)/(r-s),h=-2*r*s/(r-s);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=d,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,n,i,s,r){const o=this.elements,a=1/(t-e),l=1/(n-i),c=1/(r-s),d=(t+e)*a,u=(n+i)*l,h=(r+s)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-d,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let e=0;e<16;e++)if(t[e]!==n[e])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}Matrix4.prototype.isMatrix4=!0;const yi=new Vector3,bi=new Matrix4,Si=new Vector3(0,0,0),Ei=new Vector3(1,1,1),Ti=new Vector3,wi=new Vector3,xi=new Vector3,_i=new Matrix4,Mi=new Quaternion;class Euler{constructor(e=0,t=0,n=0,i=Euler.DefaultOrder){this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],r=i[4],o=i[8],a=i[1],l=i[5],c=i[9],d=i[2],u=i[6],h=i[10];switch(t){case"XYZ":this._y=Math.asin(En(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-r,s)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-En(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(En(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-d,h),this._z=Math.atan2(-r,l)):(this._y=0,this._z=Math.atan2(a,s));break;case"ZYX":this._y=Math.asin(-En(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(u,h),this._z=Math.atan2(a,s)):(this._x=0,this._z=Math.atan2(-r,l));break;case"YZX":this._z=Math.asin(En(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-En(r,-1,1)),Math.abs(r)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return _i.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_i,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Mi.setFromEuler(this),this.setFromQuaternion(Mi,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Euler.prototype.isEuler=!0,Euler.DefaultOrder="XYZ",Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Layers{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let Oi=0;const Ai=new Vector3,Ci=new Quaternion,Ni=new Matrix4,Di=new Vector3,Ii=new Vector3,Li=new Vector3,Pi=new Quaternion,Ri=new Vector3(1,0,0),ki=new Vector3(0,1,0),Ui=new Vector3(0,0,1),Bi={type:"added"},Fi={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),Object.defineProperty(this,"id",{value:Oi++}),this.uuid=Sn(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DefaultUp.clone();const e=new Vector3,t=new Euler,n=new Quaternion,i=new Vector3(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ci.setFromAxisAngle(e,t),this.quaternion.multiply(Ci),this}rotateOnWorldAxis(e,t){return Ci.setFromAxisAngle(e,t),this.quaternion.premultiply(Ci),this}rotateX(e){return this.rotateOnAxis(Ri,e)}rotateY(e){return this.rotateOnAxis(ki,e)}rotateZ(e){return this.rotateOnAxis(Ui,e)}translateOnAxis(e,t){return Ai.copy(e).applyQuaternion(this.quaternion),this.position.add(Ai.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Ri,e)}translateY(e){return this.translateOnAxis(ki,e)}translateZ(e){return this.translateOnAxis(Ui,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Ni.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Di.copy(e):Di.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Ii.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ni.lookAt(Ii,Di,this.up):Ni.lookAt(Di,Ii,this.up),this.quaternion.setFromRotationMatrix(Ni),i&&(Ni.extractRotation(i.matrixWorld),Ci.setFromRotationMatrix(Ni),this.quaternion.premultiply(Ci.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Bi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Fi)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Fi)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ni.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ni.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ni),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ii,e,Li),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ii,Pi,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function s(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const i=n[t];s(e.shapes,i)}else s(e.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,i=this.material.length;n<i;n++)t.push(s(e.materials,this.material[n]));i.material=t}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];i.animations.push(s(e.animations,n))}}if(t){const t=r(e.geometries),i=r(e.materials),s=r(e.textures),o=r(e.images),a=r(e.shapes),l=r(e.skeletons),c=r(e.animations),d=r(e.nodes);t.length>0&&(n.geometries=t),i.length>0&&(n.materials=i),s.length>0&&(n.textures=s),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),d.length>0&&(n.nodes=d)}return n.object=i,n;function r(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const n=e.children[t];this.add(n.clone())}return this}}Object3D.DefaultUp=new Vector3(0,1,0),Object3D.DefaultMatrixAutoUpdate=!0,Object3D.prototype.isObject3D=!0;const Vi=new Vector3,Hi=new Vector3,ji=new Vector3,Gi=new Vector3,zi=new Vector3,Wi=new Vector3,Ki=new Vector3,Yi=new Vector3,qi=new Vector3,Zi=new Vector3;class Triangle{constructor(e=new Vector3,t=new Vector3,n=new Vector3){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Vi.subVectors(e,t),i.cross(Vi);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){Vi.subVectors(i,t),Hi.subVectors(n,t),ji.subVectors(e,t);const r=Vi.dot(Vi),o=Vi.dot(Hi),a=Vi.dot(ji),l=Hi.dot(Hi),c=Hi.dot(ji),d=r*l-o*o;if(0===d)return s.set(-2,-1,-1);const u=1/d,h=(l*a-o*c)*u,p=(r*c-o*a)*u;return s.set(1-h-p,p,h)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Gi),Gi.x>=0&&Gi.y>=0&&Gi.x+Gi.y<=1}static getUV(e,t,n,i,s,r,o,a){return this.getBarycoord(e,t,n,i,Gi),a.set(0,0),a.addScaledVector(s,Gi.x),a.addScaledVector(r,Gi.y),a.addScaledVector(o,Gi.z),a}static isFrontFacing(e,t,n,i){return Vi.subVectors(n,t),Hi.subVectors(e,t),Vi.cross(Hi).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Vi.subVectors(this.c,this.b),Hi.subVectors(this.a,this.b),.5*Vi.cross(Hi).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Triangle.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Triangle.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,i,s){return Triangle.getUV(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return Triangle.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Triangle.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let r,o;zi.subVectors(i,n),Wi.subVectors(s,n),Yi.subVectors(e,n);const a=zi.dot(Yi),l=Wi.dot(Yi);if(a<=0&&l<=0)return t.copy(n);qi.subVectors(e,i);const c=zi.dot(qi),d=Wi.dot(qi);if(c>=0&&d<=c)return t.copy(i);const u=a*d-c*l;if(u<=0&&a>=0&&c<=0)return r=a/(a-c),t.copy(n).addScaledVector(zi,r);Zi.subVectors(e,s);const h=zi.dot(Zi),p=Wi.dot(Zi);if(p>=0&&h<=p)return t.copy(s);const m=h*l-a*p;if(m<=0&&l>=0&&p<=0)return o=l/(l-p),t.copy(n).addScaledVector(Wi,o);const f=c*p-h*d;if(f<=0&&d-c>=0&&h-p>=0)return Ki.subVectors(s,i),o=(d-c)/(d-c+(h-p)),t.copy(i).addScaledVector(Ki,o);const g=1/(f+m+u);return r=m*g,o=u*g,t.copy(n).addScaledVector(zi,r).addScaledVector(Wi,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let $i=0;class Material extends EventDispatcher{constructor(){super(),Object.defineProperty(this,"id",{value:$i++}),this.uuid=Sn(),this.name="",this.type="Material",this.fog=!0,this.blending=S,this.side=m,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=P,this.blendDst=R,this.blendEquation=_,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=z,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=jt,this.stencilZFail=jt,this.stencilZPass=jt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===v;continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const n in e){const i=e[n];delete i.metadata,t.push(i)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==S&&(n.blending=this.blending),this.side!==m&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){const t=i(e.textures),s=i(e.images);t.length>0&&(n.textures=t),s.length>0&&(n.images=s)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let i=0;i!==e;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Material.prototype.isMaterial=!0,Material.fromType=function(){return null};class MeshBasicMaterial extends Material{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}MeshBasicMaterial.prototype.isMeshBasicMaterial=!0;const Qi=new Vector3,Xi=new Vector2;class BufferAttribute{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=sn,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let s=e[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new Color),t[n++]=s.r,t[n++]=s.g,t[n++]=s.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let s=e[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new Vector2),t[n++]=s.x,t[n++]=s.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let s=e[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new Vector3),t[n++]=s.x,t[n++]=s.y,t[n++]=s.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let i=0,s=e.length;i<s;i++){let s=e[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new Vector4),t[n++]=s.x,t[n++]=s.y,t[n++]=s.z,t[n++]=s.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)Xi.fromBufferAttribute(this,t),Xi.applyMatrix3(e),this.setXY(t,Xi.x,Xi.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Qi.fromBufferAttribute(this,t),Qi.applyMatrix3(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Qi.fromBufferAttribute(this,t),Qi.applyMatrix4(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Qi.fromBufferAttribute(this,t),Qi.applyNormalMatrix(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Qi.fromBufferAttribute(this,t),Qi.transformDirection(e),this.setXYZ(t,Qi.x,Qi.y,Qi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==sn&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}BufferAttribute.prototype.isBufferAttribute=!0;class Int8BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Int8Array(e),t,n)}}class Uint8BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class Int16BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Int16Array(e),t,n)}}class Uint16BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Int32BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Int32Array(e),t,n)}}class Uint32BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Float16BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Uint16Array(e),t,n)}}Float16BufferAttribute.prototype.isFloat16BufferAttribute=!0;class Float32BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Float32Array(e),t,n)}}class Float64BufferAttribute extends BufferAttribute{constructor(e,t,n){super(new Float64Array(e),t,n)}}let Ji=0;const es=new Matrix4,ts=new Object3D,ns=new Vector3,is=new Box3,ss=new Box3,rs=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),Object.defineProperty(this,"id",{value:Ji++}),this.uuid=Sn(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(An(e)?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Matrix3).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return es.makeRotationFromQuaternion(e),this.applyMatrix4(es),this}rotateX(e){return es.makeRotationX(e),this.applyMatrix4(es),this}rotateY(e){return es.makeRotationY(e),this.applyMatrix4(es),this}rotateZ(e){return es.makeRotationZ(e),this.applyMatrix4(es),this}translate(e,t,n){return es.makeTranslation(e,t,n),this.applyMatrix4(es),this}scale(e,t,n){return es.makeScale(e,t,n),this.applyMatrix4(es),this}lookAt(e){return ts.lookAt(e),ts.updateMatrix(),this.applyMatrix4(ts.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ns).negate(),this.translate(ns.x,ns.y,ns.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Float32BufferAttribute(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Box3);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];is.setFromBufferAttribute(n),this.morphTargetsRelative?(rs.addVectors(this.boundingBox.min,is.min),this.boundingBox.expandByPoint(rs),rs.addVectors(this.boundingBox.max,is.max),this.boundingBox.expandByPoint(rs)):(this.boundingBox.expandByPoint(is.min),this.boundingBox.expandByPoint(is.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Vector3,1/0);if(e){const n=this.boundingSphere.center;if(is.setFromBufferAttribute(e),t)for(let e=0,n=t.length;e<n;e++){const n=t[e];ss.setFromBufferAttribute(n),this.morphTargetsRelative?(rs.addVectors(is.min,ss.min),is.expandByPoint(rs),rs.addVectors(is.max,ss.max),is.expandByPoint(rs)):(is.expandByPoint(ss.min),is.expandByPoint(ss.max))}is.getCenter(n);let i=0;for(let t=0,s=e.count;t<s;t++)rs.fromBufferAttribute(e,t),i=Math.max(i,n.distanceToSquared(rs));if(t)for(let s=0,r=t.length;s<r;s++){const r=t[s],o=this.morphTargetsRelative;for(let t=0,s=r.count;t<s;t++)rs.fromBufferAttribute(r,t),o&&(ns.fromBufferAttribute(e,t),rs.add(ns)),i=Math.max(i,n.distanceToSquared(rs))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,i=t.position.array,s=t.normal.array,r=t.uv.array,o=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let e=0;e<o;e++)l[e]=new Vector3,c[e]=new Vector3;const d=new Vector3,u=new Vector3,h=new Vector3,p=new Vector2,m=new Vector2,f=new Vector2,g=new Vector3,v=new Vector3;function y(e,t,n){d.fromArray(i,3*e),u.fromArray(i,3*t),h.fromArray(i,3*n),p.fromArray(r,2*e),m.fromArray(r,2*t),f.fromArray(r,2*n),u.sub(d),h.sub(d),m.sub(p),f.sub(p);const s=1/(m.x*f.y-f.x*m.y);isFinite(s)&&(g.copy(u).multiplyScalar(f.y).addScaledVector(h,-m.y).multiplyScalar(s),v.copy(h).multiplyScalar(m.x).addScaledVector(u,-f.x).multiplyScalar(s),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(v),c[t].add(v),c[n].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(let e=0,t=b.length;e<t;++e){const t=b[e],i=t.start;for(let e=i,s=i+t.count;e<s;e+=3)y(n[e+0],n[e+1],n[e+2])}const S=new Vector3,E=new Vector3,T=new Vector3,w=new Vector3;function x(e){T.fromArray(s,3*e),w.copy(T);const t=l[e];S.copy(t),S.sub(T.multiplyScalar(T.dot(t))).normalize(),E.crossVectors(w,t);const n=E.dot(c[e])<0?-1:1;a[4*e]=S.x,a[4*e+1]=S.y,a[4*e+2]=S.z,a[4*e+3]=n}for(let e=0,t=b.length;e<t;++e){const t=b[e],i=t.start;for(let e=i,s=i+t.count;e<s;e+=3)x(n[e+0]),x(n[e+1]),x(n[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new BufferAttribute(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const i=new Vector3,s=new Vector3,r=new Vector3,o=new Vector3,a=new Vector3,l=new Vector3,c=new Vector3,d=new Vector3;if(e)for(let u=0,h=e.count;u<h;u+=3){const h=e.getX(u+0),p=e.getX(u+1),m=e.getX(u+2);i.fromBufferAttribute(t,h),s.fromBufferAttribute(t,p),r.fromBufferAttribute(t,m),c.subVectors(r,s),d.subVectors(i,s),c.cross(d),o.fromBufferAttribute(n,h),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,m),o.add(c),a.add(c),l.add(c),n.setXYZ(h,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(m,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)i.fromBufferAttribute(t,e+0),s.fromBufferAttribute(t,e+1),r.fromBufferAttribute(t,e+2),c.subVectors(r,s),d.subVectors(i,s),c.cross(d),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===e.attributes[i])continue;const s=n[i].array,r=e.attributes[i],o=r.array,a=r.itemSize*t,l=Math.min(o.length,s.length-a);for(let e=0,t=a;e<l;e++,t++)s[t]=o[e]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)rs.fromBufferAttribute(e,t),rs.normalize(),e.setXYZ(t,rs.x,rs.y,rs.z)}toNonIndexed(){function e(e,t){const n=e.array,i=e.itemSize,s=e.normalized,r=new n.constructor(t.length*i);let o=0,a=0;for(let s=0,l=t.length;s<l;s++){o=e.isInterleavedBufferAttribute?t[s]*e.data.stride+e.offset:t[s]*i;for(let e=0;e<i;e++)r[a++]=n[o++]}return new BufferAttribute(r,i,s)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new BufferGeometry,n=this.index.array,i=this.attributes;for(const s in i){const r=e(i[s],n);t.setAttribute(s,r)}const s=this.morphAttributes;for(const i in s){const r=[],o=s[i];for(let t=0,i=o.length;t<i;t++){const i=e(o[t],n);r.push(i)}t.morphAttributes[i]=r}t.morphTargetsRelative=this.morphTargetsRelative;const r=this.groups;for(let e=0,n=r.length;e<n;e++){const n=r[e];t.addGroup(n.start,n.count,n.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const t in n){const i=n[t];e.data.attributes[t]=i.toJSON(e.data)}const i={};let s=!1;for(const t in this.morphAttributes){const n=this.morphAttributes[t],r=[];for(let t=0,i=n.length;t<i;t++){const i=n[t];r.push(i.toJSON(e.data))}r.length>0&&(i[t]=r,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const r=this.groups;r.length>0&&(e.data.groups=JSON.parse(JSON.stringify(r)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const i=e.attributes;for(const e in i){const n=i[e];this.setAttribute(e,n.clone(t))}const s=e.morphAttributes;for(const e in s){const n=[],i=s[e];for(let e=0,s=i.length;e<s;e++)n.push(i[e].clone(t));this.morphAttributes[e]=n}this.morphTargetsRelative=e.morphTargetsRelative;const r=e.groups;for(let e=0,t=r.length;e<t;e++){const t=r[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}BufferGeometry.prototype.isBufferGeometry=!0;const os=new Matrix4,as=new Ray,ls=new Sphere,cs=new Vector3,ds=new Vector3,us=new Vector3,hs=new Vector3,ps=new Vector3,ms=new Vector3,fs=new Vector3,gs=new Vector3,vs=new Vector3,ys=new Vector2,bs=new Vector2,Ss=new Vector2,Es=new Vector3,Ts=new Vector3;class Mesh extends Object3D{constructor(e=new BufferGeometry,t=new MeshBasicMaterial){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),ls.copy(n.boundingSphere),ls.applyMatrix4(s),!1===e.ray.intersectsSphere(ls))return;if(os.copy(s).invert(),as.copy(e.ray).applyMatrix4(os),null!==n.boundingBox&&!1===as.intersectsBox(n.boundingBox))return;let r;if(n.isBufferGeometry){const s=n.index,o=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,d=n.attributes.uv2,u=n.groups,h=n.drawRange;if(null!==s)if(Array.isArray(i))for(let n=0,p=u.length;n<p;n++){const p=u[n],m=i[p.materialIndex];for(let n=Math.max(p.start,h.start),i=Math.min(s.count,Math.min(p.start+p.count,h.start+h.count));n<i;n+=3){const i=s.getX(n),u=s.getX(n+1),h=s.getX(n+2);r=ws(this,m,e,as,o,a,l,c,d,i,u,h),r&&(r.faceIndex=Math.floor(n/3),r.face.materialIndex=p.materialIndex,t.push(r))}}else{for(let n=Math.max(0,h.start),u=Math.min(s.count,h.start+h.count);n<u;n+=3){const u=s.getX(n),h=s.getX(n+1),p=s.getX(n+2);r=ws(this,i,e,as,o,a,l,c,d,u,h,p),r&&(r.faceIndex=Math.floor(n/3),t.push(r))}}else if(void 0!==o)if(Array.isArray(i))for(let n=0,s=u.length;n<s;n++){const s=u[n],p=i[s.materialIndex];for(let n=Math.max(s.start,h.start),i=Math.min(o.count,Math.min(s.start+s.count,h.start+h.count));n<i;n+=3){r=ws(this,p,e,as,o,a,l,c,d,n,n+1,n+2),r&&(r.faceIndex=Math.floor(n/3),r.face.materialIndex=s.materialIndex,t.push(r))}}else{for(let n=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);n<s;n+=3){r=ws(this,i,e,as,o,a,l,c,d,n,n+1,n+2),r&&(r.faceIndex=Math.floor(n/3),t.push(r))}}}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function ws(e,t,n,i,s,r,o,a,l,c,d,u){cs.fromBufferAttribute(s,c),ds.fromBufferAttribute(s,d),us.fromBufferAttribute(s,u);const h=e.morphTargetInfluences;if(r&&h){fs.set(0,0,0),gs.set(0,0,0),vs.set(0,0,0);for(let e=0,t=r.length;e<t;e++){const t=h[e],n=r[e];0!==t&&(hs.fromBufferAttribute(n,c),ps.fromBufferAttribute(n,d),ms.fromBufferAttribute(n,u),o?(fs.addScaledVector(hs,t),gs.addScaledVector(ps,t),vs.addScaledVector(ms,t)):(fs.addScaledVector(hs.sub(cs),t),gs.addScaledVector(ps.sub(ds),t),vs.addScaledVector(ms.sub(us),t)))}cs.add(fs),ds.add(gs),us.add(vs)}e.isSkinnedMesh&&(e.boneTransform(c,cs),e.boneTransform(d,ds),e.boneTransform(u,us));const p=function(e,t,n,i,s,r,o,a){let l;if(l=t.side===f?i.intersectTriangle(o,r,s,!0,a):i.intersectTriangle(s,r,o,t.side!==g,a),null===l)return null;Ts.copy(a),Ts.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(Ts);return c<n.near||c>n.far?null:{distance:c,point:Ts.clone(),object:e}}(e,t,n,i,cs,ds,us,Es);if(p){a&&(ys.fromBufferAttribute(a,c),bs.fromBufferAttribute(a,d),Ss.fromBufferAttribute(a,u),p.uv=Triangle.getUV(Es,cs,ds,us,ys,bs,Ss,new Vector2)),l&&(ys.fromBufferAttribute(l,c),bs.fromBufferAttribute(l,d),Ss.fromBufferAttribute(l,u),p.uv2=Triangle.getUV(Es,cs,ds,us,ys,bs,Ss,new Vector2));const e={a:c,b:d,c:u,normal:new Vector3,materialIndex:0};Triangle.getNormal(cs,ds,us,e.normal),p.face=e}return p}Mesh.prototype.isMesh=!0;class BoxGeometry extends BufferGeometry{constructor(e=1,t=1,n=1,i=1,s=1,r=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:r};const o=this;i=Math.floor(i),s=Math.floor(s),r=Math.floor(r);const a=[],l=[],c=[],d=[];let u=0,h=0;function p(e,t,n,i,s,r,p,m,f,g,v){const y=r/f,b=p/g,S=r/2,E=p/2,T=m/2,w=f+1,x=g+1;let _=0,M=0;const O=new Vector3;for(let r=0;r<x;r++){const o=r*b-E;for(let a=0;a<w;a++){const u=a*y-S;O[e]=u*i,O[t]=o*s,O[n]=T,l.push(O.x,O.y,O.z),O[e]=0,O[t]=0,O[n]=m>0?1:-1,c.push(O.x,O.y,O.z),d.push(a/f),d.push(1-r/g),_+=1}}for(let e=0;e<g;e++)for(let t=0;t<f;t++){const n=u+t+w*e,i=u+t+w*(e+1),s=u+(t+1)+w*(e+1),r=u+(t+1)+w*e;a.push(n,i,r),a.push(i,s,r),M+=6}o.addGroup(h,M,v),h+=M,u+=_}p("z","y","x",-1,-1,n,t,e,r,s,0),p("z","y","x",1,-1,n,t,-e,r,s,1),p("x","z","y",1,1,e,n,t,i,r,2),p("x","z","y",1,-1,e,n,-t,i,r,3),p("x","y","z",1,-1,e,t,n,i,s,4),p("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(a),this.setAttribute("position",new Float32BufferAttribute(l,3)),this.setAttribute("normal",new Float32BufferAttribute(c,3)),this.setAttribute("uv",new Float32BufferAttribute(d,2))}static fromJSON(e){return new BoxGeometry(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function xs(e){const t={};for(const n in e){t[n]={};for(const i in e[n]){const s=e[n][i];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?t[n][i]=s.clone():Array.isArray(s)?t[n][i]=s.slice():t[n][i]=s}}return t}function _s(e){const t={};for(let n=0;n<e.length;n++){const i=xs(e[n]);for(const e in i)t[e]=i[e]}return t}const Ms={clone:xs,merge:_s};class ShaderMaterial extends Material{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=xs(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const i=this.uniforms[n].value;i&&i.isTexture?t.uniforms[n]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[n]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[n]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[n]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[n]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[n]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[n]={type:"m4",value:i.toArray()}:t.uniforms[n]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const e in this.extensions)!0===this.extensions[e]&&(n[e]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}ShaderMaterial.prototype.isShaderMaterial=!0;class Camera extends Object3D{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Camera.prototype.isCamera=!0;class PerspectiveCamera extends Camera{constructor(e=50,t=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*bn*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*yn*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*bn*Math.atan(Math.tan(.5*yn*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,i,s,r){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*yn*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const r=this.view;if(null!==this.view&&this.view.enabled){const e=r.fullWidth,o=r.fullHeight;s+=r.offsetX*i/e,t-=r.offsetY*n/o,i*=r.width/e,n*=r.height/o}const o=this.filmOffset;0!==o&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}PerspectiveCamera.prototype.isPerspectiveCamera=!0;const Os=90;class CubeCamera extends Object3D{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new PerspectiveCamera(Os,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Vector3(1,0,0)),this.add(i);const s=new PerspectiveCamera(Os,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Vector3(-1,0,0)),this.add(s);const r=new PerspectiveCamera(Os,1,e,t);r.layers=this.layers,r.up.set(0,0,1),r.lookAt(new Vector3(0,1,0)),this.add(r);const o=new PerspectiveCamera(Os,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Vector3(0,-1,0)),this.add(o);const a=new PerspectiveCamera(Os,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Vector3(0,0,1)),this.add(a);const l=new PerspectiveCamera(Os,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Vector3(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,s,r,o,a,l]=this.children,c=e.getRenderTarget(),d=e.outputEncoding,u=e.toneMapping,h=e.xr.enabled;e.outputEncoding=It,e.toneMapping=X,e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,i),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,r),e.setRenderTarget(n,3),e.render(t,o),e.setRenderTarget(n,4),e.render(t,a),n.texture.generateMipmaps=p,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(c),e.outputEncoding=d,e.toneMapping=u,e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(e,t,n,i,s,r,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:re,n,i,s,r,o,a,l,c),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}CubeTexture.prototype.isCubeTexture=!0;class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(e,t={}){super(e,e,t);const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new CubeTexture(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:ye}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new BoxGeometry(5,5,5),s=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:xs(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:f,blending:b});s.uniforms.tEquirect.value=t;const r=new Mesh(i,s),o=t.minFilter;t.minFilter===Ee&&(t.minFilter=ye);return new CubeCamera(1,10,this).update(e,r),t.minFilter=o,r.geometry.dispose(),r.material.dispose(),this}clear(e,t,n,i){const s=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,i);e.setRenderTarget(s)}}WebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget=!0;const As=new Vector3,Cs=new Vector3,Ns=new Matrix3;class Plane{constructor(e=new Vector3(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=As.subVectors(n,t).cross(Cs.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(As),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||Ns.getNormalMatrix(e),i=this.coplanarPoint(As).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Plane.prototype.isPlane=!0;const Ds=new Sphere,Is=new Vector3;class Frustum{constructor(e=new Plane,t=new Plane,n=new Plane,i=new Plane,s=new Plane,r=new Plane){this.planes=[e,t,n,i,s,r]}set(e,t,n,i,s,r){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(s),o[5].copy(r),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,i=n[0],s=n[1],r=n[2],o=n[3],a=n[4],l=n[5],c=n[6],d=n[7],u=n[8],h=n[9],p=n[10],m=n[11],f=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-i,d-a,m-u,y-f).normalize(),t[1].setComponents(o+i,d+a,m+u,y+f).normalize(),t[2].setComponents(o+s,d+l,m+h,y+g).normalize(),t[3].setComponents(o-s,d-l,m-h,y-g).normalize(),t[4].setComponents(o-r,d-c,m-p,y-v).normalize(),t[5].setComponents(o+r,d+c,m+p,y+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ds.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ds)}intersectsSprite(e){return Ds.center.set(0,0,0),Ds.radius=.7071067811865476,Ds.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ds)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(n)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Is.x=i.normal.x>0?e.max.x:e.min.x,Is.y=i.normal.y>0?e.max.y:e.min.y,Is.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Is)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ls(){let e=null,t=!1,n=null,i=null;function s(t,r){n(t,r),i=e.requestAnimationFrame(s)}return{start:function(){!0!==t&&null!==n&&(i=e.requestAnimationFrame(s),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Ps(e,t){const n=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const n=i.get(t);n&&(e.deleteBuffer(n.buffer),i.delete(t))},update:function(t,s){if(t.isGLBufferAttribute){const e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const r=i.get(t);void 0===r?i.set(t,function(t,i){const s=t.array,r=t.usage,o=e.createBuffer();let a;if(e.bindBuffer(i,o),e.bufferData(i,s,r),t.onUploadCallback(),s instanceof Float32Array)a=5126;else if(s instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(s instanceof Int16Array)a=5122;else if(s instanceof Uint32Array)a=5125;else if(s instanceof Int32Array)a=5124;else if(s instanceof Int8Array)a=5120;else if(s instanceof Uint8Array)a=5121;else{if(!(s instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+s);a=5121}return{buffer:o,type:a,bytesPerElement:s.BYTES_PER_ELEMENT,version:t.version}}(t,s)):r.version<t.version&&(!function(t,i,s){const r=i.array,o=i.updateRange;e.bindBuffer(s,t),-1===o.count?e.bufferSubData(s,0,r):(n?e.bufferSubData(s,o.offset*r.BYTES_PER_ELEMENT,r,o.offset,o.count):e.bufferSubData(s,o.offset*r.BYTES_PER_ELEMENT,r.subarray(o.offset,o.offset+o.count)),o.count=-1)}(r.buffer,t,s),r.version=t.version)}}}class PlaneGeometry extends BufferGeometry{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,r=t/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,d=e/o,u=t/a,h=[],p=[],m=[],f=[];for(let e=0;e<c;e++){const t=e*u-r;for(let n=0;n<l;n++){const i=n*d-s;p.push(i,-t,0),m.push(0,0,1),f.push(n/o),f.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<o;t++){const n=t+l*e,i=t+l*(e+1),s=t+1+l*(e+1),r=t+1+l*e;h.push(n,i,r),h.push(i,s,r)}this.setIndex(h),this.setAttribute("position",new Float32BufferAttribute(p,3)),this.setAttribute("normal",new Float32BufferAttribute(m,3)),this.setAttribute("uv",new Float32BufferAttribute(f,2))}static fromJSON(e){return new PlaneGeometry(e.width,e.height,e.widthSegments,e.heightSegments)}}const Rs={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},ks={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},uv2Transform:{value:new Matrix3},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Matrix3}}},Us={basic:{uniforms:_s([ks.common,ks.specularmap,ks.envmap,ks.aomap,ks.lightmap,ks.fog]),vertexShader:Rs.meshbasic_vert,fragmentShader:Rs.meshbasic_frag},lambert:{uniforms:_s([ks.common,ks.specularmap,ks.envmap,ks.aomap,ks.lightmap,ks.emissivemap,ks.fog,ks.lights,{emissive:{value:new Color(0)}}]),vertexShader:Rs.meshlambert_vert,fragmentShader:Rs.meshlambert_frag},phong:{uniforms:_s([ks.common,ks.specularmap,ks.envmap,ks.aomap,ks.lightmap,ks.emissivemap,ks.bumpmap,ks.normalmap,ks.displacementmap,ks.fog,ks.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:Rs.meshphong_vert,fragmentShader:Rs.meshphong_frag},standard:{uniforms:_s([ks.common,ks.envmap,ks.aomap,ks.lightmap,ks.emissivemap,ks.bumpmap,ks.normalmap,ks.displacementmap,ks.roughnessmap,ks.metalnessmap,ks.fog,ks.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Rs.meshphysical_vert,fragmentShader:Rs.meshphysical_frag},toon:{uniforms:_s([ks.common,ks.aomap,ks.lightmap,ks.emissivemap,ks.bumpmap,ks.normalmap,ks.displacementmap,ks.gradientmap,ks.fog,ks.lights,{emissive:{value:new Color(0)}}]),vertexShader:Rs.meshtoon_vert,fragmentShader:Rs.meshtoon_frag},matcap:{uniforms:_s([ks.common,ks.bumpmap,ks.normalmap,ks.displacementmap,ks.fog,{matcap:{value:null}}]),vertexShader:Rs.meshmatcap_vert,fragmentShader:Rs.meshmatcap_frag},points:{uniforms:_s([ks.points,ks.fog]),vertexShader:Rs.points_vert,fragmentShader:Rs.points_frag},dashed:{uniforms:_s([ks.common,ks.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Rs.linedashed_vert,fragmentShader:Rs.linedashed_frag},depth:{uniforms:_s([ks.common,ks.displacementmap]),vertexShader:Rs.depth_vert,fragmentShader:Rs.depth_frag},normal:{uniforms:_s([ks.common,ks.bumpmap,ks.normalmap,ks.displacementmap,{opacity:{value:1}}]),vertexShader:Rs.meshnormal_vert,fragmentShader:Rs.meshnormal_frag},sprite:{uniforms:_s([ks.sprite,ks.fog]),vertexShader:Rs.sprite_vert,fragmentShader:Rs.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:Rs.background_vert,fragmentShader:Rs.background_frag},cube:{uniforms:_s([ks.envmap,{opacity:{value:1}}]),vertexShader:Rs.cube_vert,fragmentShader:Rs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Rs.equirect_vert,fragmentShader:Rs.equirect_frag},distanceRGBA:{uniforms:_s([ks.common,ks.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Rs.distanceRGBA_vert,fragmentShader:Rs.distanceRGBA_frag},shadow:{uniforms:_s([ks.lights,ks.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:Rs.shadow_vert,fragmentShader:Rs.shadow_frag}};function Bs(e,t,n,i,s,r){const o=new Color(0);let a,l,c=!0===s?0:1,d=null,u=0,h=null;function p(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,r)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),c=t,p(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,p(o,c)},render:function(n,s){let r=!1,g=!0===s.isScene?s.background:null;g&&g.isTexture&&(g=t.get(g));const v=e.xr,y=v.getSession&&v.getSession();y&&"additive"===y.environmentBlendMode&&(g=null),null===g?p(o,c):g&&g.isColor&&(p(g,1),r=!0),(e.autoClear||r)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.mapping===ce)?(void 0===l&&(l=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:xs(Us.cube.uniforms),vertexShader:Us.cube.vertexShader,fragmentShader:Us.cube.fragmentShader,side:f,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,d===g&&u===g.version&&h===e.toneMapping||(l.material.needsUpdate=!0,d=g,u=g.version,h=e.toneMapping),n.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===a&&(a=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:xs(Us.background.uniforms),vertexShader:Us.background.vertexShader,fragmentShader:Us.background.fragmentShader,side:m,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),a.material.uniforms.uvTransform.value.copy(g.matrix),d===g&&u===g.version&&h===e.toneMapping||(a.material.needsUpdate=!0,d=g,u=g.version,h=e.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null))}}}function Fs(e,t,n,i){const s=e.getParameter(34921),r=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||null!==r,a={},l=p(null);let c=l,d=!1;function u(t){return i.isWebGL2?e.bindVertexArray(t):r.bindVertexArrayOES(t)}function h(t){return i.isWebGL2?e.deleteVertexArray(t):r.deleteVertexArrayOES(t)}function p(e){const t=[],n=[],i=[];for(let e=0;e<s;e++)t[e]=0,n[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:i,object:e,attributes:{},index:null}}function m(){const e=c.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function f(e){g(e,0)}function g(n,s){const r=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(r[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),a[n]!==s){(i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,s),a[n]=s}}function v(){const t=c.newAttributes,n=c.enabledAttributes;for(let i=0,s=n.length;i<s;i++)n[i]!==t[i]&&(e.disableVertexAttribArray(i),n[i]=0)}function y(t,n,s,r,o,a){!0!==i.isWebGL2||5124!==s&&5125!==s?e.vertexAttribPointer(t,n,s,r,o,a):e.vertexAttribIPointer(t,n,s,o,a)}function b(){S(),d=!0,c!==l&&(c=l,u(c.object))}function S(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(s,l,h,b,S){let E=!1;if(o){const t=function(t,n,s){const o=!0===s.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let d=c[o];void 0===d&&(d=p(i.isWebGL2?e.createVertexArray():r.createVertexArrayOES()),c[o]=d);return d}(b,h,l);c!==t&&(c=t,u(c.object)),E=function(e,t){const n=c.attributes,i=e.attributes;let s=0;for(const e in i){const t=n[e],r=i[e];if(void 0===t)return!0;if(t.attribute!==r)return!0;if(t.data!==r.data)return!0;s++}return c.attributesNum!==s||c.index!==t}(b,S),E&&function(e,t){const n={},i=e.attributes;let s=0;for(const e in i){const t=i[e],r={};r.attribute=t,t.data&&(r.data=t.data),n[e]=r,s++}c.attributes=n,c.attributesNum=s,c.index=t}(b,S)}else{const e=!0===l.wireframe;c.geometry===b.id&&c.program===h.id&&c.wireframe===e||(c.geometry=b.id,c.program=h.id,c.wireframe=e,E=!0)}!0===s.isInstancedMesh&&(E=!0),null!==S&&n.update(S,34963),(E||d)&&(d=!1,function(s,r,o,a){if(!1===i.isWebGL2&&(s.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;m();const l=a.attributes,c=o.getAttributes(),d=r.defaultAttributeValues;for(const t in c){const i=c[t];if(i.location>=0){let r=l[t];if(void 0===r&&("instanceMatrix"===t&&s.instanceMatrix&&(r=s.instanceMatrix),"instanceColor"===t&&s.instanceColor&&(r=s.instanceColor)),void 0!==r){const t=r.normalized,o=r.itemSize,l=n.get(r);if(void 0===l)continue;const c=l.buffer,d=l.type,u=l.bytesPerElement;if(r.isInterleavedBufferAttribute){const n=r.data,l=n.stride,h=r.offset;if(n.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)g(i.location+e,n.meshPerAttribute);!0!==s.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let e=0;e<i.locationSize;e++)f(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)y(i.location+e,o/i.locationSize,d,t,l*u,(h+o/i.locationSize*e)*u)}else{if(r.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)g(i.location+e,r.meshPerAttribute);!0!==s.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<i.locationSize;e++)f(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)y(i.location+e,o/i.locationSize,d,t,o*u,o/i.locationSize*e*u)}}else if(void 0!==d){const n=d[t];if(void 0!==n)switch(n.length){case 2:e.vertexAttrib2fv(i.location,n);break;case 3:e.vertexAttrib3fv(i.location,n);break;case 4:e.vertexAttrib4fv(i.location,n);break;default:e.vertexAttrib1fv(i.location,n)}}}}v()}(s,l,h,b),null!==S&&e.bindBuffer(34963,n.get(S).buffer))},reset:b,resetDefaultState:S,dispose:function(){b();for(const e in a){const t=a[e];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const e in t){const n=t[e];for(const e in n)h(n[e].object),delete n[e];delete t[e]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const n=a[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)h(i[e].object),delete i[e];delete n[e.id]}},initAttributes:m,enableAttribute:f,disableUnusedAttributes:v}}function Vs(e,t,n,i){const s=i.isWebGL2;let r;this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=function(i,o,a){if(0===a)return;let l,c;if(s)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](r,i,o,a),n.update(o,r,a)}}function Hs(e,t,n){let i;function s(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const r="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const a=s(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=r||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,d=e.getParameter(34930),u=e.getParameter(35660),h=e.getParameter(3379),p=e.getParameter(34076),m=e.getParameter(34921),f=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),y=u>0,b=r||t.has("OES_texture_float");return{isWebGL2:r,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:s,precision:o,logarithmicDepthBuffer:c,maxTextures:d,maxVertexTextures:u,maxTextureSize:h,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:f,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:r?e.getParameter(36183):0}}function js(e){const t=this;let n=null,i=0,s=!1,r=!1;const o=new Plane,a=new Matrix3,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function d(e,n,i,s){const r=null!==e?e.length:0;let c=null;if(0!==r){if(c=l.value,!0!==s||null===c){const t=i+4*r,s=n.matrixWorldInverse;a.getNormalMatrix(s),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,n=i;t!==r;++t,n+=4)o.copy(e[t]).applyMatrix4(s,a),o.normal.toArray(c,n),c[n+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=r,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,r){const o=0!==e.length||t||0!==i||s;return s=t,n=d(e,r,0),i=e.length,o},this.beginShadows=function(){r=!0,d(null)},this.endShadows=function(){r=!1,c()},this.setState=function(t,o,a){const u=t.clippingPlanes,h=t.clipIntersection,p=t.clipShadows,m=e.get(t);if(!s||null===u||0===u.length||r&&!p)r?d(null):c();else{const e=r?0:i,t=4*e;let s=m.clippingState||null;l.value=s,s=d(u,o,t,a);for(let e=0;e!==t;++e)s[e]=n[e];m.clippingState=s,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}}}function Gs(e){let t=new WeakMap;function n(e,t){return t===ae?e.mapping=re:t===le&&(e.mapping=oe),e}function i(e){const n=e.target;n.removeEventListener("dispose",i);const s=t.get(n);void 0!==s&&(t.delete(n),s.dispose())}return{get:function(s){if(s&&s.isTexture&&!1===s.isRenderTargetTexture){const r=s.mapping;if(r===ae||r===le){if(t.has(s)){return n(t.get(s).texture,s.mapping)}{const r=s.image;if(r&&r.height>0){const o=new WebGLCubeRenderTarget(r.height/2);return o.fromEquirectangularTexture(e,s),t.set(s,o),s.addEventListener("dispose",i),n(o.texture,s.mapping)}return null}}}return s},dispose:function(){t=new WeakMap}}}Us.physical={uniforms:_s([Us.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Rs.meshphysical_vert,fragmentShader:Rs.meshphysical_frag};class OrthographicCamera extends Camera{constructor(e=-1,t=1,n=1,i=-1,s=.1,r=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=r,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,r){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=r,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,r=n+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=e*this.view.offsetX,r=s+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(s,r,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}OrthographicCamera.prototype.isOrthographicCamera=!0;const zs=[.125,.215,.35,.446,.526,.582],Ws=20,Ks=new OrthographicCamera,Ys=new Color;let qs=null;const Zs=(1+Math.sqrt(5))/2,$s=1/Zs,Qs=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,Zs,$s),new Vector3(0,Zs,-$s),new Vector3($s,0,Zs),new Vector3(-$s,0,Zs),new Vector3(Zs,$s,0),new Vector3(-Zs,$s,0)];class PMREMGenerator{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){qs=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=tr(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=er(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(qs),e.scissorTest=!1,Js(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===re||e.mapping===oe?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),qs=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,n={magFilter:ye,minFilter:ye,generateMipmaps:!1,type:Ne,format:ke,encoding:It,depthBuffer:!1},i=Xs(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Xs(e,t,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],n=[],i=[];let s=e;const r=e-4+1+zs.length;for(let o=0;o<r;o++){const r=Math.pow(2,s);n.push(r);let a=1/r;o>e-4?a=zs[o-e+4-1]:0===o&&(a=0),i.push(a);const l=1/(r-1),c=-l/2,d=1+l/2,u=[c,c,d,c,d,d,c,c,d,d,c,d],h=6,p=6,m=3,f=2,g=1,v=new Float32Array(m*p*h),y=new Float32Array(f*p*h),b=new Float32Array(g*p*h);for(let e=0;e<h;e++){const t=e%3*2/3-1,n=e>2?0:-1,i=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(i,m*p*e),y.set(u,f*p*e);const s=[e,e,e,e,e,e];b.set(s,g*p*e)}const S=new BufferGeometry;S.setAttribute("position",new BufferAttribute(v,m)),S.setAttribute("uv",new BufferAttribute(y,f)),S.setAttribute("faceIndex",new BufferAttribute(b,g)),t.push(S),s>4&&s--}return{lodPlanes:t,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(e,t,n){const i=new Float32Array(Ws),s=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:Ws,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:nr(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:b,depthTest:!1,depthWrite:!1})}(i,e,t)}return i}_compileMaterial(e){const t=new Mesh(this._lodPlanes[0],e);this._renderer.compile(t,Ks)}_sceneToCubeUV(e,t,n,i){const s=new PerspectiveCamera(90,1,t,n),r=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(Ys),a.toneMapping=X,a.autoClear=!1;const d=new MeshBasicMaterial({name:"PMREM.Background",side:f,depthWrite:!1,depthTest:!1}),u=new Mesh(new BoxGeometry,d);let h=!1;const p=e.background;p?p.isColor&&(d.color.copy(p),e.background=null,h=!0):(d.color.copy(Ys),h=!0);for(let t=0;t<6;t++){const n=t%3;0===n?(s.up.set(0,r[t],0),s.lookAt(o[t],0,0)):1===n?(s.up.set(0,0,r[t]),s.lookAt(0,o[t],0)):(s.up.set(0,r[t],0),s.lookAt(0,0,o[t]));const l=this._cubeSize;Js(i,n*l,t>2?l:0,l,l),a.setRenderTarget(i),h&&a.render(u,s),a.render(e,s)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===re||e.mapping===oe;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=tr()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=er());const s=i?this._cubemapMaterial:this._equirectMaterial,r=new Mesh(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const o=this._cubeSize;Js(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(r,Ks)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){const n=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=Qs[(t-1)%Qs.length];this._blur(e,t-1,t,n,i)}t.autoClear=n}_blur(e,t,n,i,s){const r=this._pingPongRenderTarget;this._halfBlur(e,r,t,n,i,"latitudinal",s),this._halfBlur(r,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,r,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==r&&"longitudinal"!==r&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new Mesh(this._lodPlanes[i],l),d=l.uniforms,u=this._sizeLods[n]-1,h=isFinite(s)?Math.PI/(2*u):2*Math.PI/39,p=s/h,m=isFinite(s)?1+Math.floor(3*p):Ws;m>Ws&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to 20`);const f=[];let g=0;for(let e=0;e<Ws;++e){const t=e/p,n=Math.exp(-t*t/2);f.push(n),0===e?g+=n:e<m&&(g+=2*n)}for(let e=0;e<f.length;e++)f[e]=f[e]/g;d.envMap.value=e.texture,d.samples.value=m,d.weights.value=f,d.latitudinal.value="latitudinal"===r,o&&(d.poleAxis.value=o);const{_lodMax:v}=this;d.dTheta.value=h,d.mipInt.value=v-n;const y=this._sizeLods[i];Js(t,3*y*(i>v-4?i-v+4:0),4*(this._cubeSize-y),3*y,2*y),a.setRenderTarget(t),a.render(c,Ks)}}function Xs(e,t,n){const i=new WebGLRenderTarget(e,t,n);return i.texture.mapping=ce,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Js(e,t,n,i,s){e.viewport.set(t,n,i,s),e.scissor.set(t,n,i,s)}function er(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:nr(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:b,depthTest:!1,depthWrite:!1})}function tr(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:nr(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:b,depthTest:!1,depthWrite:!1})}function nr(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function ir(e){let t=new WeakMap,n=null;function i(e){const n=e.target;n.removeEventListener("dispose",i);const s=t.get(n);void 0!==s&&(t.delete(n),s.dispose())}return{get:function(s){if(s&&s.isTexture){const r=s.mapping,o=r===ae||r===le,a=r===re||r===oe;if(o||a){if(s.isRenderTargetTexture&&!0===s.needsPMREMUpdate){s.needsPMREMUpdate=!1;let i=t.get(s);return null===n&&(n=new PMREMGenerator(e)),i=o?n.fromEquirectangular(s,i):n.fromCubemap(s,i),t.set(s,i),i.texture}if(t.has(s))return t.get(s).texture;{const r=s.image;if(o&&r&&r.height>0||a&&r&&function(e){let t=0;const n=6;for(let i=0;i<n;i++)void 0!==e[i]&&t++;return t===n}(r)){null===n&&(n=new PMREMGenerator(e));const r=o?n.fromEquirectangular(s):n.fromCubemap(s);return t.set(s,r),s.addEventListener("dispose",i),r.texture}return null}}}return s},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function sr(e){const t={};function n(n){if(void 0!==t[n])return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){const t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function rr(e,t,n,i){const s={},r=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const e in a.attributes)t.remove(a.attributes[e]);a.removeEventListener("dispose",o),delete s[a.id];const l=r.get(a);l&&(t.remove(l),r.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(e){const n=[],i=e.index,s=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],s=e[t+1],r=e[t+2];n.push(i,s,s,r,r,i)}}else{const e=s.array;o=s.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,s=t+2;n.push(e,i,i,s,s,e)}}const a=new(An(n)?Uint32BufferAttribute:Uint16BufferAttribute)(n,1);a.version=o;const l=r.get(e);l&&t.remove(l),r.set(e,a)}return{get:function(e,t){return!0===s[t.id]||(t.addEventListener("dispose",o),s[t.id]=!0,n.memory.geometries++),t},update:function(e){const n=e.attributes;for(const e in n)t.update(n[e],34962);const i=e.morphAttributes;for(const e in i){const n=i[e];for(let e=0,i=n.length;e<i;e++)t.update(n[e],34962)}},getWireframeAttribute:function(e){const t=r.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return r.get(e)}}}function or(e,t,n,i){const s=i.isWebGL2;let r,o,a;this.setMode=function(e){r=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,i){e.drawElements(r,i,o,t*a),n.update(i,r,1)},this.renderInstances=function(i,l,c){if(0===c)return;let d,u;if(s)d=e,u="drawElementsInstanced";else if(d=t.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===d)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[u](r,l,o,i*a,c),n.update(l,r,c)}}function ar(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,i){switch(t.calls++,n){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function lr(e,t){return e[0]-t[0]}function cr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function dr(e,t){let n=1;const i=t.isInterleavedBufferAttribute?t.data.array:t.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),e.divideScalar(n)}function ur(e,t,n){const i={},s=new Float32Array(8),r=new WeakMap,o=new Vector4,a=[];for(let e=0;e<8;e++)a[e]=[e,0];return{update:function(l,c,d,u){const h=l.morphTargetInfluences;if(!0===t.isWebGL2){const i=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,s=void 0!==i?i.length:0;let a=r.get(c);if(void 0===a||a.count!==s){void 0!==a&&a.texture.dispose();const e=void 0!==c.morphAttributes.position,n=void 0!==c.morphAttributes.normal,i=void 0!==c.morphAttributes.color,l=c.morphAttributes.position||[],d=c.morphAttributes.normal||[],u=c.morphAttributes.color||[];let h=0;!0===e&&(h=1),!0===n&&(h=2),!0===i&&(h=3);let p=c.attributes.position.count*h,m=1;p>t.maxTextureSize&&(m=Math.ceil(p/t.maxTextureSize),p=t.maxTextureSize);const f=new Float32Array(p*m*4*s),g=new DataArrayTexture(f,p,m,s);g.type=Ce,g.needsUpdate=!0;const v=4*h;for(let t=0;t<s;t++){const s=l[t],r=d[t],a=u[t],c=p*m*4*t;for(let t=0;t<s.count;t++){const l=t*v;!0===e&&(o.fromBufferAttribute(s,t),!0===s.normalized&&dr(o,s),f[c+l+0]=o.x,f[c+l+1]=o.y,f[c+l+2]=o.z,f[c+l+3]=0),!0===n&&(o.fromBufferAttribute(r,t),!0===r.normalized&&dr(o,r),f[c+l+4]=o.x,f[c+l+5]=o.y,f[c+l+6]=o.z,f[c+l+7]=0),!0===i&&(o.fromBufferAttribute(a,t),!0===a.normalized&&dr(o,a),f[c+l+8]=o.x,f[c+l+9]=o.y,f[c+l+10]=o.z,f[c+l+11]=4===a.itemSize?o.w:1)}}a={count:s,texture:g,size:new Vector2(p,m)},r.set(c,a),c.addEventListener("dispose",(function e(){g.dispose(),r.delete(c),c.removeEventListener("dispose",e)}))}let l=0;for(let e=0;e<h.length;e++)l+=h[e];const d=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(e,"morphTargetBaseInfluence",d),u.getUniforms().setValue(e,"morphTargetInfluences",h),u.getUniforms().setValue(e,"morphTargetsTexture",a.texture,n),u.getUniforms().setValue(e,"morphTargetsTextureSize",a.size)}else{const t=void 0===h?0:h.length;let n=i[c.id];if(void 0===n||n.length!==t){n=[];for(let e=0;e<t;e++)n[e]=[e,0];i[c.id]=n}for(let e=0;e<t;e++){const t=n[e];t[0]=e,t[1]=h[e]}n.sort(cr);for(let e=0;e<8;e++)e<t&&n[e][1]?(a[e][0]=n[e][0],a[e][1]=n[e][1]):(a[e][0]=Number.MAX_SAFE_INTEGER,a[e][1]=0);a.sort(lr);const r=c.morphAttributes.position,o=c.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=a[e],n=t[0],i=t[1];n!==Number.MAX_SAFE_INTEGER&&i?(r&&c.getAttribute("morphTarget"+e)!==r[n]&&c.setAttribute("morphTarget"+e,r[n]),o&&c.getAttribute("morphNormal"+e)!==o[n]&&c.setAttribute("morphNormal"+e,o[n]),s[e]=i,l+=i):(r&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),o&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),s[e]=0)}const d=c.morphTargetsRelative?1:1-l;u.getUniforms().setValue(e,"morphTargetBaseInfluence",d),u.getUniforms().setValue(e,"morphTargetInfluences",s)}}}}function hr(e,t,n,i){let s=new WeakMap;function r(e){const t=e.target;t.removeEventListener("dispose",r),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){const o=i.render.frame,a=e.geometry,l=t.get(e,a);return s.get(l)!==o&&(t.update(l),s.set(l,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",r)&&e.addEventListener("dispose",r),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),l},dispose:function(){s=new WeakMap}}}const pr=new Texture,mr=new DataArrayTexture,fr=new Data3DTexture,gr=new CubeTexture,vr=[],yr=[],br=new Float32Array(16),Sr=new Float32Array(9),Er=new Float32Array(4);function Tr(e,t,n){const i=e[0];if(i<=0||i>0)return e;const s=t*n;let r=vr[s];if(void 0===r&&(r=new Float32Array(s),vr[s]=r),0!==t){i.toArray(r,0);for(let i=1,s=0;i!==t;++i)s+=n,e[i].toArray(r,s)}return r}function wr(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function xr(e,t){for(let n=0,i=t.length;n<i;n++)e[n]=t[n]}function _r(e,t){let n=yr[t];void 0===n&&(n=new Int32Array(t),yr[t]=n);for(let i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function Mr(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Or(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(wr(n,t))return;e.uniform2fv(this.addr,t),xr(n,t)}}function Ar(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(wr(n,t))return;e.uniform3fv(this.addr,t),xr(n,t)}}function Cr(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(wr(n,t))return;e.uniform4fv(this.addr,t),xr(n,t)}}function Nr(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(wr(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),xr(n,t)}else{if(wr(n,i))return;Er.set(i),e.uniformMatrix2fv(this.addr,!1,Er),xr(n,i)}}function Dr(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(wr(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),xr(n,t)}else{if(wr(n,i))return;Sr.set(i),e.uniformMatrix3fv(this.addr,!1,Sr),xr(n,i)}}function Ir(e,t){const n=this.cache,i=t.elements;if(void 0===i){if(wr(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),xr(n,t)}else{if(wr(n,i))return;br.set(i),e.uniformMatrix4fv(this.addr,!1,br),xr(n,i)}}function Lr(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Pr(e,t){const n=this.cache;wr(n,t)||(e.uniform2iv(this.addr,t),xr(n,t))}function Rr(e,t){const n=this.cache;wr(n,t)||(e.uniform3iv(this.addr,t),xr(n,t))}function kr(e,t){const n=this.cache;wr(n,t)||(e.uniform4iv(this.addr,t),xr(n,t))}function Ur(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Br(e,t){const n=this.cache;wr(n,t)||(e.uniform2uiv(this.addr,t),xr(n,t))}function Fr(e,t){const n=this.cache;wr(n,t)||(e.uniform3uiv(this.addr,t),xr(n,t))}function Vr(e,t){const n=this.cache;wr(n,t)||(e.uniform4uiv(this.addr,t),xr(n,t))}function Hr(e,t,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(e.uniform1i(this.addr,s),i[0]=s),n.setTexture2D(t||pr,s)}function jr(e,t,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(e.uniform1i(this.addr,s),i[0]=s),n.setTexture3D(t||fr,s)}function Gr(e,t,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(e.uniform1i(this.addr,s),i[0]=s),n.setTextureCube(t||gr,s)}function zr(e,t,n){const i=this.cache,s=n.allocateTextureUnit();i[0]!==s&&(e.uniform1i(this.addr,s),i[0]=s),n.setTexture2DArray(t||mr,s)}function Wr(e,t){e.uniform1fv(this.addr,t)}function Kr(e,t){const n=Tr(t,this.size,2);e.uniform2fv(this.addr,n)}function Yr(e,t){const n=Tr(t,this.size,3);e.uniform3fv(this.addr,n)}function qr(e,t){const n=Tr(t,this.size,4);e.uniform4fv(this.addr,n)}function Zr(e,t){const n=Tr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function $r(e,t){const n=Tr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Qr(e,t){const n=Tr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Xr(e,t){e.uniform1iv(this.addr,t)}function Jr(e,t){e.uniform2iv(this.addr,t)}function eo(e,t){e.uniform3iv(this.addr,t)}function to(e,t){e.uniform4iv(this.addr,t)}function no(e,t){e.uniform1uiv(this.addr,t)}function io(e,t){e.uniform2uiv(this.addr,t)}function so(e,t){e.uniform3uiv(this.addr,t)}function ro(e,t){e.uniform4uiv(this.addr,t)}function oo(e,t,n){const i=t.length,s=_r(n,i);e.uniform1iv(this.addr,s);for(let e=0;e!==i;++e)n.setTexture2D(t[e]||pr,s[e])}function ao(e,t,n){const i=t.length,s=_r(n,i);e.uniform1iv(this.addr,s);for(let e=0;e!==i;++e)n.setTexture3D(t[e]||fr,s[e])}function lo(e,t,n){const i=t.length,s=_r(n,i);e.uniform1iv(this.addr,s);for(let e=0;e!==i;++e)n.setTextureCube(t[e]||gr,s[e])}function co(e,t,n){const i=t.length,s=_r(n,i);e.uniform1iv(this.addr,s);for(let e=0;e!==i;++e)n.setTexture2DArray(t[e]||mr,s[e])}function uo(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Mr;case 35664:return Or;case 35665:return Ar;case 35666:return Cr;case 35674:return Nr;case 35675:return Dr;case 35676:return Ir;case 5124:case 35670:return Lr;case 35667:case 35671:return Pr;case 35668:case 35672:return Rr;case 35669:case 35673:return kr;case 5125:return Ur;case 36294:return Br;case 36295:return Fr;case 36296:return Vr;case 35678:case 36198:case 36298:case 36306:case 35682:return Hr;case 35679:case 36299:case 36307:return jr;case 35680:case 36300:case 36308:case 36293:return Gr;case 36289:case 36303:case 36311:case 36292:return zr}}(t.type)}function ho(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Wr;case 35664:return Kr;case 35665:return Yr;case 35666:return qr;case 35674:return Zr;case 35675:return $r;case 35676:return Qr;case 5124:case 35670:return Xr;case 35667:case 35671:return Jr;case 35668:case 35672:return eo;case 35669:case 35673:return to;case 5125:return no;case 36294:return io;case 36295:return so;case 36296:return ro;case 35678:case 36198:case 36298:case 36306:case 35682:return oo;case 35679:case 36299:case 36307:return ao;case 35680:case 36300:case 36308:case 36293:return lo;case 36289:case 36303:case 36311:case 36292:return co}}(t.type)}function po(e){this.id=e,this.seq=[],this.map={}}ho.prototype.updateCache=function(e){const t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),xr(t,e)},po.prototype.setValue=function(e,t,n){const i=this.seq;for(let s=0,r=i.length;s!==r;++s){const r=i[s];r.setValue(e,t[r.id],n)}};const mo=/(\w+)(\])?(\[|\.)?/g;function fo(e,t){e.seq.push(t),e.map[t.id]=t}function go(e,t,n){const i=e.name,s=i.length;for(mo.lastIndex=0;;){const r=mo.exec(i),o=mo.lastIndex;let a=r[1];const l="]"===r[2],c=r[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===s){fo(n,void 0===c?new uo(a,e,t):new ho(a,e,t));break}{let e=n.map[a];void 0===e&&(e=new po(a),fo(n,e)),n=e}}}function vo(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let i=0;i<n;++i){const n=e.getActiveUniform(t,i);go(n,e.getUniformLocation(t,n.name),this)}}function yo(e,t,n){const i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}vo.prototype.setValue=function(e,t,n,i){const s=this.map[t];void 0!==s&&s.setValue(e,n,i)},vo.prototype.setOptional=function(e,t,n){const i=t[n];void 0!==i&&this.setValue(e,n,i)},vo.upload=function(e,t,n,i){for(let s=0,r=t.length;s!==r;++s){const r=t[s],o=n[r.id];!1!==o.needsUpdate&&r.setValue(e,o.value,i)}},vo.seqWithValue=function(e,t){const n=[];for(let i=0,s=e.length;i!==s;++i){const s=e[i];s.id in t&&n.push(s)}return n};let bo=0;function So(e,t,n){const i=e.getShaderParameter(t,35713),s=e.getShaderInfoLog(t).trim();if(i&&""===s)return"";const r=parseInt(/ERROR: 0:(\d+)/.exec(s)[1]);return n.toUpperCase()+"\n\n"+s+"\n\n"+function(e,t){const n=e.split("\n"),i=[],s=Math.max(t-6,0),r=Math.min(t+6,n.length);for(let e=s;e<r;e++)i.push(e+1+": "+n[e]);return i.join("\n")}(e.getShaderSource(t),r)}function Eo(e,t){const n=function(e){switch(e){case It:return["Linear","( value )"];case Lt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function To(e,t){let n;switch(t){case J:n="Linear";break;case ee:n="Reinhard";break;case te:n="OptimizedCineon";break;case ne:n="ACESFilmic";break;case ie:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function wo(e){return""!==e}function xo(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function _o(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const Mo=/^[ \t]*#include +<([\w\d./]+)>/gm;function Oo(e){return e.replace(Mo,Ao)}function Ao(e,t){const n=Rs[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Oo(n)}const Co=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,No=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Do(e){return e.replace(No,Lo).replace(Co,Io)}function Io(e,t,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Lo(e,t,n,i)}function Lo(e,t,n,i){let s="";for(let e=parseInt(t);e<parseInt(n);e++)s+=i.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return s}function Po(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ro(e,t,n,i){const s=e.getContext(),r=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===u?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===h?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===p&&(t="SHADOWMAP_TYPE_VSM"),t}(n),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case re:case oe:t="ENVMAP_TYPE_CUBE";break;case ce:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),d=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case oe:t="ENVMAP_MODE_REFRACTION"}return t}(n),m=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Z:t="ENVMAP_BLENDING_MULTIPLY";break;case $:t="ENVMAP_BLENDING_MIX";break;case Q:t="ENVMAP_BLENDING_ADD"}return t}(n),f=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t/32+1)+3,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),g=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(wo).join("\n")}(n),v=function(e){const t=[];for(const n in e){const i=e[n];!1!==i&&t.push("#define "+n+" "+i)}return t.join("\n")}(r),y=s.createProgram();let b,S,E=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(b=[v].filter(wo).join("\n"),b.length>0&&(b+="\n"),S=[g,v].filter(wo).join("\n"),S.length>0&&(S+="\n")):(b=[Po(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(wo).join("\n"),S=[g,Po(n),"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",n.envMap?"#define "+m:"",f?"#define CUBEUV_TEXEL_WIDTH "+f.texelWidth:"",f?"#define CUBEUV_TEXEL_HEIGHT "+f.texelHeight:"",f?"#define CUBEUV_MAX_MIP "+f.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==X?"#define TONE_MAPPING":"",n.toneMapping!==X?Rs.tonemapping_pars_fragment:"",n.toneMapping!==X?To("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Rs.encodings_pars_fragment,Eo("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(wo).join("\n")),o=Oo(o),o=xo(o,n),o=_o(o,n),a=Oo(a),a=xo(a,n),a=_o(a,n),o=Do(o),a=Do(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(E="#version 300 es\n",b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,S=["#define varying in",n.glslVersion===mn?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===mn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+S);const T=E+S+a,w=yo(s,35633,E+b+o),x=yo(s,35632,T);if(s.attachShader(y,w),s.attachShader(y,x),void 0!==n.index0AttributeName?s.bindAttribLocation(y,0,n.index0AttributeName):!0===n.morphTargets&&s.bindAttribLocation(y,0,"position"),s.linkProgram(y),e.debug.checkShaderErrors){const e=s.getProgramInfoLog(y).trim(),t=s.getShaderInfoLog(w).trim(),n=s.getShaderInfoLog(x).trim();let i=!0,r=!0;if(!1===s.getProgramParameter(y,35714)){i=!1;const t=So(s,w,"vertex"),n=So(s,x,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(y,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+n)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):""!==t&&""!==n||(r=!1);r&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:b},fragmentShader:{log:n,prefix:S}})}let _,M;return s.deleteShader(w),s.deleteShader(x),this.getUniforms=function(){return void 0===_&&(_=new vo(s,y)),_},this.getAttributes=function(){return void 0===M&&(M=function(e,t){const n={},i=e.getProgramParameter(t,35721);for(let s=0;s<i;s++){const i=e.getActiveAttrib(t,s),r=i.name;let o=1;35674===i.type&&(o=2),35675===i.type&&(o=3),35676===i.type&&(o=4),n[r]={type:i.type,location:e.getAttribLocation(t,r),locationSize:o}}return n}(s,y)),M},this.destroy=function(){i.releaseStatesOfProgram(this),s.deleteProgram(y),this.program=void 0},this.name=n.shaderName,this.id=bo++,this.cacheKey=t,this.usedTimes=1,this.program=y,this.vertexShader=w,this.fragmentShader=x,this}let ko=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(n),r=this._getShaderCacheForMaterial(e);return!1===r.has(i)&&(r.add(i),i.usedTimes++),!1===r.has(s)&&(r.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new WebGLShaderStage(e);t.set(e,n)}return t.get(e)}}class WebGLShaderStage{constructor(e){this.id=ko++,this.code=e,this.usedTimes=0}}function Uo(e,t,n,i,s,r,o){const a=new Layers,l=new WebGLShaderCache,c=[],d=s.isWebGL2,u=s.logarithmicDepthBuffer,h=s.floatVertexTextures,p=s.maxVertexUniforms,m=s.vertexTextures;let v=s.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(r,a,c,b,E){const T=b.fog,w=E.geometry,x=r.isMeshStandardMaterial?b.environment:null,_=(r.isMeshStandardMaterial?n:t).get(r.envMap||x),M=_&&_.mapping===ce?_.image.height:null,O=y[r.type],A=E.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(h)return 1024;{const e=p,n=Math.floor((e-20)/4),i=Math.min(n,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}}(E):0;null!==r.precision&&(v=s.getMaxPrecision(r.precision),v!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",v,"instead."));const C=w.morphAttributes.position||w.morphAttributes.normal||w.morphAttributes.color,N=void 0!==C?C.length:0;let D,I,L,P,R=0;if(void 0!==w.morphAttributes.position&&(R=1),void 0!==w.morphAttributes.normal&&(R=2),void 0!==w.morphAttributes.color&&(R=3),O){const e=Us[O];D=e.vertexShader,I=e.fragmentShader}else D=r.vertexShader,I=r.fragmentShader,l.update(r),L=l.getVertexShaderID(r),P=l.getFragmentShaderID(r);const k=e.getRenderTarget(),U=r.alphaTest>0,B=r.clearcoat>0;return{isWebGL2:d,shaderID:O,shaderName:r.type,vertexShader:D,fragmentShader:I,defines:r.defines,customVertexShaderID:L,customFragmentShaderID:P,isRawShaderMaterial:!0===r.isRawShaderMaterial,glslVersion:r.glslVersion,precision:v,instancing:!0===E.isInstancedMesh,instancingColor:!0===E.isInstancedMesh&&null!==E.instanceColor,supportsVertexTextures:m,outputEncoding:null===k?e.outputEncoding:!0===k.isXRRenderTarget?k.texture.encoding:It,map:!!r.map,matcap:!!r.matcap,envMap:!!_,envMapMode:_&&_.mapping,envMapCubeUVHeight:M,lightMap:!!r.lightMap,aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:r.normalMapType===Ut,tangentSpaceNormalMap:r.normalMapType===kt,decodeVideoTexture:!!r.map&&!0===r.map.isVideoTexture&&r.map.encoding===Lt,clearcoat:B,clearcoatMap:B&&!!r.clearcoatMap,clearcoatRoughnessMap:B&&!!r.clearcoatRoughnessMap,clearcoatNormalMap:B&&!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,specularIntensityMap:!!r.specularIntensityMap,specularColorMap:!!r.specularColorMap,opaque:!1===r.transparent&&r.blending===S,alphaMap:!!r.alphaMap,alphaTest:U,gradientMap:!!r.gradientMap,sheen:r.sheen>0,sheenColorMap:!!r.sheenColorMap,sheenRoughnessMap:!!r.sheenRoughnessMap,transmission:r.transmission>0,transmissionMap:!!r.transmissionMap,thicknessMap:!!r.thicknessMap,combine:r.combine,vertexTangents:!!r.normalMap&&!!w.attributes.tangent,vertexColors:r.vertexColors,vertexAlphas:!0===r.vertexColors&&!!w.attributes.color&&4===w.attributes.color.itemSize,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap||r.transmissionMap||r.thicknessMap||r.specularIntensityMap||r.specularColorMap||r.sheenColorMap||r.sheenRoughnessMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.transmission>0||r.transmissionMap||r.thicknessMap||r.specularIntensityMap||r.specularColorMap||r.sheen>0||r.sheenColorMap||r.sheenRoughnessMap||!r.displacementMap),fog:!!T,useFog:r.fog,fogExp2:T&&T.isFogExp2,flatShading:!!r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:u,skinning:!0===E.isSkinnedMesh&&A>0,maxBones:A,useVertexTexture:h,morphTargets:void 0!==w.morphAttributes.position,morphNormals:void 0!==w.morphAttributes.normal,morphColors:void 0!==w.morphAttributes.color,morphTargetsCount:N,morphTextureStride:R,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:r.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:r.toneMapped?e.toneMapping:X,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,doubleSided:r.side===g,flipSided:r.side===f,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.maxBones),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection)}(n,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0);t.supportsVertexTextures&&a.enable(1);t.instancing&&a.enable(2);t.instancingColor&&a.enable(3);t.map&&a.enable(4);t.matcap&&a.enable(5);t.envMap&&a.enable(6);t.lightMap&&a.enable(7);t.aoMap&&a.enable(8);t.emissiveMap&&a.enable(9);t.bumpMap&&a.enable(10);t.normalMap&&a.enable(11);t.objectSpaceNormalMap&&a.enable(12);t.tangentSpaceNormalMap&&a.enable(13);t.clearcoat&&a.enable(14);t.clearcoatMap&&a.enable(15);t.clearcoatRoughnessMap&&a.enable(16);t.clearcoatNormalMap&&a.enable(17);t.displacementMap&&a.enable(18);t.specularMap&&a.enable(19);t.roughnessMap&&a.enable(20);t.metalnessMap&&a.enable(21);t.gradientMap&&a.enable(22);t.alphaMap&&a.enable(23);t.alphaTest&&a.enable(24);t.vertexColors&&a.enable(25);t.vertexAlphas&&a.enable(26);t.vertexUvs&&a.enable(27);t.vertexTangents&&a.enable(28);t.uvsVertexOnly&&a.enable(29);t.fog&&a.enable(30);e.push(a.mask),a.disableAll(),t.useFog&&a.enable(0);t.flatShading&&a.enable(1);t.logarithmicDepthBuffer&&a.enable(2);t.skinning&&a.enable(3);t.useVertexTexture&&a.enable(4);t.morphTargets&&a.enable(5);t.morphNormals&&a.enable(6);t.morphColors&&a.enable(7);t.premultipliedAlpha&&a.enable(8);t.shadowMapEnabled&&a.enable(9);t.physicallyCorrectLights&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.depthPacking&&a.enable(13);t.dithering&&a.enable(14);t.specularIntensityMap&&a.enable(15);t.specularColorMap&&a.enable(16);t.transmission&&a.enable(17);t.transmissionMap&&a.enable(18);t.thicknessMap&&a.enable(19);t.sheen&&a.enable(20);t.sheenColorMap&&a.enable(21);t.sheenRoughnessMap&&a.enable(22);t.decodeVideoTexture&&a.enable(23);t.opaque&&a.enable(24);e.push(a.mask)}(n,t),n.push(e.outputEncoding)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=y[e.type];let n;if(t){const e=Us[t];n=Ms.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let i;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(t.cacheKey===n){i=t,++i.usedTimes;break}}return void 0===i&&(i=new Ro(e,n,t,r),c.push(i)),i},releaseProgram:function(e){if(0==--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Bo(){let e=new WeakMap;return{get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,i){e.get(t)[n]=i},dispose:function(){e=new WeakMap}}}function Fo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Vo(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Ho(){const e=[];let t=0;const n=[],i=[],s=[];function r(n,i,s,r,o,a){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:i,material:s,groupOrder:r,renderOrder:n.renderOrder,z:o,group:a},e[t]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=s,l.groupOrder=r,l.renderOrder=n.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:n,transmissive:i,transparent:s,init:function(){t=0,n.length=0,i.length=0,s.length=0},push:function(e,t,o,a,l,c){const d=r(e,t,o,a,l,c);o.transmission>0?i.push(d):!0===o.transparent?s.push(d):n.push(d)},unshift:function(e,t,o,a,l,c){const d=r(e,t,o,a,l,c);o.transmission>0?i.unshift(d):!0===o.transparent?s.unshift(d):n.unshift(d)},finish:function(){for(let n=t,i=e.length;n<i;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||Fo),i.length>1&&i.sort(t||Vo),s.length>1&&s.sort(t||Vo)}}}function jo(){let e=new WeakMap;return{get:function(t,n){let i;return!1===e.has(t)?(i=new Ho,e.set(t,[i])):n>=e.get(t).length?(i=new Ho,e.get(t).push(i)):i=e.get(t)[n],i},dispose:function(){e=new WeakMap}}}function Go(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Vector3,color:new Color};break;case"SpotLight":n={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":n={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return e[t.id]=n,n}}}let zo=0;function Wo(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ko(e,t){const n=new Go,i=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)s.probe.push(new Vector3);const r=new Vector3,o=new Matrix4,a=new Matrix4;return{setup:function(r,o){let a=0,l=0,c=0;for(let e=0;e<9;e++)s.probe[e].set(0,0,0);let d=0,u=0,h=0,p=0,m=0,f=0,g=0,v=0;r.sort(Wo);const y=!0!==o?Math.PI:1;for(let e=0,t=r.length;e<t;e++){const t=r[e],o=t.color,b=t.intensity,S=t.distance,E=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=o.r*b*y,l+=o.g*b*y,c+=o.b*b*y;else if(t.isLightProbe)for(let e=0;e<9;e++)s.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*y),t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,s.directionalShadow[d]=n,s.directionalShadowMap[d]=E,s.directionalShadowMatrix[d]=t.shadow.matrix,f++}s.directional[d]=e,d++}else if(t.isSpotLight){const e=n.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(b*y),e.distance=S,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,s.spotShadow[h]=n,s.spotShadowMap[h]=E,s.spotShadowMatrix[h]=t.shadow.matrix,v++}s.spot[h]=e,h++}else if(t.isRectAreaLight){const e=n.get(t);e.color.copy(o).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),s.rectArea[p]=e,p++}else if(t.isPointLight){const e=n.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*y),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,n=i.get(t);n.shadowBias=e.bias,n.shadowNormalBias=e.normalBias,n.shadowRadius=e.radius,n.shadowMapSize=e.mapSize,n.shadowCameraNear=e.camera.near,n.shadowCameraFar=e.camera.far,s.pointShadow[u]=n,s.pointShadowMap[u]=E,s.pointShadowMatrix[u]=t.shadow.matrix,g++}s.point[u]=e,u++}else if(t.isHemisphereLight){const e=n.get(t);e.skyColor.copy(t.color).multiplyScalar(b*y),e.groundColor.copy(t.groundColor).multiplyScalar(b*y),s.hemi[m]=e,m++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(s.rectAreaLTC1=ks.LTC_FLOAT_1,s.rectAreaLTC2=ks.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(s.rectAreaLTC1=ks.LTC_HALF_1,s.rectAreaLTC2=ks.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=a,s.ambient[1]=l,s.ambient[2]=c;const b=s.hash;b.directionalLength===d&&b.pointLength===u&&b.spotLength===h&&b.rectAreaLength===p&&b.hemiLength===m&&b.numDirectionalShadows===f&&b.numPointShadows===g&&b.numSpotShadows===v||(s.directional.length=d,s.spot.length=h,s.rectArea.length=p,s.point.length=u,s.hemi.length=m,s.directionalShadow.length=f,s.directionalShadowMap.length=f,s.pointShadow.length=g,s.pointShadowMap.length=g,s.spotShadow.length=v,s.spotShadowMap.length=v,s.directionalShadowMatrix.length=f,s.pointShadowMatrix.length=g,s.spotShadowMatrix.length=v,b.directionalLength=d,b.pointLength=u,b.spotLength=h,b.rectAreaLength=p,b.hemiLength=m,b.numDirectionalShadows=f,b.numPointShadows=g,b.numSpotShadows=v,s.version=zo++)},setupView:function(e,t){let n=0,i=0,l=0,c=0,d=0;const u=t.matrixWorldInverse;for(let t=0,h=e.length;t<h;t++){const h=e[t];if(h.isDirectionalLight){const e=s.directional[n];e.direction.setFromMatrixPosition(h.matrixWorld),r.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(u),n++}else if(h.isSpotLight){const e=s.spot[l];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(u),e.direction.setFromMatrixPosition(h.matrixWorld),r.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(r),e.direction.transformDirection(u),l++}else if(h.isRectAreaLight){const e=s.rectArea[c];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(u),a.identity(),o.copy(h.matrixWorld),o.premultiply(u),a.extractRotation(o),e.halfWidth.set(.5*h.width,0,0),e.halfHeight.set(0,.5*h.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(h.isPointLight){const e=s.point[i];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(u),i++}else if(h.isHemisphereLight){const e=s.hemi[d];e.direction.setFromMatrixPosition(h.matrixWorld),e.direction.transformDirection(u),e.direction.normalize(),d++}}},state:s}}function Yo(e,t){const n=new Ko(e,t),i=[],s=[];return{init:function(){i.length=0,s.length=0},state:{lightsArray:i,shadowsArray:s,lights:n},setupLights:function(e){n.setup(i,e)},setupLightsView:function(e){n.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){s.push(e)}}}function qo(e,t){let n=new WeakMap;return{get:function(i,s=0){let r;return!1===n.has(i)?(r=new Yo(e,t),n.set(i,[r])):s>=n.get(i).length?(r=new Yo(e,t),n.get(i).push(r)):r=n.get(i)[s],r},dispose:function(){n=new WeakMap}}}class MeshDepthMaterial extends Material{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=Pt,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}MeshDepthMaterial.prototype.isMeshDepthMaterial=!0;class MeshDistanceMaterial extends Material{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0;function Zo(e,t,n){let i=new Frustum;const s=new Vector2,r=new Vector2,o=new Vector4,a=new MeshDepthMaterial({depthPacking:Rt}),l=new MeshDistanceMaterial,c={},d=n.maxTextureSize,h={0:f,1:m,2:g},v=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),y=v.clone();y.defines.HORIZONTAL_PASS=1;const S=new BufferGeometry;S.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new Mesh(S,v),T=this;function w(n,i){const s=t.update(E);v.defines.VSM_SAMPLES!==n.blurSamples&&(v.defines.VSM_SAMPLES=n.blurSamples,y.defines.VSM_SAMPLES=n.blurSamples,v.needsUpdate=!0,y.needsUpdate=!0),v.uniforms.shadow_pass.value=n.map.texture,v.uniforms.resolution.value=n.mapSize,v.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(i,null,s,v,E,null),y.uniforms.shadow_pass.value=n.mapPass.texture,y.uniforms.resolution.value=n.mapSize,y.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(i,null,s,y,E,null)}function x(t,n,i,s,r,o){let d=null;const u=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(d=void 0!==u?u:!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){const e=d.uuid,t=n.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let s=i[t];void 0===s&&(s=d.clone(),i[t]=s),d=s}return d.visible=n.visible,d.wireframe=n.wireframe,d.side=o===p?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],d.alphaMap=n.alphaMap,d.alphaTest=n.alphaTest,d.clipShadows=n.clipShadows,d.clippingPlanes=n.clippingPlanes,d.clipIntersection=n.clipIntersection,d.displacementMap=n.displacementMap,d.displacementScale=n.displacementScale,d.displacementBias=n.displacementBias,d.wireframeLinewidth=n.wireframeLinewidth,d.linewidth=n.linewidth,!0===i.isPointLight&&!0===d.isMeshDistanceMaterial&&(d.referencePosition.setFromMatrixPosition(i.matrixWorld),d.nearDistance=s,d.farDistance=r),d}function _(n,s,r,o,a){if(!1===n.visible)return;if(n.layers.test(s.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&a===p)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,n.matrixWorld);const i=t.update(n),s=n.material;if(Array.isArray(s)){const t=i.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],d=s[c.materialIndex];if(d&&d.visible){const t=x(n,d,o,r.near,r.far,a);e.renderBufferDirect(r,null,i,t,n,c)}}}else if(s.visible){const t=x(n,s,o,r.near,r.far,a);e.renderBufferDirect(r,null,i,t,n,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)_(l[e],s,r,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=u,this.render=function(t,n,a){if(!1===T.enabled)return;if(!1===T.autoUpdate&&!1===T.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),h=e.state;h.setBlending(b),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(let l=0,c=t.length;l<c;l++){const c=t[l],u=c.shadow;if(void 0===u){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===u.autoUpdate&&!1===u.needsUpdate)continue;s.copy(u.mapSize);const m=u.getFrameExtents();if(s.multiply(m),r.copy(u.mapSize),(s.x>d||s.y>d)&&(s.x>d&&(r.x=Math.floor(d/m.x),s.x=r.x*m.x,u.mapSize.x=r.x),s.y>d&&(r.y=Math.floor(d/m.y),s.y=r.y*m.y,u.mapSize.y=r.y)),null!==u.map||u.isPointLightShadow||this.type!==p||(u.map=new WebGLRenderTarget(s.x,s.y),u.map.texture.name=c.name+".shadowMap",u.mapPass=new WebGLRenderTarget(s.x,s.y),u.camera.updateProjectionMatrix()),null===u.map){const e={minFilter:pe,magFilter:pe,format:ke};u.map=new WebGLRenderTarget(s.x,s.y,e),u.map.texture.name=c.name+".shadowMap",u.camera.updateProjectionMatrix()}e.setRenderTarget(u.map),e.clear();const f=u.getViewportCount();for(let e=0;e<f;e++){const t=u.getViewport(e);o.set(r.x*t.x,r.y*t.y,r.x*t.z,r.y*t.w),h.viewport(o),u.updateMatrices(c,e),i=u.getFrustum(),_(n,a,u.camera,c,this.type)}u.isPointLightShadow||this.type!==p||w(u,a),u.needsUpdate=!1}T.needsUpdate=!1,e.setRenderTarget(l,c,u)}}function $o(e,t,n){const i=n.isWebGL2;const s=new function(){let t=!1;const n=new Vector4;let i=null;const s=new Vector4(0,0,0,0);return{setMask:function(n){i===n||t||(e.colorMask(n,n,n,n),i=n)},setLocked:function(e){t=e},setClear:function(t,i,r,o,a){!0===a&&(t*=o,i*=o,r*=o),n.set(t,i,r,o),!1===s.equals(n)&&(e.clearColor(t,i,r,o),s.copy(n))},reset:function(){t=!1,i=null,s.set(-1,0,0,0)}}},r=new function(){let t=!1,n=null,i=null,s=null;return{setTest:function(e){e?be(2929):Se(2929)},setMask:function(i){n===i||t||(e.depthMask(i),n=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case H:e.depthFunc(512);break;case j:e.depthFunc(519);break;case G:e.depthFunc(513);break;case z:e.depthFunc(515);break;case W:e.depthFunc(514);break;case K:e.depthFunc(518);break;case Y:e.depthFunc(516);break;case q:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);i=t}},setLocked:function(e){t=e},setClear:function(t){s!==t&&(e.clearDepth(t),s=t)},reset:function(){t=!1,n=null,i=null,s=null}}},c=new function(){let t=!1,n=null,i=null,s=null,r=null,o=null,a=null,l=null,c=null;return{setTest:function(e){t||(e?be(2960):Se(2960))},setMask:function(i){n===i||t||(e.stencilMask(i),n=i)},setFunc:function(t,n,o){i===t&&s===n&&r===o||(e.stencilFunc(t,n,o),i=t,s=n,r=o)},setOp:function(t,n,i){o===t&&a===n&&l===i||(e.stencilOp(t,n,i),o=t,a=n,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,i=null,s=null,r=null,o=null,a=null,l=null,c=null}}};let d={},u={},h=new WeakMap,p=[],m=null,v=!1,y=null,Z=null,$=null,Q=null,X=null,J=null,ee=null,te=!1,ne=null,ie=null,se=null,re=null,oe=null;const ae=e.getParameter(35661);let le=!1,ce=0;const de=e.getParameter(7938);-1!==de.indexOf("WebGL")?(ce=parseFloat(/^WebGL (\d)/.exec(de)[1]),le=ce>=1):-1!==de.indexOf("OpenGL ES")&&(ce=parseFloat(/^OpenGL ES (\d)/.exec(de)[1]),le=ce>=2);let ue=null,he={};const pe=e.getParameter(3088),me=e.getParameter(2978),fe=(new Vector4).fromArray(pe),ge=(new Vector4).fromArray(me);function ve(t,n,i){const s=new Uint8Array(4),r=e.createTexture();e.bindTexture(t,r),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<i;t++)e.texImage2D(n+t,0,6408,1,1,0,6408,5121,s);return r}const ye={};function be(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function Se(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}ye[3553]=ve(3553,3553,1),ye[34067]=ve(34067,34069,6),s.setClear(0,0,0,1),r.setClear(1),c.setClear(0),be(2929),r.setFunc(z),xe(!1),_e(a),be(2884),we(b);const Ee={[_]:32774,[M]:32778,[O]:32779};if(i)Ee[A]=32775,Ee[C]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(Ee[A]=e.MIN_EXT,Ee[C]=e.MAX_EXT)}const Te={[N]:0,[D]:1,[I]:768,[P]:770,[V]:776,[B]:774,[k]:772,[L]:769,[R]:771,[F]:775,[U]:773};function we(t,n,i,s,r,o,a,l){if(t!==b){if(!1===v&&(be(3042),v=!0),t===x)r=r||n,o=o||i,a=a||s,n===Z&&r===X||(e.blendEquationSeparate(Ee[n],Ee[r]),Z=n,X=r),i===$&&s===Q&&o===J&&a===ee||(e.blendFuncSeparate(Te[i],Te[s],Te[o],Te[a]),$=i,Q=s,J=o,ee=a),y=t,te=null;else if(t!==y||l!==te){if(Z===_&&X===_||(e.blendEquation(32774),Z=_,X=_),l)switch(t){case S:e.blendFuncSeparate(1,771,1,771);break;case E:e.blendFunc(1,1);break;case T:e.blendFuncSeparate(0,769,0,1);break;case w:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case S:e.blendFuncSeparate(770,771,1,771);break;case E:e.blendFunc(770,1);break;case T:e.blendFuncSeparate(0,769,0,1);break;case w:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}$=null,Q=null,J=null,ee=null,y=t,te=l}}else!0===v&&(Se(3042),v=!1)}function xe(t){ne!==t&&(t?e.frontFace(2304):e.frontFace(2305),ne=t)}function _e(t){t!==o?(be(2884),t!==ie&&(t===a?e.cullFace(1029):t===l?e.cullFace(1028):e.cullFace(1032))):Se(2884),ie=t}function Me(t,n,i){t?(be(32823),re===n&&oe===i||(e.polygonOffset(n,i),re=n,oe=i)):Se(32823)}function Oe(t){void 0===t&&(t=33984+ae-1),ue!==t&&(e.activeTexture(t),ue=t)}return{buffers:{color:s,depth:r,stencil:c},enable:be,disable:Se,bindFramebuffer:function(t,n){return u[t]!==n&&(e.bindFramebuffer(t,n),u[t]=n,i&&(36009===t&&(u[36160]=n),36160===t&&(u[36009]=n)),!0)},drawBuffers:function(i,s){let r=p,o=!1;if(i)if(r=h.get(s),void 0===r&&(r=[],h.set(s,r)),i.isWebGLMultipleRenderTargets){const e=i.texture;if(r.length!==e.length||36064!==r[0]){for(let t=0,n=e.length;t<n;t++)r[t]=36064+t;r.length=e.length,o=!0}}else 36064!==r[0]&&(r[0]=36064,o=!0);else 1029!==r[0]&&(r[0]=1029,o=!0);o&&(n.isWebGL2?e.drawBuffers(r):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(r))},useProgram:function(t){return m!==t&&(e.useProgram(t),m=t,!0)},setBlending:we,setMaterial:function(e,t){e.side===g?Se(2884):be(2884);let n=e.side===f;t&&(n=!n),xe(n),e.blending===S&&!1===e.transparent?we(b):we(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),r.setFunc(e.depthFunc),r.setTest(e.depthTest),r.setMask(e.depthWrite),s.setMask(e.colorWrite);const i=e.stencilWrite;c.setTest(i),i&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Me(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?be(32926):Se(32926)},setFlipSided:xe,setCullFace:_e,setLineWidth:function(t){t!==se&&(le&&e.lineWidth(t),se=t)},setPolygonOffset:Me,setScissorTest:function(e){e?be(3089):Se(3089)},activeTexture:Oe,bindTexture:function(t,n){null===ue&&Oe();let i=he[ue];void 0===i&&(i={type:void 0,texture:void 0},he[ue]=i),i.type===t&&i.texture===n||(e.bindTexture(t,n||ye[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=he[ue];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===fe.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),fe.copy(t))},viewport:function(t){!1===ge.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ge.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},ue=null,he={},u={},h=new WeakMap,p=[],m=null,v=!1,y=null,Z=null,$=null,Q=null,X=null,J=null,ee=null,te=!1,ne=null,ie=null,se=null,re=null,oe=null,fe.set(0,0,e.canvas.width,e.canvas.height),ge.set(0,0,e.canvas.width,e.canvas.height),s.reset(),r.reset(),c.reset()}}}function Qo(e,t,n,i,s,r,o){const a=s.isWebGL2,l=s.maxTextures,c=s.maxCubemapSize,d=s.maxTextureSize,u=s.maxSamples,h=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap;let f;const g=new WeakMap;let v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function y(e,t){return v?new OffscreenCanvas(e,t):Dn("canvas")}function b(e,t,n,i){let s=1;if((e.width>i||e.height>i)&&(s=i/Math.max(e.width,e.height)),s<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const i=t?Mn:Math.floor,r=i(s*e.width),o=i(s*e.height);void 0===f&&(f=y(r,o));const a=n?y(r,o):f;a.width=r,a.height=o;return a.getContext("2d").drawImage(e,0,0,r,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+r+"x"+o+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function S(e){return xn(e.width)&&xn(e.height)}function E(e,t){return e.generateMipmaps&&t&&e.minFilter!==pe&&e.minFilter!==ye}function T(t){e.generateMipmap(t)}function w(n,i,s,r,o=!1){if(!1===a)return i;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let l=i;return 6403===i&&(5126===s&&(l=33326),5131===s&&(l=33325),5121===s&&(l=33321)),33319===i&&(5126===s&&(l=33328),5131===s&&(l=33327),5121===s&&(l=33323)),6408===i&&(5126===s&&(l=34836),5131===s&&(l=34842),5121===s&&(l=r===Lt&&!1===o?35907:32856),32819===s&&(l=32854),32820===s&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||t.get("EXT_color_buffer_float"),l}function x(e,t,n){return!0===E(e,n)||e.isFramebufferTexture&&e.minFilter!==pe&&e.minFilter!==ye?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function _(e){return e===pe||e===me||e===ge?9728:9729}function M(e){const t=e.target;t.removeEventListener("dispose",M),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const n=e.source,s=g.get(n);if(s){const i=s[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&A(e),0===Object.keys(s).length&&g.delete(n)}i.remove(e)}(t),t.isVideoTexture&&m.delete(t)}function O(t){const n=t.target;n.removeEventListener("dispose",O),function(t){const n=t.texture,s=i.get(t),r=i.get(n);void 0!==r.__webglTexture&&(e.deleteTexture(r.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(s.__webglFramebuffer[t]),s.__webglDepthbuffer&&e.deleteRenderbuffer(s.__webglDepthbuffer[t]);else e.deleteFramebuffer(s.__webglFramebuffer),s.__webglDepthbuffer&&e.deleteRenderbuffer(s.__webglDepthbuffer),s.__webglMultisampledFramebuffer&&e.deleteFramebuffer(s.__webglMultisampledFramebuffer),s.__webglColorRenderbuffer&&e.deleteRenderbuffer(s.__webglColorRenderbuffer),s.__webglDepthRenderbuffer&&e.deleteRenderbuffer(s.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(let t=0,s=n.length;t<s;t++){const s=i.get(n[t]);s.__webglTexture&&(e.deleteTexture(s.__webglTexture),o.memory.textures--),i.remove(n[t])}i.remove(n),i.remove(t)}(n)}function A(t){const n=i.get(t);e.deleteTexture(n.__webglTexture);const s=t.source;delete g.get(s)[n.__cacheKey],o.memory.textures--}let C=0;function N(e,t){const s=i.get(e);if(e.isVideoTexture&&function(e){const t=o.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version){const n=e.image;if(null===n)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==n.complete)return void R(s,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,s.__webglTexture)}const D={[de]:10497,[ue]:33071,[he]:33648},I={[pe]:9728,[me]:9984,[ge]:9986,[ye]:9729,[be]:9985,[Ee]:9987};function L(n,r,o){if(o?(e.texParameteri(n,10242,D[r.wrapS]),e.texParameteri(n,10243,D[r.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,D[r.wrapR]),e.texParameteri(n,10240,I[r.magFilter]),e.texParameteri(n,10241,I[r.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),r.wrapS===ue&&r.wrapT===ue||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,_(r.magFilter)),e.texParameteri(n,10241,_(r.minFilter)),r.minFilter!==pe&&r.minFilter!==ye&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const o=t.get("EXT_texture_filter_anisotropic");if(r.type===Ce&&!1===t.has("OES_texture_float_linear"))return;if(!1===a&&r.type===Ne&&!1===t.has("OES_texture_half_float_linear"))return;(r.anisotropy>1||i.get(r).__currentAnisotropy)&&(e.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(r.anisotropy,s.getMaxAnisotropy())),i.get(r).__currentAnisotropy=r.anisotropy)}}function P(t,n){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",M));const s=n.source;let r=g.get(s);void 0===r&&(r={},g.set(s,r));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(n);if(a!==t.__cacheKey){void 0===r[a]&&(r[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,i=!0),r[a].usedTimes++;const s=r[t.__cacheKey];void 0!==s&&(r[t.__cacheKey].usedTimes--,0===s.usedTimes&&A(n)),t.__cacheKey=a,t.__webglTexture=r[a].texture}return i}function R(t,i,s){let o=3553;i.isDataArrayTexture&&(o=35866),i.isData3DTexture&&(o=32879);const l=P(t,i),c=i.source;if(n.activeTexture(33984+s),n.bindTexture(o,t.__webglTexture),c.version!==c.__currentVersion||!0===l){e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const s=function(e){return!a&&(e.wrapS!==ue||e.wrapT!==ue||e.minFilter!==pe&&e.minFilter!==ye)}(i)&&!1===S(i.image);let l=b(i.image,s,!1,d);l=H(i,l);const u=S(l)||a,h=r.convert(i.format,i.encoding);let p,m=r.convert(i.type),f=w(i.internalFormat,h,m,i.encoding,i.isVideoTexture);L(o,i,u);const g=i.mipmaps,v=a&&!0!==i.isVideoTexture,y=void 0===t.__version,_=x(i,l,u);if(i.isDepthTexture)f=6402,a?f=i.type===Ce?36012:i.type===Ae?33190:i.type===Le?35056:33189:i.type===Ce&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Fe&&6402===f&&i.type!==Me&&i.type!==Ae&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Me,m=r.convert(i.type)),i.format===Ve&&6402===f&&(f=34041,i.type!==Le&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Le,m=r.convert(i.type))),v&&y?n.texStorage2D(3553,1,f,l.width,l.height):n.texImage2D(3553,0,f,l.width,l.height,0,h,m,null);else if(i.isDataTexture)if(g.length>0&&u){v&&y&&n.texStorage2D(3553,_,f,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],v?n.texSubImage2D(3553,e,0,0,p.width,p.height,h,m,p.data):n.texImage2D(3553,e,f,p.width,p.height,0,h,m,p.data);i.generateMipmaps=!1}else v?(y&&n.texStorage2D(3553,_,f,l.width,l.height),n.texSubImage2D(3553,0,0,0,l.width,l.height,h,m,l.data)):n.texImage2D(3553,0,f,l.width,l.height,0,h,m,l.data);else if(i.isCompressedTexture){v&&y&&n.texStorage2D(3553,_,f,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],i.format!==ke?null!==h?v?n.compressedTexSubImage2D(3553,e,0,0,p.width,p.height,h,p.data):n.compressedTexImage2D(3553,e,f,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):v?n.texSubImage2D(3553,e,0,0,p.width,p.height,h,m,p.data):n.texImage2D(3553,e,f,p.width,p.height,0,h,m,p.data)}else if(i.isDataArrayTexture)v?(y&&n.texStorage3D(35866,_,f,l.width,l.height,l.depth),n.texSubImage3D(35866,0,0,0,0,l.width,l.height,l.depth,h,m,l.data)):n.texImage3D(35866,0,f,l.width,l.height,l.depth,0,h,m,l.data);else if(i.isData3DTexture)v?(y&&n.texStorage3D(32879,_,f,l.width,l.height,l.depth),n.texSubImage3D(32879,0,0,0,0,l.width,l.height,l.depth,h,m,l.data)):n.texImage3D(32879,0,f,l.width,l.height,l.depth,0,h,m,l.data);else if(i.isFramebufferTexture)v&&y?n.texStorage2D(3553,_,f,l.width,l.height):n.texImage2D(3553,0,f,l.width,l.height,0,h,m,null);else if(g.length>0&&u){v&&y&&n.texStorage2D(3553,_,f,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)p=g[e],v?n.texSubImage2D(3553,e,0,0,h,m,p):n.texImage2D(3553,e,f,h,m,p);i.generateMipmaps=!1}else v?(y&&n.texStorage2D(3553,_,f,l.width,l.height),n.texSubImage2D(3553,0,0,0,h,m,l)):n.texImage2D(3553,0,f,h,m,l);E(i,u)&&T(o),c.__currentVersion=c.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function k(t,s,o,a,l){const c=r.convert(o.format,o.encoding),d=r.convert(o.type),u=w(o.internalFormat,c,d,o.encoding);i.get(s).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,u,s.width,s.height,s.depth,0,c,d,null):n.texImage2D(l,0,u,s.width,s.height,0,c,d,null)),n.bindFramebuffer(36160,t),V(s)?h.framebufferTexture2DMultisampleEXT(36160,a,l,i.get(o).__webglTexture,0,F(s)):e.framebufferTexture2D(36160,a,l,i.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function U(t,n,i){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){let s=33189;if(i||V(n)){const t=n.depthTexture;t&&t.isDepthTexture&&(t.type===Ce?s=36012:t.type===Ae&&(s=33190));const i=F(n);V(n)?h.renderbufferStorageMultisampleEXT(36161,i,s,n.width,n.height):e.renderbufferStorageMultisample(36161,i,s,n.width,n.height)}else e.renderbufferStorage(36161,s,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){const s=F(n);i&&!1===V(n)?e.renderbufferStorageMultisample(36161,s,35056,n.width,n.height):V(n)?h.renderbufferStorageMultisampleEXT(36161,s,35056,n.width,n.height):e.renderbufferStorage(36161,34041,n.width,n.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,s=r.convert(t.format,t.encoding),o=r.convert(t.type),a=w(t.internalFormat,s,o,t.encoding),l=F(n);i&&!1===V(n)?e.renderbufferStorageMultisample(36161,l,a,n.width,n.height):V(n)?h.renderbufferStorageMultisampleEXT(36161,l,a,n.width,n.height):e.renderbufferStorage(36161,a,n.width,n.height)}e.bindRenderbuffer(36161,null)}function B(t){const s=i.get(t),r=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!s.__autoAllocateDepthBuffer){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,s){if(s&&s.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!s.depthTexture||!s.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(s.depthTexture).__webglTexture&&s.depthTexture.image.width===s.width&&s.depthTexture.image.height===s.height||(s.depthTexture.image.width=s.width,s.depthTexture.image.height=s.height,s.depthTexture.needsUpdate=!0),N(s.depthTexture,0);const r=i.get(s.depthTexture).__webglTexture,o=F(s);if(s.depthTexture.format===Fe)V(s)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,r,0,o):e.framebufferTexture2D(36160,36096,3553,r,0);else{if(s.depthTexture.format!==Ve)throw new Error("Unknown depthTexture format");V(s)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,r,0,o):e.framebufferTexture2D(36160,33306,3553,r,0)}}(s.__webglFramebuffer,t)}else if(r){s.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,s.__webglFramebuffer[i]),s.__webglDepthbuffer[i]=e.createRenderbuffer(),U(s.__webglDepthbuffer[i],t,!1)}else n.bindFramebuffer(36160,s.__webglFramebuffer),s.__webglDepthbuffer=e.createRenderbuffer(),U(s.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function F(e){return Math.min(u,e.samples)}function V(e){const n=i.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function H(e,n){const i=e.encoding,s=e.format,r=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===fn||i!==It&&(i===Lt?!1===a?!0===t.has("EXT_sRGB")&&s===ke?(e.format=fn,e.minFilter=ye,e.generateMipmaps=!1):n=ImageUtils.sRGBToLinear(n):s===ke&&r===we||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),n}this.allocateTextureUnit=function(){const e=C;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=N,this.setTexture2DArray=function(e,t){const s=i.get(e);e.version>0&&s.__version!==e.version?R(s,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,s.__webglTexture))},this.setTexture3D=function(e,t){const s=i.get(e);e.version>0&&s.__version!==e.version?R(s,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,s.__webglTexture))},this.setTextureCube=function(t,s){const o=i.get(t);t.version>0&&o.__version!==t.version?function(t,i,s){if(6!==i.image.length)return;const o=P(t,i),l=i.source;if(n.activeTexture(33984+s),n.bindTexture(34067,t.__webglTexture),l.version!==l.__currentVersion||!0===o){e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const s=i.isCompressedTexture||i.image[0].isCompressedTexture,o=i.image[0]&&i.image[0].isDataTexture,d=[];for(let e=0;e<6;e++)d[e]=s||o?o?i.image[e].image:i.image[e]:b(i.image[e],!1,!0,c),d[e]=H(i,d[e]);const u=d[0],h=S(u)||a,p=r.convert(i.format,i.encoding),m=r.convert(i.type),f=w(i.internalFormat,p,m,i.encoding),g=a&&!0!==i.isVideoTexture,v=void 0===t.__version;let y,_=x(i,u,h);if(L(34067,i,h),s){g&&v&&n.texStorage2D(34067,_,f,u.width,u.height);for(let e=0;e<6;e++){y=d[e].mipmaps;for(let t=0;t<y.length;t++){const s=y[t];i.format!==ke?null!==p?g?n.compressedTexSubImage2D(34069+e,t,0,0,s.width,s.height,p,s.data):n.compressedTexImage2D(34069+e,t,f,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?n.texSubImage2D(34069+e,t,0,0,s.width,s.height,p,m,s.data):n.texImage2D(34069+e,t,f,s.width,s.height,0,p,m,s.data)}}}else{y=i.mipmaps,g&&v&&(y.length>0&&_++,n.texStorage2D(34067,_,f,d[0].width,d[0].height));for(let e=0;e<6;e++)if(o){g?n.texSubImage2D(34069+e,0,0,0,d[e].width,d[e].height,p,m,d[e].data):n.texImage2D(34069+e,0,f,d[e].width,d[e].height,0,p,m,d[e].data);for(let t=0;t<y.length;t++){const i=y[t].image[e].image;g?n.texSubImage2D(34069+e,t+1,0,0,i.width,i.height,p,m,i.data):n.texImage2D(34069+e,t+1,f,i.width,i.height,0,p,m,i.data)}}else{g?n.texSubImage2D(34069+e,0,0,0,p,m,d[e]):n.texImage2D(34069+e,0,f,p,m,d[e]);for(let t=0;t<y.length;t++){const i=y[t];g?n.texSubImage2D(34069+e,t+1,0,0,p,m,i.image[e]):n.texImage2D(34069+e,t+1,f,p,m,i.image[e])}}}E(i,h)&&T(34067),l.__currentVersion=l.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(o,t,s):(n.activeTexture(33984+s),n.bindTexture(34067,o.__webglTexture))},this.rebindTextures=function(e,t,n){const s=i.get(e);void 0!==t&&k(s.__webglFramebuffer,e,e.texture,36064,3553),void 0!==n&&B(e)},this.setupRenderTarget=function(t){const l=t.texture,c=i.get(t),d=i.get(l);t.addEventListener("dispose",O),!0!==t.isWebGLMultipleRenderTargets&&(void 0===d.__webglTexture&&(d.__webglTexture=e.createTexture()),d.__version=l.version,o.memory.textures++);const u=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultipleRenderTargets,p=S(t)||a;if(u){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else if(c.__webglFramebuffer=e.createFramebuffer(),h)if(s.drawBuffers){const n=t.texture;for(let t=0,s=n.length;t<s;t++){const s=i.get(n[t]);void 0===s.__webglTexture&&(s.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&t.samples>0&&!1===V(t)){c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const i=r.convert(l.format,l.encoding),s=r.convert(l.type),o=w(l.internalFormat,i,s,l.encoding),a=F(t);e.renderbufferStorageMultisample(36161,a,o,t.width,t.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),U(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}if(u){n.bindTexture(34067,d.__webglTexture),L(34067,l,p);for(let e=0;e<6;e++)k(c.__webglFramebuffer[e],t,l,36064,34069+e);E(l,p)&&T(34067),n.unbindTexture()}else if(h){const e=t.texture;for(let s=0,r=e.length;s<r;s++){const r=e[s],o=i.get(r);n.bindTexture(3553,o.__webglTexture),L(3553,r,p),k(c.__webglFramebuffer,t,r,36064+s,3553),E(r,p)&&T(3553)}n.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(a?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(e,d.__webglTexture),L(e,l,p),k(c.__webglFramebuffer,t,l,36064,e),E(l,p)&&T(e),n.unbindTexture()}t.depthBuffer&&B(t)},this.updateRenderTargetMipmap=function(e){const t=S(e)||a,s=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let r=0,o=s.length;r<o;r++){const o=s[r];if(E(o,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,s=i.get(o).__webglTexture;n.bindTexture(t,s),T(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===V(t)){const s=t.width,r=t.height;let o=16384;const a=[36064],l=t.stencilBuffer?33306:36096;t.depthBuffer&&a.push(l);const c=i.get(t),d=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;!1===d&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer),!0===d&&(e.invalidateFramebuffer(36008,[l]),e.invalidateFramebuffer(36009,[l])),e.blitFramebuffer(0,0,s,r,0,0,s,r,o,9728),p&&e.invalidateFramebuffer(36008,a),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=B,this.setupFrameBufferTexture=k,this.useMultisampledRTT=V}function Xo(e,t,n){const i=n.isWebGL2;return{convert:function(e,n=null){let s;if(e===we)return 5121;if(e===De)return 32819;if(e===Ie)return 32820;if(e===xe)return 5120;if(e===_e)return 5122;if(e===Me)return 5123;if(e===Oe)return 5124;if(e===Ae)return 5125;if(e===Ce)return 5126;if(e===Ne)return i?5131:(s=t.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(e===Pe)return 6406;if(e===ke)return 6408;if(e===Ue)return 6409;if(e===Be)return 6410;if(e===Fe)return 6402;if(e===Ve)return 34041;if(e===He)return 6403;if(e===Re)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(e===fn)return s=t.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(e===je)return 36244;if(e===Ge)return 33319;if(e===ze)return 33320;if(e===We)return 36249;if(e===Ke||e===Ye||e===qe||e===Ze)if(n===Lt){if(s=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(e===Ke)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===Ye)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===qe)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Ze)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=t.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(e===Ke)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===Ye)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===qe)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ze)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===$e||e===Qe||e===Xe||e===Je){if(s=t.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(e===$e)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Qe)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Xe)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===Je)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===et)return s=t.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(e===tt||e===nt){if(s=t.get("WEBGL_compressed_texture_etc"),null===s)return null;if(e===tt)return n===Lt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===nt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(e===it||e===st||e===rt||e===ot||e===at||e===lt||e===ct||e===dt||e===ut||e===ht||e===pt||e===mt||e===ft||e===gt){if(s=t.get("WEBGL_compressed_texture_astc"),null===s)return null;if(e===it)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===st)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===rt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===ot)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===at)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===lt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===ct)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===dt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===ut)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===ht)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===pt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===mt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===ft)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===gt)return n===Lt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===vt){if(s=t.get("EXT_texture_compression_bptc"),null===s)return null;if(e===vt)return n===Lt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}return e===Le?i?34042:(s=t.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class ArrayCamera extends PerspectiveCamera{constructor(e=[]){super(),this.cameras=e}}ArrayCamera.prototype.isArrayCamera=!0;class Group extends Object3D{constructor(){super(),this.type="Group"}}Group.prototype.isGroup=!0;const Jo={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,r=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&(i=t.getPose(e.targetRaySpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Jo))),l&&e.hand){r=!0;for(const i of e.hand.values()){const e=t.getJointPose(i,n);if(void 0===l.joints[i.jointName]){const e=new Group;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[i.jointName]=e,l.add(e)}const s=l.joints[i.jointName];null!==e&&(s.matrix.fromArray(e.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.jointRadius=e.radius),s.visible=null!==e}const i=l.joints["index-finger-tip"],s=l.joints["thumb-tip"],o=i.position.distanceTo(s.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(a.matrix.fromArray(s.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),s.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(s.linearVelocity)):a.hasLinearVelocity=!1,s.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(s.angularVelocity)):a.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==s),null!==l&&(l.visible=null!==r),this}}class DepthTexture extends Texture{constructor(e,t,n,i,s,r,o,a,l,c){if((c=void 0!==c?c:Fe)!==Fe&&c!==Ve)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===Fe&&(n=Me),void 0===n&&c===Ve&&(n=Le),super(null,i,s,r,o,a,c,n,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:pe,this.minFilter=void 0!==a?a:pe,this.flipY=!1,this.generateMipmaps=!1}}DepthTexture.prototype.isDepthTexture=!0;class WebXRManager extends EventDispatcher{constructor(e,t){super();const n=this;let i=null,s=1,r=null,o="local-floor",a=null,l=null,c=null,d=null,u=null;const h=t.getContextAttributes();let p=null,m=null;const f=[],g=new Map,v=new PerspectiveCamera;v.layers.enable(1),v.viewport=new Vector4;const y=new PerspectiveCamera;y.layers.enable(2),y.viewport=new Vector4;const b=[v,y],S=new ArrayCamera;S.layers.enable(1),S.layers.enable(2);let E=null,T=null;function w(e){const t=g.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function x(){g.forEach((function(e,t){e.disconnect(t)})),g.clear(),E=null,T=null,e.setRenderTarget(p),d=null,c=null,l=null,i=null,m=null,N.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function _(e){const t=i.inputSources;for(let e=0;e<f.length;e++)g.set(t[e],f[e]);for(let t=0;t<e.removed.length;t++){const n=e.removed[t],i=g.get(n);i&&(i.dispatchEvent({type:"disconnected",data:n}),g.delete(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t],i=g.get(n);i&&i.dispatchEvent({type:"connected",data:n})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=f[e];return void 0===t&&(t=new WebXRController,f[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=f[e];return void 0===t&&(t=new WebXRController,f[e]=t),t.getGripSpace()},this.getHand=function(e){let t=f[e];return void 0===t&&(t=new WebXRController,f[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return r},this.getBaseLayer=function(){return null!==c?c:d},this.getBinding=function(){return l},this.getFrame=function(){return u},this.getSession=function(){return i},this.setSession=async function(a){if(i=a,null!==i){if(p=e.getRenderTarget(),i.addEventListener("select",w),i.addEventListener("selectstart",w),i.addEventListener("selectend",w),i.addEventListener("squeeze",w),i.addEventListener("squeezestart",w),i.addEventListener("squeezeend",w),i.addEventListener("end",x),i.addEventListener("inputsourceschange",_),!0!==h.xrCompatible&&await t.makeXRCompatible(),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2){const n={antialias:void 0!==i.renderState.layers||h.antialias,alpha:h.alpha,depth:h.depth,stencil:h.stencil,framebufferScaleFactor:s};d=new XRWebGLLayer(i,t,n),i.updateRenderState({baseLayer:d}),m=new WebGLRenderTarget(d.framebufferWidth,d.framebufferHeight,{format:ke,type:we,encoding:e.outputEncoding})}else{let n=null,r=null,o=null;h.depth&&(o=h.stencil?35056:33190,n=h.stencil?Ve:Fe,r=h.stencil?Le:Me);const a={colorFormat:e.outputEncoding===Lt?35907:32856,depthFormat:o,scaleFactor:s};l=new XRWebGLBinding(i,t),c=l.createProjectionLayer(a),i.updateRenderState({layers:[c]}),m=new WebGLRenderTarget(c.textureWidth,c.textureHeight,{format:ke,type:we,depthTexture:new DepthTexture(c.textureWidth,c.textureHeight,r,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:h.stencil,encoding:e.outputEncoding,samples:h.antialias?4:0});e.properties.get(m).__ignoreDepthValues=c.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),r=await i.requestReferenceSpace(o),N.setContext(i),N.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};const M=new Vector3,O=new Vector3;function A(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;S.near=y.near=v.near=e.near,S.far=y.far=v.far=e.far,E===S.near&&T===S.far||(i.updateRenderState({depthNear:S.near,depthFar:S.far}),E=S.near,T=S.far);const t=e.parent,n=S.cameras;A(S,t);for(let e=0;e<n.length;e++)A(n[e],t);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),e.position.copy(S.position),e.quaternion.copy(S.quaternion),e.scale.copy(S.scale),e.matrix.copy(S.matrix),e.matrixWorld.copy(S.matrixWorld);const s=e.children;for(let e=0,t=s.length;e<t;e++)s[e].updateMatrixWorld(!0);2===n.length?function(e,t,n){M.setFromMatrixPosition(t.matrixWorld),O.setFromMatrixPosition(n.matrixWorld);const i=M.distanceTo(O),s=t.projectionMatrix.elements,r=n.projectionMatrix.elements,o=s[14]/(s[10]-1),a=s[14]/(s[10]+1),l=(s[9]+1)/s[5],c=(s[9]-1)/s[5],d=(s[8]-1)/s[0],u=(r[8]+1)/r[0],h=o*d,p=o*u,m=i/(-d+u),f=m*-d;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(m),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=o+m,v=a+m,y=h-f,b=p+(i-f),S=l*a/v*g,E=c*a/v*g;e.projectionMatrix.makePerspective(y,b,S,E,g,v)}(S,v,y):S.projectionMatrix.copy(v.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){return null!==c?c.fixedFoveation:null!==d?d.fixedFoveation:void 0},this.setFoveation=function(e){null!==c&&(c.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)};let C=null;const N=new Ls;N.setAnimationLoop((function(t,n){if(a=n.getViewerPose(r),u=n,null!==a){const t=a.views;null!==d&&(e.setRenderTargetFramebuffer(m,d.framebuffer),e.setRenderTarget(m));let n=!1;t.length!==S.cameras.length&&(S.cameras.length=0,n=!0);for(let i=0;i<t.length;i++){const s=t[i];let r=null;if(null!==d)r=d.getViewport(s);else{const t=l.getViewSubImage(c,s);r=t.viewport,0===i&&(e.setRenderTargetTextures(m,t.colorTexture,c.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(m))}const o=b[i];o.matrix.fromArray(s.transform.matrix),o.projectionMatrix.fromArray(s.projectionMatrix),o.viewport.set(r.x,r.y,r.width,r.height),0===i&&S.matrix.copy(o.matrix),!0===n&&S.cameras.push(o)}}const s=i.inputSources;for(let e=0;e<f.length;e++){const t=f[e],i=s[e];t.update(i,n,r)}C&&C(t,n),u=null})),this.setAnimationLoop=function(e){C=e},this.dispose=function(){}}}function ea(e,t){function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,i.side===f&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),i.side===f&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);const s=t.get(i).envMap;if(s&&(n.envMap.value=s,n.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;const t=!0!==e.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*t}let r,o;i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?r=i.map:i.specularMap?r=i.specularMap:i.displacementMap?r=i.displacementMap:i.normalMap?r=i.normalMap:i.bumpMap?r=i.bumpMap:i.roughnessMap?r=i.roughnessMap:i.metalnessMap?r=i.metalnessMap:i.alphaMap?r=i.alphaMap:i.emissiveMap?r=i.emissiveMap:i.clearcoatMap?r=i.clearcoatMap:i.clearcoatNormalMap?r=i.clearcoatNormalMap:i.clearcoatRoughnessMap?r=i.clearcoatRoughnessMap:i.specularIntensityMap?r=i.specularIntensityMap:i.specularColorMap?r=i.specularColorMap:i.transmissionMap?r=i.transmissionMap:i.thicknessMap?r=i.thicknessMap:i.sheenColorMap?r=i.sheenColorMap:i.sheenRoughnessMap&&(r=i.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),n.uvTransform.value.copy(r.matrix)),i.aoMap?o=i.aoMap:i.lightMap&&(o=i.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),n.uv2Transform.value.copy(o.matrix))}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,i,s,r,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(e,i):i.isMeshToonMaterial?(n(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(n(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(n(e,i),function(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap);n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap);t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,n){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===f&&e.clearcoatNormalScale.value.negate()));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=n.texture,e.transmissionSamplerSize.value.set(n.width,n.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap);t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,i,o)):i.isMeshMatcapMaterial?(n(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?n(e,i):i.isMeshDistanceMaterial?(n(e,i),function(e,t){e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?n(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,n,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*i,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let s;t.map?s=t.map:t.alphaMap&&(s=t.alphaMap);void 0!==s&&(!0===s.matrixAutoUpdate&&s.updateMatrix(),e.uvTransform.value.copy(s.matrix))}(e,i,s,r):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function ta(e={}){const t=void 0!==e.canvas?e.canvas:function(){const e=Dn("canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,s=void 0===e.depth||e.depth,r=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",d=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let u;u=void 0!==e.context?n.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let h=null,p=null;const v=[],y=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=It,this.physicallyCorrectLights=!1,this.toneMapping=X,this.toneMappingExposure=1;const b=this;let S=!1,E=0,T=0,w=null,x=-1,_=null;const M=new Vector4,O=new Vector4;let A=null,C=t.width,N=t.height,D=1,I=null,L=null;const P=new Vector4(0,0,C,N),R=new Vector4(0,0,C,N);let k=!1;const U=new Frustum;let B=!1,F=!1,V=null;const H=new Matrix4,j=new Vector2,G=new Vector3,z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function W(){return null===w?D:1}let K,Y,q,Z,$,Q,J,ee,te,ne,ie,se,re,oe,ae,le,ce,de,ue,he,pe,me,fe,ge=n;function ve(e,n){for(let i=0;i<e.length;i++){const s=e[i],r=t.getContext(s,n);if(null!==r)return r}return null}try{const e={alpha:!0,depth:s,stencil:r,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${i}`),t.addEventListener("webglcontextlost",Se,!1),t.addEventListener("webglcontextrestored",Te,!1),null===ge){const t=["webgl2","webgl","experimental-webgl"];if(!0===b.isWebGL1Renderer&&t.shift(),ge=ve(t,e),null===ge)throw ve(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ge.getShaderPrecisionFormat&&(ge.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function ye(){K=new sr(ge),Y=new Hs(ge,K,e),K.init(Y),me=new Xo(ge,K,Y),q=new $o(ge,K,Y),Z=new ar(ge),$=new Bo,Q=new Qo(ge,K,q,$,Y,me,Z),J=new Gs(b),ee=new ir(b),te=new Ps(ge,Y),fe=new Fs(ge,K,te,Y),ne=new rr(ge,te,Z,fe),ie=new hr(ge,ne,te,Z),ue=new ur(ge,Y,Q),le=new js($),se=new Uo(b,J,ee,K,Y,fe,le),re=new ea(b,$),oe=new jo,ae=new qo(K,Y),de=new Bs(b,J,q,ie,u,a),ce=new Zo(b,ie,Y),he=new Vs(ge,K,Z,Y),pe=new or(ge,K,Z,Y),Z.programs=se.programs,b.capabilities=Y,b.extensions=K,b.properties=$,b.renderLists=oe,b.shadowMap=ce,b.state=q,b.info=Z}ye();const be=new WebXRManager(b,ge);function Se(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function Te(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const e=Z.autoReset,t=ce.enabled,n=ce.autoUpdate,i=ce.needsUpdate,s=ce.type;ye(),Z.autoReset=e,ce.enabled=t,ce.autoUpdate=n,ce.needsUpdate=i,ce.type=s}function xe(e){const t=e.target;t.removeEventListener("dispose",xe),function(e){(function(e){const t=$.get(e).programs;void 0!==t&&(t.forEach((function(e){se.releaseProgram(e)})),e.isShaderMaterial&&se.releaseShaderCache(e))})(e),$.remove(e)}(t)}this.xr=be,this.getContext=function(){return ge},this.getContextAttributes=function(){return ge.getContextAttributes()},this.forceContextLoss=function(){const e=K.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=K.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return D},this.setPixelRatio=function(e){void 0!==e&&(D=e,this.setSize(C,N,!1))},this.getSize=function(e){return e.set(C,N)},this.setSize=function(e,n,i){be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(C=e,N=n,t.width=Math.floor(e*D),t.height=Math.floor(n*D),!1!==i&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(C*D,N*D).floor()},this.setDrawingBufferSize=function(e,n,i){C=e,N=n,D=i,t.width=Math.floor(e*i),t.height=Math.floor(n*i),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return e.copy(M)},this.getViewport=function(e){return e.copy(P)},this.setViewport=function(e,t,n,i){e.isVector4?P.set(e.x,e.y,e.z,e.w):P.set(e,t,n,i),q.viewport(M.copy(P).multiplyScalar(D).floor())},this.getScissor=function(e){return e.copy(R)},this.setScissor=function(e,t,n,i){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,i),q.scissor(O.copy(R).multiplyScalar(D).floor())},this.getScissorTest=function(){return k},this.setScissorTest=function(e){q.setScissorTest(k=e)},this.setOpaqueSort=function(e){I=e},this.setTransparentSort=function(e){L=e},this.getClearColor=function(e){return e.copy(de.getClearColor())},this.setClearColor=function(){de.setClearColor.apply(de,arguments)},this.getClearAlpha=function(){return de.getClearAlpha()},this.setClearAlpha=function(){de.setClearAlpha.apply(de,arguments)},this.clear=function(e=!0,t=!0,n=!0){let i=0;e&&(i|=16384),t&&(i|=256),n&&(i|=1024),ge.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Se,!1),t.removeEventListener("webglcontextrestored",Te,!1),oe.dispose(),ae.dispose(),$.dispose(),J.dispose(),ee.dispose(),ie.dispose(),fe.dispose(),se.dispose(),be.dispose(),be.removeEventListener("sessionstart",Me),be.removeEventListener("sessionend",Oe),V&&(V.dispose(),V=null),Ae.stop()},this.renderBufferDirect=function(e,t,n,i,s,r){null===t&&(t=z);const o=s.isMesh&&s.matrixWorld.determinant()<0,a=function(e,t,n,i,s){!0!==t.isScene&&(t=z);Q.resetTextureUnits();const r=t.fog,o=i.isMeshStandardMaterial?t.environment:null,a=null===w?b.outputEncoding:!0===w.isXRRenderTarget?w.texture.encoding:It,l=(i.isMeshStandardMaterial?ee:J).get(i.envMap||o),c=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,d=!!i.normalMap&&!!n.attributes.tangent,u=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,m=!!n.morphAttributes.color,f=i.toneMapped?b.toneMapping:X,g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,y=$.get(i),S=p.state.lights;if(!0===B&&(!0===F||e!==_)){const t=e===_&&i.id===x;le.setState(i,e,t)}let E=!1;i.version===y.__version?y.needsLights&&y.lightsStateVersion!==S.state.version||y.outputEncoding!==a||s.isInstancedMesh&&!1===y.instancing?E=!0:s.isInstancedMesh||!0!==y.instancing?s.isSkinnedMesh&&!1===y.skinning?E=!0:s.isSkinnedMesh||!0!==y.skinning?y.envMap!==l||i.fog&&y.fog!==r?E=!0:void 0===y.numClippingPlanes||y.numClippingPlanes===le.numPlanes&&y.numIntersection===le.numIntersection?(y.vertexAlphas!==c||y.vertexTangents!==d||y.morphTargets!==u||y.morphNormals!==h||y.morphColors!==m||y.toneMapping!==f||!0===Y.isWebGL2&&y.morphTargetsCount!==v)&&(E=!0):E=!0:E=!0:E=!0:(E=!0,y.__version=i.version);let T=y.currentProgram;!0===E&&(T=Re(i,t,s));let M=!1,O=!1,A=!1;const C=T.getUniforms(),I=y.uniforms;q.useProgram(T.program)&&(M=!0,O=!0,A=!0);i.id!==x&&(x=i.id,O=!0);if(M||_!==e){if(C.setValue(ge,"projectionMatrix",e.projectionMatrix),Y.logarithmicDepthBuffer&&C.setValue(ge,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),_!==e&&(_=e,O=!0,A=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const t=C.map.cameraPosition;void 0!==t&&t.setValue(ge,G.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&C.setValue(ge,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||s.isSkinnedMesh)&&C.setValue(ge,"viewMatrix",e.matrixWorldInverse)}if(s.isSkinnedMesh){C.setOptional(ge,s,"bindMatrix"),C.setOptional(ge,s,"bindMatrixInverse");const e=s.skeleton;e&&(Y.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),C.setValue(ge,"boneTexture",e.boneTexture,Q),C.setValue(ge,"boneTextureSize",e.boneTextureSize)):C.setOptional(ge,e,"boneMatrices"))}const L=n.morphAttributes;(void 0!==L.position||void 0!==L.normal||void 0!==L.color&&!0===Y.isWebGL2)&&ue.update(s,n,i,T);(O||y.receiveShadow!==s.receiveShadow)&&(y.receiveShadow=s.receiveShadow,C.setValue(ge,"receiveShadow",s.receiveShadow));O&&(C.setValue(ge,"toneMappingExposure",b.toneMappingExposure),y.needsLights&&(R=A,(P=I).ambientLightColor.needsUpdate=R,P.lightProbe.needsUpdate=R,P.directionalLights.needsUpdate=R,P.directionalLightShadows.needsUpdate=R,P.pointLights.needsUpdate=R,P.pointLightShadows.needsUpdate=R,P.spotLights.needsUpdate=R,P.spotLightShadows.needsUpdate=R,P.rectAreaLights.needsUpdate=R,P.hemisphereLights.needsUpdate=R),r&&i.fog&&re.refreshFogUniforms(I,r),re.refreshMaterialUniforms(I,i,D,N,V),vo.upload(ge,y.uniformsList,I,Q));var P,R;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(vo.upload(ge,y.uniformsList,I,Q),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&C.setValue(ge,"center",s.center);return C.setValue(ge,"modelViewMatrix",s.modelViewMatrix),C.setValue(ge,"normalMatrix",s.normalMatrix),C.setValue(ge,"modelMatrix",s.matrixWorld),T}(e,t,n,i,s);q.setMaterial(i,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let d,u=1;!0===i.wireframe&&(l=ne.getWireframeAttribute(n),u=2),fe.setup(s,i,a,n,l);let h=he;null!==l&&(d=te.get(l),h=pe,h.setIndex(d));const m=null!==l?l.count:c.count,f=n.drawRange.start*u,g=n.drawRange.count*u,v=null!==r?r.start*u:0,y=null!==r?r.count*u:1/0,S=Math.max(f,v),E=Math.min(m,f+g,v+y)-1,T=Math.max(0,E-S+1);if(0!==T){if(s.isMesh)!0===i.wireframe?(q.setLineWidth(i.wireframeLinewidth*W()),h.setMode(1)):h.setMode(4);else if(s.isLine){let e=i.linewidth;void 0===e&&(e=1),q.setLineWidth(e*W()),s.isLineSegments?h.setMode(1):s.isLineLoop?h.setMode(2):h.setMode(3)}else s.isPoints?h.setMode(0):s.isSprite&&h.setMode(4);if(s.isInstancedMesh)h.renderInstances(S,T,s.count);else if(n.isInstancedBufferGeometry){const e=Math.min(n.instanceCount,n._maxInstanceCount);h.renderInstances(S,T,e)}else h.render(S,T)}},this.compile=function(e,t){p=ae.get(e),p.init(),y.push(p),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(p.pushLight(e),e.castShadow&&p.pushShadow(e))})),p.setupLights(b.physicallyCorrectLights),e.traverse((function(t){const n=t.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++){Re(n[i],e,t)}else Re(n,e,t)})),y.pop(),p=null};let _e=null;function Me(){Ae.stop()}function Oe(){Ae.start()}const Ae=new Ls;function De(e,t,n,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)p.pushLight(e),e.castShadow&&p.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||U.intersectsSprite(e)){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(H);const t=ie.update(e),s=e.material;s.visible&&h.push(e,t,s,n,G.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==Z.render.frame&&(e.skeleton.update(),e.skeleton.frame=Z.render.frame),!e.frustumCulled||U.intersectsObject(e))){i&&G.setFromMatrixPosition(e.matrixWorld).applyMatrix4(H);const t=ie.update(e),s=e.material;if(Array.isArray(s)){const i=t.groups;for(let r=0,o=i.length;r<o;r++){const o=i[r],a=s[o.materialIndex];a&&a.visible&&h.push(e,t,a,n,G.z,o)}}else s.visible&&h.push(e,t,s,n,G.z,null)}const s=e.children;for(let e=0,r=s.length;e<r;e++)De(s[e],t,n,i)}function Ie(e,t,n,i){const s=e.opaque,r=e.transmissive,a=e.transparent;p.setupLightsView(n),r.length>0&&function(e,t,n){const i=Y.isWebGL2;null===V&&(V=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:null!==me.convert(Ne)?Ne:we,minFilter:Ee,samples:i&&!0===o?4:0}));b.getDrawingBufferSize(j),i?V.setSize(j.x,j.y):V.setSize(Mn(j.x),Mn(j.y));const s=b.getRenderTarget();b.setRenderTarget(V),b.clear();const r=b.toneMapping;b.toneMapping=X,Le(e,t,n),b.toneMapping=r,Q.updateMultisampleRenderTarget(V),Q.updateRenderTargetMipmap(V),b.setRenderTarget(s)}(s,t,n),i&&q.viewport(M.copy(i)),s.length>0&&Le(s,t,n),r.length>0&&Le(r,t,n),a.length>0&&Le(a,t,n),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1)}function Le(e,t,n){const i=!0===t.isScene?t.overrideMaterial:null;for(let s=0,r=e.length;s<r;s++){const r=e[s],o=r.object,a=r.geometry,l=null===i?r.material:i,c=r.group;o.layers.test(n.layers)&&Pe(o,t,n,a,l,c)}}function Pe(e,t,n,i,s,r){e.onBeforeRender(b,t,n,i,s,r),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),s.onBeforeRender(b,t,n,i,e,r),!0===s.transparent&&s.side===g?(s.side=f,s.needsUpdate=!0,b.renderBufferDirect(n,t,i,s,e,r),s.side=m,s.needsUpdate=!0,b.renderBufferDirect(n,t,i,s,e,r),s.side=g):b.renderBufferDirect(n,t,i,s,e,r),e.onAfterRender(b,t,n,i,s,r)}function Re(e,t,n){!0!==t.isScene&&(t=z);const i=$.get(e),s=p.state.lights,r=p.state.shadowsArray,o=s.state.version,a=se.getParameters(e,s.state,r,t,n),l=se.getProgramCacheKey(a);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?ee:J).get(e.envMap||i.environment),void 0===c&&(e.addEventListener("dispose",xe),c=new Map,i.programs=c);let d=c.get(l);if(void 0!==d){if(i.currentProgram===d&&i.lightsStateVersion===o)return Ue(e,a),d}else a.uniforms=se.getUniforms(e),e.onBuild(n,a,b),e.onBeforeCompile(a,b),d=se.acquireProgram(a,l),c.set(l,d),i.uniforms=a.uniforms;const u=i.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(u.clippingPlanes=le.uniform),Ue(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(u.ambientLightColor.value=s.state.ambient,u.lightProbe.value=s.state.probe,u.directionalLights.value=s.state.directional,u.directionalLightShadows.value=s.state.directionalShadow,u.spotLights.value=s.state.spot,u.spotLightShadows.value=s.state.spotShadow,u.rectAreaLights.value=s.state.rectArea,u.ltc_1.value=s.state.rectAreaLTC1,u.ltc_2.value=s.state.rectAreaLTC2,u.pointLights.value=s.state.point,u.pointLightShadows.value=s.state.pointShadow,u.hemisphereLights.value=s.state.hemi,u.directionalShadowMap.value=s.state.directionalShadowMap,u.directionalShadowMatrix.value=s.state.directionalShadowMatrix,u.spotShadowMap.value=s.state.spotShadowMap,u.spotShadowMatrix.value=s.state.spotShadowMatrix,u.pointShadowMap.value=s.state.pointShadowMap,u.pointShadowMatrix.value=s.state.pointShadowMatrix);const h=d.getUniforms(),m=vo.seqWithValue(h.seq,u);return i.currentProgram=d,i.uniformsList=m,d}function Ue(e,t){const n=$.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}Ae.setAnimationLoop((function(e){_e&&_e(e)})),"undefined"!=typeof self&&Ae.setContext(self),this.setAnimationLoop=function(e){_e=e,be.setAnimationLoop(e),null===e?Ae.stop():Ae.start()},be.addEventListener("sessionstart",Me),be.addEventListener("sessionend",Oe),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===S)return;!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(!0===be.cameraAutoUpdate&&be.updateCamera(t),t=be.getCamera()),!0===e.isScene&&e.onBeforeRender(b,e,t,w),p=ae.get(e,y.length),p.init(),y.push(p),H.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),U.setFromProjectionMatrix(H),F=this.localClippingEnabled,B=le.init(this.clippingPlanes,F,t),h=oe.get(e,v.length),h.init(),v.push(h),De(e,t,0,b.sortObjects),h.finish(),!0===b.sortObjects&&h.sort(I,L),!0===B&&le.beginShadows();const n=p.state.shadowsArray;if(ce.render(n,e,t),!0===B&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),de.render(h,e),p.setupLights(b.physicallyCorrectLights),t.isArrayCamera){const n=t.cameras;for(let t=0,i=n.length;t<i;t++){const i=n[t];Ie(h,e,i,i.viewport)}}else Ie(h,e,t);null!==w&&(Q.updateMultisampleRenderTarget(w),Q.updateRenderTargetMipmap(w)),!0===e.isScene&&e.onAfterRender(b,e,t),fe.resetDefaultState(),x=-1,_=null,y.pop(),p=y.length>0?y[y.length-1]:null,v.pop(),h=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(e,t,n){$.get(e.texture).__webglTexture=t,$.get(e.depthTexture).__webglTexture=n;const i=$.get(e);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===K.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const n=$.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,n=0){w=e,E=t,T=n;let i=!0;if(e){const t=$.get(e);void 0!==t.__useDefaultFramebuffer?(q.bindFramebuffer(36160,null),i=!1):void 0===t.__webglFramebuffer?Q.setupRenderTarget(e):t.__hasExternalTextures&&Q.rebindTextures(e,$.get(e.texture).__webglTexture,$.get(e.depthTexture).__webglTexture)}let s=null,r=!1,o=!1;if(e){const n=e.texture;(n.isData3DTexture||n.isDataArrayTexture)&&(o=!0);const i=$.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(s=i[t],r=!0):s=Y.isWebGL2&&e.samples>0&&!1===Q.useMultisampledRTT(e)?$.get(e).__webglMultisampledFramebuffer:i,M.copy(e.viewport),O.copy(e.scissor),A=e.scissorTest}else M.copy(P).multiplyScalar(D).floor(),O.copy(R).multiplyScalar(D).floor(),A=k;if(q.bindFramebuffer(36160,s)&&Y.drawBuffers&&i&&q.drawBuffers(e,s),q.viewport(M),q.scissor(O),q.setScissorTest(A),r){const i=$.get(e.texture);ge.framebufferTexture2D(36160,36064,34069+t,i.__webglTexture,n)}else if(o){const i=$.get(e.texture),s=t||0;ge.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,s)}x=-1},this.readRenderTargetPixels=function(e,t,n,i,s,r,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=$.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){q.bindFramebuffer(36160,a);try{const o=e.texture,a=o.format,l=o.type;if(a!==ke&&me.convert(a)!==ge.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Ne&&(K.has("EXT_color_buffer_half_float")||Y.isWebGL2&&K.has("EXT_color_buffer_float"));if(!(l===we||me.convert(l)===ge.getParameter(35738)||l===Ce&&(Y.isWebGL2||K.has("OES_texture_float")||K.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-i&&n>=0&&n<=e.height-s&&ge.readPixels(t,n,i,s,me.convert(a),me.convert(l),r)}finally{const e=null!==w?$.get(w).__webglFramebuffer:null;q.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t,n=0){if(!0!==t.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const i=Math.pow(2,-n),s=Math.floor(t.image.width*i),r=Math.floor(t.image.height*i);Q.setTexture2D(t,0),ge.copyTexSubImage2D(3553,n,0,0,e.x,e.y,s,r),q.unbindTexture()},this.copyTextureToTexture=function(e,t,n,i=0){const s=t.image.width,r=t.image.height,o=me.convert(n.format),a=me.convert(n.type);Q.setTexture2D(n,0),ge.pixelStorei(37440,n.flipY),ge.pixelStorei(37441,n.premultiplyAlpha),ge.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ge.texSubImage2D(3553,i,e.x,e.y,s,r,o,a,t.image.data):t.isCompressedTexture?ge.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ge.texSubImage2D(3553,i,e.x,e.y,o,a,t.image),0===i&&n.generateMipmaps&&ge.generateMipmap(3553),q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,i,s=0){if(b.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const r=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=me.convert(i.format),c=me.convert(i.type);let d;if(i.isData3DTexture)Q.setTexture3D(i,0),d=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Q.setTexture2DArray(i,0),d=35866}ge.pixelStorei(37440,i.flipY),ge.pixelStorei(37441,i.premultiplyAlpha),ge.pixelStorei(3317,i.unpackAlignment);const u=ge.getParameter(3314),h=ge.getParameter(32878),p=ge.getParameter(3316),m=ge.getParameter(3315),f=ge.getParameter(32877),g=n.isCompressedTexture?n.mipmaps[0]:n.image;ge.pixelStorei(3314,g.width),ge.pixelStorei(32878,g.height),ge.pixelStorei(3316,e.min.x),ge.pixelStorei(3315,e.min.y),ge.pixelStorei(32877,e.min.z),n.isDataTexture||n.isData3DTexture?ge.texSubImage3D(d,s,t.x,t.y,t.z,r,o,a,l,c,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ge.compressedTexSubImage3D(d,s,t.x,t.y,t.z,r,o,a,l,g.data)):ge.texSubImage3D(d,s,t.x,t.y,t.z,r,o,a,l,c,g),ge.pixelStorei(3314,u),ge.pixelStorei(32878,h),ge.pixelStorei(3316,p),ge.pixelStorei(3315,m),ge.pixelStorei(32877,f),0===s&&i.generateMipmaps&&ge.generateMipmap(d),q.unbindTexture()},this.initTexture=function(e){Q.setTexture2D(e,0),q.unbindTexture()},this.resetState=function(){E=0,T=0,w=null,q.reset(),fe.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}ta.prototype.isWebGLRenderer=!0;class WebGL1Renderer extends ta{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class FogExp2{constructor(e,t=25e-5){this.name="",this.color=new Color(e),this.density=t}clone(){return new FogExp2(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}FogExp2.prototype.isFogExp2=!0;class Fog{constructor(e,t=1,n=1e3){this.name="",this.color=new Color(e),this.near=t,this.far=n}clone(){return new Fog(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Fog.prototype.isFog=!0;class Scene extends Object3D{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}Scene.prototype.isScene=!0;class InterleavedBuffer{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=sn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Sn()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Sn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Sn()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}InterleavedBuffer.prototype.isInterleavedBuffer=!0;const na=new Vector3;class InterleavedBufferAttribute{constructor(e,t,n,i=!1){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)na.fromBufferAttribute(this,t),na.applyMatrix4(e),this.setXYZ(t,na.x,na.y,na.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)na.fromBufferAttribute(this,t),na.applyNormalMatrix(e),this.setXYZ(t,na.x,na.y,na.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)na.fromBufferAttribute(this,t),na.transformDirection(e),this.setXYZ(t,na.x,na.y,na.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new BufferAttribute(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new InterleavedBufferAttribute(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}InterleavedBufferAttribute.prototype.isInterleavedBufferAttribute=!0;class SpriteMaterial extends Material{constructor(e){super(),this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let ia;SpriteMaterial.prototype.isSpriteMaterial=!0;const sa=new Vector3,ra=new Vector3,oa=new Vector3,aa=new Vector2,la=new Vector2,ca=new Matrix4,da=new Vector3,ua=new Vector3,ha=new Vector3,pa=new Vector2,ma=new Vector2,fa=new Vector2;class Sprite extends Object3D{constructor(e){if(super(),this.type="Sprite",void 0===ia){ia=new BufferGeometry;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new InterleavedBuffer(e,5);ia.setIndex([0,1,2,0,2,3]),ia.setAttribute("position",new InterleavedBufferAttribute(t,3,0,!1)),ia.setAttribute("uv",new InterleavedBufferAttribute(t,2,3,!1))}this.geometry=ia,this.material=void 0!==e?e:new SpriteMaterial,this.center=new Vector2(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ra.setFromMatrixScale(this.matrixWorld),ca.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),oa.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ra.multiplyScalar(-oa.z);const n=this.material.rotation;let i,s;0!==n&&(s=Math.cos(n),i=Math.sin(n));const r=this.center;ga(da.set(-.5,-.5,0),oa,r,ra,i,s),ga(ua.set(.5,-.5,0),oa,r,ra,i,s),ga(ha.set(.5,.5,0),oa,r,ra,i,s),pa.set(0,0),ma.set(1,0),fa.set(1,1);let o=e.ray.intersectTriangle(da,ua,ha,!1,sa);if(null===o&&(ga(ua.set(-.5,.5,0),oa,r,ra,i,s),ma.set(0,1),o=e.ray.intersectTriangle(da,ha,ua,!1,sa),null===o))return;const a=e.ray.origin.distanceTo(sa);a<e.near||a>e.far||t.push({distance:a,point:sa.clone(),uv:Triangle.getUV(sa,da,ua,ha,pa,ma,fa,new Vector2),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function ga(e,t,n,i,s,r){aa.subVectors(e,n).addScalar(.5).multiply(i),void 0!==s?(la.x=r*aa.x-s*aa.y,la.y=s*aa.x+r*aa.y):la.copy(aa),e.copy(t),e.x+=la.x,e.y+=la.y,e.applyMatrix4(ca)}Sprite.prototype.isSprite=!0;const va=new Vector3,ya=new Vector3;class LOD extends Object3D{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let e=0,n=t.length;e<n;e++){const n=t[e];this.addLevel(n.object.clone(),n.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const n=this.levels;let i;for(i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){va.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(va);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){va.setFromMatrixPosition(e.matrixWorld),ya.setFromMatrixPosition(this.matrixWorld);const n=va.distanceTo(ya)/e.zoom;let i,s;for(t[0].object.visible=!0,i=1,s=t.length;i<s&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let e=0,i=n.length;e<i;e++){const i=n[e];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}const ba=new Vector3,Sa=new Vector4,Ea=new Vector4,Ta=new Vector3,wa=new Matrix4;class SkinnedMesh extends Mesh{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Vector4,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,i=this.geometry;Sa.fromBufferAttribute(i.attributes.skinIndex,e),Ea.fromBufferAttribute(i.attributes.skinWeight,e),ba.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const i=Ea.getComponent(e);if(0!==i){const s=Sa.getComponent(e);wa.multiplyMatrices(n.bones[s].matrixWorld,n.boneInverses[s]),t.addScaledVector(Ta.copy(ba).applyMatrix4(wa),i)}}return t.applyMatrix4(this.bindMatrixInverse)}}SkinnedMesh.prototype.isSkinnedMesh=!0;class Bone extends Object3D{constructor(){super(),this.type="Bone"}}Bone.prototype.isBone=!0;class DataTexture extends Texture{constructor(e=null,t=1,n=1,i,s,r,o,a,l=pe,c=pe,d,u){super(null,r,o,a,l,c,i,s,d,u),this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}DataTexture.prototype.isDataTexture=!0;const xa=new Matrix4,_a=new Matrix4;class Skeleton{constructor(e=[],t=[]){this.uuid=Sn(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Matrix4)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Matrix4;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let i=0,s=e.length;i<s;i++){const s=e[i]?e[i].matrixWorld:_a;xa.multiplyMatrices(s,t[i]),xa.toArray(n,16*i)}null!==i&&(i.needsUpdate=!0)}clone(){return new Skeleton(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=_n(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new DataTexture(t,e,e,ke,Ce);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const i=e.bones[n];let s=t[i];void 0===s&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),s=new Bone),this.bones.push(s),this.boneInverses.push((new Matrix4).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const s=t[i];e.bones.push(s.uuid);const r=n[i];e.boneInverses.push(r.toArray())}return e}}class InstancedBufferAttribute extends BufferAttribute{constructor(e,t,n,i=1){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,n),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}InstancedBufferAttribute.prototype.isInstancedBufferAttribute=!0;const Ma=new Matrix4,Oa=new Matrix4,Aa=[],Ca=new Mesh;class InstancedMesh extends Mesh{constructor(e,t,n){super(e,t),this.instanceMatrix=new InstancedBufferAttribute(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Ca.geometry=this.geometry,Ca.material=this.material,void 0!==Ca.material)for(let s=0;s<i;s++){this.getMatrixAt(s,Ma),Oa.multiplyMatrices(n,Ma),Ca.matrixWorld=Oa,Ca.raycast(e,Aa);for(let e=0,n=Aa.length;e<n;e++){const n=Aa[e];n.instanceId=s,n.object=this,t.push(n)}Aa.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new InstancedBufferAttribute(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}InstancedMesh.prototype.isInstancedMesh=!0;class LineBasicMaterial extends Material{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}LineBasicMaterial.prototype.isLineBasicMaterial=!0;const Na=new Vector3,Da=new Vector3,Ia=new Matrix4,La=new Ray,Pa=new Sphere;class Line extends Object3D{constructor(e=new BufferGeometry,t=new LineBasicMaterial){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,i=t.count;e<i;e++)Na.fromBufferAttribute(t,e-1),Da.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=Na.distanceTo(Da);e.setAttribute("lineDistance",new Float32BufferAttribute(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,r=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Pa.copy(n.boundingSphere),Pa.applyMatrix4(i),Pa.radius+=s,!1===e.ray.intersectsSphere(Pa))return;Ia.copy(i).invert(),La.copy(e.ray).applyMatrix4(Ia);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new Vector3,c=new Vector3,d=new Vector3,u=new Vector3,h=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,s=n.attributes.position;if(null!==i){for(let n=Math.max(0,r.start),o=Math.min(i.count,r.start+r.count)-1;n<o;n+=h){const r=i.getX(n),o=i.getX(n+1);l.fromBufferAttribute(s,r),c.fromBufferAttribute(s,o);if(La.distanceSqToSegment(l,c,u,d)>a)continue;u.applyMatrix4(this.matrixWorld);const h=e.ray.origin.distanceTo(u);h<e.near||h>e.far||t.push({distance:h,point:d.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{for(let n=Math.max(0,r.start),i=Math.min(s.count,r.start+r.count)-1;n<i;n+=h){l.fromBufferAttribute(s,n),c.fromBufferAttribute(s,n+1);if(La.distanceSqToSegment(l,c,u,d)>a)continue;u.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(u);i<e.near||i>e.far||t.push({distance:i,point:d.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Line.prototype.isLine=!0;const Ra=new Vector3,ka=new Vector3;class LineSegments extends Line{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,i=t.count;e<i;e+=2)Ra.fromBufferAttribute(t,e),ka.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+Ra.distanceTo(ka);e.setAttribute("lineDistance",new Float32BufferAttribute(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}LineSegments.prototype.isLineSegments=!0;class LineLoop extends Line{constructor(e,t){super(e,t),this.type="LineLoop"}}LineLoop.prototype.isLineLoop=!0;class PointsMaterial extends Material{constructor(e){super(),this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}PointsMaterial.prototype.isPointsMaterial=!0;const Ua=new Matrix4,Ba=new Ray,Fa=new Sphere,Va=new Vector3;class Points extends Object3D{constructor(e=new BufferGeometry,t=new PointsMaterial){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,r=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Fa.copy(n.boundingSphere),Fa.applyMatrix4(i),Fa.radius+=s,!1===e.ray.intersectsSphere(Fa))return;Ua.copy(i).invert(),Ba.copy(e.ray).applyMatrix4(Ua);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){const s=n.index,o=n.attributes.position;if(null!==s){for(let n=Math.max(0,r.start),l=Math.min(s.count,r.start+r.count);n<l;n++){const r=s.getX(n);Va.fromBufferAttribute(o,r),Ha(Va,r,a,i,e,t,this)}}else{for(let n=Math.max(0,r.start),s=Math.min(o.count,r.start+r.count);n<s;n++)Va.fromBufferAttribute(o,n),Ha(Va,n,a,i,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,n=Object.keys(t);if(n.length>0){const e=t[n[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,n=e.length;t<n;t++){const n=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Ha(e,t,n,i,s,r,o){const a=Ba.distanceSqToPoint(e);if(a<n){const n=new Vector3;Ba.closestPointToPoint(e,n),n.applyMatrix4(i);const l=s.ray.origin.distanceTo(n);if(l<s.near||l>s.far)return;r.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:t,face:null,object:o})}}Points.prototype.isPoints=!0;class VideoTexture extends Texture{constructor(e,t,n,i,s,r,o,a,l){super(e,t,n,i,s,r,o,a,l),this.minFilter=void 0!==r?r:ye,this.magFilter=void 0!==s?s:ye,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}VideoTexture.prototype.isVideoTexture=!0;class FramebufferTexture extends Texture{constructor(e,t,n){super({width:e,height:t}),this.format=n,this.magFilter=pe,this.minFilter=pe,this.generateMipmaps=!1,this.needsUpdate=!0}}FramebufferTexture.prototype.isFramebufferTexture=!0;class CompressedTexture extends Texture{constructor(e,t,n,i,s,r,o,a,l,c,d,u){super(null,r,o,a,l,c,i,s,d,u),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}CompressedTexture.prototype.isCompressedTexture=!0;class CanvasTexture extends Texture{constructor(e,t,n,i,s,r,o,a,l){super(e,t,n,i,s,r,o,a,l),this.needsUpdate=!0}}CanvasTexture.prototype.isCanvasTexture=!0;class Curve{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let r=1;r<=e;r++)n=this.getPoint(r/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const s=n.length;let r;r=t||e*n[s-1];let o,a=0,l=s-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-r,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===r)return i/(s-1);const c=n[i];return(i+(r-c)/(n[i+1]-c))/(s-1)}getTangent(e,t){const n=1e-4;let i=e-n,s=e+n;i<0&&(i=0),s>1&&(s=1);const r=this.getPoint(i),o=this.getPoint(s),a=t||(r.isVector2?new Vector2:new Vector3);return a.copy(o).sub(r).normalize(),a}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new Vector3,i=[],s=[],r=[],o=new Vector3,a=new Matrix4;for(let t=0;t<=e;t++){const n=t/e;i[t]=this.getTangentAt(n,new Vector3)}s[0]=new Vector3,r[0]=new Vector3;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),d=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),d<=l&&(l=d,n.set(0,1,0)),u<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],o),r[0].crossVectors(i[0],s[0]);for(let t=1;t<=e;t++){if(s[t]=s[t-1].clone(),r[t]=r[t-1].clone(),o.crossVectors(i[t-1],i[t]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(En(i[t-1].dot(i[t]),-1,1));s[t].applyMatrix4(a.makeRotationAxis(o,e))}r[t].crossVectors(i[t],s[t])}if(!0===t){let t=Math.acos(En(s[0].dot(s[e]),-1,1));t/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(t=-t);for(let n=1;n<=e;n++)s[n].applyMatrix4(a.makeRotationAxis(i[n],t*n)),r[n].crossVectors(i[n],s[n])}return{tangents:i,normals:s,binormals:r}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class EllipseCurve extends Curve{constructor(e=0,t=0,n=1,i=1,s=0,r=2*Math.PI,o=!1,a=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=r,this.aClockwise=o,this.aRotation=a}getPoint(e,t){const n=t||new Vector2,i=2*Math.PI;let s=this.aEndAngle-this.aStartAngle;const r=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(s=r?0:i),!0!==this.aClockwise||r||(s===i?s=-i:s-=i);const o=this.aStartAngle+e*s;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=a-this.aX,i=l-this.aY;a=n*e-i*t+this.aX,l=n*t+i*e+this.aY}return n.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}EllipseCurve.prototype.isEllipseCurve=!0;class ArcCurve extends EllipseCurve{constructor(e,t,n,i,s,r){super(e,t,n,n,i,s,r),this.type="ArcCurve"}}function ja(){let e=0,t=0,n=0,i=0;function s(s,r,o,a){e=s,t=o,n=-3*s+3*r-2*o-a,i=2*s-2*r+o+a}return{initCatmullRom:function(e,t,n,i,r){s(t,n,r*(n-e),r*(i-t))},initNonuniformCatmullRom:function(e,t,n,i,r,o,a){let l=(t-e)/r-(n-e)/(r+o)+(n-t)/o,c=(n-t)/o-(i-t)/(o+a)+(i-n)/a;l*=o,c*=o,s(t,n,l,c)},calc:function(s){const r=s*s;return e+t*s+n*r+i*(r*s)}}}ArcCurve.prototype.isArcCurve=!0;const Ga=new Vector3,za=new ja,Wa=new ja,Ka=new ja;class CatmullRomCurve3 extends Curve{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new Vector3){const n=t,i=this.points,s=i.length,r=(s-(this.closed?0:1))*e;let o,a,l=Math.floor(r),c=r-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:0===c&&l===s-1&&(l=s-2,c=1),this.closed||l>0?o=i[(l-1)%s]:(Ga.subVectors(i[0],i[1]).add(i[0]),o=Ga);const d=i[l%s],u=i[(l+1)%s];if(this.closed||l+2<s?a=i[(l+2)%s]:(Ga.subVectors(i[s-1],i[s-2]).add(i[s-1]),a=Ga),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(d),e),n=Math.pow(d.distanceToSquared(u),e),i=Math.pow(u.distanceToSquared(a),e);n<1e-4&&(n=1),t<1e-4&&(t=n),i<1e-4&&(i=n),za.initNonuniformCatmullRom(o.x,d.x,u.x,a.x,t,n,i),Wa.initNonuniformCatmullRom(o.y,d.y,u.y,a.y,t,n,i),Ka.initNonuniformCatmullRom(o.z,d.z,u.z,a.z,t,n,i)}else"catmullrom"===this.curveType&&(za.initCatmullRom(o.x,d.x,u.x,a.x,this.tension),Wa.initCatmullRom(o.y,d.y,u.y,a.y,this.tension),Ka.initCatmullRom(o.z,d.z,u.z,a.z,this.tension));return n.set(za.calc(c),Wa.calc(c),Ka.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Vector3).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Ya(e,t,n,i,s){const r=.5*(i-t),o=.5*(s-n),a=e*e;return(2*n-2*i+r+o)*(e*a)+(-3*n+3*i-2*r-o)*a+r*e+n}function qa(e,t,n,i){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,i)}function Za(e,t,n,i,s){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,s)}CatmullRomCurve3.prototype.isCatmullRomCurve3=!0;class CubicBezierCurve extends Curve{constructor(e=new Vector2,t=new Vector2,n=new Vector2,i=new Vector2){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Vector2){const n=t,i=this.v0,s=this.v1,r=this.v2,o=this.v3;return n.set(Za(e,i.x,s.x,r.x,o.x),Za(e,i.y,s.y,r.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}CubicBezierCurve.prototype.isCubicBezierCurve=!0;class CubicBezierCurve3 extends Curve{constructor(e=new Vector3,t=new Vector3,n=new Vector3,i=new Vector3){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Vector3){const n=t,i=this.v0,s=this.v1,r=this.v2,o=this.v3;return n.set(Za(e,i.x,s.x,r.x,o.x),Za(e,i.y,s.y,r.y,o.y),Za(e,i.z,s.z,r.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}CubicBezierCurve3.prototype.isCubicBezierCurve3=!0;class LineCurve extends Curve{constructor(e=new Vector2,t=new Vector2){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Vector2){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const n=t||new Vector2;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}LineCurve.prototype.isLineCurve=!0;class LineCurve3 extends Curve{constructor(e=new Vector3,t=new Vector3){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Vector3){const n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QuadraticBezierCurve extends Curve{constructor(e=new Vector2,t=new Vector2,n=new Vector2){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Vector2){const n=t,i=this.v0,s=this.v1,r=this.v2;return n.set(qa(e,i.x,s.x,r.x),qa(e,i.y,s.y,r.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0;class QuadraticBezierCurve3 extends Curve{constructor(e=new Vector3,t=new Vector3,n=new Vector3){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Vector3){const n=t,i=this.v0,s=this.v1,r=this.v2;return n.set(qa(e,i.x,s.x,r.x),qa(e,i.y,s.y,r.y),qa(e,i.z,s.z,r.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0;class SplineCurve extends Curve{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new Vector2){const n=t,i=this.points,s=(i.length-1)*e,r=Math.floor(s),o=s-r,a=i[0===r?r:r-1],l=i[r],c=i[r>i.length-2?i.length-1:r+1],d=i[r>i.length-3?i.length-1:r+2];return n.set(Ya(o,a.x,l.x,c.x,d.x),Ya(o,a.y,l.y,c.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Vector2).fromArray(n))}return this}}SplineCurve.prototype.isSplineCurve=!0;var $a=Object.freeze({__proto__:null,ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve});class CurvePath extends Curve{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new LineCurve(t,e))}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const e=i[s]-n,r=this.curves[s],o=r.getLength(),a=0===o?0:1-e/o;return r.getPointAt(a,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const r=s[i],o=r.isEllipseCurve?2*e:r.isLineCurve||r.isLineCurve3?1:r.isSplineCurve?e*r.points.length:e,a=r.getPoints(o);for(let e=0;e<a.length;e++){const i=a[e];n&&n.equals(i)||(t.push(i),n=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new $a[n.type]).fromJSON(n))}return this}}class Path extends CurvePath{constructor(e){super(),this.type="Path",this.currentPoint=new Vector2,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new LineCurve(this.currentPoint.clone(),new Vector2(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,r){const o=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,t),new Vector2(n,i),new Vector2(s,r));return this.curves.push(o),this.currentPoint.set(s,r),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new SplineCurve(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,r){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,n,i,s,r),this}absarc(e,t,n,i,s,r){return this.absellipse(e,t,n,n,i,s,r),this}ellipse(e,t,n,i,s,r,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,s,r,o,a),this}absellipse(e,t,n,i,s,r,o,a){const l=new EllipseCurve(e,t,n,i,s,r,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class LatheGeometry extends BufferGeometry{constructor(e=[new Vector2(0,.5),new Vector2(.5,0),new Vector2(0,-.5)],t=12,n=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=En(i,0,2*Math.PI);const s=[],r=[],o=[],a=[],l=[],c=1/t,d=new Vector3,u=new Vector2,h=new Vector3,p=new Vector3,m=new Vector3;let f=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:f=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,h.x=1*g,h.y=-f,h.z=0*g,m.copy(h),h.normalize(),a.push(h.x,h.y,h.z);break;case e.length-1:a.push(m.x,m.y,m.z);break;default:f=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,h.x=1*g,h.y=-f,h.z=0*g,p.copy(h),h.x+=m.x,h.y+=m.y,h.z+=m.z,h.normalize(),a.push(h.x,h.y,h.z),m.copy(p)}for(let s=0;s<=t;s++){const h=n+s*c*i,p=Math.sin(h),m=Math.cos(h);for(let n=0;n<=e.length-1;n++){d.x=e[n].x*p,d.y=e[n].y,d.z=e[n].x*m,r.push(d.x,d.y,d.z),u.x=s/t,u.y=n/(e.length-1),o.push(u.x,u.y);const i=a[3*n+0]*p,c=a[3*n+1],h=a[3*n+0]*m;l.push(i,c,h)}}for(let n=0;n<t;n++)for(let t=0;t<e.length-1;t++){const i=t+n*e.length,r=i,o=i+e.length,a=i+e.length+1,l=i+1;s.push(r,o,l),s.push(a,l,o)}this.setIndex(s),this.setAttribute("position",new Float32BufferAttribute(r,3)),this.setAttribute("uv",new Float32BufferAttribute(o,2)),this.setAttribute("normal",new Float32BufferAttribute(l,3))}static fromJSON(e){return new LatheGeometry(e.points,e.segments,e.phiStart,e.phiLength)}}class CapsuleGeometry extends LatheGeometry{constructor(e=1,t=1,n=4,i=8){const s=new Path;s.absarc(0,-t/2,e,1.5*Math.PI,0),s.absarc(0,t/2,e,0,.5*Math.PI),super(s.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new CapsuleGeometry(e.radius,e.length,e.capSegments,e.radialSegments)}}class CircleGeometry extends BufferGeometry{constructor(e=1,t=8,n=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const s=[],r=[],o=[],a=[],l=new Vector3,c=new Vector2;r.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let s=0,d=3;s<=t;s++,d+=3){const u=n+s/t*i;l.x=e*Math.cos(u),l.y=e*Math.sin(u),r.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(r[d]/e+1)/2,c.y=(r[d+1]/e+1)/2,a.push(c.x,c.y)}for(let e=1;e<=t;e++)s.push(e,e+1,0);this.setIndex(s),this.setAttribute("position",new Float32BufferAttribute(r,3)),this.setAttribute("normal",new Float32BufferAttribute(o,3)),this.setAttribute("uv",new Float32BufferAttribute(a,2))}static fromJSON(e){return new CircleGeometry(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class CylinderGeometry extends BufferGeometry{constructor(e=1,t=1,n=1,i=8,s=1,r=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:s,openEnded:r,thetaStart:o,thetaLength:a};const l=this;i=Math.floor(i),s=Math.floor(s);const c=[],d=[],u=[],h=[];let p=0;const m=[],f=n/2;let g=0;function v(n){const s=p,r=new Vector2,m=new Vector3;let v=0;const y=!0===n?e:t,b=!0===n?1:-1;for(let e=1;e<=i;e++)d.push(0,f*b,0),u.push(0,b,0),h.push(.5,.5),p++;const S=p;for(let e=0;e<=i;e++){const t=e/i*a+o,n=Math.cos(t),s=Math.sin(t);m.x=y*s,m.y=f*b,m.z=y*n,d.push(m.x,m.y,m.z),u.push(0,b,0),r.x=.5*n+.5,r.y=.5*s*b+.5,h.push(r.x,r.y),p++}for(let e=0;e<i;e++){const t=s+e,i=S+e;!0===n?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const r=new Vector3,v=new Vector3;let y=0;const b=(t-e)/n;for(let l=0;l<=s;l++){const c=[],g=l/s,y=g*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,s=t*a+o,l=Math.sin(s),m=Math.cos(s);v.x=y*l,v.y=-g*n+f,v.z=y*m,d.push(v.x,v.y,v.z),r.set(l,b,m).normalize(),u.push(r.x,r.y,r.z),h.push(t,1-g),c.push(p++)}m.push(c)}for(let e=0;e<i;e++)for(let t=0;t<s;t++){const n=m[t][e],i=m[t+1][e],s=m[t+1][e+1],r=m[t][e+1];c.push(n,i,r),c.push(i,s,r),y+=6}l.addGroup(g,y,0),g+=y}(),!1===r&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Float32BufferAttribute(d,3)),this.setAttribute("normal",new Float32BufferAttribute(u,3)),this.setAttribute("uv",new Float32BufferAttribute(h,2))}static fromJSON(e){return new CylinderGeometry(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ConeGeometry extends CylinderGeometry{constructor(e=1,t=1,n=8,i=1,s=!1,r=0,o=2*Math.PI){super(0,e,t,n,i,s,r,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:r,thetaLength:o}}static fromJSON(e){return new ConeGeometry(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class PolyhedronGeometry extends BufferGeometry{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const s=[],r=[];function o(e,t,n,i){const s=i+1,r=[];for(let i=0;i<=s;i++){r[i]=[];const o=e.clone().lerp(n,i/s),a=t.clone().lerp(n,i/s),l=s-i;for(let e=0;e<=l;e++)r[i][e]=0===e&&i===s?o:o.clone().lerp(a,e/l)}for(let e=0;e<s;e++)for(let t=0;t<2*(s-e)-1;t++){const n=Math.floor(t/2);t%2==0?(a(r[e][n+1]),a(r[e+1][n]),a(r[e][n])):(a(r[e][n+1]),a(r[e+1][n+1]),a(r[e+1][n]))}}function a(e){s.push(e.x,e.y,e.z)}function l(t,n){const i=3*t;n.x=e[i+0],n.y=e[i+1],n.z=e[i+2]}function c(e,t,n,i){i<0&&1===e.x&&(r[t]=e.x-1),0===n.x&&0===n.z&&(r[t]=i/2/Math.PI+.5)}function d(e){return Math.atan2(e.z,-e.x)}!function(e){const n=new Vector3,i=new Vector3,s=new Vector3;for(let r=0;r<t.length;r+=3)l(t[r+0],n),l(t[r+1],i),l(t[r+2],s),o(n,i,s,e)}(i),function(e){const t=new Vector3;for(let n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}(n),function(){const e=new Vector3;for(let n=0;n<s.length;n+=3){e.x=s[n+0],e.y=s[n+1],e.z=s[n+2];const i=d(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);r.push(i,1-o)}var t;(function(){const e=new Vector3,t=new Vector3,n=new Vector3,i=new Vector3,o=new Vector2,a=new Vector2,l=new Vector2;for(let u=0,h=0;u<s.length;u+=9,h+=6){e.set(s[u+0],s[u+1],s[u+2]),t.set(s[u+3],s[u+4],s[u+5]),n.set(s[u+6],s[u+7],s[u+8]),o.set(r[h+0],r[h+1]),a.set(r[h+2],r[h+3]),l.set(r[h+4],r[h+5]),i.copy(e).add(t).add(n).divideScalar(3);const p=d(i);c(o,h+0,e,p),c(a,h+2,t,p),c(l,h+4,n,p)}})(),function(){for(let e=0;e<r.length;e+=6){const t=r[e+0],n=r[e+2],i=r[e+4],s=Math.max(t,n,i),o=Math.min(t,n,i);s>.9&&o<.1&&(t<.2&&(r[e+0]+=1),n<.2&&(r[e+2]+=1),i<.2&&(r[e+4]+=1))}}()}(),this.setAttribute("position",new Float32BufferAttribute(s,3)),this.setAttribute("normal",new Float32BufferAttribute(s.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(r,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new PolyhedronGeometry(e.vertices,e.indices,e.radius,e.details)}}class DodecahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new DodecahedronGeometry(e.radius,e.detail)}}const Qa=new Vector3,Xa=new Vector3,Ja=new Vector3,el=new Triangle;class EdgesGeometry extends BufferGeometry{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,i=Math.pow(10,n),s=Math.cos(yn*t),r=e.getIndex(),o=e.getAttribute("position"),a=r?r.count:o.count,l=[0,0,0],c=["a","b","c"],d=new Array(3),u={},h=[];for(let e=0;e<a;e+=3){r?(l[0]=r.getX(e),l[1]=r.getX(e+1),l[2]=r.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:a}=el;if(t.fromBufferAttribute(o,l[0]),n.fromBufferAttribute(o,l[1]),a.fromBufferAttribute(o,l[2]),el.getNormal(Ja),d[0]=`${Math.round(t.x*i)},${Math.round(t.y*i)},${Math.round(t.z*i)}`,d[1]=`${Math.round(n.x*i)},${Math.round(n.y*i)},${Math.round(n.z*i)}`,d[2]=`${Math.round(a.x*i)},${Math.round(a.y*i)},${Math.round(a.z*i)}`,d[0]!==d[1]&&d[1]!==d[2]&&d[2]!==d[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=d[e],i=d[t],r=el[c[e]],o=el[c[t]],a=`${n}_${i}`,p=`${i}_${n}`;p in u&&u[p]?(Ja.dot(u[p].normal)<=s&&(h.push(r.x,r.y,r.z),h.push(o.x,o.y,o.z)),u[p]=null):a in u||(u[a]={index0:l[e],index1:l[t],normal:Ja.clone()})}}for(const e in u)if(u[e]){const{index0:t,index1:n}=u[e];Qa.fromBufferAttribute(o,t),Xa.fromBufferAttribute(o,n),h.push(Qa.x,Qa.y,Qa.z),h.push(Xa.x,Xa.y,Xa.z)}this.setAttribute("position",new Float32BufferAttribute(h,3))}}}class Shape extends Path{constructor(e){super(e),this.uuid=Sn(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new Path).fromJSON(n))}return this}}const tl=function(e,t,n=2){const i=t&&t.length,s=i?t[0]*n:e.length;let r=nl(e,0,s,n,!0);const o=[];if(!r||r.next===r.prev)return o;let a,l,c,d,u,h,p;if(i&&(r=function(e,t,n,i){const s=[];let r,o,a,l,c;for(r=0,o=t.length;r<o;r++)a=t[r]*i,l=r<o-1?t[r+1]*i:e.length,c=nl(e,a,l,i,!1),c===c.next&&(c.steiner=!0),s.push(pl(c));for(s.sort(cl),r=0;r<s.length;r++)dl(s[r],n),n=il(n,n.next);return n}(e,t,r,n)),e.length>80*n){a=c=e[0],l=d=e[1];for(let t=n;t<s;t+=n)u=e[t],h=e[t+1],u<a&&(a=u),h<l&&(l=h),u>c&&(c=u),h>d&&(d=h);p=Math.max(c-a,d-l),p=0!==p?1/p:0}return sl(r,o,n,a,l,p),o};function nl(e,t,n,i,s){let r,o;if(s===function(e,t,n,i){let s=0;for(let r=t,o=n-i;r<n;r+=i)s+=(e[o]-e[r])*(e[r+1]+e[o+1]),o=r;return s}(e,t,n,i)>0)for(r=t;r<n;r+=i)o=wl(r,e[r],e[r+1],o);else for(r=n-i;r>=t;r-=i)o=wl(r,e[r],e[r+1],o);return o&&vl(o,o.next)&&(xl(o),o=o.next),o}function il(e,t){if(!e)return e;t||(t=e);let n,i=e;do{if(n=!1,i.steiner||!vl(i,i.next)&&0!==gl(i.prev,i,i.next))i=i.next;else{if(xl(i),i=t=i.prev,i===i.next)break;n=!0}}while(n||i!==t);return t}function sl(e,t,n,i,s,r,o){if(!e)return;!o&&r&&function(e,t,n,i){let s=e;do{null===s.z&&(s.z=hl(s.x,s.y,t,n,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,function(e){let t,n,i,s,r,o,a,l,c=1;do{for(n=e,e=null,r=null,o=0;n;){for(o++,i=n,a=0,t=0;t<c&&(a++,i=i.nextZ,i);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(s=n,n=n.nextZ,a--):(s=i,i=i.nextZ,l--),r?r.nextZ=s:e=s,s.prevZ=r,r=s;n=i}r.nextZ=null,c*=2}while(o>1)}(s)}(e,i,s,r);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,r?ol(e,i,s,r):rl(e))t.push(a.i/n),t.push(e.i/n),t.push(l.i/n),xl(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?sl(e=al(il(e),t,n),t,n,i,s,r,2):2===o&&ll(e,t,n,i,s,r):sl(il(e),t,n,i,s,r,1);break}}function rl(e){const t=e.prev,n=e,i=e.next;if(gl(t,n,i)>=0)return!1;let s=e.next.next;for(;s!==e.prev;){if(ml(t.x,t.y,n.x,n.y,i.x,i.y,s.x,s.y)&&gl(s.prev,s,s.next)>=0)return!1;s=s.next}return!0}function ol(e,t,n,i){const s=e.prev,r=e,o=e.next;if(gl(s,r,o)>=0)return!1;const a=s.x<r.x?s.x<o.x?s.x:o.x:r.x<o.x?r.x:o.x,l=s.y<r.y?s.y<o.y?s.y:o.y:r.y<o.y?r.y:o.y,c=s.x>r.x?s.x>o.x?s.x:o.x:r.x>o.x?r.x:o.x,d=s.y>r.y?s.y>o.y?s.y:o.y:r.y>o.y?r.y:o.y,u=hl(a,l,t,n,i),h=hl(c,d,t,n,i);let p=e.prevZ,m=e.nextZ;for(;p&&p.z>=u&&m&&m.z<=h;){if(p!==e.prev&&p!==e.next&&ml(s.x,s.y,r.x,r.y,o.x,o.y,p.x,p.y)&&gl(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,m!==e.prev&&m!==e.next&&ml(s.x,s.y,r.x,r.y,o.x,o.y,m.x,m.y)&&gl(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&ml(s.x,s.y,r.x,r.y,o.x,o.y,p.x,p.y)&&gl(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=h;){if(m!==e.prev&&m!==e.next&&ml(s.x,s.y,r.x,r.y,o.x,o.y,m.x,m.y)&&gl(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function al(e,t,n){let i=e;do{const s=i.prev,r=i.next.next;!vl(s,r)&&yl(s,i,i.next,r)&&El(s,r)&&El(r,s)&&(t.push(s.i/n),t.push(i.i/n),t.push(r.i/n),xl(i),xl(i.next),i=e=r),i=i.next}while(i!==e);return il(i)}function ll(e,t,n,i,s,r){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&fl(o,e)){let a=Tl(o,e);return o=il(o,o.next),a=il(a,a.next),sl(o,t,n,i,s,r),void sl(a,t,n,i,s,r)}e=e.next}o=o.next}while(o!==e)}function cl(e,t){return e.x-t.x}function dl(e,t){if(t=function(e,t){let n=t;const i=e.x,s=e.y;let r,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){const e=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=i&&e>o){if(o=e,e===i){if(s===n.y)return n;if(s===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;const a=r,l=r.x,c=r.y;let d,u=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&ml(s<c?i:o,s,l,c,s<c?o:i,s,n.x,n.y)&&(d=Math.abs(s-n.y)/(i-n.x),El(n,e)&&(d<u||d===u&&(n.x>r.x||n.x===r.x&&ul(r,n)))&&(r=n,u=d)),n=n.next}while(n!==a);return r}(e,t)){const n=Tl(t,e);il(t,t.next),il(n,n.next)}}function ul(e,t){return gl(e.prev,e,t.prev)<0&&gl(t.next,e,e.next)<0}function hl(e,t,n,i,s){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*s)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*s)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function pl(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function ml(e,t,n,i,s,r,o,a){return(s-o)*(t-a)-(e-o)*(r-a)>=0&&(e-o)*(i-a)-(n-o)*(t-a)>=0&&(n-o)*(r-a)-(s-o)*(i-a)>=0}function fl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&yl(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(El(e,t)&&El(t,e)&&function(e,t){let n=e,i=!1;const s=(e.x+t.x)/2,r=(e.y+t.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&s<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(gl(e.prev,e,t.prev)||gl(e,t.prev,t))||vl(e,t)&&gl(e.prev,e,e.next)>0&&gl(t.prev,t,t.next)>0)}function gl(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function vl(e,t){return e.x===t.x&&e.y===t.y}function yl(e,t,n,i){const s=Sl(gl(e,t,n)),r=Sl(gl(e,t,i)),o=Sl(gl(n,i,e)),a=Sl(gl(n,i,t));return s!==r&&o!==a||(!(0!==s||!bl(e,n,t))||(!(0!==r||!bl(e,i,t))||(!(0!==o||!bl(n,e,i))||!(0!==a||!bl(n,t,i)))))}function bl(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Sl(e){return e>0?1:e<0?-1:0}function El(e,t){return gl(e.prev,e,e.next)<0?gl(e,t,e.next)>=0&&gl(e,e.prev,t)>=0:gl(e,t,e.prev)<0||gl(e,e.next,t)<0}function Tl(e,t){const n=new _l(e.i,e.x,e.y),i=new _l(t.i,t.x,t.y),s=e.next,r=t.prev;return e.next=t,t.prev=e,n.next=s,s.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function wl(e,t,n,i){const s=new _l(e,t,n);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function xl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function _l(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class ShapeUtils{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return.5*n}static isClockWise(e){return ShapeUtils.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];Ml(e),Ol(n,e);let r=e.length;t.forEach(Ml);for(let e=0;e<t.length;e++)i.push(r),r+=t[e].length,Ol(n,t[e]);const o=tl(n,i);for(let e=0;e<o.length;e+=3)s.push(o.slice(e,e+3));return s}}function Ml(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Ol(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class ExtrudeGeometry extends BufferGeometry{constructor(e=new Shape([new Vector2(.5,.5),new Vector2(-.5,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let t=0,n=e.length;t<n;t++){r(e[t])}function r(e){const r=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:1,c=void 0===t.bevelEnabled||t.bevelEnabled,d=void 0!==t.bevelThickness?t.bevelThickness:.2,u=void 0!==t.bevelSize?t.bevelSize:d-.1,h=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3;const m=t.extrudePath,f=void 0!==t.UVGenerator?t.UVGenerator:Al;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let g,v,y,b,S,E=!1;m&&(g=m.getSpacedPoints(a),E=!0,c=!1,v=m.computeFrenetFrames(a,!1),y=new Vector3,b=new Vector3,S=new Vector3),c||(p=0,d=0,u=0,h=0);const T=e.extractPoints(o);let w=T.shape;const x=T.holes;if(!ShapeUtils.isClockWise(w)){w=w.reverse();for(let e=0,t=x.length;e<t;e++){const t=x[e];ShapeUtils.isClockWise(t)&&(x[e]=t.reverse())}}const _=ShapeUtils.triangulateShape(w,x),M=w;for(let e=0,t=x.length;e<t;e++){const t=x[e];w=w.concat(t)}function O(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}const A=w.length,C=_.length;function N(e,t,n){let i,s,r;const o=e.x-t.x,a=e.y-t.y,l=n.x-e.x,c=n.y-e.y,d=o*o+a*a,u=o*c-a*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(d),h=Math.sqrt(l*l+c*c),p=t.x-a/u,m=t.y+o/u,f=((n.x-c/h-p)*c-(n.y+l/h-m)*l)/(o*c-a*l);i=p+o*f-e.x,s=m+a*f-e.y;const g=i*i+s*s;if(g<=2)return new Vector2(i,s);r=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(i=-a,s=o,r=Math.sqrt(d)):(i=o,s=a,r=Math.sqrt(d/2))}return new Vector2(i/r,s/r)}const D=[];for(let e=0,t=M.length,n=t-1,i=e+1;e<t;e++,n++,i++)n===t&&(n=0),i===t&&(i=0),D[e]=N(M[e],M[n],M[i]);const I=[];let L,P=D.concat();for(let e=0,t=x.length;e<t;e++){const t=x[e];L=[];for(let e=0,n=t.length,i=n-1,s=e+1;e<n;e++,i++,s++)i===n&&(i=0),s===n&&(s=0),L[e]=N(t[e],t[i],t[s]);I.push(L),P=P.concat(L)}for(let e=0;e<p;e++){const t=e/p,n=d*Math.cos(t*Math.PI/2),i=u*Math.sin(t*Math.PI/2)+h;for(let e=0,t=M.length;e<t;e++){const t=O(M[e],D[e],i);U(t.x,t.y,-n)}for(let e=0,t=x.length;e<t;e++){const t=x[e];L=I[e];for(let e=0,s=t.length;e<s;e++){const s=O(t[e],L[e],i);U(s.x,s.y,-n)}}}const R=u+h;for(let e=0;e<A;e++){const t=c?O(w[e],P[e],R):w[e];E?(b.copy(v.normals[0]).multiplyScalar(t.x),y.copy(v.binormals[0]).multiplyScalar(t.y),S.copy(g[0]).add(b).add(y),U(S.x,S.y,S.z)):U(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<A;t++){const n=c?O(w[t],P[t],R):w[t];E?(b.copy(v.normals[e]).multiplyScalar(n.x),y.copy(v.binormals[e]).multiplyScalar(n.y),S.copy(g[e]).add(b).add(y),U(S.x,S.y,S.z)):U(n.x,n.y,l/a*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=d*Math.cos(t*Math.PI/2),i=u*Math.sin(t*Math.PI/2)+h;for(let e=0,t=M.length;e<t;e++){const t=O(M[e],D[e],i);U(t.x,t.y,l+n)}for(let e=0,t=x.length;e<t;e++){const t=x[e];L=I[e];for(let e=0,s=t.length;e<s;e++){const s=O(t[e],L[e],i);E?U(s.x,s.y+g[a-1].y,g[a-1].x+n):U(s.x,s.y,l+n)}}}function k(e,t){let n=e.length;for(;--n>=0;){const i=n;let s=n-1;s<0&&(s=e.length-1);for(let e=0,n=a+2*p;e<n;e++){const n=A*e,r=A*(e+1);F(t+i+n,t+s+n,t+s+r,t+i+r)}}}function U(e,t,n){r.push(e),r.push(t),r.push(n)}function B(e,t,s){V(e),V(t),V(s);const r=i.length/3,o=f.generateTopUV(n,i,r-3,r-2,r-1);H(o[0]),H(o[1]),H(o[2])}function F(e,t,s,r){V(e),V(t),V(r),V(t),V(s),V(r);const o=i.length/3,a=f.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);H(a[0]),H(a[1]),H(a[3]),H(a[1]),H(a[2]),H(a[3])}function V(e){i.push(r[3*e+0]),i.push(r[3*e+1]),i.push(r[3*e+2])}function H(e){s.push(e.x),s.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=A*e;for(let e=0;e<C;e++){const n=_[e];B(n[2]+t,n[1]+t,n[0]+t)}e=a+2*p,t=A*e;for(let e=0;e<C;e++){const n=_[e];B(n[0]+t,n[1]+t,n[2]+t)}}else{for(let e=0;e<C;e++){const t=_[e];B(t[2],t[1],t[0])}for(let e=0;e<C;e++){const t=_[e];B(t[0]+A*a,t[1]+A*a,t[2]+A*a)}}n.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;k(M,t),t+=M.length;for(let e=0,n=x.length;e<n;e++){const n=x[e];k(n,t),t+=n.length}n.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new Float32BufferAttribute(i,3)),this.setAttribute("uv",new Float32BufferAttribute(s,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let t=0,i=e.length;t<i;t++){const i=e[t];n.shapes.push(i.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const s=t[e.shapes[i]];n.push(s)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new $a[i.type]).fromJSON(i)),new ExtrudeGeometry(n,e.options)}}const Al={generateTopUV:function(e,t,n,i,s){const r=t[3*n],o=t[3*n+1],a=t[3*i],l=t[3*i+1],c=t[3*s],d=t[3*s+1];return[new Vector2(r,o),new Vector2(a,l),new Vector2(c,d)]},generateSideWallUV:function(e,t,n,i,s,r){const o=t[3*n],a=t[3*n+1],l=t[3*n+2],c=t[3*i],d=t[3*i+1],u=t[3*i+2],h=t[3*s],p=t[3*s+1],m=t[3*s+2],f=t[3*r],g=t[3*r+1],v=t[3*r+2];return Math.abs(a-d)<Math.abs(o-c)?[new Vector2(o,1-l),new Vector2(c,1-u),new Vector2(h,1-m),new Vector2(f,1-v)]:[new Vector2(a,1-l),new Vector2(d,1-u),new Vector2(p,1-m),new Vector2(g,1-v)]}};class IcosahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new IcosahedronGeometry(e.radius,e.detail)}}class OctahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new OctahedronGeometry(e.radius,e.detail)}}class RingGeometry extends BufferGeometry{constructor(e=.5,t=1,n=8,i=1,s=0,r=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:s,thetaLength:r},n=Math.max(3,n);const o=[],a=[],l=[],c=[];let d=e;const u=(t-e)/(i=Math.max(1,i)),h=new Vector3,p=new Vector2;for(let e=0;e<=i;e++){for(let e=0;e<=n;e++){const i=s+e/n*r;h.x=d*Math.cos(i),h.y=d*Math.sin(i),a.push(h.x,h.y,h.z),l.push(0,0,1),p.x=(h.x/t+1)/2,p.y=(h.y/t+1)/2,c.push(p.x,p.y)}d+=u}for(let e=0;e<i;e++){const t=e*(n+1);for(let e=0;e<n;e++){const i=e+t,s=i,r=i+n+1,a=i+n+2,l=i+1;o.push(s,r,l),o.push(r,a,l)}}this.setIndex(o),this.setAttribute("position",new Float32BufferAttribute(a,3)),this.setAttribute("normal",new Float32BufferAttribute(l,3)),this.setAttribute("uv",new Float32BufferAttribute(c,2))}static fromJSON(e){return new RingGeometry(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ShapeGeometry extends BufferGeometry{constructor(e=new Shape([new Vector2(0,.5),new Vector2(-.5,-.5),new Vector2(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],r=[];let o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,a,t),o+=a,a=0;function l(e){const o=i.length/3,l=e.extractPoints(t);let c=l.shape;const d=l.holes;!1===ShapeUtils.isClockWise(c)&&(c=c.reverse());for(let e=0,t=d.length;e<t;e++){const t=d[e];!0===ShapeUtils.isClockWise(t)&&(d[e]=t.reverse())}const u=ShapeUtils.triangulateShape(c,d);for(let e=0,t=d.length;e<t;e++){const t=d[e];c=c.concat(t)}for(let e=0,t=c.length;e<t;e++){const t=c[e];i.push(t.x,t.y,0),s.push(0,0,1),r.push(t.x,t.y)}for(let e=0,t=u.length;e<t;e++){const t=u[e],i=t[0]+o,s=t[1]+o,r=t[2]+o;n.push(i,s,r),a+=3}}this.setIndex(n),this.setAttribute("position",new Float32BufferAttribute(i,3)),this.setAttribute("normal",new Float32BufferAttribute(s,3)),this.setAttribute("uv",new Float32BufferAttribute(r,2))}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,i=e.length;n<i;n++){const i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const s=t[e.shapes[i]];n.push(s)}return new ShapeGeometry(n,e.curveSegments)}}class SphereGeometry extends BufferGeometry{constructor(e=1,t=32,n=16,i=0,s=2*Math.PI,r=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:r,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const a=Math.min(r+o,Math.PI);let l=0;const c=[],d=new Vector3,u=new Vector3,h=[],p=[],m=[],f=[];for(let h=0;h<=n;h++){const g=[],v=h/n;let y=0;0==h&&0==r?y=.5/t:h==n&&a==Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const a=n/t;d.x=-e*Math.cos(i+a*s)*Math.sin(r+v*o),d.y=e*Math.cos(r+v*o),d.z=e*Math.sin(i+a*s)*Math.sin(r+v*o),p.push(d.x,d.y,d.z),u.copy(d).normalize(),m.push(u.x,u.y,u.z),f.push(a+y,1-v),g.push(l++)}c.push(g)}for(let e=0;e<n;e++)for(let i=0;i<t;i++){const t=c[e][i+1],s=c[e][i],o=c[e+1][i],l=c[e+1][i+1];(0!==e||r>0)&&h.push(t,s,l),(e!==n-1||a<Math.PI)&&h.push(s,o,l)}this.setIndex(h),this.setAttribute("position",new Float32BufferAttribute(p,3)),this.setAttribute("normal",new Float32BufferAttribute(m,3)),this.setAttribute("uv",new Float32BufferAttribute(f,2))}static fromJSON(e){return new SphereGeometry(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class TetrahedronGeometry extends PolyhedronGeometry{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new TetrahedronGeometry(e.radius,e.detail)}}class TorusGeometry extends BufferGeometry{constructor(e=1,t=.4,n=8,i=6,s=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:s},n=Math.floor(n),i=Math.floor(i);const r=[],o=[],a=[],l=[],c=new Vector3,d=new Vector3,u=new Vector3;for(let r=0;r<=n;r++)for(let h=0;h<=i;h++){const p=h/i*s,m=r/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(p),d.y=(e+t*Math.cos(m))*Math.sin(p),d.z=t*Math.sin(m),o.push(d.x,d.y,d.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),u.subVectors(d,c).normalize(),a.push(u.x,u.y,u.z),l.push(h/i),l.push(r/n)}for(let e=1;e<=n;e++)for(let t=1;t<=i;t++){const n=(i+1)*e+t-1,s=(i+1)*(e-1)+t-1,o=(i+1)*(e-1)+t,a=(i+1)*e+t;r.push(n,s,a),r.push(s,o,a)}this.setIndex(r),this.setAttribute("position",new Float32BufferAttribute(o,3)),this.setAttribute("normal",new Float32BufferAttribute(a,3)),this.setAttribute("uv",new Float32BufferAttribute(l,2))}static fromJSON(e){return new TorusGeometry(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class TorusKnotGeometry extends BufferGeometry{constructor(e=1,t=.4,n=64,i=8,s=2,r=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:s,q:r},n=Math.floor(n),i=Math.floor(i);const o=[],a=[],l=[],c=[],d=new Vector3,u=new Vector3,h=new Vector3,p=new Vector3,m=new Vector3,f=new Vector3,g=new Vector3;for(let o=0;o<=n;++o){const y=o/n*s*Math.PI*2;v(y,s,r,e,h),v(y+.01,s,r,e,p),f.subVectors(p,h),g.addVectors(p,h),m.crossVectors(f,g),g.crossVectors(m,f),m.normalize(),g.normalize();for(let e=0;e<=i;++e){const s=e/i*Math.PI*2,r=-t*Math.cos(s),p=t*Math.sin(s);d.x=h.x+(r*g.x+p*m.x),d.y=h.y+(r*g.y+p*m.y),d.z=h.z+(r*g.z+p*m.z),a.push(d.x,d.y,d.z),u.subVectors(d,h).normalize(),l.push(u.x,u.y,u.z),c.push(o/n),c.push(e/i)}}for(let e=1;e<=n;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),s=(i+1)*e+(t-1),r=(i+1)*e+t,a=(i+1)*(e-1)+t;o.push(n,s,a),o.push(s,r,a)}function v(e,t,n,i,s){const r=Math.cos(e),o=Math.sin(e),a=n/t*e,l=Math.cos(a);s.x=i*(2+l)*.5*r,s.y=i*(2+l)*o*.5,s.z=i*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new Float32BufferAttribute(a,3)),this.setAttribute("normal",new Float32BufferAttribute(l,3)),this.setAttribute("uv",new Float32BufferAttribute(c,2))}static fromJSON(e){return new TorusKnotGeometry(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class TubeGeometry extends BufferGeometry{constructor(e=new QuadraticBezierCurve3(new Vector3(-1,-1,0),new Vector3(-1,1,0),new Vector3(1,1,0)),t=64,n=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:s};const r=e.computeFrenetFrames(t,s);this.tangents=r.tangents,this.normals=r.normals,this.binormals=r.binormals;const o=new Vector3,a=new Vector3,l=new Vector2;let c=new Vector3;const d=[],u=[],h=[],p=[];function m(s){c=e.getPointAt(s/t,c);const l=r.normals[s],h=r.binormals[s];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,s=Math.sin(t),r=-Math.cos(t);a.x=r*l.x+s*h.x,a.y=r*l.y+s*h.y,a.z=r*l.z+s*h.z,a.normalize(),u.push(a.x,a.y,a.z),o.x=c.x+n*a.x,o.y=c.y+n*a.y,o.z=c.z+n*a.z,d.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)m(e);m(!1===s?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=i;n++)l.x=e/t,l.y=n/i,h.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const n=(i+1)*(e-1)+(t-1),s=(i+1)*e+(t-1),r=(i+1)*e+t,o=(i+1)*(e-1)+t;p.push(n,s,o),p.push(s,r,o)}}()}(),this.setIndex(p),this.setAttribute("position",new Float32BufferAttribute(d,3)),this.setAttribute("normal",new Float32BufferAttribute(u,3)),this.setAttribute("uv",new Float32BufferAttribute(h,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new TubeGeometry((new $a[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class WireframeGeometry extends BufferGeometry{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,i=new Vector3,s=new Vector3;if(null!==e.index){const r=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let a=0;a<3;a++){const l=o.getX(e+a),c=o.getX(e+(a+1)%3);i.fromBufferAttribute(r,l),s.fromBufferAttribute(r,c),!0===Cl(i,s,n)&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const r=e.attributes.position;for(let e=0,o=r.count/3;e<o;e++)for(let o=0;o<3;o++){const a=3*e+o,l=3*e+(o+1)%3;i.fromBufferAttribute(r,a),s.fromBufferAttribute(r,l),!0===Cl(i,s,n)&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Float32BufferAttribute(t,3))}}}function Cl(e,t,n){const i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,s=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==n.has(i)&&!0!==n.has(s)&&(n.add(i),n.add(s),!0)}var Nl=Object.freeze({__proto__:null,BoxGeometry:BoxGeometry,BoxBufferGeometry:BoxGeometry,CapsuleGeometry:CapsuleGeometry,CapsuleBufferGeometry:CapsuleGeometry,CircleGeometry:CircleGeometry,CircleBufferGeometry:CircleGeometry,ConeGeometry:ConeGeometry,ConeBufferGeometry:ConeGeometry,CylinderGeometry:CylinderGeometry,CylinderBufferGeometry:CylinderGeometry,DodecahedronGeometry:DodecahedronGeometry,DodecahedronBufferGeometry:DodecahedronGeometry,EdgesGeometry:EdgesGeometry,ExtrudeGeometry:ExtrudeGeometry,ExtrudeBufferGeometry:ExtrudeGeometry,IcosahedronGeometry:IcosahedronGeometry,IcosahedronBufferGeometry:IcosahedronGeometry,LatheGeometry:LatheGeometry,LatheBufferGeometry:LatheGeometry,OctahedronGeometry:OctahedronGeometry,OctahedronBufferGeometry:OctahedronGeometry,PlaneGeometry:PlaneGeometry,PlaneBufferGeometry:PlaneGeometry,PolyhedronGeometry:PolyhedronGeometry,PolyhedronBufferGeometry:PolyhedronGeometry,RingGeometry:RingGeometry,RingBufferGeometry:RingGeometry,ShapeGeometry:ShapeGeometry,ShapeBufferGeometry:ShapeGeometry,SphereGeometry:SphereGeometry,SphereBufferGeometry:SphereGeometry,TetrahedronGeometry:TetrahedronGeometry,TetrahedronBufferGeometry:TetrahedronGeometry,TorusGeometry:TorusGeometry,TorusBufferGeometry:TorusGeometry,TorusKnotGeometry:TorusKnotGeometry,TorusKnotBufferGeometry:TorusKnotGeometry,TubeGeometry:TubeGeometry,TubeBufferGeometry:TubeGeometry,WireframeGeometry:WireframeGeometry});class ShadowMaterial extends Material{constructor(e){super(),this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}ShadowMaterial.prototype.isShadowMaterial=!0;class RawShaderMaterial extends ShaderMaterial{constructor(e){super(e),this.type="RawShaderMaterial"}}RawShaderMaterial.prototype.isRawShaderMaterial=!0;class MeshStandardMaterial extends Material{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kt,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}MeshStandardMaterial.prototype.isMeshStandardMaterial=!0;class MeshPhysicalMaterial extends MeshStandardMaterial{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return En(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new Color(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Color(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Color(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0;class MeshPhongMaterial extends Material{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kt,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}MeshPhongMaterial.prototype.isMeshPhongMaterial=!0;class MeshToonMaterial extends Material{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kt,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}MeshToonMaterial.prototype.isMeshToonMaterial=!0;class MeshNormalMaterial extends Material{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kt,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}MeshNormalMaterial.prototype.isMeshNormalMaterial=!0;class MeshLambertMaterial extends Material{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Z,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}MeshLambertMaterial.prototype.isMeshLambertMaterial=!0;class MeshMatcapMaterial extends Material{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kt,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0;class LineDashedMaterial extends LineBasicMaterial{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}LineDashedMaterial.prototype.isLineDashedMaterial=!0;const Dl={ShadowMaterial:ShadowMaterial,SpriteMaterial:SpriteMaterial,RawShaderMaterial:RawShaderMaterial,ShaderMaterial:ShaderMaterial,PointsMaterial:PointsMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshToonMaterial:MeshToonMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshBasicMaterial:MeshBasicMaterial,MeshMatcapMaterial:MeshMatcapMaterial,LineDashedMaterial:LineDashedMaterial,LineBasicMaterial:LineBasicMaterial,Material:Material};Material.fromType=function(e){return new Dl[e]};const Il={arraySlice:function(e,t,n){return Il.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,n=new Array(t);for(let e=0;e!==t;++e)n[e]=e;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){const i=e.length,s=new e.constructor(i);for(let r=0,o=0;o!==i;++r){const i=n[r]*t;for(let n=0;n!==t;++n)s[o++]=e[i+n]}return s},flattenJSON:function(e,t,n,i){let s=1,r=e[0];for(;void 0!==r&&void 0===r[i];)r=e[s++];if(void 0===r)return;let o=r[i];if(void 0!==o)if(Array.isArray(o))do{o=r[i],void 0!==o&&(t.push(r.time),n.push.apply(n,o)),r=e[s++]}while(void 0!==r);else if(void 0!==o.toArray)do{o=r[i],void 0!==o&&(t.push(r.time),o.toArray(n,n.length)),r=e[s++]}while(void 0!==r);else do{o=r[i],void 0!==o&&(t.push(r.time),n.push(o)),r=e[s++]}while(void 0!==r)},subclip:function(e,t,n,i,s=30){const r=e.clone();r.name=t;const o=[];for(let e=0;e<r.tracks.length;++e){const t=r.tracks[e],a=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){const r=t.times[e]*s;if(!(r<n||r>=i)){l.push(t.times[e]);for(let n=0;n<a;++n)c.push(t.values[e*a+n])}}0!==l.length&&(t.times=Il.convertArray(l,t.times.constructor),t.values=Il.convertArray(c,t.values.constructor),o.push(t))}r.tracks=o;let a=1/0;for(let e=0;e<r.tracks.length;++e)a>r.tracks[e].times[0]&&(a=r.tracks[e].times[0]);for(let e=0;e<r.tracks.length;++e)r.tracks[e].shift(-1*a);return r.resetDuration(),r},makeClipAdditive:function(e,t=0,n=e,i=30){i<=0&&(i=30);const s=n.tracks.length,r=t/i;for(let t=0;t<s;++t){const i=n.tracks[t],s=i.ValueTypeName;if("bool"===s||"string"===s)continue;const o=e.tracks.find((function(e){return e.name===i.name&&e.ValueTypeName===s}));if(void 0===o)continue;let a=0;const l=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const d=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=d/3);const u=i.times.length-1;let h;if(r<=i.times[0]){const e=a,t=l-a;h=Il.arraySlice(i.values,e,t)}else if(r>=i.times[u]){const e=u*l+a,t=e+l-a;h=Il.arraySlice(i.values,e,t)}else{const e=i.createInterpolant(),t=a,n=l-a;e.evaluate(r),h=Il.arraySlice(e.resultBuffer,t,n)}if("quaternion"===s){(new Quaternion).fromArray(h).normalize().conjugate().toArray(h)}const p=o.times.length;for(let e=0;e<p;++e){const t=e*d+c;if("quaternion"===s)Quaternion.multiplyQuaternionsFlat(o.values,t,h,0,o.values,t);else{const e=d-2*c;for(let n=0;n<e;++n)o.values[t+n]-=h[n]}}}return e.blendMode=At,e}};class Interpolant{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let r;n:{i:if(!(e<i)){for(let r=n+2;;){if(void 0===i){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,s)}if(n===r)break;if(s=i,i=t[++n],e<i)break t}r=t.length;break n}if(e>=s)break e;{const o=t[1];e<o&&(n=2,s=o);for(let r=n-2;;){if(void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===r)break;if(i=s,s=t[--n-1],e>=s)break t}r=n,n=0}}for(;n<r;){const i=n+r>>>1;e<t[i]?r=i:n=i+1}if(i=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,s,e)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let e=0;e!==i;++e)t[e]=n[s+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Interpolant.prototype.beforeStart_=Interpolant.prototype.copySampleValue_,Interpolant.prototype.afterEnd_=Interpolant.prototype.copySampleValue_;class CubicInterpolant extends Interpolant{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:xt,endingEnd:xt}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,r=e+1,o=i[s],a=i[r];if(void 0===o)switch(this.getSettings_().endingStart){case _t:s=e,o=2*t-n;break;case Mt:s=i.length-2,o=t+i[s]-i[s+1];break;default:s=e,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case _t:r=e,a=2*n-t;break;case Mt:r=1,a=n+i[1]-i[0];break;default:r=e-1,a=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-n),this._offsetPrev=s*c,this._offsetNext=r*c}interpolate_(e,t,n,i){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,d=this._offsetNext,u=this._weightPrev,h=this._weightNext,p=(n-t)/(i-t),m=p*p,f=m*p,g=-u*f+2*u*m-u*p,v=(1+u)*f+(-1.5-2*u)*m+(-.5+u)*p+1,y=(-1-h)*f+(1.5+h)*m+.5*p,b=h*f-h*m;for(let e=0;e!==o;++e)s[e]=g*r[c+e]+v*r[l+e]+y*r[a+e]+b*r[d+e];return s}}class LinearInterpolant extends Interpolant{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(n-t)/(i-t),d=1-c;for(let e=0;e!==o;++e)s[e]=r[l+e]*d+r[a+e]*c;return s}}class DiscreteInterpolant extends Interpolant{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class KeyframeTrack{constructor(e,t,n,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Il.convertArray(t,this.TimeBufferType),this.values=Il.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Il.convertArray(e.times,Array),values:Il.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Et:t=this.InterpolantFactoryMethodDiscrete;break;case Tt:t=this.InterpolantFactoryMethodLinear;break;case wt:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Et;case this.InterpolantFactoryMethodLinear:return Tt;case this.InterpolantFactoryMethodSmooth:return wt}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,r=i-1;for(;s!==i&&n[s]<e;)++s;for(;-1!==r&&n[r]>t;)--r;if(++r,0!==s||r!==i){s>=r&&(r=Math.max(r,1),s=r-1);const e=this.getValueSize();this.times=Il.arraySlice(n,s,r),this.values=Il.arraySlice(this.values,s*e,r*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let r=null;for(let t=0;t!==s;t++){const i=n[t];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,i),e=!1;break}if(null!==r&&r>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,i,r),e=!1;break}r=i}if(void 0!==i&&Il.isTypedArray(i))for(let t=0,n=i.length;t!==n;++t){const n=i[t];if(isNaN(n)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,n),e=!1;break}}return e}optimize(){const e=Il.arraySlice(this.times),t=Il.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===wt,s=e.length-1;let r=1;for(let o=1;o<s;++o){let s=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)s=!0;else{const e=o*n,i=e-n,r=e+n;for(let o=0;o!==n;++o){const n=t[e+o];if(n!==t[i+o]||n!==t[r+o]){s=!0;break}}}if(s){if(o!==r){e[r]=e[o];const i=o*n,s=r*n;for(let e=0;e!==n;++e)t[s+e]=t[i+e]}++r}}if(s>0){e[r]=e[s];for(let e=s*n,i=r*n,o=0;o!==n;++o)t[i+o]=t[e+o];++r}return r!==e.length?(this.times=Il.arraySlice(e,0,r),this.values=Il.arraySlice(t,0,r*n)):(this.times=e,this.values=t),this}clone(){const e=Il.arraySlice(this.times,0),t=Il.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}KeyframeTrack.prototype.TimeBufferType=Float32Array,KeyframeTrack.prototype.ValueBufferType=Float32Array,KeyframeTrack.prototype.DefaultInterpolation=Tt;class BooleanKeyframeTrack extends KeyframeTrack{}BooleanKeyframeTrack.prototype.ValueTypeName="bool",BooleanKeyframeTrack.prototype.ValueBufferType=Array,BooleanKeyframeTrack.prototype.DefaultInterpolation=Et,BooleanKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0,BooleanKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class ColorKeyframeTrack extends KeyframeTrack{}ColorKeyframeTrack.prototype.ValueTypeName="color";class NumberKeyframeTrack extends KeyframeTrack{}NumberKeyframeTrack.prototype.ValueTypeName="number";class QuaternionLinearInterpolant extends Interpolant{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=(n-t)/(i-t);let l=e*o;for(let e=l+o;l!==e;l+=4)Quaternion.slerpFlat(s,0,r,l-o,r,l,a);return s}}class QuaternionKeyframeTrack extends KeyframeTrack{InterpolantFactoryMethodLinear(e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)}}QuaternionKeyframeTrack.prototype.ValueTypeName="quaternion",QuaternionKeyframeTrack.prototype.DefaultInterpolation=Tt,QuaternionKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class StringKeyframeTrack extends KeyframeTrack{}StringKeyframeTrack.prototype.ValueTypeName="string",StringKeyframeTrack.prototype.ValueBufferType=Array,StringKeyframeTrack.prototype.DefaultInterpolation=Et,StringKeyframeTrack.prototype.InterpolantFactoryMethodLinear=void 0,StringKeyframeTrack.prototype.InterpolantFactoryMethodSmooth=void 0;class VectorKeyframeTrack extends KeyframeTrack{}VectorKeyframeTrack.prototype.ValueTypeName="vector";class AnimationClip{constructor(e,t=-1,n,i=Ot){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Sn(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let e=0,s=n.length;e!==s;++e)t.push(Ll(n[e]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,i=n.length;e!==i;++e)t.push(KeyframeTrack.toJSON(n[e]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,r=[];for(let e=0;e<s;e++){let o=[],a=[];o.push((e+s-1)%s,e,(e+1)%s),a.push(0,1,0);const l=Il.getKeyframeOrder(o);o=Il.sortedArray(o,1,l),a=Il.sortedArray(a,1,l),i||0!==o[0]||(o.push(s),a.push(a[0])),r.push(new NumberKeyframeTrack(".morphTargetInfluences["+t[e].name+"]",o,a).scale(1/n))}return new this(e,-1,r)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<n.length;e++)if(n[e].name===t)return n[e];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let t=0,n=e.length;t<n;t++){const n=e[t],r=n.name.match(s);if(r&&r.length>1){const e=r[1];let t=i[e];t||(i[e]=t=[]),t.push(n)}}const r=[];for(const e in i)r.push(this.CreateFromMorphTargetSequence(e,i[e],t,n));return r}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,i,s){if(0!==n.length){const r=[],o=[];Il.flattenJSON(n,r,o,i),0!==r.length&&s.push(new e(t,r,o))}},i=[],s=e.name||"default",r=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const s=l[e].keys;if(s&&0!==s.length)if(s[0].morphTargets){const e={};let t;for(t=0;t<s.length;t++)if(s[t].morphTargets)for(let n=0;n<s[t].morphTargets.length;n++)e[s[t].morphTargets[n]]=-1;for(const n in e){const e=[],r=[];for(let i=0;i!==s[t].morphTargets.length;++i){const i=s[t];e.push(i.time),r.push(i.morphTarget===n?1:0)}i.push(new NumberKeyframeTrack(".morphTargetInfluence["+n+"]",e,r))}a=e.length*r}else{const r=".bones["+t[e].name+"]";n(VectorKeyframeTrack,r+".position",s,"pos",i),n(QuaternionKeyframeTrack,r+".quaternion",s,"rot",i),n(VectorKeyframeTrack,r+".scale",s,"scl",i)}}if(0===i.length)return null;return new this(s,a,i,o)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ll(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];Il.flattenJSON(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const Pl={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class LoadingManager{constructor(e,t,n){const i=this;let s,r=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){a++,!1===r&&void 0!==i.onStart&&i.onStart(e,o,a),r=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(r=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],i=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return i}return null}}}const Rl=new LoadingManager;class Loader{constructor(e){this.manager=void 0!==e?e:Rl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise((function(i,s){n.load(e,i,t,s)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const kl={};class FileLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Pl.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout((()=>{t&&t(s),this.manager.itemEnd(e)}),0),s;if(void 0!==kl[e])return void kl[e].push({onLoad:t,onProgress:n,onError:i});kl[e]=[],kl[e].push({onLoad:t,onProgress:n,onError:i});const r=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(r).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=kl[e],i=t.body.getReader(),s=t.headers.get("Content-Length"),r=s?parseInt(s):0,o=0!==r;let a=0;const l=new ReadableStream({start(e){!function t(){i.read().then((({done:i,value:s})=>{if(i)e.close();else{a+=s.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:r});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(i)}e.enqueue(s),t()}}))}()}});return new Response(l)}throw Error(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),n=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(n);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{Pl.add(e,t);const n=kl[e];delete kl[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const n=kl[e];if(void 0===n)throw this.manager.itemError(e),t;delete kl[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class AnimationLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=this,r=new FileLoader(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(function(n){try{t(s.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),s.manager.itemError(e)}}),n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=AnimationClip.parse(e[n]);t.push(i)}return t}}class CompressedTextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=this,r=[],o=new CompressedTexture,a=new FileLoader(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(s.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const n=s.parse(e,!0);r[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(o.minFilter=ye),o.image=r,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,i)}if(Array.isArray(e))for(let t=0,n=e.length;t<n;++t)c(t);else a.load(e,(function(e){const n=s.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){r[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)r[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),r[t].format=n.format,r[t].width=n.width,r[t].height=n.height}o.image=r}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=ye),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,i);return o}}class ImageLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,r=Pl.get(e);if(void 0!==r)return s.manager.itemStart(e),setTimeout((function(){t&&t(r),s.manager.itemEnd(e)}),0),r;const o=Dn("img");function a(){c(),Pl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(t){c(),i&&i(t),s.manager.itemError(e),s.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class CubeTextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=new CubeTexture,r=new ImageLoader(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);let o=0;function a(n){r.load(e[n],(function(e){s.images[n]=e,o++,6===o&&(s.needsUpdate=!0,t&&t(s))}),void 0,i)}for(let t=0;t<e.length;++t)a(t);return s}}class DataTextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=this,r=new DataTexture,o=new FileLoader(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,(function(e){const n=s.parse(e);n&&(void 0!==n.image?r.image=n.image:void 0!==n.data&&(r.image.width=n.width,r.image.height=n.height,r.image.data=n.data),r.wrapS=void 0!==n.wrapS?n.wrapS:ue,r.wrapT=void 0!==n.wrapT?n.wrapT:ue,r.magFilter=void 0!==n.magFilter?n.magFilter:ye,r.minFilter=void 0!==n.minFilter?n.minFilter:ye,r.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(r.encoding=n.encoding),void 0!==n.flipY&&(r.flipY=n.flipY),void 0!==n.format&&(r.format=n.format),void 0!==n.type&&(r.type=n.type),void 0!==n.mipmaps&&(r.mipmaps=n.mipmaps,r.minFilter=Ee),1===n.mipmapCount&&(r.minFilter=ye),void 0!==n.generateMipmaps&&(r.generateMipmaps=n.generateMipmaps),r.needsUpdate=!0,t&&t(r,n))}),n,i),r}}class TextureLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=new Texture,r=new ImageLoader(this.manager);return r.setCrossOrigin(this.crossOrigin),r.setPath(this.path),r.load(e,(function(e){s.image=e,s.needsUpdate=!0,void 0!==t&&t(s)}),n,i),s}}class Light extends Object3D{constructor(e,t=1){super(),this.type="Light",this.color=new Color(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}Light.prototype.isLight=!0;class HemisphereLight extends Light{constructor(e,t,n){super(e,n),this.type="HemisphereLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.groundColor=new Color(t)}copy(e){return Light.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}HemisphereLight.prototype.isHemisphereLight=!0;const Ul=new Matrix4,Bl=new Vector3,Fl=new Vector3;class LightShadow{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Bl.setFromMatrixPosition(e.matrixWorld),t.position.copy(Bl),Fl.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Fl),t.updateMatrixWorld(),Ul.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ul),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class SpotLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,n=2*bn*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;n===t.fov&&i===t.aspect&&s===t.far||(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}SpotLightShadow.prototype.isSpotLightShadow=!0;class SpotLight extends Light{constructor(e,t,n=0,i=Math.PI/3,s=0,r=1){super(e,t),this.type="SpotLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.distance=n,this.angle=i,this.penumbra=s,this.decay=r,this.shadow=new SpotLightShadow}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}SpotLight.prototype.isSpotLight=!0;const Vl=new Matrix4,Hl=new Vector3,jl=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),Hl.setFromMatrixPosition(e.matrixWorld),n.position.copy(Hl),jl.copy(n.position),jl.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(jl),n.updateMatrixWorld(),i.makeTranslation(-Hl.x,-Hl.y,-Hl.z),Vl.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Vl)}}PointLightShadow.prototype.isPointLightShadow=!0;class PointLight extends Light{constructor(e,t,n=0,i=1){super(e,t),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new PointLightShadow}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}PointLight.prototype.isPointLight=!0;class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500))}}DirectionalLightShadow.prototype.isDirectionalLightShadow=!0;class DirectionalLight extends Light{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}DirectionalLight.prototype.isDirectionalLight=!0;class AmbientLight extends Light{constructor(e,t){super(e,t),this.type="AmbientLight"}}AmbientLight.prototype.isAmbientLight=!0;class RectAreaLight extends Light{constructor(e,t,n=10,i=10){super(e,t),this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}RectAreaLight.prototype.isRectAreaLight=!0;class SphericalHarmonics3{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Vector3)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,r=this.coefficients;return t.copy(r[0]).multiplyScalar(.282095),t.addScaledVector(r[1],.488603*i),t.addScaledVector(r[2],.488603*s),t.addScaledVector(r[3],.488603*n),t.addScaledVector(r[4],n*i*1.092548),t.addScaledVector(r[5],i*s*1.092548),t.addScaledVector(r[6],.315392*(3*s*s-1)),t.addScaledVector(r[7],n*s*1.092548),t.addScaledVector(r[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,r=this.coefficients;return t.copy(r[0]).multiplyScalar(.886227),t.addScaledVector(r[1],1.023328*i),t.addScaledVector(r[2],1.023328*s),t.addScaledVector(r[3],1.023328*n),t.addScaledVector(r[4],.858086*n*i),t.addScaledVector(r[5],.858086*i*s),t.addScaledVector(r[6],.743125*s*s-.247708),t.addScaledVector(r[7],.858086*n*s),t.addScaledVector(r[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+3*i);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}SphericalHarmonics3.prototype.isSphericalHarmonics3=!0;class LightProbe extends Light{constructor(e=new SphericalHarmonics3,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}LightProbe.prototype.isLightProbe=!0;class MaterialLoader extends Loader{constructor(e){super(e),this.textures={}}load(e,t,n,i){const s=this,r=new FileLoader(s.manager);r.setPath(s.path),r.setRequestHeader(s.requestHeader),r.setWithCredentials(s.withCredentials),r.load(e,(function(n){try{t(s.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),s.manager.itemError(e)}}),n,i)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=Material.fromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new Color).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const s=e.uniforms[t];switch(i.uniforms[t]={},s.type){case"t":i.uniforms[t].value=n(s.value);break;case"c":i.uniforms[t].value=(new Color).setHex(s.value);break;case"v2":i.uniforms[t].value=(new Vector2).fromArray(s.value);break;case"v3":i.uniforms[t].value=(new Vector3).fromArray(s.value);break;case"v4":i.uniforms[t].value=(new Vector4).fromArray(s.value);break;case"m3":i.uniforms[t].value=(new Matrix3).fromArray(s.value);break;case"m4":i.uniforms[t].value=(new Matrix4).fromArray(s.value);break;default:i.uniforms[t].value=s.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const t in e.extensions)i.extensions[t]=e.extensions[t];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=n(e.map)),void 0!==e.matcap&&(i.matcap=n(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new Vector2).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Vector2).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(i.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=n(e.thicknessMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}}class LoaderUtils{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class InstancedBufferGeometry extends BufferGeometry{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}InstancedBufferGeometry.prototype.isInstancedBufferGeometry=!0;class BufferGeometryLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=this,r=new FileLoader(s.manager);r.setPath(s.path),r.setRequestHeader(s.requestHeader),r.setWithCredentials(s.withCredentials),r.load(e,(function(n){try{t(s.parse(JSON.parse(n)))}catch(t){i?i(t):console.error(t),s.manager.itemError(e)}}),n,i)}parse(e){const t={},n={};function i(e,i){if(void 0!==t[i])return t[i];const s=e.interleavedBuffers[i],r=function(e,t){if(void 0!==n[t])return n[t];const i=e.arrayBuffers[t],s=new Uint32Array(i).buffer;return n[t]=s,s}(e,s.buffer),o=Nn(s.type,r),a=new InterleavedBuffer(o,s.stride);return a.uuid=s.uuid,t[i]=a,a}const s=e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,r=e.data.index;if(void 0!==r){const e=Nn(r.type,r.array);s.setIndex(new BufferAttribute(e,1))}const o=e.data.attributes;for(const t in o){const n=o[t];let r;if(n.isInterleavedBufferAttribute){const t=i(e.data,n.data);r=new InterleavedBufferAttribute(t,n.itemSize,n.offset,n.normalized)}else{const e=Nn(n.type,n.array);r=new(n.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute)(e,n.itemSize,n.normalized)}void 0!==n.name&&(r.name=n.name),void 0!==n.usage&&r.setUsage(n.usage),void 0!==n.updateRange&&(r.updateRange.offset=n.updateRange.offset,r.updateRange.count=n.updateRange.count),s.setAttribute(t,r)}const a=e.data.morphAttributes;if(a)for(const t in a){const n=a[t],r=[];for(let t=0,s=n.length;t<s;t++){const s=n[t];let o;if(s.isInterleavedBufferAttribute){const t=i(e.data,s.data);o=new InterleavedBufferAttribute(t,s.itemSize,s.offset,s.normalized)}else{const e=Nn(s.type,s.array);o=new BufferAttribute(e,s.itemSize,s.normalized)}void 0!==s.name&&(o.name=s.name),r.push(o)}s.morphAttributes[t]=r}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){const t=l[e];s.addGroup(t.start,t.count,t.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new Vector3;void 0!==c.center&&e.fromArray(c.center),s.boundingSphere=new Sphere(e,c.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}}class ObjectLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=this,r=""===this.path?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const o=new FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){let r=null;try{r=JSON.parse(n)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}const o=r.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?s.parse(r,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,i)}async loadAsync(e,t){const n=""===this.path?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const i=new FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const s=await i.loadAsync(e,t),r=JSON.parse(s),o=r.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(r)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),r=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,s,a,o,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in r)if(r[t]instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),r=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,r),a=this.parseObject(e.object,i,o,r,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let n=0,i=e.length;n<i;n++){const i=(new Shape).fromJSON(e[n]);t[i.uuid]=i}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse((function(e){e.isBone&&(i[e.uuid]=e)})),void 0!==e)for(let t=0,s=e.length;t<s;t++){const s=(new Skeleton).fromJSON(e[t],i);n[s.uuid]=s}return n}parseGeometries(e,t){const n={};if(void 0!==e){const i=new BufferGeometryLoader;for(let s=0,r=e.length;s<r;s++){let r;const o=e[s];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":r=i.parse(o);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:o.type in Nl?r=Nl[o.type].fromJSON(o,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}r.uuid=o.uuid,void 0!==o.name&&(r.name=o.name),!0===r.isBufferGeometry&&void 0!==o.userData&&(r.userData=o.userData),n[o.uuid]=r}}return n}parseMaterials(e,t){const n={},i={};if(void 0!==e){const s=new MaterialLoader;s.setTextures(t);for(let t=0,r=e.length;t<r;t++){const r=e[t];if("MultiMaterial"===r.type){const e=[];for(let t=0;t<r.materials.length;t++){const i=r.materials[t];void 0===n[i.uuid]&&(n[i.uuid]=s.parse(i)),e.push(n[i.uuid])}i[r.uuid]=e}else void 0===n[r.uuid]&&(n[r.uuid]=s.parse(r)),i[r.uuid]=n[r.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n],s=AnimationClip.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const n=this,i={};let s;function r(e){if("string"==typeof e){const t=e;return function(e){return n.manager.itemStart(e),s.load(e,(function(){n.manager.itemEnd(e)}),void 0,(function(){n.manager.itemError(e),n.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:Nn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new LoadingManager(t);s=new ImageLoader(n),s.setCrossOrigin(this.crossOrigin);for(let t=0,n=e.length;t<n;t++){const n=e[t],s=n.url;if(Array.isArray(s)){const e=[];for(let t=0,n=s.length;t<n;t++){const n=r(s[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new DataTexture(n.data,n.width,n.height)))}i[n.uuid]=new Source(e)}else{const e=r(n.url);i[n.uuid]=new Source(e)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function s(e){if("string"==typeof e){const n=e,s=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await i.loadAsync(s)}return e.data?{data:Nn(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){i=new ImageLoader(this.manager),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],r=i.url;if(Array.isArray(r)){const e=[];for(let t=0,n=r.length;t<n;t++){const n=r[t],i=await s(n);null!==i&&(i instanceof HTMLImageElement?e.push(i):e.push(new DataTexture(i.data,i.width,i.height)))}n[i.uuid]=new Source(e)}else{const e=await s(i.url);n[i.uuid]=new Source(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let s=0,r=e.length;s<r;s++){const r=e[s];void 0===r.image&&console.warn('THREE.ObjectLoader: No "image" specified for',r.uuid),void 0===t[r.image]&&console.warn("THREE.ObjectLoader: Undefined image",r.image);const o=t[r.image],a=o.data;let l;Array.isArray(a)?(l=new CubeTexture,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new DataTexture:new Texture,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=r.uuid,void 0!==r.name&&(l.name=r.name),void 0!==r.mapping&&(l.mapping=n(r.mapping,Gl)),void 0!==r.offset&&l.offset.fromArray(r.offset),void 0!==r.repeat&&l.repeat.fromArray(r.repeat),void 0!==r.center&&l.center.fromArray(r.center),void 0!==r.rotation&&(l.rotation=r.rotation),void 0!==r.wrap&&(l.wrapS=n(r.wrap[0],zl),l.wrapT=n(r.wrap[1],zl)),void 0!==r.format&&(l.format=r.format),void 0!==r.type&&(l.type=r.type),void 0!==r.encoding&&(l.encoding=r.encoding),void 0!==r.minFilter&&(l.minFilter=n(r.minFilter,Wl)),void 0!==r.magFilter&&(l.magFilter=n(r.magFilter,Wl)),void 0!==r.anisotropy&&(l.anisotropy=r.anisotropy),void 0!==r.flipY&&(l.flipY=r.flipY),void 0!==r.premultiplyAlpha&&(l.premultiplyAlpha=r.premultiplyAlpha),void 0!==r.unpackAlignment&&(l.unpackAlignment=r.unpackAlignment),void 0!==r.userData&&(l.userData=r.userData),i[r.uuid]=l}return i}parseObject(e,t,n,i,s){let r,o,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,s=e.length;i<s;i++){const s=e[i];void 0===n[s]&&console.warn("THREE.ObjectLoader: Undefined material",s),t.push(n[s])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}function d(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":r=new Scene,void 0!==e.background&&(Number.isInteger(e.background)?r.background=new Color(e.background):r.background=d(e.background)),void 0!==e.environment&&(r.environment=d(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?r.fog=new Fog(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(r.fog=new FogExp2(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":r=new PerspectiveCamera(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(r.focus=e.focus),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.filmGauge&&(r.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(r.filmOffset=e.filmOffset),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"OrthographicCamera":r=new OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(r.zoom=e.zoom),void 0!==e.view&&(r.view=Object.assign({},e.view));break;case"AmbientLight":r=new AmbientLight(e.color,e.intensity);break;case"DirectionalLight":r=new DirectionalLight(e.color,e.intensity);break;case"PointLight":r=new PointLight(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":r=new RectAreaLight(e.color,e.intensity,e.width,e.height);break;case"SpotLight":r=new SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":r=new HemisphereLight(e.color,e.groundColor,e.intensity);break;case"LightProbe":r=(new LightProbe).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),a=c(e.material),r=new SkinnedMesh(o,a),void 0!==e.bindMode&&(r.bindMode=e.bindMode),void 0!==e.bindMatrix&&r.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(r.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),a=c(e.material),r=new Mesh(o,a);break;case"InstancedMesh":o=l(e.geometry),a=c(e.material);const t=e.count,n=e.instanceMatrix,i=e.instanceColor;r=new InstancedMesh(o,a,t),r.instanceMatrix=new InstancedBufferAttribute(new Float32Array(n.array),16),void 0!==i&&(r.instanceColor=new InstancedBufferAttribute(new Float32Array(i.array),i.itemSize));break;case"LOD":r=new LOD;break;case"Line":r=new Line(l(e.geometry),c(e.material));break;case"LineLoop":r=new LineLoop(l(e.geometry),c(e.material));break;case"LineSegments":r=new LineSegments(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":r=new Points(l(e.geometry),c(e.material));break;case"Sprite":r=new Sprite(c(e.material));break;case"Group":r=new Group;break;case"Bone":r=new Bone;break;default:r=new Object3D}if(r.uuid=e.uuid,void 0!==e.name&&(r.name=e.name),void 0!==e.matrix?(r.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(r.matrixAutoUpdate=e.matrixAutoUpdate),r.matrixAutoUpdate&&r.matrix.decompose(r.position,r.quaternion,r.scale)):(void 0!==e.position&&r.position.fromArray(e.position),void 0!==e.rotation&&r.rotation.fromArray(e.rotation),void 0!==e.quaternion&&r.quaternion.fromArray(e.quaternion),void 0!==e.scale&&r.scale.fromArray(e.scale)),void 0!==e.castShadow&&(r.castShadow=e.castShadow),void 0!==e.receiveShadow&&(r.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(r.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(r.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(r.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&r.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(r.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.frustumCulled&&(r.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(r.renderOrder=e.renderOrder),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.layers&&(r.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)r.add(this.parseObject(o[e],t,n,i,s))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];r.animations.push(s[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(r.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],i=r.getObjectByProperty("uuid",n.object);void 0!==i&&r.addLevel(i,n.distance)}}return r}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const Gl={UVMapping:se,CubeReflectionMapping:re,CubeRefractionMapping:oe,EquirectangularReflectionMapping:ae,EquirectangularRefractionMapping:le,CubeUVReflectionMapping:ce},zl={RepeatWrapping:de,ClampToEdgeWrapping:ue,MirroredRepeatWrapping:he},Wl={NearestFilter:pe,NearestMipmapNearestFilter:me,NearestMipmapLinearFilter:ge,LinearFilter:ye,LinearMipmapNearestFilter:be,LinearMipmapLinearFilter:Ee};class ImageBitmapLoader extends Loader{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,r=Pl.get(e);if(void 0!==r)return s.manager.itemStart(e),setTimeout((function(){t&&t(r),s.manager.itemEnd(e)}),0),r;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(s.options,{colorSpaceConversion:"none"}))})).then((function(n){Pl.add(e,n),t&&t(n),s.manager.itemEnd(e)})).catch((function(t){i&&i(t),s.manager.itemError(e),s.manager.itemEnd(e)})),s.manager.itemStart(e)}}let Kl;ImageBitmapLoader.prototype.isImageBitmapLoader=!0;const Yl={getContext:function(){return void 0===Kl&&(Kl=new(window.AudioContext||window.webkitAudioContext)),Kl},setContext:function(e){Kl=e}};class AudioLoader extends Loader{constructor(e){super(e)}load(e,t,n,i){const s=this,r=new FileLoader(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,(function(n){try{const e=n.slice(0);Yl.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(t){i?i(t):console.error(t),s.manager.itemError(e)}}),n,i)}}class HemisphereLightProbe extends LightProbe{constructor(e,t,n=1){super(void 0,n);const i=(new Color).set(e),s=(new Color).set(t),r=new Vector3(i.r,i.g,i.b),o=new Vector3(s.r,s.g,s.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(r).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(r).sub(o).multiplyScalar(l)}}HemisphereLightProbe.prototype.isHemisphereLightProbe=!0;class AmbientLightProbe extends LightProbe{constructor(e,t=1){super(void 0,t);const n=(new Color).set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}AmbientLightProbe.prototype.isAmbientLightProbe=!0;const ql=new Matrix4,Zl=new Matrix4,$l=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,$l.copy(e.projectionMatrix);const n=t.eyeSep/2,i=n*t.near/t.focus,s=t.near*Math.tan(yn*t.fov*.5)/t.zoom;let r,o;Zl.elements[12]=-n,ql.elements[12]=n,r=-s*t.aspect+i,o=s*t.aspect+i,$l.elements[0]=2*t.near/(o-r),$l.elements[8]=(o+r)/(o-r),this.cameraL.projectionMatrix.copy($l),r=-s*t.aspect-i,o=s*t.aspect-i,$l.elements[0]=2*t.near/(o-r),$l.elements[8]=(o+r)/(o-r),this.cameraR.projectionMatrix.copy($l)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Zl),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ql)}}class Clock{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ql(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Ql();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Ql(){return("undefined"==typeof performance?Date:performance).now()}const Xl=new Vector3,Jl=new Quaternion,ec=new Vector3,tc=new Vector3;class AudioListener extends Object3D{constructor(){super(),this.type="AudioListener",this.context=Yl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Xl,Jl,ec),tc.set(0,0,-1).applyQuaternion(Jl),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Xl.x,e),t.positionY.linearRampToValueAtTime(Xl.y,e),t.positionZ.linearRampToValueAtTime(Xl.z,e),t.forwardX.linearRampToValueAtTime(tc.x,e),t.forwardY.linearRampToValueAtTime(tc.y,e),t.forwardZ.linearRampToValueAtTime(tc.z,e),t.upX.linearRampToValueAtTime(n.x,e),t.upY.linearRampToValueAtTime(n.y,e),t.upZ.linearRampToValueAtTime(n.z,e)}else t.setPosition(Xl.x,Xl.y,Xl.z),t.setOrientation(tc.x,tc.y,tc.z,n.x,n.y,n.z)}}class Audio extends Object3D{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const nc=new Vector3,ic=new Quaternion,sc=new Vector3,rc=new Vector3;class PositionalAudio extends Audio{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(nc,ic,sc),rc.set(0,0,1).applyQuaternion(ic);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(nc.x,e),t.positionY.linearRampToValueAtTime(nc.y,e),t.positionZ.linearRampToValueAtTime(nc.z,e),t.orientationX.linearRampToValueAtTime(rc.x,e),t.orientationY.linearRampToValueAtTime(rc.y,e),t.orientationZ.linearRampToValueAtTime(rc.z,e)}else t.setPosition(nc.x,nc.y,nc.z),t.setOrientation(rc.x,rc.y,rc.z)}}class AudioAnalyser{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class PropertyMixer{constructor(e,t,n){let i,s,r;switch(this.binding=e,this.valueSize=n,t){case"quaternion":i=this._slerp,s=this._slerpAdditive,r=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,r=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,s=this._lerpAdditive,r=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=r,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let r=this.cumulativeWeight;if(0===r){for(let e=0;e!==i;++e)n[s+e]=n[e];r=t}else{r+=t;const e=t/r;this._mixBufferRegion(n,s,0,e,i)}this.cumulativeWeight=r}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,r=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const e=t*this._origIndex;this._mixBufferRegion(n,i,e,1-s,t)}r>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let e=t,s=t+t;e!==s;++e)if(n[e]!==n[e+t]){o.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let e=n,s=i;e!==s;++e)t[e]=t[i+e%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let i=0;i!==s;++i)e[t+i]=e[n+i]}_slerp(e,t,n,i){Quaternion.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const r=this._workIndex*s;Quaternion.multiplyQuaternionsFlat(e,r,e,t,e,n),Quaternion.slerpFlat(e,t,e,t,e,r,i)}_lerp(e,t,n,i,s){const r=1-i;for(let o=0;o!==s;++o){const s=t+o;e[s]=e[s]*r+e[n+o]*i}}_lerpAdditive(e,t,n,i,s){for(let r=0;r!==s;++r){const s=t+r;e[s]=e[s]+e[n+r]*i}}}const oc="\\[\\]\\.:\\/",ac=new RegExp("[\\[\\]\\.:\\/]","g"),lc="[^\\[\\]\\.:\\/]",cc="[^"+oc.replace("\\.","")+"]",dc=/((?:WC+[\/:])*)/.source.replace("WC",lc),uc=/(WCOD+)?/.source.replace("WCOD",cc),hc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lc),pc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lc),mc=new RegExp("^"+dc+uc+hc+pc+"$"),fc=["material","materials","bones"];class PropertyBinding{constructor(e,t,n){this.path=t,this.parsedPath=n||PropertyBinding.parseTrackName(t),this.node=PropertyBinding.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new PropertyBinding.Composite(e,t,n):new PropertyBinding(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(ac,"")}static parseTrackName(e){const t=mc.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=n.nodeName.substring(i+1);-1!==fc.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let i=0;i<e.length;i++){const s=e[i];if(s.name===t||s.uuid===t)return s;const r=n(s.children);if(r)return r}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=PropertyBinding.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const r=e[i];if(void 0===r){const n=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==s){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[s]&&(s=e.morphTargetDictionary[s])}a=this.BindingType.ArrayElement,this.resolvedProperty=r,this.propertyIndex=s}else void 0!==r.fromArray&&void 0!==r.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=r):Array.isArray(r)?(a=this.BindingType.EntireArray,this.resolvedProperty=r):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}PropertyBinding.Composite=class Composite{constructor(e,t,n){const i=n||PropertyBinding.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},PropertyBinding.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},PropertyBinding.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},PropertyBinding.prototype.GetterByBindingType=[PropertyBinding.prototype._getValue_direct,PropertyBinding.prototype._getValue_array,PropertyBinding.prototype._getValue_arrayElement,PropertyBinding.prototype._getValue_toArray],PropertyBinding.prototype.SetterByBindingTypeAndVersioning=[[PropertyBinding.prototype._setValue_direct,PropertyBinding.prototype._setValue_direct_setNeedsUpdate,PropertyBinding.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_array,PropertyBinding.prototype._setValue_array_setNeedsUpdate,PropertyBinding.prototype._setValue_array_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_arrayElement,PropertyBinding.prototype._setValue_arrayElement_setNeedsUpdate,PropertyBinding.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[PropertyBinding.prototype._setValue_fromArray,PropertyBinding.prototype._setValue_fromArray_setNeedsUpdate,PropertyBinding.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class AnimationObjectGroup{constructor(){this.uuid=Sn(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,s=this._bindings,r=s.length;let o,a=e.length,l=this.nCachedObjects_;for(let c=0,d=arguments.length;c!==d;++c){const d=arguments[c],u=d.uuid;let h=t[u];if(void 0===h){h=a++,t[u]=h,e.push(d);for(let e=0,t=r;e!==t;++e)s[e].push(new PropertyBinding(d,n[e],i[e]))}else if(h<l){o=e[h];const a=--l,c=e[a];t[c.uuid]=h,e[h]=c,t[u]=a,e[a]=d;for(let e=0,t=r;e!==t;++e){const t=s[e],r=t[a];let o=t[h];t[h]=r,void 0===o&&(o=new PropertyBinding(d,n[e],i[e])),t[a]=o}}else e[h]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_;for(let r=0,o=arguments.length;r!==o;++r){const o=arguments[r],a=o.uuid,l=t[a];if(void 0!==l&&l>=s){const r=s++,c=e[r];t[c.uuid]=l,e[l]=c,t[a]=r,e[r]=o;for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[r],s=t[l];t[l]=i,t[r]=s}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_,r=e.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<s){const o=--s,a=e[o],c=--r,d=e[c];t[a.uuid]=l,e[l]=a,t[d.uuid]=o,e[o]=d,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e],i=t[o],s=t[c];t[l]=i,t[o]=s,t.pop()}}else{const s=--r,o=e[s];s>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=i;e!==t;++e){const t=n[e];t[l]=t[s],t.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const s=this._bindings;if(void 0!==i)return s[i];const r=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,d=new Array(l);i=s.length,n[e]=i,r.push(e),o.push(t),s.push(d);for(let n=c,i=a.length;n!==i;++n){const i=a[n];d[n]=new PropertyBinding(i,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const i=this._paths,s=this._parsedPaths,r=this._bindings,o=r.length-1,a=r[o];t[e[o]]=n,r[n]=a,r.pop(),s[n]=s[o],s.pop(),i[n]=i[o],i.pop()}}}AnimationObjectGroup.prototype.isAnimationObjectGroup=!0;class AnimationAction{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,r=s.length,o=new Array(r),a={endingStart:xt,endingEnd:xt};for(let e=0;e!==r;++e){const t=s[e].createInterpolant(null);o[e]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=bt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const n=this._clip.duration,i=e._clip.duration,s=i/n,r=n/i;e.warp(1,s,t),this.warp(r,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,r=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,a[1]=s+n,l[0]=e/r,l[1]=t/r,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled)return void this._updateWeight(e);const s=this._startTime;if(null!==s){const i=(e-s)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);const r=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;switch(this.blendMode){case At:for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(r),t[n].accumulateAdditive(o);break;case Ot:default:for(let n=0,s=e.length;n!==s;++n)e[n].evaluate(r),t[n].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const r=n===St;if(0===e)return-1===s?i:r&&1==(1&s)?t-i:i;if(n===yt){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),i>=t||i<0){const n=Math.floor(i/t);i-=t*n,s+=Math.abs(n);const o=this.repetitions-s;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,r)}else this._setEndings(!1,!1,r);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(r&&1==(1&s))return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=_t,i.endingEnd=_t):(i.endingStart=e?this.zeroSlopeAtStart?_t:xt:Mt,i.endingEnd=t?this.zeroSlopeAtEnd?_t:xt:Mt)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let r=this._weightInterpolant;null===r&&(r=i._lendControlInterpolant(),this._weightInterpolant=r);const o=r.parameterPositions,a=r.sampleValues;return o[0]=s,a[0]=t,o[1]=s+e,a[1]=n,this}}class AnimationMixer extends EventDispatcher{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,r=e._propertyBindings,o=e._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let e=0;e!==s;++e){const s=i[e],l=s.name;let d=c[l];if(void 0!==d)++d.referenceCount,r[e]=d;else{if(d=r[e],void 0!==d){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,a,l));continue}const i=t&&t._propertyBindings[e].binding.parsedPath;d=new PropertyMixer(PropertyBinding.create(n,l,i),s.ValueTypeName,s.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,a,l),r[e]=d}o[e].resultBuffer=d.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let r=s[t];if(void 0===r)r={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=r;else{const t=r.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),r.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,r=this._actionsByClip,o=r[s],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete r[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0==--n.referenceCount&&this._removeInactiveBinding(n)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let r=i[t];void 0===r&&(r={},i[t]=r),r[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,r=this._bindingsByRootAndName,o=r[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[s],0===Object.keys(o).length&&delete r[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let r="string"==typeof e?AnimationClip.findByName(i,e):e;const o=null!==r?r.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==r?r.blendMode:Ot),void 0!==a){const e=a.actionByRoot[s];if(void 0!==e&&e.blendMode===n)return e;l=a.knownActions[0],null===r&&(r=l._clip)}if(null===r)return null;const c=new AnimationAction(this,r,t,n);return this._bindAction(c,l),this._addInactiveAction(c,o,s),c}existingAction(e,t){const n=t||this._root,i=n.uuid,s="string"==typeof e?AnimationClip.findByName(n,e):e,r=s?s.uuid:e,o=this._actionsByClip[r];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),r=this._accuIndex^=1;for(let o=0;o!==n;++o){t[o]._update(i,e,s,r)}const o=this._bindings,a=this._nActiveBindings;for(let e=0;e!==a;++e)o[e].apply(r);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(void 0!==s){const e=s.knownActions;for(let n=0,i=e.length;n!==i;++n){const i=e[n];this._deactivateAction(i);const s=i._cacheIndex,r=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,r._cacheIndex=s,t[s]=r,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const e in n){const i=n[e].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const e in i){const t=i[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}AnimationMixer.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Uniform{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Uniform(void 0===this.value.clone?this.value:this.value.clone())}}class InstancedInterleavedBuffer extends InterleavedBuffer{constructor(e,t,n=1){super(e,t),this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}InstancedInterleavedBuffer.prototype.isInstancedInterleavedBuffer=!0;class GLBufferAttribute{constructor(e,t,n,i,s){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}GLBufferAttribute.prototype.isGLBufferAttribute=!0;class Raycaster{constructor(e,t,n=0,i=1/0){this.ray=new Ray(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Layers,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,n=[]){return vc(e,this,n,t),n.sort(gc),n}intersectObjects(e,t=!0,n=[]){for(let i=0,s=e.length;i<s;i++)vc(e[i],this,n,t);return n.sort(gc),n}}function gc(e,t){return e.distance-t.distance}function vc(e,t,n,i){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===i){const i=e.children;for(let e=0,s=i.length;e<s;e++)vc(i[e],t,n,!0)}}class Spherical{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(En(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Cylindrical{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const yc=new Vector2;class Box2{constructor(e=new Vector2(1/0,1/0),t=new Vector2(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=yc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return yc.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Box2.prototype.isBox2=!0;const bc=new Vector3,Sc=new Vector3;class Line3{constructor(e=new Vector3,t=new Vector3){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){bc.subVectors(e,this.start),Sc.subVectors(this.end,this.start);const n=Sc.dot(Sc);let i=Sc.dot(bc)/n;return t&&(i=En(i,0,1)),i}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Ec=new Vector3;class SpotLightHelper extends Object3D{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const n=new BufferGeometry,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,n=32;e<n;e++,t++){const s=e/n*Math.PI*2,r=t/n*Math.PI*2;i.push(Math.cos(s),Math.sin(s),1,Math.cos(r),Math.sin(r),1)}n.setAttribute("position",new Float32BufferAttribute(i,3));const s=new LineBasicMaterial({fog:!1,toneMapped:!1});this.cone=new LineSegments(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Ec.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ec),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Tc=new Vector3,wc=new Matrix4,xc=new Matrix4;class SkeletonHelper extends LineSegments{constructor(e){const t=_c(e),n=new BufferGeometry,i=[],s=[],r=new Color(0,0,1),o=new Color(0,1,0);for(let e=0;e<t.length;e++){const n=t[e];n.parent&&n.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(r.r,r.g,r.b),s.push(o.r,o.g,o.b))}n.setAttribute("position",new Float32BufferAttribute(i,3)),n.setAttribute("color",new Float32BufferAttribute(s,3));super(n,new LineBasicMaterial({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");xc.copy(this.root.matrixWorld).invert();for(let e=0,n=0;e<t.length;e++){const s=t[e];s.parent&&s.parent.isBone&&(wc.multiplyMatrices(xc,s.matrixWorld),Tc.setFromMatrixPosition(wc),i.setXYZ(n,Tc.x,Tc.y,Tc.z),wc.multiplyMatrices(xc,s.parent.matrixWorld),Tc.setFromMatrixPosition(wc),i.setXYZ(n+1,Tc.x,Tc.y,Tc.z),n+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function _c(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push.apply(t,_c(e.children[n]));return t}class PointLightHelper extends Mesh{constructor(e,t,n){super(new SphereGeometry(t,4,2),new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Mc=new Vector3,Oc=new Color,Ac=new Color;class HemisphereLightHelper extends Object3D{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new OctahedronGeometry(t);i.rotateY(.5*Math.PI),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),r=new Float32Array(3*s.count);i.setAttribute("color",new BufferAttribute(r,3)),this.add(new Mesh(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Oc.copy(this.light.color),Ac.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const i=e<n/2?Oc:Ac;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Mc.setFromMatrixPosition(this.light.matrixWorld).negate())}}class GridHelper extends LineSegments{constructor(e=10,t=10,n=4473924,i=8947848){n=new Color(n),i=new Color(i);const s=t/2,r=e/t,o=e/2,a=[],l=[];for(let e=0,c=0,d=-o;e<=t;e++,d+=r){a.push(-o,0,d,o,0,d),a.push(d,0,-o,d,0,o);const t=e===s?n:i;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}const c=new BufferGeometry;c.setAttribute("position",new Float32BufferAttribute(a,3)),c.setAttribute("color",new Float32BufferAttribute(l,3));super(c,new LineBasicMaterial({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class PolarGridHelper extends LineSegments{constructor(e=10,t=16,n=8,i=64,s=4473924,r=8947848){s=new Color(s),r=new Color(r);const o=[],a=[];for(let n=0;n<=t;n++){const i=n/t*(2*Math.PI),l=Math.sin(i)*e,c=Math.cos(i)*e;o.push(0,0,0),o.push(l,0,c);const d=1&n?s:r;a.push(d.r,d.g,d.b),a.push(d.r,d.g,d.b)}for(let t=0;t<=n;t++){const l=1&t?s:r,c=e-e/n*t;for(let e=0;e<i;e++){let t=e/i*(2*Math.PI),n=Math.sin(t)*c,s=Math.cos(t)*c;o.push(n,0,s),a.push(l.r,l.g,l.b),t=(e+1)/i*(2*Math.PI),n=Math.sin(t)*c,s=Math.cos(t)*c,o.push(n,0,s),a.push(l.r,l.g,l.b)}}const l=new BufferGeometry;l.setAttribute("position",new Float32BufferAttribute(o,3)),l.setAttribute("color",new Float32BufferAttribute(a,3));super(l,new LineBasicMaterial({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Cc=new Vector3,Nc=new Vector3,Dc=new Vector3;class DirectionalLightHelper extends Object3D{constructor(e,t,n){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);let i=new BufferGeometry;i.setAttribute("position",new Float32BufferAttribute([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new LineBasicMaterial({fog:!1,toneMapped:!1});this.lightPlane=new Line(i,s),this.add(this.lightPlane),i=new BufferGeometry,i.setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Cc.setFromMatrixPosition(this.light.matrixWorld),Nc.setFromMatrixPosition(this.light.target.matrixWorld),Dc.subVectors(Nc,Cc),this.lightPlane.lookAt(Nc),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Nc),this.targetLine.scale.z=Dc.length()}}const Ic=new Vector3,Lc=new Camera;class CameraHelper extends LineSegments{constructor(e){const t=new BufferGeometry,n=new LineBasicMaterial({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],r={},o=new Color(16755200),a=new Color(16711680),l=new Color(43775),c=new Color(16777215),d=new Color(3355443);function u(e,t,n){h(e,n),h(t,n)}function h(e,t){i.push(0,0,0),s.push(t.r,t.g,t.b),void 0===r[e]&&(r[e]=[]),r[e].push(i.length/3-1)}u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",a),u("p","n2",a),u("p","n3",a),u("p","n4",a),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l),u("c","t",c),u("p","c",d),u("cn1","cn2",d),u("cn3","cn4",d),u("cf1","cf2",d),u("cf3","cf4",d),t.setAttribute("position",new Float32BufferAttribute(i,3)),t.setAttribute("color",new Float32BufferAttribute(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=r,this.update()}update(){const e=this.geometry,t=this.pointMap;Lc.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Pc("c",t,e,Lc,0,0,-1),Pc("t",t,e,Lc,0,0,1),Pc("n1",t,e,Lc,-1,-1,-1),Pc("n2",t,e,Lc,1,-1,-1),Pc("n3",t,e,Lc,-1,1,-1),Pc("n4",t,e,Lc,1,1,-1),Pc("f1",t,e,Lc,-1,-1,1),Pc("f2",t,e,Lc,1,-1,1),Pc("f3",t,e,Lc,-1,1,1),Pc("f4",t,e,Lc,1,1,1),Pc("u1",t,e,Lc,.7,1.1,-1),Pc("u2",t,e,Lc,-.7,1.1,-1),Pc("u3",t,e,Lc,0,2,-1),Pc("cf1",t,e,Lc,-1,0,1),Pc("cf2",t,e,Lc,1,0,1),Pc("cf3",t,e,Lc,0,-1,1),Pc("cf4",t,e,Lc,0,1,1),Pc("cn1",t,e,Lc,-1,0,-1),Pc("cn2",t,e,Lc,1,0,-1),Pc("cn3",t,e,Lc,0,-1,-1),Pc("cn4",t,e,Lc,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Pc(e,t,n,i,s,r,o){Ic.set(s,r,o).unproject(i);const a=t[e];if(void 0!==a){const e=n.getAttribute("position");for(let t=0,n=a.length;t<n;t++)e.setXYZ(a[t],Ic.x,Ic.y,Ic.z)}}const Rc=new Box3;class BoxHelper extends LineSegments{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),s=new BufferGeometry;s.setIndex(new BufferAttribute(n,1)),s.setAttribute("position",new BufferAttribute(i,3)),super(s,new LineBasicMaterial({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Rc.setFromObject(this.object),Rc.isEmpty())return;const t=Rc.min,n=Rc.max,i=this.geometry.attributes.position,s=i.array;s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=t.x,s[4]=n.y,s[5]=n.z,s[6]=t.x,s[7]=t.y,s[8]=n.z,s[9]=n.x,s[10]=t.y,s[11]=n.z,s[12]=n.x,s[13]=n.y,s[14]=t.z,s[15]=t.x,s[16]=n.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=n.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return LineSegments.prototype.copy.call(this,e),this.object=e.object,this}}class Box3Helper extends LineSegments{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new BufferGeometry;i.setIndex(new BufferAttribute(n,1)),i.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new LineBasicMaterial({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class PlaneHelper extends Line{constructor(e,t=1,n=16776960){const i=n,s=new BufferGeometry;s.setAttribute("position",new Float32BufferAttribute([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),s.computeBoundingSphere(),super(s,new LineBasicMaterial({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const r=new BufferGeometry;r.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),r.computeBoundingSphere(),this.add(new Mesh(r,new MeshBasicMaterial({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?f:m,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const kc=new Vector3;let Uc,Bc;class ArrowHelper extends Object3D{constructor(e=new Vector3(0,0,1),t=new Vector3(0,0,0),n=1,i=16776960,s=.2*n,r=.2*s){super(),this.type="ArrowHelper",void 0===Uc&&(Uc=new BufferGeometry,Uc.setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),Bc=new CylinderGeometry(0,.5,1,5,1),Bc.translate(0,-.5,0)),this.position.copy(t),this.line=new Line(Uc,new LineBasicMaterial({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(Bc,new MeshBasicMaterial({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,r)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{kc.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(kc,t)}}setLength(e,t=.2*e,n=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class AxesHelper extends LineSegments{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new BufferGeometry;n.setAttribute("position",new Float32BufferAttribute(t,3)),n.setAttribute("color",new Float32BufferAttribute([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new LineBasicMaterial({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const i=new Color,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,s,r){return this.currentPath.bezierCurveTo(e,t,n,i,s,r),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function n(e){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n],s=new Shape;s.curves=i.curves,t.push(s)}return t}function i(e,t){const n=t.length;let i=!1;for(let s=n-1,r=0;r<n;s=r++){let n=t[s],o=t[r],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[r],a=-a,o=t[s],l=-l),e.y<n.y||e.y>o.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-a*(e.y-n.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==n.y)continue;if(o.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=o.x)return!0}}return i}const s=ShapeUtils.isClockWise,r=this.subPaths;if(0===r.length)return[];if(!0===t)return n(r);let o,a,l;const c=[];if(1===r.length)return a=r[0],l=new Shape,l.curves=a.curves,c.push(l),c;let d=!s(r[0].getPoints());d=e?!d:d;const u=[],h=[];let p,m,f=[],g=0;h[g]=void 0,f[g]=[];for(let t=0,n=r.length;t<n;t++)a=r[t],p=a.getPoints(),o=s(p),o=e?!o:o,o?(!d&&h[g]&&g++,h[g]={s:new Shape,p:p},h[g].s.curves=a.curves,d&&g++,f[g]=[]):f[g].push({h:a,p:p[0]});if(!h[0])return n(r);if(h.length>1){let e=!1,t=0;for(let e=0,t=h.length;e<t;e++)u[e]=[];for(let n=0,s=h.length;n<s;n++){const s=f[n];for(let r=0;r<s.length;r++){const o=s[r];let a=!0;for(let s=0;s<h.length;s++)i(o.p,h[s].p)&&(n!==s&&t++,a?(a=!1,u[s].push(o)):e=!0);a&&u[n].push(o)}}t>0&&!1===e&&(f=u)}for(let e=0,t=h.length;e<t;e++){l=h[e].s,c.push(l),m=f[e];for(let e=0,t=m.length;e<t;e++)l.holes.push(m[e].h)}return c}}class DataUtils{static toHalfFloat(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=En(e,-65504,65504),Vc[0]=e;const t=Hc[0],n=t>>23&511;return jc[n]+((8388607&t)>>Gc[n])}static fromHalfFloat(e){const t=e>>10;return Hc[0]=zc[Kc[t]+(1023&e)]+Wc[t],Vc[0]}}const Fc=new ArrayBuffer(4),Vc=new Float32Array(Fc),Hc=new Uint32Array(Fc),jc=new Uint32Array(512),Gc=new Uint32Array(512);for(let e=0;e<256;++e){const t=e-127;t<-27?(jc[e]=0,jc[256|e]=32768,Gc[e]=24,Gc[256|e]=24):t<-14?(jc[e]=1024>>-t-14,jc[256|e]=1024>>-t-14|32768,Gc[e]=-t-1,Gc[256|e]=-t-1):t<=15?(jc[e]=t+15<<10,jc[256|e]=t+15<<10|32768,Gc[e]=13,Gc[256|e]=13):t<128?(jc[e]=31744,jc[256|e]=64512,Gc[e]=24,Gc[256|e]=24):(jc[e]=31744,jc[256|e]=64512,Gc[e]=13,Gc[256|e]=13)}const zc=new Uint32Array(2048),Wc=new Uint32Array(64),Kc=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,n=0;for(;0==(8388608&t);)t<<=1,n-=8388608;t&=-8388609,n+=947912704,zc[e]=t|n}for(let e=1024;e<2048;++e)zc[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)Wc[e]=e<<23;Wc[31]=1199570944,Wc[32]=2147483648;for(let e=33;e<63;++e)Wc[e]=2147483648+(e-32<<23);Wc[63]=3347054592;for(let e=1;e<64;++e)32!==e&&(Kc[e]=1024);const Yc=0,qc=1,Zc=0,$c=1,Qc=2;function Xc(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function Jc(e=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}class PointCloud extends Points{constructor(e,t){console.warn("THREE.PointCloud has been renamed to THREE.Points."),super(e,t)}}class Particle extends Sprite{constructor(e){console.warn("THREE.Particle has been renamed to THREE.Sprite."),super(e)}}class ParticleSystem extends Points{constructor(e,t){console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),super(e,t)}}class PointCloudMaterial extends PointsMaterial{constructor(e){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),super(e)}}class ParticleBasicMaterial extends PointsMaterial{constructor(e){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),super(e)}}class ParticleSystemMaterial extends PointsMaterial{constructor(e){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),super(e)}}class Vertex extends Vector3{constructor(e,t,n){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),super(e,t,n)}}class DynamicBufferAttribute extends BufferAttribute{constructor(e,t){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),super(e,t),this.setUsage(rn)}}class Int8Attribute extends Int8BufferAttribute{constructor(e,t){console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),super(e,t)}}class Uint8Attribute extends Uint8BufferAttribute{constructor(e,t){console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),super(e,t)}}class Uint8ClampedAttribute extends Uint8ClampedBufferAttribute{constructor(e,t){console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),super(e,t)}}class Int16Attribute extends Int16BufferAttribute{constructor(e,t){console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),super(e,t)}}class Uint16Attribute extends Uint16BufferAttribute{constructor(e,t){console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),super(e,t)}}class Int32Attribute extends Int32BufferAttribute{constructor(e,t){console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),super(e,t)}}class Uint32Attribute extends Uint32BufferAttribute{constructor(e,t){console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),super(e,t)}}class Float32Attribute extends Float32BufferAttribute{constructor(e,t){console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),super(e,t)}}class Float64Attribute extends Float64BufferAttribute{constructor(e,t){console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),super(e,t)}}Curve.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Curve.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Path.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)};class AxisHelper extends AxesHelper{constructor(e){console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),super(e)}}class BoundingBoxHelper extends BoxHelper{constructor(e,t){console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),super(e,t)}}class EdgesHelper extends LineSegments{constructor(e,t){console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),super(new EdgesGeometry(e.geometry),new LineBasicMaterial({color:void 0!==t?t:16777215}))}}GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},SkeletonHelper.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};class WireframeHelper extends LineSegments{constructor(e,t){console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),super(new WireframeGeometry(e.geometry),new LineBasicMaterial({color:void 0!==t?t:16777215}))}}Loader.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),LoaderUtils.extractUrlBase(e)},Loader.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};class XHRLoader extends FileLoader{constructor(e){console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),super(e)}}class BinaryTextureLoader extends DataTextureLoader{constructor(e){console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),super(e)}}Box2.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Box2.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Box2.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Box2.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},Box3.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Box3.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Box3.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Box3.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Box3.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Euler.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Sphere.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Frustum.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Line3.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Matrix3.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Matrix3.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Matrix3.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Matrix3.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Matrix3.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Matrix3.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Matrix4.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},Matrix4.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Matrix4.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Vector3).setFromMatrixColumn(this,3)},Matrix4.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},Matrix4.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Matrix4.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Matrix4.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Matrix4.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Matrix4.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},Matrix4.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Matrix4.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Matrix4.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Matrix4.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Matrix4.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Matrix4.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Matrix4.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Matrix4.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Matrix4.prototype.makeFrustum=function(e,t,n,i,s,r){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,s,r)},Matrix4.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Plane.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Quaternion.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Quaternion.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ray.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ray.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},Ray.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Triangle.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Triangle.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Triangle.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Triangle.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Triangle.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Triangle.barycoordFromPoint=function(e,t,n,i,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Triangle.getBarycoord(e,t,n,i,s)},Triangle.normal=function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Triangle.getNormal(e,t,n,i)},Shape.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Shape.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ExtrudeGeometry(this,e)},Shape.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ShapeGeometry(this,e)},Vector2.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Vector2.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Vector2.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Vector3.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Vector3.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Vector3.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Vector3.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Vector3.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Vector3.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Vector3.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Vector3.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Vector3.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Vector4.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Vector4.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Object3D.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},Object3D.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Object3D.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},Object3D.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Object3D.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Object3D.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Mesh.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Mesh.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Ct},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),SkinnedMesh.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},PerspectiveCamera.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Light.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(BufferAttribute.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===rn},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(rn)}}}),BufferAttribute.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?rn:sn),this},BufferAttribute.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},BufferAttribute.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},BufferGeometry.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},BufferGeometry.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new BufferAttribute(arguments[1],arguments[2])))},BufferGeometry.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},BufferGeometry.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},BufferGeometry.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},BufferGeometry.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},BufferGeometry.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(BufferGeometry.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),InterleavedBuffer.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?rn:sn),this},InterleavedBuffer.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ExtrudeGeometry.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},ExtrudeGeometry.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},ExtrudeGeometry.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Scene.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Uniform.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Material.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Color}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===v}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(ShaderMaterial.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),ta.prototype.clearTarget=function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},ta.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},ta.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ta.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ta.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ta.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ta.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ta.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ta.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ta.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ta.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ta.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ta.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ta.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ta.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},ta.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ta.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ta.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ta.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ta.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ta.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ta.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ta.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ta.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ta.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ta.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?Lt:It}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(Zo.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});class WebGLRenderTargetCube extends WebGLCubeRenderTarget{constructor(e,t,n){console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),super(e,n)}}function ed(){console.error("THREE.CanvasRenderer has been removed")}function td(){console.error("THREE.JSONLoader has been removed.")}Object.defineProperties(WebGLRenderTarget.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Audio.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new AudioLoader).load(e,(function(e){t.setBuffer(e)})),this},AudioAnalyser.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},CubeCamera.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},CubeCamera.prototype.clear=function(e,t,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,i)},ImageUtils.crossOrigin=void 0,ImageUtils.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const s=new TextureLoader;s.setCrossOrigin(this.crossOrigin);const r=s.load(e,n,void 0,i);return t&&(r.mapping=t),r},ImageUtils.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const s=new CubeTextureLoader;s.setCrossOrigin(this.crossOrigin);const r=s.load(e,n,void 0,i);return t&&(r.mapping=t),r},ImageUtils.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ImageUtils.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const nd={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function id(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}class ParametricGeometry extends BufferGeometry{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class TextGeometry extends BufferGeometry{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function sd(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function rd(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function od(){console.error("THREE.ImmediateRenderObject has been removed.")}class WebGLMultisampleRenderTarget extends WebGLRenderTarget{constructor(e,t,n){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,n),this.samples=4}}class DataTexture2DArray extends DataArrayTexture{constructor(e,t,n,i){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(e,t,n,i)}}class DataTexture3D extends Data3DTexture{constructor(e,t,n,i){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(e,t,n,i)}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=i)},5419:(e,t,n)=>{"use strict";n.d(t,{ej:()=>l,kG:()=>c,U6:()=>p});var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};!function(e){function t(){var t=this||self;t.globalThis=t,delete e.prototype._T_}"object"!=typeof globalThis&&(this?t():(e.defineProperty(e.prototype,"_T_",{configurable:!0,get:t}),_T_))}(Object);const s=globalThis;var r="Invariant Violation",o=Object.setPrototypeOf,a=void 0===o?function(e,t){return e.__proto__=t,e}:o,l=function(e){function t(n){void 0===n&&(n=r);var i=e.call(this,"number"==typeof n?r+": "+n+" (see https://github.com/apollographql/invariant-packages)":n)||this;return i.framesToPop=1,i.name=r,a(i,t.prototype),i}return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error);function c(e,t){if(!e)throw new l(t)}var d=["log","warn","error","silent"],u=d.indexOf("log");function h(e){return function(){if(d.indexOf(e)>=u)return console[e].apply(console,arguments)}}function p(e){var t=d[u];return u=Math.max(0,d.indexOf(e)),t}!function(e){e.log=h("log"),e.warn=h("warn"),e.error=h("error")}(c||(c={}));var m=s.process||{env:{}};if(!s.process)try{Object.defineProperty(s,"process",{value:m})}catch(e){}},45301:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LazyLoader:()=>LazyLoader,loadInterface:()=>wt});var i,s,r,o,a,l,c,d=n(70446),u=n(14877);!function(e){e.FORWARD="FORWARD",e.LEFT="LEFT",e.RIGHT="RIGHT",e.BACK="BACK",e.UP="UP",e.DOWN="DOWN"}(i||(i={}));!function(e){e.INSIDE="mode.inside",e.OUTSIDE="mode.outside",e.DOLLHOUSE="mode.dollhouse",e.FLOORPLAN="mode.floorplan",e.TRANSITIONING="mode.transitioning"}(s||(s={}));!function(e){e.INSTANT="transition.instant",e.FLY="transition.fly",e.FADEOUT="transition.fade",e.MOVEFADE="transition.movefade"}(r||(r={}));class convertRotation_Conversion{constructor(e){this.THREE=e,this.tempEuler=new e.Euler}quaternionToRotation(e,t){const n=this.tempEuler.setFromQuaternion(e,convertRotation_Conversion.eulerOrder),i=t||{};return i.x=this.THREE.MathUtils.radToDeg(n.x),i.y=this.THREE.MathUtils.radToDeg(n.y),i.z=this.THREE.MathUtils.radToDeg(n.z),i}rotationToQuaternion(e,t){const n=t||new this.THREE.Quaternion;return this.tempEuler.x=this.THREE.MathUtils.degToRad(e.x),this.tempEuler.y=this.THREE.MathUtils.degToRad(e.y),this.tempEuler.z=this.THREE.MathUtils.degToRad(e.z||0),this.tempEuler.order=convertRotation_Conversion.eulerOrder,n.setFromEuler(this.tempEuler)}}convertRotation_Conversion.eulerOrder="YXZ",function(e){e.LEGACY="legacy",e.API="api"}(o||(o={})),function(e){e.PHASE_CHANGE="application.phasechange",e.APP_CHANGE="application.appchange"}(a||(a={})),function(e){e.UNKNOWN="application.unknown",e.WEBVR="application.webvr",e.SHOWCASE="application.showcase",e.WORKSHOP="application.workshop"}(l||(l={})),function(e){e.UNINITIALIZED="appphase.uninitialized",e.WAITING="appphase.waiting",e.LOADING="appphase.loading",e.STARTING="appphase.starting",e.PLAYING="appphase.playing",e.ERROR="appphase.error"}(c||(c={}));n(17403);var h=n(5477);const p=new h.Z("asset.registerIcon");class SvgLoader{constructor(e){this.queue=e}async load(e){const t=await this.queue.get(e,{responseType:"text"}),n=document.createElement("div");n.innerHTML=t;const i=n.querySelector("svg");if(!i)throw Error("Failed trying to load "+e+"as an svg.");const s=i.getAttribute("width"),r=i.getAttribute("height");return s||r?(r&&!s&&(p.warn(e,"does not have a defined width. Defaulting width equal to height"),i.setAttribute("width",r)),s&&!r&&(p.warn(e,"does not have a defined height. Defaulting height equal to width"),i.setAttribute("height",s))):(p.warn(e,"does not have a defined size. Defaulting to a 128x128 resolution"),i.setAttribute("width",SvgLoader.defaultResolution),i.setAttribute("height",SvgLoader.defaultResolution)),new Promise((e=>{const t=new Image;t.onload=()=>e(t),t.src=URL.createObjectURL(new Blob([i.outerHTML],{type:"image/svg+xml"}))}))}}SvgLoader.defaultResolution="128";Math.PI;var m;!function(e){e.MOVE="camera.move"}(m||(m={}));new h.Z("broadcast.move");new h.Z("command.zoom");var f,g;!function(e){e.CHANGE_START="floors.changestart",e.CHANGE_END="floors.changeend"}(f||(f={})),function(e){e.POSITION_UPDATED="label.positionupdated"}(g||(g={}));var v,y,b,S,E=n(31511);!function(e){e.HOVER="tag.hover",e.CLICK="tag.click",e.LINK_OPEN="tag.linkopen"}(v||(v={})),function(e){e.NONE="mattertag.media.none",e.PHOTO="mattertag.media.photo",e.VIDEO="mattertag.media.video",e.RICH="mattertag.media.rich"}(y||(y={})),function(e){e.NONE="tag.chunk.none",e.TEXT="tag.chunk.text",e.LINK="tag.chunk.link"}(b||(b={})),function(e){e.NAVIGATION="tag.link.nav",e.MODEL="tag.link.model",e.EXT_LINK="tag.link.ext"}(S||(S={}));new h.Z("mattertag-util");new h.Z("mattertag.add");new h.Z("mattertag.edit");var T;!function(e){e.LABEL="label",e.DESCRIPTION="description",e.MEDIA="media"}(T||(T={}));new h.Z("command.editOpacity");n(66745),n(6157);var w=n(14832);E.Uv.Transition.FLY,w.n.Interpolate,E.Uv.Transition.FADEOUT,w.n.FadeToBlack,E.Uv.Transition.INSTANT,w.n.Instant;var x;!function(e){e.CHANGE_START="viewmode.changestart",e.CHANGE_END="viewmode.changeend"}(x||(x={}));new h.Z("move-to-mode-command");var _,M;!function(e){e.MODEL_LOADED="model.loaded"}(_||(_={})),function(e){e.NONE="intersectedobject.none",e.MODEL="intersectedobject.model",e.TAG="intersectedobject.tag",e.SWEEP="intersectedobject.sweep",e.UNKNOWN="intersectedobject.unknown"}(M||(M={}));const O=new h.Z("sdk.textureLoader");class TextureLoader_SvgLoader{constructor(e){this.queue=e}async load(e){const t=await this.queue.get(e,{responseType:"text"}),n=document.createElement("div");n.innerHTML=t;const i=n.querySelector("svg");if(!i)throw Error("Failed trying to load "+e+"as an svg.");const s=i.getAttribute("width"),r=i.getAttribute("height");return s||r?(r&&!s&&(O.warn(e,"does not have a defined width. Defaulting width equal to height"),i.setAttribute("width",r)),s&&!r&&(O.warn(e,"does not have a defined height. Defaulting height equal to width"),i.setAttribute("height",s))):(O.warn(e,"does not have a defined size. Defaulting to a 128x128 resolution"),i.setAttribute("width",TextureLoader_SvgLoader.defaultResolution),i.setAttribute("height",TextureLoader_SvgLoader.defaultResolution)),new Promise((e=>{const t=new Image;t.onload=()=>e(t),t.src=URL.createObjectURL(new Blob([i.outerHTML],{type:"image/svg+xml"}))}))}}TextureLoader_SvgLoader.defaultResolution="128";new h.Z("command.takeScreenshot");var A,C,N;!function(e){e.Base64JPG="screenshot.base64.jpg",e.ArrayBufferJPG="screenshot.arraybuffer.jpg"}(A||(A={}));class EquirectangularExecutor{constructor(e,t,n,i,s,r,o,a){this.renderer=i,this.renderToTexture=s,this.viewmodeData=r,this.sweepData=o,this.sweepTextureLoader=a,this.Viewmode=t.Viewmode,this.requestTarget=n.requestTarget,this.encodeRenderTarget=n.encodeRenderTarget,this.jpegAsBase64=n.jpegAsBase64,this.getXmp=n.getXmp,this.getOrientedAngleTo=n.getOrientedAngleTo,this.forward=new e.Vector3(0,0,-1),this.sweepForward=new e.Vector3,this.viewForward=new e.Vector3}validateInput(e){return e}async exec(e,t,n){if(!this.sweepData.currentSweep||this.viewmodeData.currentMode!==this.Viewmode.Panorama)throw new Error("Can only capture equirectangular projections while stationary in a sweep");const i=this.renderer.getScene().camera,s=this.sweepData.getSweep(this.sweepData.currentSweep),r=await this.sweepTextureLoader.load(s);this.sweepForward.copy(this.forward),this.sweepForward.copy(this.forward).applyQuaternion(s.rotation).setY(0);const o=this.getOrientedAngleTo(this.sweepForward,i.getWorldDirection(this.viewForward).setY(0))+Math.PI,a=await this.requestTarget();a.setSize(EquirectangularExecutor.equirectangularRes.width,EquirectangularExecutor.equirectangularRes.height),this.renderToTexture.renderEquirectangular(r,a.target,o);const l=await this.encodeRenderTarget(a,this.getXmp(a.width,a.height,0,0));t.return(this.jpegAsBase64(l))}}EquirectangularExecutor.equirectangularRes={width:4096,height:2048},function(e){e.CLICK="INTERACTION.CLICK",e.HOVER="INTERACTION.HOVER",e.DRAG="INTERACTION.DRAG",e.DRAG_BEGIN="INTERACTION.DRAG_BEGIN",e.DRAG_END="INTERACTION.DRAG_END",e.POINTER_MOVE="INTERACTION.POINTER_MOVE",e.POINTER_BUTTON="INTERACTION.POINTER_BUTTON",e.SCROLL="INTERACTION.SCROLL",e.KEY="INTERACTION.KEY",e.LONG_PRESS_START="INTERACTION.LONG_PRESS_START",e.LONG_PRESS_END="INTERACTION.LONG_PRESS_END",e.MULTI_SWIPE="INTERACTION.MULTI_SWIPE",e.MULTI_SWIPE_END="INTERACTION.MULTI_SWIPE_END",e.PINCH="INTERACTION.PINCH",e.PINCH_END="INTERACTION.PINCH_END",e.ROTATE="INTERACTION.ROTATE",e.ROTATE_END="INTERACTION.ROTATE_END"}(C||(C={})),function(e){e.OBJ_LOADER="mp.objLoader",e.FBX_LOADER="mp.fbxLoader",e.DAE_LOADER="mp.daeLoader",e.GLTF_LOADER="mp.gltfLoader",e.SCROLLING_TUBE="mp.scrollingTube",e.TRANSFORM_CONTROLS="mp.transformControls",e.LIGHTS_COMPONENT="mp.lights",e.POINT_LIGHT="mp.pointLight",e.DIRECTIONAL_LIGHT="mp.directionalLight",e.AMBIENT_LIGHT="mp.ambientLight",e.CAMERA="mp.camera",e.INPUT="mp.input",e.XR="mp.xr"}(N||(N={}));class SensorReadingCollection{constructor(e){this.sensor=e,this.sourceMap=new Map,this.reverseSourceLookup=new Map,this.sourceId=0,this._data={}}get data(){return this._data}isItemEqual(e,t){return e.data[t].inRange===this.data[t].inRange&&e.data[t].inView===this.data[t].inView}update(){for(const[i,s]of this.sensor.readings){const r=this.addOrGetSourceId(i),o=this._data[r]||{};o.inRange=s.inRange,o.inView=s.inView,o.distanceSquared=s.distanceSq,o.direction=(e=s,t="direction",(n=(n=o.direction)||{}).x=e[t].x,n.y=e[t].y,n.z=e[t].z,n),this._data[r]=o}var e,t,n;for(const e in this.data){const t=this.reverseSourceLookup.get(e);t&&!this.sensor.readings.get(t)&&(this.sourceMap.delete(t),this.reverseSourceLookup.delete(e),delete this._data[e])}}clear(){this._data={}}addOrGetSourceId(e){const t=this.sourceMap.get(e);if(t)return t;const n="source-"+ ++this.sourceId;return this.sourceMap.set(e,n),this.reverseSourceLookup.set(n,e),n}}class DependencyFetcher_DependencyFetcher{constructor(...e){this.dependencies=e}async getDependencies(){return Promise.all(this.dependencies)}static extend(e,...t){return new DependencyFetcher_DependencyFetcher(...e.dependencies,...t)}static combine(e,t){return new DependencyFetcher_DependencyFetcher(...e.dependencies,...t.dependencies)}}class ClassFactory_ClassFactory{constructor(e,...t){this.ctor=e,this.args=t}create(...e){return new this.ctor(...this.args,...e)}}class SdkCollection_SdkCollection{constructor(e,t,n){this.dependencies=e,this.subscriptionFactory=t,this.dataFactory=n,this.dirty=!0,this.observers=new Set,this.currentData=n.create(...e);this.changeSubscription=this.subscriptionFactory.create(new class DirtinessObserver{constructor(e){this.collection=e}onChanged(){this.collection.dirty=!0;for(const e of this.collection.observers)e.onChanged()}}(this),...this.dependencies),this.changeSubscription.cancel()}static async create(e,t,n){const i=await e.getDependencies();return new SdkCollection_SdkCollection(i,t,n)}getData(){return this.currentData.data}subscribe(e){const t=this.dependencies;const n=new class CollectionChangeObserver{constructor(e){this.sdkCollection=e,this.needsUpdate=!0,this.diffRecord={added:new Map,removed:new Map,updated:new Map},this.dataView=e.dataFactory.create(...t)}get dirty(){return this.needsUpdate}readDiff(){const{added:e,removed:t,updated:n}=this.diffRecord;if(e.clear(),t.clear(),n.clear(),!this.dirty)return this.diffRecord;this.sdkCollection.update();const i=this.sdkCollection.currentData;for(const t in i.data)this.dataView.data.hasOwnProperty(t)?this.dataView.isItemEqual(i,t)||n.set(t,i.data[t]):e.set(t,i.data[t]);for(const e in this.dataView.data)i.data.hasOwnProperty(e)||t.set(e,this.dataView.data[e]);return this.dataView.update(),this.needsUpdate=!1,this.diffRecord}onChanged(){this.needsUpdate=!0}renew(){this.sdkCollection.addObserver(this)}cancel(){this.sdkCollection.removeObserver(this)}}(this);return this.addObserver(n),n}update(){this.dirty&&(this.currentData.update(),this.dirty=!1)}addObserver(e){0===this.observers.size&&(this.changeSubscription.renew(),this.dirty=!0),this.observers.add(e)}removeObserver(e){this.observers.delete(e),0===this.observers.size&&(this.changeSubscription.cancel(),this.currentData.clear())}}var D=n(90614),I=n(46686);function L(e,t){!function(e,t){e.x=t.x,e.y=t.y}(e,t),e.z=t.z}var P=n(74566);class SensorStateObservable{constructor(){this._data={origin:{x:0,y:0,z:0},forward:{x:0,y:0,z:-1}}}get data(){return this._data}equals(e){const t=1e-5;return(0,P.wo)(this.data.origin,e.data.origin,t)&&(0,P.wo)(this.data.forward,e.data.forward,t)}copy(e){L(this._data.origin,e.data.origin),L(this._data.forward,e.data.forward)}update(e){L(this._data.origin,e.frustum.origin),L(this._data.forward,e.frustum.forward)}}var R=n(13855);class executor_createSensor_CreateSensorExecutor{constructor(e,t,n,i,s){this.sdkModule=e,this.sensorFactories=t,this.sensors=n,this.sensorMap=i,this.removerMap=s}validateInput(e){if(!(0,R.p)(D.dE,e.type))throw Error(e.type+" is not a valid sensor type");return this.sensorFactories[e.type].validateInput(e)}async exec(e,t,n){const i=this.sensorFactories[e.type].create(e,this.sensors),s="sensor-"+ ++executor_createSensor_CreateSensorExecutor.nextSensorId;this.sensorMap.set(s,i);const r=I.l.create(new DependencyFetcher_DependencyFetcher(i),new SensorStateSubscriptionFactory,new ClassFactory_ClassFactory(SensorStateObservable)),o=this.sdkModule.addObservable(s,r),a=SdkCollection_SdkCollection.create(new DependencyFetcher_DependencyFetcher(i),new SensorReadingSubscriptionFactory,new ClassFactory_ClassFactory(SensorReadingCollection)),l=this.sdkModule.addCollection(s,a);this.removerMap.set(s,{dispose(){o.dispose(),l.dispose()}}),t.return({sensorId:s})}}executor_createSensor_CreateSensorExecutor.nextSensorId=0;class SensorStateSubscriptionFactory{create(e,t){return t.frustum.observe(new DependencyObserverAdaptor(e))}}class SensorReadingSubscriptionFactory{create(e,t){return t.onReadingsUpdated(new DependencyObserverAdaptor(e))}}class DependencyObserverAdaptor{constructor(e){this.dependencyObserver=e}notify(){this.dependencyObserver.onChanged()}}var k=n(44155);Math.PI;class executor_createSource_CreateSourceExecutor{constructor(e,t){this.sourceFactories=e,this.sourceMap=t}validateInput(e){if(!(0,R.p)(k.PO,e.type))throw Error(e.type+" is not a valid source type");return this.sourceFactories[e.type].validateInput(e)}exec(e,t,n){const i=this.sourceFactories[e.type].create(e),s="source-"+ ++executor_createSource_CreateSourceExecutor.nextSourceId;this.sourceMap.set(s,i),t.return({sourceId:s,type:e.type,volume:i.describeVolume()})}}executor_createSource_CreateSourceExecutor.nextSourceId=0;var U,B,F;!function(e){e.FPS="stat.fps"}(U||(U={}));!function(e){e.ALIGNED="aligned",e.UNALIGNED="unaligned"}(B||(B={})),function(e){e.UNPLACED="unplaced",e.AUTO="auto",e.MANUAL="manual"}(F||(F={}));var V,H,j,G=n(85111);class CurrentSweepObservable{constructor(e,t){this.currentSweep=Object.assign(Object.assign({},CurrentSweepObservable.empty),{floorInfo:Object.assign({},CurrentSweepObservable.empty.floorInfo),neighbors:[],position:Object.assign({},CurrentSweepObservable.empty.position),rotation:Object.assign({},CurrentSweepObservable.empty.rotation)}),this.Viewmode=e.Viewmode,this.sweepPlacementConverter=t.sweepPlacementConverter}get data(){return this.currentSweep}equals(e){const t=G.Z.epsilon;return this.currentSweep.id===e.data.id&&this.currentSweep.enabled===e.data.enabled&&this.currentSweep.alignmentType===e.data.alignmentType&&this.currentSweep.placementType===e.data.placementType&&this.currentSweep.floorInfo.id===e.data.floorInfo.id&&this.currentSweep.floorInfo.sequence===e.data.floorInfo.sequence&&this.compareNeighbors(e.currentSweep)&&(0,P.wo)(this.currentSweep.position,e.data.position,t)&&(0,P.wo)(this.currentSweep.rotation,e.data.rotation,t)}copy(e){this.copySweep(e.data)}update(e,t,n,i,s){const r=e.currentSweepObject;if(!r||e.transition.active||t.transition.active||!t.isInside()&&t.currentMode!==this.Viewmode.Outdoor)return void this.copySweep(CurrentSweepObservable.empty);let o;try{o=n.getFloor(r.floorId||"")}catch(e){o={id:void 0,index:void 0}}const a=i.getIdForSweep(r);this.currentSweep.uuid=r.uuid,this.currentSweep.sid=a,this.currentSweep.id=a,this.currentSweep.enabled=r.enabled,this.currentSweep.alignmentType=this.sweepPlacementConverter.toSdkAlignment(r.alignmentType),this.currentSweep.placementType=this.sweepPlacementConverter.toSdkPlacement(r.placementType),this.currentSweep.neighbors=[...r.neighbours],L(this.currentSweep.position,r.position),L(this.currentSweep.rotation,r.rotation),this.currentSweep.alignmentType===B.UNALIGNED&&this.currentSweep.placementType===F.UNPLACED?(this.currentSweep.floorInfo.id=void 0,this.currentSweep.floorInfo.sequence=void 0):(this.currentSweep.floorInfo.id=o.id?s.getIdFromCwfId(o.id):o.id,this.currentSweep.floorInfo.sequence=o.index)}copySweep(e){this.currentSweep.uuid=e.uuid,this.currentSweep.sid=e.sid,this.currentSweep.id=e.id,this.currentSweep.enabled=e.enabled,this.currentSweep.alignmentType=e.alignmentType,this.currentSweep.placementType=e.placementType,this.currentSweep.floorInfo.id=e.floorInfo.id,this.currentSweep.floorInfo.sequence=e.floorInfo.sequence,this.currentSweep.neighbors=[...e.neighbors],L(this.currentSweep.position,e.position),L(this.currentSweep.rotation,e.rotation)}compareNeighbors(e){const t=this.currentSweep.neighbors.length;for(let n=0;n<t;++n)if(this.currentSweep.neighbors[n]!==e.neighbors[n])return!1;return t===e.neighbors.length}}CurrentSweepObservable.empty={uuid:"",sid:"",id:"",enabled:!1,alignmentType:B.ALIGNED,placementType:F.UNPLACED,floorInfo:{id:void 0,sequence:void 0},neighbors:[],position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},function(e){e.ENTER="sweep.enter",e.EXIT="sweep.exit"}(V||(V={}));!function(e){e.ENUM1="test.enum1",e.ENUM2="test.enum2"}(H||(H={})),function(e){e.STARTED="tour.started",e.STOPPED="tour.stopped",e.ENDED="tour.ended",e.STEPPED="tour.stepped"}(j||(j={}));new h.Z("sdk: tours");Symbol.iterator;var z=n(1154),W=n(89034),K=n(93093),Y=n(87393),q=n(26517),Z=n(7692),$=n(81052),Q=n(33299),X=n(8428),J=n(41907),ee=n(47076),te=n(64038),ne=n(32548),ie=n(37632),se=n(40330),re=n(23400),oe=n(11679),ae=n(25551),le=n(76641),ce=n(90525),de=n(31991),ue=n(75977),he=n(48730),pe=n(57183),me=n(13773),fe=n(65143),ge=n(99380),ve=n(40825),ye=n(15019),be=n(93037);class SettingGetCommand extends be.m{constructor(e){super(),this.payload={key:e}}}SettingGetCommand.id="SETTING_GET";class SettingUpdateCommand extends be.m{constructor(e,t){super(),this.payload={key:e,value:t}}}SettingUpdateCommand.id="SETTING_UPDATE";var Se=n(26583),Ee=n(94772),Te=n(65171),we=n(38950),xe=n(34612),_e=n(23676),Me=n(84586),Oe=n(77364),Ae=n(77280),Ce=n(22878),Ne=n(12622),De=n(92214),Ie=n(50084),Le=n(9986),Pe=n(15099),Re=n(82722),ke=n(39823),Ue=n(56044),Be=n(88507),Fe=n(61709),Ve=n(81111),He=n(64792),je=n(57073),Ge=n(97966),ze=n(368),We=n(29755),Ke=n(61903),Ye=n(53549),qe=n(60649),Ze=n(72699),$e=n(37363),Qe=n(49807),Xe=n(19282),Je=n(87278),et=n(24673),tt=n(28452),nt=n(62630),it=n(46446),st=n(63452),rt=n(42374),ot=n(98226),at=n(56709),lt=n(17566),ct=n(36598),dt=n(7471),ut=n(39440),ht=n(99160),pt=n(9544),mt=n(28260),ft=n(8259),gt=n(48452),vt=n(18236),yt=n(49315),bt=n(2212),St=n(39808),Et=n(31013),Tt=n(34118);class LazyLoader{constructor(){this.module=null,this.loaderReady=new Et.Q,this.loader=null}setLoader(e){this.loader||(this.loader=e,this.loaderReady.resolve())}async getModule(){if(this.module)return this.module;if(await this.loaderReady,this.loader&&(this.module=await this.loader()),this.module)return this.module;throw new Error("There was an error setting up the factory")}}async function wt(e,t,n,i){const s=await async function(){return await n.getAppKey("showcase","sdk_interface_version")||""}(),r=new z.M;let a;try{a=await r.load(s)}catch(e){throw Error("Unable to fetch the sdk interface. The sdk will be disabled. "+e)}const l={THREE:bt},c={MpSdkAuthentication:$.w,RenderLayers:Q.o,OptionsKey:X.gx,Application:Le.Mx,AppPhase:Le.nh,AppPhaseChangeMessage:J.LZ,CameraTransitionType:w.n,GetFloorIntersectCommand:ee.Z,StartMoveToFloorMessage:te.S,EndMoveToFloorMessage:ne.P,MoveToFloorIndexCommand:ie.h9,ShowAllFloorsCommand:ie.EU,MattertagMediaType:se.L,RemoveMattertagCommand:re.Gn,TagDescriptionChunkType:oe.z,TagLinkType:ae.U,AddMattertagCommand:re.Fz,EditMattertagCommand:re.Ek,MattertagLinkOpenedMessage:le.Ik,NavigateToMattertagCommand:ce.Y,ModelDataLoadedMessage:de.Z,ModelColliderTarget:ue.S,NavigateToSweepCommand:he.ju,MeasuringPhase:He.au,SettingGetCommand:SettingGetCommand,SettingUpdateCommand:SettingUpdateCommand,PuckCollider:Se.YY,PinClickedMessage:pe.F7,PinHoverChangeMessage:pe.tP,PinHeadMesh:me.$,InstancedPinHeads:ye.z,PinType:fe.Er,ChangePinOpacityCommand:ge._Y,MovePinCommand:ge.I$,UpdatePinCommand:ge.tE,RemovePinCommand:ge.OL,FocusOnPinInsideCommand:he.OR,SelectAnnotationCommand:vt.oM,SweepAlignmentType:Ee.z9,SweepPlacementType:Ee.hU,BeginMoveToSweepMessage:Te.Z,EndMoveToSweepMessage:we.Z,ToggleToolCommand:xe.tT,Tools:_e.w1,TourStartedMessage:Me.oR,TourStoppedMessage:Me.NR,TourEndedMessage:Me.Mt,TourSteppedMessage:Me.Vx,Color:Oe.I,Vectors:Ae.f,Viewmode:Ce.Ey,CommandViewmode:Ne.BD,ChangeViewmodeCommand:Ne._i,BeginSwitchViewmodeMessage:De.Z,EndSwitchViewmodeMessage:Ie.Z,GetScreenPositionCommand:Qe.b,ZoomInCommand:Xe.bj,ZoomResetCommand:Xe.ob,ZoomSetCommand:Xe.ts,SourceType:ct.SourceType,sensorVolumes:{sphere:dt.b,box:ut.k,cylinder:ht.X},TourState:ft.Vs,MediaType:gt.DD},d=xt(t),h=function(e,t){const n=(async()=>{const t=(await e.getModule(rt.default)).getSignedUrls();return new Y.Z(t)})();return{applicationData:e.market.waitForData(Le.pu),cameraData:e.market.waitForData(Pe.M_),canvasData:e.market.waitForData(Re.W),cursorController:e.getModuleBySymbol(u.y.CURSOR_CONTROLLER),deepLinks:e.getModuleBySymbol(u.y.DEEP_LINKS),floorData:e.market.waitForData(ke.i),floorViewData:e.market.waitForData(Ue.c),labelData:e.market.waitForData(Be.D),mattertagData:e.market.waitForData(Fe.n),mattertagViewData:e.market.waitForData(Ve.P5),measurementModeData:e.market.waitForData(je.X),modelData:e.market.waitForData(Ge.T),pinViewData:e.market.waitForData(ve.B),annotationsViewData:e.market.waitForData(yt.A),raycasterData:e.market.waitForData(ze.P),roomData:e.market.waitForData(We.Z),settingsData:e.market.waitForData(Ke.e),sweepData:e.market.waitForData(Ye.Z),sweepViewData:e.market.waitForData(qe.D),tourData:e.market.waitForData(Ze.k),viewmodeData:e.market.waitForData($e.O),appPhaseModule:e.getModule(Je.default),commonControlsModule:e.getModule(et.default),floorCasterModule:e.getModule(tt.default),mattertagDataModule:e.getModule(nt.default),mattertagMeshModule:e.getModule(it.default),mattertagViewDataModule:e.getModule(st.default),meshQuery:e.getModuleBySymbol(u.y.MESH_QUERY),modelDataModule:e.getModule(rt.default),modelMeshModule:e.getModuleBySymbol(u.y.MODEL_MESH),meshData:e.market.waitForData(St._),navigationModule:e.getModule(ot.default),renderToTextureModule:e.getModule(at.default),sceneModule:t.getModule(),sensorModule:e.getModule(pt.K),settingsModule:e.getModuleBySymbol(u.y.SETTINGS),tourControlsModule:e.getModuleBySymbol(u.y.TOUR_CONTROLS),webglRendererModule:e.getModuleBySymbol(u.y.WEBGL_RENDERER),zoomControlModule:e.getModule(mt.default),sweepTextureLoader:n}}(t,i),p=new URLSearchParams(window.location.search).get("useLegacyIds"),m=null===p||parseInt(p,10)?o.LEGACY:o.API,f=!!(await t.market.waitForData(Ke.e)).tryGetProperty(Tt.RY,!1);a.setup(e,l,c,d,h,{idOption:m,useNewTags:f})}function xt(e){return{loadImage:W.p,waitForUpdate:()=>e.after(d.A.End),subscribe:(t,n)=>e.subscribe(t,n),addBinding:(t,n)=>e.commandBinder.addBinding(t,n),issueCommand:t=>e.commandBinder.issueCommand(t),requestTarget:()=>e.commandBinder.issueCommand(new K.oM),getRenderLayer:t=>e.getRenderLayer(t),jpegAsBase64:lt.jJ,encodeRenderTarget:lt.vP,getXmp:lt.fY,getOrientedAngleTo:q.k2,screenPositionToNDC:Z.z5,ndcToWorldPosition:Z.st,worldToScreenPosition:Z.q9}}},40529:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ErrorType:()=>v,default:()=>ErrorGui});var i=n(57227),s=n(39142),r=n(10854),o=n(2252),a=n(87207),l=n(68472),c=n(75673),d=n(81826);const u=e=>({problem:"",solution:e.t(r.Z.ERROR_BROWSER_SOLUTION),explanation:e.t(r.Z.ERROR_BROWSER_EXPLANATION),actions:(0,o.tq)()?"":["<div id='browser-tiles'>","<a href='https://www.google.com/chrome/browser/' target='_blank'>","<div class='tile'>",`<img src=${a}>`,"</div>","</a>","<a href='https://www.mozilla.org/en-US/firefox/new/' target='_blank'>","<div class='tile'>",`<img src=${l}>`,"</div>","</a>","<a href='https://www.microsoft.com/en-us/edge' target='_blank'>","<div class='tile'>",`<img src=${c}>`,"</div>","</a>","<a href='https://support.apple.com/en-us/HT204416' target='_blank'>","<div class='tile'>",`<img src=${d}>`,"</div>","</a>","</div>"].join("")}),h="https://support.matterport.com/",p=e=>{const t=e.t(r.Z.ERROR_CONTEXT_LOST_ACTIONS,{"support-url":"https://support.matterport.com/"});return{problem:e.t(r.Z.ERROR_CONTEXT_LOST_PROBLEM),solution:"",explanation:"",actions:t}},m=e=>Object.assign(Object.assign({},u(e)),{problem:`${e.t(r.Z.ERROR_WEBGL_UNSUPPORTED_PROBLEM)}`}),f=e=>{const t=h,n=(0,o.tq)()?e.t(r.Z.ERROR_GENERIC_ACTIONS_MOBILE,{"support-url":t}):e.t(r.Z.ERROR_GENERIC_ACTIONS,{"browsers-url":"#install-browser","support-url":t});return{problem:e.t(r.Z.ERROR_GENERIC_PROBLEM),solution:e.t(r.Z.ERROR_GENERIC_SOLUTION),explanation:"",actions:n}},g=e=>{const t=e.t(r.Z.ERROR_LOADING_FAILED_ACTIONS,{"support-url":"https://support.matterport.com/s/article/Oops-Model-Not-Available"});return{problem:e.t(r.Z.ERROR_LOADING_FAILED_PROBLEM),solution:"",explanation:"",actions:t}};var v;!function(e){e[e.UNSUPPORTED=1]="UNSUPPORTED",e[e.WEBGL=2]="WEBGL",e[e.WEBGL_CONTEXT_LOST=3]="WEBGL_CONTEXT_LOST",e[e.GENERIC=4]="GENERIC"}(v||(v={}));class ErrorGui extends i.Y{constructor(){super(...arguments),this.name="error-gui",this.errorType=null}async init(e,t){this.container=document.querySelector("#error-container"),this.problem=document.querySelector("#error-problem"),this.solution=document.querySelector("#error-solution"),this.explanation=document.querySelector("#error-explanation"),this.actions=document.querySelector("#error-actions"),this.localeModule=await t.getModule(s.default)}get currentErrorType(){return this.errorType}showError(e){switch(this.errorType=e,e){case v.UNSUPPORTED:this.populateErrorScreen(m);break;case v.WEBGL:this.populateErrorScreen(f);break;case v.WEBGL_CONTEXT_LOST:this.populateErrorScreen(p);break;case v.GENERIC:default:this.populateErrorScreen(g)}const t=this.actions.querySelector('[href="#install-browser"]');t&&t.addEventListener("click",(e=>{e.preventDefault(),this.populateErrorScreen(u)}))}hideError(){this.errorType=null,this.container.classList.add("hidden");for(const e of[this.problem,this.solution,this.explanation,this.actions])e.innerHTML=""}populateErrorScreen(e){const t=e(this.localeModule);this.container.classList.remove("hidden"),this.problem.innerText=t.problem,this.solution.innerText=t.solution,this.explanation.innerText=t.explanation,this.actions.innerHTML=t.actions}}},66728:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcaseGui});var i=n(67294),s=n(20745),r=n(57227),o=n(85893),a=n(94184),l=n.n(a),c=n(41907),d=n(9986),u=n(23676),h=n(60405),p=n(10854),m=n(81402),f=n(87100),g=n(13855),v=n(27861),y=n(11249),b=n(90190),S=n(32683),E=n(57340),T=n(2252),w=n(36616),x=n(71843),_=n(78576),M=n(87982),O=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let A=class VrModalControls extends i.Component{constructor(e){super(e),this.handleClick=()=>{this.context.commandBinder.issueCommand(new x.Bz(w.P.VR_SELECT,!this.props.open))}}render(){const e=this.context.locale.t(p.Z.VIEW_IN_VR);return(0,o.jsx)(M.hU,Object.assign({className:"view-in-vr",onClick:this.handleClick,ariaLabel:e},{children:(0,o.jsx)(_.oO,Object.assign({content:e,position:_.lZ.UP,tooltipTimeout:(0,T.Jm)()?1e3:void 0},{children:(0,o.jsx)("span",{className:"icon icon-vr"})}))}))}};A.contextType=h.I,A=O([E.Z],A);var C=n(65313),N=n(8259),D=n(36669),I=n(68168);var L;!function(e){e[e.flash=0]="flash",e[e.expanded=1]="expanded",e[e.collapsed=2]="collapsed"}(L||(L={}));var P=n(82971),R=n(5477),k=n(61116);const U=new R.Z("pause-button");class PauseButton extends i.Component{constructor(e){super(e),this.justEnded=!1,this.stopTour=async e=>{this.context.analytics.trackGuiEvent("tour_stopped"),e.preventDefault();try{this.context.commandBinder.issueCommand(new k.vy)}catch(e){U.debug(e)}},this.state={justPaused:!1}}componentDidUpdate(){this.state.justPaused&&this.setState({justPaused:!1}),this.justEnded=!1}UNSAFE_componentWillReceiveProps(e){!this.props.tourPlaying||e.tourPlaying||this.justEnded||this.setState({justPaused:!0}),this.props.tourEnded&&(this.justEnded=!0)}render(){const{tourPlaying:e}=this.props,{justPaused:t}=this.state;return(0,o.jsx)("div",Object.assign({id:"pause-button",onClick:this.stopTour,onTouchMove:this.stopTour,onTouchStart:this.stopTour,"data-cy":"pause-button"},{children:!e&&(0,o.jsx)("img",{src:n(31896),className:l()({justPaused:t}),alt:"","aria-hidden":"true"})}))}}PauseButton.contextType=h.I;var B,F=n(8428),V=n(12622),H=n(83233),j=n(4662),G=n(34612),z=n(54068),W=n(17423),K=n(61445),Y=n(22397),q=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Z=B=class MeasurementModeButton extends i.Component{constructor(e,t){super(e),this.modeButtonClicked=()=>{const e=this.props.openTool!==u.w1.MEASUREMENTS;e&&this.context.analytics.trackToolGuiEvent("measurements","measure_mode"),this.context.commandBinder.issueCommand(new G.tT(u.w1.MEASUREMENTS,e))},this.localized={measurementMode:t.locale.t(p.Z.MEASUREMENT_MODE)}}render(){const{className:e,tooltipTimeout:t,openTool:n}=this.props,i=this.localized.measurementMode,s=n===u.w1.MEASUREMENTS?K.BN.ACTIVE:K.BN.ENABLED;return(0,o.jsxs)("div",Object.assign({className:l()("measure-mode-button",e)},{children:[(0,o.jsx)(M.hU,Object.assign({onClick:this.modeButtonClicked,buttonState:s,ariaLabel:i},{children:(0,o.jsx)(_.oO,Object.assign({content:i,position:_.lZ.UP,tooltipTimeout:t},{children:(0,o.jsx)("span",{className:"icon icon-tape-measure"})}))})),(0,o.jsx)(Y.Z,{title:p.Z.MEASUREMENT_NUDGE_TITLE,message:p.Z.MEASUREMENT_NUDGE_MESSAGE,showTimeout:B.SHOW_NUDGE_TIMEOUT,dismissTimeout:B.DISMISS_NUDGE_TIMEOUT,appSettingsKey:z.b,localStorageSettingsKey:W.F.MeasurementUserNudgeSeen,analyticsKeys:{tool:"measurements",guiAction:"measure_nudge"}})]}))}};Z.contextType=h.I,Z.SHOW_NUDGE_TIMEOUT=6e4,Z.DISMISS_NUDGE_TIMEOUT=1e4,Z=B=q([E.Z],Z);var $=n(59379),Q=n(89049),X=n(33441),J=n(7765),ee=n(4731);class BottomUiComponent extends i.Component{constructor(e,t){super(e,t),this.isUnmounting=!1,this.touchDevice=(0,T.Jm)(),this.bindings=[],this.viewmodeToClass={[V.BD.INSIDE]:"inside",[V.BD.OUTSIDE]:"outside",[V.BD.DOLLHOUSE]:"dollhouse",[V.BD.FLOORPLAN]:"floorplan",[V.BD.TRANSITIONING]:"transitioning"},this.checkShowReel=()=>{const{tourState:e}=this.props,{settings:t}=this.context,n=t.tryGetProperty(F.gx.HighlightReel,!0);if(e.totalSteps>0&&n){const e=this.getHlStartupValue();switch(e){case L.expanded:case L.flash:(0,m.gw)(100).then((()=>this.showReel(e)))}}},this.showReel=e=>{this.isUnmounting||(this.onToggleHLR(!0),e===L.flash&&(0,m.gw)(3e3).then(this.dismissReel))},this.dismissReel=()=>{this.isUnmounting||this.onToggleHLR(!1)},this.onViewingControlsToggle=({show:e})=>{this.setState({autohide:!e})},this.updateViewportSize=()=>{this.isUnmounting||this.setState({viewportHeight:this.context.mainDiv.offsetHeight})},this.isReelEnabled=()=>this.state.viewportHeight>=400&&(0,D.ir)(this.context.settings),this.isFloorsEnabled=()=>{const{settings:e}=this.context,t=e.tryGetProperty(S.ws,!0),n=e.tryGetProperty(F.gx.FloorSelect,!0);return t&&n},this.onToggleHLR=e=>{this.isReelEnabled()&&this.props.tourState.totalSteps>0&&this.setState({reelOpen:e})},this.toggleShareModal=()=>{const e=this.props.openModal===w.P.SHARE;this.context.analytics.trackGuiEvent("click_share_button"),this.context.commandBinder.issueCommand(new x.Bz(w.P.SHARE,!e))},this.renderModeControls=()=>{const{unaligned:e,viewmode:t}=this.props;return(0,o.jsx)(v.V,{unaligned:e,viewmode:t,className:"showcase-viewmode-controls"},"mode_controls")},this.renderFloorPlanControls=()=>{const{viewmode:e}=this.props;return(0,o.jsx)(b.d,{viewmode:e,iconStyle:!0,className:"showcase-floor-controls"},"floor_controls")},this.renderNotesModeButton=()=>{const{openTool:e}=this.props;return(0,o.jsx)(j.H,{tooltipTimeout:this.touchDevice?1e3:void 0,openTool:e,className:"showcase-notes-button"},"notes_mode_button")},this.renderMeasurementModeButton=()=>{const{openTool:e}=this.props;return(0,o.jsx)(Z,{tooltipTimeout:this.touchDevice?1e3:void 0,openTool:e,className:"showcase-measurements-button"},"measurement_mode_button")},this.renderHighlightReel=(e,t)=>{const{openTool:n,tourState:i,tourMode:s}=this.props,{tourPlaying:r,highlights:a,activeStep:l,transition:c}=i;return(0,o.jsx)(P.e,{openTool:n,tourMode:s,transition:c,activeStep:l,highlights:a,tourPlaying:r,reelOpen:e,reelEnabled:t,onToggleHLR:this.onToggleHLR})},this.renderFooter=e=>{const{openTool:t,openModal:n,tourMode:i}=this.props,s=i===N.zz.STORIES,{reelOpen:r}=this.state,a=null===t,c=r&&!s;return(0,o.jsx)("div",Object.assign({className:l()("footer-ui",{"footer-ui-shaded":c})},{children:a&&(0,o.jsx)(Q.Z,{openModal:n,modelRatingEnabled:e})}))},this.renderRightControls=()=>{const e=[],{vrEnabled:t,openModal:n,shareEnabled:i}=this.props,s=(0,T.O6)();e.push((0,o.jsx)("span",{className:"divider"},"divider_1"));const r=this.context.locale.t(p.Z.SOCIAL_SHARING);return i&&e.push((0,o.jsx)(M.hU,Object.assign({onClick:this.toggleShareModal,ariaLabel:r},{children:(0,o.jsx)(_.oO,Object.assign({content:r,position:_.lZ.UP_LEFT,tooltipTimeout:this.touchDevice?1e3:void 0},{children:(0,o.jsx)("span",{className:"icon icon-share"})}))}),"toggle_share_modal")),t&&e.push((0,o.jsx)(A,{open:n===w.P.VR_SELECT},"vr_modal_controls")),s&&e.push((0,o.jsx)(C.Z,{},"fullscreen_controls")),e},this.state={reelOpen:!1,viewportHeight:t.mainDiv.offsetHeight,autohide:!1},this.onResize=(0,H.D)(this.updateViewportSize,250)}componentDidMount(){const{messageBus:e}=this.context;window.addEventListener("resize",this.onResize),this.bindings.push(e.subscribe(I.ps,this.onViewingControlsToggle)),this.checkShowReel()}componentWillUnmount(){this.isUnmounting=!0,this.bindings.map((e=>e.cancel())),window.removeEventListener("resize",this.onResize)}componentDidUpdate(e){!(e.tourState.totalSteps>0)&&this.props.tourState.totalSteps>0&&this.checkShowReel()}getHlStartupValue(){if((0,f.eY)("note","")||(0,f.eY)("tag",""))return L.collapsed;const e=this.props.tourState.highlights.some((e=>e.snapshot.is360))?L.expanded:L.flash,t=(0,f.eY)("hl",e);return(0,g.p)(L,t)?t:e}render(){const{measurementsModeEnabled:e,notesEnabled:t,openModal:n,openTool:i,showStoryTour:s,toolPanelLayout:r,tourMode:a,tourState:c,unaligned:d,viewmode:h}=this.props,{tourPlaying:p,tourEnded:m,totalSteps:f,activeStep:g,currentStep:v,highlights:b}=c,{reelOpen:S,autohide:E,viewportHeight:T}=this.state,{settings:x}=this.context,_=this.viewmodeToClass[h]||"",M=0===f,O=a===N.zz.STORIES,A=T>=400,C=this.isReelEnabled()&&!M,D=C&&S&&!i&&!n,I=i!==u.w1.MEASUREMENTS,L=this.isFloorsEnabled(),P=t&&!d,R=e&&!d,k=x.tryGetProperty(J.i,!1),U={"reel-open":D,"modal-open":!!n,"tour-playing":p,"stories-tour-showing":s,autohide:E},B=!(!n||n===w.P.CTA&&O||i),F=l()("bottom-controls",{"faded-out":B});return(0,o.jsxs)("div",Object.assign({id:"bottom-ui",className:l()("bottom-ui",U,_)},{children:[(0,o.jsx)(PauseButton,{tourPlaying:p,tourEnded:m}),(0,o.jsxs)("div",Object.assign({className:F},{children:[(0,o.jsxs)($.i,Object.assign({className:"controls"},{children:[(0,o.jsx)(y.Z,{toolPanelLayout:r,activeTool:i,activeStep:g,currentStep:v,highlights:b||[],tourPlaying:p,tourMode:a,reelOpen:S,hideReel:!A,onToggleHLR:this.onToggleHLR},"tour_controls"),this.renderModeControls(),L&&this.renderFloorPlanControls(),P&&this.renderNotesModeButton(),R&&this.renderMeasurementModeButton(),I&&this.renderRightControls()]})),k&&(0,o.jsx)(X.L,{})]})),this.renderHighlightReel(D,C),this.renderFooter(k)]}))}}BottomUiComponent.contextType=h.I;const te=(0,ee.j)(BottomUiComponent);var ne=n(5077),ie=n(65453),se=n(18253),re=n(34118),oe=n(73156),ae=n(56646),le=n(88507),ce=n(15099),de=n(56044),ue=n(49807),he=n(2212),pe=n(50084),me=n(92214),fe=n(64038),ge=n(32548);class RoomLabel extends i.Component{constructor(e){super(e)}render(){const{sid:e,position:t,text:n,readOnlyText:i,rotation:s,visible:r}=this.props,a={left:t.x+"px",top:t.y+"px",transform:s?`translate(-50%, -50%) rotate(${s}deg) `:"translate(-50%, -50%)"},l=i?`${n} ${i}`:n;return r?(0,o.jsx)("div",Object.assign({id:e,className:"label",style:a},{children:(0,o.jsx)("span",{children:l})})):null}}var ve=n(17536);const ye=new R.Z("label-ui");class LabelLayerComponent extends i.Component{constructor(e){super(e),this.subscriptions=[],this.reusableVector=new he.Vector3,this.isUnmounting=!1,this.inFloorPlan=e=>e===V.BD.FLOORPLAN,this.onCameraUpdate=()=>{this.inFloorPlan(this.props.viewmode)&&this.updateLabelPositions()},this.onViewTransitionStart=()=>{this.setState({inModeTransition:!0})},this.onViewTransitionEnd=async e=>{this.inFloorPlan((0,V.ty)(e.toMode))&&(this.setState({inModeTransition:!1}),this.updateLabelPositions())},this.updateFloorState=()=>{this.isUnmounting||this.setState({topMostFloorId:this.floorsViewData.topFloorId})},this.updateLabelPositions=async()=>{const e={};for(const t of this.labelData.getCollection()){this.reusableVector.set(t.position.x,t.position.y,t.position.z);const n=await this.context.commandBinder.issueCommand(new ue.b({worldPosition:this.reusableVector}));e[t.sid]=Object.assign({screenPosition:n},t)}this.isUnmounting||this.setState({labelPositions:e})},this.startMoveToFloor=()=>{this.setState({movingToFloor:!0})},this.endMoveToFloor=e=>{this.setState({movingToFloor:!1})},this.state={labelPositions:{},topMostFloorId:null,inModeTransition:!1,movingToFloor:!1}}async componentDidMount(){const e=this.context.messageBus;try{if(this.floorsViewData=await this.context.market.waitForData(de.c),this.isUnmounting)return;const e=this.floorsViewData.onChanged(this.updateFloorState);if(this.subscriptions.push(e),this.updateFloorState(),this.labelData=await this.context.market.waitForData(le.D),this.isUnmounting)return}catch(e){ye.debug(e)}this.updateLabelPositions();const t=await this.context.market.waitForData(ce.M_);this.isUnmounting||(this.subscriptions.push(t.onChanged(this.onCameraUpdate),e.subscribe(fe.S,this.startMoveToFloor),e.subscribe(ge.P,this.endMoveToFloor),e.subscribe(me.Z,this.onViewTransitionStart),e.subscribe(pe.Z,this.onViewTransitionEnd)),this.subscriptions.forEach((e=>e.renew())))}componentWillUnmount(){this.isUnmounting=!0,this.subscriptions.forEach((e=>e.cancel()))}renderLabel(e){const{currentFloorId:t}=this.props,{topMostFloorId:n,labelPositions:i,movingToFloor:s}=this.state,{floorId:r,screenPosition:a,text:l,visible:c,sid:d,rotation:u}=i[e],h=s?null:t;return(0,o.jsx)(RoomLabel,{position:a,rotation:u,text:l,visible:(!h&&n===r||h===r)&&c,sid:d},d)}render(){const{inModeTransition:e,labelPositions:t}=this.state,{viewmode:n}=this.props;if(!this.inFloorPlan(n)||e)return null;const i=[];return Object.keys(t).forEach((e=>{i.push(this.renderLabel(e))})),(0,o.jsx)("div",Object.assign({className:"overlay-layer labels-layer"},{children:i}))}}LabelLayerComponent.contextType=h.I;const be=(0,ve.h)(LabelLayerComponent);var Se=n(52838),Ee=n(82092),Te=n(97328),we=n(56829),xe=n(84586);class OverlayUi extends i.Component{constructor(e){super(e),this.propertiesToRefreshUi=[se.re,oe.Mp,ie.Nj,F.gx.Labels,S.Q5,ie.Cu,S.gu],this.bindings=[],this.inTransition=!1,this.newTagsEnabled=!1,this.notesEnabled=!1,this.onLoadSpinnerMessage=e=>{this.setState({loadSpinnerOn:e.isOpen})},this.onLoadSpinnerSuppressMessage=e=>{this.setState({loadSpinnerSuppress:e.suppress})},this.refreshVisibility=()=>{const e=this.context.settings;this.setState({labelsOn:e.tryGetProperty(ie.Nj,!1)&&e.tryGetProperty(F.gx.Labels,!1)&&!e.tryGetProperty(ie.Cu,!1)&&!this.inTransition,mattertagsOn:e.tryGetProperty(se.re,!1),notesOn:e.tryGetProperty(oe.Mp,!1)})},this.state={mattertagsOn:!1,labelsOn:!1,notesOn:!1,loadSpinnerOn:!1,loadSpinnerSuppress:!1}}componentDidMount(){for(const e of this.propertiesToRefreshUi)this.context.settings.onPropertyChanged(e,this.refreshVisibility);const e=()=>{this.inTransition=!0},t=()=>{this.inTransition=!1,this.refreshVisibility()};this.bindings.push(this.context.messageBus.subscribe(me.Z,e),this.context.messageBus.subscribe(pe.Z,t),this.context.messageBus.subscribe(fe.S,e),this.context.messageBus.subscribe(ge.P,t),this.context.messageBus.subscribe(we.Z_,this.onLoadSpinnerMessage),this.context.messageBus.subscribe(we.bN,this.onLoadSpinnerSuppressMessage),this.context.messageBus.subscribe(xe.oR,(()=>this.setState({loadSpinnerSuppress:!0}))),this.context.messageBus.subscribe(xe.NR,(()=>this.setState({loadSpinnerSuppress:!1})))),this.refreshVisibility(),this.newTagsEnabled=this.context.settings.tryGetProperty(re.RY,!1),this.notesEnabled=this.context.settings.tryGetProperty(oe.IA,!1)}componentWillUnmount(){for(const e of this.propertiesToRefreshUi)this.context.settings.removeOnPropertyChanged(e,this.refreshVisibility);this.bindings.forEach((e=>e.cancel())),this.bindings.length=0}render(){const{labelsOn:e,mattertagsOn:t,notesOn:n,loadSpinnerOn:i,loadSpinnerSuppress:s}=this.state,{mobile:r,viewmode:a,openModal:l,tourState:c}=this.props,{tourPlaying:d}=c,u=i&&!s,h=t&&this.newTagsEnabled,p=n&&this.notesEnabled,m=p||h;return(0,o.jsxs)("div",Object.assign({className:"overlay-ui"},{children:[m&&(0,o.jsx)(Ee.I,{}),m&&(0,o.jsx)(Se.E,{notesEnabled:p,newTagsEnabled:h,openModal:l}),t&&!this.newTagsEnabled&&(0,o.jsx)(ae.$,{tourPlaying:d,toolOpen:!1,mobile:r,allowTagOverlay:!0}),e&&(0,o.jsx)(be,{viewmode:a}),(0,o.jsx)(Te.Z,{showing:u})]}))}}OverlayUi.contextType=h.I;var _e=n(84128),Me=n(39864),Oe=n(70329),Ae=n(41920),Ce=n(45590),Ne=n(88599),De=n(37367);const Ie={"en-US":"./terms/terms-en-US.html",es:"./terms/terms-es-MX.html",fr:"./terms/terms-fr-FR.html",de:"./terms/terms-de-DE.html",ru:"./terms/terms-ru-RU.html",ja:"./terms/terms-ja-JP.html","zh-CN":"./terms/terms-zh-CN.html","zh-TW":"./terms/terms-zh-TW.html",ko:"./terms/terms-ko-KR.html",nl:"./terms/terms-nl-NL.html",it:"./terms/terms-it-IT.html",pt:"./terms/terms-pt-BR.html"};class Terms extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.onScrollPositionChange=()=>{this.scrollbars&&this.setState({scrollClass:this.scrollbars.scrollPosition.vertical})},this.onClose=()=>{this.setState({showing:!1}),this.context.commandBinder.issueCommand(new x.Bz(w.P.TERMS,!1))},this.stopPropagation=e=>{e.stopPropagation()},this.state={termsText:"",showing:!1,scrollClass:Ae.Ij.None}}async componentDidMount(){const e=function(e){if((0,De.y)(e)&&e in Ie)return Ie[e]}(this.context.locale?this.context.locale.languageCode:Ne.k$);let t="";if(e)try{t=await this.context.queue.get(e)}catch(e){t=this.context.locale.t(p.Z.TERMS_FAIL)}else t=this.context.locale.t(p.Z.TERMS_FAIL);window.requestAnimationFrame((()=>{this.isUnmounting||this.setState({showing:!0,termsText:t})}))}componentWillUnmount(){this.isUnmounting=!0}componentDidUpdate(e){this.state.termsText!==e.termsText&&(this.termsTextDiv.innerHTML=this.state.termsText,[].slice.call(this.termsTextDiv.querySelectorAll("a")).forEach((e=>{e.setAttribute("target","_blank"),e.classList.add("link")})))}render(){const{showing:e,scrollClass:t}=this.state;return(0,o.jsxs)("div",Object.assign({className:l()("modal","terms-modal",{"faded-in":e,[t]:!0}),onClick:this.stopPropagation},{children:[(0,o.jsx)("div",Object.assign({id:"terms-wrapper"},{children:(0,o.jsx)(Me.Z,Object.assign({name:"terms",ref:e=>this.scrollbars=e,onScrollPositionChange:this.onScrollPositionChange,forceHidden:(0,Ce.w)(window)},{children:(0,o.jsx)("div",{ref:e=>this.termsTextDiv=e,id:"terms-text"})}))})),(0,o.jsx)(Oe.P,{buttonStyle:Oe.A.LIGHT,onClose:this.onClose})]}))}}Terms.contextType=h.I;var Le=n(24440),Pe=n(69920),Re=n(75783),ke=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const Ue=new R.Z("vr-select");let Be=class VrModal extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.stopPropagation=e=>{e.stopPropagation()},this.renderHeadsetHeader=()=>{const{locale:e}=this.context,{vrPlatform:t}=this.state;switch(t){case Le.bk.unsupported:case Le.bk.webxr:return(0,o.jsxs)("div",Object.assign({className:"headset-header dark"},{children:[(0,o.jsxs)("span",Object.assign({className:"headset-titles"},{children:[(0,o.jsx)("h2",{children:e.t(p.Z.VR_RECOMMENDED)}),(0,o.jsx)("h1",{children:e.t(p.Z.VR_QUEST)})]})),(0,o.jsx)("img",{className:"headset-quest",src:n(49529),height:200,width:342})]}));default:return null}},this.renderBodyText=()=>{const{locale:e}=this.context,{vrPlatform:t}=this.state;switch(t){case Le.bk.unsupported:case Le.bk.webxr:return(0,o.jsx)("div",{children:(0,o.jsx)("p",{children:e.t(p.Z.VR_SUPPORTS)})});default:return null}},this.getFooterButtons=()=>{const{locale:e}=this.context,{vrPlatform:t}=this.state,n=[];n.push((0,o.jsx)(K.zx,Object.assign({buttonStyle:K.ZJ.OUTLINE,className:l()("button-inline","cancel"),onClick:this.onLearnMoreClicked},{children:e.t(p.Z.VR_LEARN_MORE_CAPS)}),"learn-more"));return t===Le.bk.webxr&&n.push((0,o.jsx)(K.zx,Object.assign({buttonState:K.BN.ENABLED,className:l()("button-inline","confirm"),onClick:this.onActionClicked},{children:e.t(p.Z.VR_ENTER)}),"enter-vr")),n},this.closeModal=()=>{this.context.commandBinder.issueCommand(new x.Bz(w.P.VR_SELECT,!1))},this.onCloseClicked=()=>{this.context.analytics.trackGuiEvent("vr_modal_close"),this.closeModal()},this.onActionClicked=()=>{switch(this.state.vrPlatform){case Le.bk.webxr:this.startWebXR(),this.closeModal()}},this.onLearnMoreClicked=()=>{window.open("https://support.matterport.com/hc/en-us/articles/360050098973-Exploring-Matterport-Spaces-in-VR-","_blank"),this.context.analytics.trackGuiEvent("vr_learn_more")},this.startWebXR=()=>{const{analytics:e,commandBinder:t}=this.context;t.issueCommand(new Re.j({type:"immersive-vr",features:["local-floor"]})).then((t=>{if(t){e.trackGuiEvent("vr_enter_app");const n=()=>{e.trackGuiEvent("vr_exit_app"),t.removeEventListener("end",n)};t.addEventListener("end",n)}else Ue.error("requestPresent Failed"),e.trackGuiEvent("vr_present_error"),this.updatePlatformState()})).catch((t=>{Ue.error("requestPresent Failed:",t),e.trackGuiEvent("vr_present_error")}))},this.state={vrPlatform:null}}async componentDidMount(){Pe.Z.apiExists()&&navigator.xr.addEventListener("ondevicechange",this.updatePlatformState),await this.updatePlatformState(),this.context.analytics.trackGuiEvent("click_vr_button")}componentWillUnmount(){this.isUnmounting=!0,Pe.Z.apiExists()&&navigator.xr.removeEventListener("ondevicechange",this.updatePlatformState)}render(){const{isMobile:e}=this.props,{locale:t}=this.context,n=l()("vr-modal","modal","full-modal",{mobile:e,desktop:!e});return(0,o.jsxs)("dialog",Object.assign({className:n,onClick:this.stopPropagation},{children:[(0,o.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,o.jsx)("div",Object.assign({className:"modal-title"},{children:t.t(p.Z.VR_VIEW_SPACE)})),(0,o.jsx)(Oe.P,{onClose:this.onCloseClicked})]})),this.renderHeadsetHeader(),(0,o.jsx)("div",Object.assign({className:"modal-body"},{children:this.renderBodyText()})),(0,o.jsx)("div",Object.assign({className:"modal-footer"},{children:this.getFooterButtons()}))]}))}async updatePlatformState(){const e=await(0,Le.pl)();this.isUnmounting||(this.setState({vrPlatform:e}),Ue.debug(this.state))}};Be.contextType=h.I,Be=ke([E.Z],Be);const Fe=Be;class CtaSmall extends i.Component{render(){const{isMobile:e}=this.props,{locale:t}=this.context;return(0,o.jsx)("div",Object.assign({className:"cta"},{children:(0,o.jsx)("h1",Object.assign({className:l()({mobile:e})},{children:t.t(e?p.Z.MOBILE_SHORT_CTA:p.Z.DESKTOP_SHORT_CTA)}))}))}}CtaSmall.contextType=h.I;const Ve={mouse:{click:n(41891),clickInside:n(70626),dragLeft:n(73993),dragRight:n(26668),play:n(31891),positionLeft:n(82906),positionRight:n(64991),zoom:n(12136)},gesture:{drag:n(72145),dragTwoFinger:n(12742),pinch:n(5435),position:n(67649),positionTwoFinger:n(2433),tap:n(24367),tapInside:n(90619),play:n(94874)},keyboard:{all:n(76064),inside:n(64549),leftRight:n(81202),spaceBar:n(71002),upDown:n(42135),zoom:n(26407)},moreHelp:{view360:n(86533),mattertag:n(14653)}},{HELP:He}=p.Z.SHOWCASE;class CtaDesktop extends i.Component{constructor(){super(...arguments),this.keys={header:p.Z.DESKTOP_SHORT_CTA,move:p.Z.MOVE,inside:p.Z.INSIDE,rotate:p.Z.ROTATE,play:p.Z.PLAY,zoom:p.Z.ZOOM},this.clickInside={Icon:Ve.mouse.clickInside,Label:this.keys.inside,FooterIcon:Ve.keyboard.inside,Alt:He.ALT_MOUSE_CLICKINSIDE,FooterAlt:He.ALT_KEYBOARD_INSIDE},this.clickMove={Icon:Ve.mouse.positionRight,Label:this.keys.move,FooterIcon:"",Alt:He.ALT_MOUSE_POSITIONRIGHT},this.moveUpDown={Icon:Ve.mouse.click,Label:this.keys.move,FooterIcon:Ve.keyboard.upDown,Alt:He.ALT_MOUSE_CLICK,FooterAlt:He.ALT_KEYBOARD_UPDOWN},this.play={Icon:Ve.mouse.play,Label:this.keys.play,FooterIcon:null,Alt:He.ALT_MOUSE_PLAY},this.zoom={Icon:Ve.mouse.zoom,Label:this.keys.zoom,FooterIcon:Ve.keyboard.zoom,Alt:He.ALT_MOUSE_ZOOM,FooterAlt:He.ALT_KEYBOARD_ZOOM},this.dragMove={Icon:Ve.mouse.positionLeft,Label:this.keys.move,FooterIcon:null,Alt:He.ALT_MOUSE_POSITIONLEFT},this.dragRotateLeft={Icon:Ve.mouse.dragLeft,Label:this.keys.rotate,FooterIcon:Ve.keyboard.leftRight,Alt:He.ALT_MOUSE_DRAGLEFT,FooterAlt:He.ALT_KEYBOARD_LEFTRIGHT},this.dragRotateRight={Icon:Ve.mouse.dragRight,Label:this.keys.rotate,FooterIcon:Ve.keyboard.leftRight,Alt:He.ALT_MOUSE_DRAGRIGHT,FooterAlt:He.ALT_KEYBOARD_LEFTRIGHT},this.left=this.clickInside,this.center=this.clickMove,this.right=this.play}render(){const{viewmode:e}=this.props,{locale:t}=this.context;return this.configureViewmodeSpecifics(e),(0,o.jsxs)("div",Object.assign({className:l()({cta:!0})},{children:[(0,o.jsx)("h1",{children:t.t(this.keys.header)}),(0,o.jsx)("h2",{children:t.t(this.left.Label)}),(0,o.jsx)("img",{src:this.left.Icon,alt:this.left.Alt}),this.left.FooterIcon?(0,o.jsx)("hr",{}):(0,o.jsx)("span",{}),this.left.FooterIcon?(0,o.jsx)("img",{className:"footer-icon",src:this.left.FooterIcon,alt:this.left.FooterAlt}):(0,o.jsx)("span",{}),(0,o.jsx)("h2",{children:t.t(this.center.Label)}),(0,o.jsx)("img",{src:this.center.Icon,alt:this.center.Alt}),this.center.FooterIcon?(0,o.jsx)("hr",{}):(0,o.jsx)("span",{}),this.center.FooterIcon?(0,o.jsx)("img",{className:"footer-icon",src:this.center.FooterIcon,alt:this.center.FooterAlt}):(0,o.jsx)("span",{}),(0,o.jsx)("h2",{children:t.t(this.right.Label)}),(0,o.jsx)("img",{src:this.right.Icon,alt:this.right.Alt}),this.right.FooterIcon?(0,o.jsx)("hr",{}):(0,o.jsx)("span",{}),this.right.FooterIcon?(0,o.jsx)("img",{className:"footer-icon",src:this.right.FooterIcon,alt:this.right.FooterAlt}):(0,o.jsx)("span",{})]}))}configureViewmodeSpecifics(e){switch(e){case V.BD.INSIDE:this.left=this.dragRotateLeft,this.center=this.moveUpDown,this.right=this.props.isHelpCta?this.zoom:this.play;break;case V.BD.OUTSIDE:case V.BD.DOLLHOUSE:this.left=this.dragRotateLeft,this.center=this.clickMove,this.right=this.clickInside;break;case V.BD.FLOORPLAN:this.left=this.dragMove,this.center=this.dragRotateRight,this.right=this.clickInside}}}CtaDesktop.contextType=h.I;const{HELP:je}=p.Z.SHOWCASE;class CtaMobile extends i.Component{constructor(){super(...arguments),this.keys={shortCta:p.Z.MOBILE_SHORT_CTA,move:p.Z.MOVE,inside:p.Z.INSIDE,rotate:p.Z.ROTATE,play:p.Z.PLAY,zoom:p.Z.ZOOM},this.clickInside={Icon:Ve.gesture.tapInside,Label:this.keys.inside,Alt:je.ALT_GESTURE_TAPINSIDE},this.clickMove={Icon:Ve.gesture.tap,Label:this.keys.move,Alt:je.ALT_GESTURE_TAP},this.dragRotate={Icon:Ve.gesture.drag,Label:this.keys.rotate,Alt:je.ALT_GESTURE_DRAG},this.dragMove={Icon:Ve.gesture.position,Label:this.keys.move,Alt:je.ALT_GESTURE_POSITION},this.play={Icon:Ve.gesture.play,Label:this.keys.play,Alt:je.ALT_GESTURE_PLAY},this.zoom={Icon:Ve.gesture.pinch,Label:this.keys.zoom,Alt:je.ALT_GESTURE_PINCH},this.left=this.dragRotate,this.center=this.clickInside,this.right=this.play}render(){const e=l()({mobile:!0}),{viewmode:t}=this.props,{locale:n}=this.context;return this.configureViewmodeSpecifics(t),(0,o.jsxs)("div",Object.assign({className:l()({cta:!0,mobile:!0})},{children:[(0,o.jsx)("h1",Object.assign({className:e},{children:n.t(this.keys.shortCta)})),(0,o.jsx)("h2",Object.assign({className:e},{children:n.t(this.left.Label)})),(0,o.jsx)("img",{src:this.left.Icon}),(0,o.jsx)("h2",Object.assign({className:e},{children:n.t(this.center.Label)})),(0,o.jsx)("img",{src:this.center.Icon}),(0,o.jsx)("h2",Object.assign({className:e},{children:n.t(this.right.Label)})),(0,o.jsx)("img",{src:this.right.Icon})]}))}configureViewmodeSpecifics(e){switch(e){case V.BD.INSIDE:this.left=this.dragRotate,this.center=this.clickMove,this.right=this.props.isHelpCta?this.zoom:this.play;break;case V.BD.DOLLHOUSE:case V.BD.OUTSIDE:this.left=this.dragRotate,this.center=this.clickInside,this.right=this.props.isHelpCta?this.zoom:this.play;break;case V.BD.FLOORPLAN:this.left=this.dragMove,this.center=this.clickInside,this.right=this.props.isHelpCta?this.zoom:this.play}}}CtaMobile.contextType=h.I;var Ge=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const ze=new R.Z("cta");var We,Ke;!function(e){e[e.NONE=0]="NONE",e[e.LARGE=1]="LARGE",e[e.SMALL=2]="SMALL"}(We||(We={})),function(e){e[e.HELP=0]="HELP",e[e.TOUR=1]="TOUR"}(Ke||(Ke={}));let Ye=class Cta extends i.Component{constructor(e){super(e),this.styles=[We.NONE],this.bindings=[],this.handleInteraction=()=>{this.props.showCta&&(this.setState({seenCta:!0}),this.context.commandBinder.issueCommand(new x.Bz(w.P.CTA,!1)))},this.onTourStopped=e=>{const{ctaSource:t,seenCta:n}=this.state;e.willResume||t!==Ke.TOUR||n||(this.setState({seenCta:!0}),this.context.commandBinder.issueCommand(new x.Bz(w.P.CTA,!0)))},this.onTourStarted=()=>{this.state.ctaSource===Ke.HELP&&2===this.styles.length&&this.setState({ctaSource:Ke.TOUR,seenCta:!1,style:this.styles[1]}),this.props.showCta&&this.context.commandBinder.issueCommand(new x.Bz(w.P.CTA,!1))},this.state={ctaSource:Ke.TOUR,seenCta:!1,style:this.styles[0]}}componentDidMount(){const{canvas:e}=this.props,{messageBus:t,settings:n}=this.context;try{e&&(e.addEventListener("mousedown",this.handleInteraction),e.addEventListener("pointerdown",this.handleInteraction),e.addEventListener("touchstart",this.handleInteraction)),this.bindings.push(t.subscribe(xe.NR,this.onTourStopped),t.subscribe(xe.Mt,this.onTourStopped),t.subscribe(xe.oR,this.onTourStarted))}catch(e){ze.debug(e)}let i=this.state.ctaSource;const s=parseInt(n.tryGetProperty("tourcta",1),10);!isNaN(s)&&s in We&&(this.styles[0]=s,i=Ke.TOUR);const r=n.tryGetProperty("help",0);!isNaN(r)&&r in We&&r!==We.NONE&&(this.styles[0]===We.NONE?this.styles[0]=r:this.styles.unshift(r),i=Ke.HELP),this.styles[0]!==We.NONE&&this.setState({style:this.styles[0],ctaSource:i})}componentWillUnmount(){const{canvas:e}=this.props;e&&(e.removeEventListener("mousedown",this.handleInteraction),e.removeEventListener("pointerdown",this.handleInteraction),e.removeEventListener("touchstart",this.handleInteraction)),this.bindings.forEach((e=>e.cancel()))}renderCtaStyle(){const{isMobile:e,viewmode:t}=this.props,{style:n,ctaSource:i}=this.state;switch(n){case We.NONE:return null;case We.SMALL:return(0,o.jsx)(CtaSmall,{isMobile:e});case We.LARGE:return e?(0,o.jsx)(CtaMobile,{isMobile:e,viewmode:t,isHelpCta:i===Ke.HELP}):(0,o.jsx)(CtaDesktop,{viewmode:t,isHelpCta:i===Ke.HELP})}}render(){const{showCta:e,isMobile:t}=this.props,{style:n,ctaSource:i}=this.state,s={ctaContainer:!0,mobile:t,showMessage:e,small:n===We.SMALL,helpCta:i===Ke.HELP};return(0,o.jsx)("div",Object.assign({id:"cta-container",className:l()(s)},{children:this.renderCtaStyle()}))}};Ye.contextType=h.I,Ye=Ge([E.Z],Ye);const qe=Ye;var Ze,$e,Qe,Xe,Je,et;!function(e){e[e.navigation=0]="navigation",e[e.moreHelp=1]="moreHelp"}(Ze||(Ze={})),function(e){e.left="left",e.middle="middle",e.right="right"}($e||($e={})),function(e){e.topInfo="topInfo",e.bigImage="bigImage",e.bottomInfo="bottomInfo",e.keyboard="keyboard"}(Qe||(Qe={})),function(e){e.desktop="desktop",e.mobile="mobile"}(Xe||(Xe={})),function(e){e.hlr="hlr",e.dollhouse="dollhouse",e.floors="floors",e.mattertag="mattertag",e.floorplan="floorplan",e.tour="tour",e.inside="inside",e.vr="vr",e.view360="view360",e.fullscreen="fullscreen"}(Je||(Je={})),function(e){e.landscape="landscape",e.portrait="portrait"}(et||(et={}));const{HELP:tt}=p.Z.SHOWCASE,nt={[Xe.desktop]:{[$e.left]:{[Qe.topInfo]:"HELP_DESKTOP_PANORAMA_1A",[Qe.bottomInfo]:"HELP_DESKTOP_PANORAMA_1B",[Qe.bigImage]:{img:Ve.mouse.dragLeft,alt:tt.ALT_MOUSE_DRAGLEFT},[Qe.keyboard]:{img:Ve.keyboard.leftRight,alt:tt.ALT_KEYBOARD_LEFTRIGHT}},[$e.middle]:{[Qe.topInfo]:"HELP_DESKTOP_PANORAMA_2A",[Qe.bottomInfo]:"HELP_DESKTOP_PANORAMA_2B",[Qe.bigImage]:{img:Ve.mouse.click,alt:tt.ALT_MOUSE_CLICK},[Qe.keyboard]:{img:Ve.keyboard.upDown,alt:tt.ALT_KEYBOARD_UPDOWN}},[$e.right]:{[Qe.topInfo]:"HELP_DESKTOP_PANORAMA_3A",[Qe.bottomInfo]:"HELP_DESKTOP_PANORAMA_3B",[Qe.bigImage]:{img:Ve.mouse.zoom,alt:tt.ALT_MOUSE_ZOOM},[Qe.keyboard]:{img:Ve.keyboard.zoom,alt:tt.ALT_KEYBOARD_ZOOM}}},[Xe.mobile]:{[$e.left]:{[Qe.topInfo]:"HELP_MOBILE_PANORAMA_1",[Qe.bigImage]:{img:Ve.gesture.drag,alt:tt.ALT_GESTURE_DRAG}},[$e.middle]:{[Qe.topInfo]:"HELP_MOBILE_PANORAMA_2",[Qe.bigImage]:{img:Ve.gesture.tap,alt:tt.ALT_GESTURE_TAP}},[$e.right]:{[Qe.topInfo]:"HELP_MOBILE_3",[Qe.bigImage]:{img:Ve.gesture.pinch,alt:tt.ALT_GESTURE_PINCH}}}},it={[Xe.desktop]:{[$e.left]:{[Qe.topInfo]:"HELP_DESKTOP_DOLLHOUSE_1A",[Qe.bottomInfo]:"HELP_DESKTOP_DOLLHOUSE_1B",[Qe.bigImage]:{img:Ve.mouse.dragLeft,alt:tt.ALT_MOUSE_DRAGLEFT},[Qe.keyboard]:{img:Ve.keyboard.all,alt:tt.ALT_KEYBOARD_ALL}},[$e.middle]:{[Qe.topInfo]:"HELP_DESKTOP_DOLLHOUSE_2A",[Qe.bigImage]:{img:Ve.mouse.positionRight,alt:tt.ALT_MOUSE_POSITIONRIGHT}},[$e.right]:{[Qe.topInfo]:"HELP_DESKTOP_DOLLHOUSE_3A",[Qe.bigImage]:{img:Ve.mouse.zoom,alt:tt.ALT_MOUSE_ZOOM}}},[Xe.mobile]:{[$e.left]:{[Qe.topInfo]:"HELP_MOBILE_DOLLHOUSE_1",[Qe.bigImage]:{img:Ve.gesture.drag,alt:tt.ALT_GESTURE_DRAG}},[$e.middle]:{[Qe.topInfo]:"HELP_MOBILE_DOLLHOUSE_2",[Qe.bigImage]:{img:Ve.gesture.positionTwoFinger,alt:tt.ALT_GESTURE_POSITIONTWOFINGER}},[$e.right]:{[Qe.topInfo]:"HELP_MOBILE_3",[Qe.bigImage]:{img:Ve.gesture.pinch,alt:tt.ALT_GESTURE_PINCH}}}},st={[Xe.desktop]:{[$e.left]:{[Qe.topInfo]:"HELP_DESKTOP_FLOORPLAN_1A",[Qe.bigImage]:{img:Ve.mouse.positionLeft,alt:tt.ALT_MOUSE_POSITIONLEFT}},[$e.middle]:{[Qe.topInfo]:"HELP_DESKTOP_FLOORPLAN_2A",[Qe.bottomInfo]:"HELP_DESKTOP_FLOORPLAN_2B",[Qe.bigImage]:{img:Ve.mouse.dragRight,alt:tt.ALT_MOUSE_DRAGRIGHT},[Qe.keyboard]:{img:Ve.keyboard.leftRight,alt:tt.ALT_KEYBOARD_LEFTRIGHT}},[$e.right]:{[Qe.topInfo]:"HELP_DESKTOP_FLOORPLAN_3A",[Qe.bottomInfo]:"HELP_DESKTOP_FLOORPLAN_3B",[Qe.bigImage]:{img:Ve.mouse.zoom,alt:tt.ALT_MOUSE_ZOOM},[Qe.keyboard]:{img:Ve.keyboard.upDown,alt:tt.ALT_KEYBOARD_UPDOWN}}},[Xe.mobile]:{[$e.left]:{[Qe.topInfo]:"HELP_MOBILE_FLOORPLAN_1",[Qe.bigImage]:{img:Ve.gesture.position,alt:tt.ALT_GESTURE_POSITION}},[$e.middle]:{[Qe.topInfo]:"HELP_MOBILE_FLOORPLAN_2",[Qe.bigImage]:{img:Ve.gesture.dragTwoFinger,alt:tt.ALT_GESTURE_DRAGTWOFINGER}},[$e.right]:{[Qe.topInfo]:"HELP_MOBILE_3",[Qe.bigImage]:{img:Ve.gesture.pinch,alt:tt.ALT_GESTURE_PINCH}}}},rt=JSON.parse(JSON.stringify(nt));rt.desktop.middle={[Qe.topInfo]:"HELP_DESKTOP_360_2A",[Qe.bottomInfo]:"HELP_DESKTOP_360_2B",[Qe.bigImage]:{img:Ve.mouse.clickInside,alt:tt.ALT_MOUSE_CLICKINSIDE},[Qe.keyboard]:{img:Ve.keyboard.inside,alt:tt.ALT_KEYBOARD_INSIDE}},rt.mobile.middle={[Qe.topInfo]:"HELP_MOBILE_360_2",[Qe.bigImage]:{img:Ve.gesture.tapInside,alt:tt.ALT_GESTURE_TAPINSIDE}};const ot={INSIDE:nt,OUTSIDE:rt,FLOORPLAN:st,DOLLHOUSE:it};var at=n(44450),lt=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let ct=class NavigationTab extends i.Component{constructor(e){super(e),this.state={overflow:!1}}UNSAFE_componentWillReceiveProps(e){(this.navigationDiv&&this.navigationDiv.clientHeight||0)/(this.navigationDiv.parentElement&&this.navigationDiv.parentElement.clientHeight||1)>.7&&this.setState({overflow:!0})}getAssetObj(e){switch(e){case this.props.Modes.DOLLHOUSE:return ot.DOLLHOUSE[this.props.device];case this.props.Modes.FLOORPLAN:return ot.FLOORPLAN[this.props.device];case this.props.Modes.OUTSIDE:return ot.OUTSIDE[this.props.device];case this.props.Modes.INSIDE:default:return ot.INSIDE[this.props.device]}}buildRows(){const e=this.getAssetObj(this.props.viewmode),t=[];for(const n in Qe){const i=[],s=[];for(const t in $e)if(i.push(this.wrapAsset(e,t,n,!1)),n===Qe.bigImage){const i=!e[t][Qe.bottomInfo];s.push((0,o.jsx)("div",Object.assign({className:l()(t,"column",{noDivider:i})},{children:(0,o.jsx)("hr",{})}),`${n}_${t}_divider_row`))}t.push((0,o.jsx)("div",Object.assign({className:l()(n,"row")},{children:i}),`${n}_vertical_row`))}return t}buildMobilePortrait(){const e=this.getAssetObj(this.props.viewmode),t=[];for(const n in e)for(const i in e[n])t.push(this.wrapAsset(e,n,i,!0));return t}wrapAsset(e,t,n,i){const s=e[t][n],r=n===Qe.bigImage||n===Qe.keyboard,a=s?s.img:void 0,c=s&&s.alt?this.context.locale.t(s.alt):void 0,d=(0,o.jsx)("img",{src:a,alt:c});return(0,o.jsx)("div",Object.assign({className:i?l()(n,"row"):l()(t,"column")},{children:s&&r?d:s&&this.context.locale.t(s)}),`wrapped_asset_${t}_${n}`)}render(){const e=this.props.device===Xe.mobile&&this.props.orientation===at.i5.PORTRAIT,t=l()({navigation:!0,small:this.state.overflow,[this.props.viewmode]:!0});return(0,o.jsx)("div",Object.assign({className:t,ref:e=>{this.navigationDiv=e}},{children:e?(0,o.jsx)(Me.Z,Object.assign({name:"navigation",forceHidden:!1},{children:(0,o.jsx)("div",Object.assign({className:"nav-wrapper"},{children:this.buildMobilePortrait()}))})):this.buildRows()}))}};ct.contextType=h.I,ct=lt([E.Z],ct);const dt=ct,ut={[Je.hlr]:{[Qe.topInfo]:"HELP_MORE_HLR_A",[Qe.bigImage]:"icon-hlr",[Qe.bottomInfo]:"HELP_DESKTOP_MORE_HLR_B"},[Je.dollhouse]:{[Qe.topInfo]:"HELP_MORE_DOLLHOUSE_A",[Qe.bigImage]:"icon-dollhouse",[Qe.bottomInfo]:"HELP_MOBILE_MORE_DOLLHOUSE_B"},[Je.floors]:{[Qe.topInfo]:"HELP_MORE_FLOORS_A",[Qe.bigImage]:"icon-floor-controls",[Qe.bottomInfo]:"HELP_DESKTOP_MORE_FLOORS_B"},[Je.mattertag]:{[Qe.topInfo]:"HELP_MORE_MATTERTAG_A",[Qe.bigImage]:Ve.moreHelp.mattertag,[Qe.bottomInfo]:"HELP_MOBILE_MORE_MATTERTAG_B"},[Je.tour]:{[Qe.topInfo]:"HELP_MORE_TOUR_A",[Qe.bigImage]:"icon-play",[Qe.bottomInfo]:"HELP_DESKTOP_MORE_TOUR_B"},[Je.inside]:{[Qe.topInfo]:"HELP_MORE_INSIDE_A",[Qe.bigImage]:"icon-panorama",[Qe.bottomInfo]:"HELP_MOBILE_MORE_INSIDE_B"},[Je.vr]:{[Qe.topInfo]:"HELP_MORE_VR_A",[Qe.bigImage]:"icon-vr",[Qe.bottomInfo]:"HELP_MOBILE_MORE_VR_B"},[Je.view360]:{[Qe.topInfo]:"HELP_MORE_360_A",[Qe.bigImage]:Ve.moreHelp.view360,[Qe.bottomInfo]:"HELP_MOBILE_MORE_360_B"},[Je.floorplan]:{[Qe.topInfo]:"HELP_MORE_FLOORPLAN_A",[Qe.bigImage]:"icon-floorplan",[Qe.bottomInfo]:"HELP_MOBILE_FLOORPLAN_B"}},ht=JSON.parse(JSON.stringify(ut));ht[Je.fullscreen]={[Qe.topInfo]:"HELP_MORE_FULLSCREEN_A",[Qe.bigImage]:"icon-fullscreen",[Qe.bottomInfo]:"HELP_DESKTOP_MORE_FULLSCREEN_B"},ht[Je.dollhouse][Qe.bottomInfo]="HELP_DESKTOP_MORE_DOLLHOUSE_B",ht[Je.mattertag][Qe.bottomInfo]="HELP_DESKTOP_MORE_MATTERTAG_B",ht[Je.inside][Qe.bottomInfo]="HELP_DESKTOP_MORE_INSIDE_B",ht[Je.vr][Qe.bottomInfo]="HELP_DESKTOP_MORE_VR_B",ht[Je.view360][Qe.bottomInfo]="HELP_DESKTOP_MORE_360_B",ht[Je.floorplan][Qe.bottomInfo]="HELP_DESKTOP_FLOORPLAN_B";const pt={[Xe.desktop]:ht,[Xe.mobile]:ut},mt=[Qe.topInfo,Qe.bigImage,Qe.bottomInfo];class MoreHelpTab extends i.Component{constructor(e){super(e),this.scrollbarsRef=(0,i.createRef)()}componentDidMount(){const e=this.scrollbarsRef.current;e&&e.scrollTo({x:0,y:0})}buildInstructions(){const e=[],t=this.props.device===Xe.desktop?5:this.props.orientation===at.i5.LANDSCAPE?3:2,n=Object.keys(pt[this.props.device]);for(let i=0;i<n.length;i+=t){for(const s of mt){const r=[];for(let e=0;e<t;e++){if(i+e>=n.length)continue;const t=pt[this.props.device][n[i+e]][s],a=l()(s,n[i+e],{noAsset:!t}),c=`${i}_${s}_${e}`;switch(s){case Qe.topInfo:r.push((0,o.jsx)("div",Object.assign({className:a},{children:this.context.locale.t(t)}),`${c}_top_info`));break;case Qe.bigImage:r.push((0,o.jsx)("div",Object.assign({className:a},{children:t.indexOf(".png")>-1?(0,o.jsx)("img",{src:t}):(0,o.jsx)("span",Object.assign({className:t},{children:"floors"===n[i+e]?(0,o.jsx)("span",{children:"2"}):null}))}),`${c}_big_img`));break;case Qe.bottomInfo:r.push((0,o.jsx)("div",Object.assign({className:a},{children:this.context.locale.t(t)}),`${c}_bottom_info`))}}e.push((0,o.jsx)("div",Object.assign({className:l()("innerRow",s)},{children:r}),`${i}_${s}_top_info`))}e.push((0,o.jsx)("div",{className:"rowPadding"},`${i}_row_padding`))}return e.pop(),e}render(){return(0,o.jsx)("div",Object.assign({className:l()("more-help-wrapper",this.props.device)},{children:(0,o.jsx)(Me.Z,Object.assign({name:"more-help-wrapper",ref:this.scrollbarsRef,forceHidden:!1},{children:(0,o.jsx)("div",Object.assign({className:l()("more-help")},{children:this.buildInstructions()}))}))}))}}MoreHelpTab.contextType=h.I;var ft=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let gt=class Help extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.setOrientation=e=>{const{orientation:t}=e;this.setState({orientation:t})},this.handleTabClick=e=>()=>{this.setState({tab:e})},this.closeHelp=()=>{this.setState({showing:!1}),this.context.commandBinder.issueCommand(new x.Bz(w.P.HELP,!1))},this.stopPropagation=e=>{e.stopPropagation()},this.device=this.props.isMobile?Xe.mobile:Xe.desktop,this.state={showing:!1,tab:Ze.navigation,orientation:(0,at.T8)().orientation},this.orientationSubscription=(0,at.kp)(at.g_.ORIENTATION_CHANGED,this.setOrientation)}componentDidMount(){this.orientationSubscription.renew(),window.requestAnimationFrame((()=>{this.isUnmounting||this.setState({showing:!0})}))}componentWillUnmount(){this.isUnmounting=!0,this.orientationSubscription.cancel()}render(){const{showing:e,tab:t,orientation:n}=this.state;return(0,o.jsxs)("div",Object.assign({id:"help-modal",className:l()(this.device,{"faded-in":e}),onClick:this.stopPropagation},{children:[(0,o.jsxs)("div",Object.assign({className:l()("tabs",t)},{children:[(0,o.jsx)("div",Object.assign({className:l()("navigation-tab",{active:t===Ze.navigation}),onClick:this.handleTabClick(Ze.navigation)},{children:(0,o.jsx)("span",{children:this.context.locale.t(p.Z.HELP_NAVIGATION_TAB)})})),(0,o.jsx)("div",Object.assign({className:l()("more-help-tab",{active:t===Ze.moreHelp}),onClick:this.handleTabClick(Ze.moreHelp)},{children:(0,o.jsx)("span",{children:this.context.locale.t(p.Z.HELP_MORE_HELP_TAB)})}))]})),t===Ze.navigation&&(0,o.jsx)(dt,{device:this.device,Modes:this.props.allModes,viewmode:this.props.viewmode,orientation:n}),t===Ze.moreHelp&&(0,o.jsx)(MoreHelpTab,{device:this.device,orientation:n}),(0,o.jsx)(Oe.P,{buttonStyle:Oe.A.LIGHT,onClose:this.closeHelp})]}))}};gt.contextType=h.I,gt=ft([E.Z],gt);const vt=gt;var yt,bt=n(41270),St=n(97966),Et=n(14877);!function(e){e.MAIL="mail",e.PINTEREST="pinterest",e.LINKEDIN="linkedin",e.TWITTER="twitter",e.FACEBOOK="facebook",e.COPYLINK="copylink",e.NATIVE="native"}(yt||(yt={}));const{FACEBOOK:Tt,TWITTER:wt,MAIL:xt,PINTEREST:_t,LINKEDIN:Mt,COPYLINK:Ot,NATIVE:At}=yt,Ct={[xt]:"em",[_t]:"pn",[Mt]:"ln",[wt]:"tw",[Tt]:"fb",[Ot]:"cp",[At]:"os"},Nt={[Tt]:{width:626,height:436},[wt]:{width:550,height:440},[_t]:{width:750,height:749},[Mt]:{width:550,height:453},[Ot]:{},[xt]:{},[At]:{}},Dt=async(e,t=!0)=>{let n;const i=await e.engine.getModuleBySymbol(Et.y.DEEP_LINKS),s=["ref","gclid","fbclid","cloudEdit","back","note","comment","apiHost","applicationKey","host","sdkKey","tag"],r=e=>!s.includes(e);return n=t?i.creator.createDeepLink({paramFilter:r}):i.creator.createLink({paramFilter:r}),n.searchParams.forEach(((e,t)=>{(s.includes(t)||0===t.indexOf("utm_"))&&n.searchParams.delete(t)})),decodeURIComponent(n.href)},It=e=>new URLSearchParams(e).toString(),Lt=(e,t,n)=>{const i=e.replace("?",`?ref=${Ct[Tt]}&`);return`http://www.facebook.com/sharer.php?${It({display:"popup",u:i})}`},Pt=(e,t,n)=>{const i=e.replace("?",`?ref=${Ct[wt]}&`),s={text:n.t(p.Z.SHARED_MESSAGE_HASHTAG,{title:t,url:i,hashtag:"#Matterport"})};return`http://twitter.com/intent/tweet?${It(s)}`},Rt=(e,t,n)=>{const i=e.replace("?",`?ref=${Ct[xt]}&`),s={subject:n.t(p.Z.SHARED_TITLE,{title:t}),body:n.t(p.Z.SHARED_MESSAGE,{title:t,url:i})};return`mailto:?${It(s)}`},kt=(e,t,n,i)=>{const s={url:e.replace("?",`?ref=${Ct[_t]}&`),media:n,description:i.t(p.Z.SHARED_TITLE,{title:t})};return`http://pinterest.com/pin/create/link/?${It(s)}`},Ut=(e,t,n)=>{const i=e.replace("?",`?ref=${Ct[Mt]}&`);return`https://www.linkedin.com/shareArticle?${It({mini:"true",url:i})}`},Bt=(e,t,n,i)=>({[Tt]:Lt(e),[wt]:Pt(e,t,i),[xt]:Rt(e,t,i),[_t]:kt(e,t,n,i),[Mt]:Ut(e),[Ot]:e,[At]:e});var Ft=n(53549);const Vt=new R.Z("share-modal");class ShareModal extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.copyURL=()=>{const{deeplink:e}=this.state;this.urlInputRef.select(),document.execCommand("copy"),window.getSelection().removeAllRanges(),this.urlInputRef.blur(),this.setState({copied:!0}),this.context.analytics.track("showcase_share_action",{channel:yt.COPYLINK,pano_id:this.sweepData.currentSweep,deeplink:e}),window.setTimeout((()=>{this.setState({copied:!1})}),2500)},this.toggleDeeplinks=()=>{const{deeplink:e}=this.state;this.setState({deeplink:!e})},this.close=()=>{this.context.commandBinder.issueCommand(new x.Bz(w.P.SHARE,!1))},this.openShareWindow=e=>{const{urls:t,deeplink:n,deeplinkUrls:i}=this.state,{width:s,height:r}=Nt[e],o=n?i[e]:t[e];let a;if(s&&r){a="top="+(window.screenY+(window.innerHeight-r)/2)+",left="+(window.screenX+(window.innerWidth-s)/2)+",width="+s+",height="+r}this.context.analytics.track("showcase_share_action",{channel:e,pano_id:this.sweepData.currentSweep,deeplink:n}),window.open(o,"",a)},this.openWebShareApi=e=>{if(!navigator.share)return;const{excerpt:t,title:n,urls:i,deeplinkUrls:s}=this.state,r={url:e?s[yt.COPYLINK]:i[yt.COPYLINK],text:t,title:n};Vt.debug("Launching Web Share API",r),navigator.share(r),this.context.analytics.track("showcase_share_action",{channel:yt.NATIVE,pano_id:this.sweepData.currentSweep,deeplink:e})},this.onWebShareClick=()=>{this.openWebShareApi(!1)},this.onWebShareDeeplinkClick=()=>{this.openWebShareApi(!0)},this.stopPropagation=e=>e.stopPropagation(),this.setUrlInputRef=e=>{this.urlInputRef=e},this.state={urls:{},deeplinkUrls:{},title:"",excerpt:"",image:"",copied:!1,deeplink:!1,webShareEnabled:(0,T.J1)()},this.openFacebook=this.openShareWindow.bind(this,yt.FACEBOOK),this.openTwitter=this.openShareWindow.bind(this,yt.TWITTER),this.openPinterest=this.openShareWindow.bind(this,yt.PINTEREST),this.openLinkedIn=this.openShareWindow.bind(this,yt.LINKEDIN),this.openEmail=this.openShareWindow.bind(this,yt.MAIL)}async componentDidMount(){const{market:e}=this.context,[t,n]=await Promise.all([e.waitForData(St.T),e.waitForData(Ft.Z)]);this.sweepData=n;const i=t.model,s=`${window.location.origin}/api/v1/player/models/${i.sid}/thumb`,r=i.details.name;this.isUnmounting||this.setState({title:r,image:s},this.updateUrls)}componentWillUnmount(){this.isUnmounting=!0}async updateUrls(){const{title:e,image:t}=this.state,[n,i]=await Promise.all([Dt(this.context,!1),Dt(this.context,!0)]),s=Bt(n,e,t,this.context.locale),r=Bt(i,e,t,this.context.locale);Vt.debug("Social Share URLs:",s),Vt.debug("Social Share URLs, with current location",r),this.isUnmounting||this.setState({urls:s,deeplinkUrls:r})}renderWebShareDialog(){return(0,o.jsxs)("div",Object.assign({className:"share-controls"},{children:[(0,o.jsx)(K.zx,Object.assign({className:"share-modal-button",buttonStyle:K.ZJ.PRIMARY,onClick:this.onWebShareDeeplinkClick},{children:this.context.locale.t(p.Z.SHARE_CURRENT_LOCATION)})),(0,o.jsx)(K.zx,Object.assign({className:"share-modal-button",buttonStyle:K.ZJ.OUTLINE,onClick:this.onWebShareClick},{children:this.context.locale.t(p.Z.SHARE_DEFAULT_LOCATION)}))]}))}renderShareDialog(){const{copied:e,deeplink:t,urls:n,deeplinkUrls:i}=this.state,s=t?i[yt.COPYLINK]:n[yt.COPYLINK],r=this.sweepData&&this.sweepData.isSweepDisabled(),a=r?this.context.locale.t(p.Z.SHARE_ERROR_SWEEP_DISABLED):void 0;return(0,o.jsxs)("div",Object.assign({className:"share-controls"},{children:[(0,o.jsxs)("div",Object.assign({className:"social-icons"},{children:[(0,o.jsx)(M.hU,{onClick:this.openFacebook,iconClass:"icon-facebook",buttonStyle:M.Dd.SOCIAL,buttonSize:K.qE.LARGE}),(0,o.jsx)(M.hU,{onClick:this.openTwitter,iconClass:"icon-twitter",buttonStyle:M.Dd.SOCIAL,buttonSize:K.qE.LARGE}),(0,o.jsx)(M.hU,{onClick:this.openLinkedIn,iconClass:"icon-linkedin",buttonStyle:M.Dd.SOCIAL,buttonSize:K.qE.LARGE}),(0,o.jsx)(M.hU,{onClick:this.openPinterest,iconClass:"icon-pinterest",buttonStyle:M.Dd.SOCIAL,buttonSize:K.qE.LARGE}),(0,o.jsx)(M.hU,{onClick:this.openEmail,iconClass:"icon-email",buttonStyle:M.Dd.SOCIAL,buttonSize:K.qE.LARGE})]})),(0,o.jsxs)("div",Object.assign({className:"input-group"},{children:[(0,o.jsx)("input",{className:"input",type:"text",value:s||"",ref:this.setUrlInputRef,onKeyDown:this.stopPropagation,onKeyPress:this.stopPropagation,onKeyUp:this.stopPropagation,readOnly:!0}),(0,o.jsx)(_.oO,Object.assign({content:e?this.context.locale.t(p.Z.SHARE_COPIED):this.context.locale.t(p.Z.COPY_URL),position:_.lZ.UP,tooltipTimeout:2e3},{children:(0,o.jsx)("button",Object.assign({className:"input-addon",onClick:this.copyURL},{children:this.context.locale.t(p.Z.COPY)}))}))]})),(0,o.jsx)(bt.X,{dataValue:"deeplink",checked:t,enabled:!r,error:r,helpText:a,label:this.context.locale.t(p.Z.SHARE_LINK_TO_LOCATION),onChange:this.toggleDeeplinks})]}))}render(){const{webShareEnabled:e}=this.state,t=l()("modal","share-modal","modal-dialog",{"share-dialog":!e,"web-share-dialog":e}),n=e?this.renderWebShareDialog():this.renderShareDialog();return(0,o.jsxs)("dialog",Object.assign({open:!0,className:t,onClick:this.stopPropagation},{children:[(0,o.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,o.jsx)("div",Object.assign({className:"modal-title"},{children:this.context.locale.t(p.Z.SHARE_MODAL_TITLE)})),(0,o.jsx)(Oe.P,{onClose:this.close})]})),(0,o.jsx)("div",Object.assign({className:"modal-body"},{children:n}))]}))}}ShareModal.contextType=h.I;var Ht=n(70680);class MeasurementModeHelp extends i.Component{constructor(e,t){super(e),this.closeModal=()=>{this.context.commandBinder.issueCommand(new x.Bz(w.P.MEASUREMENT_HELP,!1))},this.stopPropagation=e=>{e.stopPropagation()},this.locale={headerString:t.locale.t(p.Z.MEASUREMENT_MODE),subHeaderString:t.locale.t(p.Z.MEASUREMENT_HELP_MODAL_SUB_HEADER),body1String:t.locale.t(p.Z.MEASUREMENT_HELP_MODAL_BODY_1),body2String:t.locale.t(p.Z.MEASUREMENT_HELP_MODAL_BODY_2)}}render(){const{headerString:e,subHeaderString:t,body1String:n,body2String:i}=this.locale,{mobile:s}=this.props;return(0,o.jsxs)("div",Object.assign({className:l()("modal","full-modal","measurement-mode-help-modal",{mobile:s}),onClick:this.stopPropagation},{children:[(0,o.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,o.jsx)("div",Object.assign({className:"modal-title"},{children:e})),(0,o.jsx)(Oe.P,{onClose:this.closeModal})]})),(0,o.jsx)("div",Object.assign({className:"modal-subheader"},{children:t})),(0,o.jsxs)("div",Object.assign({className:"modal-body"},{children:[(0,o.jsx)("p",Object.assign({className:"modal-paragraph"},{children:n})),(0,o.jsx)("p",Object.assign({className:"modal-paragraph"},{children:i}))]}))]}))}}MeasurementModeHelp.contextType=h.I;var jt=n(84152),Gt=n(45845);class Modals extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.closeModal=()=>{this.context.commandBinder.issueCommand(new x.rE)},this.mobile=(0,T.tq)(),this.state={modelDetails:void 0}}componentDidMount(){this.context.market.waitForData(St.T).then((e=>{this.isUnmounting||this.setState({modelDetails:e.model.details})}))}componentWillUnmount(){this.isUnmounting=!0}render(){const{openModal:e,viewmode:t,glCanvas:n}=this.props,{modelDetails:i}=this.state;if(!i)return null;const s=e===w.P.SHARE,r=e===w.P.TERMS,a=e===w.P.HELP,c=e===w.P.CTA,d=e===w.P.NOTES_INTRO,u=e===w.P.MEASUREMENT_HELP,h=e===w.P.VR_SELECT,p=e===w.P.RATING_THANK_YOU,m=r||a,f=s||m||u||d||p||h&&!!i;return(0,o.jsxs)("div",Object.assign({id:"showcase-modals"},{children:[(0,o.jsxs)(Ht.N,Object.assign({className:l()("modal-background",{"modal-background":!0,"dark-modal-background":m,open:f}),open:f,selectChild:!0,childKey:e||void 0,onClick:this.closeModal},{children:[(0,o.jsx)(ShareModal,{},w.P.SHARE),(0,o.jsx)(MeasurementModeHelp,{mobile:this.mobile},w.P.MEASUREMENT_HELP),d&&(0,o.jsx)(jt.v,{},w.P.NOTES_INTRO),i&&(0,o.jsx)(Fe,{isMobile:this.mobile,modelDetails:i},w.P.VR_SELECT),r&&(0,o.jsx)(Terms,{},w.P.TERMS),a&&(0,o.jsx)(vt,{isMobile:this.mobile,viewmode:t,allModes:V.BD},w.P.HELP),p&&(0,o.jsx)(Gt.B,{},w.P.RATING_THANK_YOU)]})),(0,o.jsx)(qe,{canvas:n,isMobile:this.mobile,viewmode:t,showCta:c})]}))}}Modals.contextType=h.I;var zt=n(94805),Wt=n(72699),Kt=n(3819),Yt=n(37363),qt=n(22878),Zt=n(78522),$t=n(49563),Qt=n(72366),Xt=n(54119),Jt=n(60787),en=n(56662),tn=n(64921),nn=n(20585),sn=n(16534),rn=n(87443),on=n(47357),an=n(86696),ln=n(34259),cn=n(98529),dn=n(64191),un=n(11208),hn=n(58361),pn=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const mn=nn.LH;let fn=class TagViewPanel extends i.Component{constructor(e){super(e),this.textParser=new tn.v({links:!0}),this.onClickAttachment=(e,t)=>{this.onViewAttachment(t)},this.onViewAttachment=e=>{const{attachments:t}=this.props.tagView;this.context.commandBinder.issueCommand(new rn.xW(!0,t,e))}}renderWidgetFrame(){const{widgetFrame:e}=this.props.tagView;return e?(0,o.jsx)(un.l,{widget:e}):null}render(){const{settings:e}=this.context,{tagView:t,linkHandler:n,keywordsEnabled:i}=this.props,{id:s,description:r,label:a,attachments:c,keywords:d}=t,u=c.length>0,h=e.tryGetProperty(sn.sX,!1);return(0,o.jsxs)("div",Object.assign({className:l()("tag-view-panel",{"viewable-media":u})},{children:[u&&!h&&(0,o.jsx)(ln.T,{attachments:c,startIndex:0,onClick:this.onClickAttachment,smartWidth:mn,smartHeight:216}),(0,o.jsxs)("div",Object.assign({className:"tag-view-panel-header"},{children:[(0,o.jsx)("div",Object.assign({className:"tag-view-panel-title"},{children:a})),(0,o.jsx)(hn.O,{prefix:"tag",pin:t,id:t.id,darkTheme:!1,includeCameraView:!0,analyticAction:"tags_copy_share_link",buttonVariant:Xt.Wu.TERTIARY},t.id)]})),d&&i&&(0,o.jsx)(cn.s,{className:"tag-view-panel-keywords",keywords:d,maxVisible:5}),(0,o.jsx)(dn.e,{text:r,textParser:this.textParser,linkHandler:n,annotationType:on.J.TAG,annotationId:s,attachments:[],onViewAttachment:this.onViewAttachment}),this.renderWidgetFrame()]}))}};fn.contextType=h.I,fn=pn([E.Z],fn);const gn=(0,an.i)(fn);var vn=n(37884),yn=n(43008),bn=n(68850);function Sn(){const e=function(){const e=(0,bn.w)(),[t,n]=(0,i.useState)(e.toolHistory);return(0,i.useEffect)((()=>{const t=e.onToolHistoryChanged(n);return()=>t.cancel()}),[e]),t}();return e[e.length-1]||null}var En=n(82289),Tn=n(47931);const{TAGS:wn}=p.Z.SHOWCASE;function xn(){const e=(0,Jt.w)(),t=(0,en.P)(),n=Sn(),s=(0,En.T)(),r=(0,Tn.R)(),{commandBinder:a,locale:l}=(0,i.useContext)(h.I),c=(0,i.useCallback)((()=>{n?a.issueCommand(new G.cR):a.issueCommand(new G.CH(u.w1.TAGS))}),[n,a]);if(!t)return null;const d=n?"back":"close",p=l.t(n?wn.NAV_BACK_LABEL:wn.CLOSE_TAG_LABEL),m=!(s===u.wS.BOTTOM_PANEL)||!r;return(0,o.jsxs)(vn.J,Object.assign({className:"tags-panel",open:m,toolPanelLayout:s,scrollingDisabled:!1},{children:[(0,o.jsxs)("div",Object.assign({className:"detail-panel-header"},{children:[(0,o.jsx)(Xt.zx,{icon:d,label:p,variant:Xt.Wu.TERTIARY,onClick:c}),(0,o.jsx)(yn.O,{toolPanelLayout:s,analyticAction:"tags_navigate_in_panel"})]})),(0,o.jsx)(gn,{tagView:t,keywordsEnabled:!!e&&e.keywordsEnabled})]}))}var _n=n(34933),Mn=n(17159),On=n(17201),An=n(49355),Cn=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Nn=class VrEnterButtonControls extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.startWebXR=()=>{const{analytics:e,commandBinder:t}=this.context;t.issueCommand(new Re.j({type:"immersive-vr",features:["local-floor"]})).then((t=>{if(t){e.trackGuiEvent("vr_enter_app");const n=()=>{e.trackGuiEvent("vr_exit_app"),t.removeEventListener("end",n)};t.addEventListener("end",n)}else e.trackGuiEvent("vr_present_error"),this.updatePlatformState()})).catch((t=>{e.trackGuiEvent("vr_present_error")}))},this.state={vrPlatform:null}}async componentDidMount(){Pe.Z.apiExists()&&navigator.xr.addEventListener("ondevicechange",this.updatePlatformState),await this.updatePlatformState()}componentWillUnmount(){this.isUnmounting=!0,Pe.Z.apiExists()&&navigator.xr.removeEventListener("ondevicechange",this.updatePlatformState)}async updatePlatformState(){const e=await(0,Le.pl)();this.isUnmounting||this.setState({vrPlatform:e})}render(){return this.state.vrPlatform===Le.bk.webxr?this.renderOverlayCta():null}renderOverlayCta(){const{locale:e}=this.context;return(0,o.jsx)("div",Object.assign({id:"vr-overlay-layer",className:"overlay"},{children:(0,o.jsx)("div",Object.assign({className:"overlay-cta"},{children:(0,o.jsx)(K.zx,Object.assign({buttonSize:K.qE.LARGE,buttonState:K.BN.ENABLED,buttonStyle:K.ZJ.OVERLAY,className:l()("inline-block","confirm"),onClick:this.startWebXR},{children:e.t(p.Z.VR_ENTER)}))}))}))}};Nn.contextType=h.I,Nn=Cn([E.Z],Nn);var Dn=n(57109),In=n(11923),Ln=n(56396),Pn=n(43368),Rn=n(80312),kn=n(41345),Un=n(76031),Bn=n(57494);const{SUBSCRIBER_PROMPT:Fn}=p.Z.SHOWCASE,Vn=e=>{e.preventDefault()},Hn=()=>{const e=(0,Rn.z)(),t=(0,kn.b)(),[n,s]=(0,i.useState)(!0),r=(0,i.useCallback)((t=>{e.trackGuiEvent("subscriber_prompt_b_banner_click"),window.open(Un.Sm,"_blank")}),[e]);return(0,i.useEffect)((()=>(n&&(e.trackGuiEvent("subscriber_prompt_b_banner_viewed"),s(!1)),()=>{})),[e,n]),(0,o.jsxs)("div",Object.assign({className:"subscriber-prompt-banner",onClick:r},{children:[(0,o.jsx)("img",{className:"matterport-logo",alt:"Matterport",src:Bn}),(0,o.jsx)("a",Object.assign({className:"link",target:"_blank",onClick:Vn,href:Un.Sm},{children:t.t(Fn.BANNER_CTA_LINK_TEXT)}))]}))};var jn=n(59187),Gn=n(29055),zn=n(28741);const Wn=(0,jn.M)("isSubscriberBannerVisible",(()=>{const e=(0,Gn.a)();return(0,zn.p)().bannerEnabled&&e})),{SUMMARY:Kn}=p.Z.SHOWCASE,Yn=nn.MN/1.6;class SummaryContent extends i.Component{constructor(e){super(e),this.getImageURL=e=>{const t=new URL(e);return t.searchParams.set("width",String(nn.MN)),t.searchParams.delete("height"),t.searchParams.delete("fit"),t.searchParams.set("crop","16:10"),t.searchParams.set("dpr",String(window.devicePixelRatio)),t.href},this.onExternalLinkClicked=e=>{this.context.analytics.track("showcase_share_origin_link_clicked")},this.state={thumbnail:void 0}}componentDidMount(){const{market:e}=this.context.engine;e.waitForData(Ln.O).then((e=>{e.thumb&&e.thumb.get().then((e=>{try{this.setState({thumbnail:this.getImageURL(e)})}catch(e){this.setState({thumbnail:void 0})}}))}))}getFilteredValue(e,t,n,i){return!this.context.settings.tryGetProperty(t,n)||i&&!this.props.brandingEnabled?"":e}render(){const{modelDetails:e,showExternalUrl:t,isSubscriberBannerVisible:n}=this.props,{thumbnail:i}=this.state,{locale:s}=this.context,{name:r,presentedBy:a,summary:l,formattedAddress:c,contact:d,externalUrl:u}=e,h=t?u:"",m=this.getFilteredValue(r,F.gx.DetailsModelName,!0,!1),f=this.getFilteredValue(l,F.gx.DetailsSummary,!1,!1),g=this.getFilteredValue(c,F.gx.DetailsAddress,!1,!1),v=this.getFilteredValue(a,F.gx.PresentedBy,!1,!0),y=this.getFilteredValue(d.name,F.gx.DetailsName,!1,!0),b=this.getFilteredValue(d.email,F.gx.DetailsEmail,!1,!0),S=this.getFilteredValue(d.phone,F.gx.DetailsPhone,!1,!0),E=this.getFilteredValue(d.formattedPhone,F.gx.DetailsPhone,!1,!0),T=E||S;return(0,o.jsx)("div",Object.assign({className:"summary-content"},{children:(0,o.jsxs)(Pn.Z,Object.assign({direction:Ae.Nm.vertical},{children:[i?(0,o.jsx)("img",{className:"summary-image",width:nn.MN,height:Yn,src:i,alt:`Photo of "${m}"`}):null,n&&(0,o.jsx)(Hn,{}),(0,o.jsxs)("div",Object.assign({className:"summary-text-content"},{children:[m&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",Object.assign({className:"section-header"},{children:s.t(Kn.LABEL_LOCATION)})),(0,o.jsx)("div",Object.assign({className:"location"},{children:m}))]}),g&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",Object.assign({className:"section-header"},{children:s.t(Kn.LABEL_ADDRESS)})),(0,o.jsx)("div",Object.assign({className:"section-body"},{children:g}))]}),v&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",Object.assign({className:"section-header"},{children:this.context.locale.t(p.Z.PRESENTED_BY)})),(0,o.jsx)("div",Object.assign({className:"section-body"},{children:v}))]}),(y||S||b)&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",Object.assign({className:"section-header"},{children:s.t(Kn.LABEL_CONTACT)})),(0,o.jsxs)("div",Object.assign({className:"section-body"},{children:[y&&(0,o.jsx)("div",{children:y}),b&&(0,o.jsx)("div",{children:(0,o.jsx)("a",Object.assign({className:"link",href:"mailto:"+b},{children:b}))}),T&&(0,o.jsx)("div",{children:T})]}))]}),f&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",Object.assign({className:"section-header"},{children:s.t(Kn.LABEL_INFORMATION)})),(0,o.jsx)("div",Object.assign({className:"section-body"},{children:f}))]}),h&&(0,o.jsxs)("div",{children:[(0,o.jsx)("div",Object.assign({className:"section-header"},{children:s.t(Kn.LABEL_LEARN_MORE)})),(0,o.jsxs)("div",Object.assign({className:"external-link-wrapper"},{children:[(0,o.jsx)("i",Object.assign({className:"icon-ext-link"},{children:" "})),(0,o.jsx)("a",Object.assign({className:"section-body link",onClick:this.onExternalLinkClicked,href:h,target:"_blank",rel:"noopener"},{children:h}))]}))]})]}))]}))}))}}SummaryContent.contextType=h.I;const qn=Wn(SummaryContent);var Zn=n(84475);const{SUMMARY:$n}=p.Z.SHOWCASE;class SummaryPanel extends i.Component{constructor(){super(...arguments),this.handleCloseClick=()=>{const{commandBinder:e}=this.context;e.issueCommand(new G.tT(u.w1.SUMMARY,!1))}}render(){const{modelDetails:e,brandingEnabled:t,showExternalUrl:n}=this.props,{locale:i}=this.context;return(0,o.jsxs)("div",Object.assign({className:"summary-panel list-panel active"},{children:[(0,o.jsxs)("div",Object.assign({className:"summary-panel-header list-panel-header"},{children:[(0,o.jsx)(Zn._,Object.assign({className:"summary-panel-title"},{children:i.t($n.HEADING)})),(0,o.jsx)("div",{children:(0,o.jsx)(M.hU,{iconClass:"icon-close",buttonStyle:M.Dd.PLAIN,onClick:this.handleCloseClick})})]})),(0,o.jsx)(qn,{modelDetails:e,brandingEnabled:t,showExternalUrl:n})]}))}}SummaryPanel.contextType=h.I;const Qn=new R.Z("showcase-ui"),Xn=(0,f.FU)();class ShowcaseUi extends i.Component{constructor(e,t){super(e,t),this.bindings=[],this.mobile=(0,T.tq)(),this.propertiesToRefreshUi=[F.gx.Measurements,F.gx.DetailsModelName,S.ws,F.gx.FloorSelect],this.isUnmounting=!1,this.initialToolLoaded=!1,this.getModeChange=e=>({viewmode:(0,V.ty)(e.toMode)}),this.updateToolPanelLayout=()=>{const{toolsData:e,mainDiv:t}=this.context,n=e.toolPanelLayout;this.setState({toolPanelLayout:n}),(0,Qt.j)(t,n)},this.showHelpOnPlaying=e=>{e.phase===d.nh.PLAYING&&(this.context.commandBinder.issueCommand(new x.Bz(w.P.CTA,!0)),this.context.messageBus.unsubscribe(c.LZ,this.showHelpOnPlaying))},this.updateTools=()=>{const{toolsData:e}=this.context,{toolsLoaded:t}=this.state;e.toolsMap.length>0&&!t&&this.setState({toolsLoaded:!0}),this.initialToolLoaded||this.showInitialTool()},this.updatePerSettings=()=>{this.setState({measurementsModeEnabled:this.isMeasurementsEnabled(),notesEnabled:this.isNotesEnabled(),newTagsEnabled:this.isNewTagsEnabled()})},this.updateTourState=()=>{this.tourData&&this.setState({tourState:this.tourData.getCurrentTourState()})},this.updateTourMode=()=>{this.toursViewData&&this.setState({tourMode:this.toursViewData.currentTourMode})},this.isVrButtonEnabled=()=>(0,Le.hX)(this.context.settings),this.updateActiveTool=()=>{const{tourState:e}=this.state,{toolsData:t,commandBinder:n,mainDiv:i}=this.context,s=t.activeToolName;this.setState({activeTool:s}),window.clearTimeout(this.panelCloseTimeout),s?i.classList.add("tool-open"):this.panelCloseTimeout=window.setTimeout((()=>{i.classList.remove("tool-open")}),400),s&&e.tourPlaying&&n.issueCommand(new k.vy,!1)},this.openModalChanged=()=>{const{toolsData:e,commandBinder:t,mainDiv:n}=this.context,{tourState:i}=this.state,s=e.openModal;s?n.classList.add("modal-open"):n.classList.remove("modal-open"),s&&i.tourPlaying&&t.issueCommand(new k.vy,!1),this.setState({openModal:s})},this.renderLeftPanels=()=>{const{modelDetails:e,brandingEnabled:t,toolPanelLayout:n,activeTool:i,showExternalUrl:s}=this.state;return(0,o.jsxs)($t.g,Object.assign({activeTool:i,sidePanelCollapsible:!1,toolPanelLayout:n,className:"side-panel-left"},{children:[!!e&&(0,o.jsx)(SummaryPanel,{modelDetails:e,brandingEnabled:t,showExternalUrl:s},u.w1.SUMMARY),(0,o.jsx)(Dn.E,{toolPanelLayout:n},u.w1.SEARCH)]}))},this.glCanvas=document.getElementsByClassName("webgl-canvas")[0],this.state={viewmode:V.g,activeTool:null,openModal:null,toolsLoaded:!1,toolPanelLayout:t.toolsData.toolPanelLayout,tourState:{},tourMode:N.zz.NONE,modelDetails:null,measurementsModeEnabled:!1,notesEnabled:!1,newTagsEnabled:!1,vrEnabled:!1,brandingEnabled:!1,shareEnabled:!1,unaligned:!0,showExternalUrl:!1}}async componentDidMount(){const{settings:e,messageBus:t,market:n,toolsData:i}=this.context;for(const t of this.propertiesToRefreshUi)e.onPropertyChanged(t,this.updatePerSettings);try{this.cancelBindings(),this.bindings=[i.onToolsLoadedChanged(this.updateTools),i.onToolChanged(this.updateActiveTool),i.onOpenModalChanged(this.openModalChanged),i.onToolPanelLayoutChanged(this.updateToolPanelLayout),i.toolsMap.onChanged(this.updatePerSettings)],this.handleStartUpHelp();const[e,s,r,o,a]=await Promise.all([n.waitForData(St.T),n.waitForData(Yt.O),n.waitForData(Ft.Z),n.waitForData(Wt.k),n.waitForData(Kt.T)]);if(this.isUnmounting)return;this.bindings.push(t.subscribe(pe.Z,(e=>this.setState(Object.assign(Object.assign({},this.getModeChange(e)),this.getUnalignedSweepState())))),t.subscribe(xe.NR,this.updateTourState),t.subscribe(xe.oR,this.updateTourState),t.subscribe(xe.Vx,this.updateTourState),t.subscribe(xe.Mt,this.updateTourState),t.subscribe(xe.dW,this.updateTourState),o.getReel().onChanged(this.updateTourState),a.onCurrentTourModeChanged(this.updateTourMode),r.makeSweepChangeSubscription((()=>this.setState(this.getUnalignedSweepState()))));const l=(0,V.ty)(s.currentMode||qt.Ey.Panorama);this.tourData=o,this.toursViewData=a,this.sweepData=r,this.viewmodeData=s,this.setState(Object.assign({viewmode:l,modelDetails:e.model.details,brandingEnabled:this.isBrandingEnabled()&&!this.isMlsEnabled(),shareEnabled:this.isShareEnabled()&&!this.isMlsEnabled(),showExternalUrl:this.isBrandingEnabled()&&!this.isMlsEnabled(),vrEnabled:this.isVrButtonEnabled()},this.getUnalignedSweepState())),this.props.onAppReadyChanged(!0,!1)}catch(e){Qn.debug(e)}this.updateTourState(),this.updateTourMode(),this.updateActiveTool(),this.updateTools(),this.updatePerSettings()}async componentWillUnmount(){this.isUnmounting=!0;for(const e of this.propertiesToRefreshUi)this.context.settings.removeOnPropertyChanged(e,this.updatePerSettings);this.cancelBindings(),this.props.onAppReadyChanged(!1,!1)}handleStartUpHelp(){const{settings:e,messageBus:t,commandBinder:n}=this.context,i=e.tryGetProperty("help",0);if(1===i||2===i){const i=1===e.tryGetProperty("ts",0),s=!0===e.tryGetProperty("quickstart",!1);i||(s?n.issueCommand(new x.Bz(w.P.CTA,!0)):t.subscribe(c.LZ,this.showHelpOnPlaying))}}showInitialTool(){const{toolsData:e,settings:t}=this.context,n=t.tryGetProperty(re.RY,!1),i=t.tryGetProperty(oe.IA,!1),s=(0,zt.u)(t,n,i);s&&e.hasTool(s)&&(this.initialToolLoaded=!0,window.setTimeout((()=>{(0,zt.a)(s,this.context)}),750))}getUnalignedSweepState(){if(!this.sweepData||!this.viewmodeData)return{unaligned:this.state.unaligned};return{unaligned:this.viewmodeData.isInside()&&this.sweepData.isSweepUnaligned(this.sweepData.currentSweep)}}cancelBindings(){for(const e of this.bindings)e.cancel()}isNotesEnabled(){const{settings:e,toolsData:t}=this.context;return e.tryGetProperty(oe.IA,!1)&&!!t.getTool(u.w1.NOTES)}isNewTagsEnabled(){const{settings:e,toolsData:t}=this.context;return e.tryGetProperty(re.RY,!1)&&!!t.getTool(u.w1.TAGS)}isMeasurementsEnabled(){const{settings:e,toolsData:t}=this.context;return e.tryGetProperty(F.gx.Measurements,!0)&&!!t.getTool(u.w1.MEASUREMENTS)}isShareEnabled(){const{settings:e}=this.context,t=e.tryGetProperty(sn.Yo,!1)&&e.tryGetProperty("is_public",!1),n=(0,T.SP)()&&"0"===Xn.share;return t&&!n}isMlsEnabled(){return this.context.settings.tryGetProperty(sn.sX,!1)}isBrandingEnabled(){const{settings:e}=this.context;return e.tryGetProperty(sn.L,!0)}renderToolPanels(){const{notesEnabled:e,newTagsEnabled:t,activeTool:n,openModal:i,toolPanelLayout:s}=this.state;if(!e&&!t)return null;const{toolsData:r}=this.context,a=e&&r.getTool(u.w1.NOTES),l=t&&r.getTool(u.w1.TAGS);return(0,o.jsxs)($t.g,Object.assign({activeTool:n,sidePanelCollapsible:!1,toolPanelLayout:s,className:"side-panel-right"},{children:[a&&(0,o.jsx)(_n.s,{manager:a.manager,modalOpen:!!i,toolPanelLayout:s},u.w1.NOTES),l&&(0,o.jsx)(xn,{},u.w1.TAGS)]}))}renderToolOverlay(e){const{toolsData:t}=this.context,{openModal:n,activeTool:i,unaligned:s,toolPanelLayout:r}=this.state,a=t.toolsMap.get(u.w1.MEASUREMENTS),l=t.toolsMap.get(u.w1.NOTES);return(0,o.jsxs)("div",Object.assign({className:"tool-overlay"},{children:[!i&&(0,o.jsx)(Nn,{}),i===u.w1.MEASUREMENTS&&a&&(0,o.jsx)(An.f,{mobile:this.mobile,openModal:n,unaligned:s,manager:a.manager}),i===u.w1.NOTES&&l&&(0,o.jsx)(Mn.R,{openModal:n,toolPanelLayout:r,manager:l.manager}),(0,o.jsx)(On.r,{}),i===u.w1.SEARCH&&(0,o.jsx)(In.F,{isNarrowScreen:e})]}))}render(){const{viewmode:e,unaligned:t,tourState:n,modelDetails:i,measurementsModeEnabled:s,notesEnabled:r,shareEnabled:a,brandingEnabled:c,vrEnabled:d,openModal:h,toolsLoaded:p,toolPanelLayout:m,activeTool:f,tourMode:g}=this.state,{tourPlaying:v,activeStep:y,currentStep:b,highlights:S}=n,E=f===u.w1.SEARCH,T=g===N.zz.STORIES,w=m===u.wS.NARROW||m===u.wS.BOTTOM_PANEL;return(0,o.jsxs)("div",Object.assign({id:"gui",className:l()({"search-mode":E})},{children:[!!i&&(0,o.jsx)(ne.Z,{showing:!h&&!f,modelDetails:i,tourState:n,brandingEnabled:c,activeTool:f}),(0,o.jsx)(Modals,{viewmode:e,glCanvas:this.glCanvas,openModal:h}),(0,o.jsxs)("div",Object.assign({className:"showcase-ui-overlay"},{children:[this.renderLeftPanels(),(0,o.jsxs)("div",Object.assign({className:"scene-overlay"},{children:[T&&(0,o.jsx)(_e.m,{activeTool:f,tourPlaying:v,currentStep:b,activeStep:y,highlights:S}),(0,o.jsx)(OverlayUi,{viewmode:e,openModal:h,tourState:n,mobile:this.mobile}),p&&this.renderToolOverlay(w),(0,o.jsx)(te,{openModal:h,openTool:f,unaligned:t,viewmode:e,tourState:n,tourMode:g,measurementsModeEnabled:s,notesEnabled:r,shareEnabled:a,vrEnabled:d,toolPanelLayout:m})]})),this.renderToolPanels(),(0,o.jsx)(Zt.C,{})]}))]}))}}ShowcaseUi.contextType=h.I;var Jn=n(61903),ei=n(25986),ti=n(29410),ni=n(49767),ii=n(38035),si=n(51551);const{TOOLS:ri}=p.Z;class ShowcaseGui extends r.Y{constructor(){super(),this.name="showcase-gui-module",this.loadUi=this.loadUi.bind(this)}async init(e,t){this.engine=t,[this.settingsData,this.toolsData]=await Promise.all([t.market.waitForData(Jn.e),t.market.waitForData(ei.t)])}async loadUi(e,t,n,r,o,a,l,c,d,u,p,m){const f={editMode:!1,locale:e,analytics:t,settings:n,toolsData:this.toolsData,userData:r,mainDiv:o,engine:l,messageBus:c,market:d,commandBinder:u,queue:m};this.reactRoot=(0,s.s)(a),this.reactRoot.render((0,i.createElement)(h.I.Provider,{value:f},[(0,i.createElement)(ShowcaseUi,{key:"showcase-ui",onAppReadyChanged:p})])),this.initializeTools()}async unloadUi(){return!!this.reactRoot&&(this.reactRoot.unmount(),!0)}initializeTools(){const e=[new ti.U({id:u.w1.NOTES,namePhraseKey:ri.NOTES,panel:!0,icon:"icon-comment-outline",analytic:"notes_mode",toolbar:!1,dimmed:!1,enabled:this.settingsData.tryGetProperty(oe.IA,!1),hidesAppBar:!0,manager:new ii.L(this.engine,this.settingsData)}),new ti.U({id:u.w1.MEASUREMENTS,namePhraseKey:ri.MEASUREMENTS,panel:!1,icon:"icon-tape-measure",analytic:"measure_mode",toolbar:!1,dimmed:!1,enabled:this.settingsData.tryGetProperty(F.gx.Measurements,!0),manager:new ni.u(this.engine,this.settingsData)}),new ti.U({id:u.w1.SUMMARY,namePhraseKey:ri.SUMMARY,panel:!0,panelLeft:!0,analytic:"summary_panel",toolbar:!1,dimmed:!1,enabled:!0,hidesAppBar:!0,manager:{activate:async()=>{},deactivate:async()=>{}}})];this.settingsData.tryGetProperty(re.RY,!1)&&e.push(new ti.U({id:u.w1.TAGS,namePhraseKey:ri.TAGS,panel:!0,icon:"icon-toolbar-mattertags",analytic:"mattertag",toolbar:!1,dimmed:!1,enabled:!0,hidesAppBar:!0,manager:new si.Q(this.engine,this.settingsData)})),this.engine.commandBinder.issueCommand(new G.MV(e))}}},5077:(e,t,n)=>{"use strict";n.d(t,{Z:()=>oe});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(54119),c=n(53825),d=n(80312),u=n(41345),h=n(10854),p=n(58575),m=n(14385),f=n(15314),g=n(76031),v=n(28741),y=n(17111);const{SUBSCRIBER_PROMPT:b}=h.Z.SHOWCASE,S=e=>{e.preventDefault()},E=()=>{const e=(0,d.z)(),t=(0,u.b)(),{popupDelay:n}=(0,v.p)(),[r,o]=(0,s.useState)(0),[a,h]=(0,s.useState)(!1),[E,T]=(0,s.useState)(!0),[w,x]=(0,c._)(g.pr,!1);(0,f.U)(p.i,(e=>{if(a)return;const t=e.durationDollhouse+e.durationFloorplan+e.durationInside,i=r+t;m.L.debug(`Check Visibility: ${i}/${n}ms, User has dismissed popup: ${w.toString()}`),i>=n&&!w&&h(!0),o(i)}));const _=(0,s.useCallback)((()=>{x(!0)}),[x]),M=(0,s.useCallback)((t=>{t.stopPropagation(),e.trackGuiEvent("subscriber_prompt_a_popup_dismissed"),_()}),[_,e]),O=(0,s.useCallback)((t=>{e.trackGuiEvent("subscriber_prompt_a_popup_cta_click"),window.open(g.gP,"_blank"),_()}),[_,e]);return(0,s.useEffect)((()=>(a&&E&&(e.trackGuiEvent("subscriber_prompt_a_popup_viewed"),T(!1)),()=>{})),[e,a,E]),a?(0,i.jsxs)("div",Object.assign({className:"subscriber-prompt-popup",onClick:O},{children:[(0,i.jsx)("img",{className:"matterport-app-icon",alt:"Matterport App Icon",src:y,width:"48",height:"48"}),(0,i.jsxs)("div",Object.assign({className:"subscriber-prompt-body"},{children:[(0,i.jsx)("div",Object.assign({className:"h5 subscriber-prompt-heading"},{children:t.t(b.POPUP_CTA_HEADING)})),(0,i.jsx)("a",Object.assign({className:"link",target:"_blank",onClick:S,href:g.gP},{children:t.t(b.POPUP_CTA_LINK_TEXT)}))]})),(0,i.jsx)(l.zx,{icon:"close",onClick:M})]})):null};var T=n(37632),w=n(61445),x=n(78576),_=n(87982),M=n(9986),O=n(36667),A=n(60217),C=n(67779),N=n(95551),D=n(41252),I=n(18814);const L=new C.f({from:null,to:null,progress:new D.z(0),promise:Promise.resolve()});var P=n(58817);function R(){const e=function(){const e=(0,I.I)();return(0,N.y)(e?e.transitionObservable:L)}();return(0,P.q)((null==e?void 0:e.to)||null)}function k(e){const{commandBinder:t}=(0,s.useContext)(a.I),n=(0,O.W)(),r=function(){const e=(0,A.m)(),t=R(),[n,i]=(0,s.useState)(e?e.name:"");return(0,s.useEffect)((()=>(e?i(e.name):t&&i(t.name),()=>{})),[e,t]),n}(),l=(0,s.useCallback)((()=>{t.issueCommand(new T.Vw(null,!1))}),[t]);if(n!==M.nh.PLAYING)return null;const c=o()("floor-container",e.className);return(0,i.jsxs)("div",Object.assign({className:c},{children:[(0,i.jsx)("div",Object.assign({className:"floor-title h4"},{children:r||""})),(0,i.jsx)(_.hU,{iconClass:"icon-close",buttonStyle:_.Dd.CLEAR,buttonSize:w.qE.STANDARD,tooltipPosition:x.lZ.DOWN_RIGHT,onClick:l})]}))}var U=n(32683),B=n(33669),F=n(68077);var V=n(21546),H=n(8428),j=n(16534);var G=n(29055);var z=n(4731),W=n(57340),K=n(34612),Y=n(23676),q=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Z=class TitleBar extends s.Component{constructor(){super(...arguments),this.handleTitleClick=()=>{const{commandBinder:e,analytics:t}=this.context;e.issueCommand(new K.tT(Y.w1.SUMMARY,!0)),t.track("click_model_title",{interaction_source:"gui"})}}getFilteredValue(e,t,n,i){return!this.context.settings.tryGetProperty(t,n)||i&&!this.props.brandingEnabled?"":e}render(){const{locale:e}=this.context,{className:t,modelDetails:n}=this.props,{name:s,presentedBy:r}=n,a=this.getFilteredValue(s,H.gx.DetailsModelName,!0,!1),l=this.getFilteredValue(r,H.gx.PresentedBy,!1,!0),c=!!l;return(0,i.jsx)("div",Object.assign({id:"model-title",onClick:this.handleTitleClick,className:t,role:"button"},{children:(0,i.jsx)("div",Object.assign({id:"main-title-wrapper"},{children:(0,i.jsxs)("div",Object.assign({className:"main-title"},{children:[c&&(0,i.jsx)("div",Object.assign({className:"co-brand"},{children:(0,i.jsxs)("span",Object.assign({className:"title",id:"cobrandTitle"},{children:[e.t(h.Z.PRESENTED_BY),l]}))})),(0,i.jsxs)("div",Object.assign({id:"gui-name",className:o()({titleText:!0,noCoBrand:!l})},{children:[(0,i.jsx)("span",{className:"icon icon-location"}),a]}))]}))}))}))}};Z.contextType=a.I,Z=q([W.Z],Z);const $=Z;var Q=n(62667),X=n(81658),J=n(93590),ee=n(53033);var te=n(21396),ne=n(37614);function ie(e,t,n,i){return i?i.getViewName(e.id,t,n):e.name}function se(){const{analytics:e,commandBinder:t}=(0,s.useContext)(a.I),[n,r]=(0,s.useState)(!1),o=(0,X.K)(),c=(0,J.m)(),d=(0,ee._)(),u=(0,Q.o)(),h=function(){const e=(0,ee._)();return null==e?void 0:e.getInitialView()}(),p=(null==h?void 0:h.viewType)===te.X.BASE,m="View",f=(0,s.useCallback)((n=>{e.trackToolGuiEvent("layers","layers_switch_view"),t.issueCommand(new ne.wG(n.id))}),[e,t]),g=(0,s.useCallback)((()=>{r(!1)}),[]);if(!o||!p||c.length<2)return null;const v=c.map((e=>({text:ie(e,m,u,d),id:e.id}))),y=ie(o,m,u,d);return(0,i.jsx)("div",Object.assign({className:"model-view-selector"},{children:(0,i.jsx)(l.do,{className:"model-view-selector",variant:l.Wu.PRIMARY,size:l.qE.SMALL,theme:"dark",icon:"dpad-down",label:y,options:v,selectedOptionId:o.id,isOpen:n,onChange:f,onCancel:g})}))}var re=n(94511);function oe(e){const{activeTool:t,brandingEnabled:n,modelDetails:r,showing:l,tourState:d}=e,u=(0,V.e)(),h=(0,z.J)(),p=(0,F.y)(U.Q5,!1),m=(0,F.y)(U.gu,!0),f=p&&m,y=function(){const e=(0,I.I)(),[t,n]=(0,s.useState)(!!e&&e.showFloorSelection);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onShowFloorSelectionChanged(n);return n(e.showFloorSelection),()=>t.cancel()}),[e]),t}(),b=function(){const e=(0,F.y)(j.Zz,!0),t=(0,F.y)(H.gx.DetailsModelName,!0);return e&&t}(),S=!y,T=(()=>{const e=(0,G.a)(),t=(0,v.p)(),n=(0,c.Fx)(g.pr);return t.popupEnabled&&e&&!n})(),w=(0,F.y)(B.In,!1),{editMode:x}=(0,s.useContext)(a.I);if(!(u||b||f||w))return null;const _=o()("top-ui",{"faded-out":!l||d.tourPlaying||h}),M=o()({"faded-out":!y}),O=o()({"faded-out":!S});return(0,i.jsxs)(i.Fragment,{children:[T&&!t&&(0,i.jsx)(E,{}),(0,i.jsxs)("div",Object.assign({className:_},{children:[u&&(0,i.jsx)(re.Z,{activeTool:t}),(0,i.jsxs)("div",Object.assign({className:"child-container"},{children:[f&&(0,i.jsxs)("div",Object.assign({className:o()("container-fill","floor-name-container")},{children:[(0,i.jsx)(k,{className:M}),u&&(0,i.jsx)("div",{className:"search-button-spacer"})]})),b&&r&&(0,i.jsx)("div",Object.assign({className:o()("container-fill","title-bar-container")},{children:(0,i.jsx)($,{className:O,modelDetails:r,brandingEnabled:!!n})})),w&&!x&&(0,i.jsx)(se,{})]}))]}))]})}},85411:(e,t,n)=>{"use strict";n.d(t,{G:()=>StartApplicationCommand,M:()=>ExpandIframeCommand});var i=n(93037);class StartApplicationCommand extends i.m{constructor(e){super(),this.payload={startup:e}}}StartApplicationCommand.id="START_APPLICATION";class ExpandIframeCommand extends i.m{constructor(e){super(),this.payload={expand:e}}}ExpandIframeCommand.id="EXPAND_APP"},32389:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>LoadingGui});var i=n(57227),s=n(41907),r=n(9986),o=n(97966),a=n(39142),l=n(10854),c=n(2252),d=n(87100),u=n(81402),h=n(31013),p=n(90831),m=n(33877),f=n(43585);class ProgressRadial{constructor(e){this.lastProgress=0,this.currentProgress=0,this.webpackChunks=[],this.meshAlloc={alloc:2e6,loaded:0},this.showingProgress=!1,this.progressElm=document.getElementById("bar"),window.addEventListener("WebpackChunkProgress",this.onWebpackChunkProgress.bind(this)),this.engine=e,this.meshProgressBinding=this.onMeshLoadProgress.bind(this),this.engine.subscribe(f.Z,this.meshProgressBinding)}showProgress(){this.showingProgress=!0,this.setProgress(this.currentProgress)}setDone(){this.currentProgress=100,this.setProgress(this.currentProgress),this.engine.unsubscribe(f.Z,this.meshProgressBinding)}setProgress(e){if(!this.progressElm||isNaN(e))return;this.lastProgress=Math.max(this.lastProgress,e),e=this.lastProgress;const t=Number.parseFloat(this.progressElm.getAttribute("r")||"0"),n=Math.PI*(2*t),i=(100-(e=Math.max(Math.min(e,100),0)))/100*n;this.progressElm.style.strokeDashoffset=i.toString(10)}calcProgress(){let e=0,t=0;this.webpackChunks.forEach((n=>{e+=n.loaded,t+=n.total})),e+=this.meshAlloc.loaded,t+=this.meshAlloc.alloc,this.currentProgress=75*Math.min(e/t,1),this.showingProgress&&this.setProgress(this.currentProgress)}onWebpackChunkProgress(e){this.webpackChunks[e.chunkID]?this.webpackChunks[e.chunkID].loaded=e.loaded:this.webpackChunks[e.chunkID]={loaded:e.loaded,total:e.total},this.calcProgress()}onMeshLoadProgress(e){this.meshAlloc.loaded=e.loaded/e.total*this.meshAlloc.alloc,this.calcProgress()}}var g=n(61026),v=n(85411),y=n(16534),b=n(61903),S=n(36507);function E(e,t){var n;let i=function(e){return document.querySelector(`link[rel=${e}]`)}(e);i||(i=document.createElement("link"),null===(n=document.getElementsByTagName("head")[0])||void 0===n||n.appendChild(i)),i.setAttribute("rel",e),i.setAttribute("href",t)}class LoadingGui extends i.Y{constructor(){super(...arguments),this.name="loading-ui",this.playPromise=new h.Q,this.resolvePlayPromise=async(e,t)=>{if(this.config.allowPlayInIframe||!this.config.startNewTab){if((0,c.yL)())if(t&&(this.config.allowPlayInIframe||1===(0,d.eY)("expand",0)))this.toggleIframeExpansion(!0);else if(!this.config.allowPlayInIframe){const e=(0,d.kD)();t&&e.set("edit","1"),e.set("back","1"),e.delete("cloudEdit");const n=e.toString(),i=`${window.location.origin}${window.location.pathname}?${n}`;try{return void(window.top&&(window.top.location.href=i))}catch(e){this.log.debug("Couldn't set top window location; was Showcase sandboxed?"),this.log.debug(e)}}t&&this.settings.setProperty("quickstart",!0),e&&(this.config.noUi||(this.playIcon.classList.add("hidden"),this.progressUI.showProgress()),this.playPromise.resolve())}else{const e=(0,S.m5)(window.location.href);window.open(e,"_blank")}},this.toggleIframeExpansion=e=>{const t=e?new g.n3:new g.mQ;this.engine.commandBinder.issueCommand(t),this.engine.broadcast(new m.G(e))},this.onAppPhaseChangeMessage=async e=>{e.phase!==r.nh.STARTING&&e.phase!==r.nh.PLAYING&&e.phase!==r.nh.ERROR||(this.progressUI.setDone(),this.config.quickstart?this.showQuickstartUI():this.uiRoot.classList.add("faded-out"),this.engine.unsubscribe(s.LZ,this.onAppPhaseChangeMessage))}}async init(e,t){this.engine=t,this.config=e,this.locale=await t.getModule(a.default),this.settings=await t.market.waitForData(b.e);const n=await t.market.waitForData(o.T);this.model=n.model.details,this.updateHtmlMetadata(n,this.settings),this.bindings.push(t.commandBinder.addBinding(v.G,(async e=>{this.resolvePlayPromise(e.startup,!0)})),t.commandBinder.addBinding(v.M,(async e=>{this.toggleIframeExpansion(e.expand)}))),e.noUi||(this.bindings.push(this.settings.onPropertyChanged(y.DU,(()=>this.renderTitle())),this.settings.onPropertyChanged(y.L,(()=>this.renderBranding())),this.settings.onPropertyChanged(y.sX,(()=>this.renderBranding())),t.subscribe(s.LZ,this.onAppPhaseChangeMessage)),this.progressUI=new ProgressRadial(t),this.loadUi(),this.getLoadingElements(),this.renderSplashScreen())}get waitForPlaying(){return this.playPromise.nativePromise()}loadUi(){if(this.uiRoot=document.getElementById("loading-gui"),!this.uiRoot)throw Error("Loading GUI root not found");this.uiRoot.classList.remove("hidden"),this.config.quickstart&&(this.uiRoot.style.pointerEvents="none")}getPresentationOptions(){const{hideTitle:e,hideBranding:t,quickstart:n}=this.config,i=!n&&(void 0!==e?!e:this.settings.tryGetProperty(y.DU,!0)),s=this.settings.tryGetProperty(y.sX,!1),r=this.settings.tryGetProperty(y.L,!0);return{title:i,presentedBy:void 0!==t?!t:r&&!s}}getLoadingElements(){this.presentedBy=document.getElementById("loading-presented-by"),this.poweredBy=document.getElementById("loading-powered-by"),this.mpLogo=document.getElementById("loading-mp-logo"),this.mpLogo.src=p,this.mpLogo.alt=this.locale.t(l.Z.ALT_MATTERPORT_LOGO),this.circleLoader=document.getElementById("circleLoader"),this.nameHeader=document.getElementById("loading-header"),this.background=document.getElementById("loading-background"),this.tint=document.getElementById("tint"),this.playIcon=document.getElementById("showcase-play")}addCobrand(){var e;if(null===(e=this.model)||void 0===e?void 0:e.presentedBy){const e=this.presentedBy.querySelector(".loading-label");e&&(e.textContent=this.locale.t(l.Z.PRESENTED_BY_CAPS));const t=this.presentedBy.querySelector(".subheader");t&&(t.textContent=this.model.presentedBy),this.presentedBy.classList.remove("hidden")}}hidePlayButtonUI(){this.background.style.backgroundImage="none",this.presentedBy.style.transition="none",this.presentedBy.classList.remove("faded-in"),this.poweredBy.style.transition="none",this.poweredBy.classList.remove("faded-in"),this.nameHeader.classList.add("hidden"),this.tint.classList.add("hidden"),this.circleLoader.classList.add("hidden"),this.uiRoot.classList.add("quickstart")}async showQuickstartUI(){this.background.classList.add("faded-out"),await(0,u.gw)(500),this.presentedBy.style.transition="",this.presentedBy.classList.add("faded-in"),this.poweredBy.style.transition="",this.poweredBy.classList.add("faded-in"),await(0,u.gw)(2500),this.presentedBy.classList.remove("faded-in"),this.poweredBy.classList.remove("faded-in"),this.uiRoot.classList.add("faded-out")}showLoadingUI(e){const t=document.createAttribute("data-status");t.value=this.locale.t(l.Z.LOADING);const n=document.getElementById("loader-cont");n.attributes.setNamedItem(t),n.classList.add(this.locale.languageCode),n.classList.add("loading"),e.classList.add("faded-out"),this.presentedBy.classList.add("faded-in")}renderTitle(){const{title:e}=this.getPresentationOptions();this.nameHeader.classList.toggle("hidden",!e)}renderBranding(){const{presentedBy:e}=this.getPresentationOptions();e?this.addCobrand():this.presentedBy.classList.add("hidden")}renderSplashScreen(){this.renderTitle(),this.renderBranding(),this.config.hidePoweredBy&&this.poweredBy.classList.add("hidden"),this.nameHeader.textContent=this.model.name,this.poweredBy.classList.add("faded-in"),this.tint.classList.add("faded-in");const e=document.getElementById("play-prompt");this.playPromise.then((()=>{this.config.quickstart?this.hidePlayButtonUI():this.showLoadingUI(e)})),this.config.autoplay?(this.progressUI.showProgress(),this.playPromise.resolve()):(e.classList.remove("hidden"),e.innerText=this.locale.t(l.Z.EXPLORE_3D_SPACE),this.playIcon.classList.remove("hidden"),this.uiRoot.addEventListener("click",(()=>this.resolvePlayPromise(!0,!1)))),this.renderBackground(),this.config.allowPlayInIframe||window.scrollTo(0,0)}renderBackground(){const e=window.devicePixelRatio||1,t=Math.max(window.innerWidth,400);this.background.style.backgroundImage=`url(${this.config.baseUrl}/api/v1/player/models/${this.config.viewId}/thumb?width=${t}&dpr=${e}&disable=upscale)`}updateHtmlMetadata(e,t){const n=t.tryGetProperty(y.r4,null);if(e.hasDiscoverUrl()&&n){E("canonical",`${n}${e.model.sid}`)}}}},33877:(e,t,n)=>{"use strict";n.d(t,{G:()=>ShowcaseExpansionMessage});var i=n(4117);class ShowcaseExpansionMessage extends i.v{constructor(e){super(),this.expanded=e}}},46977:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>QuickMenus});var i=n(57227),s=n(14877),r=n(49702),o=n(15099),a=n(53549),l=n(18984),c=n(20751),d=n(82702),u=n(14279),h=n(77866),p=n(18196),m=n(61903),f=n(43985),g=n(24486),v=n(18253),y=n(57312);class QuickMenus extends i.Y{constructor(){super(...arguments),this.name="quick-menus"}async init(e,t){this.settingsModule=await t.getModuleBySymbol(s.y.SETTINGS),this.scanInfoDataModule=await t.getModuleBySymbol(s.y.SCAN_INFO),this.settingsGui=this.settingsModule.getSettingsGui();const n=await t.getModuleBySymbol(s.y.DEEP_LINKS),i=await t.market.waitForData(a.Z),b=await t.market.waitForData(m.e),S=await t.market.waitForData(o.M_);this.uIndex=this.settingsGui.addPanel("Link to location",[f.R.U],{allowSubGroups:!1,width:400,ratio:90});const E=[38,38,40,40,37,39,37,39,66,65,f.R.O];this.oIndex=this.settingsGui.addPanel("Scan Info",E,{allowSubGroups:!1,width:400,ratio:75}),this.pIndex=this.settingsGui.addPanel("Quick settings",[f.R.P],{allowSubGroups:!1}),this.settingsGui.loadPromise.then((()=>{this.settingsGui.addControl(this.uIndex,"","Link",{}),this.settingsGui.addButton(this.uIndex,"","Copy to clipboard",(()=>{const e=document.createElement("input");e.type="text",e.value=this.buildLink(n),document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)})),this.settingsGui.toggle(this.uIndex),this.settingsGui.addControl(this.oIndex,"","Scan ID",{}),this.settingsGui.addControl(this.oIndex,"","Anchor ID",{}),this.settingsGui.addControl(this.oIndex,"","Created",{}),this.settingsGui.addControl(this.oIndex,"","Time of Day",{}),this.settingsGui.addControl(this.oIndex,"","Alignment",{}),this.settingsGui.addControl(this.oIndex,"","Options",{}),this.settingsGui.addControl(this.oIndex,"","Camera",{}),this.settingsGui.addControl(this.oIndex,"","Camera Types",{}),this.settingsGui.addControl(this.oIndex,"","Sensor Serials",{}),this.settingsGui.addControl(this.oIndex,"","Serial Number",{}),this.settingsGui.addControl(this.oIndex,"","Mount Calibration",{}),this.settingsGui.addControl(this.oIndex,"","Software Version",{}),this.settingsGui.addButton(this.oIndex,"","Copy Scan ID",(async()=>{if(i.currentSweep){const e=await this.scanInfoDataModule.getScanInfo(i.currentSweep);if(e){const t=document.createElement("input");t.type="text",t.value=e.id,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}})),this.settingsGui.addButton(this.oIndex,"","Download Scan",(async()=>{if(i.currentSweep){const e=await this.scanInfoDataModule.getScanDownloadURL(i.currentSweep);e&&window.open(e)}})),this.settingsGui.toggle(this.oIndex);const e=c.WI*(180/Math.PI)*60;this.settingsGui.addControl(this.pIndex,"",u.U,!0),this.settingsGui.addControl(this.pIndex,"",g.s,!0),this.settingsGui.addControl(this.pIndex,"",v.re,!0),this.settingsGui.addControl(this.pIndex,"",y.b,!0),this.settingsGui.addSlider(this.pIndex,"",d.lookAccelerationKey,e,.25,10,2),this.settingsGui.addSlider(this.pIndex,"",r.baseTransitionSpeedKey,l.Z.camera.baseTransitionTime,1,5e3,0);const t=b.tryGetProperty(h.EU,h.Im);this.settingsGui.addSlider(this.pIndex,"",h.WQ,(0,p.JG)(t),.5,10,2),this.settingsGui.toggle(this.pIndex),this.settingsModule.registerSetting("Quick settings",d.lookAccelerationKey,e,!1),this.settingsModule.registerSetting("Quick settings",r.baseTransitionSpeedKey,l.Z.camera.baseTransitionTime,!1),this.settingsGui.onToggle(this.uIndex,(e=>{e&&this.settingsGui.updateSetting(this.uIndex,"Link",this.buildLink(n))})),this.settingsGui.onToggle(this.oIndex,(e=>{e&&this.refreshScanInfo(i)})),S.pose.onChanged((()=>{this.settingsGui.isLoaded&&this.settingsGui.isVisible(this.uIndex)&&this.settingsGui.updateSetting(this.uIndex,"Link",this.buildLink(n)),this.settingsGui.isLoaded&&this.settingsGui.isVisible(this.oIndex)&&this.refreshScanInfo(i)})),b.onPropertyChanged(h.WQ,(e=>{b.setProperty(h.EU,(0,p.HG)(e))}))}))}refreshScanInfo(e){e.currentSweep?this.scanInfoDataModule.getScanInfo(e.currentSweep).then((e=>{this.updateScanInfo(e)})):this.updateScanInfo(void 0)}updateScanInfo(e){this.settingsGui.updateSetting(this.oIndex,"Scan ID",e?e.id:""),this.settingsGui.updateSetting(this.oIndex,"Anchor ID",e?e.anchorId:""),this.settingsGui.updateSetting(this.oIndex,"Created",e?e.created:""),this.settingsGui.updateSetting(this.oIndex,"Time of Day",e?e.timeOfDay:""),this.settingsGui.updateSetting(this.oIndex,"Alignment",e?e.alignment:""),this.settingsGui.updateSetting(this.oIndex,"Options",e?JSON.stringify(e.options):""),this.settingsGui.updateSetting(this.oIndex,"Camera",e?`${e.camera.vendor} ${e.camera.model}`:""),this.settingsGui.updateSetting(this.oIndex,"Camera Types",e?JSON.stringify(e.camera.cameraTypes):""),this.settingsGui.updateSetting(this.oIndex,"Sensor Serials",e?JSON.stringify(e.camera.sensorSerialNumbers):""),this.settingsGui.updateSetting(this.oIndex,"Serial Number",e?e.camera.serialNumber:""),this.settingsGui.updateSetting(this.oIndex,"Mount Calibration",e?e.camera.mountCalibrationVersion:""),this.settingsGui.updateSetting(this.oIndex,"Software Version",e?e.camera.softwareVersion:"")}buildLink(e){return decodeURIComponent(e.creator.createDeepLink().href)}}},1390:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcaseAnalytics});var i=n(57227),s=n(14877),r=n(13350),o=n(90403),a=n(60661),l=n(42238),c=n(63408),d=n(2252),u=n(87100),h=n(83535);const p=e=>`${e}_3.0`,m=()=>{try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){return""}},f=()=>{const e=(new l.UAParser).getResult();let t=e.os.name,n=e.browser.name;const i=Object.assign({},e.device);return d._1()&&(t="iPadOS",i.vendor="Apple",i.model="iPad",i.type="tablet","Safari"===n&&(n="Mobile Safari")),{browser:{name:n,major:e.browser.major,version:e.browser.version,language:navigator.language||"",languages:navigator.languages?navigator.languages.join(", "):""},os:{name:t,version:e.os.version},device:{vendor:i.vendor,model:i.model,type:i.type}}};function g(e,t){return{app:{name:p(t),version:"3.1.69.3-0-g204b0700e6"},locale:e,screen:{width:window.screen.width,height:window.screen.height,density:window.devicePixelRatio},timezone:m(),location:{}}}const v=a.K.Logging;var y=n(36742),b=n(59057);class InteractionmodeAnalytics{constructor(){this.handlers=[{msgType:y.m,func:(e,t,n)=>{const i=n.tryGetData(b.Z);i&&e.track("interaction_mode_changed",{interaction_mode_prev:t.fromMode,interaction_mode:t.mode,interaction_source:i.source})}}]}}var S=n(36589),E=n(50566);class AnnotationAnalytics{constructor(){this.handlers=[{msgType:E.iP,func:(e,t,n)=>{const{blockType:i}=t.block;if(i===S.C.TEXT)return;let s=t.block.text;i===S.C.LINK&&(s=t.block.value||""),i===S.C.USER&&(s=t.block.id||""),e.track("annotation_block_clicked",{block_type:i,block_value:s,annotation_type:t.annotationType,annotation_id:t.id})}}]}}var T,w=n(65171),x=n(38950),_=n(72699),M=n(94772);function O(e,t){switch(e){case M.z9.ALIGNED:return 1;case M.z9.UNALIGNED:return 2}switch(t){case M.hU.MANUAL:return 3}return 0}!function(e){e.USER="self-guided",e.TOUR="tour"}(T||(T={}));class CameraDataAnalytics{constructor(){this.startLoadTime=Date.now(),this.endLoadTime=Date.now(),this.panosViewed=0,this.handlers=[{msgType:w.Z,func:(e,t,n)=>{this.onMoveToSweepBegin(t.timestamp)}},{msgType:x.Z,func:(e,t,n)=>{const i=n.tryGetData(b.Z),s=n.tryGetData(_.k);this.endLoadTime=Date.now();const r=this.endLoadTime-this.startLoadTime;e.track("pano_viewed",{pano_id:t.toSweep,pano_view_count:++this.panosViewed,alignment_type:O(t.alignmentType,t.placementType),navigation_source:s&&s.tourPlaying?T.TOUR:T.USER,interaction_source:i?i.source:b.Z.defaultSource,interaction_mode:i?i.mode:b.Z.defaultMode,load_time:r/1e3})}}]}onMoveToSweepBegin(e){this.startLoadTime=e}}var A=n(50084);class ViewmodeAnalytics{constructor(){this.handlers=[{msgType:A.Z,func:(e,t,n)=>{const i=n.tryGetData(b.Z),s={view_mode:t.toMode};i&&(s.interaction_source=i.source,s.interaction_mode=i.mode),e.track("mode_changed",s)}}]}}var C=n(69098),N=n(32548),D=n(4117);class SweepFloorOverrideMessage extends D.v{constructor(e,t,n){super(),this.sweep=e,this.from=t,this.to=n}}var I=n(39823);const L=(e,t)=>{const n=t.tryGetData(I.i);if(!e||!n)return-1;return n.getFloor(e).index};class FloorChangeAnalytics{constructor(){this.handlers=[{msgType:N.P,func:(e,t,n)=>{const i=n.tryGetData(b.Z);e.track("floor_changed",{floor_id:t.floorName,interaction_source:i?i.source:b.Z.defaultSource,interaction_mode:i?i.mode:b.Z.defaultMode})}},{msgType:SweepFloorOverrideMessage,func:(e,t,n)=>{const i=n.tryGetData(b.Z);e.track("sweep_floor_fixup",{sweep_index:t.sweep.index,sweep_alignment:t.sweep.alignmentType,sweep_placement:t.sweep.placementType,sweep_floor_from:L(t.from,n),sweep_floor_to:L(t.to,n),interaction_source:i?i.source:b.Z.defaultSource,interaction_mode:i?i.mode:b.Z.defaultMode})}}]}}var P=n(49665),R=n(53549);class ZoomAnalytics{constructor(){this.firstZoom=!0,this.fromZoom=1,this.toZoom=1,this.handlers=[{msgType:P.Z,func:(e,t,n)=>{this.analytics||(this.analytics=e);const i=n.tryGetData(R.Z);i&&i.currentSweep!==this.currentPano&&(this.firstZoom=!0,this.currentPano=i.currentSweep,this.fromZoom=1),this.toZoom=t.zoomLevel,clearTimeout(this.sendTimeout),this.sendTimeout=window.setTimeout(this.trackZoomEvent.bind(this),150)}}]}trackZoomEvent(){const e=this.firstZoom?"initial":"followup";this.analytics.track("zoom_"+e,{from:this.fromZoom,to:this.toZoom,pano:this.currentPano}),this.firstZoom=!1,this.fromZoom=this.toZoom}}var k=n(41907),U=n(9986),B=n(35424);class TimingData extends B.V{constructor(){super(...arguments),this.name="timing",this.modelLoadingStartTime=0,this.waitingStartTime=0,this.appPlayingTime=0,this.appStartedTime=0}get totalTimeToAppStarting(){let e=this.appStartedTime-performance.timing.navigationStart;return this.modelLoadingStartTime&&this.waitingStartTime&&(e-=this.modelLoadingStartTime-this.waitingStartTime),e}get totalTimeToAppPlaying(){let e=this.appPlayingTime-performance.timing.navigationStart;return this.modelLoadingStartTime&&this.waitingStartTime&&(e-=this.modelLoadingStartTime-this.waitingStartTime),e}}var F=n(5477),V=n(8428),H=n(96557);const j=new F.Z("showcase-session"),G=new TimingData;class ShowcaseSessionAnalytics{constructor(e,t){this.analytics=e,this.engine=t,this.handlers=[{msgType:k.LZ,func:async(e,t,n)=>{var i,r;switch(t.phase){case U.nh.WAITING:G.waitingStartTime=Date.now(),G.commit(),e.track("impression",{url_params:d.UD(),visible:!0});break;case U.nh.LOADING:G.modelLoadingStartTime=Date.now(),G.commit();break;case U.nh.STARTING:{G.appStartedTime=Date.now(),G.commit(),j.info("First render, model loaded "+G.totalTimeToAppStarting/1e3);const t=this.engine.market.tryGetData(V.af);this.renderer=await this.engine.getModuleBySymbol(s.y.WEBGL_RENDERER);const n=this.renderer.getCapabilities(),i={has_hlr:!t||t.options.highlight_reel,duration:Date.now()-G.modelLoadingStartTime,duration_from_navigation_start:Date.now()-performance.timing.navigationStart,gl_v2:n.gl_v2,gl_max_textures:n.gl_max_textures,gl_max_texture_size:n.gl_max_texture_size,gl_max_cubemap_size:n.gl_max_cubemap_size,gl_instancing:n.gl_instancing,gl_oes_texture_float:n.gl_oes_texture_float,gl_oes_texture_half_float:n.gl_oes_texture_half_float,gl_depth_texture:n.gl_depth_texture,gl_draw_buffers:n.gl_draw_buffers,gl_oes_fbo_render_mip_map:n.gl_oes_fbo_render_mip_map,gl_shader_texture_lod:n.gl_shader_texture_lod,gl_oes_vertex_array_obj:n.gl_oes_vertex_array_obj,gl_ovr_multi_view:n.gl_ovr_multi_view,gl_color_buffer_float:n.gl_color_buffer_float,gl_astc_supported:n.gl_astc_supported,gl_etc1_supported:n.gl_etc1_supported,gl_etc2_supported:n.gl_etc2_supported,gl_dxt_supported:n.gl_dxt_supported,gl_bptc_supported:n.gl_bptc_supported,gl_pvrtc_supported:n.gl_pvrtc_supported};e.track("model_loaded",i);break}case U.nh.PLAYING:G.appPlayingTime=Date.now(),G.commit(),j.info("Playing, session started "+G.totalTimeToAppPlaying/1e3),e.track("session_started"),window.addEventListener("unload",this.sessionEnded),e.track("load_times",{time_to_app_start:G.totalTimeToAppStarting,time_to_app_playing:G.totalTimeToAppPlaying});break;case U.nh.ERROR:{const t=await n.waitForData(U.pu),{error:s}=t,o=s&&s.name?s.name:s&&s.constructor?s.constructor.name:null,a=s?s.message:null,l=s&&s.stack?s.stack.split("\n"):[],c=l.length>=2?l[1].match(/\s+at\s+([^\s]+)/):null,d=(0,H.zg)(s),h=!!(0,u.eY)("oops",""),p=null!==(r=null===(i=this.renderer)||void 0===i?void 0:i.estimatedGPUMemoryAllocated())&&void 0!==r?r:-1,m={error_dialog:"oops",error_type:o||"",exception:{message:`${o}: ${a}`,function:c?c[1]:null,stack:l.slice(1,5).join("\n")},duration:G.modelLoadingStartTime>0?Date.now()-G.modelLoadingStartTime:void 0,duration_from_navigation_start:Date.now()-performance.timing.navigationStart,gpu_memory:p<0?void 0:p,mock_error:h};d&&(m.error_code=d),e.track("error_displayed",m);break}}}}],this.sessionEnded=()=>{this.analytics.trackAsync("session_ended",{duration:Date.now()-G.appPlayingTime})}}dispose(){window.removeEventListener("unload",this.sessionEnded)}}var z=n(92214),W=n(81402),K=n(31117),Y=n(22878),q=n(37363),Z=n(62029);const $=new F.Z("/index.js");let Q,X=0,J=1/0,ee=null,te=null,ne=window.devicePixelRatio||1;const ie={},se=new K.P(1e3),re=new K.P(1e3);class RenderingPerformanceAnalytics{constructor(e){this.engine=e,this.handlers=[{msgType:z.Z,func:(e,t,n)=>{te!==U.nh.STARTING&&te!==U.nh.PLAYING||oe(e,Y.Ey[t.toMode],1e4)}},{msgType:k.LZ,func:async(e,t,n)=>{const i=n.tryGetData(q.O);t.phase===U.nh.LOADING?oe(e,"Loading",6e4):t.phase===U.nh.STARTING?(Q=await this.engine.getModuleBySymbol(s.y.WEBGL_RENDERER),oe(e,"Starting",6e4)):t.phase===U.nh.PLAYING&&i&&i.currentMode&&oe(e,Y.Ey[i.currentMode],1e4),te=t.phase}},{msgType:Z.Vx,func:(e,t,n)=>{ne=t.pixelRatio}}]}}function oe(e,t,n){t!==ee&&(ee&&(le(e),ae()),ie[t]||(ee=t,J=n,ie[ee]=!0))}const ae=()=>{ee=null,se.clear(),re.clear(),X=0},le=e=>{const t=se.getList(),n=re.getList();if(0!==t.length)try{const i=ce(t,n);e.track("performance",i)}catch(e){$.warn("Could not send performance metrics",e)}},ce=(e,t)=>{let n=0,i=0,s=0,r=0,o=0,a=0;for(const t of e)n+=t,t<0||(t<=16.7?i+=t:t<=33.3?s+=t:t<=100?r+=t:t<=1e3?o+=t:a+=t);if(n<=0)throw Error("No positive timings, cannot calculate performance data");const l=n/e.length;i/=n,s/=n,r/=n,o/=n,a/=n;let c=e.slice();const d=(0,W.Pe)(c,50),u=(0,W.Pe)(c,95,!1),h=c[c.length-1];let p,m,f,g,v;return t.length&&(c=t.slice(),g=(0,W.Pe)(c,50,!0),v=(0,W.Pe)(c,95,!1),f=Math.round((0,W.Y8)(t)),p=c[0],m=c[c.length-1]),{phase:ee,frame_delta:l,frame_delta_avg:l,frame_delta_median:d,frame_delta_95th:u,frame_delta_max:h,duration:n,time_60_fps:i,time_60_30_fps:s,time_30_10_fps:r,time_10_1_fps:o,time_1_0_fps:a,gpu_memory_min:p,gpu_memory_max:m,gpu_memory_avg:f,gpu_memory_median:g,gpu_memory_95th:v,pixel_ratio:ne}};var de=n(61903),ue=n(24133),he=n(56044);const pe=(e,t)=>{const n=t.tryGetData(he.c);if(!n)return-1;return(e?n.floors.getFloor(e):n.getHighestVisibleFloor()).index};class MeasurementAnalytics{constructor(){this.handlers=[{msgType:ue.rf,func:(e,t,n)=>{const i={measure_sid:t.data.sid,start_position:t.data.startPosition,end_position:t.data.endPosition,length:t.data.totalLength,segments:t.data.segments,temporary:t.data.temporary,viewmode:t.data.viewmode,floor:pe(t.data.floorId,n),feature_type:t.data.featureType,constraint_style:t.data.constraint,continuous:t.data.continuous};e.track("measure_segment_add",i)}},{msgType:ue.u6,func:(e,t,n)=>{const i={measure_sid:t.data.sid,length:t.data.totalLength,segments:t.data.segments,temporary:t.data.temporary,viewmode:t.data.viewmode,floor:pe(t.data.floorId,n),feature_type:t.data.featureType,measure_type:t.data.type,constraint_style:t.data.constraint,continuous:t.data.continuous};e.track("measure_add",i)}},{msgType:ue.ty,func:(e,t)=>{const n={measure_sid:t.sid,measure_text:t.text};e.track("measure_add_title",n)}},{msgType:ue.mM,func:(e,t)=>{const n={measure_sid:t.sid,measure_old_text:t.oldText,measure_new_text:t.newText};e.track("measure_update_title",n)}},{msgType:ue.$Z,func:(e,t,n)=>{const i={measure_sid:t.data.sid,length:t.data.totalLength,segments:t.data.segments,temporary:t.data.temporary,viewmode:t.data.viewmode,floor:pe(t.data.floorId,n),measure_count:t.data.count,continuous:t.data.continuous};e.track("measure_remove",i)}},{msgType:ue.av,func:(e,t,n)=>{const i={measure_sid:t.data.sid,length:t.data.totalLength,segments:t.data.segments,temporary:t.data.temporary,viewmode:t.data.viewmode,floor:pe(t.data.floorId,n),feature_type:t.data.featureType,constraint_style:t.data.constraint,continuous:t.data.continuous};e.track("measure_update",i)}},{msgType:ue.$n,func:(e,t)=>{const n=t.opened?"measure_mode_enter":"measure_mode_exit",i={viewmode:t.viewmode,measure_count:t.count};e.track(n,i)}},{msgType:ue.ff,func:(e,t)=>{e.track("measure_cancelled",{})}}]}}var me=n(39142),fe=n(58575);class ActivityAnalytics{constructor(){this.handlers=[{msgType:fe.i,func:(e,t)=>{const n={duration_dollhouse:t.durationDollhouse,duration_floorplan:t.durationFloorplan,duration_inside:t.durationInside,duration:t.durationDollhouse+t.durationFloorplan+t.durationInside,main_mode:t.mainMode,bytes_downloaded:t.totalBytesDownloaded,tiles_downloaded:t.tilesDownloaded};e.track("activity_ping",n)}}]}}var ge,ve=n(3035),ye=n(76922),be=n(94113),Se=n(70399),Ee=n(69054),Te=n(12622),we=n(41403);!function(e){e.UNINITIALIZED="uninitialized",e.INACTIVE="inactive",e.ACTIVE="active"}(ge||(ge={}));class ShowcaseActivityTracking{constructor(){this.name="activity-analytics",this._state=ge.UNINITIALIZED,this.activeModeMap=new Map,this.totalTilesDownloaded=0,this.onTileDownloaded=()=>{this.totalTilesDownloaded++}}async init(e,t,n){this.engine=e,this.requestQueue=n,[this.input,this.viewmodeData,this.applicationData]=await Promise.all([await e.getModuleBySymbol(s.y.INPUT),await e.market.waitForData(q.O),await e.market.waitForData(U.pu)]);const i=[],r=[ve.R,ye._t,be.e,Se.er,Ee.G],o=()=>this.active=!0;this.applicationData.phase===U.nh.PLAYING?this._state=ge.INACTIVE:i.push(e.subscribe(k.LZ,(()=>{this.applicationData.phase===U.nh.PLAYING&&(this._state=ge.INACTIVE)}))),i.push(...(()=>{const e=[];return r.forEach((t=>{e.push(this.input.registerUnfilteredHandler(t,o))})),e})()),i.push(e.subscribe(A.Z,(e=>{const t=e.fromMode,n=e.toMode;t&&t!==Y.Ey.Transition&&this.applicationData.phase===U.nh.PLAYING&&this.handleModeChange(t,n)}))),i.push(this.engine.subscribe(we.o,this.onTileDownloaded)),t(i)}get active(){return this._state===ge.ACTIVE}set active(e){this._state!==ge.UNINITIALIZED&&(e&&this._state===ge.INACTIVE&&this.startActivityTimeout(),this._state=e?ge.ACTIVE:ge.INACTIVE)}handleModeChange(e,t){this.activeModeMap.has(t)?this.updateActivityTimeForMode(t,!0):this.activeModeMap.set(t,{previousTime:Date.now(),totalTimeinMS:0}),this.updateActivityTimeForMode(e)}updateActivityTimeForMode(e,t){const n=this.activeModeMap.get(e);if(void 0===n)return;const{previousTime:i,totalTimeinMS:s}=n;t?this.activeModeMap.set(e,{previousTime:Date.now(),totalTimeinMS:s}):this.activeModeMap.set(e,{previousTime:Date.now(),totalTimeinMS:s+(Date.now()-i)})}startActivityTimeout(){this.activeModeMap.set(Y.Ey.Dollhouse,{previousTime:Date.now(),totalTimeinMS:0}),this.activeModeMap.set(Y.Ey.Floorplan,{previousTime:Date.now(),totalTimeinMS:0}),this.activeModeMap.set(Y.Ey.Panorama,{previousTime:Date.now(),totalTimeinMS:0}),window.setTimeout(this.notifyActivityAnalytic.bind(this),ShowcaseActivityTracking.ACTIVITY_INTERVAL)}notifyActivityAnalytic(){if(this.viewmodeData.currentMode&&this.viewmodeData.currentMode!==Y.Ey.Transition&&this.updateActivityTimeForMode(this.viewmodeData.currentMode),this.active){let e=0,t=Y.Ey.Panorama;this.activeModeMap.forEach(((n,i)=>{n.totalTimeinMS>e&&(t=i,e=n.totalTimeinMS)})),this.active=!1;const[n,i,s]=[this.activeModeMap.get(Y.Ey.Dollhouse),this.activeModeMap.get(Y.Ey.Floorplan),this.activeModeMap.get(Y.Ey.Panorama)].map((e=>e?e.totalTimeinMS:0));this.engine.broadcast(new fe.i(n,i,s,Te.KP[t],this.requestQueue.totalBytesDownloaded,this.totalTilesDownloaded))}}}ShowcaseActivityTracking.ACTIVITY_INTERVAL=15e3;var xe,_e=n(38182);!function(e){e.USER="self-guided",e.TOUR="tour"}(xe||(xe={}));class RoomDataAnalytics{constructor(){this.handlers=[{msgType:_e.D,func:(e,t,n)=>{const i=n.tryGetData(b.Z),s=n.tryGetData(_.k),r={room_id:t.roomId,room_index:t.meshSubgroup,room_type:t.roomType,viewmode:t.viewmode?Te.KP[t.viewmode]:t.viewmode,room_visit_count:t.visitCount,room_count:t.roomCount,navigation_source:s&&s.tourPlaying?xe.TOUR:xe.USER,interaction_source:i?i.source:b.Z.defaultSource,interaction_mode:i?i.mode:b.Z.defaultMode};e.track("room_visited",r)}}]}}var Me=n(98142);class ShowcaseLabelAnalytics{constructor(){this.handlers=[{msgType:Me.V,func:(e,t,n)=>{e.track("internal_warning",{warningType:"rtl_disabled_roomnav"})}}]}}var Oe=n(19582);const Ae=e=>e.sort(((e,t)=>e.localeCompare(t)));class ModelRatingAnalytics{constructor(){this.handlers=[{msgType:Oe.E,func:(e,t)=>{const{happiness:n,quality:i,navigation:s,feedback:r}=t.rating,o={};n&&(o.happiness=+n),(s&&s.length>0||i&&i.length>0)&&(o.issue_types=function(e=[],t=[]){const n=[];return Ae(t).forEach((e=>n.push(`navigation-${e.trim()}`))),Ae(e).forEach((e=>n.push(`quality-${e.trim()}`))),n.join(",")}(i||[],s||[])),r&&r.length>0&&(o.feedback=r),Object.keys(o).length>0&&e.track("model_rated",o)}}]}}class ShowcaseAnalytics extends i.Y{constructor(){super(...arguments),this.name="showcase-analytics",this.loaded=!1,this.handlers=[],this.track=(e,t)=>{this.analytics.track(e,t)}}async init(e,t){this.analytics=await t.getModuleBySymbol(s.y.ANALYTICS),this.apiClient=(await t.getModule(r.default)).getApi();const n=await t.market.waitForData(de.e),i=await t.getModule(me.default);this.addMessageHandlers(this.analytics,t),this.context=function(e,t,n){const i=g(t,n);return(0,c.Z)(e).then((e=>{i.location={city:e.city,country:e.country_name,region:e.region}})),i}(e.apiQueue,i.languageCode,e.appName),this.options=Object.assign({mds_enabled:!0},{model_id:(0,u.eY)("model")||(0,u.eY)("m")||"",start_source:(0,u.eY)("play",!1)?"autoplay":d.yL()?"click":"fullpage",autoplay:(0,u.eY)("play",!1)||!d.yL(),quickstart:1===(0,u.eY)("qust",0)||1===(0,u.eY)("qs",0),language_tag:(0,u.eY)("lang",null),is_mobile:d.tq(),iframe:d.yL(),aspect_ratio:d.dy(),session_id:(0,h.D)(),window:{height:window.innerHeight,width:window.innerWidth},platform:f()}),this.activityTracking=new ShowcaseActivityTracking,this.activityTracking.init(t,this.registerBindings.bind(this),e.apiQueue);const o=await this.createAnalyticsConfigs(e,n);this.analytics.load(o,e.analyticsQueue,this.options,this.context,this.apiClient.user).then((()=>{this.loaded=!0}))}addMessageHandlers(e,t){this.addMessageHandler(new ShowcaseSessionAnalytics(e,t),t),this.addMessageHandler(new ViewmodeAnalytics,t),this.addMessageHandler(new CameraDataAnalytics,t),this.addMessageHandler(new InteractionmodeAnalytics,t),this.addMessageHandler(new FloorChangeAnalytics,t),this.addMessageHandler(new C.s,t),this.addMessageHandler(new ZoomAnalytics,t),this.addMessageHandler(new MeasurementAnalytics,t),this.addMessageHandler(new RenderingPerformanceAnalytics(t),t),this.addMessageHandler(new ActivityAnalytics,t),this.addMessageHandler(new RoomDataAnalytics,t),this.addMessageHandler(new ShowcaseLabelAnalytics,t),this.addMessageHandler(new ModelRatingAnalytics,t),this.addMessageHandler(new AnnotationAnalytics,t)}addMessageHandler(e,t){this.handlers.push(e),e.handlers.forEach(((e,n)=>{this.bindings.push(t.subscribe(e.msgType,(n=>{e.func(this.analytics,n,t.market)})))}))}registerBindings(e){this.bindings.push(...e)}async createAnalyticsConfig(e,t){if(((e,t)=>{const n=Object.keys(e);for(const i of n)if(e[i]===t)return!0;return!1})(a.K,e)){const{apiClient:n}=this,i=o.H[e],s=null!==i.key?await n.getAppKey(t,i.key):null,r=null!==i.url?await n.getAppKey(t,i.url):null;if(null===i.key||null!==s&&null===i.url||null!==r)return{provider:e,token:s,url:r}}return null}async createAnalyticsConfigs(e,t){const n=e.appName,i=void 0!==e.provider?e.provider:await this.apiClient.getAppKey(n,"analytics_provider"),s=[];if(!i)return s;const r=i.split(",");for(const e of r){const t=await this.createAnalyticsConfig(e,n);null!==t?s.push(t):this.log.warn(`Failed to set up ${e}, token/url required but not found in config`)}return s.length<1&&s.push({provider:v,token:null,url:null}),s}onUpdate(e){this.loaded&&((e,t)=>{var n;if(!ee)return;se.push(t);const i=null!==(n=null==Q?void 0:Q.estimatedGPUMemoryAllocated())&&void 0!==n?n:-1;i>-1&&re.push(i),X+=t,X>=J&&(le(e),ae())})(this.analytics,e)}dispose(e){super.dispose(e);for(const e of this.handlers)e.dispose&&e.dispose();this.handlers=[]}getSessionId(){return this.options.session_id||""}trackGuiEvent(e,t={}){const{tool:n,interactionSource:i,panoId:s}=t,r={gui_action:e};n&&Object.assign(r,{tool:n}),i&&Object.assign(r,{interaction_source:i}),s&&Object.assign(r,{pano_id:s}),this.track("showcase_gui",r)}trackToolGuiEvent(e,t,n={}){this.trackGuiEvent(t,Object.assign({tool:e},n))}}},58575:(e,t,n)=>{"use strict";n.d(t,{i:()=>ActivityPingMessage});var i=n(4117);class ActivityPingMessage extends i.v{constructor(e,t,n,i,s,r){super(),this.durationDollhouse=e,this.durationFloorplan=t,this.durationInside=n,this.mainMode=i,this.totalBytesDownloaded=s,this.tilesDownloaded=r}}},68860:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcaseHotkeys});var i=n(14877),s=n(94113),r=n(43985),o=n(12622),a=n(57227),l=n(19926),c=n(37363),d=n(22878),u=n(61903),h=n(56483),p=n(15099);class ShowcaseHotkeys extends a.Y{constructor(){super(...arguments),this.name="showcase-hotkeys",this.inputCommandMap={[l.M.PRESSED]:{[r.R.ONE]:()=>(this.viewmodeData.currentMode===d.Ey.Panorama&&(this.settings.setProperty(h.Lp,!1),this.currentView=0),this.switchToMode(o.BD.INSIDE)),[r.R.TWO]:()=>this.switchToMode(o.BD.DOLLHOUSE),[r.R.THREE]:()=>this.switchToMode(o.BD.FLOORPLAN),[r.R.ZERO]:()=>{const e=this.currentView++%this.meshViews.length;return this.meshViews[e]()}}},this.currentView=0,this.meshViews=[()=>(this.settings.setProperty(h.Lp,!1),this.switchToMode(o.BD.MESH)),()=>(this.settings.setProperty(h.Lp,!0),this.switchToMode(o.BD.MESH)),()=>(this.settings.setProperty(h.Lp,!0),this.switchToMode(o.BD.INSIDE)),()=>(this.settings.setProperty(h.Lp,!1),this.switchToMode(o.BD.INSIDE))]}async init(e,t){const n=await t.getModuleBySymbol(i.y.INPUT);[this.viewmodeData,this.settings,this.cameraData]=await Promise.all([t.market.waitForData(c.O),t.market.waitForData(u.e),t.market.waitForData(p.M_)]),this.issueCommand=t.commandBinder.issueCommand.bind(t.commandBinder),n.registerHandler(s.e,(async e=>{this.inputCommandMap[e.state]&&this.inputCommandMap[e.state][e.key]&&await this.inputCommandMap[e.state][e.key]()}))}async switchToMode(e){const{currentMode:t}=this.viewmodeData;if(t!==d.Ey.Transition){const n=(0,d.Bw)(t)&&(e===o.BD.MESH||e===o.BD.INSIDE)?this.cameraData.pose.rotation:void 0;await this.issueCommand(new o._i(e,void 0,{rotation:n}))}}}},22299:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcasePasswordModule});var i=n(67294),s=n(20745),r=n(57227),o=n(95430),a=n(93487),l=n(39142),c=n(85893),d=n(94184),u=n.n(d),h=n(10854),p=n(60405),m=n(90831);class PoweredBy extends i.Component{render(){const{attributionLinkText:e,attributionLinkUrl:t}=this.props,{locale:n}=this.context;return(0,c.jsxs)("div",Object.assign({className:"powered-by"},{children:[(0,c.jsx)("p",Object.assign({className:"powered-by-label"},{children:n.t(h.Z.POWERED_BY)})),(0,c.jsx)("img",{className:"powered-by-logo",alt:"Matterport",src:m,width:"150",height:"32"}),t&&(0,c.jsx)("a",Object.assign({href:t,className:"powered-by-link"},{children:e||t}))]}))}}PoweredBy.contextType=p.I;var f=n(5477),g=n(24877),v=n(40603);class InvalidPasswordException extends v.y{constructor(e="Invalid password"){super(e),this.name="InvalidPassword"}}class TooManyAttemptsException extends v.y{constructor(e="Too many attempts, please try again in a few minutes"){super(e),this.name="TooManyAttempts"}}const y=new f.Z("showcase-password");class ShowcasePasswordUi extends i.Component{constructor(e){super(e),this.isUnmounting=!1,this.onInputChange=e=>{const{name:t,value:n}=e.target;"password"===t&&this.setState({password:n,hasError:!1})},this.onSubmit=async e=>{e.preventDefault(),this.setState({formEnabled:!1}),await this.authenticate(),this.isUnmounting||this.setState({formEnabled:!0})},this.state={formEnabled:!0,hasError:!1,tooManyAttempts:!1,password:""}}componentWillUnmount(){this.isUnmounting=!0}async authenticate(){const{authenticate:e}=this.props,{password:t}=this.state;y.debug("Validating password input...");const n=await e(t).catch((e=>(e instanceof TooManyAttemptsException&&this.setState({hasError:!0,tooManyAttempts:!0}),!1)));this.isUnmounting||this.setState({hasError:!n})}stopPropagation(e){e.stopPropagation()}renderLockout(){const{locale:e}=this.context;return(0,c.jsxs)("div",Object.assign({className:"sc-password-modal sc-password-lockout"},{children:[(0,c.jsx)("header",Object.assign({className:"modal-header"},{children:(0,c.jsx)("h1",Object.assign({className:"modal-title"},{children:e.t(h.Z.SC_LOCKOUT_TITLE)}))})),(0,c.jsx)("p",Object.assign({className:"modal-body"},{children:e.t(h.Z.SC_LOCKOUT_MESSAGE)}))]}))}renderLoginForm(){const{hasError:e,password:t,formEnabled:n}=this.state,{locale:i}=this.context;return(0,c.jsxs)("div",Object.assign({className:"sc-password-modal sc-password-login"},{children:[(0,c.jsx)("header",Object.assign({className:"modal-header"},{children:(0,c.jsx)("h1",Object.assign({className:"modal-title"},{children:i.t(h.Z.SC_PASSWORD_TITLE)}))})),(0,c.jsxs)("div",Object.assign({className:"modal-body"},{children:[(0,c.jsxs)("form",Object.assign({onSubmit:this.onSubmit,className:"sc-password-form"},{children:[(0,c.jsx)("input",{type:"password",name:"password",placeholder:i.t(h.Z.SC_PASSWORD_PLACEHOLDER),onInput:this.onInputChange,onKeyDown:this.stopPropagation,onKeyPress:this.stopPropagation,onKeyUp:this.stopPropagation,disabled:!n,value:t,className:u()("sc-password-input",{error:e}),autoComplete:"on"}),(0,c.jsx)("button",Object.assign({type:"submit",disabled:!n,className:"sc-password-submit"},{children:i.t(h.Z.SC_PASSWORD_SUBMIT)}))]})),e&&(0,c.jsxs)("p",Object.assign({className:"help-text error"},{children:[(0,c.jsx)("span",{className:"icon icon-error"}),i.t(h.Z.SC_PASSWORD_INVALID)]})),!e&&(0,c.jsx)("p",{className:"help-text"})]}))]}))}render(){const{hasError:e,tooManyAttempts:t}=this.state,n=e&&t?this.renderLockout():this.renderLoginForm();return(0,c.jsxs)("div",Object.assign({className:"sc-password-ui",style:{backgroundImage:`url(${g})`}},{children:[(0,c.jsx)("div",Object.assign({className:"sc-password-content"},{children:n})),(0,c.jsx)("footer",Object.assign({className:"sc-password-footer"},{children:(0,c.jsx)(PoweredBy,{})}))]}))}}ShowcasePasswordUi.contextType=p.I;var b=n(81637),S=n(29991);class ShowcasePasswordModule extends r.Y{constructor(){super(...arguments),this.name="showcase-password",this.authenticated=!1}async init(e,t){this.config=e,this.engine=t;const n=e.baseUrl||window.location.origin;this.auth=new o.L(n)}showPasswordScreen(){this.loadUi()}hidePasswordScreen(){this.unloadUi()}async loadUi(){const{container:e}=this.config,t=await this.engine.getModule(l.default),n=Object.assign(Object.assign({},S.O),{locale:t});this.reactContainer=document.createElement("div"),this.reactContainer.id="showcase-password-container",e.appendChild(this.reactContainer),this.reactRoot=(0,s.s)(this.reactContainer),this.reactRoot.render((0,i.createElement)(p.I.Provider,{value:n},[(0,i.createElement)(ShowcasePasswordUi,{key:"showcase-password",authenticate:e=>this.authenticate(e)})]))}async unloadUi(){var e;return!!this.reactRoot&&(this.reactRoot.unmount(),null===(e=this.reactContainer)||void 0===e||e.remove(),delete this.reactContainer,!0)}async authenticate(e){const{modelId:t}=this.config;if(!await this.auth.authenticate(t,e)){switch(this.engine.broadcast(new b.s(this.auth.errorType)),this.auth.errorType){case a.s.INVALID_CREDENTIALS:throw new InvalidPasswordException;case a.s.TOO_MANY_ATTEMPTS:throw new TooManyAttemptsException}return!1}return this.log.debug("Password authentication was successful"),this.engine.broadcast(new b.L),!0}}},81637:(e,t,n)=>{"use strict";n.d(t,{L:()=>PasswordAuthenticationSuccess,s:()=>PasswordAuthenticationFail});var i=n(4117);class PasswordAuthenticationSuccess extends i.v{}class PasswordAuthenticationFail extends i.v{constructor(e){super(),this.errorType=e}}},645:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcaseSettings});var i,s,r,o=n(57227),a=n(14877),l=n(61903),c=n(8428),d=n(11620),u=n(14832),h=n(66225),p=n(5477),m=n(49991);!function(e){e.BLACK="black",e.GREY="grey",e.WHITE="white"}(i||(i={})),function(e){e.DISABLED="disabled",e.MEASURE="measure",e.MEASURE_AND_VIEW="measureAndView"}(s||(s={})),function(e){e.metric="metric",e.imperial="imperial"}(r||(r={}));var f=n(93510),g=n(84347),v=n(95655);const y=new p.Z("mds-player-options-deserializer"),b={[m.Y.LEFT]:g.kw.Left,[m.Y.RIGHT]:g.kw.Right,[m.Y.AUTO]:g.kw.Auto},S={[i.BLACK]:v.z.black,[i.GREY]:v.z.grey,[i.WHITE]:v.z.white};class MdsPlayerOptionsDeserializer{deserialize(e){if(!e||!this.validate(e))return y.debug("Deserialized invalid options data from MDS",e),null;const t=(e.publication||{}).options||{},n=e.options,i=b[n.tourPanDirection],o={address:t.address,contact_email:t.contactEmail,contact_name:t.contactName,contact_phone:t.contactPhone,dollhouse:n.dollhouseEnabled,external_url:t.externalUrl,floor_plan:n.floorplanEnabled,floor_select:n.floorSelectEnabled,highlight_reel:n.highlightReelEnabled,labels:n.labelsEnabled,labels_dh:n.dollhouseLabelsEnabled,model_name:t.modelName,model_summary:t.modelSummary,presented_by:t.presentedBy,measurements:n.measurements!==s.DISABLED,measurements_saved:n.measurements===s.MEASURE_AND_VIEW,unit_type:n.unitType===r.imperial?f.M.IMPERIAL:f.M.METRIC,background_color:S[n.backgroundColor],tour_buttons:n.tourButtonsEnabled,fast_transitions:n.tourFastTransitionsEnabled,transition_speed:n.tourTransitionSpeed,transition_time:n.tourTransitionTime,pan_speed:n.tourPanSpeed,dollhouse_pan_speed:n.tourDollhousePanSpeed,zoom_duration:n.tourZoomDuration,pan_angle:n.tourPanAngle,pan_direction:i,space_search:n.spaceSearchEnabled};return new c.af(o)}validate(e){return["id","options","publication"].every((t=>t in e))}}var E;!function(e){e.ENABLED="enabled",e.DISABLED="disabled",e.DEFAULT="default"}(E||(E={}));var T=n(73957);const w=(0,T.S)(b),x=(0,T.S)(S);class MdsPlayerOptionsSerializer{serialize(e){const t={},n=e.options||{};if(void 0!==n.dollhouse&&(t.dollhouseOverride=n.dollhouse?E.ENABLED:E.DISABLED),void 0!==n.floor_plan&&(t.floorplanOverride=n.floor_plan?E.ENABLED:E.DISABLED),void 0!==n.floor_select&&(t.floorSelectOverride=n.floor_select?E.ENABLED:E.DISABLED),void 0!==n.space_search&&(t.spaceSearchOverride=n.space_search?E.ENABLED:E.DISABLED),void 0!==n.labels&&(t.labelsOverride=n.labels?E.ENABLED:E.DISABLED),void 0!==n.labels_dh&&(t.dollhouseLabelsOverride=n.labels_dh?E.ENABLED:E.DISABLED),void 0!==n.highlight_reel&&(t.highlightReelOverride=n.highlight_reel?E.ENABLED:E.DISABLED),void 0!==n.background_color&&(t.backgroundColor={set:x[n.background_color]||i.BLACK}),void 0!==n.unit_type){const e=n.unit_type===f.M.METRIC?r.metric:r.imperial;t.unitType={set:e}}if(void 0!==n.measurements||void 0!==n.measurements_saved){const e=n.measurements&&n.measurements_saved?s.MEASURE_AND_VIEW:n.measurements?s.MEASURE:s.DISABLED;t.measurements={set:e}}void 0!==n.tour_buttons&&(t.tourButtonsOverride=n.tour_buttons?E.ENABLED:E.DISABLED),void 0!==n.fast_transitions&&(t.tourFastTransitionsOverride=n.fast_transitions?E.ENABLED:E.DISABLED),void 0!==n.pan_angle&&(t.tourPanAngle={set:n.pan_angle}),void 0!==n.pan_direction&&(t.tourPanDirection={set:w[n.pan_direction]}),void 0!==n.pan_speed&&(t.tourPanSpeed={set:n.pan_speed}),void 0!==n.transition_speed&&(t.tourTransitionSpeed={set:n.transition_speed}),void 0!==n.transition_time&&(t.tourTransitionTime={set:n.transition_time}),void 0!==n.zoom_duration&&(t.tourZoomDuration={set:n.zoom_duration}),void 0!==n.dollhouse_pan_speed&&(t.tourDollhousePanSpeed={set:n.dollhouse_pan_speed});const o={};return void 0!==n.presented_by&&(o.presentedByOverride=n.presented_by?E.ENABLED:E.DISABLED),void 0!==n.contact_email&&(o.contactEmailOverride=n.contact_email?E.ENABLED:E.DISABLED),void 0!==n.contact_name&&(o.contactNameOverride=n.contact_name?E.ENABLED:E.DISABLED),void 0!==n.contact_phone&&(o.contactPhoneOverride=n.contact_phone?E.ENABLED:E.DISABLED),void 0!==n.external_url&&(o.externalUrlOverride=n.external_url?E.ENABLED:E.DISABLED),void 0!==n.model_name&&(o.modelNameOverride=n.model_name?E.ENABLED:E.DISABLED),void 0!==n.model_summary&&(o.modelSummaryOverride=n.model_summary?E.ENABLED:E.DISABLED),void 0!==n.address&&(o.addressOverride=n.address?E.ENABLED:E.DISABLED),{options:t,publication:{options:o}}}}var _=n(91985);const M=new p.Z("mds-player-options-store");class MdsPlayerOptionsStore extends h.u{constructor(){super(...arguments),this.serializer=new MdsPlayerOptionsSerializer,this.deserializer=new MdsPlayerOptionsDeserializer,this.prefetchKey="data.model.publication.options"}async read(e={}){const t={modelId:this.getViewId()};return this.query(_.GetModelOptions,t,e).then((e=>{var t;return this.deserializer.deserialize(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)}))}async update(e){const t=this.getViewId(),n=this.serializer.serialize(e);if(0===Object.keys(n).length)throw new Error("No data to update?");return this.mutate(_.PatchModel,{modelId:t,patch:n}).then((e=>{M.debug(e)}))}}var O=n(65834),A=n(18537),C=n(52549),N=n(7819),D=n(48697),I=n(47063);class ShowcaseSettings extends o.Y{constructor(){super(...arguments),this.name="showcase-settings",this.updateTransitionType=(e,t,n)=>{const i=e.options.fast_transitions?u.n.FadeToBlack:u.n.Interpolate;t.hasProperty(d.gj)?t.setProperty(d.gj,i):n.registerSetting("player_options",d.gj,i)}}async init(e,t){const{readonly:n,baseUrl:i}=e;this.engine=t,this.store=new MdsPlayerOptionsStore({readonly:n,baseUrl:i});const[s,r,o,d]=await Promise.all([t.getModuleBySymbol(a.y.SETTINGS),t.market.waitForData(l.e),t.getModule(N.F),this.store.read()]);this.playerOptionsData=d||new c.af,t.market.register(this,c.af,this.playerOptionsData);for(const e in c.gx){const t=c.gx[e],n=this.playerOptionsData.options[t];if(s.hasProperty(t)){const e=s.getProperty(t);s.updateSetting(t,n&&e),this.log.debug(`Updated player_options setting ${t} = ${n&&e}`)}else s.registerSetting("player_options",t,n),this.log.debug(`Registered player_options setting ${t} = ${n}`)}if(this.updateTransitionType(this.playerOptionsData,r,s),this.bindings.push(r.onPropertyChanged(c.gx.InstantTransitions,(()=>this.updateTransitionType(this.playerOptionsData,r,s)))),!n){this.bindings.push(o.onSave((()=>this.save()),{dataType:C.g.SETTINGS}));const e=await t.market.waitForData(D.Q);e.setRevertableType(C.g.SETTINGS),e.setPublishableType(C.g.SETTINGS),this.monitor=new O.u(this.playerOptionsData,{aggregationType:A.E.NextFrame},this.engine),this.monitor.onChanged((()=>this.engine.commandBinder.issueCommand(new I.VQ({dataTypes:[C.g.SETTINGS]}))))}}async save(){if(!this.store||!this.monitor)return void this.log.warn("Settings changes will NOT be saved");const e=this.monitor.getDiffRecord(),t=e.options;return t&&(t&&void 0===t.measurements&&void 0!==t.measurements_saved&&(t.measurements=this.playerOptionsData.options.measurements),t&&void 0!==t.measurements&&void 0===t.measurements_saved&&(t.measurements_saved=this.playerOptionsData.options.measurements_saved),void 0!==(null==t?void 0:t.floor_select)&&(t.floor_select=this.playerOptionsData.options.floor_select),void 0!==(null==t?void 0:t.labels_dh)&&(t.labels_dh=this.playerOptionsData.options.labels_dh),void 0===t.presented_by&&void 0===t.contact_email&&void 0===t.contact_name&&void 0===t.contact_phone&&void 0===t.external_url&&void 0===t.model_name&&void 0===t.model_summary&&void 0===t.address||(t.presented_by=this.playerOptionsData.options.presented_by,t.contact_email=this.playerOptionsData.options.contact_email,t.contact_name=this.playerOptionsData.options.contact_name,t.contact_phone=this.playerOptionsData.options.contact_phone,t.external_url=this.playerOptionsData.options.external_url,t.model_name=this.playerOptionsData.options.model_name,t.model_summary=this.playerOptionsData.options.model_summary,t.address=this.playerOptionsData.options.address)),this.monitor.clearDiffRecord(),this.store.update(e)}}},76482:(e,t,n)=>{"use strict";n.d(t,{b:()=>FlyInCommand});var i=n(93037);class FlyInCommand extends i.m{constructor(e){super(),this.payload={pose:e}}}},94139:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcaseStart});var i=n(2212),s=n(57227),r=n(14877),o=n(53549),a=n(22878),l=n(98370),c=n(14832),d=n(94772),u=n(81402),h=n(61903),p=n(2153),m=n(76482),f=n(8428),g=n(63387),v=n(31998),y=n(31013),b=n(37632),S=n(645),E=n(56829),T=n(94293);class ShowcaseStart extends s.Y{constructor(){super(...arguments),this.name="showcase-start",this.firstRenderPromise=new y.Q,this.flyInPromise=new y.Q,this.handleFlyIn=(e,t,n)=>(this.renderer.startRender(!1),this.doStandardStart(e,t,n,!0).catch((()=>this.renderer.startRender(!0))))}async init(e,t){const[n,i]=await Promise.all([t.market.waitForData(h.e),t.getModule(p.default)]);[this.sweepData,this.sweepModule,this.cameraModule,this.renderer]=await Promise.all([t.market.waitForData(o.Z),t.getModule(v.default),t.getModuleBySymbol(r.y.CAMERA),t.getModuleBySymbol(r.y.WEBGL_RENDERER)]);const s=n.tryGetProperty("quickstart",!1),a=i.getStartingPose();return(s?this.doQuickStart(a,t):this.doStandardStart(a,t,n,!1)).then((()=>this.flyInPromise.resolve())),this.bindings.push(t.commandBinder.addBinding(m.b,(async e=>{this.handleFlyIn(e.pose||i.getStartingPose(),t,n)}))),this.waitForFirstRender}get waitForFirstRender(){return this.firstRenderPromise.nativePromise()}get waitForFlyin(){return this.flyInPromise.nativePromise()}async doQuickStart(e,t){const n=this.sweepData.getStartSweep(e),i=n&&n.id,s=await t.getModule(l.default);return await s.switchToMode(e.mode,c.n.Instant,{sweepID:i,position:e.camera.position||n&&n.position,rotation:e.camera.rotation,zoom:-1!==e.camera.zoom?e.camera.zoom:void 0}),t.broadcast(new E.bN(!1)),e.mode!==a.Ey.Dollhouse&&e.mode!==a.Ey.Floorplan||e.floorVisibility&&await t.commandBinder.issueCommandWhenBound(new b.h9(e.floorVisibility.lastIndexOf(1),!0,0)),this.renderBeforeStarting(t)}async doStandardStart(e,t,n,s){var o;const[d]=await Promise.all([t.getModule(l.default)]);await t.getModule(S.default);const h=n.checkUrlParam("dh",0,1)||!n.tryGetProperty(f.gx.Dollhouse,!0),p=n.checkUrlParam("fp",0,1)||!n.tryGetProperty(f.gx.FloorPlan,!0);e&&(e.mode===a.Ey.Dollhouse&&h||e.mode===a.Ey.Floorplan&&p||e.mode===a.Ey.Panorama&&!e.pano)&&(e=null);const m=!e||e&&(e.mode===a.Ey.Dollhouse||e.mode===a.Ey.Floorplan),v=!e||e&&!this.is360Pano(e)&&(0,a.Bw)(e.mode)&&!h,y=e?e.mode:a.Ey.Panorama,w=this.sweepData.getStartSweep(e),x=w&&w.id,_=this.sweepData.getFirstSweep();let M=_&&_.rotation;if((null===(o=null==e?void 0:e.camera)||void 0===o?void 0:o.rotation)&&!(0,T.mB)(e.camera.rotation)&&(M=e.camera.rotation),M&&y!==a.Ey.Floorplan&&(M=(0,g.Z)(M)),v){await t.getModuleBySymbol(r.y.MODEL_MESH);const n=d.getFlyinEndPose({sweepID:x,position:e?e.camera.position:void 0,rotation:M}),o=d.getFlyinStartPose(n,s?new i.Vector3(0,0,0):void 0);t.broadcast(new E.bN(!0));const h=x?this.sweepModule.activateSweep({sweepId:x}):Promise.resolve();return await d.switchToMode(a.Ey.Dollhouse,c.n.Instant,o),await this.renderBeforeStarting(t),await(0,u.gw)(750),await this.cameraModule.moveTo({transitionType:c.n.Interpolate,pose:n}).nativePromise(),await h,t.broadcast(new E.bN(!1)),d.switchToMode(y,c.n.Interpolate,{sweepID:x,rotation:M},l.DEFAULT_TRANSITION_TIME)}await d.switchToMode(y,c.n.Instant,{sweepID:x,position:e?e.camera.position:void 0,rotation:M,zoom:e&&-1!==e.camera.zoom?e.camera.zoom:void 0}),m&&e&&(e.floorVisibility?await t.commandBinder.issueCommandWhenBound(new b.h9(e.floorVisibility.lastIndexOf(1),!0,0)):await t.commandBinder.issueCommandWhenBound(new b.Vw(null))),await this.renderBeforeStarting(t)}is360Pano(e){if(e.pano.uuid){const t=this.sweepData.getSweep(e.pano.uuid);if(t)return t.alignmentType!==d.z9.ALIGNED}else{const e=this.sweepData.getFirstSweep();if(void 0!==e)return e.alignmentType!==d.z9.ALIGNED}return!1}async renderBeforeStarting(e){await this.renderer.renderOnce(),await e.getModuleBySymbol(r.y.LOADING_GUI),this.renderer.startRender(!0),this.firstRenderPromise.resolve()}}},21284:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ShowcaseWebGLContextLoss});var i=n(57227),s=n(14877),r=n(62029),o=n(40529);class ShowcaseWebGLContextLoss extends i.Y{constructor(){super(...arguments),this.name="showcase-webgl-context-loss",this.contextLostEvent=null,this.framesWithLostContext=0}async init(e,t){this.config=e,this.engine=t,this.bindings.push(t.subscribe(r.zq,(e=>{this.contextLostEvent=e.event})),t.subscribe(r.Xq,(()=>{this.contextLostEvent=null,this.framesWithLostContext=0,t.getModule(o.default).then((e=>{e.currentErrorType===o.ErrorType.WEBGL_CONTEXT_LOST&&e.hideError()}))})))}onUpdate(e){const{contextLostEvent:t}=this;if(t){++this.framesWithLostContext===this.config.notificationDelayFrames&&(this.engine.getModule(o.default).then((e=>{e.currentErrorType||e.showError(o.ErrorType.WEBGL_CONTEXT_LOST)})),this.engine.getModuleBySymbol(s.y.ANALYTICS).then((e=>{!function(e,t){e.track("error_displayed",{error_dialog:"oops",error_type:"WebGLContextLost",exception:{message:`WebGL context lost: ${t.statusMessage||"no status given"}`},mock_error:!1})}(e,t)})))}}}},61026:(e,t,n)=>{"use strict";n.d(t,{n3:()=>ShowcaseStartCommand,mQ:()=>ShowcaseStopCommand});var i=n(93037);class ShowcaseStartCommand extends i.m{}ShowcaseStartCommand.id="SHOWCASE_START";class ShowcaseStopCommand extends i.m{}ShowcaseStopCommand.id="SHOWCASE_STOP";class ShowcaseReadyCommand extends i.m{}ShowcaseReadyCommand.id="SHOWCASE_READY"},2710:(e,t,n)=>{"use strict";n.d(t,{nQ:()=>o});var i=n(10854);const{MATTERTAGS:s,MODAL:r}=i.Z.WORKSHOP,o=(e=1)=>({title:s.DELETE_TAGS_MODAL_TITLE,titleLocalizationOptions:e,message:s.DELETE_TAGS_MODAL_MESSAGE,messageLocalizationOptions:e,cancellable:!0,cancelPhraseKey:r.NO,confirmPhraseKey:r.YES})},4254:(e,t,n)=>{"use strict";n.d(t,{U:()=>g});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(47475),d=n(71907),u=n(70329),h=n(70680),p=n(61445),m=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const f=new(n(5477).Z)("workshop-modal");var g;!function(e){e[e.CONFIRM=0]="CONFIRM",e[e.CLOSE=1]="CLOSE"}(g||(g={}));const v={message:"",title:"",modalClass:"",cancellable:!0,closeButton:!0,confirmDisabled:!1};let y=class WorkshopModal extends s.Component{constructor(e){super(e),this.isUnmounting=!1,this.handleModalCommand=async e=>{if(e.action===d.f.DISPLAY){if(this.state.open){if(!this.state.cancellable)return Promise.reject("Cannot close non-cancellable modal");await this.close(g.CLOSE)}return this.openModal(e.properties)}if(e.action===d.f.UPDATE)this.updateModal(e.properties);else{if(!this.state.open)return Promise.reject("Cannot cancel a closed modal");this.close(g.CLOSE)}return this.togglePromise},this.close=async e=>{await this.props.commandBinder.issueCommand(new c.n(400,0)),this.promiseResolve(e),this.props.handleBlur(!1),this.isUnmounting||this.setState({open:!1})},this.stopPropagation=e=>{e.stopPropagation()},this.onCancel=e=>{e.stopPropagation(),this.close(g.CLOSE)},this.onConfirm=async e=>{e.stopPropagation(),this.close(g.CONFIRM)},this.state={open:!1}}async componentDidMount(){try{this.props.commandBinder.addBinding(d.Q,this.handleModalCommand)}catch(e){f.debug(e)}}async componentWillUnmount(){this.isUnmounting=!0;try{this.props.commandBinder.removeBinding(d.Q,this.handleModalCommand)}catch(e){f.debug(e)}}updateModal(e){this.isUnmounting||this.state.open&&this.setState(Object.assign({},e))}openModal(e){this.props.commandBinder.issueCommand(new c.n(400,3)),this.props.handleBlur(!0);const t=Object.assign({},v,e);return this.isUnmounting?this.promiseResolve(g.CLOSE):(this.setState(Object.assign({open:!0},t)),this.togglePromise=new Promise((e=>{this.promiseResolve=e}))),this.togglePromise}render(){const{locale:e}=this.context,{open:t,title:n,titleLocalizationOptions:s,message:r,messageLocalizationOptions:a,confirmPhraseKey:l,cancelPhraseKey:c,closeButton:d,modalClass:m,confirmDisabled:f}=this.state,g=m||"";let v=n;if("string"==typeof n){const t=void 0===s?{}:s,r=e.t(n,t);v=(0,i.jsx)("span",{children:r})}let y=r;if("string"==typeof r){const t=void 0===a?{}:a,n=e.t(r,t);y=(0,i.jsx)("p",Object.assign({className:"modal-message"},{children:n}))}return(0,i.jsx)(h.N,Object.assign({open:t,className:o()("modal-background","workshop-modal-background",{open:t}),onClick:this.stopPropagation},{children:(0,i.jsxs)("dialog",Object.assign({className:`modal workshop-modal ${g}`},{children:[(0,i.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,i.jsx)("div",Object.assign({className:"modal-title"},{children:v})),d&&(0,i.jsx)(u.P,{onClose:this.onCancel})]})),(0,i.jsx)("div",Object.assign({className:"modal-body"},{children:y})),(0,i.jsxs)("div",Object.assign({className:"modal-footer"},{children:[c&&(0,i.jsx)(p.zx,Object.assign({buttonStyle:p.ZJ.OUTLINE,className:o()("button-inline","cancel"),onClick:this.onCancel},{children:e.t(c)})),l&&(0,i.jsx)(p.zx,Object.assign({buttonState:f?p.BN.DISABLED:p.BN.ENABLED,className:o()("button-inline","confirm"),onClick:this.onConfirm},{children:e.t(l)}))]}))]}))}))}};y.contextType=l.I,y=m([a.Z],y)},71907:(e,t,n)=>{"use strict";n.d(t,{f:()=>i,Q:()=>WorkshopModalCommand});var i,s=n(93037);!function(e){e[e.CLOSE=0]="CLOSE",e[e.DISPLAY=1]="DISPLAY",e[e.UPDATE=2]="UPDATE"}(i||(i={}));class WorkshopModalCommand extends s.m{constructor(e,t){if(super(),e&&!t)throw new Error("Cannot open empty modal");this.payload={action:e,properties:t}}}WorkshopModalCommand.id="WORKSHOP_MODAL"},95703:(e,t,n)=>{"use strict";n.d(t,{M:()=>Matrix});var i=n(2212);class ROMatrix{constructor(e){this.elements=[],e?(e=>void 0!==e.elements)(e)?this.elements=e.elements.slice():i.Matrix4.prototype.set.apply(this,e):i.Matrix4.prototype.set.apply(this,ROMatrix.identity)}equals(e){return i.Matrix4.prototype.equals.call(this,e)}clone(){return new ROMatrix(this)}}ROMatrix.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];class Matrix extends ROMatrix{constructor(e){e instanceof Array||e?super(e):super(),this.threeMatrix=new i.Matrix4}set(e,t,n,s,r,o,a,l,c,d,u,h,p,m,f,g){return i.Matrix4.prototype.set.call(this,e,t,n,s,r,o,a,l,c,d,u,h,p,m,f,g),this}makeScale(e,t,n){return i.Matrix4.prototype.makeScale.call(this,e,t,n),this}copy(e){for(let t=0;t<this.elements.length;t++)this.elements[t]=e.elements[t];return this}clone(){return(new Matrix).copy(this)}transpose(){return i.Matrix4.prototype.transpose.call(this)}lookAt(e,t,n){return i.Matrix4.prototype.lookAt.call(this,e,t,n),this}setPosition(e){return i.Matrix4.prototype.setPosition.call(this,e.x,e.y,e.z),this}extractRotation(e){return i.Matrix4.prototype.extractRotation.call(this,e),this}makePerspective(e,t,n,s,r,o){return i.Matrix4.prototype.makePerspective.call(this,e,t,n,s,r,o),this}makePerspectiveFov(e,t,n=.1,s=1e3){const r=n*Math.tan(e*(Math.PI/180)/2),o=-r,a=r*t,l=-a;return i.Matrix4.prototype.makePerspective.call(this,l,a,r,o,n,s),this}makeOrthographic(e,t,n,s,r,o){return i.Matrix4.prototype.makeOrthographic.call(this,e,t,n,s,r,o),this}identity(){return this.set.apply(this,ROMatrix.identity)}makeRotationFromQuaternion(e){return i.Matrix4.prototype.makeRotationFromQuaternion.call(this,e),this}makeRotationFromEuler(e){return i.Matrix4.prototype.makeRotationFromEuler.call(this,e),this}getInverse(e){return i.Matrix4.prototype.copy.call(this,e),i.Matrix4.prototype.invert.call(this),this}premultiply(e){return i.Matrix4.prototype.premultiply.call(this,e),this}multiplyMatrices(e,t){return i.Matrix4.prototype.multiplyMatrices.call(this,e,t),this}scale(e){return i.Matrix4.prototype.scale.call(this,e),this}compose(e,t,n){return i.Matrix4.prototype.compose.call(this,e,t,n),this}asThreeMatrix4(){return this.threeMatrix.set(this.elements[0],this.elements[4],this.elements[8],this.elements[12],this.elements[1],this.elements[5],this.elements[9],this.elements[13],this.elements[2],this.elements[6],this.elements[10],this.elements[14],this.elements[3],this.elements[7],this.elements[11],this.elements[15])}}},85111:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=Object.freeze({signedUrlDefaultExpireTime:24e4,signedUrlCheckInterval:1e4,signedUrlRefreshBuffer:15e3,visionTilingStartDate:new Date("8/26/2016"),visionTilingStartVersion:"1.1.407.13667",epsilon:1e-5,skyboxMeshGroup:"_group_skybox_",skysphereMeshGroup:"_group_skysphere_"})},93037:(e,t,n)=>{"use strict";n.d(t,{m:()=>Command});class Command{}},64177:(e,t,n)=>{"use strict";n.d(t,{B:()=>CommandBinder});var i=n(15697),s=n(31013);const r=new(n(5477).Z)("command-binder");class CommandBinder{constructor(){this.typeLookup=new i.cj,this.bindings={},this.queuedCommands={},this.hookedCommands={},this.resetHooks=()=>{this.hookedCommands={}},this.issueCommand=this.issueCommand.bind(this),this.issueCommandWhenBound=this.issueCommandWhenBound.bind(this)}addBinding(e,t){const n=this.typeLookup.getKeyByType(e,!0);if(this.bindings[n])throw Error(`Command ${n} already bound to a callback`);this.bindings[n]=t,this.callQueuedCommands(n);return{renew:()=>{this.bindings[n]!==t&&this.addBinding(e,t)},cancel:()=>this.removeBinding(e,t),active:this.bindings[n]===t}}removeBinding(e,t){const n=this.typeLookup.getKeyByType(e);if(!n)return void r.debug("Trying to unbind unbound command");this.bindings[n]===t?delete this.bindings[n]:r.debug("Trying to unbind unbound callback")}issueCommand(e,t=!0){const n=this.typeLookup.getKeyByInstance(e),i=this.bindings[n];return i?this.issueCommandHelper(e,n,i,t):Promise.reject("Command not bound: "+e.id)}issueCommandHelper(e,t,n,i=!0){return this.hookedCommands[t]&&!this.hookedCommands[t].resolving?this.issueHookCommand(e,t):n(e.payload)}issueCommandWhenBound(e){const t=new s.Q;return this.issueCommand(e).then((e=>t.resolve(e))).catch((n=>{const i=this.typeLookup.getKeyByInstance(e,!0);this.queuedCommands[i]||(this.queuedCommands[i]=[]),this.queuedCommands[i].push({command:e,deferred:t})})),t.nativePromise()}callQueuedCommands(e){const t=[];this.queuedCommands[e]&&(this.queuedCommands[e].forEach((e=>{t.push(this.issueCommand(e.command).then((t=>e.deferred.resolve(t))))})),Promise.all(t).then((()=>{delete this.queuedCommands[e]})))}hookCommand(e,t,n){const i=this.typeLookup.getKeyByType(e,!0);if(this.hookedCommands[i]){if(t&&null!==this.hookedCommands[i].preCommandCallback)throw Error(`Command ${e.name} has already been pre hooked`);if(!t&&null!==this.hookedCommands[i].postCommandCallback)throw Error(`Command ${e.name} has already been post hooked`)}else this.hookedCommands[i]={preCommandCallback:null,postCommandCallback:null,resolving:!1};t?this.hookedCommands[i].preCommandCallback=n:this.hookedCommands[i].postCommandCallback=n}async issueHookCommand(e,t){const n=this.hookedCommands[t],i=this.bindings[t],s=e.payload,r=n.preCommandCallback,o=n.postCommandCallback;try{r&&await r(s),n.resolving=!0;const a=await this.issueCommandHelper(e,t,i,!0);return n.resolving=!1,o&&await o(s),a}catch(e){throw Error(`Could not completely issueHookCommand - ${e}`)}}}},35424:(e,t,n)=>{"use strict";n.d(t,{V:()=>Data});var i=n(98254);class Data extends i.T{}},37008:(e,t,n)=>{"use strict";var i,s;n.d(t,{p3:()=>i,Jj:()=>NullGeneratorResult,M8:()=>WaitForPromiseGeneratorResult,ZP:()=>EngineGenerators}),function(e){e[e.None=0]="None",e[e.Duration=1]="Duration",e[e.Phase=2]="Phase",e[e.Promise=3]="Promise"}(i||(i={}));class EngineGeneratorResult{constructor(e){this.type=e}}class NullGeneratorResult extends EngineGeneratorResult{constructor(){super(i.None)}}class WaitDurationGeneratorResult extends EngineGeneratorResult{constructor(e){super(i.Duration),this.duration=e,this.startTime=Date.now()}}class WaitForPhaseGeneratorResult extends EngineGeneratorResult{constructor(e){super(i.Phase),this.phase=e}}!function(e){e[e.Pending=0]="Pending",e[e.Fulfilled=1]="Fulfilled",e[e.Rejected=2]="Rejected"}(s||(s={}));class WaitForPromiseGeneratorResult extends EngineGeneratorResult{constructor(e){super(i.Promise),this.promise=e,this.promiseState=s.Pending,e.then((()=>{this.promiseState=s.Fulfilled})).catch((()=>{this.promiseState=s.Rejected}))}}class EngineGenerator{constructor(e,t=!0){this.generator=e,t&&this.start()}start(){this.started||(this.iterator=this.generator()),this.started=!0}iterate(){const e=this.iterator.next();this.currentResult=e.value,e.done&&(this.started=!1)}}class EngineGenerators{constructor(){this.generators=[]}startGenerator(e){let t=this.generators.length;for(let n=0;n<this.generators.length;n++){this.generators[n].generator===e&&(t=n)}this.generators[t]=new EngineGenerator(e)}stopGenerator(e){for(const t of this.generators)t.generator===e&&(t.started=!1)}processGenerators(e,t){for(const n of this.generators)if(n.started)switch(e){case i.None:(!n.currentResult||n.currentResult instanceof NullGeneratorResult)&&n.iterate();break;case i.Phase:if(n.currentResult instanceof WaitForPhaseGeneratorResult){const e=n.currentResult;void 0!==t&&e.phase===t&&n.iterate()}break;case i.Promise:if(n.currentResult instanceof WaitForPromiseGeneratorResult){n.currentResult.promiseState===s.Fulfilled&&n.iterate()}break;case i.Duration:if(n.currentResult instanceof WaitDurationGeneratorResult){const e=n.currentResult;Date.now()-e.startTime>=e.duration&&n.iterate()}}}}},4117:(e,t,n)=>{"use strict";n.d(t,{v:()=>Message});class Message{constructor(){this.msgId=-1}setID(e){if(-1!==this.msgId)throw Error("Message.msgId can only be set once.");this.msgId=e}}},79013:(e,t,n)=>{"use strict";n.d(t,{Q:()=>a,Y:()=>MessageBus});var i=n(15697),s=n(5477),r=n(91183);const o=new s.Z("message-bus");var a;!function(e){e[e.PERMANENT=0]="PERMANENT",e[e.ONCE=1]="ONCE"}(a||(a={}));class MessageBus{constructor(){this.typeLookup=new i.cj,this.callbacks={},this.messageQueue=[],this.messageCount=0}subscribe(e,t,n=a.PERMANENT){return(0,r.k1)((()=>this._subscribe(e,t,n)),(()=>this.unsubscribe(e,t)),!0,(0,i.HS)(e))}_subscribe(e,t,n=a.PERMANENT){const i=this.typeLookup.getKeyByType(e,!0);this.callbacks[i]||(this.callbacks[i]=[]),this.callbacks[i].push({type:n,callback:t})}unsubscribe(e,t){const n=this.typeLookup.getKeyByType(e);n?this.unsubscribeByIndex(n,t):o.debug(`Message callback not bound for Type: ${e.name}`)}unsubscribeByIndex(e,t){const n=this.callbacks[e].findIndex((e=>e.callback===t));-1!==n?this.callbacks[e].splice(n,1):o.debug(`Message callback not bound for TypeIndex: ${e}`)}broadcast(e){if(e.setID(this.messageCount++),this.messageQueue.push(e),1===this.messageQueue.length){for(const e of this.messageQueue){const t=this.typeLookup.getKeyByInstance(e);if(!t)continue;const n=this.callbacks[t].slice();for(const i of n)i.callback(e),i.type===a.ONCE&&this.unsubscribeByIndex(t,i.callback)}this.messageQueue=[]}}}},57227:(e,t,n)=>{"use strict";n.d(t,{Y:()=>Module});var i=n(5477);class Module{constructor(){this.bindings=[]}init(e,t){return Promise.resolve()}onUpdate(e){}dispose(e){for(const e of this.bindings)e.cancel();this.bindings=[]}get log(){return this._logger||(this._logger=new i.Z(this.name||"module")),this._logger}}},33299:(e,t,n)=>{"use strict";n.d(t,{o:()=>RenderLayers});class RenderLayer{constructor(e){this._mask=e}get mask(){return this._mask}addLayers(e){this._mask|=e.mask}removeLayers(e){return this._mask&=~e.mask}clone(){return new RenderLayer(this._mask)}}class RenderLayers{constructor(){this.layerRegistry=[],this.unusedLayers=[];for(let e=1;e<32;e++)this.unusedLayers.push(e)}static get ALL(){return new RenderLayer(-1)}static get NONE(){return new RenderLayer(0)}static get DEFAULT(){return new RenderLayer(1)}claimLayer(e){const t=this.getLayer(e);if(t.mask)return t;if(0===this.unusedLayers.length)throw Error("All render layers have already been claimed");const n=this.unusedLayers[0];return this.layerRegistry[n]=e,this.unusedLayers.shift(),new RenderLayer(1<<n)}getLayer(e){const t=this.layerRegistry.indexOf(e);return-1!==t?new RenderLayer(1<<t):RenderLayers.NONE}disposeLayer(e){const t=this.layerRegistry.indexOf(e);-1!==t&&this.unusedLayers.push(t)}}},15697:(e,t,n)=>{"use strict";n.d(t,{z$:()=>i,oL:()=>s,HS:()=>r,cj:()=>TypeLookup});const i=e=>e.prototype.constructor.name,s=e=>e.constructor,r=e=>{if("string"==typeof e)return e;if(e&&e.name)return e.name;const t=e.toString();return t.substring(0,t.indexOf("\n")).split(" ")[1]};class TypeLookup{constructor(){this.typeLookupMap={}}getKey(e){return"string"==typeof e?e:e.name}addType(e){if(!e)throw Error("Cannot index undefined type");const t=this.getKey(e);if(this.typeLookupMap[t])throw Error(`Type ${t} already registered`);return this.typeLookupMap[t]=e,t}getKeyByType(e,t){if(!e)throw Error("Cannot index undefined type");const n=this.getKey(e);let i=this.typeLookupMap[n];return!i&&t&&(i=e,this.addType(i)),i?n:""}getKeyByInstance(e,t){if(!e)throw Error("Cannot index undefined data");const n=e.constructor.name;let i=this.typeLookupMap[n];return!i&&t&&(i=e.constructor,this.addType(i)),i?n:""}getTypeByKey(e){const t=this.typeLookupMap[e];if(!t)throw Error("Key not found");if("string"==typeof t)throw Error("non type keyed result not supported");return t}getKnownTypes(){return Object.values(this.typeLookupMap)}}},70446:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>i}),function(e){e[e.Begin=0]="Begin",e[e.Logic=1]="Logic",e[e.Render=2]="Render",e[e.End=3]="End"}(i||(i={}))},80051:(e,t,n)=>{"use strict";n.d(t,{k:()=>PlayerMovedMessage});var i=n(4117);class PlayerMovedMessage extends i.v{constructor(e,t){super(),this.x=e,this.y=t}}},20725:(e,t,n)=>{"use strict";n.d(t,{a:()=>PlayerResizedMessage});var i=n(4117);class PlayerResizedMessage extends i.v{constructor(e,t){super(),this.width=e,this.height=t}}},9986:(e,t,n)=>{"use strict";n.d(t,{nh:()=>i,Mx:()=>s,pu:()=>ApplicationData,RU:()=>a});var i,s,r=n(35424),o=n(36013);!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.WAITING=1]="WAITING",e[e.LOADING=2]="LOADING",e[e.STARTING=3]="STARTING",e[e.PLAYING=4]="PLAYING",e[e.ERROR=5]="ERROR"}(i||(i={})),function(e){e.UNKNOWN="unknown",e.WEBVR="webvr",e.SHOWCASE="showcase",e.WORKSHOP="workshop"}(s||(s={}));class ApplicationData extends r.V{constructor(e,t=s.UNKNOWN){super(),this.name="app",this.phase=e,this.application=t,this.phaseTimes=(0,o.$)({[i.UNINITIALIZED]:0,[i.WAITING]:0,[i.LOADING]:0,[i.STARTING]:0,[i.PLAYING]:0,[i.ERROR]:0}),this.error=null}getName(){return this.application.toString()}getVersion(){return"3.1.69.3-0-g204b0700e6"}}const a=()=>new ApplicationData(i.UNINITIALIZED)},36667:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var i=n(67294),s=n(20302),r=n(9986);const o=(0,s.u)(r.pu);function a(){const e=o(),[t,n]=(0,i.useState)(e?e.phase:null);return(0,i.useEffect)((()=>{if(!e)return()=>{};const t=e.onPropertyChanged("phase",n);return n(e.phase),()=>t.cancel()}),[e]),t}},87278:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>AppPhaseModule});var i=n(57227),s=n(9986),r=n(41907),o=n(93287),a=n(74372);class AppPhaseModule extends i.Y{constructor(){super(...arguments),this.name="app-phase"}async init(e,t){this.market=t.market,this.broadcast=t.broadcast.bind(t),this.tasks=e.tasks,this.appState=(0,s.RU)(),this.appState.phase=s.nh.UNINITIALIZED,this.appState.phaseTimes[s.nh.UNINITIALIZED]=Date.now(),this.appState.application=s.Mx.SHOWCASE,this.market.register(this,s.pu,this.appState),this.watchTasks(this.appState.phase),this.watchErrors(),this.updateAppHeaders(),this.bindings.push(this.appState.onPropertyChanged("application",(()=>this.updateAppHeaders())))}async watchTasks(e){if(e>=s.nh.PLAYING)return;const t=e+1;try{await Promise.all(this.tasks[t])}catch(e){this.error(e)}t===s.nh.PLAYING&&this.broadcast(new r.pB(this.appState.application)),this.appState.phase!==s.nh.ERROR&&e!==s.nh.ERROR&&(this.updateCurrentPhase(t),this.watchTasks(t))}async watchErrors(){try{await Promise.all(this.tasks[s.nh.ERROR])}catch(e){this.error(e)}}updateCurrentPhase(e){this.appState.phase=e,this.appState.phaseTimes[e]=Date.now(),this.log.info(`${JSON.stringify(this.appState)}`),this.appState.commit(),this.broadcast(new r.LZ(e))}error(e){this.appState.error=e,this.updateCurrentPhase(s.nh.ERROR)}updateActiveApp(e){this.appState.application=e,this.appState.commit(),this.broadcast(new r.bS(e))}getData(){return this.appState}updateAppHeaders(){(0,o.l)(this.appState.getName()),(0,a.t)(this.appState.getVersion())}}},41907:(e,t,n)=>{"use strict";n.d(t,{LZ:()=>AppPhaseChangeMessage,bS:()=>ApplicationChangeMessage,pB:()=>ApplicationLoadedMessage});var i=n(4117);class AppPhaseChangeMessage extends i.v{constructor(e){super(),this.phase=e}}class ApplicationChangeMessage extends i.v{constructor(e){super(),this.application=e}}class ApplicationLoadedMessage extends i.v{constructor(e){super(),this.application=e}}},46686:(e,t,n)=>{"use strict";n.d(t,{l:()=>SdkObservable,W:()=>SdkObserver});class SdkObservable{constructor(e,t,n){this.dependencies=e,this.subscriptionFactory=t,this.observers=new Set,this.currentData=n.create(),this.freshDataCache=n.create()}static async create(e,t,n){const i=await e.getDependencies();return new SdkObservable(i,t,n)}getData(){return this.currentData.data}subscribe(e){return this.addObserver(e),new class ObserverSubscription{constructor(e){this.sdkObservable=e,this.renew()}renew(){this.sdkObservable.addObserver(e)}cancel(){this.sdkObservable.removeObserver(e)}}(this)}addObserver(e){if(!this.observers.has(e)){class SdkObservableFacade{constructor(e){this.observable=e}onChanged(){this.observable.onChanged()}}this.observers.add(e),1===this.observers.size&&(this.currentData.update(...this.dependencies),this.changeSubscription=this.subscriptionFactory.create(new SdkObservableFacade(this),...this.dependencies)),e.dirty=!0}}removeObserver(e){0!==this.observers.size&&(this.observers.delete(e),0===this.observers.size&&this.changeSubscription.cancel())}onChanged(){if(this.freshDataCache.update(...this.dependencies),!this.currentData.equals(this.freshDataCache)){this.currentData.copy(this.freshDataCache);for(const e of this.observers)e.dirty=!0}}}class SdkObserver{constructor(){this.dirty=!1}}},92216:(e,t,n)=>{"use strict";n.d(t,{I:()=>SdkData});var i=n(35424);class SdkData extends i.V{constructor(){super(...arguments),this.name="sdk",this.applicationKey=null}}},29819:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CommunicationMethod:()=>c,Sdk:()=>Sdk,default:()=>Sdk});var i,s,r=n(57227),o=n(92216),a=n(84759);!function(e){e.EMBED="sdk.embed",e.BUNDLE="sdk.bundle"}(i||(i={})),function(e){e.CONNECTION="sdk.connection",e.DISCONNECT="sdk.disconnect",e.MESSAGED="sdk.messaged",e.SUBSCRIBED="sdk.subscribed",e.UNSUBSCRIBED="sdk.unsubscribed",e.OBSERVABLE_SUB="sdk.obs.subscribe",e.OBSERVABLE_UNSUB="sdk.obs.unsubscribe",e.COLLECTION_SUB="sdk.coll.subscribe",e.COLLECTION_UNSUB="sdk.coll.unsubscribe"}(s||(s={}));class AnalyticsProxy{constructor(e,t){this.analytics=e,this.sdkType=t,this.trackedEvents=new a.X}track(e,t,n){this.trackedEvents.has(e,t)||(this.trackedEvents.add(e,t),this.analytics.track(e,Object.assign({sdkType:this.sdkType},n)))}alwaysTrack(e,t,n){this.trackedEvents.add(e,t),this.analytics.track(e,Object.assign({sdkType:this.sdkType},n))}}class ClientCallAnalyticsHandler{constructor(e,t){this.analytics=e,this.getApplicationKey=t,this.messageType="client call"}onMessage(e,t){const{namespace:n,name:i}=e,s={applicationKey:this.getApplicationKey(),namespace:n,name:i,method:t.communicationMethod};this.analytics.track("sdk_call",n+i,s)}}var l=n(31013);class IdGenerator{constructor(){this.usedIds=new Set,this.usedIds.add(0)}generate(){let e;do{e=Math.floor(1e6*Math.random())}while(this.usedIds.has(e));return this.usedIds.add(e),e}isInUse(e){return this.usedIds.has(e)}}var c,d=n(6015);!function(e){e.POSTMESSAGE="postmessage",e.DIRECT="direct",e.WEBSOCKET="websocket"}(c||(c={}));var u,h,p,m=n(40470);class PostMessageConnectHandler{constructor(e,t,n,i){this.hostWindow=e,this.hostId=t,this.idGenerator=n,this.connectionReceiver=i,this.inFlightClients=new Set,this.connectionHandler=new d.TY(t,new d.R9(window)),this.connectionHandler.addObserver(new m.OR({onConnectionReceived:(e,t)=>this.onConnectionReceived(e,t)}))}init(){this.connectionHandler.init()}dispose(){this.connectionHandler.dispose()}onConnectionReceived(e,t){if(this.inFlightClients.has(t.id))return;e=e||{},this.inFlightClients.add(t.id);const n=e&&e.bootstrapVersion?this.idGenerator.generate():t.id,i=this.hostId,s=t.source,r=this.hostWindow,o=new d.l(i,r,n,s).createMessenger();this.connectionReceiver.onConnectionReceived(t.origin,e.options,{applicationKey:e.applicationKey,id:n,messenger:o,communicationMethod:c.POSTMESSAGE},{accept(e,t){o.send(new m.U7(e,t,n,i,window.location.origin))},handshake(){o.send(new m.RS)},reject(e){o.send(new m.HX(e)),o.dispose()}},e.applicationKey)}}class DirectConnectHandler{constructor(e,t,n){this.hostId=e,this.idGenerator=t,this.connectionReceiver=n,this.hostNode=new d.Ej(window.location.origin),this.connectionHandler=new d.TY(e,new d.tY(this.hostNode)),this.connectionHandler.addObserver(new m.OR({onConnectionReceived:(e,t)=>this.onConnectionReceived(e,t)}))}init(){this.connectionHandler.init()}dispose(){this.connectionHandler.dispose()}onConnectionReceived(e,t){const n=t.id,i=this.hostId,s=t.source,r=this.hostNode,o=s.origin,a=new d.UX(i,r,n,s).createMessenger(),l=new d.UX(i,r,n,s).createMessenger();this.connectionReceiver.onConnectionReceived(o,e.options,{id:n,applicationKey:e.applicationKey,messenger:a,communicationMethod:c.DIRECT},{accept(e,t){l.send(new m.U7(e,t,n,i,o)),l.dispose()},handshake(){l.send(new m.RS)},reject(e){l.send(new m.HX(e)),l.dispose()}})}connect(e,t){const n=this.idGenerator.generate(),i=this.hostId,s=new d.Ej(e),r=this.hostNode,o=new d.UX(n,s,i,r);return new Promise(((r,a)=>{const l=new d.UX(n,s,i,this.hostNode).createMessenger();l.init();const c=new class ConnectResponseHandler{accept(t,n,i,s,a){r({targetOrigin:e,sourceId:t,targetId:s,scriptUrl:n,serializedInterface:i,messengerFactory:o}),l.dispose()}reject(e){a(e),l.dispose()}};l.addObserver(new m.fE(c)),l.addObserver(new m.MJ(c)),l.send(new m.HE("direct",t))}))}}!function(e){e.EVENT="postmessage.event",e.RESPONSE="postmessage.response",e.OBSERVATION="postmessage.observation",e.COLLECTION_UPDATE="collection.updated",e.PRIVATE_MESSAGE="private.message"}(u||(u={})),function(e){e.ITEM_ADDED="collection.item.added",e.ITEM_REMOVED="collection.item.removed",e.ITEM_UPDATED="collection.item.updated",e.COLL_UPDATED="collection.coll.updated"}(h||(h={}));!function(e){e.DISCONNECT="sdk.client.disconnect",e.ACTION="postmessage.action",e.EVENT_SUB="postmessage.subscribe",e.EVENT_UNSUB="postmessage.unsubscribe",e.OBSERVABLE_SUB="postmessage.observe",e.OBSERVABLE_UNSUB="postmessage.unobserve",e.COLLECTION_SUB="collection.sub",e.COLLECTION_UNSUB="collection.unsub",e.PRIVATE_MESSAGE="private.message"}(p||(p={}));var f=n(31511);Math.PI;f.AR.Mode.DOLLHOUSE,new Float32Array(16);var g=n(29497);g.h.Success,f.kJ.AStarStatus.SUCCESS,g.h.NoPath,f.kJ.AStarStatus.NO_PATH,g.h.Timeout,f.kJ.AStarStatus.TIMEOUT;Symbol.iterator;var v;n(6157),n(90614);!function(e){e.map=new Map}(v||(v={}));n(44155);class ResponseMessage{constructor(e,t,n,i){this.type=u.RESPONSE,this.payload={uid:e,message:t,success:n,error:i},this.uid=e,this.message=t,this.success=n,this.error=i}}class EventMessage{constructor(e,t){this.type=u.EVENT,this.payload={eventType:e,eventData:t},this.eventType=e,this.eventData=t}}class ObservationMessage{constructor(e,t){this.type=u.OBSERVATION,this.payload={observableKey:e,observableData:t}}}class CollectionItemAddedMessage{constructor(e,t,n,i){this.type=u.COLLECTION_UPDATE,this.payload={operation:e,collectionKey:t,collectionIndex:n,item:i}}}class CollectionItemRemovedMessage{constructor(e,t,n){this.type=u.COLLECTION_UPDATE,this.payload={operation:e,collectionKey:t,collectionIndex:n}}}class CollectionItemUpdatedMessage{constructor(e,t,n,i){this.type=u.COLLECTION_UPDATE,this.payload={operation:e,collectionKey:t,collectionIndex:n,item:i}}}class CollectionUpdatedMessage{constructor(e,t){this.type=u.COLLECTION_UPDATE,this.payload={operation:e,collectionKey:t}}}class PrivateMessage_PrivateMessage{constructor(e,t){this.type=u.PRIVATE_MESSAGE,this.payload={messageType:e,messagePayload:t}}}class FunctionCallMessageObserver{constructor(e,t){this.receiver=e,this.clientInfo=t,this.messageType=p.ACTION}notify(e){this.receiver.onActionReceived(e,this.clientInfo)}}class EventSubscribeMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.EVENT_SUB}notify(e){this.observer.onEventSubReceived(e,this.clientInfo)}}class EventUnsubscribeMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.EVENT_UNSUB}notify(e){this.observer.onEventUnsubReceived(e,this.clientInfo)}}class ObservableSubMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.OBSERVABLE_SUB}notify(e){this.observer.onObservableSubReceived(e,this.clientInfo)}}class ObservableUnsubMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.OBSERVABLE_UNSUB}notify(e){this.observer.onObservableUnsubReceived(e,this.clientInfo)}}class CollectionSubMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.COLLECTION_SUB}notify(e){this.observer.onCollectionSubReceived(e,this.clientInfo)}}class CollectionUnsubMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.COLLECTION_UNSUB}notify(e){this.observer.onCollectionUnsubReceived(e,this.clientInfo)}}class PrivateMessageObserver_PrivateMessageObserver{constructor(e,t){this.observer=e,this.clientInfo=t,this.messageType=p.PRIVATE_MESSAGE}notify(e){this.observer.onPrivateMessageReceived(e,this.clientInfo)}}var y=n(46686),b=n(14877);const S=new(n(5477).Z)("sdk");class Sdk extends r.Y{constructor(){super(...arguments),this.name="sdk",this.hostId=Math.floor(1e6*Math.random()),this.triedLoadingInterface=!1,this.connectionHandlers=[],this.clientInterface={functions:{},commands:{},enums:{},observables:{},collections:{}},this.perOriginInterfaces=new Map,this.perSdkTypeInterfaces=new Map,this.clientConnections=new Map,this.eventToClientSubMap=new a.X,this.clientToEventSubMap=new a.X,this.observableToClientSubMap=new a.X,this.clientToObservableSubMap=new Map,this.collectionToClientSubMap=new a.X,this.clientToCollectionSubMap=new Map,this.privateMessageHandlers=new a.X,this.valueToClientInterface={},this.commandCreators={},this.commands={},this.asyncCommands={},this.observables={},this.collections={},this.firstTimeCollectionSubs=new a.X}async init(e,t){this.config=e,this.applicationKey=e.applicationKey,this.validationUrl=e.validationUrl,this.facade=new Sdk.MessengerHostFacade(this),this.clientIdGenerator=new IdGenerator,this.directConnectHandler=new DirectConnectHandler(this.hostId,this.clientIdGenerator,this.facade),this.connectionHandlers.push(new PostMessageConnectHandler(window,this.hostId,this.clientIdGenerator,this.facade),this.directConnectHandler),this.analytics=new AnalyticsProxy(await t.getModuleBySymbol(b.y.ANALYTICS),i.EMBED),this.clientFilter=e.clientFilter||(()=>!0),this.issueCommand=t.commandBinder.issueCommand.bind(t.commandBinder),this.interfacePromise=new l.Q,this.getClientScriptUrl=e.getClientScriptUrl,this.requestQueue=e.queue,this.data=new o.I,t.market.register(this,o.I,this.data),this.addPrivateMessageHandler(new ClientCallAnalyticsHandler(this.analytics,(()=>this.applicationKey))),this.enableHandshaking()}dispose(){for(const e of this.connectionHandlers)e.dispose();this.clearInterface()}connect(e,t={applicationKey:""}){return this.directConnectHandler.connect(e,t)}enableHandshaking(){for(const e of this.connectionHandlers)e.init()}async setupInterface(){if(!this.triedLoadingInterface)try{this.triedLoadingInterface=!0,await this.config.setupExternalSdk(this),this.interfacePromise.resolve()}catch(e){this.interfacePromise.reject(e.message)}}clearInterface(){this.clientInterface.functions={},this.clientInterface.commands={},this.clientInterface.enums={},this.clientInterface.observables={},this.clientInterface.collections={},this.commandCreators={}}onUpdate(){for(const[,e]of this.clientToObservableSubMap)for(const[t,[n,i]]of e)n.dirty&&(this.notifyObservableUpdate(t,i.getData()),n.dirty=!1);for(const[,e]of this.clientToCollectionSubMap)for(const[t,[,n]]of e)n.dirty&&this.notifyCollectionUpdates(t,n.readDiff())}addCommandCreator(e,t){const n=this.getInterfaceIndex(e);if(this.clientInterface.functions.hasOwnProperty(n)&&S.debug(`Overwriting ${n} function in sdk interface`),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.functions[n]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.functions[n]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.functions[n]=e,this.commandCreators[n]=t}addEnumToInterface(e){const t=this.getInterfaceIndex(e);if(this.clientInterface.functions.hasOwnProperty(t)&&S.debug(`Overwriting ${t} enum in sdk interface`),e.sdkTypes)for(const n of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(n)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.enums[t]=Object.assign({},e),this.perSdkTypeInterfaces.set(n,i)}if(e.origins)for(const n of e.origins){const i=this.perOriginInterfaces.get(n)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.enums[t]=Object.assign({},e),this.perOriginInterfaces.set(n,i)}if(this.clientInterface.enums[t]=Object.assign(Object.assign({},e),{values:Object.assign({},e.values)}),"Event"===e.name){const t=Object.keys(e.values);for(const n in t){this.valueToClientInterface;const i=e.values[t[n]];this.valueToClientInterface.hasOwnProperty(i)?S.warn(`Duplicate event detected for ${JSON.stringify(e)}`):this.valueToClientInterface[i]=e}}}async addCommandToInterface(e,t){const n=this.getInterfaceIndex(e);if(this.addCommand(n,t),e.sdkTypes)for(const t of e.sdkTypes){const i=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.commands[n]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,i)}if(e.origins)for(const t of e.origins){const i=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};i.commands[n]=Object.assign({},e),this.perOriginInterfaces.set(t,i)}this.clientInterface.commands[n]=e}async addAsyncCommandToInterface(e,t,...n){const i=this.getInterfaceIndex(e);if(this.addCommand(i,t,!0),e.sdkTypes)for(const t of e.sdkTypes){const n=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};n.commands[i]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,n)}if(e.origins)for(const t of e.origins){const n=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};n.commands[i]=Object.assign({},e),this.perOriginInterfaces.set(t,n)}this.clientInterface.commands[i]=Object.assign({},e)}async addCommand(e,t,n=!1){this.clientInterface.commands.hasOwnProperty(e);const i=this;return n?(this.asyncCommands[e]=t,{dispose(){delete i.asyncCommands[e]}}):(this.commands[e]=await t,{dispose(){delete i.commands[e]}})}addObservableToInterface(e,t,...n){const i=this.getInterfaceIndex(e);if(this.addObservable(i,t),e.sdkTypes)for(const t of e.sdkTypes){const n=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};n.observables[i]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,n)}if(e.origins)for(const t of e.origins){const n=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};n.observables[i]=Object.assign({},e),this.perOriginInterfaces.set(t,n)}this.clientInterface.observables[i]=Object.assign({},e)}addObservable(e,t){this.clientInterface.observables.hasOwnProperty(e),this.observables[e]=t;const n=this;return{dispose(){n.removeObservable(e)}}}removeObservable(e){var t;delete this.observables[e];for(const n of this.observableToClientSubMap.getValuesAtKey(e))null===(t=this.clientToObservableSubMap.get(n.id))||void 0===t||t.delete(e);this.observableToClientSubMap.removeKey(e)}addCollectionToInterface(e,t,...n){const i=this.getInterfaceIndex(e);if(this.addCollection(i,t),e.sdkTypes)for(const t of e.sdkTypes){const n=this.perSdkTypeInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};n.collections[i]=Object.assign({},e),this.perSdkTypeInterfaces.set(t,n)}if(e.origins)for(const t of e.origins){const n=this.perOriginInterfaces.get(t)||{functions:{},commands:{},enums:{},observables:{},collections:{}};n.collections[i]=Object.assign({},e),this.perOriginInterfaces.set(t,n)}this.clientInterface.collections[i]=Object.assign({},e)}addCollection(e,t){this.clientInterface.collections.hasOwnProperty(e),this.collections[e]=t;const n=this;return{dispose(){n.removeCollection(e)}}}removeCollection(e){var t;delete this.collections[e];for(const n of this.collectionToClientSubMap.getValuesAtKey(e))null===(t=this.clientToCollectionSubMap.get(n.id))||void 0===t||t.delete(e);this.collectionToClientSubMap.removeKey(e)}addPrivateMessageHandler(e){const{privateMessageHandlers:t}=this;return t.add(e.messageType,e),{dispose(){t.remove(e.messageType,e)}}}getInterfaceIndex(e){let t=`${e.name}`;return e.namespace&&(t=`${e.namespace}.${t}`),t}sendPrivateMessage(e,t){for(const[,n]of this.clientConnections)n.messenger.send(new PrivateMessage_PrivateMessage(e,t))}broadcast(e,t,n){for(const[,i]of this.clientConnections)if(t){const s=t(n);i.messenger.send(new EventMessage(e,s||[]))}else i.messenger.send(new EventMessage(e,[]))}notifyObservableUpdate(e,t){for(const n of this.observableToClientSubMap.getValuesAtKey(e))n.messenger.send(new ObservationMessage(e,t))}notifyCollectionUpdates(e,t){const{added:n,removed:i,updated:s}=t,r=n.size>0,o=i.size>0,a=s.size>0;for(const t of this.collectionToClientSubMap.getValuesAtKey(e)){const l=t.id;if(r)for(const[i,s]of n)t.messenger.send(new CollectionItemAddedMessage(h.ITEM_ADDED,e,i,s));if(o)for(const[n]of i)t.messenger.send(new CollectionItemRemovedMessage(h.ITEM_REMOVED,e,n));if(a)for(const[n,i]of s)t.messenger.send(new CollectionItemUpdatedMessage(h.ITEM_UPDATED,e,n,i));(r||o||a||this.firstTimeCollectionSubs.has(l,e))&&(t.messenger.send(new CollectionUpdatedMessage(h.COLL_UPDATED,e)),this.firstTimeCollectionSubs.remove(l,e))}}verifyConnection(e){const t={cache:!1,headers:{"X-Matterport-Application-Key":this.applicationKey,"X-Matterport-Referrer":e}};return this.requestQueue.get(this.validationUrl,t)}async onConnectionReceived(e,t,n,i,s){if(!this.clientFilter(e))return i.reject("Connection refused");this.applicationKey=s||this.applicationKey||null;try{await this.verifyConnection(e)}catch(e){return i.reject("key/referrer mismatch")}const r=async()=>{const t=new URL(e).hostname,s=this.perOriginInterfaces.get(t.toLowerCase()),r=this.perSdkTypeInterfaces.get(n.communicationMethod),o={enums:{},functions:{},observables:{},collections:{}},a=function(e,t,n,i){const s=e[t].sdkTypes,r=e[t].origins;if(!s&&!r)return!0;const o=s&&r&&(null==n?void 0:n[t])&&(null==i?void 0:i[t]),a=s&&!r&&(null==n?void 0:n[t]),l=!s&&r&&(null==i?void 0:i[t]);return o||a||l};for(const e in this.clientInterface.enums)a(this.clientInterface.enums,e,null==r?void 0:r.enums,null==s?void 0:s.enums)&&(o.enums[e]=this.clientInterface.enums[e]);for(const e in this.clientInterface.observables)a(this.clientInterface.observables,e,null==r?void 0:r.observables,null==s?void 0:s.observables)&&(o.observables[e]=this.clientInterface.observables[e]);for(const e in this.clientInterface.collections)a(this.clientInterface.collections,e,null==r?void 0:r.collections,null==s?void 0:s.collections)&&(o.collections[e]=this.clientInterface.collections[e]);for(const e in this.clientInterface.functions)a(this.clientInterface.functions,e,null==r?void 0:r.functions,null==s?void 0:s.functions)&&(o.functions[e]=this.clientInterface.functions[e]);for(const e in this.clientInterface.commands)a(this.clientInterface.commands,e,null==r?void 0:r.commands,null==s?void 0:s.commands)&&(o.functions[e]=this.clientInterface.commands[e]);this.onConnectionAccepted(e,n),i.accept(await this.getClientScriptUrl(),o)};i.handshake();try{this.config.onClientConnect(null==t?void 0:t.auth),await this.setupInterface(),await this.interfacePromise,await r(),this.data.atomic((()=>{this.data.applicationKey=this.applicationKey,this.data.commit()}))}catch(e){i.reject(e)}}onConnectionAccepted(e,t){const n=t.id,i=t.messenger,s={id:n,applicationKey:t.applicationKey,origin:e,communicationMethod:t.communicationMethod,messenger:i};this.clientConnections.set(n,s);const r=this.facade;i.addObserver(new FunctionCallMessageObserver(r,s)),i.addObserver(new EventSubscribeMessageObserver(r,s)),i.addObserver(new EventUnsubscribeMessageObserver(r,s)),i.addObserver(new ObservableSubMessageObserver(r,s)),i.addObserver(new ObservableUnsubMessageObserver(r,s)),i.addObserver(new CollectionSubMessageObserver(r,s)),i.addObserver(new CollectionUnsubMessageObserver(r,s)),i.addObserver(new PrivateMessageObserver_PrivateMessageObserver(r,s)),i.init(),this.trackSdkConnect(s)}onDisconnectReceived(e,t){const n=this.clientToEventSubMap.getValuesAtKey(t.id),i=this.clientToObservableSubMap.get(t.id)||[],s=this.clientToCollectionSubMap.get(t.id)||[];for(const e of n)this.eventToClientSubMap.remove(e,t);for(const[e]of i)this.observableToClientSubMap.remove(e,t);for(const[e]of s)this.collectionToClientSubMap.remove(e,t);this.clientToEventSubMap.removeKey(t.id),this.clientToObservableSubMap.delete(t.id),this.clientToCollectionSubMap.delete(t.id)}onActionReceived(e,t){if(this.tryActionThroughCommand(e,t))return;const n=this.commandCreators[e.targetFunction];if(n){this.trackSdkCall(e,t.id);try{this.issueCommand(n(e.params,t)).then((n=>t.messenger.send(new ResponseMessage(e.uid,n,!0,"")))).catch((n=>t.messenger.send(new ResponseMessage(e.uid,{},!1,n.message||n))))}catch(n){S.debug(n),t.messenger.send(new ResponseMessage(e.uid,{},!1,n.message))}}else t.messenger.send(new ResponseMessage(e.uid,{},!1,`${e.targetFunction} is not a valid command`))}tryActionThroughCommand(e,t){if(this.tryActionThroughAsyncCommand(e,t))return!0;const n=this.commands[e.targetFunction];if(!n)return!!this.clientInterface.commands.hasOwnProperty(e.targetFunction)&&(t.messenger.send(new ResponseMessage(e.uid,{},!1,`${e.targetFunction} is not ready to be called`)),!0);this.trackSdkCall(e,t.id);try{const i=new ReturnObserver({onSuccess(n){t.messenger.send(new ResponseMessage(e.uid,n,!0,""))},onFail(n){t.messenger.send(new ResponseMessage(e.uid,{},!1,n))}});n.exec(e.params,i,t)}catch(n){S.debug(n),t.messenger.send(new ResponseMessage(e.uid,{},!1,n.message))}return!0}tryActionThroughAsyncCommand(e,t){const n=this.asyncCommands[e.targetFunction];return!!n&&(n.then((n=>{try{const i=new ReturnObserver({onSuccess(n){t.messenger.send(new ResponseMessage(e.uid,n,!0,""))},onFail(n){t.messenger.send(new ResponseMessage(e.uid,{},!1,n))}});n.exec(e.params,i,t)}catch(n){S.debug(n),t.messenger.send(new ResponseMessage(e.uid,{},!1,n.message))}})),!0)}onEventSubReceived(e,t){this.eventToClientSubMap.add(e.subscription,t),this.trackSdkEvent(s.SUBSCRIBED,e,t)}onEventUnsubReceived(e,t){this.eventToClientSubMap.remove(e.subscription,t),this.trackSdkEvent(s.UNSUBSCRIBED,e,t)}async onObservableSubReceived(e,t){const n=e.observableKey,i=this.observables[n];if(i){const r=await i;if(!this.observables[n])return;if(!this.observableToClientSubMap.has(n,t)){const i=new y.W,o=r.subscribe(i);this.observableToClientSubMap.add(n,t);const a=this.clientToObservableSubMap.get(t.id)||new Map;a.set(n,[i,r,o]),this.clientToObservableSubMap.set(t.id,a),this.trackClientObservableSub(s.OBSERVABLE_SUB,e,t)}}else S.error(n,"is not a valid, registered observable")}onObservableUnsubReceived(e,t){const n=e.observableKey;this.observableToClientSubMap.remove(n,t);const i=this.clientToObservableSubMap.get(t.id);if(i){const r=i.get(n);if(r){const[,,o]=r;o.cancel(),i.delete(n),this.trackClientObservableSub(s.OBSERVABLE_UNSUB,e,t)}}}async onCollectionSubReceived(e,t){const n=e.collectionKey,i=this.collections[n];if(i){const r=await i;if(!this.collections[n])return;if(!this.collectionToClientSubMap.has(n,t)){const i=r.subscribe(t),o=[r,i];this.collectionToClientSubMap.add(n,t);const a=this.clientToCollectionSubMap.get(t.id)||new Map;a.set(n,o),this.clientToCollectionSubMap.set(t.id,a),this.firstTimeCollectionSubs.add(t.id,n),this.trackClientCollectionSub(s.COLLECTION_SUB,e,t)}}else S.error(n,"is not a valid, registered collection")}onCollectionUnsubReceived(e,t){const n=e.collectionKey;this.collectionToClientSubMap.remove(n,t);const i=this.clientToCollectionSubMap.get(t.id);if(i){const r=i.get(n);if(r){const[,o]=r;o.cancel(),i.delete(n),this.trackClientCollectionSub(s.COLLECTION_UNSUB,e,t)}}}onPrivateMessageReceived(e,t){const{messageType:n,messagePayload:i}=e;for(const e of this.privateMessageHandlers.getValuesAtKey(n))e.onMessage(i,t)}trackSdkConnect(e){if(!this.analytics)return;const t={origin:e.origin,applicationKey:this.applicationKey,method:e.communicationMethod};this.analytics.track("sdk_connect","connect",t)}trackSdkEvent(e,t,n){if(!this.analytics)return;const i=e===s.SUBSCRIBED?"on":"off",r=this.valueToClientInterface[t.subscription];if(!r)return;const o=Object.keys(r.values),a=o.find(((e,n)=>{const i=o[n];return r.values[i]===t.subscription}));if(!a)return;const l={origin:n.origin,applicationKey:this.applicationKey,name:i,namespace:r.namespace,eventType:a,count:this.eventToClientSubMap.valuesPerKey(t.subscription),method:n.communicationMethod};this.analytics.track("sdk_event",t.subscription,l)}trackSdkCall(e,t){const n=this.clientConnections.get(t);if(!n)return;const i=this.clientInterface.functions[e.targetFunction]||this.clientInterface.commands[e.targetFunction],s=Object.assign(Object.assign({origin:n.origin,applicationKey:this.applicationKey},i),{method:n.communicationMethod});this.analytics.track("sdk_call",e.targetFunction,s)}trackClientObservableSub(e,t,n){const i=e===s.OBSERVABLE_SUB,r=this.clientInterface.observables[t.observableKey],o=Object.assign(Object.assign({origin:n.origin,applicationKey:this.applicationKey},r),{is_collection:!1,action:i?"subscribe":"cancel",method:n.communicationMethod});this.analytics.track("sdk_subscribe",t.observableKey,o)}trackClientCollectionSub(e,t,n){const i=e===s.COLLECTION_SUB,r=this.clientInterface.collections[t.collectionKey],o=Object.assign(Object.assign({origin:n.origin,applicationKey:this.applicationKey},r),{is_collection:!0,action:i?"subscribe":"cancel",method:n.communicationMethod});this.analytics.track("sdk_subscribe",t.collectionKey,o)}}Sdk.MessengerHostFacade=class{constructor(e){this.messageHandler=e}onConnectionReceived(e,t,n,i,s){this.messageHandler.onConnectionReceived(e,t,n,i,s)}onDisconnectReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onDisconnectReceived(e,n)}onActionReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onActionReceived(e,n)}onEventSubReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onEventSubReceived(e,n)}onEventUnsubReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onEventUnsubReceived(e,n)}onObservableSubReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onObservableSubReceived(e,n)}onObservableUnsubReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onObservableUnsubReceived(e,n)}onCollectionSubReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onCollectionSubReceived(e,n)}onCollectionUnsubReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onCollectionUnsubReceived(e,n)}onPrivateMessageReceived(e,t){const n=this.messageHandler.clientConnections.get(t.id);n&&this.messageHandler.onPrivateMessageReceived(e,n)}};class ReturnObserver{constructor(e){this.action=e}return(e){this.action.onSuccess(e)}throw(e){this.action.onFail(e)}}},17423:(e,t,n)=>{"use strict";var i;n.d(t,{F:()=>i}),function(e){e.UnitType="user_preference/unit_type",e.MeasurementSnapping="user_preference/measurement_snapping",e.MeasurementContinuousLines="user_preference/measurement_continuous",e.MeasurementUserNudgeSeen="user_preference/measurement_nudge",e.HighlightReelSettingsTab="user_preference/highlight_reel_settings_tab",e.NotesModeNudgeSeen="user_preference/notes_mode_nudge",e.NotesAddNudgeSeen="user_preference/notes_add_nudge",e.NotesIntroModalSeen="user_preference/notes_intro_seen",e.LastRatingPromptTime="user_preference/model_rating_last_prompt_time",e.TagsAddNudgeSeen="user_preference/tags_add_nudge",e.SubscriberPromptDismissed="user_preference/subscriber_prompt_dismissed",e.DollhouseUserNudgeSeen="user_preference/dollhouse_nudge"}(i||(i={}))},6058:(e,t,n)=>{"use strict";n.d(t,{u:()=>SettingsToggler});class SettingsToggler{constructor(e,t){this.settingsData=e,this.settings=t,this.cache={},this.toggle=e=>{e?this.apply():this.reset()}}apply(){this.cache={};for(const e of Object.keys(this.settings)){const t=this.settingsData.tryGetProperty(e,void 0);t!==this.settings[e]&&(this.cache[e]=t,this.settingsData.setProperty(e,this.settings[e]))}}reset(){for(const e of Object.keys(this.cache)){const t=this.cache[e];this.settingsData.setProperty(e,void 0!==t&&t)}this.cache={}}}},61903:(e,t,n)=>{"use strict";n.d(t,{e:()=>SettingsData});var i=n(35424),s=n(66910),r=n(253);class SettingsData extends i.V{constructor(){super(...arguments),this.name="settings",this.properties=(0,s.q)()}setProperty(e,t){const n=this.properties.get(e);null!=t&&n===t||(this.properties.set(e,t),this.commit([e]))}notifyPropertyObserver(e,t){e(this.properties.get(t))}setLocalStorageProperty(e,t){(0,r.m8)(e,t),this.setProperty(e,t)}hasProperty(e){return this.properties.has(e)}tryGetProperty(e,t){return this.hasProperty(e)?this.properties.get(e):t}getProperty(e){if(this.hasProperty(e))return this.properties.get(e);throw new Error("SettingsData: "+e+" not found")}checkUrlParam(e,t,n=0){const i=this.tryGetProperty(e,n);return"number"==typeof i?i===t:parseInt(i,10)===t}iterate(e){for(const t of this.properties.keys)e(t,this.getProperty(t))}}},81242:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SettingPersistence:()=>a,default:()=>SettingsModule});var i,s=n(2212),r=n(81402),o=n(31013);!function(e){e[e.Init=0]="Init",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(i||(i={}));class SettingsGUI{constructor(e){this.onChange=e,this.settings={},this.helperObject={colors:{},vectors:{},quaternions:{}},this.initPromise=new o.Q,this.loadState=i.Init,this.uninitError="ControlKit not yet initialized",this.lastKeys=[],this.lastKeysBufferLength=0,this.controlKit=void 0,this.updateRequired=!1,this.panels=[],this.onToggleCallbacks={},this.onKeyDown=e=>{this.lastKeys.unshift(e.keyCode),this.lastKeys.length>this.lastKeysBufferLength&&this.lastKeys.pop();for(let e=0;e<this.panels.length;e++){const t=this.panels[e].activationSequence;(0,r.Jq)(this.lastKeys,t)&&this.toggle(e)}},this.getPanelId=e=>{for(const t of this.panels)if(e===t.header)return t.index;return-1},this.getSubGroup=(e,t)=>{const n=this.panels[e];n.guiPanel||(n.guiPanel=n.makeGuiPanel()),n.allowSubGroups||(t="");let i=n.subGroups.get(t||"");if(!i){n.guiPanel.addSubGroup({label:t,enable:!n.allowSubGroups});const e=n.guiPanel._groups[n.guiPanel._groups.length-1],s=e._subGroups[e._subGroups.length-1];i=new SubGroupWrapper(n.guiPanel,e,s),n.subGroups.set(t||"",i)}return i},this.addColor=(e,t,n,i)=>{this.updateHelperObject(t+n,i),e.addColor(this.helperObject.colors,t+n,{label:n,colorMode:"hex",onChange:e=>{this.settings[t+n].setHex(parseInt(e.substring(1),16));const i={};i[n]=this.settings[t+n],this.onChange(i)}})},this.addVector3=(e,t,n,i)=>{this.updateHelperObject(e+n,i);const r=this.getSubGroup(e,`${t}: ${n}`),o=["x","y","z"];for(const t in o)r.addNumberInput(this.helperObject.vectors[e+n],o[t],{label:o[t],onChange:()=>{this.settings[e+n]=new s.Vector3(this.helperObject.vectors[n].x,this.helperObject.vectors[n].y,this.helperObject.vectors[n].z);const t={};t[n]=this.settings[e+n],this.onChange(t)}})},this.addQuaternion=(e,t,n,i)=>{this.updateHelperObject(e+n,i);const r=this.getSubGroup(e,`${t}: ${n}`),o=["x","y","z","w"];for(const t in o)r.addNumberInput(this.helperObject.quaternions[e+n],o[t],{label:o[t],onChange:()=>{this.settings[e+n]=new s.Quaternion(this.helperObject.quaternions[e+n].x,this.helperObject.quaternions[e+n].y,this.helperObject.quaternions[e+n].z,this.helperObject.quaternions[e+n].w);const t={};t[n]=this.settings[e+n],this.onChange(t)}})}}init(){}async loadGuiPackage(){return this.loadState===i.Init&&(n.e(66).then(n.t.bind(n,94810,23)).then((e=>{const t=document.createElement("div");t.id="controlKitElement",(document.getElementById("control-kit-wrapper")||document.body).appendChild(t);const n=e=>e.stopPropagation();t.addEventListener("keydown",n),t.addEventListener("keyup",n),t.addEventListener("keypress",n),this.controlKit=new e.default({opacity:.9,enable:!1,parentDomElementId:"controlKitElement"}),this.controlKit.setShortcutEnable(""),this.controlKit.enable(),this.initPromise.resolve(),this.loadState=i.Loaded})),this.loadState=i.Loading),this.loadPromise}get loadPromise(){return this.initPromise.nativePromise()}get isLoaded(){return void 0!==this.controlKit}addPanel(e,t,n={}){for(void 0===n.width&&(n.width=250),void 0===n.allowSubGroups&&(n.allowSubGroups=!0),void 0===n.ratio&&(n.ratio=60),this.lastKeysBufferLength=Math.max(this.lastKeysBufferLength,t.length);this.lastKeysBufferLength>this.lastKeys.length;)this.lastKeys.unshift(-1);return this.panels.push({index:this.panels.length,header:e,guiPanel:null,makeGuiPanel:()=>this.controlKit.addPanel({label:e,align:"right",ratio:n.ratio,width:n.width}),subGroups:new Map,allowSubGroups:n.allowSubGroups,activationSequence:t.reverse()}),this.panels.length-1}isVisible(e){if(!this.controlKit)throw new Error(this.uninitError);return this.panels[e].guiPanel._enabled}toggle(e){this.controlKit?this.toggleVisibility(e):this.loadGuiPackage().then((()=>{this.toggleVisibility(e)}))}onToggle(e,t){this.onToggleCallbacks[e]||(this.onToggleCallbacks[e]=[]),this.onToggleCallbacks[e].push(t)}toggleVisibility(e){if(!this.controlKit)throw new Error(this.uninitError);const t=this.panels[e].guiPanel._enabled;if(t?this.panels[e].guiPanel.disable():this.panels[e].guiPanel.enable(),this.onToggleCallbacks[e])for(const n of this.onToggleCallbacks[e])n(!t)}dispose(){const e=document.getElementById("controlKit");e&&e.remove(),this.controlKit=void 0}activate(e){window.addEventListener("keydown",this.onKeyDown)}deactivate(e){this.controlKit&&this.controlKit.disable(),window.removeEventListener("keydown",this.onKeyDown)}render(){this.controlKit&&this.updateRequired&&(this.updateRequired=!1,this.controlKit.update())}updateSetting(e,t,n){if(!this.controlKit)throw new Error(this.uninitError);const i=e+t,s=this.settings[i];n&&"function"==typeof n.equals&&"function"==typeof n.copy&&s&&"function"==typeof s.equals&&"function"==typeof s.copy?n.equals(this.settings[i])||(this.settings[i].copy(n),this.updateHelperObject(i,n),this.updateRequired=!0):n!==this.settings[e+t]&&(this.settings[i]=n,this.updateRequired=!0)}getSetting(e,t){return this.settings[e+t]}isRegistered(e,t){return void 0!==this.settings[e+t]}addControl(e,t,n,i,r,o=2,a){if(!this.controlKit)throw new Error(this.uninitError);const l=`${e}${n}`;this.settings[l]=i;let c=typeof i;if(("string"===c&&"true"===i||"false"===i)&&(c="boolean"),i instanceof s.Color)this.addColor(this.getSubGroup(e,t),e,n,i);else if(i instanceof s.Vector3)this.addVector3(e,t,n,i);else if(i instanceof s.Quaternion)this.addQuaternion(e,t,n,i);else{const s=this.getSubGroup(e,t);switch(c){case"string":Array.isArray(a)?(this.settings[l]={options:a,selected:i},s.addSelect(this.settings[l],"options",{target:"selected",label:n,onChange:e=>{const t={[n]:a[e]};this.onChange(t)}})):s.addStringInput(this.settings,e+n,{label:n,onChange:t=>{const i={};this.settings[e+n]=t,i[n]=this.settings[e+n],this.onChange(i)}});break;case"number":this.settings[`${e+n}_range`]=r||[0,10],s.addSlider(this.settings,e+n,`${e+n}_range`,{label:n,onChange:()=>{const t={};t[n]=this.settings[e+n],this.onChange(t)},dp:o});break;case"boolean":s.addCheckbox(this.settings,e+n,{label:n,ratio:10,onChange:()=>{const t={};t[n]=this.settings[e+n],this.onChange(t)}});break;default:s.addStringOutput(this.settings,e+n,{label:n})}}}addButton(e,t,n,i){if(!this.controlKit)throw new Error(this.uninitError);this.getSubGroup(e,t).addButton(n,i,{label:"none",ratio:100})}addSlider(e,t,n,i,s,r,o){if(!this.controlKit)throw new Error(this.uninitError);const a=this.getSubGroup(e,t);this.settings[e+n]=i,this.settings[e+n+"_range"]=[s,r],a.addSlider(this.settings,e+n,e+n+"_range",{label:n,dp:o,onChange:()=>{const t={};t[n]=this.settings[e+n],this.onChange(t)}})}updateHelperObject(e,t){t instanceof s.Color?this.helperObject.colors[e]="#"+t.getHexString():t instanceof s.Vector3?(this.helperObject.vectors[e]={},this.helperObject.vectors[e].x=t.x,this.helperObject.vectors[e].y=t.y,this.helperObject.vectors[e].z=t.z):t instanceof s.Quaternion&&(this.helperObject.quaternions[e]={},this.helperObject.quaternions[e].x=t.x,this.helperObject.quaternions[e].y=t.y,this.helperObject.quaternions[e].z=t.z,this.helperObject.quaternions[e].w=t.w)}}class SubGroupWrapper{constructor(e,t,n){this.panel=e,this.group=t,this.subGroup=n}addButton(...e){this.invoke("addButton",e)}addSlider(...e){this.invoke("addSlider",e)}addSelect(...e){this.invoke("addSelect",e)}addCheckbox(...e){this.invoke("addCheckbox",e)}addColor(...e){this.invoke("addColor",e)}addStringInput(...e){this.invoke("addStringInput",e)}addStringOutput(...e){this.invoke("addStringOutput",e)}addNumberInput(...e){this.invoke("addNumberInput",e)}invoke(e,t){const n=this.panel._groups,i=this.group._subGroups,s=n.indexOf(this.group),r=i.indexOf(this.subGroup);n.splice(s,1),n.push(this.group),i.splice(r,1),i.push(this.subGroup);try{this.panel[e](...t)}finally{n.splice(s,0,n.pop()),i.splice(r,0,i.pop())}}}var a,l=n(57227),c=n(61903),d=n(2252),u=n(253),h=n(87100);function p(e){if(""===e)return e;const t=+e;return isNaN(t)?e:t}!function(e){e[e.NONE=0]="NONE",e[e.LOCAL_STORAGE=1]="LOCAL_STORAGE"}(a||(a={}));class SettingsModule extends l.Y{constructor(){super(...arguments),this.name="settings",this.queuedControls=[],this.queuedButtons=[],this.secretWord=[38,38,40,40,37,39,37,39,66,65,72],this.panelID=-1,this.addPanel=(e,t,n)=>{const i=this.getPanelId(e);return-1===i?this.settingsGUI.addPanel(e,t,n):i},this.getPanelId=e=>this.settingsGUI.getPanelId(e)}async init(e,t){this.engine=t,this.settings=new c.e,this.engine.market.register(this,c.e,this.settings),e.useGUI&&(this.settingsGUI=new SettingsGUI((e=>{this.updateSettings(e)})),t.addComponent(this,this.settingsGUI),this.panelID=this.settingsGUI.addPanel("3.1.69.3-0-g204b0700e6",this.secretWord));(0,h.kD)().forEach(((t,n)=>{let i=t;"string"==typeof i&&(i=p(i)),this.settings.setProperty(n,i),e.useGUI&&this.queuedControls.push({panelId:this.panelID,group:"Engine Config",settingName:n,value:i})})),e.useGUI&&this.settingsGUI.loadPromise.then((()=>{for(const e of this.queuedControls)this.settingsGUI.addControl(e.panelId,e.group,e.settingName,e.value,e.range,e.rangePrecision,e.options);for(const e of this.queuedButtons)this.settingsGUI.addButton(e.panelId,e.group,e.buttonName,e.callback);this.settingsGUI.toggle(this.panelID)}))}get settingsData(){return this.settings}get loadPromise(){return this.settingsGUI.loadPromise}getSettingsGui(){return this.settingsGUI}getMainPanelId(){return this.panelID}updateSetting(e,t,n=this.panelID){t&&t.clone&&"function"==typeof t.clone?this.settings.setProperty(e,t.clone()):this.settings.setProperty(e,t),this.settingsGUI&&this.settingsGUI.isLoaded&&this.settingsGUI.updateSetting(n,e,t)}updateSettings(e){for(const t in e)this.updateSetting(t,e[t])}registerSetting(e,t,n,i=!0,s=a.NONE,r,o=this.panelID,l=2,c){if(this.settingsGUI&&this.settingsGUI.isRegistered(o,t))return void this.log.warn(`Duplicate setting ${t} registered. Is a module being used twice?`);let d;d=n&&n.clone&&"function"==typeof n.clone?n.clone():n,this.settingsGUI&&i&&(this.settingsGUI.isLoaded?this.settingsGUI.addControl(o,e,t,d,r,l,c):this.queuedControls.push({panelId:o,group:e,settingName:t,value:n,range:r,rangePrecision:l,options:c}));const h=s===a.LOCAL_STORAGE?(0,u.fp)(t,n):n;this.updateSetting(t,h)}registerMenuEntry(e){const{header:t,setting:n,initialValue:i,persist:s,displayInUi:r,range:o,panel:a,onChange:l,rangePrecision:c,options:u,urlParam:m}=e;let f=i();const g=encodeURIComponent(n);if(m){const e=(0,h.eY)(g,null);null!==e&&(f="true"===e||"false"!==e&&p(e))}if(this.registerSetting(t,n,f,r,s,o,a,c,u),!l&&!m)return null;if(l&&l(f),m){const e=i(),t=t=>{const n=(0,h.kD)();n.has(g)&&t===e?n.delete(g):n.set(g,t),(0,d.Vf)(n.toString(),!0),l&&l(t)};return this.settings.onPropertyChanged(n,t)}return l?this.settings.onPropertyChanged(n,l):null}registerMenuButton(e){const{header:t,buttonName:n,panel:i,callback:s}=e;this.registerButton(t,n,s,i)}registerButton(e,t,n,i=this.panelID){this.settingsGUI&&(this.settingsGUI.isLoaded?this.settingsGUI.addButton(i,e,t,n):this.queuedButtons.push({panelId:i,group:e,buttonName:t,callback:n}))}hasProperty(e){return this.settings.hasProperty(e)}getProperty(e){return this.settings.getProperty(e)}tryGetProperty(e,t){return this.settings.tryGetProperty(e,t)}toggleMenu(){this.settingsGUI&&this.settingsGUI.toggle(0)}disposeGui(){this.settingsGUI.dispose()}}},18537:(e,t,n)=>{"use strict";var i;n.d(t,{E:()=>i}),function(e){e[e.Immediate=0]="Immediate",e[e.NextFrame=1]="NextFrame",e[e.Duration=2]="Duration",e[e.Manual=3]="Manual"}(i||(i={}))},60673:(e,t,n)=>{"use strict";n.d(t,{KI:()=>i,AQ:()=>ChangeRecord,Z8:()=>CollectionMonitor});var i,s=n(95987),r=n(18537),o=n(70446);!function(e){e.added="added",e.removed="removed",e.updated="updated"}(i||(i={}));class ChangeRecord{constructor(e,t,n){this.index=e,this.action=t,this.diff=n}}class CollectionMonitor{constructor(e,t){if(this.changedHandlers=[],this.awaitingInvoke=!1,this.diffRecord=[],this.targetMonitors={},this.triggerChangeHandlers=this.invokeChangeHandlers.bind(this),this.config=e,this.updatePhaseSync=t,this.config.aggregationType===r.E.NextFrame){if(!t)throw Error("UpdatePhaseSync required for NextFrame aggregation")}else if(this.config.aggregationType===r.E.Duration)throw Error("Aggregation Type not implemented")}hasDiffRecord(){return this.diffRecord.length>0}clearDiffRecord(){this.diffRecord=[];for(const e in this.targetMonitors){const t=this.targetMonitors[e];t.hasDiffRecord()&&t.clearDiffRecord()}}onChanged(e){this.changedHandlers.push(e)}removeOnChanged(e){(0,s.bX)(this.changedHandlers,e)}invokeCallbacks(e){if(this.changedHandlers.length>0)for(const t of this.changedHandlers)t(e)}invokeChangeHandlers(e){switch(this.config.aggregationType){case r.E.Immediate:this.invokeCallbacks(e);break;case r.E.NextFrame:this.awaitingInvoke||(this.awaitingInvoke=!0,this.updatePhaseSync.after(o.A.End).then((()=>{this.awaitingInvoke=!1,this.invokeCallbacks(e)})));break;case r.E.Manual:}}}},67495:(e,t,n)=>{"use strict";n.d(t,{c:()=>MapMonitor});var i=n(60673),s=n(65834),r=n(54929);class MapMonitor extends i.Z8{constructor(e,t,n){super(t,n),this.target=e;for(const i of e.keys){const r=e.get(i),o=new s.u(r,t,n);o.onChanged(this.triggerChangeHandlers),this.targetMonitors[i]=o}const o={onAdded:(e,o)=>{const a=new s.u(e,t,n);a.onChanged(this.triggerChangeHandlers),this.targetMonitors[o]=a;const l=this.diffRecord.findIndex((e=>e.index===o));-1!==l&&this.diffRecord.splice(l,1);const c=new i.AQ(o,i.KI.added,(0,r.p$)(e));-1===l&&this.diffRecord.push(c),this.triggerChangeHandlers(c)},onRemoved:(e,t)=>{delete this.targetMonitors[t];const n=this.diffRecord.findIndex((e=>e.index===t));-1!==n&&this.diffRecord.splice(n,1);const s=new i.AQ(t,i.KI.removed,(0,r.p$)(e));-1===n&&this.diffRecord.push(s),this.triggerChangeHandlers(s)}};this.target.onElementChanged(o)}commitChanges(){this.invokeCallbacks(this.getDiffRecord())}getDiffRecord(){const e=[];for(const t in this.targetMonitors){const n=this.targetMonitors[t];if(n.hasDiffRecord()){const s=n.getDiffRecord(),o=this.diffRecord.findIndex((e=>e.index===t));-1!==o?(0,r.TS)(this.diffRecord[o].diff,s):e.push(new i.AQ(t,i.KI.updated,s))}}return this.diffRecord.concat(e)}}},65834:(e,t,n)=>{"use strict";n.d(t,{u:()=>Monitor});var i=n(18537),s=n(54929),r=n(70446),o=n(95987);class Monitor{constructor(e,t,n){this.updatePhaseSync=n,this.target=e,this.clearDiffRecord(),this.target.onChanged((()=>{this.diffRecord=(0,s.br)(this.originalData,(0,s.p$)(this.target),t.shallow),this.handleAggregation()})),this.aggregationType=t.aggregationType,this.changedHandlers=[]}hasDiffRecord(){return Object.keys(this.diffRecord).length>0}getDiffRecord(){return this.diffRecord}clearDiffRecord(){this.originalData=(0,s.p$)(this.target),this.diffRecord={}}onChanged(e){this.changedHandlers.push(e)}removeOnChanged(e){(0,o.bX)(this.changedHandlers,e)}commitChanges(){this.triggerChangeHandlers(this.diffRecord)}handleAggregation(){switch(this.aggregationType){case i.E.Immediate:this.triggerChangeHandlers(this.diffRecord);break;case i.E.NextFrame:if(!this.updatePhaseSync)throw new Error("handleAggregation() -> Next frame aggregation requested, but updatePhaseSync is null");this.nextFramePromise||(this.nextFramePromise=this.updatePhaseSync.after(r.A.Begin).then((()=>{this.triggerChangeHandlers(this.diffRecord)})).finally((()=>{this.nextFramePromise=void 0})));break;case i.E.Duration:throw new Error("AggregationType.Duration: Please implement me :)");case i.E.Manual:}}triggerChangeHandlers(e){if(this.changedHandlers.length>0)for(const t of this.changedHandlers)t(e)}}},15183:(e,t,n)=>{"use strict";n.d(t,{y:()=>Observable});var i=n(91183);class Observable{constructor(){this.isObservable=!0,this._dirtyObservable=!1,this._activeObservable=!0,this._observerNotifying=!1,this._changeObservers=new Set,this._parentObservables=new Set,this._childObservables=new Set,Object.defineProperties(this,{isObservable:{value:this.isObservable,writable:!1,enumerable:!1},_dirtyObservable:{value:this._dirtyObservable,enumerable:!1},_activeObservable:{value:this._activeObservable,enumerable:!1},_observerNotifying:{value:this._observerNotifying,enumerable:!1},_changeObservers:{value:this._changeObservers,writable:!1,enumerable:!1},_childObservables:{value:this._childObservables,writable:!1,enumerable:!1},_parentObservables:{value:this._parentObservables,writable:!1,enumerable:!1}})}onChanged(e){if(this._changeObservers.has(e))throw new Error("This observer function is already observing this Observable, and double subscriptions are not supported.");return(0,i.k1)((()=>this._changeObservers.add(e)),(()=>this.removeOnChanged(e)),!0)}removeOnChanged(e){this._changeObservers.delete(e)}notifyObservers(){if(this._dirtyObservable&&!this._observerNotifying&&this._activeObservable){this._observerNotifying=!0;for(const e of this._changeObservers)this.notifyObserver(e);this._dirtyObservable=!1,this._observerNotifying=!1}}notifyObserver(e){e(void 0)}notifyDown(){for(const e of this._childObservables)e.notifyDown();this.notifyObservers()}notifyUp(){for(const e of this._parentObservables)e.notifyUp();this.notifyObservers()}setDirty(e=!0){this.setDirtyUp(),e&&this.notifyUp()}setDirtyUp(){if(!this._dirtyObservable){this._dirtyObservable=!0;for(const e of this._parentObservables)e.setDirtyUp()}}addChildObservable(e){Observable.isObservable(e)&&(this._childObservables.add(e),e._parentObservables.add(this))}removeChildObservables(e){Observable.isObservable(e)&&(this._childObservables.delete(e),e._parentObservables.delete(this))}atomic(e){if(!this._activeObservable)return e();try{this.setActive(!1),e()}finally{this.setActive(!0)}}setActive(e){const t=this._activeObservable;this._activeObservable=e,!t&&e&&this.notifyObservers();for(const t of this._childObservables)t.setActive(e)}deepCopy(){throw Error("deepCopy is only implemented in subclasses of Observable")}static isObservable(e){return e&&e.isObservable}}},29984:(e,t,n)=>{"use strict";n.d(t,{d:()=>ObservableArray,C:()=>r});var i=n(15183),s=n(54929);class ObservableArray extends i.y{constructor(){super(),this.isObservableArray=!0,this.elements=[]}push(e){return this.elements.push(e),this.addChildObservable(e),this.setDirty(),this.length}concat(e){const t=this.elements.length;this.elements=this.elements.concat(e);for(let e=t;e<this.elements.length;e++)this.addChildObservable(this.elements[e]);return this.setDirty(),this.length}replace(e){for(const e of this.elements)this.removeChildObservables(e);return this.elements=[],this.concat(e)}remove(e){if(e<0||e>=this.length)throw new Error(`Index ${e} not in range of ObservableArray`);const[t]=this.elements.splice(e,1);this.removeChildObservables(t),this.setDirty()}update(e,t){const n=this.elements[e];n!==t&&(this.elements[e]=t,this.removeChildObservables(n),this.addChildObservable(t),this.setDirty())}get length(){return this.elements.length}set length(e){if(e<this.elements.length){for(let t=this.elements.length-1;t>=e;t--){const e=this.elements[t];this.removeChildObservables(e)}this.elements.length=e,this.setDirty()}}values(){return[...this.elements]}filter(e){return this.elements.filter(e)}find(e){return this.elements.find(e)}*[Symbol.iterator](){for(const e of this.elements)yield e}map(e){return this.elements.map(e)}forEach(e){this.elements.forEach(e)}sort(e){this.elements.sort(e)}get(e){return this.elements[e]}findIndex(e){return this.elements.findIndex(e)}indexOf(e){return this.elements.indexOf(e)}splice(e,t,...n){let i;if(n.length){i=this.elements.splice(e,t,...n);for(const e of n)this.addChildObservable(e)}else i=this.elements.splice(e,t);for(const e of i)this.removeChildObservables(e);return this.setDirty(),i}insert(e,t){if(e>this.elements.length)throw new Error(`Tried to insert at index ${e} in an array that's only ${this.elements.length} long`);e!==this.elements.length?(this.elements.splice(e,0,t),this.addChildObservable(t),this.setDirty()):this.push(t)}shift(){const e=this.elements.shift();return e&&(this.removeChildObservables(e),this.setDirty()),e}move(e,t){if(t>this.elements.length-1)throw Error("Index to move to is out of bounds");const n=this.elements[e];this.elements.splice(e,1),this.elements.splice(t,0,n),this.setDirty()}onElementChanged(e){let t=this.elements.slice();return this.onChanged((()=>{for(const n in t){const i=parseInt(n,10);e.onRemoved&&void 0===this.get(i)&&e.onRemoved(t[i],i)}for(const n in this.elements){const s=parseInt(n,10),r=this.get(s);void 0===t[s]?e.onAdded&&e.onAdded(r,s):(i.y.isObservable(r)&&r._dirtyObservable||r!==t[s])&&(e.onUpdated?e.onUpdated(r,s):e.onRemoved&&null===r&&e.onRemoved(t[s],s))}t=this.elements.slice()}))}deepCopy(){return this.map((e=>(0,s.p$)(e)))}}const r=e=>{const t=new ObservableArray;return e&&t.concat(e),t}},66910:(e,t,n)=>{"use strict";n.d(t,{v:()=>ObservableMap,q:()=>o});var i=n(15183),s=n(54929);function r(e){return(0,s.hj)(e)?""+e:e}class ObservableMap extends i.y{constructor(){super(),this.map={},this._keysSet=new Set,this._keysList=[]}get keys(){return this._keysList.slice()}get values(){return this._keysList.map((e=>this.get(e)))}entries(){const e=[];for(const t in this.map)e.push([t,this.map[t]]);return e}get length(){return this._keysList.length}*[Symbol.iterator](){for(const e of this._keysList)yield this.get(e)}get(e){return this.map[e]}has(e){return void 0!==this.map[e]}set(e,t){e=r(e);this.map[e]!==t&&(this.removeChildObservables(this.map[e]),this.addChildObservable(t),this.map[e]=t,this._keysSet.has(e)||(this._keysList.push(e),this._keysSet.add(e)),this.setDirty())}clear(){if(this.length>0){for(const e in this.map)this.removeChildObservables(this.map[e]);this.map={},this._keysSet.clear(),this._keysList=[],this.setDirty()}}delete(e){e=r(e),this.removeChildObservables(this.map[e]);const t=this.map.hasOwnProperty(e);return delete this.map[e],t&&(this._keysSet.delete(e),this._keysList.splice(this._keysList.indexOf(e),1),this.setDirty()),t}onElementChanged(e){let t=Object.assign({},this.map);return this.onChanged((()=>{for(const n in t)e.onRemoved&&!this.has(n)&&e.onRemoved(t[n],n);for(const n of this._keysList){const s=this.get(n);void 0===t[n]?e.onAdded&&e.onAdded(s,n):(i.y.isObservable(s)&&s._dirtyObservable||s!==t[n])&&(e.onUpdated&&null!==s?e.onUpdated(s,n):e.onRemoved&&null===s&&e.onRemoved(t[n],n))}t=Object.assign({},this.map)}))}deepCopy(){const e={};for(const t of this._keysList)e[t]=(0,s.p$)(this.map[t]);return e}}const o=(e={})=>{const t=new ObservableMap;for(const n in e)t.set(n,e[n]);return t}},98254:(e,t,n)=>{"use strict";n.d(t,{T:()=>ObservableObject});var i=n(15183),s=n(54929),r=n(87100),o=n(5477),a=n(91183);const l=new o.Z("ObservableObject"),c=1===(0,r.eY)("debug",0);class ObservableObject extends i.y{constructor(){super(),this._propertyObservables={},this._valueCache={},this._dirtyKeys=new Set,Object.defineProperties(this,{_propertyObservables:{value:this._propertyObservables,writable:!1,enumerable:!1},_valueCache:{value:this._valueCache,writable:!1,enumerable:!1},_dirtyKeys:{value:this._dirtyKeys,writable:!1,enumerable:!1}}),c&&setTimeout((()=>{!function(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]=e[n],e._valueCache[n]=e[n],Object.defineProperty(e,n,{get:()=>t[n],set:s=>{const r=e._valueCache[n];(r!==s||i.y.isObservable(r)&&r._dirtyObservable)&&u(e,n),t[n]=s},enumerable:!0}))}(this)}),1)}onPropertyChanged(e,t){if(this._propertyObservables[e]||(this._propertyObservables[e]=[]),-1!==this._propertyObservables[e].indexOf(t))throw new Error("This observer function is already observing this Observable, and double subscriptions are not supported.");return(0,a.k1)((()=>this._propertyObservables[e].push(t)),(()=>this.removeOnPropertyChanged(e,t)),!0,e)}removeOnPropertyChanged(e,t){const n=this._propertyObservables[e].indexOf(t);n>=0&&this._propertyObservables[e].splice(n,1)}commit(e=[]){for(const t of e)this._dirtyKeys.add(t);this.setDirtyUp(),this.notifyUp()}setDirtyUp(){for(const e in this){if(!this.hasOwnProperty(e))continue;const t=this._valueCache[e],n=this[e],s=typeof n,r="undefined"===s||"string"===s||"number"===s||"boolean"===s||null===n;if(this._propertyObservables[e]&&!r&&!i.y.isObservable(n))throw new Error(`Property ${e} has property listeners, but has a value that is not observable or a primitive!`);t!==n?(this.removeChildObservables(t),this.addChildObservable(n),this._valueCache[e]=n,this._dirtyKeys.add(e)):i.y.isObservable(t)&&t._dirtyObservable&&this._dirtyKeys.add(e)}super.setDirtyUp()}notifyObservers(){if(this._dirtyObservable&&!this._observerNotifying&&this._activeObservable){this._observerNotifying=!0;for(const e of this._dirtyKeys){for(const t of this._propertyObservables[e]||[])this.notifyPropertyObserver(t,e);c&&h(this,e)}this._observerNotifying=!1,this._dirtyKeys.clear()}super.notifyObservers()}notifyPropertyObserver(e,t){e(this._valueCache[t])}notifyObserver(e){e(this)}deepCopy(){const e={};for(const t in this)this.hasOwnProperty(t)&&(e[t]=(0,s.p$)(this[t]));return e}}const d=new Map;function u(e,t){d.has(e)||d.set(e,{});d.get(e)[t]=Error()}function h(e,t){if(d.has(e)){const n=d.get(e);n[t]&&delete n[t]}}if(c){const e=setInterval((()=>{(function(){for(const e of d.values())for(const t in e)return l.error(`ObservableObject property "${t}" was still dirty after one tick! Did you forget a .commit()?`),l.error("See stack trace of the property write below:"),l.error(e[t].stack),!0;return!1})()&&void 0!==e&&clearInterval(e)}),16)}},36013:(e,t,n)=>{"use strict";n.d(t,{$:()=>l});var i=n(15183),s=n(67779),r=n(54929);function o(e,t){const n=Object.getOwnPropertyNames(t);for(const i of n)void 0===e[i]&&("function"==typeof t[i]?Object.defineProperty(e,i,{value:t[i].bind(e)}):Object.defineProperty(e,i,{value:t[i],writable:!0}));null!==Object.getPrototypeOf(Object.getPrototypeOf(t))&&o(e,Object.getPrototypeOf(t))}var a=n(98254);const l=e=>{if(!e||0===Object.keys(e).length)throw new Error("createObservableProxy() only works on objects that has predefined keys. Did you mean createObservableMap or createObservableArray?");if(e instanceof a.T)throw new Error("Using ObservableProxy on an ObservableObject is a BUG!");if(e.isObservableProxy)return e;const t={},n=new i.y,l=Object.create(e);Object.defineProperties(l,{isObservableProxy:{value:!0},onPropertyChanged:{value:(e,n)=>t[e].onChanged(n)},removeOnPropertyChanged:{value:(e,n)=>t[e].removeOnChanged(n)},deepCopy:{value:()=>(0,r.p$)(e)}}),o(l,n);for(const n in e)if(e.hasOwnProperty(n)){const i=(0,s.Y)(e[n]);t[n]=i,l.addChildObservable(i),Object.defineProperty(l,n,{get:()=>e[n],set:i=>{e[n]=i,t[n].value=i},enumerable:!0})}return Object.seal(l),l}},67779:(e,t,n)=>{"use strict";n.d(t,{f:()=>ObservableValue,Y:()=>r});var i=n(15183),s=n(54929);class ObservableValue extends i.y{constructor(e){super(),this.value=e}notifyObserver(e){e(this.value)}get value(){return this._value}set value(e){this._value!==e&&(this.removeChildObservables(this._value),this.addChildObservable(e),this._value=e,this.setDirty())}deepCopy(){return(0,s.p$)(this._value)}}const r=e=>new ObservableValue(e)},97428:(e,t,n)=>{"use strict";n.d(t,{$:()=>PureObservable});class PureObservable{constructor(){this.observers=new Set}observe(e){this.observers.add(e);const t=this;return{renew(){t.observers.add(e)},cancel(){t.removeObserver(e)}}}removeObserver(e){this.observers.delete(e)}notify(){for(const e of this.observers)e.notify()}}},52549:(e,t,n)=>{"use strict";var i;n.d(t,{g:()=>i}),function(e){e.BLURS="blurs",e.BLUR_SUGGESTIONS="blur-suggestions",e.FLOORS="floors",e.HIGHLIGHTS="highlights",e.LABELS="labels",e.MATTERTAGS="mattertags",e.MEASUREMENTS="measurements",e.NOTES="notes",e.ORDERED_LISTS="orderedLists",e.PHOTOS="photos",e.SETTINGS="settings",e.START_LOCATION="startlocation",e.SWEEPS="sweeps"}(i||(i={}))},36032:(e,t,n)=>{"use strict";n.d(t,{V:()=>AggregateSubscription});class AggregateSubscription{constructor(...e){this.subs=e}renew(){for(const e of this.subs)e.renew()}cancel(){for(const e of this.subs)e.cancel()}}},91183:(e,t,n)=>{"use strict";n.d(t,{gm:()=>Catalog,ne:()=>DataCatalog,k1:()=>s});const i=new(n(5477).Z)("Subscription");class Catalog{constructor(e,t,n){this.watchedData=e,this.registerSubscription=t,this.unregisterSubscription=n}createSubscription(e,t){return new Subscription((()=>this.registerSubscription(e)),(()=>this.unregisterSubscription(e)),t)}getData(){return this.watchedData()}}class DataCatalog{constructor(e,t,n){this.watchedData=e,this.registerSubscription=t,this.unregisterSubscription=n}createSubscription(e,t){const n=()=>e(this.watchedData());return new Subscription((()=>this.registerSubscription(n)),(()=>this.unregisterSubscription(n)),t)}getData(){return this.watchedData()}}class Subscription{constructor(e,t,n=!1,i=""){this.startSubscription=e,this.endSubscription=t,this.id=i,this.isSubbed=!1,n&&this.renew()}renew(){this.isSubbed?i.debugWarn(`Duplicate subscription renew ${this.id}`):(this.startSubscription(),this.isSubbed=!0)}cancel(){this.isSubbed&&(this.endSubscription(),this.isSubbed=!1)}get active(){return this.isSubbed}}function s(e,t,n=!0,i=""){return new Subscription(e,t,n,i)}},591:(e,t,n)=>{"use strict";n.d(t,{r:()=>DomSubscription});class DomSubscription{constructor(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.options=i,this.renew()}renew(){this.target.addEventListener(this.type,this.listener,this.options)}cancel(){this.target.removeEventListener(this.type,this.listener)}}},54929:(e,t,n)=>{"use strict";n.d(t,{p$:()=>s,TS:()=>r,br:()=>o,NK:()=>a,hj:()=>l});const i=e=>"propertyObservers"===e||"changeObservers"===e||"isObservable"===e||"childChangeFunctions"===e||"isObservableProxy"===e||"diffRoot"===e||"elementChangedHandlers"===e||"knownKeysMap"===e||"knownKeysList"===e||"isVector2"===e||"isVector3"===e||"isQuaternion"===e||"onPropertyChanged"===e||"removeOnPropertyChanged"===e||"onChanged"===e||"target"===e,s=(e,t=[])=>{if(void 0!==e){if(t.includes(e))return Array.isArray(e)||ArrayBuffer.isView(e)?[]:{};if(e instanceof Date)return new Date(e);if(null===e)return null;if(e.deepCopy)return e.deepCopy();if(e.isQuaternion)return{x:e.x,y:e.y,z:e.z,w:e.w};if("object"==typeof e){const n=Array.isArray(e)||ArrayBuffer.isView(e)?[]:{};for(const r in e){if(i(r))continue;const o=e[r];o instanceof Date?n[r]=new Date(o):"function"!=typeof o&&(t.push(e),n[r]="object"==typeof o?s(o,t):o,t.pop())}return n}return e}},r=(e,t)=>{for(const n in t){if("function"==typeof t[n])continue;if(i(n)&&!e.hasOwnProperty(n))continue;const o=t[n];if(e.hasOwnProperty(n)){const t=e[n];(null===t?null:typeof t)!==(null===o?null:typeof o)?e[n]=s(o):"object"==typeof t?t instanceof Date?e[n]=new Date(o):r(t,o):e[n]=o}else e[n]=s(o)}},o=(e,t,n=!1)=>{const i={};for(const s in e){const r=e[s],l=t[s];a(r,l)&&(void 0===r||void 0===l||typeof r!=typeof l||"object"!=typeof r?i[s]=l:Array.isArray(l)?a(r,l)&&(i[s]=l):i[s]=n?l:o(r,l))}for(const n in t)n in e||(i[n]=t[n]);return i},a=(e,t)=>{if(null===e||"object"!=typeof e)return e!==t;if(!t)return!0;for(const n in t)if(!(n in e))return!0;for(const n in e)if(a(e[n],t[n]))return!0;return!1};function l(e){return"number"==typeof e}},91754:(e,t,n)=>{"use strict";var i;n.d(t,{h:()=>i}),function(e){e.NOTE="note",e.COMMENT="comment",e.MATTERTAG="mattertag"}(i||(i={}))},77364:(e,t,n)=>{"use strict";n.d(t,{I:()=>Color});var i=n(2212);class Color{}Color.MP_BRAND=new i.Color("rgb(255, 49, 88)"),Color.MATTERTAG_BLUE=new i.Color("rgb(3, 104, 125)"),Color.WHITE=new i.Color("rgb(255, 255, 255)"),Color.BLACK=new i.Color("rgb(0, 0, 0)"),Color.RED=new i.Color(16711680),Color.GREEN=new i.Color(65280),Color.BLUE=new i.Color(255),Color.YELLOW=new i.Color(16776960)},95891:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>s}),function(e){e[e.GL_TEXTURE_CUBE_MAP_POSITIVE_X=0]="GL_TEXTURE_CUBE_MAP_POSITIVE_X",e[e.GL_TEXTURE_CUBE_MAP_NEGATIVE_X=1]="GL_TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.GL_TEXTURE_CUBE_MAP_POSITIVE_Y=2]="GL_TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y=3]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.GL_TEXTURE_CUBE_MAP_POSITIVE_Z=4]="GL_TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z=5]="GL_TEXTURE_CUBE_MAP_NEGATIVE_Z"}(i||(i={}));const s=i},99295:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>i}),function(e){e[e.boundingSkybox=-100]="boundingSkybox",e[e.default=0]="default",e[e.ghostFloor=3]="ghostFloor",e[e.panoMarker=4]="panoMarker",e[e.reticule=5]="reticule",e[e.grid=5]="grid",e[e.meshTrims=5]="meshTrims",e[e.pins360=6]="pins360",e[e.portals=9]="portals",e[e.rotators=10]="rotators",e[e.pins=14]="pins",e[e.pinSelectedHalo=15]="pinSelectedHalo",e[e.lines=20]="lines",e[e.endpoints=21]="endpoints",e[e.labels=22]="labels",e[e.gizmos=23]="gizmos",e[e.colorOverlay=1e3]="colorOverlay"}(i||(i={}))},36589:(e,t,n)=>{"use strict";var i;n.d(t,{C:()=>i}),function(e){e.TEXT="text",e.LINK="link",e.HASH="hash",e.USER="user"}(i||(i={}))},77280:(e,t,n)=>{"use strict";n.d(t,{f:()=>Vectors,e:()=>i});var i,s=n(2212);class Vectors{}Vectors.UP=new s.Vector3(0,1,0),Vectors.DOWN=new s.Vector3(0,-1,0),Vectors.LEFT=new s.Vector3(-1,0,0),Vectors.RIGHT=new s.Vector3(1,0,0),Vectors.FORWARD=new s.Vector3(0,0,-1),Vectors.BACK=new s.Vector3(0,0,1),Vectors.ZERO=new s.Vector3(0,0,0),Vectors.UNIT=new s.Vector3(1,1,1),Vectors.HORIZONTAL_PLANE=new s.Vector3(1,0,1),function(e){e.NONE="NONE",e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.FORWARD="FORWARD",e.BACK="BACK",e.ZERO="ZERO",e.UNIT="UNIT",e.HORIZONTAL_PLANE="HORIZONTAL_PLANE"}(i||(i={}))},40603:(e,t,n)=>{"use strict";n.d(t,{y:()=>BaseException});var i=n(96557);class BaseException extends Error{constructor(e,t){super(e instanceof Error?e.message:e),this.name="BaseException",t&&(this.code=t),e instanceof Error&&(this.originalError=e,(0,i.Ad)(e)&&(this.isMock=!0))}}},62631:(e,t,n)=>{"use strict";n.d(t,{n:()=>NotImplementedError});var i=n(40603);class NotImplementedError extends i.y{constructor(e="Not implemented"){super(e),this.name="NotImplemented"}}},18050:(e,t,n)=>{"use strict";n.d(t,{Z:()=>OutOfRangeException});var i=n(40603);class OutOfRangeException extends i.y{constructor(e="Out of range"){super(e),this.name="OutOfRangeException"}}},96557:(e,t,n)=>{"use strict";function i(e){return!!(e&&e instanceof Error&&e.code)}function s(e){return!!(e&&e instanceof Error&&e.originalError)}function r(e){return!!(e&&e instanceof Error&&e.isMock)}function o(e){return i(e)?e.code:""}function a(e){const t=[];let n=e;for(;n;)i(n)&&t.push(n.code),n=s(n)?n.originalError:void 0;return t}n.d(t,{bh:()=>i,Ad:()=>r,zg:()=>o,UX:()=>a})},97236:(e,t,n)=>{"use strict";n.d(t,{U:()=>MaasAttachmentsStore});var i=n(62631),s=n(5673),r=n(5005),o=n(12621);class MaasAttachmentsStore{constructor(e={readonly:!0}){const{baseUrl:t}=e;this.config=e,this.client=new s.w({baseUrl:t,server:o.wO})}async create(...e){throw new i.n}async read(e={}){throw new i.n}async update(...e){throw new i.n}async delete(...e){throw new i.n}async query(e,t,n={}){if(!MaasAttachmentsStore.baseViewId)throw new r.SN("Cannot read Attachments, no model view configured");return this.client.query(e,t,n)}async mutate(e,t,n){const{readonly:i}=this.config;if(i)throw new r.pp("Cannot write Attachments, model is in read-only mode");if(!MaasAttachmentsStore.baseViewId)throw new r.SN("Cannot write Attachments, no model view configured");return this.client.mutate(e,t,n)}static setBaseViewId(e){MaasAttachmentsStore.baseViewId=e}}MaasAttachmentsStore.baseViewId=null},66225:(e,t,n)=>{"use strict";n.d(t,{u:()=>MdsStore});var i=n(62631),s=n(5673),r=n(5005),o=n(5477),a=n(87100);const l=new o.Z("MdsStore");class MdsStore{constructor(e={readonly:!0}){this.viewId=null;const{baseUrl:t,viewId:n}=e;this.config=e,this.client=new s.w({baseUrl:t}),n&&(this.viewId=n)}async create(...e){throw new i.n}async read(e={}){throw new i.n}async update(...e){throw new i.n}async delete(...e){throw new i.n}async query(e,t,n={}){if(!this.getViewId())throw new r.SN("No model view specified for query");const i=Object.assign({fetchPolicy:"cache-first",prefetchKey:this.prefetchKey},n),{fetchPolicy:s}=n;let o;if("no-cache"!==s)for(const n of MdsStore.sharedCache)if(o=await n.read(e,t,i),void 0!==o){l.debug(`Using cached response for ${i.prefetchKey}`);break}return o||this.client.query(e,t,i)}async mutate(e,t,n){const{readonly:i}=this.config;if(i)throw new r.pp("Cannot mutate in read-only mode");if(!this.getViewId())throw new r.SN("Cannot mutate, no view was specified");return this.client.mutate(e,t,n).then((e=>{const t="53100"===(0,a.eY)("error","");if(!s.w.isOk(e)||t){const n=new r.w0(s.w.getErrorMessage(e));throw t&&(n.isMock=!0),n}return e}))}getViewId(){return this.viewId||MdsStore.currentViewId||MdsStore.baseViewId}static setCurrentViewId(e){MdsStore.currentViewId=e}static setBaseViewId(e){MdsStore.baseViewId=e}static addSharedCache(e){MdsStore.sharedCache.add(e)}static removeSharedCache(e){MdsStore.sharedCache.delete(e)}}MdsStore.baseViewId=null,MdsStore.currentViewId=null,MdsStore.sharedCache=new Set},5673:(e,t,n)=>{"use strict";n.d(t,{w:()=>ModelApiClient});var i=n(29474),s=n(23564),r=n(81707),o=n(80496);var a=n(73957),l=n(5477),c=n(90778),d=n(5005);var u=n(12621),h=n(78804);const p=new l.Z("model-api-client");class ModelApiClient{constructor(e={}){const t=e.baseUrl||window.location.origin,n=e.server||u.fH;this.graphUrl=e.url||`${t}${n}`,p.debug(`Initialized Model API client for ${this.graphUrl}`);const a=(0,i.createHttpLink)({uri:this.graphUrl}),l=(c=(e,{headers:t={}})=>((0,h.m)(this.graphUrl,t),{headers:t}),new r.i0((function(e,t){var n=(0,s._T)(e,[]);return new o.y$((function(i){var s;return Promise.resolve(n).then((function(t){return c(t,e.getContext())})).then(e.setContext).then((function(){s=t(e).subscribe({next:i.next.bind(i),error:i.error.bind(i),complete:i.complete.bind(i)})})).catch(i.error.bind(i)),function(){s&&s.unsubscribe()}}))})));var c;this.apollo=new i.fe({link:l.concat(a),cache:new i.h4})}async query(e,t,n={}){const i=Object.assign(Object.assign({errorPolicy:"all"},n),{query:e,variables:t,fetchPolicy:"no-cache"});return this.apollo.query(i).then((e=>{const{data:t,errors:n}=e;return{data:t,errors:n}})).catch((e=>{throw p.error(e),new d.Zb(e,this.getApolloErrorCode(e))}))}async mutate(e,t,n={}){const i=Object.assign(Object.assign({errorPolicy:"all"},n),{mutation:e,variables:t});return this.apollo.mutate(i).then((e=>{const{data:t,errors:n}=e;return{data:t,errors:n}})).catch((e=>{throw p.error(e),new d.w0(e,this.getApolloErrorCode(e))}))}async upload(e,t,n,i){const s={};let r=0;(0,a.y)(n,((e,t,n)=>{if(e&&((i=e).filename&&i.blob&&i.blob instanceof Blob)){const i="file"+r++;s[i]=e,n[t]=`multipart:${i}`}var i}));const o=new FormData;for(const[e,t]of Object.entries(s))o.append(e,t.blob,t.filename);o.append("query",(0,c.S)(e)),o.append("operation",t),o.append("variables",JSON.stringify(n));const l=(0,h.m)(this.graphUrl,{});return this.uploadFormData(o,l,i).then((e=>{if(!ModelApiClient.isOk(e)){const t=ModelApiClient.getErrorCode(e)||"54200";throw new d.BR(ModelApiClient.getErrorMessage(e),t)}return e}))}getApolloErrorCode(e){var t;if(e instanceof i.cA){const n=null===(t=e.networkError)||void 0===t?void 0:t.statusCode;if(n)return`61${n}`}return"61000"}async uploadFormData(e,t,n){const i=new XMLHttpRequest;i.open("GET",this.graphUrl,!0),i.responseType="json",i.setRequestHeader("Accept","application/json"),n&&(i.upload.onprogress=n);for(const e in t)i.setRequestHeader(e,t[e]);return new Promise(((t,n)=>{i.onreadystatechange=()=>{4===i.readyState&&(200===i.status?t(i.response):0!==i.status&&n(new d.BR(`${i.status} ${i.statusText}`,`54${i.status}`)))},i.onerror=()=>{n(new d.BR("Network error","54002"))},i.send(e)}))}static isOk(e){return!(null==e?void 0:e.errors)||0===e.errors.length}static getErrorCode({errors:e}){var t;return(null==e?void 0:e.length)&&(null===(t=e[0].extensions)||void 0===t?void 0:t.code)||""}static getErrorMessage({errors:e}){let t="";return Array.isArray(e)&&e[0]&&(t=e[0].message||e[0].toString(),e.length>1&&(t+=` (+${e.length-1})`)),t}}ModelApiClient.version="2020.05.28"},5005:(e,t,n)=>{"use strict";n.d(t,{Zb:()=>MdsReadError,w0:()=>MdsWriteError,BR:()=>MdsUploadError,SN:()=>InvalidViewError,pp:()=>ReadOnlyError});var i=n(40603);class MdsReadError extends i.y{constructor(e,t="62001"){super(e),this.name="MdsReadError",this.code=t}}class MdsWriteError extends i.y{constructor(e,t="63001"){super(e),this.name="MdsWriteError",this.code=t}}class MdsUploadError extends i.y{constructor(e,t="63002"){super(e),this.name="MdsUploadError",this.code=t}}class InvalidViewError extends i.y{constructor(e,t="52404"){super(e),this.name="InvalidView",this.code=t}}class ReadOnlyError extends i.y{constructor(e,t="53001"){super(e),this.name="ReadOnly",this.code=t}}},9042:(e,t,n)=>{"use strict";var i;n.d(t,{G:()=>i}),function(e){e.UPLOAD="upload",e.EXTERNAL="external",e.SANDBOX="sandbox"}(i||(i={}))},23688:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>i}),function(e){e.THUMBNAIL="thumbnail",e.REEL="reel"}(i||(i={}))},40330:(e,t,n)=>{"use strict";var i;n.d(t,{L:()=>i}),function(e){e.PHOTO="photo",e.VIDEO="video",e.RICH="rich"}(i||(i={}))},94170:(e,t,n)=>{"use strict";var i;n.d(t,{x:()=>i}),function(e){e.FULL="full",e.VIEWER="viewer",e.PUBLIC="public"}(i||(i={}))},49991:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e.LEFT="left",e.RIGHT="right",e.AUTO="auto"}(i||(i={}))},36886:(e,t,n)=>{"use strict";var i;n.d(t,{b:()=>i}),function(e){e.UNPLACED="unplaced",e.AUTO="auto",e.MANUAL="manual"}(i||(i={}))},22026:(e,t,n)=>{"use strict";var i;n.d(t,{u:()=>i}),function(e){e.COMMENT="comment",e.MATTERTAG="mattertag"}(i||(i={}))},50889:(e,t,n)=>{"use strict";var i;n.d(t,{B:()=>i}),function(e){e.PHOTO2D="photo2D",e.EQUIRECTANGULAR="equirectangular"}(i||(i={}))},61233:(e,t,n)=>{"use strict";var i;n.d(t,{w:()=>i}),function(e){e.PANORAMA="panorama",e.FLOORPLAN="floorplan",e.DOLLHOUSE="dollhouse",e.MESH="mesh"}(i||(i={}))},12621:(e,t,n)=>{"use strict";n.d(t,{fH:()=>i,wO:()=>s,AR:()=>r,SJ:()=>o});const i=`${window.location.pathname}`+"api/mp/models/graph",s=`${window.location.pathname}`+"api/mp/attachments/graph",r="features/mds_prefetch",o="data.model.views"},60661:(e,t,n)=>{"use strict";var i;n.d(t,{K:()=>i}),function(e){e.Segment="segment",e.Logging="logging",e.Matterport="mp"}(i||(i={}))},90403:(e,t,n)=>{"use strict";n.d(t,{H:()=>f});var i=n(60661),s=n(5477);const r=new s.Z("segment");const o=new s.Z("log-analytics");var a=n(83535),l=n(63336),c=n(19718),d=n(253),u=n(36507);const h=new s.Z("mp-analytics"),p="ajs_anonymous_id",m="sc_anonymous_id";const f={[i.K.Segment]:{class:class SegmentAnalyticsProvider{constructor(e){this.token=e,this.endpointType=i.K.Segment,this.options={}}init(e,t){return this.setOptions(e),this.context=t,this.token?(window.analytics&&window.analytics.initialize&&(window.analytics=null),window.analytics||function(){var e=window.analytics=window.analytics||[];if(!e.initialize)if(e.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{e.invoked=!0,e.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on","addSourceMiddleware","addIntegrationMiddleware","setAnonymousId","addDestinationMiddleware"],e.factory=function(t){return function(){var n=Array.prototype.slice.call(arguments);return n.unshift(t),e.push(n),e}};for(var t=0;t<e.methods.length;t++){var n=e.methods[t];e[n]=e.factory(n)}e.load=function(t,n){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s),e._loadOptions=n},e.SNIPPET_VERSION="4.15.2"}}(),window.analytics.load(this.token),new Promise(((e,t)=>{window.analytics.ready(e)}))):Promise.resolve()}identify(e){window.analytics.identify(e.id,{first_name:e.firstName,last_name:e.lastName,email:e.email})}track(e,t,n){s.Z.level>=3&&r.debug(e,t?JSON.stringify(t).replace('\\"','"'):t),t=Object.assign(t||{},this.options);const i=this.context.integrations?Object.assign({},this.context.integrations):{};i.Intercom=!!n;try{window.analytics.track(e,t,Object.assign(Object.assign({},this.context),{integrations:i}))}catch(t){r.error(`Failed to send data to segment for ${e}`)}}trackAsync(e,t,n){if(t=t||{},navigator.sendBeacon)try{navigator.sendBeacon("https://api.segment.io/v1/t",JSON.stringify({event:e,anonymousId:window.analytics.user().anonymousId(),properties:Object.assign({data:t},this.options),integrations:{Intercom:!!n},writeKey:this.token,sentAt:Date.now(),type:"track",context:this.context}))}catch(e){r.error("Failed to send async segment request")}}setOptions(e){Object.assign(this.options,e)}},key:"segment_key",url:null},[i.K.Logging]:{class:class LoggingAnalyticsProvider{init(e,t){return o.debug("logging analytics to console",{options:e,context:t}),Promise.resolve()}identify(e){o.debug("identify as",e)}track(e,t,n){o.debug({eventName:e,data:t,intercom:n})}trackAsync(e,t,n){o.debug({eventName:e,data:t,intercom:n})}setOptions(e){o.debug("set options",e)}},key:null,url:null},[i.K.Matterport]:{class:class MatterportAnalyticsProvider{constructor(e,t,n){this.token=e,this.url=t,this.queue=n,this.options={},this.segmentStylePayload=(e,t,n)=>({timestamp:(0,l.U)(new Date),integrations:{Intercom:!!n},context:this.segmentStyleContext(this.context),properties:t,event:e,messageId:(0,a.D)(),anonymousId:this.anonymousId,type:"track",userId:this.user?this.user.id:null,sentAt:(0,l.U)(new Date)}),this.segmentStyleContext=e=>{const t={page:{path:window.location.pathname,referrer:(0,u.an)(),search:window.location.search,title:window.document.title,url:window.location.href},userAgent:navigator.userAgent,library:{name:"showcase",version:"1"},campaign:{}};return Object.assign(Object.assign({},e),t)};const i=(0,d.fp)(m);if(i)this.anonymousId=i;else{const e=(0,c.$)(p);this.anonymousId=e?e.replace(/%22/g,""):(0,a.D)(),(0,d.m8)(m,this.anonymousId)}this.headers={"X-API-Key":this.token,"Content-Type":"application/json",Accept:"application/json"}}init(e,t){return this.setOptions(e),this.context=t,h.debug("init",{options:this.options,context:this.segmentStyleContext(this.context)}),Promise.resolve()}identify(e){h.debug("identify as",e),this.user=e}track(e,t,n){s.Z.level>=3&&h.debug(e,t?JSON.stringify(t).replace('\\"','"'):t),t=Object.assign(t||{},this.options);const i=this.segmentStylePayload(e,t,n);this.queue.post(this.url,{body:i,headers:this.headers})}trackAsync(e,t,n){if(t=Object.assign(t||{},this.options),navigator.sendBeacon)try{const i=this.segmentStylePayload(e,t,n);navigator.sendBeacon(`${this.url}?api_key=${this.token}`,JSON.stringify(i))}catch(e){h.error("Failed to sendBeacon analytics request")}}setOptions(e){Object.assign(this.options,e)}},key:"analytics_mp_key",url:"analytics_mp_url"}}},80312:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var i=n(67294),s=n(60405);function r(){const{analytics:e}=(0,i.useContext)(s.I);return e}},29782:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Analytics:()=>AnalyticsModule,default:()=>a,useAnalytics:()=>o.z});var i=n(90403),s=n(57227),r=n(81402);class AnalyticsModule extends s.Y{constructor(){super(...arguments),this.name="analytics",this.endpoints=[],this.loaded=!1,this.bufferedData=[],this.options={},this.track=(e,t,n)=>this.loaded?(0,r.gw)(0).then((()=>{this.endpoints.forEach((i=>{i.track(e,t,n)}))})):(this.bufferedData.push({event:e,data:t}),Promise.resolve()),this.trackAsync=(e,t,n)=>{this.loaded?this.endpoints.forEach((i=>{i.trackAsync(e,t,n)})):this.bufferedData.push({event:e,data:t})}}async load(e,t,n,s,r){this.loaded=!1,Object.assign(this.options,n);for(const n of e){const{provider:e,token:o,url:a}=n;if(void 0===i.H[e])continue;const l=new(0,i.H[e].class)(o,a,t);await l.init(this.options,s),r&&r.loggedIn&&l.identify(r),this.endpoints.push(l),this.loaded=!0}return this.loaded&&this.flushBufferedData(),this.loaded}setOptions(e){Object.assign(this.options,e),this.endpoints.forEach((t=>{t.setOptions(e)}))}trackFeatures(...e){this.options.ab_tests||(this.options.ab_tests=[]);const t=this.options.ab_tests;t.push(...e);const n={ab_tests:t};this.endpoints.forEach((e=>{e.setOptions(n)}))}flushBufferedData(){for(const e of this.bufferedData)this.endpoints.forEach((t=>{t.track(e.event,e.data,e.intercom)}));this.bufferedData.length=0}}var o=n(80312);const a=AnalyticsModule},49315:(e,t,n)=>{"use strict";n.d(t,{A:()=>AnnotationsViewData});var i=n(35424),s=n(67779);class AnnotationsViewData extends i.V{constructor(){super(),this.name="annotations-view-data",this.dockedAnnotationObservable=(0,s.Y)(null),this.billboardAnnotationObservable=(0,s.Y)(null),this.billboardSelectedObservable=(0,s.Y)(!1),this.capabilities=new Map}setDockedAnnotation(e,t){const n=e&&t?{id:e,annotationType:t}:null;this.isEqual(n,this.dockedAnnotation)||this.atomic((()=>{this.dockedAnnotationObservable.value=n,n&&this.billboardSelected&&(this.billboardSelectedObservable.value=!1)}))}get dockedAnnotation(){return this.dockedAnnotationObservable.value}setBillboardAnnotation(e,t,n){const i=e&&t?{id:e,annotationType:t}:null;this.atomic((()=>{this.isEqual(i,this.billboardAnnotation)||(this.billboardAnnotationObservable.value=i),void 0===n&&i||(this.billboardSelectedObservable.value=!!n,n&&this.dockedAnnotation&&(this.dockedAnnotationObservable.value=null))}))}get billboardAnnotation(){return this.billboardAnnotationObservable.value}get billboardSelected(){return this.billboardSelectedObservable.value}get selectedAnnotation(){return this.billboardSelected?this.billboardAnnotation:null}updateCapabilities(e,t){this.capabilities.set(e,t)}getCapabilities(e){const t={dock:!0,preview:!0,select:!0};this.capabilities.has(e)||this.capabilities.set(e,t);const n=this.capabilities.get(e)||t;return Object.assign({},n)}isEqual(e,t){return(null==e?void 0:e.id)===(null==t?void 0:t.id)&&(null==e?void 0:e.annotationType)===(null==t?void 0:t.annotationType)}}},18236:(e,t,n)=>{"use strict";n.d(t,{bd:()=>DockAnnotationCommand,oM:()=>SelectAnnotationCommand,Kw:()=>PreviewAnnotationCommand,G5:()=>CloseBillboardCommand,yL:()=>CloseOtherAnnotationsCommand,Aj:()=>CloseAnnotationCommand});var i=n(93037);class DockAnnotationCommand extends i.m{constructor(e,t){super(),this.payload={id:e,annotationType:t}}}class SelectAnnotationCommand extends i.m{constructor(e,t){super(),this.payload={id:e,annotationType:t}}}class PreviewAnnotationCommand extends i.m{constructor(e,t){super(),this.payload={id:e,annotationType:t}}}class CloseBillboardCommand extends i.m{}class CloseOtherAnnotationsCommand extends i.m{constructor(e,t){super(),this.payload={exceptType:e,exceptId:t}}}class CloseAnnotationCommand extends i.m{constructor(e,t){super(),this.payload={id:e,annotationType:t}}}},47357:(e,t,n)=>{"use strict";var i;n.d(t,{J:()=>i}),function(e){e.NOTE="note",e.TAG="tag",e.OBJECT="object"}(i||(i={}))},38117:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AnnotationAttachmentClickedMessage:()=>o.qk,AnnotationBlockClickedMessage:()=>o.iP,AnnotationClosedMessage:()=>o.Ps,AnnotationOpeningMessage:()=>o.do,AnnotationType:()=>c.J,AnnotationsViewData:()=>a.A,CloseAnnotationCommand:()=>l.Aj,CloseBillboardCommand:()=>l.G5,CloseOtherAnnotationsCommand:()=>l.yL,DockAnnotationCommand:()=>l.bd,PreviewAnnotationCommand:()=>l.Kw,SelectAnnotationCommand:()=>l.oM,default:()=>d});var i=n(57227),s=n(68168),r=n(9986),o=n(50566),a=n(49315),l=n(18236);class AnnotationsModule extends i.Y{constructor(){super(...arguments),this.name="annotations",this.handleDockAnnotation=async e=>{const t=this.viewData,{dockedAnnotation:n}=t,{id:i,annotationType:s}=e;this.viewData.getCapabilities(i).dock&&((null==n?void 0:n.id)!==i||(null==n?void 0:n.annotationType)!==s?(this.engine.broadcast(new o.do(s,i,!0)),t.atomic((()=>{t.setDockedAnnotation(i,s),t.setBillboardAnnotation(null)})),this.sendDockToggledMessage(!0)):this.log.debug("Annotation is already docked"))},this.handleSelectAnnotation=async e=>{const t=this.viewData,{dockedAnnotation:n,billboardAnnotation:i,billboardSelected:s}=t,{id:r,annotationType:a}=e;this.viewData.getCapabilities(r).select&&(s&&(null==i?void 0:i.id)===r&&(null==i?void 0:i.annotationType)===a?this.log.debug("Annotation is already selected"):(s||this.engine.broadcast(new o.do(a,r,!1)),t.atomic((()=>{t.setBillboardAnnotation(r,a,!0),t.setDockedAnnotation(null)})),n&&this.sendDockToggledMessage(!1)))},this.handlePreviewAnnotation=async e=>{this.viewData.getCapabilities(e.id).preview&&this.viewData.setBillboardAnnotation(e.id,e.annotationType,!1)},this.handleCloseBillboard=async()=>{const e=this.viewData,{billboardAnnotation:t}=e;t&&(e.setBillboardAnnotation(null),this.engine.broadcast(new o.Ps(t.annotationType,t.id)))},this.handleClosingOtherAnnotations=async e=>{const{exceptType:t,exceptId:n}=e;this.closeOtherAnnotations(t,n)},this.closeOtherAnnotations=(e,t)=>{const n=this.viewData,{billboardAnnotation:i,dockedAnnotation:s}=n,r=i&&!this.isMatchingAnnotation(i,e,t),a=s&&!this.isMatchingAnnotation(s,e,t);n.atomic((()=>{i&&r&&(n.setBillboardAnnotation(null),this.engine.broadcast(new o.Ps(i.annotationType,i.id))),s&&a&&(n.setDockedAnnotation(null),this.sendDockToggledMessage(!1),this.engine.broadcast(new o.Ps(s.annotationType,s.id)))}))},this.handleCloseAnnotation=async e=>{const t=this.viewData,{billboardAnnotation:n,dockedAnnotation:i}=t,{id:s,annotationType:r}=e;let a=!1;t.atomic((()=>{s===(null==n?void 0:n.id)&&r===(null==n?void 0:n.annotationType)&&(t.setBillboardAnnotation(null),a=!0),s===(null==i?void 0:i.id)&&r===(null==i?void 0:i.annotationType)&&(t.setDockedAnnotation(null),this.sendDockToggledMessage(!1),a=!0)})),a&&this.engine.broadcast(new o.Ps(r,s))}}async init(e,t){this.viewData=new a.A,this.engine=t,this.applicationData=await t.market.waitForData(r.pu),this.bindings.push(t.commandBinder.addBinding(l.bd,this.handleDockAnnotation),t.commandBinder.addBinding(l.oM,this.handleSelectAnnotation),t.commandBinder.addBinding(l.Kw,this.handlePreviewAnnotation),t.commandBinder.addBinding(l.Aj,this.handleCloseAnnotation),t.commandBinder.addBinding(l.G5,this.handleCloseBillboard),t.commandBinder.addBinding(l.yL,this.handleClosingOtherAnnotations),this.applicationData.onPropertyChanged("application",this.closeOtherAnnotations)),t.market.register(this,a.A,this.viewData)}dispose(e){this.bindings.forEach((e=>{e.cancel()})),this.bindings=[],super.dispose(e)}onUpdate(){}isMatchingAnnotation(e,t,n){return!(!n&&!t)&&((!n||n===e.id)&&(!t||t===e.annotationType))}sendDockToggledMessage(e){e?this.engine.broadcast(new s.ro):this.engine.broadcast(new s.A)}}var c=n(47357);const d=AnnotationsModule},50566:(e,t,n)=>{"use strict";n.d(t,{do:()=>AnnotationOpeningMessage,Ps:()=>AnnotationClosedMessage,qk:()=>AnnotationAttachmentClickedMessage,iP:()=>AnnotationBlockClickedMessage});var i=n(4117);class AnnotationOpeningMessage extends i.v{constructor(e,t,n){super(),this.annotationType=e,this.id=t,this.docked=n}}class AnnotationClosedMessage extends i.v{constructor(e,t){super(),this.annotationType=e,this.id=t}}class AnnotationAttachmentClickedMessage extends i.v{constructor(e,t,n){super(),this.annotationType=e,this.id=t,this.attachmentId=n}}class AnnotationBlockClickedMessage extends i.v{constructor(e,t,n){super(),this.block=n,this.id=t,this.annotationType=e}}},13912:(e,t,n)=>{"use strict";n.d(t,{C:()=>r,K:()=>o});var i=n(47357);function s(e,t){return t===e.getCurrentUserId()}function r(e,t,n){if(t===i.J.NOTE){return e.isCommenter()&&!!n&&s(e,n.id)}return e.isEditor()}function o(e,t,n){if(t===i.J.NOTE){return e.isCommenter()&&!!n&&s(e,n.id)||e.isOrgAdmin()}return e.isEditor()}},76092:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i}),function(e){e.ACCESS_TOKEN_REQUIRED="object.access.token.required",e.FORBIDDEN="spaces.public.access.password.forbidden",e.INVALID_PASSWORD="spaces.public.access.invalid_password",e.TOO_MANY_ATTEMPTS="spaces.public.access.too_many_attempts",e.UNAUTHORIZED="user.unauthorized",e.NOT_FOUND="not.found",e.PASSWORD_REQUIRED="model.unauthorized"}(i||(i={}))},93487:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e.INVALID_CREDENTIALS="invalidcredentials",e.TOO_MANY_ATTEMPTS="toomanyattempts",e.UNKNOWN="unknown"}(i||(i={}))},83711:(e,t,n)=>{"use strict";n.d(t,{r:()=>MpModelTokenAuthentication});var i=n(87100);class MpModelTokenAuthentication{constructor(){const e=(0,i.eY)("auth","");this.authenticate(e)}isAuthenticated(){return!!MpModelTokenAuthentication.token}authenticate(e){return!(!e||"string"!=typeof e)&&(MpModelTokenAuthentication.token=e.replace(","," "),!0)}getAuthorizationHeader(){return MpModelTokenAuthentication.token?MpModelTokenAuthentication.token:""}}},95430:(e,t,n)=>{"use strict";n.d(t,{L:()=>MpPasswordAuthentication});var i=n(5477),s=n(93487),r=n(76092),o=n(78804);const a=new i.Z("mp-password-authentication");class MpPasswordAuthentication{constructor(e=window.location.origin){this.baseUrl=e,this.errorType=s.s.UNKNOWN}async authenticate(e,t){if(!e.match(/[a-zA-Z0-9]+/))return a.error(`Invalid Model ID ${e}`),!1;const n=`${window.location.origin}${window.location.pathname}/api/v2/models/${e}/public-access/`;return this.fetchToken(n,t).then((async e=>{let t={};return e&&(t=await e.json(),e.ok&&t.token)?(this.login(t.token),!0):(this.errorType=MpPasswordAuthentication.getErrorType(t.code),this.logout(),!1)}))}isAuthenticated(){return void 0!==MpPasswordAuthentication.token}login(e){MpPasswordAuthentication.token=e}logout(){MpPasswordAuthentication.token=void 0}getAuthorizationHeader(){return MpPasswordAuthentication.token?`Matterport-Object-Access ${MpPasswordAuthentication.token}`:""}async fetchToken(e,t){const n=JSON.stringify({password:t}),i={"Content-Type":"application/json"};return(0,o.m)(e,i),fetch(e,{method:"GET",cache:"no-cache",headers:i,body:n})}static getErrorType(e){switch(e){case r.X.TOO_MANY_ATTEMPTS:return s.s.TOO_MANY_ATTEMPTS;case r.X.INVALID_PASSWORD:return s.s.INVALID_CREDENTIALS}return s.s.UNKNOWN}}},81052:(e,t,n)=>{"use strict";n.d(t,{w:()=>MpSdkAuthentication});class MpSdkAuthentication{static setToken(e){MpSdkAuthentication.token="Bearer "+e}isAuthenticated(){return!!MpSdkAuthentication.token}authenticate(e){return!(!e||"string"!=typeof e)}getAuthorizationHeader(){return MpSdkAuthentication.token?MpSdkAuthentication.token:""}}},36407:(e,t,n)=>{"use strict";var i,s;n.d(t,{SL:()=>i,AB:()=>s,eE:()=>r,Qf:()=>o}),function(e){e.BASE="base",e.STANDARD="standard",e.HIGH="high",e.ULTRAHIGH="ultrahigh"}(i||(i={})),function(e){e[e.BASE=512]="BASE",e[e.STANDARD=1024]="STANDARD",e[e.HIGH=2048]="HIGH",e[e.ULTRAHIGH=4096]="ULTRAHIGH"}(s||(s={}));const r={[i.BASE]:s.BASE,[i.STANDARD]:s.STANDARD,[i.HIGH]:s.HIGH,[i.ULTRAHIGH]:s.ULTRAHIGH},o={[s.BASE]:i.BASE,[s.STANDARD]:i.STANDARD,[s.HIGH]:i.HIGH,[s.ULTRAHIGH]:i.ULTRAHIGH}},98383:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var i=n(95891),s=n(18050);const r={0:i.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_Y,1:i.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_Z,2:i.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_X,3:i.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z,4:i.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_X,5:i.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y},o=e=>{if(e<0||e>5)throw new s.Z("mapFaceToCubemapFace() -> face must be in the range [0, 5]");return r[e]}},8428:(e,t,n)=>{"use strict";n.d(t,{af:()=>PlayerOptionsData,gx:()=>i});var i,s=n(35424),r=n(98254),o=n(95655),a=n(93510),l=n(11620);class PlayerOptionsData extends s.V{constructor(e={}){super(),this.name="player-options",this.options=new PlayerOptions(e)}resetDefaultTourOptions(){this.options.fast_transitions=l.LI,this.options.transition_speed=l.p$,this.options.transition_time=l.rd,this.options.pan_speed=l.tu,this.options.dollhouse_pan_speed=l.nr,this.options.zoom_duration=l.we,this.options.pan_angle=l.Cj,this.options.pan_direction=l.y6,this.options.commit()}}class PlayerOptions extends r.T{constructor(e){super(),this.presented_by=!1,this.highlight_reel=!0,this.floor_plan=!0,this.tour_buttons=!0,this.labels=!0,this.labels_dh=!0,this.floor_select=!0,this.space_search=!0,this.measurements=!0,this.measurements_saved=!0,this.dollhouse=!0,this.contact_email=!1,this.address=!1,this.contact_name=!1,this.model_summary=!1,this.contact_phone=!1,this.model_name=!1,this.external_url=!1,this.unit_type=a.M.IMPERIAL,this.background_color=o.z.default,this.fast_transitions=l.LI,this.transition_speed=l.p$,this.transition_time=l.rd,this.pan_speed=l.tu,this.dollhouse_pan_speed=l.nr,this.zoom_duration=l.we,this.pan_angle=l.Cj,this.pan_direction=l.y6,e&&this.copy(e)}copy(e){this.presented_by=!!e.presented_by,this.highlight_reel=!!e.highlight_reel,this.floor_plan=!!e.floor_plan,this.tour_buttons=!!e.tour_buttons,this.labels=!!e.labels,this.space_search=!!e.space_search,this.dollhouse=!!e.dollhouse,this.fast_transitions=!!e.fast_transitions,this.contact_email=!!e.contact_email,this.address=!!e.address,this.contact_name=!!e.contact_name,this.model_summary=!!e.model_summary,this.contact_phone=!!e.contact_phone,this.model_name=!!e.model_name,this.external_url=!!e.external_url,void 0!==e.measurements&&(this.measurements=e.measurements),void 0!==e.labels_dh&&(this.labels_dh=e.labels_dh),void 0!==e.floor_select&&(this.floor_select=e.floor_select),void 0!==e.measurements_saved&&(this.measurements_saved=e.measurements_saved),void 0!==e.unit_type&&(this.unit_type=e.unit_type),void 0!==e.background_color&&void 0!==o.z[e.background_color]&&(this.background_color=e.background_color),void 0!==e.transition_speed&&(this.transition_speed=e.transition_speed),void 0!==e.transition_time&&(this.transition_time=e.transition_time),void 0!==e.pan_speed&&(this.pan_speed=e.pan_speed),void 0!==e.dollhouse_pan_speed&&(this.dollhouse_pan_speed=e.dollhouse_pan_speed),void 0!==e.zoom_duration&&(this.zoom_duration=e.zoom_duration),void 0!==e.pan_angle&&(this.pan_angle=e.pan_angle),void 0!==e.pan_direction&&(this.pan_direction=e.pan_direction)}}!function(e){e.PresentedBy="presented_by",e.HighlightReel="highlight_reel",e.FloorPlan="floor_plan",e.TourButtons="tour_buttons",e.Labels="labels",e.LabelsDollhouse="labels_dh",e.Measurements="measurements",e.FloorSelect="floor_select",e.SavedMeasurements="measurements_saved",e.Dollhouse="dollhouse",e.InstantTransitions="fast_transitions",e.TransitionSpeed="transition_speed",e.TransitionTime="transition_time",e.PanSpeed="pan_speed",e.DollhousePanSpeed="dollhouse_pan_speed",e.ZoomDuration="zoom_duration",e.PanAngle="pan_angle",e.PanDirection="pan_direction",e.Units="unit_type",e.DetailsEmail="contact_email",e.DetailsAddress="address",e.DetailsName="contact_name",e.DetailsSummary="model_summary",e.DetailsPhone="contact_phone",e.DetailsModelName="model_name",e.DetailsExternalUrl="external_url",e.BackgroundColor="background_color",e.SpaceSearch="space_search"}(i||(i={}))},87393:(e,t,n)=>{"use strict";n.d(t,{Z:()=>SweepTextureLoader});var i=n(2212),s=n(5477),r=n(36407),o=n(81402);const a=new s.Z("api"),l={[r.SL.BASE]:256,[r.SL.STANDARD]:1024,[r.SL.HIGH]:2048,[r.SL.ULTRAHIGH]:4096};class SweepTextureLoader{constructor(e){this.urls=e,this.sweepCubeTextures={}}useTexture(e){const t=this.getTexture(e);if(!t)throw Error("Texture for sweep not loaded before using");return t}loadFace(e,t,n,s){return this.loadFaceImage(e,t,n,s).then((e=>{const t=new i.Texture(e);return t.needsUpdate=!0,t}))}load(e,t=r.SL.STANDARD){const n=this.sweepCubeTextures[e.id];if(n)return a.debug("Skipping load of pano, already loaded"),new Promise((function(e,t){e(n)}));const s=[2,4,0,5,1,3].map((n=>this.loadFaceImage(e,t,n))),o=Promise.all(s).then((t=>{const n=new i.CubeTexture(t);return n.flipY=!1,n.needsUpdate=!0,this.sweepCubeTextures[e.id]=n,n}));return o.catch((()=>{a.error(`Downloading cubemap for pano ${e.id} failed`)})),o}unload(e){var t;const n=this.sweepCubeTextures[e];if(!n)throw Error("Texture for sweep not loaded before unloading");n.dispose(),null===(t=n.images)||void 0===t||t.forEach((e=>{var t,n;null===(n=(t=e).close)||void 0===n||n.call(t)})),this.sweepCubeTextures[e]=null}unloadAll(e){const t=(0,o.ow)(e);for(const e of Object.keys(this.sweepCubeTextures))this.sweepCubeTextures[e]&&!t[e]&&this.unload(e)}async loadFaceImage(e,t,n,i){const s=l[t],r=await e.getFaceUrl(t,n);return this.urls.getImageBitmap(r,s,s,i)}getTexture(e){return this.sweepCubeTextures[e]}}},95655:(e,t,n)=>{"use strict";n.d(t,{K:()=>s,z:()=>r});const i={bgPrimary:"#0F1011",bgSecondary:"#1e2023",gridPrimary:"#2d3035",gridSecondary:"#171a1c"},s={black:i,grey:{bgPrimary:"#c9cbcc",bgSecondary:"#9d9d9e",gridPrimary:"#c9cbcc",gridSecondary:"#b0b1b1"},white:{bgPrimary:"#fcfdff",bgSecondary:"#ced0d3",gridPrimary:"#fcfdff",gridSecondary:"#e2e3e5"},default:i};var r;!function(e){e.black="black",e.grey="grey",e.white="white",e.default="black"}(r||(r={}))},90237:(e,t,n)=>{"use strict";n.d(t,{GT:()=>UnauthorizedException,V2:()=>ForbiddenException,TR:()=>NotFoundException});var i=n(40603);class ApiException extends i.y{constructor(e="Api Exception"){super(e),this.name="ApiException"}}class UnauthorizedException extends ApiException{constructor(e="Unauthorized"){super(e),this.name="Unauthorized"}}class ForbiddenException extends ApiException{constructor(e="Forbidden"){super(e),this.name="Forbidden"}}class NotFoundException extends ApiException{constructor(e="Not Found"){super(e),this.name="NotFound"}}},63408:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(17403);async function s(e){return e.get("https://static.matterport.com/geoip/",{responseType:"json",priority:i.RequestPriority.LOW})}},76576:(e,t,n)=>{"use strict";n.d(t,{P8:()=>r,gM:()=>o,PT:()=>a});var i=n(92280);let s=null;const r=e=>{s=e},o=()=>s,a=(e,t)=>(s&&(0,i.S)(e)&&(t["x-matterport-application-key"]=s),t)},93287:(e,t,n)=>{"use strict";n.d(t,{l:()=>r,I:()=>o});var i=n(92280);let s=null;const r=e=>{s=e},o=(e,t)=>(s&&(0,i.S)(e)&&(t["x-matterport-application-name"]=s),t)},74372:(e,t,n)=>{"use strict";n.d(t,{t:()=>r,X:()=>o});var i=n(92280);let s=null;const r=e=>{s=e},o=(e,t)=>(s&&(0,i.S)(e)&&(t["x-matterport-application-version"]=s),t)},78804:(e,t,n)=>{"use strict";n.d(t,{m:()=>h});var i=n(93287),s=n(74372),r=n(76576),o=n(95430),a=n(83711),l=n(81052);const c=[new a.r,new l.w,new o.L];var d=n(92280);const u=[(e,t,n=c)=>{const i=n.map((e=>e.getAuthorizationHeader())).find(Boolean);return i&&(0,d.S)(e)&&(t.authorization=i),t},i.I,s.X,r.PT],h=(e,t,n=u)=>(n.forEach((n=>n(e,t))),t)},92280:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});const i=["matterport.com","matterportvr.cn","localhost"],s=["/api/"],r=e=>{let t;try{t=new URL(e.toLowerCase())}catch(e){return!1}const{hostname:n,pathname:r}=t,o=i.some((e=>n===e||n.endsWith(`.${e}`))),a=s.some((e=>r.startsWith(e)));return o&&a}},13350:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ApiClient});var i=n(5477),s=n(17403),r=n(76092),o=n(90237);class Organization{constructor(e){this.blurEnabled=!1,e&&Object.assign(this,e)}}var a,l=n(63408),c=n(87100);!function(e){e.USER="user",e.ADMIN="admin"}(a||(a={}));class User{constructor(e){this.loggedIn=!1,this.flags=new Set,this.memberships=[],e&&Object.assign(this,e)}getFlags(e=""){if(this.memberships){const e=(0,c.eY)("organization","");for(const t of this.memberships)if(""===e||t.organizationId===e)for(const e of t.flags)this.flags.add(e)}const t=new Set;return this.flags.forEach((n=>{if(0===n.indexOf(e)){const i=n.replace(e,"");t.add(i)}})),t}hasFlag(e,t="showcase"){return this.getFlags().has(`${t}/${e}`)}isOrganizationAdmin(e){const t=this.getMembership(e);return!!(null==t?void 0:t.roles.includes(a.ADMIN))}getMembershipFlags(e){const t=this.getMembership(e);return t?t.flags:[]}getMembership(e){return this.memberships.find((t=>t.organizationId===e))}hasMembershipFlag(e,t){return this.getMembershipFlags(e).includes(t)}getMembershipFeature(e,t){const n=this.getMembership(e);return(null==n?void 0:n.features[t])||!1}hasMembership(e){return this.memberships.some((t=>t.organizationId===e))}}class Membership{constructor(e){this.features={},e&&Object.assign(this,e)}}var d=n(16752);const u=new i.Z("user.serializers");function h(e,t="3.1.69.3-0-g204b0700e6"){const n=[];for(let i of e){const e=i.match(/^.*\-(\d+(?:\.\d+)*)$/);if(e&&e[1]){if(i=i.replace(/-(\d+(?:\.\d+)*)$/,""),d.o.lt(t,e[1])){u.debug(`Dropping feature flag ${i}, version >= ${e[1]} required`);continue}u.debug(`Enabled versioned feature flag ${i}`)}n.push(i)}return n}var p=n(78804),m=n(2252);const f=new i.Z("ImageBitmapSupport"),g=(0,c.eY)("imageBitmap",null);let v=null;function y(){return"1"===g||(null===v&&function(){if(v=!1,(0,m.vU)()){const e=(0,m.rI)();e.major<=95&&(f.error(`Firefox/${e.major} issue, Disabling ImageBitmap support, upgrade to 96 for better performance.`),v=!0)}}(),!v&&("createImageBitmap"in window?"0"!==g:"1"===g))}var b=n(83711),S=n(5673),E=n(66225),T=n(91985),w=n(54929);class IndividualQueryCache{constructor(e,t,n){this.query=e,this.variables=t,this.response=n}read(e,t,n){return e!==this.query||(0,w.NK)(t,this.variables)?Promise.resolve(void 0):Promise.resolve(this.response)}}const x=new i.Z("api"),_=Object.freeze({cacheClearTimeout:6e4});class Api{constructor(e=new s.RequestQueue,t=new s.RequestQueue,n={},i=window.location.origin){this.apiQueue=e,this.storeQueue=t,this.prefetchedData=n,this.baseUrl=i,this._configCache={},this._userCache={},this._organizationCache={},setTimeout((()=>{this.prefetchedData={}}),_.cacheClearTimeout)}async init(e){const t=[this.getUser().then((e=>this.user=e))];e&&t.push(this.getConfigs(e)),await Promise.all(t)}getOnStoreQueue(e,t={}){return this.get(e,t,this.storeQueue)}get(e,t={},n=this.apiQueue){const{headers:i={},prefetchFrom:s}=t;return s&&this.prefetchedData[s]?Promise.resolve(this.prefetchedData[s]):(t.headers=(0,p.m)(e,i),n.get(e,t).then((e=>{if(null===e)throw Error("Data from get was null, possibly unparsable JSON");return e})))}getImage(e,t){return this.getOnStoreQueue(e,Object.assign(Object.assign({},t),{responseType:"image"}))}async getImageBitmap(e,t,n,i={}){if(y()){const s=-1!==e.indexOf("?"),r=e+(s?"&":"?")+"imgopt=1",o=await this.getOnStoreQueue(r,Object.assign(Object.assign({},i),{responseType:"blob"}));return createImageBitmap(o,0,0,t,n,{imageOrientation:i.flipY?"flipY":"none"})}return this.getImage(e,i)}async getConfigs(e,t){if(e=e.toLowerCase(),!t&&this._configCache[e])return this._configCache[e];const n=t?{responseType:"json"}:{responseType:"json",prefetchFrom:"config"};let i={};const s=this.baseUrl+`/api/v1/config/${e}`;try{i=await this.get(s,n)}catch(e){x.warn(`Failed to load config from ${s}, ignoring`)}return t||(this._configCache[e]=i),i||{}}async getAppKey(e,t,n){if(""===e||""===t)return null;const i=await this.getConfigs(e,n);return i.hasOwnProperty(t)?i[t]:null}async getGeoIpLocation(){return(0,l.Z)(this.apiQueue)}async modelIsAccessible(e){var t,n;const i=await this.modelQuery(e);if((null===(n=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.id)!==e)throw new o.V2("Access denied (403)")}async modelExists(e,t={ignorePrefetch:!1}){var n,i,s,a,l,c,d,u,h;const{ignorePrefetch:p}=t;if(!p&&this.prefetchedData&&this.prefetchedData.model){const{model:t,queries:c}=this.prefetchedData,d=null===(i=null===(n=null==c?void 0:c.GetModelPrefetch)||void 0===n?void 0:n.data)||void 0===i?void 0:i.model;if(!(null==d?void 0:d.id)&&t.has_public_access_password)throw new o.GT("Model requires a password");if(!(new b.r).isAuthenticated()){const t=null===(a=null===(s=null==c?void 0:c.GetModelPrefetch)||void 0===s?void 0:s.errors)||void 0===a?void 0:a.find((e=>"model"===(null==e?void 0:e.path[0])));if((null===(l=null==t?void 0:t.extensions)||void 0===l?void 0:l.code)===r.X.NOT_FOUND)throw new o.TR("Model not found (404)");if(d&&(null==d?void 0:d.id)!==e)throw new o.V2("Access denied (403)")}}const m=await this.modelQuery(e);if(null===(c=m.errors)||void 0===c?void 0:c.length){switch(null===(d=m.errors[0].extensions)||void 0===d?void 0:d.code){case r.X.PASSWORD_REQUIRED:throw new o.GT("Access token required (401)");case r.X.NOT_FOUND:throw new o.TR("Model not found (404)");default:throw new o.V2("Access denied (403)")}}else if((null===(h=null===(u=m.data)||void 0===u?void 0:u.model)||void 0===h?void 0:h.id)!==e)throw new o.V2("Access denied (403)")}async getOrganization(e){if(e in this._organizationCache)return this._organizationCache[e];const t=`${window.location.origin}${window.location.pathname}/api/v2/organizations/${e}`,n=await this.get(t,{responseType:"json"}).catch((e=>{x.error(e)}));let i=null;return n&&(i=new Organization({id:n.sid,name:n.company_name||"",blurEnabled:!!n.manual_blur})),this._organizationCache[e]=i,i}async getUser(e){if(e&&e in this._userCache)return this._userCache[e];const t=`${window.location.origin}${window.location.pathname}/api/v2/users/${e||"current"}`,n=function(e){if(!e)return new User;const t=(e.memberships||[]).map((t=>new Membership({userId:e.user_sid,organizationId:t.organization_sid,name:t.name,flags:h(t.flags||[]),roles:t.roles||[],features:t.features||{}})));return new User({id:e.user_sid,firstName:e.first_name,lastName:e.last_name,email:e.email,loggedIn:e.is_authenticated,flags:new Set(h(e.flags)),memberships:t})}(await this.get(t,{responseType:"json"}).catch((e=>{x.error(e)})));return n.id&&(this._userCache[n.id]=n),n}async modelQuery(e){const t={modelId:e},n=new S.w({baseUrl:this.baseUrl}),i=await n.query(T.GetModelDetails,t),s=(i.errors||[]).filter((e=>{var t;return 1===(null===(t=e.path)||void 0===t?void 0:t.length)&&"model"===e.path[0]}));return 0===s.length&&(this.modelDetailCache&&E.u.removeSharedCache(this.modelDetailCache),this.modelDetailCache=new IndividualQueryCache(T.GetModelDetails,t,i),E.u.addSharedCache(this.modelDetailCache)),{data:i.data,errors:s}}}var M=n(57227);class ApiClient extends M.Y{constructor(){super(...arguments),this.name="api-client"}async init(e,t){this.api=new Api(e.apiQueue,e.storeQueue,e.prefetchedData,e.baseUrl),await this.api.init(e.preloadConfig)}getApi(){return this.api}}},11620:(e,t,n)=>{"use strict";n.d(t,{gj:()=>r,LI:()=>o,p$:()=>a,rd:()=>l,tu:()=>c,nr:()=>d,we:()=>u,Cj:()=>h,y6:()=>p});var i=n(84347),s=n(77866);const r="TransitionType",o=!0,a=s.Mk,l=s.mL,c=s.pn,d=s.su,u=s._c,h=s.BA,p=i.kw.Auto},67731:(e,t,n)=>{"use strict";n.d(t,{P:()=>Attachment});var i=n(98254),s=n(9042),r=n(48452);class Attachment extends i.T{constructor(e){super(),this.category=s.G.EXTERNAL,this.mediaType=r.DD.IMAGE,this.mimeType="",this.src="",this.height=0,this.width=0,e&&Object.assign(this,e)}copy(e){return this.id=e.id,this.src=e.src,this.url=e.url,this.thumbnailUrl=e.thumbnailUrl,this.height=e.height,this.width=e.width,this.created=e.created,this.category=e.category,this.mediaType=e.mediaType,this.parentId=e.parentId||"",this.parentType=e.parentType,this.filename=e.filename,this.bytes=e.bytes,this.mimeType=e.mimeType||"",this}}},4752:(e,t,n)=>{"use strict";n.d(t,{b:()=>AttachmentsData});var i=n(35424),s=n(66910),r=n(67731);class AttachmentsData extends i.V{constructor(){super(),this.name="attachments-data",this.pendingAttachments=(0,s.q)(),this.removedAttachments=(0,s.q)(),this.currentUploads=(0,s.q)(),this.failedUploads=(0,s.q)()}iteratePending(e){for(const t of this.pendingAttachments)e(t)}iterateRemoved(e){for(const t of this.removedAttachments)e(t)}get pendings(){return this.pendingAttachments}get removals(){return this.removedAttachments}getPendingAttachment(e){return this.pendingAttachments.get(e)}getRemovedAttachment(e){return this.removedAttachments.get(e)}addPending(e){this.pendingAttachments.set(e.id,e)}removePendingAttachment(e){this.pendingAttachments.has(e)&&this.pendingAttachments.delete(e)}clearPending(){this.pendingAttachments.clear()}getPendingAttachmentsForAsset(e,t){const n=[];return this.iteratePending((i=>{i.parentType===t&&i.parentId===e&&n.push(i)})),n}getRemovedAttachmentsForAsset(e,t){const n=[];return this.iterateRemoved((i=>{i.parentType===t&&i.parentId===e&&n.push(i)})),n}markAttachmentForDelete(e){const t=new r.P(e);this.removedAttachments.set(t.id,t)}clearRemovals(){this.removedAttachments.clear()}get uploads(){return this.currentUploads}addUpload(e){this.uploads.set(e.id,e)}removeUpload(e){this.uploads.has(e)&&this.uploads.delete(e)}clearUploads(){this.uploads.clear()}get failures(){return this.failedUploads}addFailure(e){this.failures.set(e.id,e)}removeFailure(e){this.failures.has(e)&&this.failures.delete(e)}clearFailures(){this.failures.clear()}}},87443:(e,t,n)=>{"use strict";n.d(t,{wu:()=>EmbedMediaCommand,st:()=>LoadEmbeddedMediaCommand,It:()=>UploadAttachmentsCommand,iu:()=>ConfirmAttachmentChangesCommand,Ze:()=>CancelAttachmentChangesCommand,x9:()=>ResetAttachmentChangesCommand,xW:()=>AttachmentViewerCommand,$T:()=>RemoveAttachmentCommand,Rh:()=>RemoveFailureCommand});var i=n(93037);class EmbedMediaCommand extends i.m{constructor(e,t,n){super(),this.id="EMBED_MEDIA",this.payload={parentId:e,parentType:t,src:n}}}class LoadEmbeddedMediaCommand extends i.m{constructor(e){super(),this.id="LOAD_ATTACHMENT_EMBED",this.payload={attachment:e}}}class UploadAttachmentsCommand extends i.m{constructor(e,t,n){super(),this.id="UPLOAD_ATTACHMENTS",this.payload={parentId:e,parentType:t,files:n}}}class ConfirmAttachmentChangesCommand extends i.m{constructor(e,t,n){super(),this.id="CONFIRM_ATTACHMENT_CHANGES",this.payload={parentId:e,parentType:t,prevParentId:n}}}class CancelAttachmentChangesCommand extends i.m{constructor(){super(...arguments),this.id="CANCEL_ATTACHMENT_CHANGES"}}class ResetAttachmentChangesCommand extends i.m{constructor(){super()}}class AttachmentViewerCommand extends i.m{constructor(e,t,n){super(),this.payload={open:e,attachments:t,attachmentId:n}}}class RemoveAttachmentCommand extends i.m{constructor(e){super(),this.id="ATTACHMENT_REMOVE",this.payload={attachment:e}}}class RemoveFailureCommand extends i.m{constructor(e){super(),this.id="ATTACHMENT_REMOVE_FAILED_UPLOAD",this.payload={id:e}}}},48452:(e,t,n)=>{"use strict";var i,s,r;n.d(t,{kV:()=>i,_V:()=>s,DD:()=>r}),function(e){e.FILE_TOO_LARGE="oversize",e.EMPTY_FILE="empty",e.OVER_QUOTA="overQuota",e.UPLOAD_FAILED="failed",e.PERMISSION_DENIED="permission"}(i||(i={})),function(e){e.EMBED_FAIL="embedFail",e.EMBED_SUCCESS="success"}(s||(s={})),function(e){e.IMAGE="image",e.PDF="pdf",e.VIDEO="video",e.RICH="rich",e.ZIP="zip",e.TEXT="text",e.AUDIO="audio",e.MODEL="model",e.APPLICATION="application"}(r||(r={}))},24849:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Attachment:()=>o.P,AttachmentCategory:()=>a.G,AttachmentEmbedStatus:()=>l._V,AttachmentUploadDoneMessage:()=>c.RE,AttachmentUploadError:()=>l.kV,AttachmentUploadProgressMessage:()=>c.Vj,AttachmentViewerCommand:()=>_.xW,AttachmentsData:()=>x.b,AttachmentsStore:()=>AttachmentsStore,CancelAttachmentChangesCommand:()=>_.Ze,CloseAttachmentViewerMessage:()=>c.Rd,ConfirmAttachmentChangesCommand:()=>_.iu,EmbedMediaCommand:()=>_.wu,EmbeddingDoneMessage:()=>c.v8,ExternalAttachmentDeserializer:()=>m.d,ExternalAttachmentSerializer:()=>ExternalAttachmentSerializer,FileAttachmentDeserializer:()=>f.O,FileAttachmentStorage:()=>FileAttachmentStorage,FileUploadDeserializer:()=>FileUploadDeserializer,FileUploadSerializer:()=>FileUploadSerializer,LoadEmbeddedMediaCommand:()=>_.st,MediaType:()=>l.DD,RemoveAttachmentCommand:()=>_.$T,RemoveFailureCommand:()=>_.Rh,ResetAttachmentChangesCommand:()=>_.x9,UploadAttachmentsCommand:()=>_.It,ViewAttachmentsMessage:()=>c.O,default:()=>N});var i=n(57227),s=n(89142),r=n(22026),o=n(67731),a=n(9042),l=n(48452),c=n(96372),d=n(66225),u=n(38636),h=n(5477),p=n(85553);class ExternalAttachmentSerializer{constructor(){this.getAttachmentDetails=e=>e.mediaType?{mediaType:(0,p.m)(e.mediaType),srcUrl:e.src,thumbnailUrl:e.src,width:e.width,height:e.height}:null,this.validate=e=>!!e&&void 0!==e.mediaType}serialize(e){const t=this.getAttachmentDetails(e);return t&&this.validate(t)?t:null}}var m=n(15878),f=n(96294),g=n(70129),v=n(98443);const y=new h.Z("AttachmentsStore");class AttachmentsStore extends d.u{constructor(e){super(e),this.embedSerializer=new ExternalAttachmentSerializer,this.embedDeserializer=new m.d,this.fileDeserializer=new f.O}create(e){if(0===e.length)return Promise.resolve(null);const t=e[0].parentId,n=e[0].parentType;if(e.find((e=>e.parentId!==t||e.parentType!==n)))throw new Error("Cannot attach to different parents in one request");const i=this.getViewId(),s=[],o=[];let l,c;if(e.forEach((e=>{if(e.category===a.G.EXTERNAL){const t=this.embedSerializer.serialize(e);if(!t)throw y.error("Failure attaching external attachment:",e),new Error("Could not attach External Attachment");s.push(t)}else e.category===a.G.UPLOAD&&o.push(e.id)})),n!==r.u.COMMENT)throw new Error(`Cannot attach to attachment to a ${n}`);return l=g.AddCommentAttachments,c="addCommentAttachments",this.mutate(l,{modelId:i,parentId:t,externalAttachments:s,fileAttachments:o}).then((e=>{const t=[],n=(0,u.q)(e,`data.${c}.externalAttachments`);if(n&&Array.isArray(n))for(const e of n){const n=this.embedDeserializer.deserialize(e);n&&t.push(n)}const i=(0,u.q)(e,`data.${c}.fileAttachments`);if(i&&Array.isArray(i))for(const e of i){const n=this.fileDeserializer.deserialize(e);n&&t.push(n)}return t.reduce(((e,t)=>(e[t.id]=t,e)),{})}))}async remove(e){const{id:t,parentId:n,parentType:i}=e,s=this.getViewId(),r=await this.mutate(v.RemoveFileAttachment,{modelId:s,attachmentId:t,parentType:i,parentId:n}),o=(0,u.q)(r,"data.removeFileAttachment")||!1;return o||y.error("remove file attachment failed!"),o}async delete(e,t,n){const i=this.getViewId();return Promise.all(e.map((e=>this.mutate(v.DeleteExternalAttachment,{modelId:i,attachmentId:e,parentType:n,parentId:t}))))}getViewId(){return this.viewId}}var b=n(97236),S=n(63336),E=n(28129);const T=new h.Z("file-upload-deserializer");class FileUploadDeserializer{deserialize(e){if(!e||!this.validate(e))return T.debug("Deserialized invalid file attachment data from MDS",e),null;const t=new o.P;return t.id=e.id,t.created=(0,S.p)(e.created),e.mimeType&&(t.mimeType=e.mimeType,t.mediaType=(0,p.id)(e.mimeType)),t.thumbnailUrl=new E.n(e.url||"",(0,S.p)(e.validUntil,null)),t.url=new E.n(e.url||"",(0,S.p)(e.validUntil,null)),t.filename=e.filename||"",t.bytes=e.bytes||0,t.category=a.G.UPLOAD,t.width=e.imageWidth||0,t.height=e.imageHeight||0,t}validate(e){return["id","created","url","filename","mimeType","validUntil"].every((t=>t in e))}}class FileUploadSerializer{constructor(){}serialize(e){return{filename:e.file.name,contents:{filename:e.file.name,blob:e.file}}}}const w=new h.Z("FileAttachmentStorage");class FileAttachmentStorage extends b.U{constructor(e){super(e),this.uploadDeserializer=new FileUploadDeserializer,this.uploadSerializer=new FileUploadSerializer}async create(e,t){const n=b.U.baseViewId,i=this.uploadSerializer.serialize(e);let s;try{s=await this.client.upload(v.UploadFileAttachmentToModel,"UploadFileAttachmentToModel",Object.assign(Object.assign({},i),{modelId:n,organizationId:this.config.organizationId}),t)}catch(t){return w.error(t),"file.upload.quota.exceeded"===t.code?e.error=l.kV.OVER_QUOTA:e.error=l.kV.UPLOAD_FAILED,e.progress=100,e}if(s.errors&&s.errors.length>0)w.error(s.errors),e.error=l.kV.UPLOAD_FAILED;else{const t=(0,u.q)(s,"data.uploadFileAttachmentToModel")||null;if(t){const n=this.uploadDeserializer.deserialize(t);n?(w.info("upload successful!"),e.attachment=n):(w.error("cannot create attachment"),e.error=l.kV.UPLOAD_FAILED)}else w.error("upload failed!"),e.error=l.kV.UPLOAD_FAILED}return e.progress=100,e}async delete(e){const t=await this.client.mutate(v.DeleteFileAttachment,{id:e}),n=(0,u.q)(t,"data.deleteFileAttachment")||!1;return n?w.info("upload deleted!"):w.error("upload deletion failed!"),n}}var x=n(4752),_=n(87443),M=n(10047),O=n(72187);function A(e){switch(e){case O.ht.PHOTO:return l.DD.IMAGE;case O.ht.VIDEO:return l.DD.VIDEO;case O.ht.RICH:return l.DD.RICH;default:return}}function C(e){const{height:t,width:n,thumbnail_height:i,thumbnail_width:s,cache_age:r}=e,o=(void 0===t||void 0===n)&&(s&&i),a=e.type===O.ht.PHOTO?e.url:void 0,l=e.thumbnail_url||a,c=r?new Date(Date.now()+1e3*r):null;return{width:o?s:n,height:o?i:t,mediaType:A(e.type),url:new E.n(a||"",c),thumbnailUrl:new E.n(l||"",c)}}class AttachmentsModule extends i.Y{constructor(){super(...arguments),this.name="attachments-module",this.loadEmbeddedAttachment=async e=>this.getUpdatedEmbed(e.attachment),this.embedMedia=async e=>{let t,n=null;const i=await this.oEmbedConsumer.getOEmbedData(e.src);return i?(n=new o.P,n.id=(0,s.fV)(),n.parentType=e.parentType,n.parentId=e.parentId,n.src=e.src,n.category=a.G.EXTERNAL,Object.assign(n,C(i)),this.attachmentsData.addPending(n),t=l._V.EMBED_SUCCESS):t=l._V.EMBED_FAIL,this.engine.broadcast(new c.v8(n,t,e.parentId,e.parentType)),n},this.uploadAttachments=async e=>{const{parentType:t,parentId:n,files:i}=e,s=this.attachmentsData;i.forEach((e=>{this.uploadAttachment(e,n,t).then((e=>{s.atomic((()=>{e.error?(s.removeUpload(e.id),s.addFailure(e)):e.attachment&&(e.attachment.parentId=n,e.attachment.parentType=t,s.removeUpload(e.id),s.addPending(e.attachment))})),this.engine.broadcast(new c.RE(e))}))}))},this.onProgress=(e,t)=>{if(!e.lengthComputable)return;const n=e.total>0?Math.floor(e.loaded/e.total*100):100,i=Object.assign(Object.assign({},t),{progress:n});this.attachmentsData.addUpload(i),this.engine.broadcast(new c.Vj(i))},this.removeFailure=async e=>{this.attachmentsData.removeFailure(e.id)},this.removeAttachment=async e=>{if(!this.fileAttachmentStorage)return void this.log.error("No file attachment store");const{attachment:t}=e,n=this.attachmentsData,i=n.getPendingAttachment(t.id);i?(i.category===a.G.UPLOAD&&await this.fileAttachmentStorage.delete(t.id),n.removePendingAttachment(t.id)):n.markAttachmentForDelete(t)},this.confirmAttachmentChanges=async e=>{const t=this.attachmentsData,{pendings:n,removals:i}=t,{parentId:s,parentType:o,prevParentId:l}=e,c=n.length>0||i.length>0;if(n.length>0){const e=l||s;t.iteratePending((t=>{l&&t.parentId===e&&t.parentType===o&&(t.parentId=s)}));const i=o!==r.u.MATTERTAG?n.values:n.values.filter((e=>e.category===a.G.UPLOAD));await this.attachmentsStore.create(i)}if(i.length>0){const e=o!==r.u.MATTERTAG?i.values:i.values.filter((e=>e.category===a.G.UPLOAD));e.length>0&&await this.deleteAttachments(e,s,o)}return this.resetAttachmentData(),c},this.cancelAttachmentChanges=async()=>{const e=this.attachmentsData,{pendings:t,removals:n}=e;0===t.length&&0===n.length||(this.fileAttachmentStorage?(e.pendings.values.forEach((e=>{e.category===a.G.UPLOAD&&this.fileAttachmentStorage.delete(e.id)})),this.resetAttachmentData()):this.log.error("No file attachment store"))},this.deleteAttachments=async(e,t,n)=>{if(!this.fileAttachmentStorage)return void this.log.error("No file attachment store");if(0===e.length)return;const i=[],s=[];this.attachmentsData.atomic((()=>{e.forEach((e=>{e.category===a.G.UPLOAD?i.push(e):e.category===a.G.EXTERNAL&&s.push(e.id)}))})),i.length>0&&await Promise.all(i.map((e=>this.attachmentsStore.remove(e)))),s.length>0&&await this.attachmentsStore.delete(s,t,n)},this.handleAttachmentViewerCommand=async e=>{const{open:t,attachments:n,attachmentId:i}=e;t&&n?this.openAttachmentViewer(n,i):this.closeAttachmentViewer()}}async init(e,t){this.engine=t;const{viewId:n,organizationId:i,apiConfig:s,queue:r}=e;this.attachmentsStore=new AttachmentsStore({readonly:!1,viewId:n}),i&&(this.fileAttachmentStorage=new FileAttachmentStorage({readonly:!1,organizationId:i}));const o={embedlyKey:s.embedly_key,instagramAppId:s.instagram_app_id,instagramClientToken:s.instagram_client_token,googleMapsApiKey:s.google_maps_key};this.oEmbedConsumer=new O.a_(r,o),this.attachmentsData=new x.b,this.bindings.push(t.commandBinder.addBinding(_.It,this.uploadAttachments),t.commandBinder.addBinding(_.wu,this.embedMedia),t.commandBinder.addBinding(_.st,this.loadEmbeddedAttachment),t.commandBinder.addBinding(_.iu,this.confirmAttachmentChanges),t.commandBinder.addBinding(_.Ze,this.cancelAttachmentChanges),t.commandBinder.addBinding(_.x9,(async()=>this.resetAttachmentData())),t.commandBinder.addBinding(_.$T,this.removeAttachment),t.commandBinder.addBinding(_.Rh,this.removeFailure),t.commandBinder.addBinding(_.xW,this.handleAttachmentViewerCommand)),t.market.register(this,x.b,this.attachmentsData)}async getUpdatedEmbed(e){if(e.category===a.G.EXTERNAL){const t=await this.oEmbedConsumer.getOEmbedData(e.src);return Object.assign(e,C(t)),t}return null}async uploadAttachment(e,t,n){const i={file:e,id:(0,s.fV)(),progress:0,error:null,attachment:null,parentId:t,parentType:n};if(!this.fileAttachmentStorage)return this.log.error("No file attachment store"),i.error=l.kV.PERMISSION_DENIED,Promise.resolve(i);const r=e.size;return 0===r?(i.error=l.kV.EMPTY_FILE,Promise.resolve(i)):r>M.z6?(i.error=l.kV.FILE_TOO_LARGE,Promise.resolve(i)):(this.attachmentsData.addUpload(i),this.fileAttachmentStorage.create(i,(e=>this.onProgress(e,i))))}resetAttachmentData(){const e=this.attachmentsData;e.atomic((()=>{e.clearPending(),e.clearRemovals(),e.clearUploads(),e.clearFailures()}))}openAttachmentViewer(e,t){this.viewerOpen=!0,this.engine.broadcast(new c.O(e,t))}closeAttachmentViewer(){this.viewerOpen&&(this.viewerOpen=!1,this.engine.broadcast(new c.Rd))}}const N=AttachmentsModule},96372:(e,t,n)=>{"use strict";n.d(t,{O:()=>ViewAttachmentsMessage,Rd:()=>CloseAttachmentViewerMessage,Vj:()=>AttachmentUploadProgressMessage,RE:()=>AttachmentUploadDoneMessage,v8:()=>EmbeddingDoneMessage});var i=n(4117);class ViewAttachmentsMessage extends i.v{constructor(e,t){super(),this.attachments=e,this.attachmentId=t}}class CloseAttachmentViewerMessage extends i.v{}class AttachmentUploadProgressMessage extends i.v{constructor(e){super(),this.upload=e}}class AttachmentUploadDoneMessage extends i.v{constructor(e){super(),this.upload=e}}class EmbeddingDoneMessage extends i.v{constructor(e,t,n,i){super(),this.attachment=e,this.status=t,this.parentId=n,this.parentType=i}}},10047:(e,t,n)=>{"use strict";n.d(t,{yk:()=>i,z6:()=>s,Aw:()=>r,t8:()=>o,m:()=>a,KI:()=>l,fn:()=>c,vH:()=>d,VB:()=>u,RW:()=>h});const i=25,s=524288e3,r=["image/gif","image/png","image/jpeg","image/webp","image/bmp"],o=["image/gif","image/png","image/jpeg","image/webp"],a=140,l=140,c=60,d=60,u=300,h=250},15878:(e,t,n)=>{"use strict";n.d(t,{d:()=>ExternalAttachmentDeserializer});var i=n(5477),s=n(28129),r=n(63336),o=n(85553),a=n(67731),l=n(9042);const c=new i.Z("external-attachment-deserializer");class ExternalAttachmentDeserializer{constructor(){}deserialize(e){if(!e||!this.validate(e))return c.debug("Deserialized invalid external attachment data from MDS",e),null;const t=new a.P;return t.id=e.id,t.created=(0,r.p)(e.created),t.src=e.url||"",t.thumbnailUrl=new s.n(e.thumbnailUrl||"",(0,r.p)(e.validUntil,null)),t.url=new s.n(e.url||"",(0,r.p)(e.validUntil,null)),e.mediaType&&(t.mediaType=(0,o.bY)(e.mediaType)),e.category?t.category=e.category:t.category=l.G.EXTERNAL,e.width&&(t.width=e.width),e.height&&(t.height=e.height),t.parentType=e.parentDetails.type,t.parentId=e.parentDetails.parent.id,t}validate(e){if(!e)return!1;const t=["id","created","modified","mediaType","category","parentDetails"].filter((t=>!(t in e))),n=0===t.length;return n||c.debug("Attachment invalid:",{missingFields:t}),n}}},96294:(e,t,n)=>{"use strict";n.d(t,{O:()=>FileAttachmentDeserializer});var i=n(5477),s=n(63336),r=n(85553),o=n(67731),a=n(9042),l=n(28129);const c=new i.Z("file-attachment-deserializer");class FileAttachmentDeserializer{constructor(){}deserialize(e){if(!e||!this.validate(e))return c.debug("Deserialized invalid file attachment data from MDS",e),null;const t=new o.P;return t.id=e.id,t.created=(0,s.p)(e.created),e.mimeType&&(t.mimeType=e.mimeType,t.mediaType=(0,r.id)(e.mimeType)),t.category=a.G.UPLOAD,t.thumbnailUrl=new l.n(e.url||"",(0,s.p)(e.validUntil,null)),t.url=new l.n(e.url||"",(0,s.p)(e.validUntil,null)),t.filename=e.filename||"",t.bytes=e.bytes||0,t.width=e.imageWidth||0,t.height=e.imageHeight||0,t}validate(e){if(!e)return!1;return["id","created","url","mimeType","filename"].every((t=>t in e))}}},85553:(e,t,n)=>{"use strict";var i;n.d(t,{bY:()=>p,VV:()=>f,ae:()=>u,fy:()=>l,Ug:()=>d,lV:()=>c,Uq:()=>a,m:()=>m,id:()=>h}),function(e){e.IMAGE="image",e.VIDEO="video",e.RICH="rich",e.ZIP="zip",e.PDF="pdf"}(i||(i={}));var s=n(9042),r=n(48452),o=n(10047);function a(e){return!(e.category!==s.G.UPLOAD||!e.mimeType)&&o.t8.includes(e.mimeType)}function l(e,t){return t?{width:o.VB,height:o.RW}:e?{width:o.fn,height:o.vH}:{width:o.m,height:o.KI}}function c(e){return e.category===s.G.EXTERNAL||e.category===s.G.SANDBOX||!!e.mimeType&&o.Aw.includes(e.mimeType)}function d(e){return e.filter((e=>c(e)))}function u(e){return e.filter((e=>!c(e)))}function h(e){return e.startsWith("image")?r.DD.IMAGE:e.startsWith("video")?r.DD.VIDEO:e.startsWith("audio")?r.DD.AUDIO:e.startsWith("model")?r.DD.MODEL:e.startsWith("text")?r.DD.TEXT:"application/pdf"===e?r.DD.PDF:r.DD.APPLICATION}function p(e){switch(e){case i.IMAGE:return r.DD.IMAGE;case i.PDF:return r.DD.PDF;case i.VIDEO:return r.DD.VIDEO;case i.RICH:return r.DD.RICH;case i.ZIP:return r.DD.ZIP;default:throw Error(`Unknown attachment media type ${e}`)}}function m(e){switch(e){case r.DD.IMAGE:return i.IMAGE;case r.DD.PDF:return i.PDF;case r.DD.VIDEO:return i.VIDEO;case r.DD.RICH:return i.RICH;case r.DD.ZIP:return i.ZIP;default:throw Error(`Unknown media type ${e}`)}}function f(e){if(!e)return"0";const t=Math.min(Math.floor(Math.log(e)/Math.log(1e3)),3),n=["B","kB","MB","GB"][t];return`${Number((e/Math.pow(1e3,t)).toFixed(1))}${n}`}},24092:(e,t,n)=>{"use strict";n.d(t,{L:()=>ResetPitchCommand});var i=n(93037);class ResetPitchCommand extends i.m{}},15099:(e,t,n)=>{"use strict";n.d(t,{M_:()=>CameraData,rw:()=>h});var i=n(41674),s=n(35424),r=n(41252),o=n(2212);const a=(e,t)=>e&&t?e.equals(t):e===t;var l=n(26517),c=n(95703),d=n(98254),u=n(994);class CameraPoseData extends d.T{constructor(e){super(),this.position=new o.Vector3,this.rotation=new o.Quaternion,this.focalDistance=-1,this.projection=(0,i.AN)(e)}aspect(){return this.projection.elements[5]/this.projection.elements[0]}clone(e=new CameraPoseData(this.aspect())){return e.position.copy(this.position),e.rotation.copy(this.rotation),e.focalDistance=this.focalDistance,e.projection.copy(this.projection),e}isOrtho(){return(0,l.Pp)(this.projection)}fovX(){return 2*Math.atan(1*this.aspect()/this.projection.elements[5])}fovY(){return 2*Math.atan(1/this.projection.elements[5])}}class CameraTransition extends d.T{constructor(){super(...arguments),this.startTime=0,this.duration=0,this.active=!1,this.type=null,this.progress=new r.z(0),this.blackoutProgress=new r.z(0),this.from={position:new o.Vector3,rotation:new o.Quaternion,projection:new c.M},this.to={position:new o.Vector3,rotation:new o.Quaternion,projection:new c.M},this.rotationDelay=0,this.rotationDuration=1,this.matrixDelay=0,this.matrixDuration=1,this.activeInternal=!1,this.promise=null}}const h=(e,t,n=!0)=>{t.position=p(e.position,t.position,n),t.rotation=p(e.rotation,t.rotation,n),t.projection=p(e.projection,t.projection,n),t.focalDistance=e.focalDistance},p=(e,t,n=!0)=>(e&&!t?t=e.clone():e&&t?t.copy(e):n&&(t=void 0),t);class CameraData extends s.V{constructor(e,t){super(),this._width=e,this._height=t,this.name="camera",this._baseProjection=new c.M,this._orthoMatrix=new c.M,this._lastOrthoZoom=1,this._perspectiveMatrix=new c.M,this.pose=new CameraPoseData(e/t),this.transition=new CameraTransition,this.setCameraDimensions(e,t),this._baseFovY=u.Ue*i.oR.fov}setCameraDimensions(e,t){if(void 0===e||void 0===t)return;this._width=e,this._height=t;const n=e/t,s=this.isOrtho()?(0,i.aH)(e,t,t/(2*this.orthoZoom()),this._orthoMatrix):this._perspectiveMatrix.makePerspectiveFov(u.MN*this.fovY(),n,i.oR.near,i.oR.far);if(this.pose.projection.copy(s),this.transition.active&&this.transition.to.projection)if((0,l.Pp)(this.transition.to.projection)){const n=(0,l.S3)(this.transition.to.projection);this.transition.to.projection.copy((0,i.aH)(e,t,t/(2*n)))}else{const e=2*u.MN*Math.atan(1/this.transition.to.projection.elements[5]);this.transition.to.projection.makePerspectiveFov(e,n,i.oR.near,i.oR.far)}this.pose.commit()}setBaseProjection(e){this._baseProjection=e}get width(){return this._width}get height(){return this._height}get baseFovY(){return this._baseFovY}aspect(){return this.pose.aspect()}fovY(){return this.pose.fovY()}fovX(){return this.pose.fovX()}isOrtho(){return this.pose.isOrtho()}baseZoom(){return this.pose.projection.elements[0]/2}defaultZoom(){return(0,l.Pp)(this._baseProjection)?(0,l.S3)(this._baseProjection):this.perspectiveZoom()}zoom(){return this.isOrtho()?this.orthoZoom():this.perspectiveZoom()}orthoZoom(){const e=(0,l.S3)(this.pose.projection);return isNaN(e)?this._lastOrthoZoom:(this._lastOrthoZoom=e,e)}perspectiveZoom(){return this.baseFovY/this.fovY()}copyTransition(e){this.transition.active=e.active,this.transition.activeInternal=e.activeInternal,this.transition.type=e.type,this.transition.startTime=e.startTime,this.transition.duration=e.duration,this.transition.rotationDelay=e.rotationDelay,this.transition.rotationDuration=e.rotationDuration,this.transition.matrixDelay=e.matrixDelay,this.transition.matrixDuration=e.matrixDuration,e.progress&&this.transition.progress.copy(e.progress),e.blackoutProgress&&this.transition.blackoutProgress.copy(e.blackoutProgress),e.from&&h(e.from,this.transition.from),e.to&&h(e.to,this.transition.to),this.transition.promise=e.promise}canTransition(){return!this.transition.active}clone(){const e=new CameraData(this.width,this.height);return e.copy(this),e}copy(e){this.pose.position.copy(e.pose.position),this.pose.rotation.copy(e.pose.rotation),this.pose.focalDistance=e.pose.focalDistance,this.pose.projection.copy(e.pose.projection),this.pose.commit(),this._baseFovY=e.baseFovY,this.copyTransition(e.transition),this.transition.commit(),this._width=e.width,this._height=e.height}shallowIsEqual(e){return this.pose.position.equals(e.pose.position)&&this.pose.rotation.equals(e.pose.rotation)&&this.pose.projection.equals(e.pose.projection)&&this.pose.focalDistance===e.pose.focalDistance&&this.baseFovY===e.baseFovY}isEqual(e){return this.shallowIsEqual(e)&&this.transitionIsEqual(e.transition)}transitionIsEqual(e){return this.transition.active===e.active&&this.transition.type===e.type&&this.transition.progress.equals(e.progress)&&this.transition.blackoutProgress.equals(e.blackoutProgress)&&this.transition.rotationDelay===e.rotationDelay&&this.transition.rotationDuration===e.rotationDuration&&this.transition.matrixDelay===e.matrixDelay&&this.transition.matrixDuration===e.matrixDuration&&this.transition.activeInternal===e.activeInternal&&a(this.transition.from.position,e.from.position)&&a(this.transition.from.rotation,e.from.rotation)&&a(this.transition.from.projection,e.from.projection)&&a(this.transition.to.position,e.to.position)&&a(this.transition.to.rotation,e.to.rotation)&&a(this.transition.to.projection,e.to.projection)&&this.transition.startTime===e.startTime&&this.transition.duration===e.duration}}},41674:(e,t,n)=>{"use strict";n.d(t,{oR:()=>s,AN:()=>r,aH:()=>o});var i=n(95703);const s={fov:75,near:.1,far:3e3},r=(e,t)=>(t||(t=new i.M),t.makePerspectiveFov(s.fov,e,s.near,s.far)),o=(e,t,n=1,r)=>{r||(r=new i.M);const o=e/2,a=t/2,l=r.makeOrthographic(-o,o,a,-a,s.near,s.far);return l.elements[0]*=n,l.elements[5]*=n,l}},49702:(e,t,n)=>{"use strict";n.r(t),n.d(t,{TRANSITION_DISTANCE_MULTIPLIER:()=>S,baseTransitionSpeedKey:()=>E,default:()=>CameraModule});var i=n(2212);var s=n(34629),r=n(26517),o=n(20725),a=n(57227),l=n(15099),c=n(4117);class CameraMoveMessage extends c.v{constructor(e,t){super(),this.from=t,this.to=e,this.timestamp=Date.now()}}class BeginCameraMoveMessage extends CameraMoveMessage{}class EndCameraMoveMessage extends CameraMoveMessage{}var d=n(31013),u=n(65270),h=n(18984),p=n(61903),m=n(82722),f=n(74170),g=n(37008),v=n(14832),y=n(24092);const b={[v.n.Instant]:{blackoutTime:0,transitionTime:0},[v.n.FadeToBlack]:{blackoutTime:h.Z.camera.transitionBlackoutTime,transitionTime:2*h.Z.camera.transitionBlackoutTime},[v.n.Interpolate]:{blackoutTime:0,transitionTime:h.Z.camera.transitionFadeTime},[v.n.MoveToBlack]:{blackoutTime:h.Z.camera.transitionBlackoutTime,transitionTime:h.Z.camera.transitionFadeTime}},S=166,E="Transition time";class CameraModule extends a.Y{constructor(){super(...arguments),this.name="camera-data",this.eulerCache=new i.Euler,this.quaternionCache=new i.Quaternion}async init(e,t){this.engine=t,this.market=t.market,this.canvas=await t.market.waitForData(m.W),this.cameraData=new l.M_(this.canvas.width,this.canvas.height),this.market.register(this,l.M_,this.cameraData),this.baseTransitionTime=e.baseTransitionTime||h.Z.camera.baseTransitionTime,t.market.waitForData(p.e).then((e=>{e.onPropertyChanged(E,(e=>{this.baseTransitionTime=e}))})),t.commandBinder.addBinding(y.L,(async()=>this.resetPitch())),this.bindings.push(t.subscribe(o.a,(e=>this.cameraData.setCameraDimensions(e.width,e.height)))),this.transitionSpeed=e.transitionSpeed||h.Z.camera.transitionSpeed}getData(e=!0){return e?Object.freeze(this.cameraData.clone()):this.cameraData}onUpdate(e){}fromPose(){return{position:this.cameraData.pose.position.clone(),rotation:this.cameraData.pose.rotation.clone(),projection:this.cameraData.pose.projection.clone(),focalDistance:this.cameraData.pose.focalDistance}}updateCameraProjection(e){e&&(this.cameraData.pose.projection.copy(e),this.cameraData.pose.commit(),this.broadcastCameraMoved({projection:e}))}updateCameraFocus(e){this.cameraData.pose.focalDistance=e,this.cameraData.pose.commit()}updateCameraRotation(e){e&&(this.cameraData.pose.rotation.copy(e),this.cameraData.pose.commit(),this.broadcastCameraMoved({rotation:e}))}resetPitch(){this.eulerCache.setFromQuaternion(this.cameraData.pose.rotation,"YXZ"),this.eulerCache.x=0,this.eulerCache.z=0,this.quaternionCache.setFromEuler(this.eulerCache),this.updateCameraRotation(this.quaternionCache)}updateCameraPosition(e){e&&(this.cameraData.pose.position.copy(e),this.cameraData.pose.commit(),this.broadcastCameraMoved({position:e}))}broadcastCameraMoved(e){const t=this.fromPose(),n=Object.assign(Object.assign({},t),e);this.engine.broadcast(new CameraMoveMessage(n,t))}updateCameraPose(e){e.position&&this.updateCameraPosition(e.position),e.rotation&&this.updateCameraRotation(e.rotation)}canTransition(){return this.cameraData.canTransition()}moveTo(e){if(!this.canTransition())return d.Q.reject("Cannot move while the camera is already moving");const t=b[e.transitionType],n=e.pose.rotation,i=e.pose.position;let s=e.projection;e.pose.zoom&&(s&&(0,r.Pp)(s)||this.cameraData.isOrtho())&&(s=this.adjustProjectionZoom(s||this.cameraData.pose.projection.clone(),e.pose.zoom));const o=void 0!==e.blackoutTime?e.blackoutTime:t.blackoutTime,a=e.transitionType,l=e.transitionSpeedMultiplier?1/e.transitionSpeedMultiplier:1;let c=a===v.n.Instant?0:e.transitionTime;if(void 0===c)if(e.transitionType===v.n.Interpolate&&i){const e=i.distanceTo(this.cameraData.pose.position);c=this.baseTransitionTime+Math.log2(1+e)*S*this.transitionSpeed*l}else c=t.transitionTime;const u=this.fromPose();this.beginInternalTransition({transitionType:a,transitionTime:c,blackoutTime:o,pose:{position:i,rotation:n},projection:s,easing:e.easing,rotationDelay:e.rotationDelay||0,rotationDuration:e.rotationDuration||1,matrixDelay:e.matrixDelay||0,matrixDuration:e.matrixDuration||1,focalDistance:e.focalDistance||u.focalDistance});const h={position:e.pose.position?e.pose.position.clone():void 0,rotation:e.pose.rotation?e.pose.rotation.clone():void 0,projection:e.projection?e.projection.clone():void 0,focalDistance:e.focalDistance?e.focalDistance:void 0};this.engine.broadcast(new BeginCameraMoveMessage(h,u));const p=this.cameraData.transition.promise;if(!p)throw new Error("Expected promise to have been created.");const m=this.progressInternalTransition.bind(this),y=this.endInternalTransition.bind(this),E=this;return p.notify(0),this.engine.startGenerator((function*(){let t=16;for(t>=E.cameraData.transition.duration&&(p.notify(.5),yield new g.Jj);t<E.cameraData.transition.duration;){m(t,o);const e=(0,f.uZ)(t/E.cameraData.transition.duration,0,1);p.notify(e),yield new g.Jj,t=16+Date.now()-E.cameraData.transition.startTime}y(e.transitionType),E.cameraData.commit(),p.notify(1),p.resolve(),E.engine.broadcast(new EndCameraMoveMessage(h,u))})),p.promise()}async cancelTransition(){return this.cameraData.transition.active?new Promise((e=>{(0,l.rw)(this.cameraData.pose,this.cameraData.transition.to,!1);const t=Date.now()-this.cameraData.transition.startTime;this.cameraData.transition.duration=t,this.cameraData.transition.progress.stop(1),this.cameraData.pose.commit(),this.cameraData.transition.commit();const n=this.cameraData.transition.onPropertyChanged("active",(t=>{t||(n&&n.cancel(),e())}))})):Promise.resolve()}updateTransitionSpeed(e){if(this.cameraData.transition.active){const t=Date.now(),n=t-this.cameraData.transition.startTime,i=n/e,s=this.cameraData.transition.progress,r=(s.duration-n)/e+i;this.cameraData.transition.duration=r,this.cameraData.transition.startTime=t-i,s.modifyAnimation(s.value,s.endValue,r,s.easing,i),this.cameraData.transition.commit()}}beginExternalTransition(){this.cameraData.transition.activeInternal||(this.cameraData.transition.startTime=Date.now(),this.cameraData.transition.active=!0,this.cameraData.transition.promise=new d.Q,this.cameraData.transition.commit())}endExternalTransition(){var e;this.cameraData.transition.activeInternal||(this.cameraData.transition.active=!1,null===(e=this.cameraData.transition.promise)||void 0===e||e.resolve(),this.cameraData.transition.commit())}beginInternalTransition(e){const t=e.transitionTime||0;if(this.cameraData.transition.startTime=Date.now(),this.cameraData.transition.duration=t,this.cameraData.transition.active=!0,this.cameraData.transition.promise=new d.Q,this.cameraData.transition.activeInternal=!0,this.cameraData.transition.type=e.transitionType,this.cameraData.transition.progress.modifyAnimation(0,1,t,e.easing||u.to),this.cameraData.transition.rotationDelay=e.rotationDelay||0,this.cameraData.transition.rotationDuration=e.rotationDuration||1,this.cameraData.transition.matrixDelay=e.matrixDelay||0,this.cameraData.transition.matrixDuration=e.matrixDuration||1,e.transitionType===v.n.FadeToBlack&&this.cameraData.transition.blackoutProgress.modifyAnimation(0,1,e.blackoutTime,u.vG),e.transitionType===v.n.MoveToBlack){const e=500;this.cameraData.transition.blackoutProgress.modifyAnimation(0,1,t-2*e,u.aB,0,e)}this.cameraData.transition.from.position=this.cameraData.pose.position.clone(),this.cameraData.transition.from.rotation=this.cameraData.pose.rotation.clone(),this.cameraData.transition.from.projection=this.cameraData.pose.projection.clone(),this.cameraData.transition.from.focalDistance=this.cameraData.pose.focalDistance,this.cameraData.transition.to.position=e.pose.position?e.pose.position.clone():void 0,this.cameraData.transition.to.rotation=e.pose.rotation?e.pose.rotation.clone():void 0,this.cameraData.transition.to.projection=e.projection?e.projection.clone():void 0,this.cameraData.transition.to.focalDistance=e.focalDistance?e.focalDistance:void 0,this.cameraData.transition.commit()}progressInternalTransition(e,t){if(this.cameraData.transition.active){if(this.cameraData.transition.progress.updateAbsolute(e),this.cameraData.transition.type===v.n.Interpolate)this.updateInterpolateTransition();else if(this.cameraData.transition.type===v.n.FadeToBlack){let n=0;const i=this.cameraData.transition.duration;e<=t?n=e:((0,l.rw)(this.cameraData.transition.to,this.cameraData.pose,!1),n=e>=i-t?i-e:t),this.cameraData.transition.blackoutProgress.updateAbsolute(n),this.cameraData.transition.progress.updateAbsolute(e<=t?0:i)}else if(this.cameraData.transition.type===v.n.MoveToBlack){const t=this.cameraData.transition.blackoutProgress;this.updateInterpolateTransition(),t.updateAbsolute(e-t.delay)}this.cameraData.pose.commit(),this.cameraData.transition.commit()}}updateInterpolateTransition(){const e=this.cameraData.transition.from,t=this.cameraData.transition.to;if(t.position&&e.position&&this.cameraData.pose.position.copy(e.position).lerp(t.position,this.cameraData.transition.progress.value),t.focalDistance&&e.focalDistance&&(this.cameraData.pose.focalDistance=(0,s.t)(e.focalDistance,t.focalDistance,this.cameraData.transition.progress.value)),t.rotation&&e.rotation){const n=(0,u.e3)(this.cameraData.transition.progress.easing,this.cameraData.transition.progress.value,this.cameraData.transition.progress.elapsed,this.cameraData.transition.progress.duration*this.cameraData.transition.rotationDuration,this.cameraData.transition.rotationDelay);this.cameraData.pose.rotation.copy(e.rotation).slerp(t.rotation,n)}if(t.projection&&e.projection){const n=(0,u.e3)(u.w2,this.cameraData.transition.progress.value,this.cameraData.transition.progress.elapsed,this.cameraData.transition.progress.duration*this.cameraData.transition.matrixDuration,this.cameraData.transition.matrixDelay);!function(e,t,n,i){const s=i.elements,r=e.elements,o=t.elements;for(let e=0;e<16;e++)s[e]=r[e]*(1-n)+o[e]*n}(e.projection,t.projection,n,this.cameraData.pose.projection)}}endInternalTransition(e){(0,l.rw)(this.cameraData.transition.to,this.cameraData.pose,!1),this.cameraData.transition.type=null,this.cameraData.transition.active=!1,this.cameraData.transition.activeInternal=!1,this.cameraData.transition.progress.stop(1),e!==v.n.FadeToBlack&&e!==v.n.MoveToBlack||this.cameraData.transition.blackoutProgress.stop(0),this.cameraData.pose.commit(),this.cameraData.transition.commit()}adjustProjectionZoom(e,t){const n=1/t;return e.elements[0]=n/this.canvas.aspectRatio,e.elements[5]=n,e}setBaseProjection(e){this.cameraData.setBaseProjection(e)}}},14832:(e,t,n)=>{"use strict";var i;n.d(t,{n:()=>i}),function(e){e[e.Instant=0]="Instant",e[e.FadeToBlack=1]="FadeToBlack",e[e.Interpolate=2]="Interpolate",e[e.MoveToBlack=3]="MoveToBlack"}(i||(i={}))},18984:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o,y:()=>a});var i=n(51167),s=n(14832),r=n(87100);const o=Object.freeze({camera:{transitionBlackoutTime:300,transitionFadeTime:800,baseTransitionTime:(0,r.eY)("btt",200),transitionSpeed:(0,r.eY)("tsp",3)}}),a={[i.s.Desktop]:s.n.Interpolate,[i.s.Mobile]:s.n.Interpolate,[i.s.VrOrientOnly]:s.n.FadeToBlack,[i.s.VrWithController]:s.n.FadeToBlack,[i.s.VrWithTrackedController]:s.n.FadeToBlack}},7692:(e,t,n)=>{"use strict";n.d(t,{q9:()=>r,bD:()=>o,D_:()=>a,z5:()=>c,st:()=>d,Kh:()=>u,fi:()=>h});var i=n(2212),s=n(77280);const r=(()=>{const e=new i.Matrix4,t=new i.Matrix4;return(n,s,r,o)=>(r=r||new i.Vector2,o=o||new i.Vector3,l(n.pose,t),e.copy(t),e.invert(),o.set(s.x,s.y,s.z).applyMatrix4(e).applyMatrix4(n.pose.projection.asThreeMatrix4()),h(n.width,n.height,o,r),{screenPosition:r,ndcPosition:o})})(),o=(()=>{const e=new i.Vector3,t=new i.Vector2;return(n,i,s,r,o,l)=>(e.copy(a(n,i,s,l)),h(r,o,e,t),t)})(),a=(()=>{const e=new i.Matrix4,t=new i.Matrix4,n=new i.Vector3;return(i,r,o,a)=>(e.compose(r,o,s.f.UNIT),t.copy(e),t.invert(),n.copy(i).applyMatrix4(t).applyMatrix4(a),n)})(),l=(e,t)=>(t=t||new i.Matrix4).compose(e.position,e.rotation,s.f.UNIT),c=(e,t,n,s,r)=>((r=r||new i.Vector2).x=e/n*2-1,r.y=-t/s*2+1,r),d=(e,t,n=.5,s)=>((s=s||new i.Vector3).x=t.x,s.y=t.y,s.z=n,u(e.pose,s)),u=(()=>{const e=new i.Matrix4,t=new i.Matrix4;return(n,s,r)=>((r=r||new i.Vector3).copy(s),t.copy(n.projection.asThreeMatrix4()),t.invert(),l(n,e),r.applyMatrix4(t).applyMatrix4(e))})(),h=(e,t,n,s)=>((s=s||new i.Vector2).set((n.x+1)*e/2,(1-n.y)*t/2),s)},56396:(e,t,n)=>{"use strict";n.d(t,{O:()=>CameraStartData,B:()=>CameraStartPose});var i=n(22878),s=n(35424);class CameraStartData extends s.V{constructor(e,t,n){super(),this.name="cam-start",this.icon=e,this.thumb=t,this.modified=new Date(0),this.pose=new CameraStartPose,n&&this.pose.copy(n)}copy(e){return this.icon=e.icon,this.thumb=e.thumb,this.modified=e.modified||new Date,this.pose.copy(e.pose),this}get hasCameraPose(){return this.pose&&this.pose.camera&&void 0!==this.pose.camera.position}}class CameraStartPose{constructor(e=i.Ey.Panorama,t,n,s,r,o){this.mode=e,this.camera={position:t||void 0,rotation:n||void 0,zoom:s||void 0},this.pano=r||{uuid:void 0},this.floorVisibility=o||void 0}copy(e){return this.camera.position=r(e.camera.position,this.camera.position),this.camera.rotation=r(e.camera.rotation,this.camera.rotation),this.camera.zoom=e.camera.zoom,this.pano.uuid=e.pano.uuid?e.pano.uuid.slice():void 0,this.mode=e.mode,this.floorVisibility=e.floorVisibility?e.floorVisibility.slice():void 0,this}}const r=(e,t)=>e&&t?t.copy(e):e&&!t?e.clone():void 0},3922:(e,t,n)=>{"use strict";n.d(t,{K:()=>NavigationUrl});var i=n(2212),s=n(22878),r=n(87100),o=n(5477),a=n(63387),l=n(94293);const c=new o.Z("navurl");class InvalidViewmodeError extends Error{constructor(e,t){super(`view mode ${e} is invalid${t?` when ${t}`:""}`)}}class NavigationUrl{static encodeVector3(e,t=2){const{x:n,y:i,z:s}=e;return NavigationUrl.packFloats([n,i,s],t)}static decodeVector3(e){const t=NavigationUrl.unpackFloats(e,3);return t?new i.Vector3(...t):null}static encodeQuaternion(e,t=2){return NavigationUrl.packFloats([e.x,e.y,e.z,e.w],t)}static decodeQuaternion(e){const t=NavigationUrl.unpackFloats(e,4);return t&&!(0,l.mB)(t)?new i.Quaternion(...t):null}static encodeEuler(e,t=2){return NavigationUrl.packFloats([e.x,e.y,e.z],t)}static decodeEuler(e){const t=NavigationUrl.unpackFloats(e,3);return t?new i.Euler(t[0],t[1],t[2],"XYZ"):void 0}static packFloats(e,t=2){let n=e.map((e=>{const n=parseFloat(e.toFixed(t)).toString().replace(/^(\-)?0+.(\d+)/,"$1.$2");return"0"===n?"":n})).join(",");return n=n.replace(/,+$/,""),n}static unpackFloats(e,t=0){const n=e.split(",").map((e=>""===e?0:parseFloat(e)));if(!n||n.includes(NaN))return[];for(;n.length<t;)n.push(0);return n}static getQueryString(e,t=!0){return NavigationUrl.serialize(e,t).toString()}static serialize(e,t=!0){const n=NavigationUrl.removeNavigationKeys();try{if(t){const t=NavigationUrl.getShortPose(e);for(const[e,i]of Object.entries(t))n.set(e,i)}else{const t=NavigationUrl.getStartPose(e),i=JSON.stringify(t);n.set("start",i)}}catch(e){c.debug(e)}return n}static deserialize(e=window.location.href){const t=new URL(e).searchParams;try{const e=t.get("start");return e?NavigationUrl.parseStartObject(e):NavigationUrl.parseShortUrl(t)}catch(e){c.debug(e)}return null}static removeNavigationKeys(){const e=(0,r.kD)();for(const t of["start","sm","sp","sq","sr","ss","sf","sz"])e.delete(t);return e}static parseShortUrl(e){const t=e.get("sm"),n=e.get("sp"),r=e.get("sq"),o=e.get("sr"),l=e.get("ss"),d=e.get("sf"),u=e.get("sz"),h=NavigationUrl.parseViewmode(t),p=NavigationUrl.decodeEuler(o||"")||new i.Euler(0,0,0),m=NavigationUrl.decodeQuaternion(r||"")||new i.Quaternion(0,0,0,1),f=n?NavigationUrl.decodeVector3(n):void 0,g=l?parseInt(l,10)-1:void 0,v=d?NavigationUrl.unpackFloats(d,4):void 0,y=u?parseFloat(u):void 0;if((0,s.Bw)(h)&&void 0===g)throw new InvalidViewmodeError(h,"sweep index not defined");if(!(0,s.Bw)(h)&&!f)throw new InvalidViewmodeError(h,"position is falsy");let b=r?m:(new i.Quaternion).setFromEuler(p);(0,s.Bw)(h)&&(b=(0,a.Z)(b));const S={mode:h,quaternion:b,position:f||void 0,sweepIndex:g,floorVisibility:v,zoom:y};return c.debug("Parsed short URL pose data:",S),S}static parseStartObject(e){const t=JSON.parse(decodeURIComponent(e));if(!t.camera_quaternion)throw Error("Start override is missing camera_quaternion");if(!t.camera_position)throw Error("Start override is missing camera_position");const n=NavigationUrl.parseViewmode(t.camera_mode),s=(new i.Quaternion).copy(t.camera_quaternion),r={mode:n,panoId:t.scan_id,position:(new i.Vector3).copy(t.camera_position),quaternion:s,zoom:t.ortho_zoom,floorVisibility:t.floor_visibility};return c.debug("Parsed &start URL pose data:",r),r}static getShortPose({cameraData:e,viewmodeData:t,floorsViewData:n,sweepData:r}){const o=(new i.Euler).setFromQuaternion(e.pose.rotation,"XYZ"),a=r.currentSweepIndex,l={};if(t.isInside())o.z=0,l.sr=NavigationUrl.encodeEuler(o),void 0!==a&&(l.ss=a+1),t.currentMode===s.Ey.Mesh&&(l.sm=NavigationUrl.validateViewmode(t.currentMode));else{l.sm=NavigationUrl.validateViewmode(t.currentMode),l.sr=NavigationUrl.encodeEuler(o),l.sp=NavigationUrl.encodeVector3(e.pose.position);const i=n.getFloorsVisibility();i.length&&n.totalFloors>1&&(l.sf=i)}return t.currentMode===s.Ey.Floorplan&&(l.sz=parseFloat(e.zoom().toFixed(2))),l.sq=NavigationUrl.encodeQuaternion(e.pose.rotation),c.debug(`Short URL params for current location ${JSON.stringify(l)}`),delete l.sq,l}static getStartPose({cameraData:e,viewmodeData:t,floorsViewData:n,sweepData:i}){const r={x:0,y:0,z:0,w:1};r.x=e.pose.rotation.x,r.y=e.pose.rotation.y,r.z=e.pose.rotation.z,r.w=e.pose.rotation.w;const o={x:0,y:0,z:0};o.x=e.pose.position.x,o.y=e.pose.position.y,o.z=e.pose.position.z;const a={camera_mode:NavigationUrl.validateViewmode(t.currentMode),camera_position:o,camera_quaternion:r};return t.isInside()?a.scan_id=i.currentSweep:a.floor_visibility=n.getFloorsVisibility(),t.currentMode===s.Ey.Floorplan&&(a.ortho_zoom=e.zoom()),a}static parseViewmode(e){let t=NavigationUrl.DEFAULT_VIEW_MODE;return null!=e&&(t=parseInt(e,10)),NavigationUrl.validateViewmode(t)}static validateViewmode(e){if(null===e||!NavigationUrl.VALID_URL_VIEW_MODES.includes(e))throw new InvalidViewmodeError(e);return e}}NavigationUrl.DEFAULT_VIEW_MODE=s.Ey.Panorama,NavigationUrl.VALID_URL_VIEW_MODES=[s.Ey.Panorama,s.Ey.Dollhouse,s.Ey.Floorplan,s.Ey.Outdoor,s.Ey.Mesh]},10815:(e,t,n)=>{"use strict";n.d(t,{n:()=>SetCameraStartCommand});var i=n(93037);class SetCameraStartCommand extends i.m{constructor(e){super(),this.payload={snapshotSid:e}}}SetCameraStartCommand.id="SET_CAMERA_START"},2153:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CameraStartModule});var i=n(21938),s=n(56396),r=n(57227),o=n(3922),a=n(22878),l=n(86936),c=n(53549),d=n(63387),u=n(52549),h=n(7819),p=n(48697),m=n(47063),f=n(66225),g=n(10943),v=n(5477);class MdsCameraStartPatchSerializer{serialize(e){return{image:e.sid}}}var y=n(91985);const b=new v.Z("mds-camera-start-store");class MdsCameraStartStore extends f.u{constructor(){super(...arguments),this.deserializer=new g.f,this.serializer=new MdsCameraStartPatchSerializer}async update(e){const t=this.getViewId(),n=this.serializer.serialize(e);if(0===Object.keys(n).length)throw new Error("No data to update?");return this.mutate(y.PatchModel,{modelId:t,patch:n}).then((e=>{b.debug(e)}))}}var S=n(10815),E=n(97966);class CameraStartModule extends r.Y{constructor(){super(...arguments),this.name="camera-start",this.store=null}async init(e,t){var n,r,a;const{readonly:l}=e;this.engine=t,[this.storage,this.sweepData,this.modelData]=await Promise.all([t.getModule(h.F),t.market.waitForData(c.Z),t.market.waitForData(E.T)]);const d=t.market.waitForData(i.P).then((e=>{this.snapshotsData=e})),m=o.K.deserialize();if(m){const e=this.parseNavigationPose(m);this.validStartPano(e)?(this.startingPose=new s.B,this.startingPose.copy(e),this.log.debug("Starting Camera Pose",this.startingPose)):this.log.error("Invalid start pose",e)}if(this.bindings.push(this.engine.commandBinder.addBinding(S.n,(async e=>this.updateStartLocationFromSnapshot(e.snapshotSid)))),!l){this.store=new MdsCameraStartStore({readonly:l}),this.bindings.push(this.storage.onSave((()=>this.save()),{dataType:u.g.START_LOCATION}));const e=await t.market.waitForData(p.Q);e.setRevertableType(u.g.START_LOCATION),e.setPublishableType(u.g.START_LOCATION)}let f,g;const v=this.modelData.model.image,y=this.modelData.model.imagePose;if(y?(f=this.buildCameraStart(y),g=y.thumbnailUrl):v&&(await d,f=null!==(n=this.getIconStartPose(v))&&void 0!==n?n:void 0,g=this.getIconThumbnail(v)),f||(f=null!==(r=this.getStartFallback())&&void 0!==r?r:void 0),null===(a=null==f?void 0:f.pano)||void 0===a?void 0:a.uuid){const e=this.sweepData.getSweep(f.pano.uuid);e&&!e.enabled&&(this.log.warn(`Enabled hidden start sweep ${f.pano.uuid}`),e.enabled=!0,e.commit())}this.data=new s.O(v,g,f),t.market.register(this,s.O,this.data)}getStartingPose(){return this.startingPose||this.data.pose}parseNavigationPose(e){const{mode:t,quaternion:n,position:i,floorVisibility:s,sweepIndex:r,zoom:o}=e;let{panoId:a}=e;if(a&&!this.sweepData.containsSweep(a)){const e=this.sweepData.getSweepByUuid(a);e&&(a=e.id)}if(!a&&void 0!==r){const e=this.sweepData.getSweepByIndex(r);e?a=e.id:this.log.debug(`Failed to load sweep index ${r}`)}return{mode:t,camera:{position:i,rotation:n,zoom:o},pano:{uuid:a},floorVisibility:s}}async updateStartLocationFromSnapshot(e){const t=this.snapshotsData.get(e),n=this.buildCameraStart(t),i=new s.O(t.sid,t.thumbnailUrl,n);this.data.copy(i),this.data.commit(),this.engine.broadcast(new l.O(t.is360)),await this.engine.commandBinder.issueCommand(new m.VQ({dataTypes:[u.g.START_LOCATION]}))}async save(){const e=this.data.icon;if(!e||!this.store)return void this.log.warn("Unable to save start location");const t=this.snapshotsData.get(e);return this.store.update(t)}buildCameraStart(e){const t={mode:e.metadata.cameraMode,camera:{position:e.metadata.cameraPosition,rotation:e.metadata.cameraQuaternion,zoom:e.metadata.orthoZoom},pano:{}};return(0,a.Bw)(t.mode)&&(t.pano={uuid:e.metadata.scanId}),t.floorVisibility=e.metadata.floorVisibility,t}defaultCameraStart(e){return{mode:a.Ey.Panorama,camera:{position:e.position,rotation:(0,d.Z)(e.rotation),zoom:0},pano:{uuid:e.id}}}validStartPano(e){return!!e&&(!(0,a.Bw)(e.mode)||!!e.pano.uuid&&this.sweepData.containsSweep(e.pano.uuid))}getStartFallback(){const e=this.sweepData.getFirstAlignedSweep()||this.sweepData.getFirstSweep();return void 0===e?null:this.defaultCameraStart(e)}getIconStartPose(e){let t=null;return e&&e in this.snapshotsData.collection&&(t=(new s.B).copy(this.buildCameraStart(this.snapshotsData.get(e)))),this.validStartPano(t)||(t=null),t}getIconThumbnail(e){if(e&&e in this.snapshotsData.collection)return this.snapshotsData.get(e).thumbnailUrl}}},86936:(e,t,n)=>{"use strict";n.d(t,{O:()=>StartLocationSetMessage});var i=n(4117);class StartLocationSetMessage extends i.v{constructor(e){super(),this.is360=e}}},99145:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CanvasExtModule});var i=n(80051),s=n(20725),r=n(57227),o=n(82722),a=n(41510),l=n(1682),c=n(47475);class CanvasExtModule extends r.Y{constructor(){super(...arguments),this.name="canvas-ext"}async init(e,t){this._canvas=e.canvas,this.msgBus=t.msgBus,this.canvasBounds=this._canvas.getBoundingClientRect(),this.bindings.push(t.commandBinder.addBinding(a.M,(async function(){})),t.commandBinder.addBinding(l.L,(async function(){})),t.commandBinder.addBinding(c.n,(async function(){}))),this.data=new o.W(this.canvasBounds.width,this.canvasBounds.height),t.market.register(this,o.W,this.data)}get element(){return this._canvas}get width(){return this.canvasBounds.width}get height(){return this.canvasBounds.height}get x(){return this.canvasBounds.left}get y(){return this.canvasBounds.top}onUpdate(){this.canvasBounds=this._canvas.getBoundingClientRect();const e=this.data.width!==this.width||this.data.height!==this.height,t=this.data.x!==this.x||this.data.y!==this.y;e&&(this.data.width=this.width,this.data.height=this.height,this.data.commit(),this.msgBus.broadcast(new s.a(this.width,this.height))),t&&(this.data.x=this.x,this.data.y=this.y,this.data.commit(),this.msgBus.broadcast(new i.k(this.x,this.y)))}}},22122:(e,t,n)=>{"use strict";n.d(t,{lb:()=>s,hf:()=>r});var i=n(41510);const s=(e=200)=>({resizeDimensions:[{property:i.P.width,setDimension:e=>e.width,duration:e},{property:i.P.height,setDimension:e=>e.height,duration:e},{property:i.P.top,setDimension:()=>0,duration:e},{property:i.P.left,setDimension:()=>0,duration:e}]}),r=(e,t,n,s=200)=>{const r=[];return void 0!==e&&r.push({property:i.P.width,setDimension:t=>t.width+e,duration:s}),void 0!==t&&r.push({property:i.P.height,setDimension:e=>e.height+t,duration:s}),void 0!==n&&r.push({property:i.P.left,setDimension:()=>n,duration:s}),{resizeDimensions:r}}},47475:(e,t,n)=>{"use strict";n.d(t,{n:()=>BlurCanvasCommand});var i=n(93037);class BlurCanvasCommand extends i.m{constructor(e,t){super(),this.name="blur-canvas",this.payload={duration:e,pixelBlur:t}}}},41510:(e,t,n)=>{"use strict";n.d(t,{P:()=>i,M:()=>ResizeCanvasCommand});var i,s=n(93037);!function(e){e.left="left",e.top="top",e.width="width",e.height="height"}(i||(i={}));class ResizeCanvasCommand extends s.m{constructor(e){super(),this.name="resize-canvas",this.payload=Object.assign({},e)}}},1682:(e,t,n)=>{"use strict";n.d(t,{L:()=>ScreenToCanvasPointCommand});var i=n(93037);class ScreenToCanvasPointCommand extends i.m{constructor(e){super(),this.name="screen-to-canvas-point",this.payload=Object.assign({},e)}}},82722:(e,t,n)=>{"use strict";n.d(t,{W:()=>CanvasData});var i=n(35424);class CanvasData extends i.V{constructor(e,t){super(),this.name="canvas",this.x=0,this.y=0,this.width=e||0,this.height=t||0}get aspectRatio(){const e=this.width/this.height;return isFinite(e)?e:1}}},3555:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CanvasModule});var i=n(57227),s=n(82722),r=n(20725),o=n(80051),a=n(41510),l=n(31013),c=n(1682),d=n(81402),u=n(47475),h=n(44450),p=n(40603);class CanvasMountError extends p.y{}const m={[a.P.width]:"width",[a.P.height]:"height",[a.P.top]:"top",[a.P.left]:"left"};class CanvasModule extends i.Y{constructor(){super(...arguments),this.name="canvas",this.getNewX=()=>0,this.getNewY=()=>0,this.getNewWidth=e=>e.width,this.getNewHeight=e=>e.height,this.activeTransitions=[],this.activeTransitionMap={left:null,top:null,width:null,height:null},this.onResize=e=>{e.propertyName in a.P&&(this.resolveActiveTransition(e.propertyName),this._canvas.style.transitionDuration=this.stringifyTransitionDurations())},this.onWindowResize=()=>{this.transitionDurations.left=this.transitionDurations.top=this.transitionDurations.width=this.transitionDurations.height="0s",this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition(),this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),this._canvas.style.transitionDuration=this.stringifyTransitionDurations()},this.resizeCanvas=async e=>{if(0!==e.resizeDimensions.length)return this.activeTransitions.forEach(this.resolveActiveTransition.bind(this)),e.resizeDimensions.forEach((e=>{const{property:t,setDimension:n,duration:i=0}=e,s=m[t],r=this._canvas.style[s];switch(t){case a.P.height:this.setHeight(n,i);break;case a.P.width:this.setWidth(n,i);break;case a.P.top:this.setY(n,i);break;case a.P.left:this.setX(n,i)}if(this._canvas.style[s]!==r&&i>0){const e=new l.Q;e.then((()=>{clearTimeout(n)}));const n=setTimeout((()=>{this.resolveActiveTransition(t)}),i+500);this.activeTransitionMap[t]=e,this.activeTransitions.push(t)}})),this.hasActiveTransitions()||(this.canvasBounds=this._canvas.getBoundingClientRect()),this.getTransitionPromise()}}async init(e,t){if(this.engine=t,!e.container)throw new CanvasMountError;this.container=e.container,this.container.appendChild(e.canvas),this.containerBounds=this.container.getBoundingClientRect(),this._canvas=e.canvas,this._canvas.setAttribute("tabindex","-1"),this._canvas.style.position="absolute",this._canvas.style.left="0",this._canvas.style.top="0",this.transitionDurations={left:"0s",top:"0s",width:"0s",height:"0s",filter:"0.4s"},this._canvas.style.transitionProperty=Object.keys(this.transitionDurations).join(","),this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.updateTransitions(),this.bindings.push((0,h.kp)(h.g_.RESIZE,this.onWindowResize),t.commandBinder.addBinding(a.M,this.resizeCanvas),this.makeTransitionEndSubscription(),t.commandBinder.addBinding(c.L,(async e=>this.screenToCanvasPoint(e.x,e.y))),t.commandBinder.addBinding(u.n,this.blur.bind(this)));for(const e of this.bindings)e.renew();this.canvasBounds=this._canvas.getBoundingClientRect(),this.containerBounds=this.container.getBoundingClientRect(),this.data=new s.W(this.canvasBounds.width,this.canvasBounds.height),t.market.register(this,s.W,this.data)}makeTransitionEndSubscription(){let e=!1;return{renew:()=>{e||(this.element.addEventListener("transitionend",this.onResize),e=!0)},cancel:()=>{e&&(this.element.removeEventListener("transitionend",this.onResize),e=!1)}}}dispose(e){super.dispose(e)}get element(){return this._canvas}get width(){return this.canvasBounds.width}get height(){return this.canvasBounds.height}get x(){return this.canvasBounds.left}get y(){return this.canvasBounds.top}onUpdate(){const e=this.container.getBoundingClientRect(),t=this.containerHasChanged(e);t&&(this.containerBounds=e,this.updateTransitions()),(t||this.hasActiveTransitions())&&(this.canvasBounds=this._canvas.getBoundingClientRect());const n=this.data.width!==this.width||this.data.height!==this.height,i=this.data.x!==this.x||this.data.y!==this.y;n&&(this.data.width=this.width,this.data.height=this.height,this.data.commit(),this.engine.broadcast(new r.a(this.width,this.height))),i&&(this.data.x=this.x,this.data.y=this.y,this.data.commit(),this.engine.broadcast(new o.k(this.x-this.containerBounds.left,this.y-this.containerBounds.top)))}containerHasChanged(e){return e.left!==this.containerBounds.left||e.top!==this.containerBounds.top||e.width!==this.containerBounds.width||e.height!==this.containerBounds.height}setX(e,t=0){this.getNewX="number"==typeof e?()=>e:e,this.transitionDurations.left=`${t}ms`,this.updateTransitions()}setY(e,t=0){this.getNewY="number"==typeof e?()=>e:e,this.transitionDurations.top=`${t}ms`,this.updateTransitions()}setWidth(e,t=0){this.getNewWidth="number"==typeof e?()=>e:e,this.transitionDurations.width=`${t}ms`,this.updateTransitions()}setHeight(e,t=0){this.getNewHeight="number"==typeof e?()=>e:e,this.transitionDurations.height=`${t}ms`,this.updateTransitions()}screenToCanvasPoint(e,t){return{x:e-this.x,y:t-this.y}}async blur(e){this.transitionDurations.filter=`${e.duration}ms`,this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this._canvas.style.filter=`blur(${e.pixelBlur}px)`,await(0,d.gw)(e.duration),0===e.pixelBlur&&(this._canvas.style.filter="")}getTransitionPromise(){return Promise.all(this.activeTransitions.map((e=>this.activeTransitionMap[e])).filter((e=>!!e)))}updateTransitions(){this._canvas.style.transitionDuration=this.stringifyTransitionDurations(),this.applySize(),this.applyPosition()}applySize(){this._canvas.style.width=`${this.getNewWidth(this.containerBounds)}px`,this._canvas.style.height=`${this.getNewHeight(this.containerBounds)}px`}applyPosition(){this._canvas.style.left=`${this.getNewX(this.containerBounds)}px`,this._canvas.style.top=`${this.getNewY(this.containerBounds)}px`}stringifyTransitionDurations(){return Object.keys(this.transitionDurations).map((e=>this.transitionDurations[e])).join(",")}resolveActiveTransition(e){this.canvasBounds=this._canvas.getBoundingClientRect();const t=this.activeTransitions.indexOf(e);-1!==t&&this.activeTransitions.splice(t,1);const n=this.activeTransitionMap[e];n&&n.resolve(),this.activeTransitionMap[e]=null,this.transitionDurations[e]="0s"}hasActiveTransitions(){return this.activeTransitions.length>0}}},14894:(e,t,n)=>{"use strict";n.d(t,{Z:()=>CommonControls});class CommonControls{}},24673:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CommonControlsModule});var i=n(57227),s=n(37363);class CommonControlsModule extends i.Y{constructor(){super(...arguments),this.name="common-controls"}async init(e,t){this.modeControls={},t.market.waitForData(s.O).then((e=>this.viewmodeData=e))}startRotateTransition(e,t,n=!0){return this.checkControlsForAction((i=>i.startRotateTransition(e,t,n)))}startZoomTransition(e,t,n=!0){return this.checkControlsForAction((i=>i.startZoomTransition(e,t,n)))}startTranslateTransition(e,t,n=!0){return this.checkControlsForAction((i=>i.startTranslateTransition(e,t,n)))}stop(){return this.checkControlsForAction((e=>(e.stop(),Promise.resolve())))}checkControlsForAction(e){if(this.viewmodeData&&null!==this.viewmodeData.currentMode){if(this.modeControls[this.viewmodeData.currentMode]){return e(this.modeControls[this.viewmodeData.currentMode].controls)}}return Promise.reject("checkControlsForAction() -> Current view mode is null")}addControls(e,t,n=!1){this.modeControls[e]&&!n||(this.modeControls[e]={mode:e,controls:t})}}},24377:(e,t,n)=>{"use strict";n.d(t,{$:()=>TogglePanoMarkerCommand});var i=n(93037);class TogglePanoMarkerCommand extends i.m{constructor(e){super(),this.id="TOGGLE_PANO_MARKER",this.payload={enabled:e}}}},3837:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CurrentPanoMarker});var i=n(57227),s=n(14877),r=n(2212),o=n(99295),a=n(55356);const l=new r.Vector3(0,1,0),c=16724312,d=[{innerRadius:0,outerRadius:.42,color:c,opacity:.7},{innerRadius:.67,outerRadius:1,color:c,opacity:.7}];class MarkerRenderer{constructor(e,t,n){this.scene=e,this.sweepData=t,this.mesh=new a.f({radius:.25,normal:l,rings:d}),this.mesh.name="CurrentPanoMarker",this.mesh.renderOrder=o.z.panoMarker,this.mesh.layers.mask=n.mask}init(){}dispose(){this.mesh.dispose()}render(){const e=this.sweepData.currentAlignedSweepObject;e&&this.move(e.floorPosition)}activate(){this.scene.add(this.mesh)}deactivate(){this.scene.remove(this.mesh)}move(e){this.mesh.position.copy(e).setY(e.y+MarkerRenderer.floorOffset)}}MarkerRenderer.floorOffset=.01;var u=n(37363),h=n(53549),p=n(24377),m=n(22878),f=n(61903),g=n(64969);class CurrentPanoMarker extends i.Y{constructor(){super(...arguments),this.name="current-pano-marker",this.state={markerEnabled:!1,transitionPromise:null}}async init(e,t){const n=(await t.getModuleBySymbol(s.y.WEBGL_RENDERER)).getScene(),i=t.claimRenderLayer(this.name),[r,o,a]=await Promise.all([t.market.waitForData(f.e),t.market.waitForData(h.Z),t.market.waitForData(u.O)]);this.engine=t,this.settingsData=r,this.sweepData=o,this.viewmodeData=a,this.markerRenderer=new MarkerRenderer(n,o,i),this.bindings.push(t.commandBinder.addBinding(p.$,(async({enabled:e})=>this.setCommandOverride(e))),this.viewmodeData.makeModeChangeSubscription((()=>this.updateMarker())),this.sweepData.makeSweepChangeSubscription((()=>this.updateMarker())),this.settingsData.onPropertyChanged(g.o,(()=>this.updateMarker()))),this.updateMarker()}setCommandOverride(e){this.state.commandOverride=e,this.updateMarker()}async updateMarker(){const{commandOverride:e}=this.state,t=this.viewmodeData.currentMode,n=this.sweepData.currentAlignedSweepObject,i=!1===this.settingsData.tryGetProperty(g.o,!0)||!1===e||(0,m.Bw)(t)||t===m.Ey.Transition;return this.toggleMarker(!!n&&!i)}async toggleMarker(e){const{markerEnabled:t,transitionPromise:n}=this.state;if(n&&await n,t===e)return;const i=e?this.enableMarker():this.disableMarker();return this.state.transitionPromise=i.finally((()=>{this.state.markerEnabled=e,this.state.transitionPromise=null})),this.state.transitionPromise}async enableMarker(){return this.engine.addComponent(this,this.markerRenderer)}async disableMarker(){return this.engine.removeComponent(this,this.markerRenderer)}}},64969:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i="features/current_sweep_indicator"},57312:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});const i="features/cursor"},35784:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CursorDataModule});var i=n(14877),s=n(57227),r=n(2212),o=n(34629),a=n(45803),l=n(70399),c=n(368);class CursorDataModule extends s.Y{constructor(){super(...arguments),this.name="cursor-data",this.cursorState=new a.Y,this.position=new r.Vector2,this.timeToFade=0,this.onPointerMove=()=>{if(null!==this.raycasterData.hit&&this.raycasterData.pointerNdcPosition.distanceToSquared(this.position)>CursorDataModule.movementThreshold){this.position.copy(this.raycasterData.pointerNdcPosition),this.timeToFade=CursorDataModule.fadeOutDelay;const e=(0,o.t)(0,CursorDataModule.fadeInDuration,1-this.cursorState.opacity.value);this.cursorState.opacity.modifyAnimation(this.cursorState.opacity.value,1,e),this.cursorState.commit()}}}async init(e,t){this.input=await t.getModuleBySymbol(i.y.INPUT),this.raycasterData=await t.market.waitForData(c.P),t.market.register(this,a.Y,this.cursorState),this.bindings.push(this.input.registerHandler(l.mE,this.onPointerMove)),CursorDataModule.fadeInDuration>CursorDataModule.fadeOutDelay&&this.log.warn("fadeInDuration should be less than fadeOutDelay!")}onUpdate(e){let t=!1;this.timeToFade>0&&(this.timeToFade-=e,this.timeToFade<=0&&(t=!0)),this.cursorState.opacity.tick(e),this.cursorState.commit(),t&&this.cursorState.opacity.modifyAnimation(1,0,CursorDataModule.fadeOutDuration)}dispose(e){super.dispose(e)}}CursorDataModule.fadeOutDelay=700,CursorDataModule.fadeOutDuration=700,CursorDataModule.fadeInDuration=300,CursorDataModule.movementThreshold=.003},45803:(e,t,n)=>{"use strict";n.d(t,{Y:()=>CursorData});var i=n(41252),s=n(35424);class CursorData extends s.V{constructor(){super(),this.name="cursor",this.opacity=new i.z(0),this.texture=null}}},65481:(e,t,n)=>{"use strict";var i;n.d(t,{L:()=>i}),function(e){e[e.Reticle=0]="Reticle",e[e.GridPlane=1]="GridPlane"}(i||(i={}))},58193:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>CursorMesh});var i=n(57227),s=n(14877),r=n(2212),o=n(45803),a=n(368),l=n(33299),c=n(65481),d=n(99295),u=n(55356);const h=[{outerRadius:.977,innerRadius:.926,color:16777215,opacity:1},{outerRadius:.898,innerRadius:.648,color:16777215,opacity:.73}];class Cursor{constructor(e,t=l.o.ALL){this.scene=e,this.layer=t,this.supportsMobile=!1,this.style=c.L.Reticle,this.bindings=[],this.onCursorDataUpdated=e=>{this.mesh.configure({opacity:e.opacity.value,texture:e.texture})},this.onPositionUpdate=e=>{if(e.hit&&e.hit.face){const t=e.hit.point.clone(),n=e.hit.face.normal;this.container.position.copy(t),this.mesh.configure({normal:n})}},this.container=new r.Group,this.container.name="cursor",this.mesh=new u.f({radius:.2,rings:h}),this.container.add(this.mesh),this.mesh.renderOrder=d.z.reticule,this.mesh.layers.mask=this.layer.mask}init(){}render(){}dispose(){this.mesh.dispose(),this.container.children.forEach((e=>{if(e.isMesh&&e!==this.mesh){e.geometry.dispose();const t=e.material;t.dispose(),t.map&&t.map.dispose()}}))}async activate(e){const t=await e.market.waitForData(o.Y),n=await e.market.waitForData(a.P);this.bindings.push(t.onChanged(this.onCursorDataUpdated),n.onChanged(this.onPositionUpdate)),this.scene.add(this.container)}deactivate(){for(const e of this.bindings)e.cancel();this.bindings.length=0,this.scene.remove(this.container)}setVisible(e){this.container.visible=e}}class CursorMesh extends i.Y{constructor(){super(...arguments),this.name="cursor-mesh",this.setVisible=e=>{this.cursor&&this.cursor.setVisible(e)}}async init(e,t){const n=(await t.getModuleBySymbol(s.y.WEBGL_RENDERER)).getScene(),i=t.claimRenderLayer(this.name);this.cursor=new Cursor(n,i),t.addComponent(this,this.cursor)}get container(){return this.cursor.container}}},90818:(e,t,n)=>{"use strict";n.d(t,{C:()=>SetDollhouseVerticalLimits});var i=n(93037);class SetDollhouseVerticalLimits extends i.m{constructor(e){super(),this.payload=e,this.id="DOLLHOUSE_VERTICAL_LIMITS"}}},93314:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>DollhouseControls});var i=n(57227),s=n(14877),r=n(77280),o=n(24673),a=n(17921),l=n(76922),c=n(94113),d=n(43985),u=n(19926),h=n(8054),p=n(92214),m=n(37363),f=n(22878),g=n(2252),v=n(74170),y=n(994),b=n(63387),S=n(2212),E=n(41674),T=n(36540),w=n(39808),x=n(85111),_=n(14894),M=n(31013),O=n(14832);const A=1e3/60,C=89*y.Ue,N=.001*y.Ue,D=.25,I=Math.PI/1e3,L=x.Z.epsilon;class CameraControls extends _.Z{constructor(e,t,n,i=!1){super(),this.cameraPoseProxy=e,this.cameraCheck=t,this.tempOrientation=new S.Quaternion,this.tempAxis=new S.Vector3,this.nextPosition=new S.Vector3,this.nextOrientation=new S.Quaternion,this.currentOrientation=new S.Quaternion,this.currentPosition=new S.Vector3,this.positionDelta=new S.Vector3,this.angularAccel=new S.Vector2,this.angularVelocity=new S.Vector2,this.linearAccel=new S.Vector2,this.linearVelocity=new S.Vector2,this.zoomAccel=0,this.zoomVelocity=0,this.cameraOrientation=new S.Euler,this.aimTarget=new S.Vector3,this.poseController=null,this.currentPhiLowerLimit=N,this.currentPhiUpperLimit=C,this.checkBounds=i,this._maxZoomDistance=Math.max(30,1.5*n.getSize(new S.Vector3).length()),this.transition={active:!1,startTime:0,elapsed:0,duration:0,angularVelocity:new S.Vector2,linearVelocity:new S.Vector2,zoomVelocity:0,easeOut:!1}}onAccessGranted(e){this.poseController=e}onAccessRevoked(e){this.stop()}get maxZoomDistance(){return this._maxZoomDistance}setOrbitalAcceleration(e,t=!1){this.transition.active||(t&&this.haltVelocity(e,this.angularVelocity),this.angularAccel.x=void 0!==e.x?e.x:this.angularAccel.x,this.angularAccel.y=void 0!==e.y?e.y:this.angularAccel.y)}setPanAcceleration(e,t=!1){this.transition.active||(t&&this.haltVelocity(e,this.linearVelocity),this.linearAccel.x=void 0!==e.x?e.x:this.linearAccel.x,this.linearAccel.y=void 0!==e.y?e.y:this.linearAccel.y)}setZoomAcceleration(e){this.transition.active||(this.zoomAccel=e)}async setPhiLimits(e,t,n){this.currentPhiLowerLimit=e,this.currentPhiUpperLimit=t;const i=this.cameraPoseProxy.pose;this.cameraOrientation.setFromQuaternion(i.rotation,"YXZ");const s=-this.cameraOrientation.x,r=(0,v.uZ)(0,this.currentPhiLowerLimit-s,this.currentPhiUpperLimit-s);Math.abs(r)>L&&n&&await this.orbit(new S.Vector2,!0)}haltVelocity(e,t){e.x&&t.x&&Math.sign(e.x)!==Math.sign(t.x)&&(t.x=0),e.y&&t.y&&Math.sign(e.y)!==Math.sign(t.y)&&(t.y=0)}startTransition(e,t,n,i,s){if(null===this.poseController)return M.Q.reject("Unable to start transition, since controller is unavailable.");const r=new M.Q;return this.transition.active=!0,this.transition.duration=e,this.transition.elapsed=0,this.transition.startTime=Date.now(),this.transition.deferred=r,this.transition.angularVelocity.copy(t),this.transition.linearVelocity.copy(n),this.transition.zoomVelocity=i,this.transition.easeOut=s,this.angularAccel.set(0,0),this.linearAccel.set(0,0),this.zoomAccel=0,this.angularVelocity.copy(t),this.linearVelocity.copy(n),this.zoomVelocity=i,this.poseController.beginExternalTransition(),r.promise()}stopTransition(){this.transition.active&&(this.poseController&&this.poseController.endExternalTransition(),this.transition.active=!1),this.transition.deferred&&(this.transition.deferred.resolve(),this.transition.deferred=void 0)}updateTransition(e,t,n,i){let s=1,r=e/A;if(this.transition.elapsed+=e,this.transition.elapsed>=this.transition.duration){s=(this.transition.duration-(this.transition.elapsed-e))/e,r=1}t&&(this.angularVelocity.copy(this.transition.angularVelocity).multiplyScalar(s*r),this.orbit(this.angularVelocity)),n&&(this.linearVelocity.copy(this.transition.linearVelocity).multiplyScalar(s*r),this.pan(this.linearVelocity)),i&&(this.zoomVelocity=this.transition.zoomVelocity*s*r,this.zoom(this.zoomVelocity)),this.transition.elapsed>=this.transition.duration&&(this.stop(this.transition.easeOut),this.transition.active=!1)}updateDefault(e,t,n,i){const s=e/A;t&&(this.angularVelocity.addScaledVector(this.angularAccel,s),this.orbit(this.angularVelocity),this.angularVelocity.multiplyScalar(Math.pow(.92,s))),n&&(this.linearVelocity.addScaledVector(this.linearAccel,s),this.pan(this.linearVelocity),this.linearVelocity.multiplyScalar(Math.pow(.92,s))),i&&(this.zoomVelocity+=this.zoomAccel*s,this.zoom(this.zoomVelocity),this.zoomVelocity*=Math.pow(.84,s))}startRotateTransition(e,t,n){return t.x*=-1,this.startTransition(e,t.clone().multiplyScalar(A),new S.Vector2,0,n).nativePromise()}startTranslateTransition(e,t,n=!0){return this.startTransition(e,new S.Vector2,t.clone().multiplyScalar(A),0,n).nativePromise()}startZoomTransition(e,t,n){return this.startTransition(e,new S.Vector2(0,0),new S.Vector2(0,0),t,n).nativePromise()}update(e){const t=this.angularAccel.length()>L||this.angularVelocity.length()>L,n=this.linearAccel.length()>L||this.linearVelocity.length()>L,i=Math.abs(this.zoomAccel)>L||Math.abs(this.zoomVelocity)>L;this.transition.active?this.updateTransition(e,t,n,i):this.updateDefault(e,t,n,i)}stopMomentum(){this.transition.active||(this.angularVelocity.set(0,0),this.linearVelocity.set(0,0),this.zoomVelocity=0)}stopAcceleration(){this.transition.active||(this.setOrbitalAcceleration({x:0,y:0}),this.setPanAcceleration({x:0,y:0}),this.setZoomAcceleration(0))}stop(e=!1){this.stopTransition(),this.stopAcceleration(),e||this.stopMomentum()}pan(e){if(!this.poseController)return;const t=this.cameraPoseProxy.pose;this.positionDelta.x=e.x,this.positionDelta.z=e.y,this.nextPosition.copy(t.position).add(this.positionDelta),this.checkBounds&&!this.cameraCheck(this.nextPosition,t.rotation,t.focalDistance)||(this.currentPosition.copy(this.nextPosition),this.poseController.updateCameraPosition(this.currentPosition))}orbit(e,t=!1){if(!this.poseController)return;const n=this.cameraPoseProxy.pose;this.cameraOrientation.setFromQuaternion(n.rotation,"YXZ");const i=-this.cameraOrientation.x,s=(0,v.uZ)(e.y,this.currentPhiLowerLimit-i,this.currentPhiUpperLimit-i);if(this.aimTarget.copy(r.f.FORWARD).applyQuaternion(n.rotation),this.aimTarget.setLength(n.focalDistance),this.aimTarget.addVectors(n.position,this.aimTarget),this.tempAxis.copy(r.f.RIGHT),this.tempOrientation.setFromAxisAngle(this.tempAxis.applyQuaternion(n.rotation),-s),this.nextPosition.copy(n.position).sub(this.aimTarget).applyQuaternion(this.tempOrientation),this.nextOrientation.copy(n.rotation).premultiply(this.tempOrientation),this.tempOrientation.setFromAxisAngle(r.f.UP,e.x),this.nextPosition.applyQuaternion(this.tempOrientation),this.nextOrientation.premultiply(this.tempOrientation),this.nextPosition=this.nextPosition.add(this.aimTarget),this.nextOrientation.normalize(),!this.checkBounds||this.cameraCheck(n.position,this.nextOrientation,n.focalDistance)){if(this.currentPosition.copy(this.nextPosition),this.currentOrientation.copy(this.nextOrientation),t)return this.poseController.moveTo({transitionType:O.n.Interpolate,pose:{position:this.currentPosition.clone(),rotation:this.currentOrientation.clone()},transitionTime:500});n.rotation.equals(this.currentOrientation)||(this.poseController.updateCameraPosition(this.currentPosition),this.poseController.updateCameraRotation(this.currentOrientation))}}zoom(e){if(!this.poseController)return;const t=this.cameraPoseProxy.pose,n=this.maxZoomDistance-D,i=t.focalDistance,s=(0,v.uZ)(e*n+i,D,this.maxZoomDistance)-i,o=t.focalDistance+s;this.nextPosition.copy(t.position).add(r.f.FORWARD.clone().applyQuaternion(t.rotation).setLength(-s)),this.checkBounds&&!this.cameraCheck(this.nextPosition,t.rotation,o)||(this.currentPosition.copy(this.nextPosition),this.poseController.updateCameraPosition(this.currentPosition),this.poseController.updateCameraFocus(o))}}var P=n(7692);class CameraTouchControls{constructor(e,t,n){this.poseProxy=e,this.cameraCheck=t,this.raycaster=n,this.movingCamera=!1,this.smoothedTouch0=new S.Vector2,this.smoothedTouch1=new S.Vector2,this.origTouchAxis=new S.Vector2,this.origCenterPt=new S.Vector2,this.plane=new S.Plane(r.f.UP.clone(),0),this.originalPinchLength=0,this.pointersMoved=(()=>{const e=new S.Vector2,t=new S.Vector3,n=new S.Vector3,i=new S.Vector2,s=new S.Vector3;return o=>{if(!this.poseController)return;this.smoothedTouch0.lerp(o[0].position,.2),this.smoothedTouch1.lerp(o[1].position,.2),i.copy(this.smoothedTouch1).sub(this.smoothedTouch0).normalize();const a=this.origTouchAxis.angle()-i.angle();t.copy(this.initialPose.position);const l=new S.Vector3(-this.intersectionPt.x,0,-this.intersectionPt.z);t.add(l),t.applyAxisAngle(r.f.UP,a),l.negate(),t.add(l);const c=(new S.Quaternion).copy(this.initialPose.rotation),d=(new S.Quaternion).setFromAxisAngle(r.f.UP,a);c.premultiply(d);const u=this.smoothedTouch0.clone().lerp(this.smoothedTouch1,.5),h=new S.Vector3;if(n.copy(r.f.FORWARD).applyQuaternion(c),this.castFrom(u.x,n.y<-.01?u.y:this.origCenterPt.y,h),isNaN(h.x))return void(this.movingCamera=!1);h.x-=this.intersectionPt.x,h.z-=this.intersectionPt.z,h.negate(),h.applyAxisAngle(r.f.UP,a);const p=1-1/(e.subVectors(this.smoothedTouch0,this.smoothedTouch1).length()/this.originalPinchLength),m=t.add(h).lerp(this.intersectionPt,p).clone(),f=s.subVectors(m,this.intersectionPt).length();this.cameraCheck(m,c,f)&&this.poseController&&(this.poseController.updateCameraPosition(m),this.poseController.updateCameraRotation(c),this.poseController.updateCameraFocus(f))}})(),this.initMove=(()=>{const e=new S.Vector2,t=new S.Ray,n=new S.Vector3;return i=>{const s=i[0].position,o=i[1].position;this.smoothedTouch0.copy(s),this.smoothedTouch1.copy(o),this.originalPinchLength=e.subVectors(s,o).length(),this.origTouchAxis.copy(o).sub(s).normalize(),this.origCenterPt.copy(s).lerp(o,.5);const{pose:a}=this.poseProxy;this.initialPose=a.clone();const l=new S.Vector3,c=new S.Vector3;(0,P.Kh)(this.initialPose,l.set(this.origCenterPt.x,this.origCenterPt.y,-1),l),(0,P.Kh)(this.initialPose,c.set(this.origCenterPt.x,this.origCenterPt.y,1),c),c.sub(l).normalize();const d=this.raycaster.picking.pick(l,c);d||(t.set(l,c),t.at(a.focalDistance,n)),this.intersectionPt=d?d.point:n,this.plane.set(r.f.UP.clone(),0),this.plane.translate(new S.Vector3(0,this.intersectionPt.y,0))}})(),this.castFrom=(()=>{const e=new S.Ray,t=new S.Vector3,n=new S.Vector3;return(i,s,r)=>{(0,P.Kh)(this.initialPose,t.set(i,s,-1),t),(0,P.Kh)(this.initialPose,n.set(i,s,1),n),n.sub(t).normalize(),e.set(t,n),e.intersectPlane(this.plane,r)&&!r.equals(t)||(r.x=NaN),r.y=0}})()}rawPointerUpdate(e){const t=this.movingCamera;this.movingCamera=2===e.pointers.length&&!!this.poseController,this.movingCamera&&(t?this.pointersMoved(e.pointers):this.initMove(e.pointers))}onAccessGranted(e){this.poseController=e}onAccessRevoked(e){this.poseController=void 0,this.movingCamera=!1}}var R,k=n(90818);!function(e){e[e.NONE=h.r3.NONE]="NONE",e[e.ROTATE=h.r3.PRIMARY]="ROTATE",e[e.PAN=h.r3.SECONDARY]="PAN",e[e.ZOOM=h.r3.MIDDLE]="ZOOM"}(R||(R={}));class DollhouseControls extends i.Y{constructor(){super(...arguments),this.name="dollhouse-controls",this.controlState=R.NONE,this.movementKeys=new S.Vector2,this.adjustedBounds=new S.Box3,this.didDrag=!1,this.resetControlState=()=>{this.controlState=R.NONE},this.convertDeltaToLocal=(()=>{const e=new S.Vector3,t=new S.Vector3;return n=>{const i=n.x||0,s=n.y||0,o=2*i*this.cameraPoseProxy.pose.focalDistance,a=2*s*this.cameraPoseProxy.pose.focalDistance/this.cameraPoseProxy.pose.aspect();return e.copy(r.f.RIGHT).applyQuaternion(this.cameraPoseProxy.pose.rotation).setY(0).setLength(o),t.copy(r.f.FORWARD).applyQuaternion(this.cameraPoseProxy.pose.rotation),e.add(t.setY(0).setLength(a)),e}})(),this.cameraCheck=(()=>{function e(e){return e.x>=1||e.x<=-1||e.y>=1||e.y<=-1||e.z<=-1||e.z>=1}const t=[];for(let e=0;e<8;e++)t.push(new S.Vector3);const n=new S.Matrix4,i=new S.Matrix4,s=new S.Box3;return(o,a,l)=>{if(l<D)return!1;if(!(0,b.cb)(o,a,this.cameraPoseProxy.pose.projection,this.adjustedBounds))return!1;(0,b.jB)(this.meshData.extendedBounds,t),n.compose(o,a,r.f.UNIT),n.invert(),i.copy(this.cameraPoseProxy.pose.projection.asThreeMatrix4()),s.makeEmpty();let c=!1;for(let e=0;e<8;e++)t[e].applyMatrix4(n),t[e].z=(0,v.uZ)(t[e].z,-E.oR.far,-E.oR.near),t[e].applyMatrix4(i),s.expandByPoint(t[e]);c=e(s.min)||e(s.max),s.min.clampScalar(-1,1),s.max.clampScalar(-1,1);return(s.max.x-s.min.x)*(s.max.y-s.min.y)>(c?.05:.01)}})()}async init(e,t){this.cameraPoseProxy=e.cameraPoseProxy,[this.viewmodeData,this.meshData,this.commonControlsModule]=await Promise.all([t.market.waitForData(m.O),t.market.waitForData(w._),t.getModule(o.default)]),this.controls=new CameraControls(this.cameraPoseProxy,this.cameraCheck,this.meshData.extendedBounds,!0),this.bindings.push(t.subscribe(p.Z,(e=>{this.controls.stop(),this.resetControlState()}))),t.commandBinder.addBinding(k.C,(async e=>this.controls.setPhiLimits(void 0!==e.phiLowerLimitDegrees?e.phiLowerLimitDegrees*y.Ue:N,void 0!==e.phiUpperLimitDegrees?e.phiUpperLimitDegrees*y.Ue:C,this.validateViewmode())));const n=await t.getModuleBySymbol(s.y.INPUT);this.setupBounds(),this.commonControlsModule.addControls(f.Ey.Dollhouse,this.controls);const i=await t.getModuleBySymbol(s.y.RAYCASTER);this.cameraTouchControls=new CameraTouchControls(this.cameraPoseProxy,this.cameraCheck,i),this.bindings.push(n.registerHandler(a.a,(e=>{this.validateViewmode()&&this.onScrollWheel(e)}))),this.bindings.push(n.registerHandler(l.E0,(e=>{this.validateViewmode()&&(this.didDrag=!1,this.onDragBegin(e.buttons))}))),this.bindings.push(n.registerHandler(l._R,(e=>{this.validateViewmode()&&(e.timeSinceLastMove<100&&this.didDrag&&(this.onDrag(e.delta),this.controls.update(A),this.controls.stopAcceleration()),this.onDragEnd(e.delta,e.buttons))}))),this.bindings.push(n.registerHandler(l._t,(e=>{this.validateViewmode()&&(this.didDrag=!0,this.onDrag(e.delta),this.controls.update(A),this.controls.stop())}))),this.bindings.push(n.registerHandler(T.h,(e=>{this.validateViewmode()&&this.cameraTouchControls.rawPointerUpdate(e)}))),this.bindings.push(n.registerHandler(c.e,(e=>{this.validateViewmode()&&e.state!==u.M.PRESSED&&this.onKey(e.key,e.state)}))),this.cameraPoseProxy.newSession(this)}onUpdate(e){this.validateViewmode()&&this.controls.update(e)}onAccessGranted(e){this.controls.onAccessGranted(e),this.cameraTouchControls.onAccessGranted(e)}onAccessRevoked(e){this.controls.onAccessRevoked(e),this.cameraTouchControls.onAccessRevoked(e)}onScrollWheel(e){if(0!==e.delta.y){const t=1/this.cameraPoseProxy.pose.focalDistance*2,n=this.modelSize;this.controls.setZoomAcceleration(.1*e.delta.y/(t*n*500)),this.controls.update(A),this.controls.setZoomAcceleration(0)}}onDragBegin(e){if(this.controlState===R.NONE){const t=e;this.controlState=t}this.controls.stop()}onDrag(e){switch(this.controlState){case R.ROTATE:this.controls.setOrbitalAcceleration({x:-Math.PI*e.x,y:-Math.PI*e.y});break;case R.PAN:const t=this.convertDeltaToLocal(e);this.controls.setPanAcceleration({x:-t.x,y:-t.z});break;case R.ZOOM:0!==e.y&&this.controls.setZoomAcceleration(-e.y)}}onDragEnd(e,t){t&this.controlState||(this.controlState=R.NONE,(0,g.tq)()&&this.controls.stop())}onKey(e,t){const n=t===u.M.DOWN;let i=!1;switch(e){case d.R.LEFTARROW:case d.R.J:this.controls.setOrbitalAcceleration({x:n?I:0},!0);break;case d.R.RIGHTARROW:case d.R.L:this.controls.setOrbitalAcceleration({x:n?-I:0},!0);break;case d.R.UPARROW:case d.R.I:this.controls.setOrbitalAcceleration({y:n?-I:0},!0);break;case d.R.DOWNARROW:case d.R.K:this.controls.setOrbitalAcceleration({y:n?I:0},!0);break;case d.R.W:this.movementKeys.y=n?1:0,i=!0;break;case d.R.S:this.movementKeys.y=n?-1:0,i=!0;break;case d.R.D:this.movementKeys.x=n?1:0,i=!0;break;case d.R.A:this.movementKeys.x=n?-1:0,i=!0}if(i){const e=this.convertDeltaToLocal(this.movementKeys).setLength(.02);this.controls.setPanAcceleration({x:e.x,y:e.z})}}validateViewmode(){return this.viewmodeData.currentMode===f.Ey.Dollhouse}setupBounds(){function e(e,t){return Math.sign(e+t)===Math.sign(e)?e+t:0}this.modelSize=Math.max(this.meshData.extendedSize.length(),1),this.adjustedBounds.copy(this.meshData.extendedBounds);const t=-2;this.adjustedBounds.min.x=e(this.adjustedBounds.min.x,t),this.adjustedBounds.min.y=e(this.adjustedBounds.min.y,t),this.adjustedBounds.min.z=e(this.adjustedBounds.min.z,t),this.adjustedBounds.max.x=e(this.adjustedBounds.max.x,2),this.adjustedBounds.max.y=e(this.adjustedBounds.max.y,2),this.adjustedBounds.max.z=e(this.adjustedBounds.max.z,2);const n=new S.Vector3;this.adjustedBounds.getSize(n),this.adjustedBounds.setFromCenterAndSize(this.meshData.meshCenter,n)}}},92165:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Fatcaster});var i=n(57227),s=n(14877),r=n(96765),o=n(2212),a=n(77280);class Fatcaster extends i.Y{constructor(){super(...arguments),this.name="fat-caster",this.rayAssembly=new Array(Fatcaster.rayCount),this.rayPlaneOrientation=new o.Quaternion,this.rayVisuals=[]}async init(e,t){this.config={debug:!!e.debug},this.raycaster=await t.getModuleBySymbol(s.y.RAYCASTER);for(let e=0;e<Fatcaster.rayCount;++e)this.rayAssembly[e]=new o.Ray;if(e.debug){const e=(await t.getModuleBySymbol(s.y.WEBGL_RENDERER)).getScene();for(let t=0;t<Fatcaster.rayCount;++t){this.rayVisuals[t]=new o.ArrowHelper(new o.Vector3,new o.Vector3);const n=this.rayVisuals[t];n.remove(n.cone),n.setLength(1e3),e.add(this.rayVisuals[t])}}}async dispose(e){const t=(await e.getModuleBySymbol(s.y.WEBGL_RENDERER)).getScene();for(const e of this.rayVisuals)t.remove(e)}get ray(){return this.raycaster.pointer.pointerRay.clone()}cast(e,t,n=r.a.Filter.AVERAGE){const i=this.ray;return this.updateRayAssembly(i.origin,i.direction,e),this.castRays(t,n)}castRays(e,t){const n=[];let i=null;for(const t of this.rayAssembly){const s=this.raycaster.picking.pick(t.origin,t.direction,e);s&&(t===this.rayAssembly[0]&&(i=s),s.point.add(this.rayAssembly[0].origin).sub(t.origin),n.push(s))}return t(n,i,this.rayAssembly)}updateRayAssembly(e,t,n){for(const e of this.rayAssembly)e.direction.copy(t);if(this.rayPlaneOrientation.setFromUnitVectors(a.f.FORWARD,t),this.rayAssembly[0].origin.copy(e),this.rayAssembly[1].origin.copy(a.f.RIGHT).multiplyScalar(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[2].origin.copy(a.f.UP).multiplyScalar(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[3].origin.copy(a.f.LEFT).multiplyScalar(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[4].origin.copy(a.f.DOWN).multiplyScalar(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[5].origin.copy(a.f.UP).add(a.f.RIGHT).setLength(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[6].origin.copy(a.f.UP).add(a.f.LEFT).setLength(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[7].origin.copy(a.f.DOWN).add(a.f.RIGHT).setLength(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.rayAssembly[8].origin.copy(a.f.DOWN).add(a.f.LEFT).setLength(n).applyQuaternion(this.rayPlaneOrientation).add(e),this.config.debug)for(let e=0;e<this.rayVisuals.length;++e){const n=this.rayVisuals[e];n.setDirection(t),n.position.copy(this.rayAssembly[e].origin)}}}Fatcaster.rayCount=9},96765:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var i,s=n(2212);!function(e){let t;!function(e){const t=e=>{for(const t of e)if(t.face)return{point:t.point,object:t.object,distance:t.distance,face:t.face};return null},n=(e,t)=>e.distance-t.distance;e.CENTER_FIRST=(e,n)=>n&&n.face?{point:n.point,normal:n.face.normal,object:n.object,distance:n.distance,face:n.face}:t(e),e.CLOSEST=e=>t(e.sort(n)),e.AVERAGE=e=>{if(0===e.length)return null;const t={point:new s.Vector3,face:{a:0,b:1,c:2,normal:new s.Vector3,materialIndex:0},distance:0,object:e[0].object};for(const n of e)t.face&&n.face&&(t.point.add(n.point),t.face.normal.add(n.face.normal));return t.point.divideScalar(e.length),t.face&&t.face.normal.divideScalar(e.length).normalize(),t};e.CENTER_GROUP=t=>(n,s,r)=>{if(s){const i=[s];for(let e=1;e<n.length&&e<3;++e){const o=n[e];if(o.face){const n=Math.abs(r[e].direction.dot(o.face.normal));s.point.distanceTo(o.point)*n<=t&&i.push(o)}}if(i.length>=3){const t=e.AVERAGE(i,null,r);if(t&&t.face&&s.face)return t.face.normal=s.face.normal,t}}const o=i(n,r,t);return o?e.AVERAGE(o,null,r):e.CENTER_FIRST(n,s,r)};const i=(e,t,i)=>{const s=e.slice().sort(n),r=[s[0]];let o;for(o=1;o<s.length&&r.length<3;++o){const e=s[o];if(e.face){const n=Math.abs(t[o].direction.dot(e.face.normal));r[0].point.distanceTo(e.point)*n>i&&(r.length=0),r.push(e)}}return r.length<3?null:r}}(t=e.Filter||(e.Filter={}))}(i||(i={}))},47076:(e,t,n)=>{"use strict";n.d(t,{Z:()=>GetFloorIntersectCommand});var i=n(93037);class GetFloorIntersectCommand extends i.m{constructor(e){super(),this.payload=Object.assign({},e)}}},28452:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GetFloorIntersectCommand:()=>i.Z,default:()=>v});var i=n(47076),s=n(14877),r=n(70446),o=n(57227),a=n(15099),l=n(7692),c=n(39823),d=n(37363),u=n(22878),h=n(75977),p=n(43816),m=n(26517),f=n(2212),g=n(77280);class FloorCaster extends o.Y{constructor(){super(...arguments),this.name="floor-caster",this.cameraPosition=new f.Vector3,this.forwardPosition=new f.Vector3,this.targetPlane=new f.Plane}async init(e,t){this.engine=t,[this.renderer,this.cameraData,this.viewmodeData,this.raycaster,this.floorsData,this.meshQuery]=await Promise.all([t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.market.waitForData(a.M_),t.market.waitForData(d.O),t.getModuleBySymbol(s.y.RAYCASTER),t.market.waitForData(c.i),t.getModuleBySymbol(s.y.MESH_QUERY)]),t.commandBinder.addBinding(i.Z,(e=>this.castToFloor(e.screenPosition,e.height,e.includeHiddenFloors)))}async castToFloor(e,t,n=!0){await this.engine.after(r.A.End);const i=this.renderer.getScene().camera,s=(0,l.z5)(e.x,e.y,this.cameraData.width,this.cameraData.height);let o,a=null;this.cameraPosition.set(s.x,s.y,-1).unproject(i),this.forwardPosition.set(s.x,s.y,1).unproject(i);const c=this.raycaster.picking.cast(this.cameraPosition,this.forwardPosition.clone().sub(this.cameraPosition).normalize(),n?p.T0:p.Pv)[0];if(c&&c.object instanceof h.S){a=c&&c.point||null;const e=this.meshQuery.floorIdFromObject(c.object);e?o=this.floorsData.getFloor(e):a&&(o=this.floorsData.getClosestFloorAtHeight(a.y))}if(void 0!==t){this.cameraPosition.copy(this.cameraData.pose.position);const e=(0,l.st)(this.cameraData,s);if(this.viewmodeData.currentMode!==u.Ey.Floorplan){const n=(0,m.n0)(this.cameraPosition,e);this.targetPlane.set(g.f.DOWN,t),a=(0,m.Fe)(this.cameraPosition,n,this.targetPlane)||null}else e.y=t,a=e}const d=o?o.index:-1;return{position:a,floor:d,floorIndex:d}}}const v=FloorCaster},11542:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>FloorplanControls});var i=n(2212),s=n(77280),r=n(87727),o=n(85111),a=n(29949);class CameraControls extends a.B{constructor(e,t,n,i=!1){super(e,t,n,i),this.cameraModule=e,this.angularAccel=0,this.angularVelocity=0,this.transition.angularVelocity=0}setRollAcceleration(e,t=!1){this.transition.active||(t&&e&&this.angularVelocity&&Math.sign(e)!==Math.sign(this.angularVelocity)&&(this.angularVelocity=0),this.angularAccel=e)}startRotateTransition(e,t,n){return this.startTransition(e,t.x*r.SI,new i.Vector2,0,n).nativePromise()}startTransition(e,t,n,i,s){return this.transition.angularVelocity=t,this.angularVelocity=t,this.angularAccel=0,super.startTransition(e,t,n,i,s)}update(e){super.update(e);(Math.abs(this.angularAccel)>o.Z.epsilon||Math.abs(this.angularVelocity)>o.Z.epsilon)&&(this.transition.active?this.updateAngularTransition(e):this.updateAngularDefault(e))}stopMomentum(){super.stopMomentum(),this.transition.active||(this.angularVelocity=0)}stopAcceleration(){super.stopAcceleration(),this.transition.active||this.setRollAcceleration(0)}updateAngularTransition(e){const t=this.getTransitionScale(e);this.angularVelocity=this.transition.angularVelocity*t,this.roll(this.angularVelocity)}updateAngularDefault(e){const t=e/r.SI;this.angularVelocity=this.angularVelocity+this.angularAccel*t,this.roll(this.angularVelocity),this.angularVelocity*=Math.pow(1-r.O8,t)}roll(e){const t=this.cameraModule.getData(!1);this.currentOrientation.setFromAxisAngle(s.f.FORWARD,e),this.currentOrientation.multiplyQuaternions(t.pose.rotation,this.currentOrientation),this.currentOrientation.normalize(),this.checkBounds&&!this.insideBounds(t.pose.position,this.currentOrientation,t.pose.projection)||t.pose.rotation.equals(this.currentOrientation)||this.cameraModule.updateCameraRotation(this.currentOrientation)}}var l=n(79846),c=n(93145),d=n(14877),u=n(43985),h=n(19926),p=n(22878),m=n(8054);const f=Math.PI/2/1e3;var g;!function(e){e[e.NONE=m.r3.NONE]="NONE",e[e.PAN=m.r3.PRIMARY]="PAN",e[e.ROTATE=m.r3.SECONDARY]="ROTATE",e[e.ZOOM=m.r3.MIDDLE]="ZOOM"}(g||(g={}));class FloorplanControls extends l.default{constructor(){super(...arguments),this.name="floorplan-controls"}async init(e,t){await super.init(e,t),t.getModuleBySymbol(d.y.INPUT).then((e=>{this.bindings.push(e.registerHandler(c.D,(e=>{this.validateViewmode()&&(this.controls.setRollAcceleration(e.rotateDelta),this.controls.update(r.SI),this.controls.stop())}))),this.bindings.push(e.registerHandler(c.u,this.resetControlState))}))}createCameraControls(e){this.controls=new CameraControls(this.cameraModule,e.extendedBounds,e.meshCenter,!0),this.commonControlsModule.addControls(p.Ey.Floorplan,this.controls)}onDrag(e){switch(super.onDrag(e),this.controlState){case g.ROTATE:this.controls.setRollAcceleration(e.x*Math.PI)}}onKey(e){super.onKey(e);const{key:t,state:n,modifiers:i}=e,s=n===h.M.DOWN;switch(t){case u.R.J:case u.R.LEFTARROW:this.controls.setRollAcceleration(s?f:0,!0);break;case u.R.L:case u.R.RIGHTARROW:this.controls.setRollAcceleration(s?-f:0,!0);break;case u.R.DOWNARROW:i.shiftKey||this.controls.setZoomAcceleration(s?r.Gu:0);break;case u.R.UPARROW:i.shiftKey||this.controls.setZoomAcceleration(s?-r.Gu:0)}}validateViewmode(){return this.viewmodeData.currentMode===p.Ey.Floorplan}}},32548:(e,t,n)=>{"use strict";n.d(t,{P:()=>EndMoveToFloorMessage});var i=n(4117);class EndMoveToFloorMessage extends i.v{constructor(e,t){super(),this.floorId=e,this.floorName=t}}},64038:(e,t,n)=>{"use strict";n.d(t,{S:()=>StartMoveToFloorMessage});var i=n(4117);class StartMoveToFloorMessage extends i.v{constructor(e,t){super(),this.from=e,this.to=t}}},39823:(e,t,n)=>{"use strict";n.d(t,{i:()=>FloorsData});var i=n(35424),s=n(91183),r=n(66910),o=n(7688);class FloorsData extends i.V{constructor(e){super(),this.name="floors",this.floors=(0,r.q)(e)}onNameChange(e){let t=[];return(0,s.k1)((()=>{this.getOrderedValues().forEach(((n,i)=>{t.push(n.onPropertyChanged("name",e))}))}),(()=>{t.forEach((e=>e.cancel())),t=[]}),!0)}getFloor(e){if(!this.floors.has(e))throw new o.H;return this.floors.get(e)}hasFloor(e){return this.floors.has(e)}getFloorAtIndex(e){return this.floors.values.find((t=>t.index===e))}getFloorByMeshGroup(e){return this.floors.values.find((t=>t.meshGroup===e))}getFloorCount(){return this.floors.length}getCollection(){return this.floors}iterate(e){return this.getOrderedValues().forEach(e)}getTopFloor(){const e=this.getOrderedValues();if(!e.length)throw new o.H("Cannot get top floor, model has no floors");return e[e.length-1]}getBottomFloor(){const e=this.getOrderedValues();if(!e.length)throw new o.H("Cannot get bottom floor, model has no floors");return e[0]}getFloorAtHeight(e,t=!1){const n=this.getOrderedValues();t&&n.reverse();for(const t of n){const n=t.boundingBox;if(n.min.y<=e&&e<=n.max.y)return t}const i=this.getBottomFloor();return e<i.boundingBox.min.y?i:this.getTopFloor()}getClosestFloorAtHeight(e){let t,n=1/0;for(const i of this.floors){const s=Math.abs(i.medianSweepHeight()-e);n>s&&(n=s,t=i)}return t}rename(e,t){if(!this.floors.has(e))return;const n=this.floors.get(e);n.name=t,n.commit()}getOrderedValues(){return this.floors.values.sort(((e,t)=>e.index-t.index))}}},7688:(e,t,n)=>{"use strict";n.d(t,{H:()=>InvalidFloorException});var i=n(40603);class InvalidFloorException extends i.y{constructor(e="Invalid Floor"){super(e),this.name="InvalidFloorException"}}},97358:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>FloorDataModule});var i=n(57227),s=n(18537),r=n(60673),o=n(67495),a=n(39823),l=n(52549),c=n(47063),d=n(7819),u=n(48697),h=n(81047),p=n(66225),m=n(5477),f=n(2212);class OrderList{constructor(){this.list=[]}insort(e){const t=this.binarySearch(e);let n=t.index;if(!t.success)for(;this.compare(e,this.list[n])>=0&&n<this.list.length;)n++;for(let e=this.list.length;e>n;e--)this.list[e]=this.list[e-1];this.list[n]=e}removeIndex(e){if(e>this.list.length)throw Error("OrderList.removeIndex() -> Invalid index: "+e);this.list.splice(e,1)}getElement(e){if(e>=0&&e<this.list.length)return this.list[e];throw new Error("OrderList.getElement() -> Invalid index: "+e)}get length(){return this.list.length}find(e){const t=this.binarySearch(e);return t.success?t.index:-1}compare(e,t){return void 0===t?1:"number"==typeof e?e===t?0:e<t?-1:1:e.compare(t)}binarySearch(e){let t,n=0,i=this.list.length-1,s=-1,r=0;for(;n<=i;){if(s=Math.floor((n+i)/2),t=this.list[s],r=this.compare(e,t),0===r)return{success:!0,index:s};r<0?i=s-1:n=s+1}return{success:!1,index:s}}}var g=n(54929),v=n(98254);class Floor extends v.T{constructor(e={}){super(),this.name="",this.center=new f.Vector3,this.boundingBox=new f.Box3,this.size=new f.Vector3,this.sweepHeights=new OrderList,this.sweepFloorHeights=new OrderList,this.medianSweepHeight=()=>this.sweepHeights.length>0?this.sweepHeights.getElement(Math.floor(this.sweepHeights.length/2)):this.center.y,this.minSweepFloorHeight=()=>this.sweepFloorHeights.length>0?this.sweepFloorHeights.getElement(0):this.boundingBox.min.y,Object.assign(this,e)}setBounds(e){this.boundingBox.copy(e),this.boundingBox.getSize(this.size),this.boundingBox.getCenter(this.center)}addSweep(e,t){this.sweepHeights.insort(e.y),this.sweepFloorHeights.insort(t.y)}get bottom(){return this.minSweepFloorHeight()}get top(){return this.sweepFloorHeights.length>0?this.sweepFloorHeights.getElement(this.sweepFloorHeights.length-1):this.boundingBox.max.y}deepCopy(){return(0,g.p$)({id:this.id,meshGroup:this.meshGroup,index:this.index,name:this.name,center:this.center,boundingBox:this.boundingBox,size:this.size,medianSweepHeight:this.medianSweepHeight(),bottom:this.bottom})}}const y=new m.Z("mds-floor-deserializer");class MdsFloorDeserializer{deserialize(e){if(!e||!this.validate(e))return y.debug("Deserialized invalid floor data from MDS",e),null;const t=e.label||"",n=e.dimensions||{},{areaFloor:i}=n;return new Floor({id:e.id,index:e.sequence,meshGroup:e.meshId,name:t,areaFloor:i||-1})}validate(e){return["id","sequence","meshId"].every((t=>t in e))}}class MdsFloorPatchSerializer{serialize(e){return{label:e.name}}}class MdsFloorStore extends p.u{constructor(){super(...arguments),this.deserializer=new MdsFloorDeserializer,this.prefetchKey="data.model.floors"}async read(e={}){const t={modelId:this.getViewId()};return this.query(h.GetFloors,t,e).then((e=>{var t,n;const i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.floors;if(!i||!Array.isArray(i))return null;return i.reduce(((e,t)=>{const n=this.deserializer.deserialize(t);return n&&(e[t.id]=n),e}),{})}))}async update(e,t){const n=this.getViewId(),i=(new MdsFloorPatchSerializer).serialize(t);if(!i)throw new Error("Could not update Floor");return this.mutate(h.PatchFloor,{modelId:n,floorId:e,data:i})}}var b=n(7688);class FloorDataModule extends i.Y{constructor(){super(...arguments),this.name="floors"}async init(e,t){const{readonly:n,baseUrl:i}=e;this.engine=t,this.store=new MdsFloorStore({readonly:n,baseUrl:i});const[r]=await Promise.all([this.store.read()]);if(this.data=new a.i(r||{}),t.market.register(this,a.i,this.data),!1===n){const e=this.data.getCollection();this.monitor=new o.c(e,{aggregationType:s.E.NextFrame,shallow:!0},t),this.monitor.onChanged((()=>this.engine.commandBinder.issueCommand(new c.VQ({dataTypes:[l.g.FLOORS]}))));const[n]=await Promise.all([t.getModule(d.F)]);this.bindings.push(n.onSave((()=>this.save()),{dataType:l.g.FLOORS}));const i=await t.market.waitForData(u.Q);i.setRevertableType(l.g.FLOORS),i.setPublishableType(l.g.FLOORS)}}onUpdate(){}async save(){const e=this.monitor.getDiffRecord();this.monitor.clearDiffRecord();const t=[];for(const n of e){const e=n.index;if(!e)throw new b.H(`Invalid floor '${n.index}'`);n.action===r.KI.updated&&t.push(this.store.update(e,n.diff))}return Promise.all(t)}}},56044:(e,t,n)=>{"use strict";n.d(t,{c:()=>FloorsViewData});var i=n(41252),s=n(35424),r=n(10854),o=n(67779),a=n(94772),l=n(98254);class FloorState extends l.T{constructor(){super(...arguments),this.hidden=!1,this.navigable=!0,this.hasEnabledAlignedSweeps=!1,this.hasEnabledUnalignedSweeps=!1}}var c=n(66910),d=n(29984),u=n(9986);class FloorsStateHelper{constructor(e,t,n,i,s){this.floors=e,this.viewmodeData=t,this.sweepData=n,this.applicationData=i,this.currentFloorObservable=s,this.bindings=[],this.states=new c.v,this._navigableFloorIds=new d.d,this.hasEnabledAlignedSweeps=!1,this.updateFloorSweepData=()=>{const e=this.sweepData;this.isEditMode()||(this.states.values.forEach((e=>{e.hasEnabledAlignedSweeps=!1,e.hasEnabledUnalignedSweeps=!1})),e.iterate((e=>{if(null!==e.floorId){let t=this.getState(e.floorId);t||(t=this.initializeFloorState(e.floorId)),e.alignmentType===a.z9.ALIGNED?t.hasEnabledAlignedSweeps||(t.hasEnabledAlignedSweeps=e.enabled):t.hasEnabledUnalignedSweeps||(t.hasEnabledUnalignedSweeps=e.enabled),t.commit(),this.hasEnabledAlignedSweeps||(this.hasEnabledAlignedSweeps=e.enabled)}}))),this.updateNavigable()},this.updateHidden=()=>{const e=!this.currentFloorId,t=this.isViewingAlignedPano();this.states.keys.forEach((n=>{const i=!!n&&n===this.currentFloorId,s=this.getState(n);s.hidden=!(e||i||t),s.commit()}))},this.updateNavigable=()=>{const e=this.isEditMode(),t=this.isViewingAlignedPano(),n=this.viewmodeData.isDollhouse()||this.viewmodeData.isFloorplan();this.states.keys.forEach((i=>{const s=this.getState(i);s.navigable=!!e||(t?s.hasEnabledAlignedSweeps:!!n||(s.hasEnabledAlignedSweeps||s.hasEnabledUnalignedSweeps)),s.commit()}));const i=[];this.floors.iterate((e=>{this.getState(e.id).navigable&&i.push(e.id)})),this._navigableFloorIds.replace(i)},this.bindings.push(t.makeModeChangeSubscription(this.updateHidden),n.makeSweepChangeSubscription(this.updateHidden),s.onChanged(this.updateHidden),t.makeModeChangeSubscription(this.updateNavigable),n.makeSweepChangeSubscription(this.updateNavigable),i.onPropertyChanged("application",this.updateFloorSweepData)),this.initializeFloorStates(),this.updateFloorSweepData(),this.updateHidden()}getState(e){return this.states.get(e)}get navigableFloorIds(){return this._navigableFloorIds.values()}onNavigableFloorIdsChanged(e){return this._navigableFloorIds.onChanged(e)}isViewingAlignedPano(){return this.viewmodeData.isInside()&&void 0!==this.sweepData.currentAlignedSweepObject}isEditMode(){return this.applicationData.application===u.Mx.WORKSHOP}get currentFloorId(){return this.currentFloorObservable.value?this.currentFloorObservable.value.id:null}initializeFloorStates(){this.floors.iterate((e=>this.initializeFloorState(e.id)))}initializeFloorState(e){const t=new FloorState;return this.states.set(e,t),t}}var h=n(43543);function p(e,t){return e}const m={floorChangesEnabled:()=>!0,roomNavFeatureEnabled:()=>!0};class FloorsViewData extends s.V{constructor(e,t,n,s,r,a){super(),this.name="floors-view",this.floorSelectable=!1,this.currentFloorObservable=new o.f(null),this.transitionObservable=new o.f({from:null,to:null,progress:new i.z(0),promise:Promise.resolve()}),this._observableFloorsSelectMode=new o.f(!1),this._observableRoomSelectMode=new o.f(!1),this._showFloorSelection=new o.f(!1),this.getFloorMin=e=>{const t=e||(this.currentFloorId||this.bottomFloorId);return this.floors.getFloor(t).bottom},this.isHidden=e=>this.stateHelper.getState(e).hidden,this.isNavigable=e=>this.stateHelper.getState(e).navigable,this.getHighestVisibleFloor=()=>this.currentFloor?this.currentFloor:this.floors.getTopFloor(),this.getHighestVisibleFloorId=()=>this.getHighestVisibleFloor().id,this.updateViewData=()=>{this.floors.iterate((e=>{this.derivedData[e.id]={id:e.id,index:e.index,name:this.getFloorName(e.id)}})),this.commit()},this.getViewData=e=>{if(!this.derivedData[e]){const t=this.floors.getFloor(e);this.derivedData[e]={id:t.id,index:t.index,name:this.getFloorName(t.id)}}return this.derivedData[e]},this.getAllViewData=()=>{const e=[];return this.floors.iterate((t=>{e.push(this.getViewData(t.id))})),e},this.getFloor=e=>this.floors.getFloor(e),this.floors=e,this.config=null!=a?a:m,this.localize=null!=r?r:p,this.derivedData={},this.stateHelper=new FloorsStateHelper(e,t,n,s,this.currentFloorObservable),this.updateViewData()}isCurrentOrAllFloors(e){return!e||!this.currentFloorId||e===this.currentFloorId}isCurrentMeshGroupOrAllFloors(e){return this.currentFloorMeshGroup===h.eh||this.currentFloorMeshGroup===e}makeFloorChangeSubscription(e){return this.currentFloorObservable.onChanged(e)}get currentFloor(){return this.currentFloorObservable.value}get currentFloorId(){var e;return(null===(e=this.currentFloorObservable.value)||void 0===e?void 0:e.id)||null}get currentFloorIndex(){return this.currentFloorObservable.value?this.currentFloorObservable.value.index:h.qE}get currentFloorMeshGroup(){return this.currentFloorObservable.value?this.currentFloorObservable.value.meshGroup:h.eh}getFloorIndexForMeshGroup(e){if(e===h.eh)return h.qE;const t=this.floors.getFloorByMeshGroup(e);return t?t.index:h.qE}get bottomFloorId(){return this.floors.getBottomFloor().id}get topFloorId(){return this.floors.getTopFloor().id}get singleFloor(){if(1===this.floors.getFloorCount())return this.floors.getFloorAtIndex(0)}isMultifloor(){return this.floors.getFloorCount()>1}get nearestFloorId(){return this.transitionActive?this.transition.progress.value>.5?this.transition.to:this.transition.from:this.currentFloorId}get nearestFloor(){const e=this.nearestFloorId;return e?this.floors.getFloor(e):void 0}get transitionActive(){return this.transition.progress.active}get transition(){return this.transitionObservable.value}transitionToFloorInstant(e){this.currentFloorObservable.value=e?this.floors.getFloor(e):null,this.commit()}transitionToFloor(e,t,n,i){const s=this.transitionObservable.value.progress;s.modifyAnimation(0,1,n),this.transitionObservable.value={from:e,to:t,progress:s,promise:i},this.commit(),i.then((()=>{this.transitionToFloorInstant(t)}))}get totalFloors(){return this.floorsEnabled?this.floors.getFloorCount():1}hasEnabledAlignedSweeps(e){return null!==e?this.stateHelper.getState(e).hasEnabledAlignedSweeps:this.stateHelper.hasEnabledAlignedSweeps}getNavigableFloorIds(){return this.stateHelper.navigableFloorIds}onNavigableFloorIdsChanged(e){return this.stateHelper.onNavigableFloorIdsChanged(e)}getFloorIdMap(){const e={};return this.iterate((t=>{e[t.id]={id:t.id,name:t.name,items:[]}})),e}iterate(e){this.floors.iterate((t=>{const n=this.getViewData(t.id);n&&e(n)}))}getFloorNames(){const e=[];return this.floorsEnabled?(this.floors.iterate((t=>{e[t.index]=this.getFloorName(t.id)})),e):e}getFloorName(e){if(!e)return this.localize(r.Z.FLOOR_ALL);const t=this.floors.getFloor(e);return void 0!==t.name&&""!==t.name?t.name:this.getDefaultFloorName(e)}getDefaultFloorName(e){const t=this.floors.getFloor(e);return this.localize(r.Z.SHOWCASE.FLOORS.DEFAULT_NAME,t.index+1)}getFloorsVisibility(){if(this.currentFloorId){const e=[];return this.floors.iterate((t=>{e[t.index]=t.id===this.currentFloorId?1:0})),e}return[]}get floorsEnabled(){return this.config.floorChangesEnabled()}get floorSelectModeEnabled(){return this.config.roomNavFeatureEnabled()}get floorSelectModeActive(){return this._observableFloorsSelectMode.value}set floorSelectModeActive(e){const t=e&&this.floorsEnabled&&this.floorSelectModeEnabled;t!==this._observableFloorsSelectMode.value&&(this._observableFloorsSelectMode.value=t,this.commit())}onFloorSelectModeChange(e){return this._observableFloorsSelectMode.onChanged(e)}get showFloorSelection(){return this._showFloorSelection.value}set showFloorSelection(e){(e&&this.floorSelectModeEnabled)!==this._showFloorSelection.value&&(this._showFloorSelection.value=e&&this.floorSelectModeEnabled,this.commit())}onShowFloorSelectionChanged(e){return this._showFloorSelection.onChanged(e)}get roomSelectModeActive(){return this._observableRoomSelectMode.value}set roomSelectModeActive(e){const t=e&&this.floorSelectModeEnabled||!this.floorSelectModeEnabled;t!==this._observableRoomSelectMode.value&&(this._observableRoomSelectMode.value=t,this.commit())}onRoomSelectModeChange(e){return this._observableRoomSelectMode.onChanged(e)}}},37632:(e,t,n)=>{"use strict";n.d(t,{Vw:()=>MoveToFloorCommand,h9:()=>MoveToFloorIndexCommand,EU:()=>ShowAllFloorsCommand});var i=n(93037);class MoveToFloorCommand extends i.m{constructor(e,t=!1,n,i){super(),this.id="MOVETO_FLOOR",this.payload={floorId:e,suppressCameraMovement:t,transitionTime:n,focusPoint:i}}}class MoveToFloorIndexCommand extends i.m{constructor(e,t=!1,n,i){super(),this.id="MOVETO_FLOOR_NUMBER",this.payload={floorIndex:e,suppressCameraMovement:t,transitionTime:n,focusPoint:i}}}class ShowAllFloorsCommand extends i.m{constructor(e){super(),this.id="SHOW_ALL_FLOORS",this.payload=e}}},43543:(e,t,n)=>{"use strict";n.d(t,{qE:()=>i,eh:()=>s,cw:()=>r});const i=-1,s=-1,r=500},60217:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var i=n(17536),s=n(58817);function r(){const e=(0,i.R)();return(0,s.q)(e)}},17536:(e,t,n)=>{"use strict";n.d(t,{R:()=>r,h:()=>o});var i=n(67294),s=n(18814);function r(){const e=(0,s.I)(),[t,n]=(0,i.useState)(e?e.currentFloorId:null);return(0,i.useEffect)((()=>{if(!e)return()=>{};const t=()=>{const t=e.currentFloorId;n(t)},i=e.makeFloorChangeSubscription(t);return t(),()=>i.cancel()}),[e]),t}const o=(0,n(59187).M)("currentFloorId",r)},58817:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var i=n(67294),s=n(18814);function r(e){const t=(0,s.I)(),[n,r]=(0,i.useState)(t&&null!==e?t.getViewData(e):null);return(0,i.useEffect)((()=>{if(!t)return()=>{};if(e){const n=t.getViewData(e);r(n)}else r(null);return()=>{}}),[t,e]),n}},18814:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,p:()=>a});var i=n(20302),s=n(59187),r=n(56044);const o=(0,i.u)(r.c),a=(0,s.M)("floorsViewData",o)},27086:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>FloorsViewDataModule});var i=n(57227),s=n(14877),r=n(39142),o=n(94113),a=n(95847),l=n(43985),c=n(19926),d=n(53549),u=n(37363),h=n(15099),p=n(39808),m=n(32548),f=n(38950),g=n(92214),v=n(368),y=n(22878),b=n(72699),S=n(9986),E=n(41907),T=n(39823),w=n(74170),x=n(34629),_=n(56483);class FloorsRenderer{constructor(e,t,n,i,s,r,o,a){this.getAngleModifier=e,this.pose=t,this.floorsViewData=n,this.meshQuery=i,this.viewmodeData=s,this.raycasterData=r,this.meshData=o,this.touchDevice=a,this.getDiscardDistance=e=>{if(e){return 4+(this.pose.focalDistance*_.xx.DISCARD_FOCAL_MULTI||0)}return 0}}activate(){}init(){}dispose(){}deactivate(){const{floorOpacity:e,floorFadeDist:t}=this.meshData.meshGroupVisuals;for(const n of this.meshData.meshGroups.floors.values())t.set(n.meshGroup,0),e.set(n.meshGroup,0)}beforeRender(){const e=this.floorsViewData.nearestFloor,t=this.floorsViewData.transition.progress.active,n=!(!e||this.viewmodeData.isInside()),i=_.xx.FADE_OPAQUE;let s=i,r=i;const o=this.getAngleModifier();n&&(this.floorsViewData.floorSelectModeEnabled&&(this.viewmodeData.isDollhouse()||this.viewmodeData.isOrthographic())?(s=i*o*_.xx.FADE_IN_VALUE,r=s*_.xx.FADE_BELOW_MULT+_.xx.FADE_BELOW_START):(s=_.xx.FADE_ABOVE,r=_.xx.FADE_BELOW));const{floorOpacity:a,floorFadeDist:l}=this.meshData.meshGroupVisuals;for(const{meshGroup:n}of this.meshData.meshGroups.floors){const o=this.floorsViewData.floors.getFloorByMeshGroup(n);let c=i;const d=this.isBelowSelectedFloor(o)?r:s;let u=(0,w.uZ)(d+_.xx.FADE_IN_HOVER_BOOST_VALUE,0,1);this.floorsViewData.roomSelectModeActive&&(u=d),c=this.isHoveredFloor(null==o?void 0:o.id)&&!t&&d>0?u:d,c=this.isFloorTransitioningOut(o)?d:c,c=this.isSelectedFloor(null==o?void 0:o.id)||this.isFloorTransitioningIn(o)?i:c,c=this.clampForViewmodeTransitions(c);const h=a.get(n);if(void 0===h)a.set(n,c);else if(h!==c){let e=(0,x.t)(h,c,.2);Math.abs(c-e)<1e-4&&(e=c),a.set(n,e)}const p=this.viewmodeData.isDollhouse(),m=this.getDiscardDistance(p&&!!e&&n>e.meshGroup);l.set(n,m)}}render(){}clampForViewmodeTransitions(e){if(this.viewmodeData.currentMode===y.Ey.Transition){const{to:t}=this.viewmodeData.transition;if(t===y.Ey.Panorama)return Math.max(1-this.meshData.meshTextureOpacity.value,e)}return e}isHoveredFloor(e){if(void 0!==e&&this.raycasterData.hit&&(this.viewmodeData.isDollhouse()||this.viewmodeData.isOrthographic())&&!this.touchDevice&&this.floorsViewData.isNavigable(e)){const t=this.raycasterData.hit.object;return e===this.meshQuery.floorIdFromObject(t)}return!1}isSelectedFloor(e){const t=this.floorsViewData.nearestFloor;return!t||!(!e||t.id!==e)}isBelowSelectedFloor(e){const t=this.floorsViewData.nearestFloor;return!!(e&&t&&t.index>e.index)}isFloorTransitioningIn(e){return!(!e||!this.floorsViewData.transition.progress.active||this.floorsViewData.transition.to&&this.floorsViewData.transition.to!==e.id)}isFloorTransitioningOut(e){return!(!e||!this.floorsViewData.transition.progress.active||this.floorsViewData.transition.from&&this.floorsViewData.transition.from!==e.id&&this.floorsViewData.transition.to===e.id)}}var M=n(31013),O=n(64038),A=n(37008),C=n(14832),N=n(48730),D=n(2212),I=n(77280),L=n(26517),P=n(78720),R=n(99931),k=n(7688),U=n(28757),B=n(43543);class FloorsNavigation{constructor(e,t,n,i,s,r,o,a,l){this.engine=e,this.floorsData=t,this.floorsViewData=n,this.sweepData=i,this.cameraData=s,this.cameraModule=r,this.viewmodeData=o,this.updateCurrentFloor=a,this.meshData=l,this.MOVE_TO_BLACK_TRANSITION_TIME=2e3,this.moveFloorUp=(e=!1,t)=>{const n=this.floorsViewData.currentFloorId,i=this.floorsViewData.getNavigableFloorIds(),s=n?i.indexOf(n):-1;let r=i[s+1];return void 0===r&&(r=this.viewmodeData.isInside()?i[i.length-1]:i[0]),this.moveToFloor(r,e,t)},this.moveFloorDown=(e=!1,t)=>{const n=this.floorsViewData.currentFloorId,i=this.floorsViewData.getNavigableFloorIds(),s=n?i.indexOf(n):i.length;let r=i[s-1];return void 0===r&&(r=this.viewmodeData.isInside()?i[0]:i[i.length-1]),this.moveToFloor(r,e,t)},this.moveToFloor=(e,t=!1,n,i)=>{const s=this.floorsViewData.currentFloorId,r=s===e,o=this.floorsViewData.totalFloors<2&&!e,a=e?this.floorsViewData.floors.getFloor(e):null;if(r||o||!this.floorsViewData.floorsEnabled)return this.updateCurrentFloor(e),M.Q.resolve();if(a&&!this.canMoveToFloor(a,t))return M.Q.reject(new k.H("Invalid floor ID"));this.engine.broadcast(new O.S(s,e)),void 0===n&&(n=B.cw);const l=new M.Q;let c;this.floorsViewData.transitionToFloor(s,e,n,l.nativePromise()),this.floorsViewData.commit();let d,u=i;if(this.viewmodeData.isInside()){const t=e=>e=>this.floorsViewData.isCurrentOrAllFloors(e.floorId),n=!!e?P.nK:t,s=[(0,P._T)(),(0,P._k)(),n(e)],r=[(0,R.l0)(i||this.cameraData.pose.position)],o=this.sweepData.sortByScore(s,r).shift();o&&(u=o.sweep.position,c=o.sweep.id)}else null!==e&&this.engine.commandBinder.issueCommand(new U.aK);d=t?Promise.resolve():this.getCameraTransition(e,n,c,u);const h=this,p=M.Q.all([l,d]);return this.engine.startGenerator((function*(){let e=Date.now();for(;h.floorsViewData.transition.progress.active;){yield new A.Jj;const t=Date.now(),n=t-e;h.floorsViewData.transition.progress.tick(n),h.floorsViewData.commit(),e=t}h.updateCurrentFloor(h.floorsViewData.transition.to),l.resolve()})),p}}moveToFloorIndex(e,t=!1,n,i){let s=null;if(e!==B.qE){const t=this.floorsViewData.floors.getFloorAtIndex(e);if(!t)return M.Q.reject(new k.H(`Invalid floor index ${e}`));s=t.id}return this.moveToFloor(s,t,n,i)}canMoveToFloor(e,t=!1){if(!e)return!1;const n=this.floorsViewData.transition.progress.active,i=this.cameraData.canTransition()||t,s=e.index<=this.floorsViewData.totalFloors-1,r=e.index>=-1;return!n&&i&&s&&r}getCameraTransition(e,t,n,i){if(this.viewmodeData.currentMode===y.Ey.Dollhouse||this.viewmodeData.currentMode===y.Ey.Floorplan){const n=this.getPoseForFloor(e,i);return this.cameraModule.moveTo({transitionType:C.n.Interpolate,pose:n.pose,focalDistance:n.focalDistance,transitionTime:t}).nativePromise()}return this.viewmodeData.isInside()&&n?this.engine.commandBinder.issueCommand(new N.ju({transition:C.n.MoveToBlack,sweep:n,transitionTime:this.MOVE_TO_BLACK_TRANSITION_TIME})):Promise.resolve()}getPoseForFloor(e,t){const{position:n,rotation:i}=this.cameraData.pose,s=e?this.floorsData.getFloor(e):null,r=s?s.medianSweepHeight():this.meshData.meshCenter.y,o=s?s.center:this.meshData.meshCenter;o.setY(r);const a=I.f.FORWARD.clone().applyQuaternion(i),l=n.clone();let c,d;if(t){const e=n.clone().addScaledVector(a,this.cameraData.pose.focalDistance),i=(new D.Vector3).set(0,n.y,0),s=(new D.Vector3).set(0,e.y,0),o=i.distanceTo(s);l.setY(r+o);const u=e.clone().setY(t.y);d=u.distanceTo(l),this.viewmodeData.isDollhouse()&&(c=(0,L.n0)(l,u))}else{const e=(s?s.size.y:F)/2+F*-a.y;l.setY(r+e),d=l.distanceTo(o)}return{focalDistance:d,pose:{position:l,rotation:c}}}}const F=8;var V=n(56044),H=n(37632),j=n(65270),G=n(63387),z=n(994);class FloorsSelectModeHelper{constructor(e,t,n){this.floorsViewData=e,this.viewmodeData=t,this.pose=n,this.vectors={lookDir:new D.Vector3,flattenedLookDir:new D.Vector3},this.getAngleModifier=this.getAngleModifier.bind(this)}update(){const e=this.getAngleModifier(),t=1===this.floorsViewData.totalFloors,n=!!this.floorsViewData.nearestFloor,i=!this.viewmodeData.isInside()&&!this.viewmodeData.transitionActive();this.floorsViewData.roomSelectModeActive=i&&(t||n&&e<1||this.viewmodeData.isFloorplan()),this.floorsViewData.floorSelectModeActive=i&&1===e&&!t,this.floorsViewData.showFloorSelection=!this.viewmodeData.transitionActive()&&(this.viewmodeData.isDollhouse()||this.viewmodeData.isFloorplan())&&n&&!t,this.floorsViewData.floorSelectable=this.floorsViewData.floorSelectModeEnabled&&(this.viewmodeData.isDollhouse()||this.viewmodeData.isOrthographic())}getAngleModifier(){const e=this.vectors.lookDir.copy(I.f.FORWARD).applyQuaternion(this.pose.rotation),t=this.vectors.flattenedLookDir.copy(e).setY(0),n=e.angleTo(t)*z.MN,i=_.xx.FADE_IN_START_ANGLE,s=_.xx.FADE_IN_END_ANGLE,r=1-(0,G.dS)(n,i,s,0,1);return(0,j.FG)(r,0,1,1)}}var W=n(2252),K=n(36032),Y=n(16493),q=n(88965),Z=n(10830),$=n(42226),Q=n(61903),X=n(32683),J=n(50084),ee=n(8428);class FloorsViewDataModule extends i.Y{constructor(){super(...arguments),this.name="floors-viewdata",this.onEndMoveToSweepMessage=e=>{const t=this.sweepData.getSweep(e.toSweep);t&&this.updateCurrentFloor(t.floorId)},this.onMoveToFloorCommand=async e=>this.floorNavigation.moveToFloor(e.floorId,e.suppressCameraMovement,e.transitionTime,e.focusPoint),this.onMoveToFloorIndexCommand=async e=>this.floorNavigation.moveToFloorIndex(e.floorIndex,e.suppressCameraMovement,e.transitionTime,e.focusPoint),this.onShowAllFloorsCommand=async e=>{const t="boolean"==typeof e.moveCamera&&!e.moveCamera;await this.engine.commandBinder.issueCommand(new H.Vw(null,t))},this.applicationChanged=()=>{this.floorsViewData.updateViewData()},this.updateCurrentFloor=e=>{this.config.allowFloorChanges&&this.floorsViewData.currentFloorId!==e&&(this.floorsViewData.transitionToFloorInstant(e),this.engine.broadcast(new m.P(e,this.floorsViewData.getFloorName(e))))},this.updateFloorSelectMode=()=>{var e;null===(e=this.floorsSelectModeHelper)||void 0===e||e.update()},this.floorSelectFeatureEnabledCheck=()=>{const e=this.settingsData.tryGetProperty(X.ws,!0),t=this.settingsData.tryGetProperty(ee.gx.FloorSelect,!0),n=this.applicationData.application===S.Mx.WORKSHOP;this.toggleFloors(n||e&&t)}}async init(e,t){var n,i,o;this.engine=t,this.config=e,[this.floorsData,this.settingsData,this.applicationData,this.sweepData,this.viewmodeData]=await Promise.all([t.market.waitForData(T.i),t.market.waitForData(Q.e),t.market.waitForData(S.pu),t.market.waitForData(d.Z),t.market.waitForData(u.O)]);const a=await t.getModule(r.default),l={floorChangesEnabled:()=>this.config.allowFloorChanges,roomNavFeatureEnabled:()=>this.settingsData.tryGetProperty(X.Q5,!1)};if(this.floorsViewData=new V.c(this.floorsData,this.viewmodeData,this.sweepData,this.applicationData,a.t.bind(a),l),this.floorSelectFeatureEnabledCheck(),t.market.register(this,V.c,this.floorsViewData),[this.cameraData,this.input,this.raycasterData]=await Promise.all([t.market.waitForData(h.M_),t.getModuleBySymbol(s.y.INPUT),t.market.waitForData(v.P)]),this.config.allowFloorChanges){const e=null===(n=this.config.startingFloorsVisibility)||void 0===n?void 0:n.lastIndexOf(1),t=null===(i=this.floorsData.getFloorAtIndex(e))||void 0===i?void 0:i.id,s=null===(o=this.sweepData.currentSweepObject)||void 0===o?void 0:o.floorId,r=s||t||null;(s||t)&&(this.log.debug(`Set initial floor to ${r} from current pose`),this.updateCurrentFloor(r))}const[c,m]=await Promise.all([t.getModuleBySymbol(s.y.CAMERA),t.market.waitForData(p._)]);this.floorNavigation=new FloorsNavigation(t,this.floorsData,this.floorsViewData,this.sweepData,this.cameraData,c,this.viewmodeData,this.updateCurrentFloor,m),this.floorsSelectModeHelper=new FloorsSelectModeHelper(this.floorsViewData,this.viewmodeData,this.cameraData.pose);const w=await t.getModuleBySymbol(s.y.MESH_QUERY),x=new FloorsRenderer(this.floorsSelectModeHelper.getAngleModifier,this.cameraData.pose,this.floorsViewData,w,this.viewmodeData,this.raycasterData,m,(0,W.Jm)());t.addComponent(this,x),this.settingsData.tryGetProperty(X.Q5,!1)&&this.config.allowFloorChanges&&this.registerFloorHoverCursorEffect(),this.bindings.push(this.registerKeys(),t.subscribe(E.bS,this.applicationChanged),this.floorsData.onChanged(this.floorsViewData.updateViewData),t.subscribe(f.Z,this.onEndMoveToSweepMessage),t.subscribe(g.Z,function(e,t,n){let i=!1;return s=>{const r=e.tryGetData(b.k);if(!r||r&&r.isTourActive())return;(0,y.Bw)(s.toMode)&&(i=null!==n.currentFloorId);const o=(0,y.Bw)(s.fromMode),a=s.toMode===y.Ey.Floorplan,l=s.toMode===y.Ey.Dollhouse;if(!o||!l&&!a)return;const c=i||a?n.currentFloorId:null;t(new H.Vw(c,!0,0))}}(t.market,t.commandBinder.issueCommand,this.floorsViewData)),t.commandBinder.addBinding(H.Vw,this.onMoveToFloorCommand),t.commandBinder.addBinding(H.h9,this.onMoveToFloorIndexCommand),t.commandBinder.addBinding(H.EU,this.onShowAllFloorsCommand),t.subscribe(J.Z,this.updateFloorSelectMode),this.cameraData.pose.onChanged(this.updateFloorSelectMode),this.floorsViewData.onChanged(this.updateFloorSelectMode),this.settingsData.onPropertyChanged(X.ws,this.floorSelectFeatureEnabledCheck),this.settingsData.onPropertyChanged(ee.gx.FloorSelect,this.floorSelectFeatureEnabledCheck),this.applicationData.onPropertyChanged("application",this.floorSelectFeatureEnabledCheck)),this.updateFloorSelectMode(),this.sweepData.currentSweepObject&&this.updateCurrentFloor(this.sweepData.currentSweepObject.floorId)}onUpdate(){}toggleFloors(e){e||null===this.floorsViewData.currentFloorId||this.updateCurrentFloor(null),this.config.allowFloorChanges=e,this.updateFloorSelectMode()}registerKeys(){return this.input.registerHandler(o.e,(async e=>{if(!this.cameraData.canTransition())return;const t=e.modifiers.shiftKey;if(e.state===c.M.PRESSED)switch(e.key){case l.R.UPARROW:t&&this.floorNavigation.moveFloorUp();break;case l.R.DOWNARROW:t&&this.floorNavigation.moveFloorDown();break;case l.R.R:this.floorNavigation.moveFloorUp();break;case l.R.F:this.floorNavigation.moveFloorDown();break;case l.R.Y:this.floorNavigation.moveToFloor(null)}}))}registerFloorHoverCursorEffect(){const e=Y.s.is((e=>q.$4.isRoomMesh(e)&&e.raycastEnabled&&this.floorsViewData.floorSelectable)),t=new K.V(this.input.registerMeshHandler(a.z,e,(e=>{this.engine.commandBinder.issueCommand(new Z.u($.C.FINGER))})),this.input.registerMeshHandler(a.A,e,(e=>{this.engine.commandBinder.issueCommand(new Z.u($.C.DEFAULT))})));t.cancel();const n=(()=>{let e=!1;return()=>{const n=this.floorsViewData.floorSelectModeEnabled;n!==e&&(e=n,e?t.renew():(t.cancel(),this.engine.commandBinder.issueCommand(new Z.u($.C.DEFAULT))))}})();n(),this.bindings.push(this.viewmodeData.onChanged(n),this.floorsViewData.onFloorSelectModeChange(n),this.floorsViewData.makeFloorChangeSubscription(n),t)}}},32683:(e,t,n)=>{"use strict";n.d(t,{Q5:()=>i,ws:()=>s,u_:()=>r,gu:()=>o});const i="features/roomnav",s="features/floorselect",r="features/current_floor_indicator",o="features/floor_name_overlay"},3786:(e,t,n)=>{"use strict";n.d(t,{I:()=>GuiErrorCommand});var i=n(93037);class GuiErrorCommand extends i.m{constructor(e,t){super(),this.id="DEFAULT_ERROR",this.payload={messagePhraseKey:e,options:t}}}},99280:(e,t,n)=>{"use strict";n.d(t,{c:()=>AlertNotificationMessage});var i=n(4117);class AlertNotificationMessage extends i.v{constructor(e){super(),this.open=e}}},71843:(e,t,n)=>{"use strict";n.d(t,{Bz:()=>ToggleModalCommand,rE:()=>CloseModalCommand,Mn:()=>ToggleIconToolbarCommand});var i=n(93037);class ToggleModalCommand extends i.m{constructor(e,t){super(),this.payload={modal:e,open:t}}}ToggleModalCommand.id="TOGGLE_MODAL";class CloseModalCommand extends i.m{constructor(){super()}}CloseModalCommand.id="CLOSE_MODAL";class ToggleIconToolbarCommand extends i.m{constructor(e){super(),this.payload={open:e}}}ToggleIconToolbarCommand.id="TOGGLE_ICON_TOOLBAR"},40895:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var i=n(85893),s=n(94184),r=n.n(s);function o({current:e,min:t,max:n}){const s=void 0!==t&&e<t||e>n;return(0,i.jsxs)("div",Object.assign({className:r()("text-counter",{error:s})},{children:[e,"/",n]}))}},90636:(e,t,n)=>{"use strict";n.d(t,{s:()=>T});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(85553),d=n(65610),u=n(87443),h=n(48452),p=n(45923),m=n(87982),f=n(61445),g=n(78576),v=n(10854),y=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{ATTACHMENTS:b}=v.Z.SHOWCASE;let S=class PendingUpload extends s.Component{constructor(e){super(e),this.onRemoveFailed=e=>{const{id:t,error:n}=this.props;n&&(e.stopPropagation(),this.context.commandBinder.issueCommand(new u.Rh(t)))}}renderError(e){let t=g.ig.SMALL;const n=this.context.locale;let s=n.t(b.ERROR_UPLOAD_FAIL);switch(e){case h.kV.FILE_TOO_LARGE:s=n.t(b.ERROR_FILE_TOO_LARGE);break;case h.kV.EMPTY_FILE:s=n.t(b.ERROR_EMPTY_FILE);break;case h.kV.OVER_QUOTA:s=n.t(b.ERROR_OVER_QUOTA),t=g.ig.MEDIUM;break;case h.kV.PERMISSION_DENIED:s=n.t(b.ERROR_PERMISSION_DENIED)}const r=this.context.locale.t(b.REMOVE_TOOLTIP);return(0,i.jsxs)("div",Object.assign({className:"upload-status"},{children:[(0,i.jsx)(g.oO,Object.assign({className:"upload-error-message",content:s,position:g.lZ.DOWN,tooltipWidth:t,showOnClick:!0},{children:(0,i.jsx)("span",{className:"icon icon-error"})})),(0,i.jsx)(m.hU,{iconClass:"icon-close",className:"attachment-delete",buttonStyle:m.Dd.SOCIAL,buttonSize:f.qE.SMALL,tooltipMsg:r,tooltipPosition:g.lZ.DOWN_LEFT,onClick:this.onRemoveFailed})]}))}renderInProgress(){const{progress:e}=this.props;return(0,i.jsx)("div",Object.assign({className:"upload-status"},{children:(0,i.jsx)(p.$,{progress:e,innerRadius:20,barWidth:4})}))}render(){const{className:e,error:t}=this.props,n={"upload-error":!!t};return(0,i.jsx)("div",Object.assign({className:o()("attachment","attachment-upload",n,e)},{children:t?this.renderError(t):this.renderInProgress()}))}};S.contextType=l.I,S=y([a.Z],S);var E=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let T=class AnnotationAttachments extends s.Component{constructor(e){super(e),this.onViewAttachment=(e,t)=>{this.props.onViewAttachment&&this.props.onViewAttachment(t)},this.renderAttachment=(e,t)=>{const{inline:n,canDelete:s,attachments:r}=this.props,o=r.length,a=!n&&(1===o||0===t&&o>2),l=!!n||!a,u=(0,c.fy)(!!n,a);return(0,i.jsx)(d.P,{attachment:e,inline:!!n,canDelete:!!s,hero:a,cover:!0,onClick:this.onViewAttachment,thumbnail:l,smartWidth:u.width,smartHeight:u.height},e.id)},this.renderPendingUpload=e=>(0,i.jsx)(S,{id:e.id,className:"inline",progress:e.progress,error:e.error},e.id)}render(){const{attachments:e,uploads:t,failures:n,inline:s,children:r}=this.props;return(0,i.jsxs)("div",Object.assign({className:o()("annotation-attachments",{"annotation-attachments-inline":!!s})},{children:[e.map(this.renderAttachment),t&&t.map(this.renderPendingUpload),n&&n.map(this.renderPendingUpload),r]}))}};T.contextType=l.I,T=E([a.Z],T)},52838:(e,t,n)=>{"use strict";n.d(t,{E:()=>oe});var i=n(85893),s=n(67294),r=n(91033),o=n(57340),a=n(94184),l=n.n(a),c=n(65143),d=n(40825),u=n(47357),h=n(49315),p=n(50566),m=n(18236),f=n(95361);function g(e,t){return t?t.getNoteView(e):null}var v=n(60405),y=n(43873);function b({comment:e,noteView:t}){const n=t?t.created:e.created,{userData:r}=(0,s.useContext)(v.I),o=t?t.user.email:e.user.email,a=r.getUserDisplay(o),l=a.color,c=t?t.comments.length-1:0,d=1===c?`${c} reply`:`${c} replies`,u=""===e.text&&!(e.attachments.length>0)?"Original content was deleted":n.toLocaleString();return(0,i.jsxs)("header",Object.assign({className:"note-header"},{children:[(0,i.jsx)(y.C,{label:a.initials,badgeStyle:{color:l,borderColor:l}}),(0,i.jsxs)("div",Object.assign({className:"note-details"},{children:[(0,i.jsx)("span",Object.assign({className:"note-user"},{children:a.name})),c>0&&(0,i.jsx)("span",Object.assign({className:"note-summary-info note-replies"},{children:d})),(0,i.jsx)("div",Object.assign({className:"note-subheader"},{children:u}))]}))]}))}var S=n(85553),E=n(34259);function T(e){const{attachments:t}=e,{analytics:n}=(0,s.useContext)(v.I);if(!(t.length>0))return null;const r=t.filter(S.lV);if(0===r.length)return null;return(0,i.jsx)(E.T,{attachments:r,startIndex:0,onClick:(t,i)=>{n.trackToolGuiEvent("notes","notes_preview_click_attachment"),t.stopPropagation(),e.onClick(i)},smartWidth:318,smartHeight:130})}var w=n(64191);function x(e){return e?e.getTextParser():null}function _(e){return e?e.getLinkHandler():null}function M({text:e,noteId:t}){const n=function(){const e=(0,f.Q)(),[t,n]=(0,s.useState)(x(e));return(0,s.useEffect)((()=>(t||n(x(e)),()=>{})),[e]),t}(),r=function(){const e=(0,f.Q)(),[t,n]=(0,s.useState)(_(e));return(0,s.useEffect)((()=>(t||n(_(e)),()=>{})),[e]),t}();return(0,i.jsx)("div",Object.assign({className:l()("note-post",{"note-summary-info":!e})},{children:e&&n&&(0,i.jsx)(w.e,{text:e,textParser:n,linkHandler:r,maxLength:150,annotationType:u.J.NOTE,annotationId:t})}))}var O=n(41345),A=n(10854);const{ANNOTATIONS:C}=A.Z.SHOWCASE;function N(e){const{previewId:t}=e,n=(0,O.b)(),r=function(){const e=(0,f.Q)(),[t,n]=(0,s.useState)(e?e.focusedComment:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onFocusedCommentChanged(n);return n(e.focusedComment),()=>t.cancel()}),[e]),t}(),o=function(e){const t=(0,f.Q)(),[n,i]=(0,s.useState)(g(e,t));return(0,s.useEffect)((()=>(n&&n.id===e||i(g(e,t)),()=>{})),[e,t]),n}(t);if(!o)return null;const a=o.comments.get(0),c=a&&a.attachments.length>0,d=o.comments.length>0,u=n.t(C.READ_MORE_MESSAGE),h=l()("annotation-preview-contents","note-preview-contents",{"viewable-media":c});return(0,i.jsxs)("div",Object.assign({className:h,onClick:t=>{t.stopPropagation(),e.onClick()}},{children:[a&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(T,{attachments:a.attachments.values(),onClick:e.onClick}),(0,i.jsx)(b,{noteView:o,comment:a}),(0,i.jsx)(M,{text:a.text,noteId:t})]}),r&&r.id!==a.id&&(0,i.jsxs)("div",Object.assign({className:"nested-comment-preview"},{children:[(0,i.jsx)(b,{comment:r}),(0,i.jsx)(M,{text:r.text,noteId:t})]})),d&&(0,i.jsx)("div",Object.assign({className:"link link-more"},{children:u}))]}))}var D=n(23676),I=n(64921),L=n(86696),P=n(48452),R=n(65610),k=n(16534),U=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let B=class TagMedia extends s.Component{constructor(e){super(e),this.clickAttachment=(e,t)=>{const{attachments:n,onClick:i}=this.props;0!==n.length&&(e.stopPropagation(),i(e,t))}}getMediaDimensions(e){const t=function(e){const{mediaType:t,width:n,height:i}=e;if(n&&i&&t===P.DD.IMAGE)return Math.max(n,1)/Math.max(i,1)<1?200:275;return 300}(e),n=function(e){const{mediaType:t,width:n,height:i}=e;if(n&&i&&t===P.DD.IMAGE)return Math.max(n,1)/Math.max(i,1)>=1?400:300;return 350}(e),{layerWidth:i,layerHeight:s}=this.props;if(void 0===i||void 0===s)return{maxWidth:n};let r=Math.min(n,.35*i);r=Math.max(r,t);return{maxWidth:r,maxHeight:.6*s,minWidth:t}}renderAttachment(e){const{maxWidth:t,maxHeight:n,minWidth:s}=this.getMediaDimensions(e),r={maxHeight:`${n}px`,maxWidth:`${t}px`,minWidth:`${s}px`},o=Object.assign({},r);return delete o.minWidth,(0,i.jsx)("div",Object.assign({className:"tag-media",style:r},{children:(0,i.jsx)(R.P,{style:o,attachment:e,onClick:this.clickAttachment,maxWidth:t,maxHeight:n})}))}render(){const{settings:e}=this.context,{attachments:t}=this.props;return e.tryGetProperty(k.sX,!1)||0===t.length?null:1===t.length?this.renderAttachment(t[0]):(0,i.jsx)("div",Object.assign({className:"tag-media"},{children:(0,i.jsx)(E.T,{attachments:t,startIndex:0,onClick:this.clickAttachment,smartWidth:318,smartHeight:130})}))}};B.contextType=v.I,B=U([o.Z],B);var F=n(14832),V=n(19822),H=n(54119),j=n(58361);const{TAGS:G}=A.Z.SHOWCASE;function z(e){const{tag:t}=e,{analytics:n,commandBinder:r,editMode:o,locale:a}=(0,s.useContext)(v.I),c=a.t(G.SHARE_TAG_LABEL),d=o?a.t(G.EDIT_TAG_LABEL):a.t(G.DOCK_TAG_LABEL),u=o?"toggle-pencil":"dock",h=t.id,p=(0,s.useCallback)((e=>{e.stopPropagation(),n.trackToolGuiEvent("tags",o?"tags_billboard_edit_tag":"tags_billboard_dock_tag"),r.issueCommand(new V.lt(h,F.n.Interpolate,!0))}),[h,o]);return(0,i.jsxs)("header",Object.assign({className:l()("tag-billboard-header",{editable:o})},{children:[!o&&(0,i.jsx)(j.O,{prefix:"tag",pin:t,id:t.id,label:c,darkTheme:!0,includeCameraView:!0,analyticAction:"tags_copy_share_link"}),(0,i.jsx)(H.zx,{icon:u,label:d,size:H.qE.SMALL,variant:H.Wu.TERTIARY,theme:"dark",onClick:p,reverse:!0})]}))}var W,K=n(98529),Y=n(11208),q=n(90636),Z=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{ANNOTATIONS:$}=A.Z.SHOWCASE;let Q=W=class TagPreviewer extends s.Component{constructor(e){super(e),this.textParser=new I.v({links:!0}),this.openAttachment=(e,t)=>{this.trackEvent("tags_billboard_click_attachment"),this.props.onClick(t)},this.onClickTag=e=>{const{editMode:t}=this.context;this.trackEvent(t?"tags_billboard_click_to_edit":"tags_billboard_click_to_dock"),e.stopPropagation(),this.props.onClick()},this.handleTruncationChange=e=>{this.setState({truncated:e})},this.state={keywordsEnabled:!1,tagView:null,truncated:!1}}componentDidMount(){this.updateTagView()}componentDidUpdate(e){e.previewId!==this.props.previewId&&this.updateTagView()}updateTagView(){const{previewId:e}=this.props,{toolsData:t}=this.context,n=t.getTool(D.w1.TAGS);if(n){const t=n.manager.dataMap.tagsViewData;if(!t)return;const i=t.getTagView(e),s=t.keywordsEnabled;this.setState({tagView:i,keywordsEnabled:s})}}trackEvent(e){this.context.analytics.trackToolGuiEvent("tags",e)}renderWidgetFrame(e){const{widgetFrame:t}=e;return t?(0,i.jsx)(Y.l,{widget:t}):null}render(){const{tagView:e,keywordsEnabled:t,truncated:n}=this.state;if(!e)return null;const{locale:s}=this.context,{layerWidth:r,layerHeight:o,linkHandler:a}=this.props,{id:c,label:d,attachments:h,description:p,keywords:m}=e,f=(0,S.Ug)(h),g=f.length>0,v=(0,S.ae)(h),y=v.length-3;y>0&&(v.length=3);const b=s.t($.READ_MORE_MESSAGE),E=!d&&!p,T=l()("annotation-preview-contents","tag-billboard",{"viewable-media":g,"media-only":E,"has-keywords":t&&m&&m.length>0});return(0,i.jsxs)("div",Object.assign({className:T,onClick:this.onClickTag},{children:[(0,i.jsx)(z,{tag:e}),(0,i.jsxs)("div",Object.assign({className:"tag-billboard-contents"},{children:[(0,i.jsx)(B,{attachments:f,layerWidth:r,layerHeight:o,onClick:this.openAttachment}),d&&(0,i.jsx)("div",Object.assign({className:"tag-billboard-title"},{children:d})),p&&(0,i.jsx)("div",Object.assign({className:"tag-billboard-description"},{children:(0,i.jsx)(w.e,{text:p,textParser:this.textParser,linkHandler:a,annotationType:u.J.TAG,annotationId:c,maxLength:W.MAX_TAG_LENGTH,maxLines:W.MAX_DESCRIPTION_LINES,onTruncationChange:this.handleTruncationChange})})),m&&t&&(0,i.jsx)(K.s,{keywords:m,theme:"dark",className:"tag-previewer-keywords"}),v.length>0&&(0,i.jsx)(q.s,Object.assign({attachments:v},{children:y>0&&(0,i.jsx)("div",Object.assign({className:"attachment attachments-truncated"},{children:(0,i.jsx)("div",Object.assign({className:"attachment-view attachment-other "},{children:(0,i.jsx)("div",Object.assign({className:"attachment-label"},{children:(0,i.jsxs)("div",Object.assign({className:"file-label"},{children:[y," more attachment",1===y?"":"s","..."]}))}))}))}))})),this.renderWidgetFrame(e),n&&(0,i.jsx)("div",Object.assign({className:"annotation-read-more"},{children:(0,i.jsx)("span",Object.assign({className:"link link-more"},{children:b}))}))]}))]}))}};Q.contextType=v.I,Q.MAX_TAG_LENGTH=100,Q.MAX_DESCRIPTION_LINES=4,Q=W=Z([o.Z],Q);const X=(0,L.i)(Q);var J=n(91997),ee=n(20302),te=n(61709);const ne=(0,ee.u)(te.n),ie=(0,ee.u)(J.h),se=({previewId:e})=>{const t=ie(),n=ne();if(!t||!n)return null;const s=t.suggestions.find((t=>t.id===e));if(!s)return null;const r=s.mattertagId?n.getTag(s.mattertagId):void 0,o=r?r.label:s.displayLabel,a=r?r.description:s.displayCategory,c=r&&(null==r?void 0:r.keywords.length)>0?r.keywords:s.keywords,d=l()("annotation-preview-contents","object-billboard",{});return(0,i.jsx)("div",Object.assign({className:d},{children:(0,i.jsxs)("div",Object.assign({className:"object-billboard-contents"},{children:[(0,i.jsx)("div",Object.assign({className:"object-billboard-title"},{children:o})),c&&(0,i.jsx)(K.s,{keywords:c,theme:"dark",className:"tag-previewer-keywords"}),(0,i.jsx)("div",Object.assign({className:"object-billboard-description"},{children:a}))]}))}))};var re=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let oe=class AnnotationsLayer extends s.Component{constructor(e){super(e),this.bindings=[],this.isUnmounting=!1,this.clickOuterAnnotation=()=>{const{currentAnnotation:e}=this.state;if(!e)return;const{selectedAnnotation:t,dockedAnnotation:n}=this.viewData;if(t)this.closeAnnotation();else{n||e.annotationType===u.J.NOTE?this.dockAnnotation():this.selectAnnotation()}},this.onClickNote=async e=>{this.context.analytics.trackGuiEvent("click_note_preview"),this.clickInnerAnnotation(e)},this.onClickTag=e=>{this.context.analytics.trackGuiEvent("tags_click_tag_billboard"),this.clickInnerAnnotation(e)},this.onResize=e=>{e.forEach((e=>{const t=e.target;t.classList.contains("annotation-preview")&&"hidden"!==t.style.visibility||this.updatePositioning(!0)}))},this.updateScreenPosition=()=>{this.updatePositioning(!1)},this.updateCurrentAnnotation=()=>{const{billboardAnnotation:e}=this.viewData;this.setState({currentAnnotation:e}),e&&this.updatePositioning(!0)},this.updatePositioning=e=>{if(!this.pinsViewData||!this.layer||!this.viewData.billboardAnnotation)return;const t=this.pinsViewData.screenPosition;if(t){if(e){const e=t.x,n=t.y;this.updatePreviewDirection(e,n)}this.setState({screenPosition:t,layerWidth:this.layer.offsetWidth,layerHeight:this.layer.offsetHeight})}},this.updatePreviewDirection=(e,t)=>{if(!this.layer||!this.preview)return;const{layerWidth:n,layerHeight:i,previewDirection:s}=this.state,{offsetWidth:r,offsetHeight:o}=this.preview;if(!(n&&i&&r&&o))return;let a=s;const l=t<o,d=t>i-o,u=e<r,h=e>n-r;l&&d?a=h&&!u?c.Od.LEFT:c.Od.RIGHT:l?a=u?c.Od.DOWN_RIGHT:h?c.Od.DOWN_LEFT:c.Od.DOWN:d?a=u?c.Od.UP_RIGHT:h?c.Od.UP_LEFT:c.Od.UP:u&&h?a=l?c.Od.DOWN:c.Od.UP:u?a=c.Od.RIGHT:h?a=c.Od.LEFT:null===a&&(a=c.Od.RIGHT),a!==s&&this.setState({previewDirection:a})},this.setLayerRef=e=>{this.layer=e,e&&(this.resizeObserver.observe(e),this.updatePositioning(!0))},this.setPreviewRef=e=>{this.preview=e,e&&(this.resizeObserver.observe(e),this.updatePositioning(!0))},this.state={currentAnnotation:null,screenPosition:null,previewDirection:null,layerWidth:0,layerHeight:0},this.resizeObserver=new r.Z(this.onResize)}componentDidMount(){const{market:e}=this.context;Promise.all([e.waitForData(h.A),e.waitForData(d.B)]).then((([e,t])=>{this.isUnmounting||(this.viewData=e,this.pinsViewData=t,this.bindings.push(e.onChanged(this.updateCurrentAnnotation),t.onScreenPositionChanged(this.updateScreenPosition)),this.isUnmounting||(this.updateCurrentAnnotation(),this.updateScreenPosition()))}))}componentWillUnmount(){this.isUnmounting=!0;for(const e of this.bindings)e.cancel();this.resizeObserver&&this.resizeObserver.disconnect()}async clickInnerAnnotation(e){const{currentAnnotation:t}=this.state;if(t){const{messageBus:n}=this.context,{id:i,annotationType:s}=t;e&&!this.viewData.dockedAnnotation||this.dockAnnotation(),e&&n.broadcast(new p.qk(s,i,e))}}dockAnnotation(){const{currentAnnotation:e}=this.state;if(!e)return;const{analytics:t,commandBinder:n}=this.context;t.trackGuiEvent(`annotations_dock_${e.annotationType}`),n.issueCommand(new m.bd(e.id,e.annotationType))}selectAnnotation(){const{currentAnnotation:e}=this.state;if(!e)return;const{analytics:t,commandBinder:n}=this.context;t.trackGuiEvent(`annotations_select_${e.annotationType}`),n.issueCommand(new m.oM(e.id,e.annotationType))}closeAnnotation(){const{currentAnnotation:e}=this.state;if(!e)return;const{commandBinder:t}=this.context;t.issueCommand(new m.Aj(e.id,e.annotationType))}getPreviewPositioning(){const{screenPosition:e,previewDirection:t}=this.state;if(e){let n="",i=e.x;switch(t){case c.Od.UP:n="translate(-50%, -100%)";break;case c.Od.DOWN:n="translateX(-50%)";break;case c.Od.LEFT:n="translate(-100%, -50%)";break;case c.Od.RIGHT:n="translateY(-50%)";break;case c.Od.UP_LEFT:i+=50,n="translate(-100%, -100%)";break;case c.Od.UP_RIGHT:n="translate(-50px, -100%)";break;case c.Od.DOWN_LEFT:i+=50,n="translate(-100%, 5px)";break;case c.Od.DOWN_RIGHT:n="translate(-50px, 5px)"}return{top:`${e.y}px`,left:`${i}px`,visibility:null===t?"hidden":"",transform:n}}return{}}render(){const{openModal:e,newTagsEnabled:t,notesEnabled:n}=this.props;if(e)return null;const{currentAnnotation:s,previewDirection:r,screenPosition:o,layerWidth:a,layerHeight:c}=this.state,d=null===o,h=c-100,p=t&&s&&s.annotationType===u.J.TAG,m=n&&s&&s.annotationType===u.J.NOTE,f=s&&s.annotationType===u.J.OBJECT;return(0,i.jsx)("div",Object.assign({ref:this.setLayerRef,className:"annotations-preview-layer"},{children:s&&(p||m||f)&&!d&&(0,i.jsxs)("div",Object.assign({ref:this.setPreviewRef,className:l()("annotation-preview",`annotation-preview-${r}`,{"tag-preview":!!p,"note-preview":!!m,"object-preview":!!f}),style:this.getPreviewPositioning(),onClick:this.clickOuterAnnotation},{children:[p&&(0,i.jsx)(X,{previewId:s.id,onClick:this.onClickTag,layerWidth:a,layerHeight:h}),m&&(0,i.jsx)(N,{previewId:s.id,onClick:this.onClickNote}),f&&(0,i.jsx)(se,{previewId:s.id})]}))}))}};oe.contextType=v.I,oe=re([o.Z],oe)},64191:(e,t,n)=>{"use strict";n.d(t,{e:()=>f});var i=n(85893),s=n(67294),r=n(57340),o=n(60405),a=n(36589),l=n(33009),c=n(18236),d=n(50566),u=n(16534),h=n(90636),p=n(42201),m=(n(79071),n(9706),function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o});let f=class ViewOnlyAnnotation extends s.Component{constructor(e){super(e),this.onTextReplaced=e=>{const{onTruncationChange:t}=this.props,n=this.state.truncated;this.setState({truncated:e}),t&&n!==e&&t(e)},this.onClickAnchor=e=>{const t=e.target,n=t.dataset.blocktype;if(e.stopPropagation(),n){const{annotationType:i,annotationId:s,linkHandler:r}=this.props,o={blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id};if(n===a.C.LINK&&r&&o.value){e.preventDefault();const t=(0,l.V)(o.value),{url:n,modelId:a,pose:d}=t;a?r.handler.openLink({fullLink:n,modelId:a}):d?(r.handler.openLink({fullLink:n,pose:d}),this.context.commandBinder.issueCommand(new c.Aj(s,i))):r.handler.openLink(n)}this.context.messageBus.broadcast(new d.iP(i,s,o))}},this.state={truncated:!1}}renderAttachments(e){if(0===e.length)return null;const{onViewAttachment:t}=this.props;return(0,i.jsx)(h.s,{attachments:e,onViewAttachment:t})}render(){const{settings:e}=this.context,{text:t,textParser:n,edited:s,attachments:r,maxLength:o,maxLines:a,readMore:l}=this.props,{truncated:c}=this.state,d=e.tryGetProperty(u.sX,!1);return(0,i.jsxs)("div",Object.assign({className:"annotation-box"},{children:[(0,i.jsx)("div",Object.assign({className:"annotation-text-box"},{children:(0,i.jsx)(p.Z,{text:t,textParser:n,onClickAnchor:d?void 0:this.onClickAnchor,clickableLinks:!d,onTextReplaced:this.onTextReplaced,maxLength:o,maxLines:a,readonly:!0})})),s&&(0,i.jsx)("div",Object.assign({className:"annotation-edited"},{children:"(edited)"})),l&&c&&(0,i.jsx)("div",Object.assign({className:"annotation-read-more"},{children:(0,i.jsx)("span",Object.assign({className:"link link-more"},{children:l}))})),r&&!d&&this.renderAttachments(r)]}))}};f.contextType=o.I,f=m([r.Z],f)},65610:(e,t,n)=>{"use strict";n.d(t,{P:()=>z});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(10854),c=n(60405),d=n(87443),u=n(9042),h=n(72187),p=n(5477),m=n(87982),f=n(61445);function g(e,t,n,i){let s=e,r=t;if(n&&s>n){const e=n/s;s*=e,r&&(r*=e)}if(r&&i&&r>i){const e=i/r;s*=e,r*=e}return{width:s,height:r}}class OEmbedTextComponent extends s.Component{constructor(e){super(e)}render(){const{className:e,cover:t,data:n,onClick:s,style:r}=this.props,a=o()("oembed","oembed-text",e,{"oembed-text--cover":t}),l=n.provider_name?`${n.provider_name} content`:"Embedded content",c=n.author_name?`from ${n.author_name}`:"";return(0,i.jsxs)("div",Object.assign({className:a,style:r,onClick:s},{children:[n.title&&(0,i.jsx)("h3",{children:n.title}),(0,i.jsx)("p",{children:`${l} ${c}`})]}))}}const v=["soundcloud","spotify"];class OEmbedThumbnailComponent extends s.Component{constructor(e){super(e)}getAttributes(){const{data:e}=this.props;let t=e.thumbnail_url,n=e.thumbnail_width,i=e.thumbnail_height;return(!t||!n||!i)&&e.type===h.ht.PHOTO&&(t=e.url,n=e.width,i=e.height),{url:t,width:n,height:i}}render(){const{className:e,cover:t,data:n,disabled:s,maxHeight:r,maxWidth:a,onClick:l,style:c}=this.props,{url:d,width:u,height:p}=this.getAttributes();if(!d||!u||!p)return(0,i.jsx)(OEmbedTextComponent,Object.assign({},this.props));const y=function(e,t){return e<128||t<128}(u,p),b=!s&&function(e){const t=(e.provider_name||"").toLowerCase();return e.type===h.ht.VIDEO?"giphy"!==t:!(e.type!==h.ht.RICH||!v.includes(t))}(n),S=o()("oembed","oembed-thumbnail",e,{"oembed-thumbnail--cover":t,"oembed-thumbnail--cover--icon":t&&y}),E=Object.assign(Object.assign({},c),{backgroundImage:`url('${d}')`});if(!t){const{width:e,height:t}=g(u,p,a,r);E.width=`${e}px`,E.height=`${t}px`}return t&&y&&(E.maxWidth=1.5*u+"px"),(0,i.jsx)("div",Object.assign({className:S,style:E,onClick:s?void 0:l},{children:b&&(0,i.jsx)(m.hU,{className:"oembed-thumbnail__cta",iconClass:"icon-play-unicode",buttonStyle:m.Dd.OVERLAY,buttonSize:f.qE.LARGE})}))}}class OEmbedPhotoComponent extends s.Component{constructor(e){super(e)}render(){const{className:e,cover:t,data:n,maxHeight:s,maxWidth:r,onClick:a,style:l}=this.props,c=o()("oembed","oembed-photo",e,{"oembed-photo--cover":t});if(t){const e=Object.assign(Object.assign({},l),{backgroundImage:`url('${n.url}')`});return(0,i.jsx)("div",{className:c,style:e,onClick:a})}if(!r&&!s)return(0,i.jsx)("img",{className:c,src:n.url,style:l,onClick:a});const{width:d,height:u}=g(n.width,n.height,r,s);return(0,i.jsx)("img",{className:c,src:n.url,style:l,onClick:a,width:d,height:u})}}var y=n(2252);function b(e){const{className:t,children:n}=e;if(!n)return null;const s=o()("oembed","oembed-loading",t);return(0,i.jsx)("div",Object.assign({className:s},{children:n}))}const S={flickr:!0,instagram:!0},E="oembed-iframe--loading",T=/^<iframe.*>.*<\/iframe>$/;function w(e,t,n,i){const{html:s}=e;let r;var o,a;o=s,r=T.test(o)?function(e){const t=document.createElement("div");return t.innerHTML=e,t.firstChild}(s):function(e){const t=document.createElement("iframe");return t.setAttribute("allow","encrypted-media; autoplay; fullscreen"),t.srcdoc=`<!doctype html>${e}`,t}(s),r.src||void 0!==(a=e.provider_name)&&S[a.toLowerCase()]?r.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups allow-presentation"):r.setAttribute("sandbox","allow-same-origin"),r.classList.add("oembed-iframe",E),t&&(r.onload=()=>t(r));const{width:l,height:c}=g(e.width,e.height,n,i);return r.width=`${l}`,c&&(r.height=`${c}`),r}function x(e){const{className:t,data:n,loadingComponent:r,maxHeight:o,maxWidth:a,onClick:l,onLoad:c,style:d}=e,u=(0,s.useRef)(),h=(0,s.useRef)(),[p,m]=(0,s.useState)(!1),f=(0,s.useCallback)((e=>{const t=w(n,c,a,o);h.current&&h.current.remove(),h.current=t,e.appendChild(t),m(!0)}),[n]);(0,s.useEffect)((()=>(u.current&&f(u.current),()=>{})),[f]);const g=(0,s.useCallback)((e=>{u.current=e,h||f(e)}),[f]);return(0,i.jsx)("div",Object.assign({className:t,style:d,ref:g,onClick:l},{children:!p&&(0,i.jsx)(b,{children:r})}))}var _=n(17141);const M=new p.Z("oembed-video");class OEmbedVideoComponent extends s.Component{constructor(){super(...arguments),this.isUnmounting=!1,this.onIFrameLoad=async e=>{if(!this.isUnmounting){e.classList.remove(E);try{const t=await function(e){const t=new _.Player(e);return new Promise(((e,n)=>{t.on("ready",(()=>{e(t)}))}))}(e);if(this.isUnmounting)return;(0,y.tq)()||t.play()}catch(e){M.warn("unable to autoplay video"),M.warn(e)}}}}componentWillUnmount(){this.isUnmounting=!0}render(){const{className:e,cover:t}=this.props;if(t)return(0,i.jsx)(OEmbedThumbnailComponent,Object.assign({},this.props));const n=o()("oembed","oembed-video",e);return(0,i.jsx)(x,Object.assign({},this.props,{className:n,onLoad:this.onIFrameLoad}))}}class OEmbedRichComponent extends s.Component{constructor(){super(...arguments),this.isUnmounting=!1,this.onIFrameLoad=e=>{if(this.isUnmounting)return;const t=()=>{const t=function(e){var t;const n=null===(t=e.contentWindow)||void 0===t?void 0:t.document;if(!n)return;const i=n.body,s=n.documentElement;return Math.max(i.scrollHeight,i.offsetHeight,s.clientHeight,s.scrollHeight,s.offsetHeight)}(e),n=t?`${t}`:"";n&&(e.height=n)};this.props.data.height||(this.stopHeightCheck=function(e,t){let n,i=t;const s=()=>{e(),i*=1.5,n=window.setTimeout(s,i)};return n=window.setTimeout(s,i),()=>window.clearTimeout(n)}(t,100)),e.classList.remove(E)}}componentWillUnmount(){this.isUnmounting=!0,this.stopHeightCheck&&this.stopHeightCheck()}render(){const{className:e,cover:t}=this.props;if(t)return(0,i.jsx)(OEmbedThumbnailComponent,Object.assign({},this.props));const n=o()("oembed","oembed-rich",e);return(0,i.jsx)(x,Object.assign({},this.props,{className:n,onLoad:this.onIFrameLoad}))}}function O(e){const{children:t,className:n}=e;if(!t)return null;const s=o()("oembed","oembed-error",n);return(0,i.jsx)("div",Object.assign({className:s},{children:t}))}const A=new p.Z("oembed-errors");class OEmbedComponent extends s.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e){A.warn(e.message)}componentDidUpdate(e){e.data!==this.props.data&&this.setState({hasError:!1})}render(){const{className:e,cover:t,data:n,disabled:s,errorComponent:r,loadingComponent:o,maxHeight:a,maxWidth:l,onClick:c,showError:d,style:u,thumbnail:p}=this.props;if(d||this.state.hasError)return(0,i.jsx)(O,Object.assign({className:e},{children:r}));if(!n)return(0,i.jsx)(b,Object.assign({className:e},{children:o}));const m={className:e,cover:t,maxHeight:a,maxWidth:l,onClick:c,style:u};return p?(0,i.jsx)(OEmbedThumbnailComponent,Object.assign({data:n,disabled:s},m)):n.type===h.ht.PHOTO?(0,i.jsx)(OEmbedPhotoComponent,Object.assign({data:n},m)):n.type===h.ht.VIDEO?(0,i.jsx)(OEmbedVideoComponent,Object.assign({data:n,loadingComponent:o},m)):n.type===h.ht.RICH?(0,i.jsx)(OEmbedRichComponent,Object.assign({data:n,loadingComponent:o},m)):null}}var C=n(41345);const{ATTACHMENTS:N}=l.Z.SHOWCASE;function D(e){const t=(0,C.b)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"icon icon-error"}),!e.compact&&(0,i.jsx)("div",Object.assign({className:"embed-error-message"},{children:t.t(N.FAILED_TO_LOAD_MESSAGE)}))]})}var I=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let L=class EmbeddedMedia extends s.Component{constructor(e){super(e),this.isUnmounting=!1,this.state={embed:null,showError:!1}}componentDidMount(){this.getEmbeddedMedia()}componentWillUnmount(){this.isUnmounting=!0}componentDidUpdate(e){this.props.attachment.id!==e.attachment.id&&this.getEmbeddedMedia()}async getEmbeddedMedia(){const{attachment:e}=this.props,{commandBinder:t}=this.context;try{const n=await t.issueCommand(new d.st(e));if(!n)throw new Error("embed not found");if(this.isUnmounting)return;this.setState({attachmentId:e.id,embed:n,showError:!1})}catch(t){if(this.isUnmounting)return;this.setState({attachmentId:e.id,embed:null,showError:!0})}}render(){const{compact:e,cover:t,maxHeight:n,maxWidth:s,onClick:r,style:a,thumbnail:l}=this.props,{embed:c,showError:d}=this.state,u=c&&this.state.attachmentId===this.props.attachment.id,h=(0,i.jsx)("div",{className:"gui-spinner-icon"}),p=(0,i.jsx)(D,{compact:e}),m=o()("embedded-media",{"embedded-media--error":d,clickable:r&&!d});return(0,i.jsx)(OEmbedComponent,{className:m,data:u&&null!=c?c:void 0,style:a,loadingComponent:h,errorComponent:p,showError:d,thumbnail:l,cover:t,disabled:e,maxWidth:s,maxHeight:n,onClick:d?void 0:r})}};L.contextType=c.I,L=I([a.Z],L);var P=n(85553),R=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let k=class Image extends s.Component{constructor(e){super(e),this.clickImage=e=>{this.props.onClick&&this.props.onClick(e,this.props.id)}}render(){const{className:e,onClick:t,url:n,cover:s,style:r}=this.props,a={"image-cover":!!s};if(e&&Object.assign(a,{[e]:!0}),s){const e=Object.assign(Object.assign({},r),{backgroundImage:n?`url('${n}')`:"none"});return(0,i.jsx)("div",{className:o()("image",a),style:e,onClick:t?this.clickImage:void 0})}return(0,i.jsx)("img",{className:o()("image",a),src:n,style:r,onClick:t?this.clickImage:void 0})}};k=R([a.Z],k);var U=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{ATTACHMENTS:B}=l.Z.SHOWCASE;let F=class UploadedMedia extends s.Component{constructor(e){super(e),this.isUnmounting=!1,this.state={mediaUrl:""}}componentDidMount(){this.loadMedia()}componentWillUnmount(){this.isUnmounting=!0}componentDidUpdate(e){e.attachment.id!==this.props.attachment.id&&this.loadMedia()}getImageUrl(){const{attachment:e,cover:t,smartWidth:n,smartHeight:i}=this.props,{mediaUrl:s}=this.state;if(!(0,P.lV)(e))return null;if(!t||void 0===n||void 0===i||!(0,P.Uq)(e))return s;const r=-1!==s.indexOf("?");return`${s}${r?"&":"?"}height=${i}&crop=${n}:${i},smart`}async loadMedia(){const{attachment:e,thumbnail:t}=this.props,n=t&&e.thumbnailUrl?e.thumbnailUrl:e.url,i=await n.get();this.isUnmounting||this.setState({mediaUrl:i})}render(){const{attachment:e,cover:t,inline:n,onClick:s,style:r}=this.props,{id:a,category:l,filename:c,bytes:d}=e;if(l!==u.G.UPLOAD)return null;const h=this.getImageUrl(),p=o()("attachment-view",{clickable:!!s});if(h)return(0,i.jsx)(k,{id:a,url:h,cover:t,style:r,onClick:s,className:p});{const{mediaUrl:e}=this.state,t=this.context.locale.t(B.DOWNLOAD_TOOLTIP),a=d?(0,P.VV)(d):"";return(0,i.jsxs)("div",Object.assign({className:o()(p,"attachment-other",{inline:n}),onClick:s,style:r},{children:[!n&&(0,i.jsx)("div",{className:"icon icon-file"}),(0,i.jsxs)("div",Object.assign({className:"attachment-label"},{children:[(0,i.jsx)("div",Object.assign({className:"file-label"},{children:c})),a&&!n&&(0,i.jsx)("div",Object.assign({className:"size-label"},{children:a}))]})),!n&&e&&(0,i.jsx)("a",Object.assign({className:"link download-link","data-balloon":t,"data-balloon-pos":"down",href:e,download:!0},{children:(0,i.jsx)("span",{className:"icon-download"})}))]}))}}};F.contextType=c.I,F=U([a.Z],F);var V=n(54119);function H(e){const t=(0,s.useCallback)((function(t){e.onLoad(t.currentTarget)}),[e]);return(0,i.jsx)("iframe",{style:{width:"100%",height:"100%",border:0},src:e.src,onLoad:t})}var j=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{ATTACHMENTS:G}=l.Z.SHOWCASE;let z=class Attachment extends s.Component{constructor(e){super(e),this.removeAttachment=e=>{const{canDelete:t,attachment:n}=this.props;e.stopPropagation(),t&&(this.context.analytics.trackGuiEvent("attachments_click_remove"),this.context.commandBinder.issueCommand(new d.$T(n)))},this.onClick=e=>{this.props.onClick&&this.props.onClick(e,this.props.attachment.id)}}render(){const{inline:e,canDelete:t,hero:n}=this.props,s={inline:!!e,hero:!!n},r=this.context.locale.t(G.DELETE_ATTACHMENT_TOOLTIP);return(0,i.jsxs)("div",Object.assign({className:o()("attachment",s)},{children:[this.renderMedia(),t&&(0,i.jsx)(V.zx,{icon:"close",className:"attachment-delete",size:V.qE.SMALL,variant:V.Wu.FAB,theme:"dark",tooltip:r,tooltipOptions:{placement:"bottom-start"},onClick:this.removeAttachment})]}))}renderMedia(){const{attachment:e,cover:t,inline:n,maxHeight:s,maxWidth:r,smartHeight:o,smartWidth:a,style:l,thumbnail:c}=this.props,d={attachment:e,thumbnail:c,cover:t,onClick:this.props.onClick?this.onClick:void 0};switch(e.category){case u.G.UPLOAD:return(0,i.jsx)(F,Object.assign({},d,{inline:n,smartWidth:a,smartHeight:o,style:l}));case u.G.EXTERNAL:return(0,i.jsx)(L,Object.assign({},d,{compact:n,maxWidth:r,maxHeight:s,style:l}));case u.G.SANDBOX:const e=this.props.attachment;return(0,i.jsx)(H,{src:e.src,onLoad:e.onLoad})}}};z.contextType=c.I,z=j([a.Z],z)},34259:(e,t,n)=>{"use strict";n.d(t,{T:()=>h});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(65610),d=n(87982),u=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let h=class AttachmentCarousel extends s.Component{constructor(e){super(e),this.onNext=e=>{const{attachments:t,onNavigate:n}=this.props,{index:i}=this.state;e.stopPropagation();const s=i+1<t.length?i+1:0;this.context.analytics.trackGuiEvent("attachments_viewer_next"),this.setState({index:s}),n&&n(s)},this.onPrev=e=>{const{attachments:t,onNavigate:n}=this.props,{index:i}=this.state;e.stopPropagation();const s=i>0?i-1:t.length-1;this.context.analytics.trackGuiEvent("attachments_viewer_prev"),this.setState({index:s}),n&&n(s)},this.state={index:e.startIndex}}UNSAFE_componentWillReceiveProps(e){this.setState({index:e.startIndex})}render(){const{attachments:e,onClick:t,smartWidth:n,smartHeight:s}=this.props,{index:r}=this.state,a=e[r];if(!a)return null;const l=e.length>1,u=void 0!==n&&void 0!==s;return(0,i.jsxs)("div",Object.assign({className:"attachment-carousel"},{children:[(0,i.jsx)("div",Object.assign({className:"attachment-carousel-view"},{children:(0,i.jsx)(c.P,{attachment:a,onClick:t,cover:u,smartWidth:n,smartHeight:s,thumbnail:!1})})),l&&(0,i.jsx)(d.hU,{className:o()("modal-nav","modal-prev"),iconClass:"icon-dpad-left",onClick:this.onPrev}),l&&(0,i.jsx)(d.hU,{className:o()("modal-nav","modal-next"),iconClass:"icon-dpad-right",onClick:this.onNext})]}))}};h.contextType=l.I,h=u([a.Z],h)},82092:(e,t,n)=>{"use strict";n.d(t,{I:()=>E});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=n(43985),c=n(36616),d=n(71843),u=n(56829),h=n(87443),p=n(96372),m=n(34259),f=n(87982),g=n(78576),v=n(60405),y=n(10854),b=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{ATTACHMENTS:S}=y.Z.SHOWCASE;let E=class AttachmentViewer extends s.Component{constructor(e){super(e),this.bindings=[],this.onKey=async e=>{const{attachments:t,attachmentIndex:n}=this.state,i=t.length;let s=-1;switch(e.keyCode){case l.R.ESCAPE:this.closeAttachmentViewer();break;case l.R.LEFTARROW:s=n-1,s<0&&(s=i-1);break;case l.R.RIGHTARROW:s=n+1,s>=i&&(s=0)}-1!==s&&this.setState({attachmentIndex:s}),e.stopPropagation()},this.closeAttachmentViewer=()=>{this.state.open&&this.context.commandBinder.issueCommand(new h.xW(!1))},this.onModalToggled=e=>{e.modal!==c.P.ATTACHMENT||e.open||this.closeAttachmentViewer()},this.onViewerClosed=()=>{this.state.open&&(document.removeEventListener("keydown",this.onKey,{capture:!0}),this.context.commandBinder.issueCommand(new d.Bz(c.P.ATTACHMENT,!1)),this.setState({open:!1}))},this.onNavigate=e=>{this.setState({attachmentIndex:e})},this.onViewAttachments=e=>{const{attachments:t,attachmentId:n}=e,i=n||this.getCurrentAttachmentId(),s=t.findIndex((e=>e.id===i));0===t.length||-1===s?this.closeAttachmentViewer():(this.state.open||(document.addEventListener("keydown",this.onKey,{capture:!0}),this.context.commandBinder.issueCommand(new d.Bz(c.P.ATTACHMENT,!0)),this.setState({open:!0})),this.setState({attachments:t,attachmentIndex:s}))},this.state={open:!1,attachmentIndex:-1,attachments:[]}}componentDidMount(){const{messageBus:e}=this.context;this.bindings.push(e.subscribe(p.O,this.onViewAttachments),e.subscribe(p.Rd,this.onViewerClosed),e.subscribe(u.nV,this.onModalToggled))}componentWillUnmount(){for(const e of this.bindings)e.cancel();document.removeEventListener("keydown",this.onKey,{capture:!0})}getCurrentAttachmentId(){var e;const{attachmentIndex:t,attachments:n}=this.state;return(null===(e=n[t])||void 0===e?void 0:e.id)||void 0}render(){const{open:e,attachments:t,attachmentIndex:n}=this.state,{locale:s}=this.context,r=s.t(S.CLOSE_TOOLTIP),o=s.t(S.VIEWER_INDEX_COUNT,{currentNumber:n+1,totalNumber:t.length});return(0,i.jsx)("div",Object.assign({className:a()("overlay-layer","attachment-overlay",{open:e})},{children:e&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",Object.assign({className:"overlay-top-bar"},{children:[(0,i.jsx)("div",Object.assign({className:"overlay-label"},{children:o})),(0,i.jsx)(f.hU,{iconClass:"icon-close",buttonStyle:f.Dd.OVERLAY,tooltipMsg:r,tooltipPosition:g.lZ.DOWN,onClick:this.closeAttachmentViewer})]})),(0,i.jsx)(m.T,{attachments:t,startIndex:n,onNavigate:this.onNavigate})]})}))}};E.contextType=v.I,E=b([r.Z],E)},4662:(e,t,n)=>{"use strict";n.d(t,{H:()=>x});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(57340),c=n(60405),d=n(10854),u=n(73156),h=n(17423),p=n(23676),m=n(34612),f=n(36616),g=n(71843),v=n(56829),y=n(51073),b=n(78576),S=n(87982),E=n(61445),T=n(56759),w=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let x=i=class NotesModeButton extends r.Component{constructor(e,t){super(e),this.nudgeTimeout=0,this.bindings=[],this.onModalToggled=e=>{e.modal!==f.P.NOTES_INTRO||e.open||this.toggleNotesMode(!0)},this.dismissNudge=()=>{this.state.showNudge&&(this.context.analytics.trackGuiEvent("notes_nudge_dismissed"),this.context.settings.setLocalStorageProperty(h.F.NotesModeNudgeSeen,!0),this.setState({showNudge:!1}))},this.modeButtonClicked=()=>{const e=this.props.openTool!==p.w1.NOTES;if(e){const{commandBinder:e,settings:t}=this.context;this.context.analytics.trackGuiEvent("notes_mode_click_open");if(!t.tryGetProperty(h.F.NotesIntroModalSeen,!1))return void e.issueCommand(new g.Bz(f.P.NOTES_INTRO,!0))}this.toggleNotesMode(e)},this.localized={notesModeString:t.locale.t(d.Z.NOTES_MODE),nudgeTitleString:t.locale.t(d.Z.NOTES_NUDGE_TITLE),nudgeMessageString:t.locale.t(d.Z.NOTES_NUDGE_MESSAGE)},this.state={showNudge:!1}}componentDidMount(){this.updateNudge(),this.bindings.push(this.context.messageBus.subscribe(v.nV,this.onModalToggled))}componentWillUnmount(){for(const e of this.bindings)e.cancel()}updateNudge(){const e=this.context.settings.tryGetProperty(u.pE,!1),t=this.context.settings.tryGetProperty(h.F.NotesModeNudgeSeen,!1);!e||t||this.nudgeTimeout||(this.nudgeTimeout=window.setTimeout((()=>{this.setState({showNudge:!0}),window.setTimeout((()=>{this.dismissNudge()}),i.DISMISS_NUDGE_TIMEOUT)}),i.SHOW_NUDGE_TIMEOUT))}toggleNotesMode(e){const{commandBinder:t,messageBus:n}=this.context;e&&n.broadcast(new y.Ey),t.issueCommand(new m.tT(p.w1.NOTES,e))}render(){const{className:e,tooltipTimeout:t,openTool:n}=this.props,{showNudge:i}=this.state,{nudgeTitleString:r,nudgeMessageString:o}=this.localized,l=this.localized.notesModeString,c=n===p.w1.NOTES?E.BN.ACTIVE:E.BN.ENABLED;return(0,s.jsxs)("div",Object.assign({className:a()("notes-mode-button",e)},{children:[(0,s.jsx)(S.hU,Object.assign({ariaLabel:l,buttonState:c,onClick:this.modeButtonClicked},{children:(0,s.jsx)(b.oO,Object.assign({content:l,position:b.lZ.UP,tooltipTimeout:t},{children:(0,s.jsx)("span",{className:"icon icon-comment-outline"})}))})),(0,s.jsx)(T.u,{className:a()("tooltip-title-large","nudge-tooltip"),open:i,closeButton:!0,onClose:this.dismissNudge,title:r,message:(0,s.jsx)("div",Object.assign({className:"nudge-message"},{children:(0,s.jsx)("span",Object.assign({className:"message"},{children:o}))})),arrowPos:T.x.BOTTOM_CENTER})]}))}};x.contextType=c.I,x.SHOW_NUDGE_TIMEOUT=15e3,x.DISMISS_NUDGE_TIMEOUT=1e4,x=i=w([l.Z],x)},22397:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(56759),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let u=class Nudge extends s.Component{constructor(e,t){super(e),this.nudgeTimeout=0,this.initNudge=()=>{const e=this.context.settings.tryGetProperty(this.props.appSettingsKey,!1),t=this.context.settings.tryGetProperty(this.props.localStorageSettingsKey,!1);!e||t||this.nudgeTimeout||(this.nudgeTimeout=window.setTimeout((()=>{this.setState({show:!0}),window.setTimeout((()=>{this.dismissNudge()}),this.props.dismissTimeout)}),this.props.showTimeout))},this.dismissNudge=()=>{if(this.state.show){const{tool:e,guiAction:t}=this.props.analyticsKeys;this.context.analytics.trackToolGuiEvent(e,t),this.context.settings.setLocalStorageProperty(this.props.localStorageSettingsKey,!0),this.setState({show:!1})}},this.localized={title:t.locale.t(this.props.title),message:t.locale.t(this.props.message)},this.state={show:!1}}componentDidMount(){this.initNudge()}componentWillUnmount(){this.nudgeTimeout&&window.clearTimeout(this.nudgeTimeout)}render(){const{show:e}=this.state,{title:t,message:n}=this.localized,s=this.props.arrowPosition?this.props.arrowPosition:c.x.BOTTOM_CENTER;return(0,i.jsx)(c.u,{className:o()("tooltip-title-large","nudge-tooltip"),open:e,closeButton:!0,onClose:this.dismissNudge,title:t,message:(0,i.jsx)("div",Object.assign({className:"nudge-message"},{children:(0,i.jsx)("span",Object.assign({className:"message"},{children:n}))})),arrowPos:s})}};u.contextType=l.I,u=d([a.Z],u);const h=u},90190:(e,t,n)=>{"use strict";n.d(t,{d:()=>FloorControls});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(12622),l=n(60405),c=n(56044),d=n(39864),u=n(2252),h=n(41920),p=n(10854),m=n(78576),f=n(87982),g=n(61445);const v="floor-button";class FloorIconSelector extends s.Component{constructor(e){super(e),this.scrollbarsRef=(0,s.createRef)(),this.mobile=(0,u.tq)(),this.updateScrollCenter=()=>{if(Object.keys(this.props.floors).length<6||!this.scrollbarsRef.current)return;const{currentFloor:e}=this.props,t=e&&document.querySelector(`.floor-button[data-value="${e.id}"]`);t?this.scrollbarsRef.current.setScrollCenter(t):this.scrollbarsRef.current.scrollTo({y:0})},this.onOutsideClick=e=>{this.setShowMenu(!1)},this.onIconClick=e=>{e.stopPropagation(),this.setShowMenu(!this.state.showMenu),this.context.analytics.trackGuiEvent("floor_controls")},this.setShowMenu=e=>{this.state.showMenu!==e&&(e?window.addEventListener("click",this.onOutsideClick):window.removeEventListener("click",this.onOutsideClick),this.setState({showMenu:e}))},this.onFloorClick=e=>{e.stopPropagation(),this.setShowMenu(!1);const t=e.target.getAttribute("data-value");this.props.handleClickFloor(t),this.context.analytics.trackGuiEvent("floor_clicked")},this.renderFloorName=e=>{const{currentFloor:t,currentFloorIndicator:n}=this.props,s=n&&(null==t?void 0:t.id)===e.id,r=o()(v,{current:s});return(0,i.jsx)("div",Object.assign({className:r,onClick:this.onFloorClick,"data-value":e.id},{children:e.name}),e.id)},this.state={showMenu:!1}}componentDidMount(){this.updateScrollCenter()}componentWillUnmount(){window.removeEventListener("click",this.onOutsideClick)}componentDidUpdate(e){e.currentFloor!==this.props.currentFloor&&this.updateScrollCenter()}renderAllFloorName(){const e=!this.props.currentFloor,t=o()(v,{current:e}),n=this.context.locale.t(p.Z.FLOOR_ALL);return(0,i.jsx)("div",Object.assign({className:t,onClick:this.onFloorClick},{children:n}),"all")}getFloorMenu(){const e=this.props.floors.map(this.renderFloorName).reverse();this.props.shouldShowAll&&e.unshift(this.renderAllFloorName());const t=e.length>=6,n=o()("floor-menu-wrapper",{"faded-in":this.state.showMenu,scrollable:t});return t?(0,i.jsx)("div",Object.assign({className:n},{children:(0,i.jsx)(d.Z,Object.assign({name:"floor-menu-wrapper",forceHidden:this.mobile,ref:this.scrollbarsRef,singleScrollDirection:h.Nm.vertical,onScrollbarVisibilityChange:this.updateScrollCenter},{children:e}))})):(0,i.jsx)("div",Object.assign({className:n},{children:e}))}render(){const{currentFloor:e,currentFloorIndicator:t}=this.props,{showMenu:n}=this.state,s=t&&e&&e.index+1,r=this.context.locale.t(p.Z.HELP_MORE_FLOORS_A),a=n?g.BN.ACTIVE:g.BN.ENABLED,l=o()("select-floor",{"tooltip-hidden":n}),c=o()("floor-number",{"two-digit":void 0!==s&&s>=10}),d=o()("icon",{"icon-floor-controls-all":!s,"icon-floor-controls":s});return(0,i.jsxs)(f.hU,Object.assign({buttonState:a,onClick:this.onIconClick,className:"floor-controls",ariaLabel:r},{children:[this.getFloorMenu(),(0,i.jsxs)(m.oO,Object.assign({content:r,position:m.lZ.UP,className:l},{children:[(0,i.jsx)("div",Object.assign({className:c},{children:(0,i.jsx)("span",{children:s})})),(0,i.jsx)("span",{className:d})]}))]}))}}FloorIconSelector.contextType=l.I;var y=n(56767),b=n(80592),S=n(32683);class FloorControls extends s.Component{constructor(e){super(e),this.bindings=[],this.isUnmounting=!1,this.handleClickFloor=e=>{(0,b.j)(e,this.context)},this.onCurrentFloorChanged=()=>{var e,t;const n=(null===(e=this.floorsViewData)||void 0===e?void 0:e.currentFloor)||void 0,i=n&&(null===(t=this.floorsViewData)||void 0===t?void 0:t.getViewData(n.id));this.setState({currentFloor:i})},this.onFloorsChanged=()=>{var e,t;const n=(null===(e=this.floorsViewData)||void 0===e?void 0:e.getNavigableFloorIds()).map(null===(t=this.floorsViewData)||void 0===t?void 0:t.getViewData);this.setState({floors:n})},this.state={currentFloorIndicator:!0,floors:[]}}onSettingsChanged(){const{settings:e}=this.context,t=e.tryGetProperty(S.u_,!0);this.setState({currentFloorIndicator:t})}componentDidMount(){const{settings:e,market:t}=this.context;e&&(this.bindings.push(e.onPropertyChanged(S.u_,(()=>this.onSettingsChanged()))),this.onSettingsChanged()),t&&t.waitForData(c.c).then((e=>{this.isUnmounting||(this.floorsViewData=e,this.bindings.push(this.floorsViewData.makeFloorChangeSubscription(this.onCurrentFloorChanged),this.floorsViewData.floors.onNameChange(this.onFloorsChanged),this.floorsViewData.onNavigableFloorIdsChanged(this.onFloorsChanged)),this.onCurrentFloorChanged(),this.onFloorsChanged())}))}componentWillUnmount(){this.isUnmounting=!0,this.bindings.forEach((e=>{e.cancel()}))}render(){const{className:e,viewmode:t,iconStyle:n}=this.props,{currentFloor:s,currentFloorIndicator:r,floors:l}=this.state;if(!(l.length>1&&t!==a.BD.OUTSIDE))return null;const c=t!==a.BD.INSIDE;return(0,i.jsxs)("div",Object.assign({className:o()("floor-selector",e)},{children:[n&&(0,i.jsx)(FloorIconSelector,{floors:l,currentFloor:s,handleClickFloor:this.handleClickFloor,shouldShowAll:c,currentFloorIndicator:r}),!n&&(0,i.jsx)("span",{className:"divider"}),!n&&(0,i.jsx)(y.O,{})]}))}}FloorControls.contextType=l.I},56767:(e,t,n)=>{"use strict";n.d(t,{O:()=>S});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(10854),c=n(22878),d=n(34506),u=n(36032),h=n(18814);function p(e){return e?e.getNavigableFloorIds().map(e.getViewData):[]}var m=n(60217),f=n(20302),g=n(37363);const v=(0,f.u)(g.O);var y=n(80592),b=n(41345);function S(e){const t=function(){const e=(0,h.I)(),[t,n]=(0,s.useState)(p(e));return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=()=>n(p(e)),i=new u.V(e.floors.onNameChange(t),e.onNavigableFloorIdsChanged(t));return t(),()=>i.cancel()}),[e]),t}(),n=function(){const e=v(),[t,n]=(0,s.useState)(null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.currentModeObservable.onChanged(n);return n(e.currentMode),()=>t.cancel()}),[e]),t}(),r=(0,m.m)(),f=(0,s.useContext)(a.I),{analytics:g}=f,S=(0,b.b)(),E=(0,s.useCallback)((e=>{(0,y.j)(e||null,f),g.trackGuiEvent("floor_clicked")}),[f]),T=t.map((e=>({text:e.name,value:e.id,selected:(null==r?void 0:r.id)===e.id}))).reverse();n!==c.Ey.Panorama&&T.unshift({text:S.t(l.Z.FLOOR_ALL),value:"",selected:!r});const w=o()("floor-menu-selector",e.className);return(0,i.jsx)(d.S,{menuStyle:d.K.DROPDOWN,onChange:E,options:T,className:w})}},80592:(e,t,n)=>{"use strict";n.d(t,{j:()=>a});var i=n(5477),s=n(61116),r=n(37632);const o=new i.Z("floor-controls-switch-floor");async function a(e,t){const{analytics:n,commandBinder:i}=t;try{await i.issueCommand(new s.vy);const t=null===e?"click_toggle_all_floors_button":"click_floor_select_button";n.trackGuiEvent(t);const o=new r.Vw(e);await i.issueCommand(o)}catch(e){o.debug(e)}}},89049:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var i=n(85893),s=n(67294),r=n(57340),o=n(10854),a=n(60405),l=n(36616),c=n(71843),d=n(17116),u=n(68077),h=n(41345),p=n(16534),m=n(13847);var f=n(89992);const g=()=>{const e=(0,h.b)(),t=!(0,u.y)(p.sX,!1),n=(()=>{const e=(0,m.n)(),t=(0,u.y)(p.r4,"");return t&&(null==e?void 0:e.hasDiscoverUrl())?`${t}${e.model.sid}`:null})(),s=e.t(o.Z.ALT_MATTERPORT_LOGO),r=(0,i.jsx)("img",{className:"footer-logo",alt:s,src:f});return t?(0,i.jsx)("a",Object.assign({className:"link logo-link",href:n||"https://matterport.com",target:"_blank"},{children:r})):r};var v=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const y="gui";let b=class Footer extends s.Component{constructor(e){super(e),this.handleTermsClick=()=>{const e=this.props.openModal===l.P.TERMS;this.context.commandBinder.issueCommand(new c.Bz(l.P.TERMS,!e)),this.context.analytics.trackGuiEvent("click_terms_button",{interactionSource:y})},this.handleHelpClick=()=>{const e=this.props.openModal===l.P.HELP;this.context.commandBinder.issueCommand(new c.Bz(l.P.HELP,!e)),this.context.analytics.trackGuiEvent("click_help_button",{interactionSource:y})},this.handleFeedbackClick=()=>{const{analytics:e,commandBinder:t}=this.context;t.issueCommand(new d.m),e.trackGuiEvent("click_feedback_button",{interactionSource:y})}}render(){const{isWorkshop:e=!1,modelRatingEnabled:t}=this.props;return e&&!t?null:(0,i.jsxs)("div",Object.assign({id:"footer"},{children:[t&&(0,i.jsx)("span",Object.assign({onClick:this.handleFeedbackClick,className:"link model-feedback-link",role:"link"},{children:this.context.locale.t(o.Z.FEEDBACK)})),!e&&t&&(0,i.jsx)("span",{children:" | "}),!e&&(0,i.jsx)("span",Object.assign({onClick:this.handleHelpClick,className:"link",role:"link"},{children:this.context.locale.t(o.Z.HELP)})),!e&&(0,i.jsx)("span",{children:" | "}),!e&&(0,i.jsx)("span",Object.assign({onClick:this.handleTermsClick,className:"link",role:"link"},{children:this.context.locale.t(o.Z.TERMS)})),!e&&(0,i.jsx)(g,{})]}))}};b.contextType=a.I,b=v([r.Z],b);const S=b},65313:(e,t,n)=>{"use strict";n.d(t,{Z:()=>FullscreenControls});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(2252),l=n(10854),c=n(60405),d=n(78576),u=n(87982);class FullscreenControls extends s.Component{constructor(e){super(e),this.handleButtonClick=()=>{const{analytics:e}=this.context;a.rm()?(e.trackGuiEvent("click_exit_fullscreen",{interactionSource:"gui"}),a.Qg()):(e.trackGuiEvent("click_enter_fullscreen",{interactionSource:"gui"}),a.Zx(document.body))},this.onFullScreenChange=e=>{const{mainDiv:t}=this.context,n=a.rm();n?t.classList.add("full-screen"):t.classList.remove("full-screen"),this.setState({fullscreen:n})},this.state={fullscreen:a.rm()},document.addEventListener("fullscreenchange",this.onFullScreenChange),document.addEventListener("webkitfullscreenchange",this.onFullScreenChange),document.addEventListener("MSFullscreenChange",this.onFullScreenChange),document.addEventListener("mozfullscreenchange",this.onFullScreenChange)}componentWillUnmount(){document.removeEventListener("fullscreenchange",this.onFullScreenChange),document.removeEventListener("webkitfullscreenchange",this.onFullScreenChange),document.removeEventListener("MSFullscreenChange",this.onFullScreenChange),document.removeEventListener("mozfullscreenchange",this.onFullScreenChange)}render(){const e=a.Jm(),{fullscreen:t}=this.state,n=t?this.context.locale.t(l.Z.EXIT_FULLSCREEN):this.context.locale.t(l.Z.VIEW_FULLSCREEN);return(0,i.jsx)("div",Object.assign({className:"fullscreen-mode"},{children:(0,i.jsx)(u.hU,Object.assign({onClick:this.handleButtonClick,ariaLabel:n},{children:(0,i.jsx)(d.oO,Object.assign({content:n,position:d.lZ.UP_LEFT,tooltipTimeout:e?1e3:void 0},{children:(0,i.jsx)("span",{className:o()("icon",t?"icon-fullscreen-exit":"icon-fullscreen")})}))}))}))}}FullscreenControls.contextType=c.I},28439:(e,t,n)=>{"use strict";n.d(t,{_:()=>ReelScrollContainer});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(45590),l=n(44450),c=n(43368),d=n(41920);class ReelScrollContainer extends s.Component{constructor(e){super(e),this.scrollbarRef=(0,s.createRef)(),this.elementRef=(0,s.createRef)(),this.onWindowResize=()=>{const e=(0,a.w)(window);this.state.hideScrollbar!==e&&this.setState({hideScrollbar:e})},this.onScrollableChanged=e=>{this.setState({scrollable:e})},this.onScrollPositionChange=e=>{this.setState({scrollPosition:e})},this.getScrollableContainer=()=>{const e=this.scrollbarRef.current;return(null==e?void 0:e.getScrollableContainer())||void 0},this.handleHighlightClickable=()=>{this.props.highlightClickable(!0)},this.state={scrollLeft:0,hideScrollbar:(0,a.w)(window),scrollPosition:d.Ij.None,scrollable:!1},this.resizeSubscription=(0,l.kp)(l.g_.RESIZE,this.onWindowResize)}componentDidMount(){this.resizeSubscription.renew(),this.onScrollableChanged(!0),this.onScrollPositionChange(d.Ij.Beginning)}componentWillUnmount(){this.resizeSubscription.cancel()}componentDidUpdate(e){const{activeElement:t}=this.props;if(null!==t&&e.activeElement!==t){const e=this.scrollbarRef.current;e&&e.scrollToElement(t)}}setSorting(e){const t=this.elementRef.current;if(t)if(e){if(t.classList.add("sorting"),this.props.mobile){const e=this.scrollbarRef.current;e&&e.pauseScrollHandling()}}else t.classList.remove("sorting")}render(){const{thumbScrollingOnly:e,children:t,totalSteps:n}=this.props,{hideScrollbar:s,scrollPosition:r,scrollable:a}=this.state,l=o()({scrollable:a,[r]:!0});return(0,i.jsx)("div",Object.assign({id:"reel",className:l,ref:this.elementRef},{children:(0,i.jsx)(c.Z,Object.assign({direction:d.Nm.horizontal,ref:this.scrollbarRef,hideScrollbar:s,thumbScrollingOnly:e,waitToUpdate:0===n,handleClick:this.handleHighlightClickable,onScrollableChanged:this.onScrollableChanged,onScrollPositionChange:this.onScrollPositionChange},{children:t}))}))}}},79512:(e,t,n)=>{"use strict";n.d(t,{y:()=>Highlight});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(14832),c=n(84347),d=n(22878),u=n(78576),h=n(10854);const{HLR:p}=h.Z.WORKSHOP;class Highlight extends s.Component{constructor(e){super(e),this.isUnmounting=!1,this.editHighlight=e=>{e.stopPropagation(),this.props.onClickHighlight(this.props.index,!0)},this.removeHighlight=e=>{e.stopPropagation(),this.props.onRemoveHighlight&&this.props.onRemoveHighlight(this.props.highlight.snapshot.sid)},this.onClickHighlight=e=>{e.preventDefault(),this.props.onClickHighlight(this.props.index,!1)},this.setContainerRef=e=>{const{index:t,getRef:n}=this.props;this.element=e,n&&n(t,this.element)},this.state={thumbnailUrl:""}}componentDidMount(){this.loadThumbnail()}componentWillUnmount(){this.isUnmounting=!0}async loadThumbnail(){const{snapshot:e}=this.props.highlight,t=await e.thumbnailUrl.get();this.isUnmounting||this.setState({thumbnailUrl:t})}renderTransitionSettings(){const{locale:e}=this.context,{transitionType:t,panDirection:n,transitionCondition:s}=this.props;let r="pan-auto";n===c.kw.Left?r="icon icon-rotate-left":n===c.kw.Right&&(r="icon icon-rotate-right");let o="";return t===l.n.FadeToBlack?o=e.t(p.TRANSITION_SETTING_SLIDESHOW):t===l.n.Interpolate&&(o=e.t(p.TRANSITION_SETTING_WALKTHROUGH)),(0,i.jsxs)("div",Object.assign({className:"transition-settings"},{children:[(0,i.jsxs)("span",Object.assign({className:"transition-type"},{children:[o,s&&(0,i.jsx)("span",{children:"*"})]})),(0,i.jsx)("span",{className:`pan-icon ${r}`})]}))}renderImageBar(){var e;const{locale:t}=this.context,{highlight:n,editable:s}=this.props,r=n.snapshot.is360,a=n.snapshot.metadata.cameraMode,l=null!==(e=this.getMarker(a,r))&&void 0!==e?e:"",c=t.t(p.REMOVE_HIGHLIGHT_TOOLTIP_MESSAGE),d=t.t(p.EDIT_HIGHLIGHT_TOOLTIP_MESSAGE);return(0,i.jsxs)("div",Object.assign({className:"image-bar"},{children:[(0,i.jsx)("span",{className:o()("highlight-marker",{[l]:!s})}),s&&(0,i.jsx)(u.oO,Object.assign({className:"highlight-remove",content:c,position:u.lZ.DOWN_RIGHT},{children:(0,i.jsx)("span",{className:o()("icon-delete"),"aria-label":c,"aria-labelledby":"",onClick:this.removeHighlight})})),s&&(0,i.jsx)(u.oO,Object.assign({className:"highlight-edit",content:d,position:u.lZ.DOWN_LEFT},{children:(0,i.jsx)("span",{className:o()("icon-toggle-pencil"),"aria-label":d,onClick:this.editHighlight})}))]}))}getMarker(e,t){return e===d.Ey.Dollhouse||e===d.Ey.Floorplan?null:t?"icon-360":"icon-panorama"}render(){const{thumbnailUrl:e}=this.state,{highlight:t,active:n,editable:s}=this.props,{name:r}=t.snapshot,a=!!r||s,l=e?{backgroundImage:`url('${e}')`}:{};return(0,i.jsxs)("div",Object.assign({className:o()("highlight-box",{active:n,editable:s}),onClick:this.onClickHighlight,ref:this.setContainerRef},{children:[(0,i.jsx)("div",{className:"highlight-image",style:l}),this.renderImageBar(),s&&this.renderTransitionSettings(),(0,i.jsx)("div",Object.assign({className:o()("image-name",{shadowed:a})},{children:(0,i.jsx)("span",Object.assign({className:"static-text",role:"listitem","aria-label":r||"highlight"},{children:r}))}))]}))}}Highlight.contextType=a.I},27861:(e,t,n)=>{"use strict";n.d(t,{V:()=>ModeControls});var i,s,r=n(85893),o=n(67294),a=n(60405),l=n(37363),c=n(56044),d=n(12622),u=n(94184),h=n.n(u),p=n(61116),m=n(10854),f=n(5477);!function(e){e.Inside="panorama",e.InsideMesh="mesh",e.Dollhouse="dollhouse",e.Floorplan="floorplan",e.None="none"}(i||(i={})),function(e){e.Inside="click_inside_mode_button",e.InsideMesh="click_mesh_mode_button",e.Dollhouse="click_dollhouse_mode_button",e.Floorplan="click_dollhouse_mode_button"}(s||(s={}));var g=n(2252),v=n(87982),y=n(61445),b=n(78576),S=n(22397);class ModeButton extends o.Component{constructor(e){super(e),this.onClick=()=>{const{buttonId:e,analyticsName:t}=this.props;this.props.onClick(e,t)}}static isTouchDevice(){return(0,g.Jm)()}get tooltip(){return this.context.locale.t(this.props.tooltipPhraseKey)}render(){const{disabled:e,decorative:t,active:n,buttonId:i,tooltipPos:s,nudgeProps:o}=this.props,a=n?y.BN.ACTIVE:e?y.BN.DISABLED:t?y.BN.DECORATIVE:y.BN.ENABLED,l=!ModeButton.isTouchDevice(),c=`icon-${i}`;return(0,r.jsxs)("div",Object.assign({className:`mode-${i}`},{children:[(0,r.jsx)(v.hU,Object.assign({onClick:this.onClick,iconClass:l?void 0:c,buttonState:a,ariaLabel:this.tooltip},{children:l&&(0,r.jsx)(b.oO,Object.assign({content:this.tooltip,position:s||b.lZ.UP},{children:(0,r.jsx)("span",{className:`icon ${c}`})}))})),o&&(0,r.jsx)(S.Z,{title:o.title,message:o.message,showTimeout:o.showTimeout,dismissTimeout:o.dismissTimeout,appSettingsKey:o.appSettingsKey,localStorageSettingsKey:o.localStorageSettingsKey,analyticsKeys:o.analyticsKeys,arrowPosition:o.arrowPosition})]}))}}ModeButton.contextType=a.I;var E=n(8428);const T=["dh",E.gx.Dollhouse],w=["fp",E.gx.FloorPlan];function x(e,t){if(t)return!1;const n=e.checkUrlParam("dh",0,1),i=!e.tryGetProperty(E.gx.Dollhouse,!1);return n||i}function _(e,t){if(t)return!1;const n=e.checkUrlParam("fp",0,1),i=!e.tryGetProperty(E.gx.FloorPlan,!1);return n||i}function M(e,t){return!t&&!e}function O(e,t,n){const s=e===t;switch(e){case i.Dollhouse:case i.Floorplan:return n||!s;case i.Inside:return n?t!==i.InsideMesh:!s;case i.InsideMesh:return n?s:t===i.Inside}return!1}var A=n(17423),C=n(39468),N=n(56759);const D=new f.Z("mode-buttons");class ModeButtons extends o.Component{constructor(e){super(e),this.onClick=async(e,t)=>{const{transitioning:n}=this.props;if(n)return;const s=function(e){switch(e){case i.Dollhouse:return d.BD.DOLLHOUSE;case i.Floorplan:return d.BD.FLOORPLAN;case i.Inside:return d.BD.INSIDE;case i.InsideMesh:return d.BD.MESH;default:throw new Error(`cannot get viewmode for mode buttonId ${e}`)}}(e),{analytics:r,commandBinder:o}=this.context;r.trackGuiEvent(t);try{await o.issueCommand(new p.vy),await o.issueCommand(new d._i(s))}catch(e){D.warn(e)}}}render(){const{activeButtonId:e,activeStateDisplay:t,className:n,dollhousePrevented:o,floorplanPrevented:a,insidePrevented:l,meshPrevented:c,transitioning:d,viewmodeChangeEnabled:u}=this.props,p=t?b.lZ.DOWN:b.lZ.UP,f=t?N.x.TOP_CENTER:N.x.BOTTOM_LEFT,g=!u,v=d,y=!c&&O(i.InsideMesh,e,!!t),S=!l&&O(i.Inside,e,!!t),E=!o&&O(i.Dollhouse,e,!!t),T=!a&&O(i.Floorplan,e,!!t);return(0,r.jsxs)("div",Object.assign({className:h()("mode-buttons",n)},{children:[y&&(0,r.jsx)(ModeButton,{tooltipPhraseKey:m.Z.VIEW_INSIDE_MESH,tooltipPos:p,analyticsName:s.InsideMesh,buttonId:i.InsideMesh,active:e===i.InsideMesh,onClick:this.onClick,disabled:g,decorative:v}),S&&(0,r.jsx)(ModeButton,{tooltipPhraseKey:m.Z.VIEW_INSIDE,tooltipPos:p,analyticsName:s.Inside,buttonId:i.Inside,active:e===i.Inside,onClick:this.onClick,disabled:g,decorative:v}),E&&(0,r.jsx)(ModeButton,{tooltipPhraseKey:m.Z.VIEW_DOLLHOUSE,tooltipPos:p,analyticsName:s.Dollhouse,buttonId:i.Dollhouse,active:e===i.Dollhouse,onClick:this.onClick,disabled:g,decorative:v,nudgeProps:{title:m.Z.DOLLHOUSE_NUDGE_TITLE,message:m.Z.DOLLHOUSE_NUDGE_MESSAGE,showTimeout:5e3,dismissTimeout:1e4,appSettingsKey:C.I,localStorageSettingsKey:A.F.DollhouseUserNudgeSeen,analyticsKeys:{tool:"view_mode",guiAction:"dollhouse_nudge"},arrowPosition:f}}),T&&(0,r.jsx)(ModeButton,{tooltipPhraseKey:m.Z.VIEW_FLOORPLAN,tooltipPos:p,analyticsName:s.Floorplan,buttonId:i.Floorplan,active:e===i.Floorplan,onClick:this.onClick,disabled:g,decorative:v})]}))}}ModeButtons.contextType=a.I;class ModeControls extends o.Component{constructor(e){super(e),this.bindings=[],this.isUnmounting=!1,this.updateDollhouseState=()=>{const{editMode:e,settings:t}=this.context;this.setState({dollhousePrevented:x(t,e)})},this.updateFloorplanState=()=>{const{editMode:e,settings:t}=this.context;this.setState({floorplanPrevented:_(t,e)})},this.onCurrentFloorChanged=()=>{const{editMode:e}=this.context,t=this.floorsViewData.currentFloor,n=this.floorsViewData.hasEnabledAlignedSweeps(t&&t.id);this.setState({insidePrevented:M(n,e)})},this.onViewmodeChangeLockUpdate=()=>{const{market:e}=this.context,t=e.tryGetData(l.O);if(!t)return;const n=t.viewmodeChangeEnabled;this.setState({viewmodeChangeEnabled:n})},this.state={dollhousePrevented:!1,floorplanPrevented:!1,insidePrevented:!1,viewmodeChangeEnabled:!0}}componentDidMount(){const{market:e,settings:t}=this.context;Promise.all([e.waitForData(l.O),e.waitForData(c.c)]).then((([e,n])=>{this.isUnmounting||(this.floorsViewData=n,this.bindings.push(e.onPropertyChanged("viewmodeChangeEnabled",this.onViewmodeChangeLockUpdate),n.makeFloorChangeSubscription(this.onCurrentFloorChanged)),T.forEach((e=>{this.bindings.push(t.onPropertyChanged(e,this.updateDollhouseState))})),w.forEach((e=>{this.bindings.push(t.onPropertyChanged(e,this.updateFloorplanState))})),this.onCurrentFloorChanged(),this.updateDollhouseState(),this.updateFloorplanState(),this.onViewmodeChangeLockUpdate())}))}componentWillUnmount(){this.isUnmounting=!0;for(const e of this.bindings)e.cancel();this.bindings=[]}render(){const{editMode:e}=this.context,{className:t,unaligned:n,viewmode:s,activeStateDisplay:o}=this.props,{viewmodeChangeEnabled:a,dollhousePrevented:l,floorplanPrevented:c,insidePrevented:u}=this.state,h=s===d.BD.TRANSITIONING;h||(this.activeButtonId=function(e,t){if(e)return i.None;switch(t){case d.BD.DOLLHOUSE:return i.Dollhouse;case d.BD.FLOORPLAN:return i.Floorplan;case d.BD.INSIDE:return i.Inside;case d.BD.MESH:return i.InsideMesh}return i.None}(n,s));const p=function(e){return!e}(e);return(0,r.jsx)(ModeButtons,{className:t,activeStateDisplay:o,activeButtonId:this.activeButtonId,transitioning:h,dollhousePrevented:l,floorplanPrevented:c,insidePrevented:u,meshPrevented:p,viewmodeChangeEnabled:a})}}ModeControls.contextType=a.I},11249:(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var i=n(85893),s=n(67294),r=n(60405),o=n(23676),a=n(61116),l=n(8259),c=n(94184),d=n.n(c),u=n(54119),h=n(15314),p=n(84586),m=n(65171),f=n(10854),g=n(5477);const{TOURS:v}=f.Z.SHOWCASE,y=new g.Z("story-tour-controls");function b(e){const{activeStep:t,currentStep:n,handlePlayPause:l,highlights:c,tourPlaying:g,toolPanelLayout:b}=e,[S,E]=(0,s.useState)(!1),[T,w]=(0,s.useState)(!1),{commandBinder:x,locale:_}=(0,s.useContext)(r.I),M=(0,s.useCallback)((()=>{E(!0)}),[]),O=(0,s.useCallback)((()=>{t===n&&E(!1)}),[t,n]);(0,h.U)(p.Vx,M),(0,h.U)(m.Z,O);const A=0===c.length,C=A||-1===(t>0?t-1:-1),N=t+1<c.length?t+1:-1,D=A||-1===N,I=b===o.wS.NARROW||b===o.wS.BOTTOM_PANEL,L=g?_.t(f.Z.PAUSE):_.t(f.Z.PLAY),P=A||!g?"play-unicode":"pause",R=c[t];let k=(null==R?void 0:R.snapshot.name)||"";S||(k=g||T?"":_.t(v.TOUR_BUTTON_LABEL));const U=(0,s.useCallback)((()=>{w(!0),l()}),[l]),B=(0,s.useCallback)((async e=>{if(!A){e.stopPropagation(),w(!0);try{g&&await x.issueCommand(new a.vy({willResume:!0})),await x.issueCommand(new a.HW(!0,!1)),g&&await x.issueCommand(new a.TH)}catch(e){y.debug(e)}}}),[A,g,x]),F=(0,s.useCallback)((async e=>{if(!A){e.stopPropagation(),w(!0);try{g&&await x.issueCommand(new a.vy({willResume:!0})),await x.issueCommand(new a.HW(!1,!1)),g&&await x.issueCommand(new a.TH)}catch(e){y.debug(e)}}}),[A,g,x]);return(0,i.jsxs)("div",Object.assign({className:"tour-story-controls"},{children:[(0,i.jsx)(u.zx,{icon:"dpad-left",className:"story-tour-previous-cta",variant:u.Wu.TERTIARY,size:u.qE.SMALL,disabled:C,ariaLabel:"prev",onClick:F}),(0,i.jsx)(u.zx,{className:"tour-story-play-pause",icon:P,variant:u.Wu.TERTIARY,size:u.qE.SMALL,disabled:A,ariaLabel:L,onClick:A?void 0:U}),(0,i.jsx)(u.zx,{icon:"dpad-right",className:"story-tour-next-cta",variant:u.Wu.TERTIARY,size:u.qE.SMALL,disabled:D,ariaLabel:"next",onClick:B}),k&&!I&&(0,i.jsx)("span",Object.assign({className:d()("tour-control-label",{active:g})},{children:k}))]}))}var S=n(2252),E=n(87982),T=n(61445),w=n(57340),x=n(78576),_=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let M=class HighlightButton extends s.Component{constructor(e){super(e),this.handleButtonClick=()=>{const e=this.props.reelOpen?"hide_":"show_";this.context.analytics.trackToolGuiEvent("hlr",e+"highlight_reel"),this.props.onToggleHLR(!this.props.reelOpen)}}render(){const{reelEnabled:e,reelOpen:t,activeTool:n,tourMode:s}=this.props,r=s===l.zz.STORIES;if(!e||r&&n!==o.w1.HLR)return null;const a=t?this.context.locale.t(f.Z.CLOSE_HIGHLIGHTS):this.context.locale.t(f.Z.OPEN_HIGHLIGHTS);return(0,i.jsx)(E.hU,Object.assign({className:"highlight-button",onClick:this.handleButtonClick,ariaLabel:a,"aria-expanded":t?"true":"false"},{children:(0,i.jsx)(x.oO,Object.assign({content:a,position:x.lZ.UP_RIGHT,tooltipTimeout:(0,S.Jm)()?1e3:void 0},{children:(0,i.jsx)("span",{className:"icon "+(t?"icon-dpad-down":"icon-dpad-up")})}))}))}};M.contextType=r.I,M=_([w.Z],M);var O=n(68077),A=n(8428),C=n(59187),N=n(49598);function D(){const e=(0,O.y)(A.gx.HighlightReel,!0),t=(0,O.y)(N.rU,N.iL);return e&&t!==N.Nu}(0,C.M)("reelEnabled",D);function I(){const e=(0,O.y)(A.gx.TourButtons,!0),t=(0,O.y)(N.RN,N.So);return e&&t!==N.Un}(0,C.M)("tourEnabled",I);function L(e){const{activeTool:t,handlePlayPause:n,highlights:o,onToggleHLR:a,reelOpen:c,hideReel:u,tourPlaying:h}=e,{locale:p,editMode:m}=(0,s.useContext)(r.I),g=D()&&!u||m,v=I()||m,y=(0,s.useRef)((0,S.Jm)());if(!g&&!v)return null;const b=0===o.length,w=b?T.BN.DISABLED:h?T.BN.ACTIVE:T.BN.ENABLED,_=h?p.t(f.Z.PAUSE):p.t(f.Z.PLAY);return(0,i.jsxs)("div",Object.assign({className:"highlight-tour-controls"},{children:[g&&(0,i.jsx)(M,{activeTool:t,reelOpen:c,reelEnabled:g,tourMode:l.zz.LEGACY,onToggleHLR:a}),v&&(0,i.jsx)(E.hU,Object.assign({buttonState:w,onClick:n,className:"tour-controls",ariaLabel:_},{children:b?(0,i.jsx)("span",{className:"icon icon-play"}):(0,i.jsx)(x.oO,Object.assign({content:_,position:x.lZ.UP,tooltipTimeout:y.current?1e3:void 0},{children:(0,i.jsx)("span",{className:d()({icon:!0,"icon-pause-outline":h,"icon-play":!h})})}))}))]}))}const P=(0,C.M)("tourStoriesFeatureEnabled",(function(){return(0,O.y)(N.lj,!1)})),R=new g.Z("tour-controls");class TourControlsComponent extends s.Component{constructor(){super(...arguments),this.handlePlayPause=async()=>{const{analytics:e,commandBinder:t}=this.context,{highlights:n,tourPlaying:i}=this.props;if(0===n.length)return;const s=i?"pause_highlights":"play_highlights";e.trackGuiEvent(s);try{i?await t.issueCommand(new a.vy):await t.issueCommand(new a.TH)}catch(e){R.debug(e)}}}render(){const{activeStep:e,activeTool:t,currentStep:n,highlights:s,onToggleHLR:r,hideReel:a,reelOpen:c,toolPanelLayout:d,tourMode:u,tourPlaying:h,tourStoriesFeatureEnabled:p}=this.props,{editMode:m}=this.context,f=d===o.wS.BOTTOM_PANEL||d===o.wS.NARROW,g=!!t&&t!==o.w1.HLR,v=0===s.length,y=u===l.zz.NONE;if(m){if(t===o.w1.MESH_TRIM)return null;if(f&&g)return null}else if(v||y||t)return null;const S=u===l.zz.STORIES||y&&p,E=u===l.zz.LEGACY||y&&!p;return S?(0,i.jsx)(b,{activeStep:e,currentStep:n,highlights:s,toolPanelLayout:d,tourPlaying:h,handlePlayPause:this.handlePlayPause}):E?(0,i.jsx)(L,{activeTool:t,handlePlayPause:this.handlePlayPause,highlights:s,onToggleHLR:r,reelOpen:c,hideReel:a,tourPlaying:h}):null}}TourControlsComponent.contextType=r.I;const k=P(TourControlsComponent)},1729:(e,t,n)=>{"use strict";n.d(t,{c:()=>d});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let d=class TourProgress extends s.Component{constructor(){super(...arguments),this.handleClick=()=>{this.context.analytics.trackToolGuiEvent("hlr","tour_progress");const{reelOpen:e,onToggleHLR:t}=this.props;!e&&t&&t(!0)}}getTourSteps(){const{totalSteps:e,activeStep:t}=this.props,n=[];for(let s=0;s<e;s++)n.push((0,i.jsx)("div",{className:o()({active:s===t})},s.toString()));return n}render(){const{reelOpen:e,tourPlaying:t,activeStep:n,totalSteps:s}=this.props,r=n+1+"/"+s,a=-1!==n&&!e&&r,l=-1!==n&&e&&t;return s>0?(0,i.jsxs)("div",Object.assign({id:"tour-progress",className:o()({"faded-in":t,"full-width":e}),onClick:this.handleClick,"data-balloon":a,"data-balloon-pos":"right","data-balloon-size":"xs"},{children:[l&&(0,i.jsx)("div",Object.assign({className:"progress-number"},{children:r})),-1!==n&&(0,i.jsx)("div",Object.assign({className:"progress-bar"},{children:this.getTourSteps()}))]})):null}};d.contextType=l.I,d=c([a.Z],d)},7583:(e,t,n)=>{"use strict";n.d(t,{M:()=>b});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(57340),c=n(60405),d=n(86823),u=n(87443),h=n(29605),p=n(61445),m=n(72187),f=n(10854),g=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{EMBED:v}=f.Z.WORKSHOP;var y;!function(e){e.NONE="none",e.INVALID_URL_SYNTAX="invalid",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(y||(y={}));let b=i=class MediaEmbedEditor extends r.Component{constructor(e){super(e),this.inputRef=(0,r.createRef)(),this.isUnmounting=!1,this.onInput=e=>{const t=(0,d.j)(e)?y.NONE:y.INVALID_URL_SYNTAX;this.setState({validationPhase:t,currentUrl:e})},this.onApply=()=>{this.isDisabled()||this.onDoneEditing(this.state.currentUrl)},this.stopPropagation=e=>{e.stopPropagation()},this.onDoneEditing=async e=>{const{onEmbed:t,url:n}=this.props,i=(0,m.V0)(e);if(i&&i!==n)try{const e=await this.loadMedia(i);if(this.isUnmounting)return;e?(this.setState({validationPhase:y.LOADED,error:void 0,currentUrl:i}),t(e)):this.onEmbedError(i)}catch(e){if(this.isUnmounting)return;this.onEmbedError(i,e)}},this.loadMedia=async e=>{const{parentId:t,parentType:n}=this.props;return this.setState({validationPhase:y.LOADING}),this.context.commandBinder.issueCommand(new u.wu(t,n,e))},this.state={currentUrl:e.url||"",validationPhase:y.NONE,error:void 0}}componentWillUnmount(){this.isUnmounting=!0,this.setState({currentUrl:"",validationPhase:y.NONE,error:void 0})}componentDidUpdate(e){const{url:t}=this.props;t!==e.url&&this.setState({currentUrl:t||"",validationPhase:y.NONE,error:void 0})}focus(){this.inputRef.current&&this.inputRef.current.focus()}onEmbedError(e,t){this.setState({error:t,validationPhase:y.ERROR,currentUrl:e})}isDisabled(){const{validationPhase:e,currentUrl:t}=this.state;return e===y.ERROR||e===y.LOADING||e===y.INVALID_URL_SYNTAX&&""!==t||""===t}renderError(){const{locale:e}=this.context,{error:t}=this.state;let n=e.t(v.ERROR_MESSAGE);return t instanceof m.HF?n=e.t(v.PROVIDER_NOT_SUPPORTED_MESSAGE):t instanceof m.t1&&(n=e.t(v.LINK_TYPE_NOT_SUPPORTED_MESSAGE)),(0,s.jsxs)("div",Object.assign({className:"popover-message popover-message-error"},{children:[n," ",(0,s.jsx)("a",Object.assign({className:"link",target:"_blank",rel:"noreferrer",href:i.supportPage},{children:e.t(v.HELP_CTA)}))]}))}renderHelpMessage(){const{locale:e}=this.context,{currentUrl:t,validationPhase:n}=this.state;switch(n){case y.ERROR:return this.renderError();case y.LOADING:return(0,s.jsx)("div",Object.assign({className:"popover-message"},{children:e.t(v.LOADING_MESSAGE)}));case y.INVALID_URL_SYNTAX:if(""!==t)return(0,s.jsx)("div",Object.assign({className:"popover-message popover-message-error"},{children:e.t(v.INVALID_URL_MESSAGE)}))}return(0,s.jsx)("div",Object.assign({className:"popover-message"},{children:(0,s.jsx)("a",Object.assign({className:"link",target:"_blank",href:i.supportPage},{children:e.t(v.SUPPORTED_FORMATS_MESSAGE)}))}))}render(){const{locale:e}=this.context,{className:t}=this.props,{currentUrl:n}=this.state,i=this.isDisabled()?p.BN.DISABLED:p.BN.ENABLED;return(0,s.jsxs)("div",Object.assign({className:"media-embed-editor",onClick:this.stopPropagation},{children:[(0,s.jsx)(h.Z,{ref:this.inputRef,text:n,type:"url",className:a()(t),placeholder:"Linked Video or GIF (eg. youtube.com)",onDone:this.onDoneEditing,onInput:this.onInput}),(0,s.jsxs)("div",Object.assign({className:"popover-footer"},{children:[this.renderHelpMessage(),(0,s.jsx)(p.zx,Object.assign({className:"button-inline embed-apply-btn",buttonStyle:p.ZJ.CLEAR,buttonSize:p.qE.SMALL,buttonState:i,onClick:this.onApply},{children:e.t(v.APPLY_CTA)}))]}))]}))}};b.contextType=c.I,b.supportPage="https://support.matterport.com/hc/en-us/articles/115006363868-Add-Multimedia-to-a-Mattertag-Post",b=i=g([l.Z],b)},77157:(e,t,n)=>{"use strict";n.d(t,{B:()=>b});var i=n(85893),s=n(67294),r=n(57340),o=n(60405),a=n(56759),l=n(61445),c=n(87982),d=n(93510),u=n(17423),h=n(89794),p=n(20680),m=n(59997),f=n(72329),g=n(78576),v=n(10854),y=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let b=class MeasurementSettings extends s.Component{constructor(e,t){super(e),this.propertiesToRefreshUi=[u.F.UnitType,u.F.MeasurementSnapping,u.F.MeasurementContinuousLines],this.close=()=>{this.setState({settingsOpen:!1})},this.updatePerSettings=()=>{this.setState({units:this.context.settings.tryGetProperty(u.F.UnitType,d.M.METRIC),snapping:this.context.settings.tryGetProperty(u.F.MeasurementSnapping,!1),continuousLines:this.context.settings.tryGetProperty(u.F.MeasurementContinuousLines,!1)})},this.toggleUnits=()=>{const e=this.state.units!==d.M.METRIC?d.M.METRIC:d.M.IMPERIAL;this.context.settings.setLocalStorageProperty(u.F.UnitType,e)},this.toggleSnapping=()=>{const e=this.state.snapping;this.context.settings.setLocalStorageProperty(u.F.MeasurementSnapping,!e)},this.toggleOpen=e=>{e.stopPropagation();const{onToggle:t}=this.props;t&&t(e,!this.state.settingsOpen),this.setState((e=>({settingsOpen:!e.settingsOpen})))},this.toggleContinuousLines=()=>{const e=this.state.continuousLines;this.context.settings.setLocalStorageProperty(u.F.MeasurementContinuousLines,!e)},this.locale={continuousLinesString:t.locale.t(v.Z.MEASUREMENT_CONTINUOUS_LINES),snappingString:t.locale.t(v.Z.MEASUREMENT_SNAPPING),unitsString:t.locale.t(v.Z.MEASUREMENT_UNITS),imperialString:t.locale.t(v.Z.MEASUREMENT_IMPERIAL),metricString:t.locale.t(v.Z.MEASUREMENT_METRIC),settingsString:t.locale.t(v.Z.MEASUREMENT_SETTINGS),closeString:t.locale.t(v.Z.CLOSE)},this.state={settingsOpen:!1,units:d.M.METRIC,snapping:!1,continuousLines:!1}}async componentDidMount(){for(const e of this.propertiesToRefreshUi)this.context.settings.onPropertyChanged(e,this.updatePerSettings);this.updatePerSettings()}componentWillUnmount(){for(const e of this.propertiesToRefreshUi)this.context.settings.removeOnPropertyChanged(e,this.updatePerSettings)}render(){const{iconButtonStyle:e}=this.props,{settingsOpen:t}=this.state,{settingsString:n}=this.locale,s=e||c.Dd.OVERLAY;return(0,i.jsx)(c.hU,Object.assign({className:"measurement-settings-btn",buttonStyle:s,iconClass:"icon-settings",buttonState:t?l.BN.ACTIVE:l.BN.ENABLED,onClick:this.toggleOpen,tooltipMsg:!t&&n||void 0,tooltipPosition:g.lZ.DOWN},{children:this.renderSettingsPopup()}))}renderSettingsPopup(){const{settingsOpen:e,units:t,snapping:n,continuousLines:s}=this.state,{continuousLinesString:r,snappingString:o,unitsString:l,imperialString:c,metricString:u}=this.locale,g=t===d.M.METRIC;return(0,i.jsxs)(h.J,Object.assign({className:"measurement-settings-popup",arrowPosition:a.x.TOP_RIGHT,open:e,close:this.close},{children:[(0,i.jsx)(p.w,Object.assign({label:o},{children:(0,i.jsx)(m.Z,{onToggle:this.toggleSnapping,enabled:!0,onOffLabel:!0,toggled:n})})),(0,i.jsx)(p.w,Object.assign({label:r},{children:(0,i.jsx)(m.Z,{onToggle:this.toggleContinuousLines,enabled:!0,onOffLabel:!0,toggled:s})})),(0,i.jsx)(p.w,Object.assign({label:l,className:"units-setting"},{children:(0,i.jsxs)("div",Object.assign({className:"radio-group radio-buttons"},{children:[(0,i.jsx)(f.E,Object.assign({name:"unit",value:d.M.IMPERIAL,id:"unit-imperial",enabled:!0,checked:!g,onChange:this.toggleUnits},{children:c})),(0,i.jsx)(f.E,Object.assign({name:"unit",value:d.M.METRIC,id:"unit-metric",enabled:!0,checked:g,onChange:this.toggleUnits},{children:u}))]}))}))]}))}};b.contextType=o.I,b=y([r.Z],b)},49767:(e,t,n)=>{"use strict";n.d(t,{u:()=>MeasurementsManager});var i=n(6058),s=n(73156),r=n(24486),o=n(65453),a=n(18253),l=n(14279),c=n(8483),d=n(2753),u=n(97082),h=n(4559),p=n(34e3),m=n(56044),f=n(57073),g=n(53549),v=n(37363);class MeasurementsManager{constructor(e,t){this.engine=e,this.initialized=!1,this.disabledAssets={[l.U]:!1,[r.s]:!1,[o.Nj]:!1,[a.re]:!1,[s.Mp]:!1},this.settingsToggler=new i.u(t,this.disabledAssets)}async activate(){if(!this.initialized){this.initialized=!0;const e=this.engine,[t,n,i,s]=await Promise.all([e.market.waitForData(f.X),e.market.waitForData(m.c),e.market.waitForData(g.Z),e.market.waitForData(v.O)]);this.dataMap={measurementModeData:t,floorsViewData:n,sweepData:i,viewmodeData:s}}this.settingsToggler.toggle(!0),await this.engine.commandBinder.issueCommandWhenBound(new c.O(!0,!0))}async deactivate(){this.settingsToggler.toggle(!1),this.dataMap.measurementModeData.setSelectedGroupIndex(-1),await this.engine.commandBinder.issueCommand(new c.O(!1))}in360view(){const e=this.dataMap.sweepData.currentSweep?this.dataMap.sweepData.currentSweep:"";return this.dataMap.viewmodeData.isInside()&&this.dataMap.sweepData.isSweepUnaligned(e)}getSelectedMeasurement(){return this.dataMap.measurementModeData.selectedGroupSid}renameMeasurement(e,t){return this.engine.commandBinder.issueCommand(new d.R(e,t))}setMeasurementVisibility(e,...t){return this.engine.commandBinder.issueCommand(new u.W(e,...t))}async batchDeleteMeasurement(e){return this.engine.commandBinder.issueCommand(new h.JM(...e)),!0}async deleteMeasurement(e){await this.engine.commandBinder.issueCommand(new h.JM(e))}async toggleSelected(e){await this.engine.commandBinder.issueCommand(new p.l(e))}}},49355:(e,t,n)=>{"use strict";n.d(t,{f:()=>R});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(64792),d=n(4559),u=n(63930),h=n(5947),p=n(93510),m=n(48558);var f=n(45923),g=n(56759),v=n(61445),y=n(87982),b=n(78576),S=n(17423),E=n(77157);const T={[c.au.CREATING]:!0,[c.au.CONFIRMING_POINT]:!0},w={[c.au.IDLE]:!0,[c.au.CREATING]:!0,[c.au.CREATING_NEXT_POINT]:!0},x=(c.au.CREATING,c.au.CONFIRMING_POINT,{[c.au.IDLE]:!0,[c.au.CREATING]:!0,[c.au.CREATING_NEXT_POINT]:!0});var _=n(34612),M=n(23676),O=n(36616),A=n(71843),C=n(10854);const N="measurement-mode-add-tooltip",D="measurement-mode-desktop-help",I="measurement-mode-mobile-help";var L,P=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let R=L=class MeasurementsOverlay extends s.Component{constructor(e,t){super(e),this.bindings=[],this.measurementSettingsRef=(0,s.createRef)(),this.propertiesToRefreshUi=[S.F.UnitType,S.F.MeasurementSnapping,S.F.MeasurementContinuousLines,N,D,I],this.isUnmounting=!1,this.onMeasurementModeDataChanged=()=>{const{measurementModeData:e}=this.props.manager.dataMap,t=e.selectedGroupInfo,n=e.phase,i=e.pressProgress>=.95?1:e.pressProgress;n===c.au.CLOSED?(this.closeMeasurementHelpModal(),this.dismissAddTooltip()):n===c.au.IDLE&&this.updateAddTooltipVisibility(),this.setState({phase:n,pressProgress:i,selectedGroup:t,pointPosition:e.pointPosition})},this.updatePerSettings=()=>{const e=this.context.settings;this.setState({units:e.tryGetProperty(S.F.UnitType,p.M.METRIC),snapping:e.tryGetProperty(S.F.MeasurementSnapping,!1),continuousLines:e.tryGetProperty(S.F.MeasurementContinuousLines,!1),addTooltipShown:e.tryGetProperty(N,!1),desktopHelpShown:e.tryGetProperty(D,!1),mobileHelpShown:e.tryGetProperty(I,!1)})},this.updateAddTooltipVisibility=()=>{this.state.addTooltipShown||this.context.editMode||this.isUnmounting||(this.setState({showAddTooltip:!0}),window.clearTimeout(this.startAddingTooltip),this.startAddingTooltip=window.setTimeout((()=>{this.dismissAddTooltip()}),L.START_ADDING_TOOLTIP_TIMEOUT))},this.dismissAddTooltip=()=>{this.isUnmounting||(this.setState({showAddTooltip:!1}),this.context.settings.setProperty(N,!0))},this.getOverlayComponents=()=>{const{mobile:e,openModal:t}=this.props,{mobileHelpShown:n,desktopHelpShown:s,phase:r}=this.state,{editMode:a}=this.context,l=t===O.P.MEASUREMENT_HELP,{closeString:d,helpString:u}=this.locale,h=a?"overlay-top-center":"overlay-bar",p=r!==c.au.IDLE&&r!==c.au.CLOSED,m=[(0,i.jsxs)("div",Object.assign({className:o()(h,{"active-phase":p})},{children:[!a&&(0,i.jsx)("div",{className:"overlay-bar-filler"}),(0,i.jsx)("div",Object.assign({className:"overlay-bar-center"},{children:this.renderOverlayInfo()})),!a&&(0,i.jsxs)("div",Object.assign({className:"overlay-bar-right"},{children:[(0,i.jsx)(y.hU,{className:"measurement-help-btn",buttonStyle:y.Dd.OVERLAY,iconClass:"icon-help",buttonState:l?v.BN.ACTIVE:v.BN.ENABLED,onClick:this.toggleHelpOpen,tooltipMsg:!l&&u||void 0,tooltipPosition:b.lZ.DOWN}),(0,i.jsx)(E.B,{ref:this.measurementSettingsRef,onToggle:this.settingsToggled}),(0,i.jsx)(y.hU,{iconClass:"icon-close",buttonStyle:y.Dd.OVERLAY,tooltipMsg:d,tooltipPosition:b.lZ.DOWN,onClick:this.onCloseMeasurementTool})]}))]}),"top-bar")];if(!s||!n){const t=e?this.getMobileHelp():this.getDesktopHelp();m.push(t)}return m},this.getMobileHelp=()=>{const{phase:e}=this.state,{pressHoldStart:t,pressHoldEnd:n,dragEdit:s}=this.locale.mobileHelp;let r,o;switch(e){case c.au.CREATING_NEXT_POINT:r=(0,i.jsx)("div",{className:"icon icon-drag-edit"}),o=(0,i.jsx)("span",Object.assign({className:"message"},{children:n}));break;case c.au.EDITING:case c.au.POINT_PLACED:r=(0,i.jsx)("div",{className:"icon icon-finger-drag"}),o=(0,i.jsx)("span",Object.assign({className:"message"},{children:s}));break;case c.au.CREATING:r=(0,i.jsx)("div",{className:"icon icon-press-hold"}),o=(0,i.jsx)("span",Object.assign({className:"message"},{children:t}))}return(0,i.jsxs)("div",Object.assign({className:"overlay-message"},{children:[r,o]}),"mobile-help")},this.getDesktopHelp=()=>{const{phase:e,selectedGroup:t}=this.state,{clickAnywhereString:s,escapeString:r}=this.locale.desktopHelp;let o,a;switch(e){case c.au.CREATING:o=(0,i.jsx)("div",{className:"icon icon-draw-lines"}),a=(0,i.jsx)("span",Object.assign({className:"message"},{children:s}));break;case c.au.CREATING_NEXT_POINT:t&&t.count>=3&&(o=(0,i.jsx)("div",Object.assign({className:"escape-key"},{children:(0,i.jsx)("img",{src:n(78899)})})),a=(0,i.jsx)("span",Object.assign({className:"message escape-message"},{children:r})))}return(0,i.jsxs)("div",Object.assign({className:"overlay-message"},{children:[o,a]}),"desktop-help")},this.clickCTAButton=e=>{const{phase:t}=this.state;t===c.au.IDLE?this.onStartPointPlacement(e):this.onStopPointPlacement(e)},this.onDeleteMeasurement=e=>{e&&e.stopPropagation(),this.context.commandBinder.issueCommand(new d.Ev)},this.onStartPointPlacement=e=>{e&&e.stopPropagation(),this.context.commandBinder.issueCommand(new u.c),this.dismissAddTooltip()},this.onStopPointPlacement=e=>{e&&e.stopPropagation(),this.context.commandBinder.issueCommand(new h.B)},this.onCloseMeasurementTool=async e=>{e&&e.stopPropagation(),this.closeMeasurementHelpModal(),await this.context.commandBinder.issueCommand(new _.tT(M.w1.MEASUREMENTS,!1));const t=this.measurementSettingsRef.current;t&&t.close(),this.dismissAddTooltip()},this.settingsToggled=(e,t)=>{e.stopPropagation(),t&&this.closeMeasurementHelpModal()},this.toggleHelpOpen=e=>{const{openModal:t}=this.props,n=t===O.P.MEASUREMENT_HELP;e.stopPropagation();const i=this.measurementSettingsRef.current;i&&i.close(),n||this.context.analytics.trackToolGuiEvent("measurements","measure_mode_help_clicked"),this.context.commandBinder.issueCommand(new A.Bz(O.P.MEASUREMENT_HELP,!n))},this.locale={startAddingString:t.locale.t(C.Z.MEASUREMENT_START_ADDING),continuousLinesString:t.locale.t(C.Z.MEASUREMENT_CONTINUOUS_LINES),snappingString:t.locale.t(C.Z.MEASUREMENT_SNAPPING),unitsString:t.locale.t(C.Z.MEASUREMENT_UNITS),imperialString:t.locale.t(C.Z.MEASUREMENT_IMPERIAL),metricString:t.locale.t(C.Z.MEASUREMENT_METRIC),desktopHelp:{clickAnywhereString:t.locale.t(C.Z.MEASUREMENT_HELP_CLICK_ANYWHERE),escapeString:t.locale.t(C.Z.MEASUREMENT_HELP_ESCAPE)},mobileHelp:{pressHoldStart:t.locale.t(C.Z.MEASUREMENT_HELP_PRESS_START),dragEdit:t.locale.t(C.Z.MEASUREMENT_HELP_DRAG_EDIT),pressHoldEnd:t.locale.t(C.Z.MEASUREMENT_HELP_PRESS_END)},helpString:t.locale.t(C.Z.HELP),closeString:t.locale.t(C.Z.CLOSE)},this.state={units:p.M.METRIC,snapping:!1,continuousLines:!1,phase:c.au.CLOSED,selectedGroup:null,pressProgress:0,pointPosition:null,showAddTooltip:!1,desktopHelpShown:!1,mobileHelpShown:!1,addTooltipShown:!1}}async componentDidMount(){const{measurementModeData:e}=this.props.manager.dataMap;this.bindings.push(e.onChanged(this.onMeasurementModeDataChanged),e.onDataChanged(this.onMeasurementModeDataChanged));for(const e of this.propertiesToRefreshUi)this.bindings.push(this.context.settings.onPropertyChanged(e,this.updatePerSettings));this.onMeasurementModeDataChanged(),this.updatePerSettings()}componentWillUnmount(){this.isUnmounting=!0;for(const e of this.bindings)e.cancel()}componentDidUpdate(){const{mobile:e}=this.props,{continuousLines:t,selectedGroup:n}=this.state;if(e)this.isCheckVisible()&&this.context.settings.setProperty(I,!0);else if(null!==n){const e=n.count;(t?e>3:2===e)&&this.context.settings.setProperty(D,!0)}}renderProgressCircle(){const{mobile:e}=this.props,{pressProgress:t,pointPosition:n,phase:s}=this.state;if(!e||null===n||t<=0||!T[s])return null;const r={left:n.x-L.pointButtonRadius/2+"px",top:n.y-L.pointButtonRadius/2+"px"};return(0,i.jsx)("div",Object.assign({className:"point-button-wrapper",style:r},{children:(0,i.jsx)(f.$,Object.assign({className:o()({complete:1===t,reset:0===t}),progress:100*t,innerRadius:L.pointButtonRadius,barWidth:L.pressProgressBarThickness},{children:(0,i.jsx)("circle",{className:"point",cx:"0",cy:"0",r:"22",transform:"rotate(-90)",fill:"#fff"})}))}))}renderOverlayInfo(){const{selectedGroup:e,units:t}=this.state;if(null===e)return null;const n=e.info.text?` ${e.info.text}`:"",s=`${((e,t)=>{if(t===p.M.METRIC)return`${e.toFixed(2)}m`;const{feet:n,inches:i}=(0,m.XJ)(e);return n>0?`${n}' ${i}"`:`${i}"`})(e.length,t)} ${n}`;return(0,i.jsx)("div",Object.assign({className:"overlay-info"},{children:s}))}render(){return(0,i.jsxs)("div",Object.assign({className:"overlay measurements-overlay"},{children:[this.getOverlayComponents(),this.renderProgressCircle(),this.renderOverlayCta()]}))}hasCancelCta(){if(this.isCheckVisible())return!1;const{phase:e,selectedGroup:t}=this.state,n=e===c.au.CREATING&&(!t||0===t.count),i=e===c.au.CREATING_NEXT_POINT&&!!t&&2===t.count;return n||i}isCheckVisible(){const{phase:e,continuousLines:t}=this.state;return this.isCompleteMeasurement()&&(t?e===c.au.CREATING_NEXT_POINT:e===c.au.CREATING)}isCompleteMeasurement(){const{continuousLines:e,selectedGroup:t}=this.state;if(null===t)return!1;const n=t.count;return e?n>2:2===n}renderOverlayCta(){const{startAddingString:e}=this.locale,{mobile:t,unaligned:n}=this.props,{phase:s,showAddTooltip:r,selectedGroup:a}=this.state,l=s===c.au.EDITING,d=a&&a.count>0&&(t?!!w[s]:!!x[s])?v.BN.ENABLED:v.BN.DISABLED,u=this.isCheckVisible()?"icon-checkmark":"icon-plus",h=n||l?v.BN.DISABLED:v.BN.ENABLED,p=o()("overlay-cta-btn",{"overlay-cta-cancel":this.hasCancelCta()});return(0,i.jsxs)("div",Object.assign({className:"overlay-cta"},{children:[(0,i.jsx)(g.u,{className:"tooltip-simple-medium",open:r,message:(0,i.jsx)("span",{children:e}),arrowPos:g.x.BOTTOM_CENTER}),(0,i.jsx)(y.hU,{className:p,iconClass:u,buttonStyle:y.Dd.PRIMARY,buttonState:h,onClick:this.clickCTAButton}),(0,i.jsx)(y.hU,{className:"overlay-cta-button-outer",buttonStyle:y.Dd.OVERLAY,iconClass:"icon-delete",buttonState:d,onClick:this.onDeleteMeasurement})]}))}closeMeasurementHelpModal(){const{openModal:e}=this.props;e===O.P.MEASUREMENT_HELP&&this.context.commandBinder.issueCommand(new A.Bz(e,!1))}};R.contextType=l.I,R.pointButtonRadius=132,R.pressProgressBarThickness=8,R.START_ADDING_TOOLTIP_TIMEOUT=5e3,R=L=P([a.Z],R)},97328:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(45923),c=n(70680),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let u=class LoadIndicator extends s.Component{constructor(e){super(e)}render(){const{showing:e}=this.props;return(0,i.jsx)(c.N,Object.assign({open:e,className:o()("load-indicator",{"fade-in":e,"fade-out":!e})},{children:(0,i.jsx)("div",Object.assign({className:"center-container"},{children:(0,i.jsx)(l.$,{progress:33,barWidth:4,progressColor:"#ffffff"})}))}))}};u=d([a.Z],u);const h=u},36616:(e,t,n)=>{"use strict";var i;n.d(t,{P:()=>i}),function(e){e.TERMS="terms",e.VR_SELECT="vrSelect",e.MATTERTAG_PHOTO="mattertag",e.HELP="help",e.CTA="cta",e.MEASUREMENT_HELP="measurementModeHelp",e.SHARE="share",e.ATTACHMENT="attachmentViewer",e.ADD_FROM_PHOTOS="add_from_photos",e.HIGHLIGHT_EDITOR="highlight_editor",e.REVERT_CHANGES="revert_unpublished_modal",e.TOUR_SETTINGS="hlr_settings",e.NOTES_INTRO="notes_intro",e.RATING_THANK_YOU="rating_thank_you",e.LINK_EDITOR="link_editor",e.MODEL_VIEW_EDITOR="model_view_editor"}(i||(i={}))},33441:(e,t,n)=>{"use strict";n.d(t,{L:()=>N});var i,s=n(85893),r=n(67294),o=n(57340),a=n(60405),l=n(31055),c=n(94184),d=n.n(c),u=n(10854),h=n(70329),p=n(41270),m=n(75060),f=n(88794),g=n(61445),v=n(17116);!function(e){e[e.Disappointed=0]="Disappointed",e[e.Unsatisfied=1]="Unsatisfied",e[e.Neutral=2]="Neutral",e[e.Satisfied=3]="Satisfied",e[e.Happy=4]="Happy"}(i||(i={}));const{MODEL_RATING:y}=u.Z.WORKSHOP,b={HAPPINESS:"happiness",QUALITY:"quality",NAVIGATION:"navigation",FEEDBACK:"feedback"},S=b.HAPPINESS,E={[b.HAPPINESS]:y.HAPPINESS_TITLE,[b.QUALITY]:y.QUALITY_ISSUES_TITLE,[b.NAVIGATION]:y.NAVIGATION_ISSUES_TITLE,[b.FEEDBACK]:y.FEEDBACK_TITLE},T={[b.HAPPINESS]:y.HAPPINESS_BODY},w={[b.QUALITY]:[{text:y.QUALITY_ISSUES_LIGHTING,value:"lighting"},{text:y.QUALITY_ISSUES_3D_MESH,value:"3d_mesh"},{text:y.QUALITY_ISSUES_COLORING,value:"coloring"},{text:y.QUALITY_ISSUES_IMAGE_QUALITY,value:"image_quality"}],[b.NAVIGATION]:[{text:y.NAVIGATION_ISSUES_BLOCKED_DOORWAYS,value:"blocked_doorways"},{text:y.NAVIGATION_ISSUES_OBSTRUCTIONS,value:"obstructions"},{text:y.NAVIGATION_ISSUES_MISALIGNED_SCANS,value:"misaligned_scans"},{text:y.NAVIGATION_ISSUES_FLOOR_SEPARATION,value:"floor_separation"},{text:y.NAVIGATION_ISSUES_DISAPPEARING_FLOORS,value:"disappearing_floors"}]},x=[{value:1,altText:u.Z.REUSABLES.EMOJI_ALT_DISAPPOINTED,icon:i.Disappointed},{value:2,altText:u.Z.REUSABLES.EMOJI_ALT_UNSATISFIED,icon:i.Unsatisfied},{value:3,altText:u.Z.REUSABLES.EMOJI_ALT_NEUTRAL,icon:i.Neutral},{value:4,altText:u.Z.REUSABLES.EMOJI_ALT_SATISFIED,icon:i.Satisfied},{value:5,altText:u.Z.REUSABLES.EMOJI_ALT_HAPPY,icon:i.Happy}];var _=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let M=class RatingIcon extends r.Component{render(){switch(this.props.icon){case i.Disappointed:return(0,s.jsxs)("svg",Object.assign({width:"29",height:"29",viewBox:"0 0 29 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.5 28C21.9557 28 28 21.9557 28 14.5C28 7.04503 21.9557 1 14.5 1C7.04506 1 1 7.04506 1 14.5C1 21.9557 7.04503 28 14.5 28ZM14.5 29C22.508 29 29 22.508 29 14.5C29 6.49278 22.508 0 14.5 0C6.49278 0 0 6.49278 0 14.5C0 22.508 6.49278 29 14.5 29Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M9.26389 16.1111C10.3761 16.1111 11.2778 14.8488 11.2778 13.2917C11.2778 11.7345 10.3761 10.4722 9.26389 10.4722C8.15165 10.4722 7.25 11.7345 7.25 13.2917C7.25 14.8488 8.15165 16.1111 9.26389 16.1111Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M19.7361 16.1111C20.8484 16.1111 21.75 14.8488 21.75 13.2917C21.75 11.7345 20.8484 10.4722 19.7361 10.4722C18.6239 10.4722 17.7222 11.7345 17.7222 13.2917C17.7222 14.8488 18.6239 16.1111 19.7361 16.1111Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M4.83253 9.66666C4.66497 9.66666 4.495 9.6143 4.35 9.50555C3.99394 9.23891 3.92225 8.73383 4.18889 8.37777C6.81661 4.87361 10.324 4.83333 10.4722 4.83333C10.9169 4.83333 11.2778 5.19422 11.2778 5.63888C11.2778 6.08274 10.9193 6.44283 10.4754 6.44444C10.3506 6.44605 7.60122 6.51372 5.47778 9.34444C5.31989 9.5555 5.07742 9.66666 4.83253 9.66666ZM24.1675 9.66666C23.9218 9.66666 23.6809 9.5555 23.5222 9.34444C21.3956 6.50808 18.6397 6.44605 18.5229 6.44444C18.0799 6.43961 17.7222 6.07711 17.7246 5.63486C17.7271 5.19099 18.0847 4.83333 18.5278 4.83333C18.676 4.83333 22.1826 4.87361 24.8111 8.37777C25.0786 8.73383 25.0061 9.23891 24.65 9.50555C24.505 9.6143 24.3358 9.66666 24.1675 9.66666V9.66666ZM18.9185 22.4581C18.9096 22.4226 17.9961 18.9306 14.5 18.9306C11.0039 18.9306 10.0904 22.4226 10.0815 22.4581C10.0388 22.6297 10.117 22.8053 10.2684 22.8963C10.4199 22.9865 10.6172 22.9656 10.7485 22.848C10.7558 22.8415 11.5646 22.1528 14.5 22.1528C17.3919 22.1528 18.2192 22.8214 18.2507 22.848C18.3272 22.9205 18.4271 22.9583 18.5278 22.9583C18.5954 22.9583 18.6639 22.9414 18.7259 22.9068C18.8838 22.8166 18.9628 22.6337 18.9185 22.4581V22.4581Z",fill:"#222222"})]}));case i.Unsatisfied:return(0,s.jsxs)("svg",Object.assign({width:"30",height:"29",viewBox:"0 0 30 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.125 28C22.5808 28 28.625 21.9558 28.625 14.5C28.625 7.04416 22.5808 1 15.125 1C7.66916 1 1.625 7.04416 1.625 14.5C1.625 21.9558 7.66916 28 15.125 28ZM29.625 14.5C29.625 22.5081 23.1331 29 15.125 29C7.11687 29 0.625 22.5081 0.625 14.5C0.625 6.49187 7.11687 0 15.125 0C23.1331 0 29.625 6.49187 29.625 14.5Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M21.1546 22.0553C21.1183 21.9111 20.2137 18.5278 15.125 18.5278C10.0355 18.5278 9.13167 21.9111 9.09542 22.0553C9.05111 22.2301 9.13006 22.4114 9.28633 22.5016C9.44342 22.591 9.63997 22.5644 9.76967 22.4395C9.78497 22.4242 11.3437 20.9444 15.125 20.9444C18.9063 20.9444 20.4658 22.4242 20.4803 22.4387C20.5577 22.5153 20.6608 22.5555 20.7639 22.5555C20.8316 22.5555 20.9 22.5386 20.9621 22.504C21.1199 22.4138 21.1989 22.2309 21.1546 22.0553Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M10.2917 13.6944C11.4039 13.6944 12.3055 12.4321 12.3055 10.875C12.3055 9.31787 11.4039 8.05556 10.2917 8.05556C9.17942 8.05556 8.27777 9.31787 8.27777 10.875C8.27777 12.4321 9.17942 13.6944 10.2917 13.6944Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M19.9583 13.6944C21.0706 13.6944 21.9722 12.4321 21.9722 10.875C21.9722 9.31787 21.0706 8.05556 19.9583 8.05556C18.8461 8.05556 17.9444 9.31787 17.9444 10.875C17.9444 12.4321 18.8461 13.6944 19.9583 13.6944Z",fill:"#222222"})]}));case i.Neutral:return(0,s.jsxs)("svg",Object.assign({width:"30",height:"29",viewBox:"0 0 30 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.75 28C22.2057 28 28.25 21.9557 28.25 14.5C28.25 7.04503 22.2057 1 14.75 1C7.29506 1 1.25 7.04506 1.25 14.5C1.25 21.9557 7.29503 28 14.75 28ZM14.75 29C22.758 29 29.25 22.508 29.25 14.5C29.25 6.49278 22.758 0 14.75 0C6.74278 0 0.25 6.49278 0.25 14.5C0.25 22.508 6.74278 29 14.75 29Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M9.51389 16.1111C10.6261 16.1111 11.5278 14.8488 11.5278 13.2917C11.5278 11.7345 10.6261 10.4722 9.51389 10.4722C8.40165 10.4722 7.5 11.7345 7.5 13.2917C7.5 14.8488 8.40165 16.1111 9.51389 16.1111Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M19.9861 16.1111C21.0984 16.1111 22 14.8488 22 13.2917C22 11.7345 21.0984 10.4722 19.9861 10.4722C18.8739 10.4722 17.9722 11.7345 17.9722 13.2917C17.9722 14.8488 18.8739 16.1111 19.9861 16.1111Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M20.3889 20.9444H9.11111C8.66645 20.9444 8.30556 20.5844 8.30556 20.1389C8.30556 19.6934 8.66645 19.3333 9.11111 19.3333H20.3889C20.8344 19.3333 21.1944 19.6934 21.1944 20.1389C21.1944 20.5844 20.8344 20.9444 20.3889 20.9444Z",fill:"#222222"})]}));case i.Satisfied:return(0,s.jsxs)("svg",Object.assign({width:"30",height:"29",viewBox:"0 0 30 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15.375 28C22.8308 28 28.875 21.9558 28.875 14.5C28.875 7.04416 22.8308 1 15.375 1C7.91916 1 1.875 7.04416 1.875 14.5C1.875 21.9558 7.91916 28 15.375 28ZM29.875 14.5C29.875 22.5081 23.3831 29 15.375 29C7.36687 29 0.875 22.5081 0.875 14.5C0.875 6.49187 7.36687 0 15.375 0C23.3831 0 29.875 6.49187 29.875 14.5Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M9.34541 19.028C9.38166 19.1722 10.2863 22.5555 15.375 22.5555C20.4645 22.5555 21.3683 19.1722 21.4046 19.028C21.4489 18.8532 21.3699 18.672 21.2137 18.5817C21.0566 18.4923 20.86 18.5189 20.7303 18.6438C20.715 18.6591 19.1563 20.1389 15.375 20.1389C11.5937 20.1389 10.0342 18.6591 10.0197 18.6446C9.94233 18.568 9.83922 18.5278 9.73611 18.5278C9.66844 18.5278 9.59997 18.5447 9.53794 18.5793C9.38005 18.6695 9.30111 18.8524 9.34541 19.028V19.028Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M10.5417 13.6944C11.6539 13.6944 12.5556 12.4321 12.5556 10.875C12.5556 9.31787 11.6539 8.05556 10.5417 8.05556C9.42943 8.05556 8.52778 9.31787 8.52778 10.875C8.52778 12.4321 9.42943 13.6944 10.5417 13.6944Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M20.2083 13.6944C21.3206 13.6944 22.2222 12.4321 22.2222 10.875C22.2222 9.31787 21.3206 8.05556 20.2083 8.05556C19.0961 8.05556 18.1944 9.31787 18.1944 10.875C18.1944 12.4321 19.0961 13.6944 20.2083 13.6944Z",fill:"#222222"})]}));case i.Happy:return(0,s.jsxs)("svg",Object.assign({width:"30",height:"29",viewBox:"0 0 30 29",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15 28C22.4558 28 28.5 21.9558 28.5 14.5C28.5 7.04416 22.4558 1 15 1C7.54416 1 1.5 7.04416 1.5 14.5C1.5 21.9558 7.54416 28 15 28ZM29.5 14.5C29.5 22.5081 23.0081 29 15 29C6.99187 29 0.5 22.5081 0.5 14.5C0.5 6.49187 6.99187 0 15 0C23.0081 0 29.5 6.49187 29.5 14.5Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M8.97042 19.028C9.00667 19.1722 9.9113 22.5555 15 22.5555C20.0895 22.5555 20.9933 19.1722 21.0296 19.028C21.0739 18.8532 20.9949 18.672 20.8387 18.5817C20.6816 18.4923 20.485 18.5189 20.3553 18.6438C20.34 18.6591 18.7813 20.1389 15 20.1389C11.2187 20.1389 9.65917 18.6591 9.64467 18.6446C9.56733 18.568 9.46422 18.5278 9.36111 18.5278C9.29344 18.5278 9.22497 18.5447 9.16294 18.5793C9.00505 18.6695 8.92611 18.8524 8.97042 19.028V19.028Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M15 17.6006C12.6107 17.6006 11.0246 17.3218 9.06388 16.9408C8.61519 16.8554 7.74438 16.9408 7.74438 18.2603C7.74438 20.8985 10.7757 24.1965 15 24.1965C19.2244 24.1965 22.2557 20.8985 22.2557 18.2603C22.2557 16.9408 21.3841 16.8546 20.9362 16.9408C18.9754 17.3218 17.3901 17.6006 15 17.6006Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M10.1667 13.6944C11.2789 13.6944 12.1806 12.4321 12.1806 10.875C12.1806 9.31787 11.2789 8.05556 10.1667 8.05556C9.05443 8.05556 8.15278 9.31787 8.15278 10.875C8.15278 12.4321 9.05443 13.6944 10.1667 13.6944Z",fill:"#222222"}),(0,s.jsx)("path",{d:"M19.8333 13.6944C20.9456 13.6944 21.8472 12.4321 21.8472 10.875C21.8472 9.31787 20.9456 8.05556 19.8333 8.05556C18.7211 8.05556 17.8194 9.31787 17.8194 10.875C17.8194 12.4321 18.7211 13.6944 19.8333 13.6944Z",fill:"#222222"})]}))}}};M=_([o.Z],M);const{MODEL_RATING:O}=u.Z.WORKSHOP,A=Object.values(b);class ModelRatingForm extends r.Component{constructor(e){super(e),this.submitCurrentRating=(e=!1)=>{const{currentQuestionId:t}=this.state;let n={};switch(t){case b.QUALITY:n={quality:this.state.quality};break;case b.NAVIGATION:n={navigation:this.state.navigation};break;case b.FEEDBACK:n={feedback:this.state.feedback},this.resetValues()}n&&this.context.commandBinder.issueCommand(new v.M(n,e))},this.resetValues=()=>{this.setState({happiness:void 0,quality:void 0,navigation:void 0,feedback:void 0})},this.hasPerfectHappinessRating=()=>5===this.state.happiness,this.handleButtonClick=()=>{const{currentQuestionId:e}=this.state;let t;switch(this.submitCurrentRating(e===b.FEEDBACK),e){case b.QUALITY:t=b.NAVIGATION;break;case b.NAVIGATION:t=b.FEEDBACK}t&&this.setState({currentQuestionId:t})},this.handleHappinessClick=(e,t)=>{this.context.commandBinder.issueCommand(new v.M({happiness:t.value})),5!==t.value?this.setState({happiness:t.value,currentQuestionId:b.QUALITY}):this.submitCurrentRating(!0)},this.handleCheckboxChange=(e,t,n)=>{const i=n.value,s={},r=(this.state[t]||[]).slice();r.includes(i)?r.splice(r.indexOf(i),1):r.push(i),s[t]=r,this.setState(s)},this.handleFeedbackChange=e=>{this.setState({feedback:e})},this.handleClose=()=>{this.context.commandBinder.issueCommand(new v.m(!1))},this.renderProgress=()=>{const{locale:e}=this.context,{currentQuestionId:t}=this.state;if(!t)return null;if(t===b.HAPPINESS||this.hasPerfectHappinessRating())return;const n=A.indexOf(t);return(0,s.jsx)("span",Object.assign({className:"model-rating-progress"},{children:e.t(O.PROGRESS,{"current-question-number":n,"max-question-number":A.length-1})}))},this.state={currentQuestionId:S}}componentWillUnmount(){this.submitCurrentRating(),this.context.commandBinder.issueCommand(new v.m(!1))}renderCurrentQuestion(){const{locale:e}=this.context,{currentQuestionId:t}=this.state;if(t===b.FEEDBACK)return(0,s.jsx)("div",Object.assign({className:"question-type text-entry"},{children:(0,s.jsx)(m.Z,{text:this.state.feedback||"",label:e.t(O.FEEDBACK_LABEL),onInput:this.handleFeedbackChange,onDone:this.handleFeedbackChange,maxLength:200,rows:3,focusOnMount:!0,scrollIntoViewOnMount:!0})}));if(t===b.HAPPINESS)return(0,s.jsx)("div",Object.assign({className:"question-type emoji-select"},{children:(0,s.jsx)(f.h,{children:x.map((e=>(0,s.jsx)(g.zx,Object.assign({buttonState:this.state.happiness===e.value?g.BN.ACTIVE:g.BN.ENABLED,buttonStyle:g.ZJ.PLAIN,buttonSize:g.qE.SMALL,onClick:this.handleHappinessClick,onClickArgs:[e]},{children:(0,s.jsx)(M,{icon:e.icon})}),e.value)))})}));if(t===b.QUALITY||t===b.NAVIGATION){const n=(t===b.QUALITY?this.state.quality:this.state.navigation)||[],i=w[t];return(0,s.jsx)("div",Object.assign({className:"question-type multi-select"},{children:i.map((i=>(0,s.jsx)(p.X,{enabled:!0,checkboxStyle:p.C.FILTER,onChange:this.handleCheckboxChange,onChangeArgs:[t,i],checked:n.includes(i.value),label:e.t(i.text)},i.text)))}))}return null}render(){const{locale:e}=this.context,{currentQuestionId:t}=this.state,n=t===S,i=E[t],r=T[t],o=t===b.FEEDBACK?O.SAVE:O.NEXT;return(0,s.jsxs)("div",Object.assign({className:d()("model-rating-dialog",{"in-progress":!n})},{children:[(0,s.jsx)(h.P,{onClose:this.handleClose,closeOnMouseDown:!0}),(0,s.jsxs)("div",Object.assign({className:"model-rating-form"},{children:[(0,s.jsxs)("div",Object.assign({className:"model-rating-question"},{children:[(0,s.jsx)("h3",Object.assign({className:"question-title"},{children:e.t(i)})),r&&(0,s.jsx)("p",Object.assign({className:"question-body"},{children:e.t(r)})),this.renderCurrentQuestion()]})),(0,s.jsxs)("footer",Object.assign({className:"model-rating-footer"},{children:[(0,s.jsx)("div",{children:t!==b.HAPPINESS&&(0,s.jsx)(g.zx,Object.assign({buttonStyle:g.ZJ.SECONDARY,buttonState:g.BN.ENABLED,onClick:this.handleButtonClick,onClickArgs:[t]},{children:e.t(o)}))}),this.renderProgress()]}))]}))]}))}}ModelRatingForm.contextType=a.I;var C=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let N=class ModelRatingDialog extends r.Component{constructor(e){super(e),this.isUnmounting=!1,this.bindings=[],this.handleDialogVisibilityChange=e=>{this.setState({isVisible:e})},this.state={initializing:!0,isVisible:!1}}componentDidMount(){const{market:e}=this.context.engine;e.waitForData(l.P).then((e=>{this.isUnmounting||(this.bindings.push(e.onDialogVisibleChanged(this.handleDialogVisibilityChange)),this.setState({initializing:!1}))}))}componentWillUnmount(){this.isUnmounting=!0,this.bindings.forEach((e=>e.cancel()))}render(){const{initializing:e,isVisible:t}=this.state;return t&&!e?(0,s.jsx)(ModelRatingForm,{}):null}};N.contextType=a.I,N=C([o.Z],N)},45845:(e,t,n)=>{"use strict";n.d(t,{B:()=>ModelRatingThankYou});var i=n(85893),s=n(67294),r=n(60405),o=n(71843),a=n(36616),l=n(10854),c=n(70329),d=n(94184),u=n.n(d);class Link extends s.Component{render(){const{className:e,href:t,children:n,onClick:s}=this.props;return(0,i.jsx)("a",Object.assign({className:u()("link",{className:e}),href:t,target:"_blank",onClick:s},{children:n}))}}var h=n(37145),p=n(80860);const{MODEL_RATING:m}=l.Z.WORKSHOP;class ModelRatingThankYou extends s.Component{constructor(){super(...arguments),this.onClose=()=>{this.context.commandBinder.issueCommand(new o.Bz(a.P.RATING_THANK_YOU,!1))},this.stopPropagation=e=>{e.stopPropagation()}}render(){const{locale:e}=this.context;return(0,i.jsxs)("dialog",Object.assign({className:"modal model-rating-thank-you open",onClick:this.stopPropagation,onPointerDown:this.stopPropagation,onPointerUp:this.stopPropagation},{children:[(0,i.jsx)(c.P,{onClose:this.onClose}),(0,i.jsx)("h4",{children:e.t(m.THANK_YOU_HEADING)}),(0,i.jsx)(h.ZP,{animation:p.F.HandsRaised}),(0,i.jsx)("p",Object.assign({className:"p4"},{children:e.t(m.THANK_YOU_BODY)})),(0,i.jsxs)("small",Object.assign({className:"model-rating-cta"},{children:[e.t(m.THANK_YOU_CTA)," ",(0,i.jsx)(Link,Object.assign({href:"//matterport.com/resources/support",onClick:this.onClose},{children:e.t(m.THANK_YOU_CTA_LINK_TEXT)}))]}))]}))}}ModelRatingThankYou.contextType=r.I},84152:(e,t,n)=>{"use strict";n.d(t,{v:()=>NotesIntro});var i=n(85893),s=n(67294),r=n(60405),o=n(71843),a=n(36616),l=n(17423),c=n(61445),d=n(70329),u=n(43873),h=n(10854);const{NOTES:p}=h.Z.SHOWCASE;class NotesIntro extends s.Component{constructor(){super(...arguments),this.onClose=()=>{this.context.commandBinder.issueCommand(new o.Bz(a.P.NOTES_INTRO,!1))},this.stopPropagation=e=>{e.stopPropagation()}}componentDidMount(){this.context.settings.setLocalStorageProperty(l.F.NotesIntroModalSeen,!0)}renderHeader(){return(0,i.jsxs)("div",Object.assign({className:"notes-intro-header"},{children:[(0,i.jsxs)("div",{children:["Welcome to the ",(0,i.jsx)("div",Object.assign({className:"h4"},{children:"Notes Beta"}))]}),(0,i.jsxs)("div",Object.assign({className:"note-badges"},{children:[(0,i.jsx)(u.C,{badgeStyle:{backgroundColor:"#E993A7"},iconClass:"icon-comment"}),(0,i.jsx)(u.C,{badgeStyle:{backgroundColor:"#6140B0"},iconClass:"icon-comment"}),(0,i.jsx)(u.C,{badgeStyle:{backgroundColor:"#385DFF"},iconClass:"icon-comment"})]}))]}))}render(){const{locale:e}=this.context;return(0,i.jsxs)("dialog",Object.assign({className:"modal full-modal notes-intro open",onClick:this.stopPropagation,onPointerDown:this.stopPropagation,onPointerUp:this.stopPropagation},{children:[(0,i.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,i.jsx)("div",Object.assign({className:"modal-title"},{children:e.t(p.MODAL_TITLE)})),(0,i.jsx)(d.P,{onClose:this.onClose})]})),this.renderHeader(),(0,i.jsx)("div",Object.assign({className:"modal-body"},{children:(0,i.jsx)("div",Object.assign({className:"modal-content"},{children:e.t(p.MODAL_COPY)}))})),(0,i.jsx)("div",Object.assign({className:"modal-footer"},{children:(0,i.jsx)("div",Object.assign({className:"modal-buttons"},{children:(0,i.jsx)(c.zx,Object.assign({buttonSize:c.qE.LARGE,onClick:this.onClose},{children:e.t(p.MODAL_CTA)}))}))}))]}))}}NotesIntro.contextType=r.I},38035:(e,t,n)=>{"use strict";n.d(t,{L:()=>NotesManager});var i=n(6058),s=n(24486),r=n(65453),o=n(14279),a=n(18253),l=n(4752),c=n(49315),d=n(40825),u=n(38562),h=n(69670),p=n(8765);class NotesManager{constructor(e,t){this.engine=e,this.initialized=!1,this.disabledAssets={[o.U]:!1,[r.Nj]:!1,[s.s]:!1,[a.re]:!1},this.settingsToggler=new i.u(t,this.disabledAssets),this.initPromise=this.init()}async init(){const e=this.engine.market;return Promise.all([e.waitForData(u.X),e.waitForData(h.c),e.waitForData(l.b),e.waitForData(c.A),e.waitForData(d.B)]).then((([e,t,n,i,s])=>(this.dataMap={notesViewData:e,hashtagData:t,attachmentsData:n,annotationsViewData:i,pinsViewData:s},!0)))}async activate(){this.initialized||(this.initialized=!0,await this.initPromise),this.settingsToggler.toggle(!0),await this.engine.commandBinder.issueCommand(new p.yK(!0))}async deactivate(){await this.engine.commandBinder.issueCommand(new p.yK(!1)),this.settingsToggler.toggle(!1)}getTextParser(){return this.dataMap.notesViewData.getTextParser()}getLinkHandler(){return this.dataMap.notesViewData.getLinkHandler()}}},17159:(e,t,n)=>{"use strict";n.d(t,{R:()=>D});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(2252),d=n(23676),u=n(17423),h=n(47357),p=n(13912),m=n(65143),f=n(8765),g=n(57756),v=n(73156),y=n(6165),b=n(56759),S=n(61445),E=n(87982),T=n(45923),w=n(78576),x=n(95361);const _=(0,n(59187).M)("openNoteView",(function(){const e=(0,x.Q)(),[t,n]=(0,s.useState)(e?e.openNoteView:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenNoteViewChanged(n);return n(e.openNoteView),()=>t.cancel()}),[e]),t}));var M,O=n(10854),A=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{NOTES:C}=O.Z.SHOWCASE;let N=M=class NotesOverlay extends s.Component{constructor(e){super(e),this.bindings=[],this.touchDevice=(0,c.Jm)(),this.showNudgeTimeout=0,this.dismissNudgeTimeout=0,this.isUnmounting=!1,this.updateNotesPhase=()=>{this.isUnmounting||this.setState({notesPhase:this.props.manager.dataMap.notesViewData.notesPhase})},this.updateActiveAnnotation=()=>{if(this.isUnmounting)return;const e=this.props.manager.dataMap.notesViewData.activeNotation;this.setState({activeNotation:e})},this.updateForPinChanges=()=>{if(this.isUnmounting)return;const e=this.props.manager.dataMap.pinsViewData;this.setState({pinEditorState:e.pinEditorState,creationProgress:e.progress,screenPosition:e.screenPosition,canPlace:e.canPlace,canAdd:e.canAdd})},this.showNudge=()=>{this.isUnmounting||(this.setState({showAddNudge:!0}),this.dismissNudgeTimeout=window.setTimeout(this.dismissNudge,M.DISMISS_NUDGE_TIMEOUT))},this.dismissNudge=()=>{this.isUnmounting||(this.context.settings.setLocalStorageProperty(u.F.NotesAddNudgeSeen,!0),this.setState({showAddNudge:!1}))},this.clickCTAButton=e=>{this.dismissNudge(),this.hasCancelCta()?(e.stopPropagation(),this.props.manager.dataMap.notesViewData.isNewNote&&this.context.commandBinder.issueCommand(new f.gc)):this.onStartAddingNote(e)},this.savePinAppearance=e=>{const{openNoteView:t}=this.props;t&&this.context.commandBinder.issueCommand(new f.oE(t.id,e))},this.onStartAddingNote=e=>{e.stopPropagation(),this.trackEvent("notes_overlay_click_add"),this.context.commandBinder.issueCommand(new f.VI)},this.deleteNote=()=>{const{openNoteView:e}=this.props;e&&(this.trackEvent("notes_overlay_click_delete"),this.context.commandBinder.issueCommand(new f.sG(e.id)))},this.closeEditor=()=>{this.context.commandBinder.issueCommand(new f.df(!1))},this.toggleColorPicker=e=>{e.stopPropagation();const{notesPhase:t}=this.state,n=t===g.U.EDITING;this.context.commandBinder.issueCommand(new f.df(!n)),this.setState({showAddNudge:!1})},this.state={showAddNudge:!1,notesPhase:g.U.CLOSED,pinEditorState:m.V8.IDLE,activeNotation:null,screenPosition:null,creationProgress:0,canPlace:!0,canAdd:!0}}componentDidMount(){const{notesViewData:e,pinsViewData:t}=this.props.manager.dataMap;this.bindings.push(e.onNotesPhaseChanged(this.updateNotesPhase),e.onActiveNotationChanged(this.updateActiveAnnotation),t.onChanged(this.updateForPinChanges)),this.setNudge(),this.updateNotesPhase(),this.updateForPinChanges(),this.updateActiveAnnotation()}componentDidUpdate(e){var t,n;(null===(t=e.openNoteView)||void 0===t?void 0:t.id)!==(null===(n=this.props.openNoteView)||void 0===n?void 0:n.id)&&this.dismissNudge()}componentWillUnmount(){this.isUnmounting=!0,window.clearTimeout(this.showNudgeTimeout),window.clearTimeout(this.dismissNudgeTimeout);for(const e of this.bindings)e.cancel()}setNudge(){this.context.settings.tryGetProperty(u.F.NotesAddNudgeSeen,!1)||this.showNudgeTimeout||(this.showNudgeTimeout=window.setTimeout(this.showNudge,M.SHOW_NUDGE_TIMEOUT))}trackEvent(e){this.context.analytics.trackToolGuiEvent("notes",e)}hasCancelCta(){const{pinEditorState:e}=this.state;return e===m.V8.CREATING||e===m.V8.PLACING}renderOverlayMessage(){const{pinEditorState:e,canPlace:t}=this.state;if(e===m.V8.CREATING||!this.touchDevice&&e===m.V8.PLACING||!t){const e=this.context.locale.t(this.touchDevice?C.OVERLAY_ADD_TOUCH:C.OVERLAY_ADD_CLICK),n=this.context.locale.t(this.touchDevice?C.OVERLAY_PLACE_TOUCH:C.OVERLAY_PLACE_CLICK),s=t?e:n;return(0,i.jsxs)("div",Object.assign({className:"overlay-message"},{children:[(0,i.jsx)("div",{className:"icon icon-notes"}),(0,i.jsx)("span",Object.assign({className:"message"},{children:s}))]}))}return null}renderProgressCircle(){const{creationProgress:e,screenPosition:t,pinEditorState:n}=this.state;if(!(n===m.V8.PRESSING&&e>0&&this.touchDevice)||!t)return null;const s={left:t.x-M.PROGRESS_RADIUS/2+"px",top:t.y-M.PROGRESS_RADIUS/2+"px"};return(0,i.jsx)("div",Object.assign({className:"point-button-wrapper",style:s},{children:(0,i.jsx)(T.$,Object.assign({progress:100*e,innerRadius:M.PROGRESS_RADIUS,barWidth:M.PROGRESS_WIDTH},{children:(0,i.jsx)("circle",{className:"point",cx:"0",cy:"0",r:"22",transform:"rotate(-90)",fill:"#fff"})}))}))}renderTopBar(e){const{notesPhase:t}=this.state,{openNoteView:n,toolPanelLayout:s,manager:r}=this.props,{notesViewData:o}=r.dataMap,a=s===d.wS.SIDE_PANEL,l=o.isNewNote;if(a||l)return this.renderOverlayMessage();if(n&&e){const e=t!==g.U.OPENING&&!!n,s=t===g.U.EDITING?S.BN.ACTIVE:e?S.BN.ENABLED:S.BN.DISABLED;return(0,i.jsx)("div",Object.assign({className:"overlay-bar overlay-top-right"},{children:(0,i.jsx)(E.hU,{iconClass:"icon-stem-height",buttonStyle:E.Dd.OVERLAY,buttonState:s,onClick:this.toggleColorPicker})}))}return null}renderCta(e){const{showAddNudge:t,canAdd:n}=this.state,s=this.hasCancelCta(),r=n?S.BN.ENABLED:S.BN.DISABLED,a=!n||t?void 0:this.context.locale.t(s?C.CANCEL_TOOLTIP:C.ADD_TOOLTIP);return(0,i.jsx)(E.hU,Object.assign({className:"overlay-cta-btn",buttonStyle:E.Dd.PRIMARY,buttonState:r,tooltipMsg:a,tooltipPosition:e,onClick:this.clickCTAButton},{children:(0,i.jsx)("div",Object.assign({className:o()("overlay-cta-rotate-btn",{"overlay-cta-cancel":s})},{children:(0,i.jsx)("span",{className:"icon icon-plus"})}))}))}renderActionBar(e){const{openNoteView:t}=this.props,{showAddNudge:n,notesPhase:s,activeNotation:r,pinEditorState:a}=this.state;if(s===g.U.CLOSED||r)return null;const{toolPanelLayout:l}=this.props,c=a===m.V8.CREATING||a===m.V8.PLACING,u=s===g.U.EDITING,h=s===g.U.OPENING,p=l===d.wS.SIDE_PANEL,f=this.context.locale.t(C.COLOR_STEM_TOOLTIP),v=this.context.locale.t(C.DELETE_TOOLTIP);if(p){const s=!c&&!h&&!!t,r=u?S.BN.ACTIVE:s?S.BN.ENABLED:S.BN.DISABLED;return(0,i.jsxs)("div",Object.assign({className:"overlay-cta"},{children:[e&&(0,i.jsx)(E.hU,{className:o()("overlay-cta-button-outer","overlay-cta-button-outer-left"),iconClass:"icon-stem-height",buttonStyle:E.Dd.OVERLAY,buttonState:r,tooltipMsg:f,tooltipPosition:w.lZ.DOWN,onClick:this.toggleColorPicker}),(0,i.jsx)(b.u,{className:"tooltip-simple-medium",open:n,message:(0,i.jsx)("span",{children:this.context.locale.t(C.ADD_CTA_TOOLTIP)}),arrowPos:b.x.BOTTOM_CENTER}),this.renderCta(w.lZ.DOWN),e&&(0,i.jsx)(E.hU,{className:"overlay-cta-button-outer",buttonStyle:E.Dd.OVERLAY,iconClass:"icon-delete",tooltipMsg:v,tooltipPosition:w.lZ.DOWN,buttonState:s?S.BN.ENABLED:S.BN.DISABLED,onClick:this.deleteNote})]}))}return(0,i.jsx)("div",Object.assign({className:"overlay-cta"},{children:this.renderCta(w.lZ.UP)}))}render(){const{toolPanelLayout:e,openModal:t,openNoteView:n}=this.props;if(t)return null;const{notesPhase:s}=this.state,{userData:r}=this.context,o=r.isCommenter(),a=!!n&&(0,p.C)(r,h.J.NOTE,n.user),l=s===g.U.EDITING,c=e===d.wS.SIDE_PANEL;return(0,i.jsxs)("div",Object.assign({className:"overlay"},{children:[this.renderTopBar(a),o&&this.renderActionBar(a),n&&c&&a&&(0,i.jsx)(y.q,{pin:n,id:n.id,pinType:m.Er.NOTE,onSave:this.savePinAppearance,onClose:this.closeEditor,open:l,colors:v.ZP.colors,toolPanelLayout:e}),this.renderProgressCircle()]}))}};N.contextType=l.I,N.PROGRESS_RADIUS=132,N.PROGRESS_WIDTH=8,N.SHOW_NUDGE_TIMEOUT=5e3,N.DISMISS_NUDGE_TIMEOUT=5e3,N=M=A([a.Z],N);const D=_(N)},34933:(e,t,n)=>{"use strict";n.d(t,{s:()=>et});var i=n(85893),s=n(67294),r=n(57340),o=n(60405),a=n(20585),l=n(65143),c=n(57183),d=n(57756),u=n(8765),h=n(23676),p=n(47357),m=n(13912),f=n(51073),g=n(73156),v=n(94184),y=n.n(v),b=n(81402),S=n(91754),E=n(34612),T=n(47931),w=n(87443),x=n(85553),_=n(22026),M=n(36589),O=n(33009),A=n(18236),C=n(50566),N=n(71843),D=n(36616),I=n(4752),L=n(10047),P=n(90636),R=n(61445),k=n(51663),U=n(84282),B=n(82068),F=n(87982),V=n(16881),H=n(4117);class OpenMediaEmbedPopupMessage extends H.v{}class CloseMediaEmbedPopupMessage extends H.v{}var j=n(70329),G=n(7583),z=n(10854),W=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{EMBED:K}=z.Z.WORKSHOP;let Y=class MediaEmbedPopup extends s.Component{constructor(e){super(e),this.popupRef=(0,s.createRef)(),this.embedRef=(0,s.createRef)(),this.open=()=>{this.popupRef.current&&this.popupRef.current.classList.add("open"),this.focus()},this.close=()=>{this.popupRef.current&&this.popupRef.current.classList.remove("open")},this.stopPropagation=e=>{e.stopPropagation()}}componentDidMount(){this.context.messageBus.subscribe(OpenMediaEmbedPopupMessage,this.open),this.context.messageBus.subscribe(CloseMediaEmbedPopupMessage,this.close)}componentWillUnmount(){this.close(),this.context.messageBus.unsubscribe(OpenMediaEmbedPopupMessage,this.open),this.context.messageBus.unsubscribe(CloseMediaEmbedPopupMessage,this.close)}focus(){this.embedRef.current&&this.embedRef.current.focus()}render(){const{locale:e}=this.context,{onCancel:t,onEmbed:n,parentId:s,parentType:r}=this.props;return(0,i.jsxs)("div",Object.assign({ref:this.popupRef,className:"annotation-popup",onClick:this.stopPropagation},{children:[(0,i.jsxs)("div",Object.assign({className:"popover-header"},{children:[(0,i.jsx)("div",Object.assign({className:"popover-label"},{children:e.t(K.MEDIA_LINK_LABEL)})),(0,i.jsx)(j.P,{buttonStyle:j.A.LIGHT,onClose:t})]})),(0,i.jsx)(G.M,{ref:this.embedRef,parentId:s,parentType:r,className:"text-field-dark",onEmbed:n})]}))}};Y.contextType=o.I,Y=W([r.Z],Y);n(79071),n(9706);var q=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{ANNOTATIONS:Z}=z.Z.SHOWCASE;let $=class Annotation extends s.Component{constructor(e){super(e),this.uploadTooltipTimeout=0,this.bindings=[],this.isUnmounting=!1,this.getAttachmentsState=()=>{if(!this.attachmentsData)return;const{active:e,parentId:t,parentType:n}=this.props;if(!e)return;return{pendingAttachments:this.attachmentsData.getPendingAttachmentsForAsset(t,n),removedAttachments:this.attachmentsData.getRemovedAttachmentsForAsset(t,n),failures:this.attachmentsData.failures.values,uploads:this.attachmentsData.uploads.values}},this.updateAttachments=()=>{const e=this.getAttachmentsState();e&&this.setState(e)},this.cancelEdits=()=>{this.props.onCancelEditing&&this.props.onCancelEditing()},this.saveEdits=()=>{this.onDoneEditing()},this.onDoneEditing=()=>{const{onDoneEditing:e}=this.props;if(e){const t=this.getMarkdown();e(t,""===t&&0===this.getAttachmentCount())}},this.onInput=e=>{this.setState({textChanged:e.trim()!==this.props.text})},this.openLinkEditor=()=>{!(this.props.openModal===D.P.LINK_EDITOR)&&this.textEditor&&(this.context.analytics.trackGuiEvent("annotation_open_link_editor"),this.textEditor.prepareLinkForEdit())},this.onClickBlock=(e,t)=>{const{active:n,annotationType:i,annotationId:s,linkHandler:r}=this.props,o=e.blockType;if(o===M.C.LINK&&n)this.setState({selectedBlock:e}),this.context.commandBinder.issueCommand(new N.Bz(D.P.LINK_EDITOR,!0));else if(!n){if(o===M.C.LINK&&r&&e.value){t&&t.preventDefault();const n=(0,O.V)(e.value),{url:o,modelId:a,pose:l}=n;a?r.handler.openLink({fullLink:o,modelId:a}):l?(r.handler.openLink({fullLink:o,pose:l}),this.context.commandBinder.issueCommand(new A.Aj(s,i))):r.handler.openLink(o)}this.context.messageBus.broadcast(new C.iP(i,s,e))}},this.closeLinkEditor=async()=>(this.setState({selectedBlock:null}),this.context.commandBinder.issueCommand(new N.Bz(D.P.LINK_EDITOR,!1))),this.onCancelLink=async()=>{await this.closeLinkEditor()},this.toggleEmbedEditor=()=>{this.setState((e=>{const t=!e.embedPopupOpen;return t?(this.context.analytics.trackGuiEvent("annotation_open_embed_editor"),this.context.messageBus.broadcast(new OpenMediaEmbedPopupMessage)):this.context.messageBus.broadcast(new CloseMediaEmbedPopupMessage),{embedPopupOpen:t}}))},this.closeEmbedEditor=()=>{this.state.embedPopupOpen&&this.toggleEmbedEditor()},this.onRemoveLink=()=>{this.onSaveLink("","")},this.onSaveLink=(e,t)=>{this.props.openModal===D.P.LINK_EDITOR&&this.textEditor&&(this.setState({textChanged:!0}),this.textEditor.saveLink(e,t),this.closeLinkEditor())},this.onClickFileInput=()=>{const{active:e,onClickToEdit:t}=this.props;this.isAtMaxAttachments()?(window.clearTimeout(this.uploadTooltipTimeout),this.setState({showUploadTooltip:!0}),this.uploadTooltipTimeout=window.setTimeout((()=>{this.setState({showUploadTooltip:!1})}),2500)):!e&&t&&t()},this.onFileUpload=e=>{const{parentId:t,parentType:n}=this.props,i=Array.from(e),s=this.getAttachmentCount();e.length+s>L.yk&&i.splice(L.yk-s),this.context.commandBinder.issueCommand(new w.It(t,n,i)),this.edit()},this.onDrop=e=>{this.context.analytics.trackGuiEvent("attachment_drag_and_dropped"),this.onFileUpload(e)},this.onFilesChosen=e=>{this.context.analytics.trackGuiEvent("annotation_files_chosen"),this.onFileUpload(e)},this.dropActivated=()=>{const{active:e,creating:t,onClickToEdit:n}=this.props;t&&!e&&n&&n()},this.setTextEditorRef=e=>this.textEditor=e,this.state={textChanged:!1,selectedBlock:null,showUploadTooltip:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[],embedPopupOpen:!1}}componentDidMount(){this.context.market.waitForData(I.b).then((e=>{this.attachmentsData=e,this.bindings.push(this.attachmentsData.onChanged(this.updateAttachments)),this.isUnmounting||this.updateAttachments()}))}componentWillUnmount(){this.isUnmounting=!0,window.clearTimeout(this.uploadTooltipTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){const{active:n,parentId:i,parentType:s}=this.props;e.active&&!n?this.setState({textChanged:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[],embedPopupOpen:!1}):i===e.parentId&&s===e.parentType||this.updateAttachments()}edit(){this.textEditor&&this.textEditor.toggleEditing(!0)}focus(){this.textEditor&&this.textEditor.focus()}getMarkdown(){let e;return e=this.textEditor?this.textEditor.getMarkdown():this.props.text,e.trim()}getAttachmentCount(){const{attachments:e}=this.props,{pendingAttachments:t,removedAttachments:n,uploads:i}=this.state;return e.length+t.length+i.length-n.length}isAtMaxAttachments(){return this.getAttachmentCount()>=L.yk}inEmptyState(){const{active:e,text:t}=this.props;return!e&&""===t.trim()&&0===this.getAttachmentCount()}renderButtonBar(){const{active:e,creating:t,parentId:n}=this.props;if(!e)return null;const{pendingAttachments:s,removedAttachments:r,textChanged:o,uploads:a,showUploadTooltip:l}=this.state,c=this.isAtMaxAttachments(),d=o||r.length>0||s.length>0,u=a.length>0,h=!c&&!u,p=d&&e&&!u?R.BN.ENABLED:R.BN.DISABLED,m=c?R.BN.DIMMED:u?R.BN.DISABLED:R.BN.ENABLED,f=this.context.locale.t(c?Z.MAX_ATTACHMENTS_TOOLTIP:Z.UPLOAD_TOOLTIP,L.yk),g=this.context.locale.t(c?Z.MAX_ATTACHMENTS_TOOLTIP:Z.EMBED_TOOLTIP,L.yk),v=this.context.locale.t(t?Z.ADD_CTA:Z.SAVE_CTA),y=this.context.locale.t(Z.LINK_TOOLTIP),b=this.context.locale.t(Z.CANCEL_CTA);return(0,i.jsxs)("div",Object.assign({className:"annotation-button-bar"},{children:[(0,i.jsxs)("div",Object.assign({className:"annotation-editors"},{children:[(0,i.jsx)(U.p,Object.assign({id:`${n}-annotation`,multi:!0,enabled:h,onUpload:this.onFilesChosen},{children:(0,i.jsx)(F.hU,{iconClass:"icon-attach",buttonStyle:F.Dd.PLAIN,buttonState:m,onClick:this.onClickFileInput,tooltipMsg:f,tooltipPersist:l})})),(0,i.jsx)(F.hU,{iconClass:"icon-media-mix",buttonStyle:F.Dd.PLAIN,buttonState:m,tooltipMsg:g,onClick:this.toggleEmbedEditor}),(0,i.jsx)(F.hU,{iconClass:"icon-add-link",buttonStyle:F.Dd.PLAIN,tooltipMsg:y,onClick:this.openLinkEditor})]})),(0,i.jsxs)("div",Object.assign({className:"annotation-cta-buttons"},{children:[(0,i.jsx)(R.zx,Object.assign({buttonStyle:R.ZJ.SECONDARY,buttonSize:R.qE.SMALL,className:"button-inline",buttonState:R.BN.ENABLED,onClick:this.cancelEdits},{children:b})),(0,i.jsx)(R.zx,Object.assign({className:"button-inline",buttonStyle:R.ZJ.SECONDARY,buttonSize:R.qE.SMALL,buttonState:p,onClick:this.saveEdits},{children:v}))]}))]}))}renderAttachments(){const{attachments:e,active:t,onViewAttachment:n}=this.props,{uploads:s,failures:r,pendingAttachments:o}=this.state,a=this.attachmentsData?e.filter((e=>!this.attachmentsData.removals.get(e.id))):e;return o.forEach((e=>a.push(e))),(0,i.jsx)(P.s,{canDelete:t,inline:t,attachments:a,uploads:s,failures:r,onViewAttachment:n})}renderSmartEditor(){const{placeholder:e,hashtags:t,text:n,creating:s,textParser:r,active:o,maxLength:a,tabIndex:l,annotationType:c,onClickToEdit:d}=this.props,u=c===p.J.NOTE,h=this.inEmptyState()&&u&&!s?this.context.locale.t(Z.CONTENT_DELETED):e;return(0,i.jsx)(k.b,{ref:this.setTextEditorRef,textParser:r,text:n,active:!!o,clickToEdit:!!d,placeholder:h,onClickBlock:this.onClickBlock,onStartEditing:o?void 0:d,onDoneEditing:this.onDoneEditing,onCancelEditing:this.cancelEdits,onInput:this.onInput,tabIndex:l,maxLength:a,hashtags:t||[],userMentions:u})}render(){const{className:e,creating:t,active:n,parentId:s,parentType:r,annotationType:o,onClickToEdit:a,edited:l,title:c}=this.props,{uploads:d,selectedBlock:u}=this.state,h=this.getAttachmentCount()<L.yk,m=!(d.length>0)&&(n||t)&&h,f=o===p.J.NOTE,g=this.inEmptyState()&&!t&&f,v=!n&&l&&!g,b={annotating:n,"editor-box":n||!!a,"annotation-emptied":g};let S="",E="";return u&&u.blockType===M.C.LINK&&(S=u.text,E=u.value||""),(0,i.jsxs)(B.Z,Object.assign({className:"annotation-box",onDropped:this.onDrop,disabled:!m,onActivate:this.dropActivated},{children:[c,(0,i.jsxs)("div",Object.assign({className:y()("annotation-text-box",b,e)},{children:[this.renderSmartEditor(),n&&this.renderAttachments(),n&&this.renderButtonBar()]})),v&&(0,i.jsx)("div",Object.assign({className:"annotation-edited"},{children:"(edited)"})),!n&&!t&&this.renderAttachments(),n&&!!s&&(0,i.jsx)(Y,{parentId:s,parentType:r,onEmbed:this.closeEmbedEditor,onCancel:this.closeEmbedEditor}),n&&!!s&&(0,i.jsx)(V.I,{linkText:S,linkUrl:E,onCancelLink:this.onCancelLink,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink})]}))}};$.contextType=o.I,$=q([r.Z],$);var Q=n(64191),X=n(25379),J=n(43873),ee=n(76223),te=n(10969),ne=n(94170),ie=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{INVITE_USER:se,INVITE_BUTTON:re,INVITE_USERS:oe,INVITE_VISIBLE_MSG:ae}=z.Z.USERS;let le=class UserInviteCard extends s.Component{constructor(e){super(e),this.onInviteUsers=()=>{this.props.onInviteUsers(this.props.invitees)}}render(){const{invitees:e}=this.props;if(0===e.length)return null;const{locale:t}=this.context;let n;const s=t.t(re,e.length);n=1===e.length?t.t(se,{email:e[0]}):t.t(oe,{emails:e.join(", ")});const r=t.t(ae);return(0,i.jsxs)("div",Object.assign({className:"user-invite-card"},{children:[(0,i.jsxs)("div",Object.assign({className:"user-invite-info"},{children:[(0,i.jsx)("span",{className:"icon icon-eye-show"}),(0,i.jsx)("span",Object.assign({className:""},{children:r}))]})),(0,i.jsx)("p",Object.assign({className:"user-invite-msg"},{children:n})),(0,i.jsx)(R.zx,Object.assign({onClick:this.onInviteUsers,buttonStyle:R.ZJ.TERTIARY,className:y()("button-inline","user-invite-button")},{children:s}))]}))}};le.contextType=o.I,le=ie([r.Z],le);var ce=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{INVITE_VISIBLE_MSG:de,INVITE_USER_FAILED:ue,INVITE_USERS_FAILED:he}=z.Z.USERS;let pe=class UserInviteError extends s.Component{constructor(e){super(e)}render(){const{failedEmails:e}=this.props,{locale:t}=this.context;if(0===e.length)return null;let n;n=1===e.length?t.t(ue,{email:e[0]}):t.t(he,{failedEmails:e.join(", ")});const s=t.t(de);return(0,i.jsxs)("div",Object.assign({className:"user-invite-card"},{children:[(0,i.jsxs)("div",Object.assign({className:"user-invite-info"},{children:[(0,i.jsx)("span",{className:"icon icon-eye-show"}),(0,i.jsx)("span",Object.assign({className:""},{children:s}))]})),(0,i.jsx)("p",Object.assign({className:"user-invite-msg"},{children:n}))]}))}};pe.contextType=o.I,pe=ce([r.Z],pe);var me=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{UNKNOWN_USER:fe,UNKNOWN_USERS:ge,INVITE_VISIBLE_MSG:ve}=z.Z.USERS;let ye=class UnknownEmailCard extends s.Component{render(){const{locale:e}=this.context,{emails:t}=this.props;if(0===t.length)return null;let n;n=1===t.length?e.t(fe,{email:t[0]}):e.t(ge,{emails:t.join(", ")});const s=e.t(ve);return(0,i.jsxs)("div",Object.assign({className:"user-invite-card"},{children:[(0,i.jsxs)("div",Object.assign({className:"user-invite-info"},{children:[(0,i.jsx)("span",{className:"icon icon-eye-show"}),(0,i.jsx)("span",Object.assign({className:""},{children:s}))]})),(0,i.jsx)("p",Object.assign({className:"user-invite-msg"},{children:n}))]}))}};ye.contextType=o.I,ye=me([r.Z],ye);var be=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Se=class UnknownUserMention extends s.Component{constructor(e){super(e),this.inviteUsers=async e=>{if(0===e.length)return;const{noteId:t,message:n}=this.props;await this.context.commandBinder.issueCommand(new ee.JB(e,n,g.AT,t))}}getInvitees(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{(e.userStatus===te.J.MENTIONED||e.userStatus===te.J.KNOWN&&e.modelAccess===ne.x.PUBLIC)&&t.push(e.email)})),t}getFailedEmails(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{e.userStatus===te.J.FAILED&&t.push(e.email)})),t}render(){const{expires:e,noteId:t}=this.props;if((new Date).getTime()>e)return null;const{userData:n}=this.context,s=n.isInviter(),r=this.getInvitees(),o=this.getFailedEmails();return(0,i.jsxs)("div",Object.assign({className:"user-mentions-unknown"},{children:[s&&r.length>0&&(0,i.jsx)(le,{invitees:r,modelAccess:g.AT,noteId:t,onInviteUsers:this.inviteUsers}),!s&&r.length>0&&(0,i.jsx)(ye,{emails:r}),o.length>0&&(0,i.jsx)(pe,{failedEmails:o})]}))}};Se.contextType=o.I,Se=be([r.Z],Se);var Ee=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{NOTES:Te}=z.Z.SHOWCASE;let we=class Comment extends s.Component{constructor(e){super(e),this.editComment=()=>{const{comment:e}=this.props;this.trackEvent("notes_click_edit_comment"),this.context.commandBinder.issueCommand(new u.x4(e.id)),this.annotation&&this.annotation.edit()},this.deleteComment=()=>{const{noteId:e,comment:t}=this.props;this.trackEvent("notes_click_delete_comment"),this.context.commandBinder.issueCommand(new u.mH(e,t.id))},this.saveChanges=(e,t)=>{const{comment:n,noteId:i,onCancel:s}=this.props;t?(this.trackEvent("notes_delete_empty_comment"),this.context.commandBinder.issueCommand(new u.mH(i,n.id)),s()):this.context.commandBinder.issueCommand(new u.Uw(i,n.id,e))},this.setAnnotationRef=e=>{this.annotation=e},this.getMenuOptions=(e,t)=>{const n=[];return e&&n.push([Te.EDIT,this.editComment]),t&&n.push([Te.DELETE,this.deleteComment]),n}}trackEvent(e){this.context.analytics.trackToolGuiEvent("notes",e)}getUnknownMentions(){const{manager:e,comment:t,userMentionMap:n}=this.props;return e.dataMap.notesViewData.getCommentUserMentions(t.text,n)}renderAnnotation(e){const{comment:t,attachments:n,hashtags:s,active:r,onViewAttachment:o,manager:a,noteId:l,onCancel:c,toolPanelLayout:d,openModal:u}=this.props,{text:h,edited:m,id:f}=t,v=a.getTextParser(),y=a.getLinkHandler();return e?(0,i.jsx)($,{ref:this.setAnnotationRef,text:h,textParser:v,linkHandler:y,hashtags:s,annotationType:p.J.NOTE,annotationId:l,parentType:_.u.COMMENT,parentId:f,attachments:n,active:r,edited:m,creating:!1,toolPanelLayout:d,openModal:u,onViewAttachment:o,onDoneEditing:this.saveChanges,onCancelEditing:c,maxLength:g.Ko},f):(0,i.jsx)(Q.e,{text:h,textParser:v,linkHandler:y,annotationType:p.J.NOTE,annotationId:l,attachments:n,edited:m,onViewAttachment:o})}render(){const{comment:e,active:t,noteId:n,manager:s}=this.props,{user:r,created:o,id:a,text:l}=e,{userData:c}=this.context,d=(0,m.C)(c,p.J.NOTE,r),u=(0,m.K)(c,p.J.NOTE,r),h=this.getMenuOptions(d,u),f=e.modified.getTime()+60*g.E8*1e3,v=c.getUserDisplay(r.email),b=v.color,S=s.getTextParser().getPlainText(l),E=this.getUnknownMentions();return(0,i.jsxs)("div",Object.assign({className:y()("comment",{active:t}),"data-id":a},{children:[(0,i.jsxs)("div",Object.assign({className:"note-header comment-header"},{children:[(0,i.jsx)(J.C,{badgeStyle:{color:b,borderColor:b},label:v.initials}),(0,i.jsxs)("div",Object.assign({className:"note-details"},{children:[(0,i.jsx)("span",Object.assign({className:"note-user"},{children:v.name})),(0,i.jsx)("div",Object.assign({className:"note-subheader"},{children:o.toLocaleString()}))]})),!t&&(d||u)&&(0,i.jsx)(X.n,{id:a,menu:h})]})),this.renderAnnotation(d),d&&(0,i.jsx)(Se,{noteId:n,message:S,userMentions:E,expires:f})]}))}};we.contextType=o.I,we=Ee([r.Z],we);var xe=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{NOTES:_e}=z.Z.SHOWCASE;let Me=class ReplyBox extends s.Component{constructor(e){super(e),this.startReply=()=>{this.context.analytics.trackToolGuiEvent("notes","notes_click_new_comment"),this.context.commandBinder.issueCommand(new u.x4(this.props.replyId))},this.onDone=(e,t)=>{const{replyId:n,noteId:i,onCancel:s,onReply:r}=this.props;t?s():r(i,n,e)}}render(){const{hashtags:e,replyId:t,noteId:n,active:s,onCancel:r,toolPanelLayout:o,openModal:a,manager:l}=this.props;return(0,i.jsx)($,{className:"reply-box",textParser:l.getTextParser(),linkHandler:l.getLinkHandler(),annotationType:p.J.NOTE,annotationId:n,parentType:_.u.COMMENT,parentId:t,attachments:[],active:s,edited:!1,creating:!0,text:"",hashtags:e,toolPanelLayout:o,openModal:a,placeholder:this.context.locale.t(_e.REPLY_PLACEHOLDER),onClickToEdit:this.startReply,onDoneEditing:this.onDone,onCancelEditing:r,maxLength:g.Ko})}};Me.contextType=o.I,Me=xe([r.Z],Me);var Oe=n(78576),Ae=n(58361),Ce=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{NOTES:Ne}=z.Z.SHOWCASE;let De=class NoteHeader extends s.Component{constructor(e){super(e),this.editNote=()=>{this.trackEvent("notes_click_edit_note"),this.props.onEditNote()},this.deleteNote=()=>{const{note:e}=this.props;this.trackEvent("notes_click_delete_note"),this.context.commandBinder.issueCommand(new u.sG(e.id))},this.resolveNote=()=>{const{note:e}=this.props;this.trackEvent("notes_click_resolve_note"),this.context.commandBinder.issueCommand(new u.yp(e.id,!0))},this.unresolveNote=()=>{const{note:e}=this.props;this.trackEvent("notes_click_unresolve_note"),this.context.commandBinder.issueCommand(new u.yp(e.id,!1))},this.getMenuOptions=(e,t,n)=>{const i=[];return e&&i.push([Ne.EDIT,this.editNote]),n&&i.push([Ne.UNRESOLVE,this.unresolveNote]),t&&i.push([Ne.DELETE,this.deleteNote]),i}}trackEvent(e){this.context.analytics.trackToolGuiEvent("notes",e)}render(){const{note:e,creatingNote:t,active:n,onCancelNote:s}=this.props,{userData:r}=this.context,o=(0,m.C)(r,p.J.NOTE,e.user),a=r.getUserDisplay(e.user.email),l=a.color,c=!t&&!n,d=c&&(0,m.K)(r,p.J.NOTE,e.user),u=c&&!e.resolved,h=c&&e.resolved,f=!t&&(o||h||d),g=this.getMenuOptions(o,d,h),v=this.context.locale.t(Ne.MARK_AS_RESOLVED);return(0,i.jsxs)("header",Object.assign({className:"note-header"},{children:[(0,i.jsx)(J.C,{badgeStyle:{color:l,borderColor:l},label:a.initials}),(0,i.jsxs)("div",Object.assign({className:"note-details"},{children:[(0,i.jsx)("span",Object.assign({className:"note-user"},{children:a.name})),(0,i.jsx)("div",Object.assign({className:"note-subheader"},{children:e.created.toLocaleString()}))]})),t&&(0,i.jsx)(F.hU,{iconClass:"icon-close",buttonStyle:F.Dd.PLAIN,tooltipMsg:this.context.locale.t(Ne.CANCEL),tooltipPosition:Oe.lZ.DOWN,onClick:s}),u&&(0,i.jsx)(F.hU,{iconClass:"icon-checkmark",buttonStyle:F.Dd.SOCIAL,buttonSize:R.qE.SMALL,buttonState:R.BN.ENABLED,tooltipMsg:v,tooltipPosition:Oe.lZ.DOWN,onClick:this.resolveNote}),c&&(0,i.jsx)(Ae.O,{prefix:"note",pin:e,id:e.id,darkTheme:!0,analyticAction:"copy_note_share_link",includeCameraView:!0}),f&&(0,i.jsx)(X.n,{id:e.id,menu:g})]}))}};De.contextType=o.I,De=Ce([r.Z],De);var Ie=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Le=class NotePost extends s.Component{constructor(e){super(e),this.bindings=[],this.startEditing=()=>{const e=this.props.manager.dataMap.notesViewData.activeNotation;this.annotation&&e===this.props.note.id&&this.annotation.edit()},this.saveNoteChanges=async(e,t)=>{const{note:n,manager:i,onCancel:s}=this.props;t?s():i.dataMap.notesViewData.isNewNote?await this.context.commandBinder.issueCommand(new u.FB(e)):await this.context.commandBinder.issueCommand(new u.kd(n.id,e))},this.onEditNote=()=>{var e;const{note:t}=this.props,n=null===(e=t.comments.get(0))||void 0===e?void 0:e.id;n&&this.context.commandBinder.issueCommand(new u.x4(n))},this.onFocusPin=()=>{this.props.manager.dataMap.notesViewData.isNewNote&&this.startEditing()},this.setAnnotationRef=e=>{this.annotation=e}}componentDidMount(){const{messageBus:e}=this.context;this.bindings.push(e.subscribe(c.cd,this.onFocusPin))}componentWillUnmount(){for(const e of this.bindings)e.cancel()}componentDidUpdate(e){this.props.active&&!e.active&&this.startEditing()}getExpirationTime(e){return e.modified.getTime()+60*g.E8*1e3}getUnknownMentions(e){const{manager:t,userMentionMap:n}=this.props;return t.dataMap.notesViewData.getCommentUserMentions(e.text,n)}renderUserMentionCards(){const{manager:e,note:t}=this.props,n=t.comments.get(0);if(!n)return null;const s=e.getTextParser().getPlainText(n.text),r=this.getExpirationTime(n),o=this.getUnknownMentions(n);return 0===o.length?null:(0,i.jsx)(Se,{message:s,noteId:t.id,expires:r,userMentions:o})}renderAnnotation(e){const{note:t,creatingNote:n,attachments:s,hashtags:r,active:o,onViewAttachment:a,manager:l,onCancel:c,toolPanelLayout:d,openModal:u}=this.props,h=l.getTextParser(),m=l.getLinkHandler(),f=t.comments.get(0),v=(null==f?void 0:f.text)||"",y=(null==f?void 0:f.edited)||!1;if(e){const e=(null==f?void 0:f.id)||t.id;return(0,i.jsx)($,{ref:this.setAnnotationRef,textParser:h,linkHandler:m,annotationId:t.id,annotationType:p.J.NOTE,parentId:e,parentType:_.u.COMMENT,attachments:s,active:o,edited:y,creating:n,text:v,hashtags:r,placeholder:"Add your message",toolPanelLayout:d,openModal:u,onViewAttachment:a,onDoneEditing:this.saveNoteChanges,onCancelEditing:c,maxLength:g.TM})}return(0,i.jsx)(Q.e,{text:v,textParser:h,linkHandler:m,annotationType:p.J.NOTE,annotationId:t.id,attachments:s,edited:y,onViewAttachment:a})}render(){const{note:e,creatingNote:t,onCancel:n,active:s}=this.props,{userData:r}=this.context,o=e.comments.get(0),a=e.user.id===r.getCurrentUserId(),l=!!a&&r.isCommenter();return(0,i.jsxs)("div",Object.assign({className:"note-post"},{children:[(0,i.jsx)(De,{note:e,active:s,creatingNote:t,onEditNote:this.onEditNote,onCancelNote:n}),this.renderAnnotation(l),!t&&o&&a&&this.renderUserMentionCards()]}))}};Le.contextType=o.I,Le=Ie([r.Z],Le);var Pe=n(40552),Re=n(77492);const{NOTES:ke}=z.Z.SHOWCASE;class NoteWidget extends s.Component{constructor(e){super(e),this.bindings=[],this.cancelTimeout=0,this.updateListIndex=()=>{const e=this.props.manager.dataMap.notesViewData.listIndex;this.setState({listIndex:e,navigating:!1})},this.updateAttachments=()=>{const{note:e,manager:t}=this.props,n=e?t.dataMap.notesViewData.getNoteAttachments(e.id):[];this.setState({attachments:n})},this.updateHashtags=()=>{const{hashtagData:e}=this.props.manager.dataMap;this.setState({hashtags:e.getHashtags()})},this.updateActiveNotation=()=>{const{notesViewData:e}=this.props.manager.dataMap;this.setState({activeNotation:e.activeNotation})},this.updateUserMentionMap=()=>{this.setState({userMentionMap:this.context.userData.getUsersWhoMayNeedAccess()})},this.updateToolAssetAccess=()=>{this.setState({toolAccess:this.context.toolsData.toolAccess})},this.closeNotesMode=()=>{this.context.commandBinder.issueCommand(new E.tT(h.w1.NOTES,!1))},this.cancelNoteChanges=()=>{const{note:e,manager:t}=this.props,{activeNotation:n}=this.state;window.clearTimeout(this.cancelTimeout),t.dataMap.notesViewData.isNewNote?this.setState({cancellingCreation:!0},(()=>{this.closeNote(),this.cancelTimeout=window.setTimeout((()=>{this.setState({cancellingCreation:!1})}),500)})):e&&n&&this.cancelCommentChanges()},this.cancelCommentChanges=()=>{this.context.commandBinder.issueCommand(new u.oH)},this.closeNote=()=>{this.props.manager.dataMap.notesViewData.isNewNote?this.context.commandBinder.issueCommand(new u.gc):this.context.commandBinder.issueCommand(new u._N)},this.addReply=(e,t,n)=>{this.context.commandBinder.issueCommand(new u.Df(e,n,t)),this.setState({replyId:this.getReplyId()})},this.cancelReply=()=>{this.cancelCommentChanges(),this.setState({replyId:this.getReplyId()})},this.onViewAttachment=e=>{const{attachments:t}=this.state;if(t.length){this.context.analytics.trackToolGuiEvent("notes","notes_click_view_attachment");const n=t.filter((e=>(0,x.lV)(e)));n.length>0&&this.context.commandBinder.issueCommand(new w.xW(!0,n,e))}},this.onNavigateList=async e=>{const t=this.props.noteListViews[e];if(!t)return;this.setState({listIndex:e,navigating:!0}),this.context.commandBinder.issueCommand(new w.xW(!1));const n=t.assetType===S.h.COMMENT;await this.context.commandBinder.issueCommand(new u.Zd(t.id,n,!1)),n&&await this.context.messageBus.broadcast(new f.JL(t.id))},this.state={activeNotation:null,listIndex:-1,replyId:this.getReplyId(),toolAccess:h.X$.SCENE,hashtags:[],attachments:[],userMentionMap:{},cancellingCreation:!1,navigating:!1}}componentDidMount(){const{hashtagData:e,notesViewData:t}=this.props.manager.dataMap,{toolsData:n,userData:i}=this.context;this.bindings.push(n.onToolAssetAccessChanged(this.updateToolAssetAccess),e.onChanged(this.updateHashtags),t.onActiveNotationChanged(this.updateActiveNotation),t.onListIndexChanged(this.updateListIndex),i.onUsersChanged(this.updateUserMentionMap)),this.updateToolAssetAccess(),this.updateHashtags(),this.updateActiveNotation(),this.updateListIndex(),this.updateUserMentionMap()}componentWillUnmount(){window.clearTimeout(this.cancelTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){var n;const{note:i}=this.props;e.note!==i&&(this.updateAttachments(),(null===(n=e.note)||void 0===n?void 0:n.id)!==(null==i?void 0:i.id)&&i&&(window.clearTimeout(this.cancelTimeout),this.setState({replyId:this.getReplyId()})),this.handleMissingNotation())}shouldComponentUpdate(){return!this.state.cancellingCreation}getReplyId(){return this.props.note?(0,b.O1)(11):null}handleMissingNotation(){const{note:e,manager:t,creatingNote:n}=this.props,{activeNotation:i,replyId:s}=this.state;if(n||!i)return;const{notesViewData:r}=t.dataMap;if(e){const t=e.id;i===t||i===s||r.getComment(t,i)||r.setActiveNotation(null)}else r.setActiveNotation(null)}getCommentAttachments(e){return this.state.attachments.filter((t=>t.parentId===e))}renderReplyBox(){const{note:e,toolPanelLayout:t,openModal:n,manager:s}=this.props,{activeNotation:r,hashtags:o,replyId:a}=this.state;if(!e||!a)return null;const l=r===a;return l||null===r?(0,i.jsx)(Me,{replyId:a,noteId:e.id,active:l,hashtags:o,manager:s,toolPanelLayout:t,openModal:n,onCancel:this.cancelReply,onReply:this.addReply}):null}renderComments(){const{note:e,toolPanelLayout:t,manager:n,openModal:s}=this.props;if(!e)return null;const{activeNotation:r,hashtags:o,userMentionMap:a}=this.state;return(0,i.jsx)("div",Object.assign({className:"note-comments"},{children:e.comments.map(((l,c)=>{if(0===c)return null;const d=this.getCommentAttachments(l.id);return(0,i.jsx)(we,{active:r===l.id,manager:n,noteId:e.id,comment:l,attachments:d,hashtags:o,userMentionMap:a,toolPanelLayout:t,openModal:s,onCancel:this.cancelCommentChanges,onViewAttachment:this.onViewAttachment},l.id)}))}))}renderNoteNavHeader(){const{noteListViews:e,creatingNote:t,note:n,toolPanelLayout:s}=this.props;if(t||!n)return null;const{toolAccess:r,activeNotation:o,listIndex:a,navigating:l}=this.state,c=e.length,d=!t&&!o&&c>1&&-1!==a,u=s===h.wS.SIDE_PANEL,p=r===h.X$.SCENE,m=r===h.X$.LIST||!p&&u,f=this.context.locale.t(m?ke.NAV_BACK:ke.NAV_CLOSE),g=m?"icon-back":"icon-close",v=m||!p?this.closeNote:this.closeNotesMode;return(0,i.jsxs)("div",Object.assign({className:"detail-panel-header"},{children:[(0,i.jsx)(Pe.A,{label:f,className:"return-btn",icon:g,buttonSize:R.qE.SMALL,buttonStyle:R.ZJ.TOOLBAR,onClick:v}),d&&(0,i.jsx)(Re.$,{index:a,total:c,disabled:l,wrapAround:!0,onNavigate:this.onNavigateList})]}))}render(){var e,t;const{manager:n,note:s,toolPanelLayout:r,notesPhase:o,creatingNote:a,openModal:l}=this.props,{activeNotation:c,hashtags:d,userMentionMap:u}=this.state,{userData:h}=this.context,p=h.isCommenter(),m=null===(t=null===(e=null==s?void 0:s.comments)||void 0===e?void 0:e.get(0))||void 0===t?void 0:t.id,f=!!c&&(c===m||a),g={annotating:!!c,creating:a},v=m?this.getCommentAttachments(m):[];return(0,i.jsxs)("div",Object.assign({className:y()("note-widget",g)},{children:[this.renderNoteNavHeader(),s&&(0,i.jsx)(Le,{active:f,manager:n,note:s,notesPhase:o,creatingNote:a,attachments:v,hashtags:d,userMentionMap:u,toolPanelLayout:r,openModal:l,onCancel:this.cancelNoteChanges,onViewAttachment:this.onViewAttachment}),!a&&this.renderComments(),!a&&p&&this.renderReplyBox()]}))}}NoteWidget.contextType=o.I;const Ue=(0,T.W)(NoteWidget);var Be=n(37884),Fe=n(6165),Ve=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let He=class NoteDetailsPanel extends s.Component{constructor(e){super(e),this.bindings=[],this.onCommentFocus=e=>{this.toolPanel.scrollToSelector(`[data-id='${e.commentId}']`)},this.closeEditor=()=>{this.context.commandBinder.issueCommand(new u.df(!1))},this.savePinAppearance=e=>{const{note:t}=this.props;t&&this.context.commandBinder.issueCommand(new u.oE(t.id,e))},this.setToolPanelRef=e=>{e&&(this.toolPanel=e)}}componentDidMount(){this.bindings.push(this.context.messageBus.subscribe(f.JL,this.onCommentFocus))}componentWillUnmount(){for(const e of this.bindings)e.cancel()}componentDidUpdate(e){var t,n;this.toolPanel&&(e.notesPhase!==d.U.EDITING&&this.props.notesPhase===d.U.EDITING||(null===(t=e.note)||void 0===t?void 0:t.id)!==(null===(n=this.props.note)||void 0===n?void 0:n.id)||e.modalOpen&&!this.props.modalOpen)&&this.toolPanel.resetScrollTop()}render(){const{note:e,noteListViews:t,notesPhase:n,closing:s,creatingNote:r,modalOpen:o,toolPanelLayout:a,manager:c}=this.props,u=!!e&&(0,m.C)(this.context.userData,p.J.NOTE,e.user),f=n===d.U.EDITING,v=a===h.wS.BOTTOM_PANEL,y=!(!e||s||v&&o),b=f&&v;return(0,i.jsxs)(Be.J,Object.assign({ref:this.setToolPanelRef,open:y,toolPanelLayout:a,scrollingDisabled:b},{children:[(0,i.jsx)(Ue,{manager:c,note:e,toolPanelLayout:a,notesPhase:n,creatingNote:r,noteListViews:t}),e&&v&&u&&(0,i.jsx)(Fe.q,{id:e.id,pin:e,pinType:l.Er.NOTE,onSave:this.savePinAppearance,onClose:this.closeEditor,colors:g.ZP.colors,open:f,toolPanelLayout:a},e.id)]}))}};He.contextType=o.I,He=Ve([r.Z],He);var je=n(64921),Ge=n(77534),ze=n(46317),We=n(34506),Ke=n(28876),Ye=n(13729),qe=n(54787),Ze=n(28654),$e=n(90786);const{NOTES:Qe}=z.Z.SHOWCASE;var Xe;!function(e){e.TODAY="TODAY",e.YESTERDAY="YESTERDAY",e.THIS_WEEK="THIS_WEEK",e.ONE_WEEK_AGO="ONE_WEEK_AGO",e.TWO_WEEKS_AGO="TWO_WEEKS_AGO",e.THREE_WEEKS_AGO="THREE_WEEKS_AGO",e.OLDER="OLDER"}(Xe||(Xe={}));class NotesList extends s.Component{constructor(e){super(e),this.bindings=[],this.transitionTimeout=0,this.updateNoteFilter=()=>{const e=this.props.manager.dataMap.notesViewData;this.setState({filter:e.notesFilter})},this.transitionNoteOut=e=>{const{filter:t}=this.state,n=e.resolved&&t===Ge.$.OPEN?e.id:null;this.setState({filteringOutId:n}),window.clearTimeout(this.transitionTimeout),n&&(this.transitionTimeout=window.setTimeout((()=>{this.setState({filteringOutId:null})}),a.g))},this.updateNoteGroups=()=>{const e=this.getSortedNoteGroups();this.setState({listGroups:e})},this.onSelectListItem=e=>{this.trackEvent("notes_list_open_note");const[t,n]=e.split("-"),i=t===S.h.COMMENT;this.openListItem(n,i,!1)},this.editNote=e=>{this.trackEvent("notes_list_edit_note"),this.openListItem(e.id,!1,!0)},this.deleteNote=e=>{this.trackEvent("notes_list_delete_note"),this.context.commandBinder.issueCommand(new u.sG(e.id))},this.openNotesIntro=e=>{e.stopPropagation(),this.context.commandBinder.issueCommand(new N.Bz(D.P.NOTES_INTRO,!0))},this.onFilterChange=e=>{if(e){const t=e;this.trackEvent("notes_list_change_filter"),this.props.manager.dataMap.notesViewData.setNotesFilter(t)}},this.onCloseLayer=async e=>{e&&e.stopPropagation(),await this.context.commandBinder.issueCommand(new E.tT(h.w1.NOTES,!1))},this.getMenuOptions=(e,t,n)=>{const i=[];if(t){const t=()=>this.editNote(e);i.push([Qe.EDIT_LIST_ITEM_OPTION_CTA,t])}if(n){const t=()=>this.deleteNote(e);i.push([Qe.DELETE_LIST_ITEM_OPTION_CTA,t])}return i},this.state={listGroups:{},filter:Ge.$.OPEN,filteringOutId:null}}componentDidMount(){const{notesViewData:e}=this.props.manager.dataMap,{messageBus:t}=this.context;this.bindings.push(e.onNotesFilterChanged(this.updateNoteFilter),t.subscribe(f.hY,this.transitionNoteOut)),this.textParser=new je.v({links:!0,hashtags:!0,users:this.context.userData}),this.updateNoteGroups(),this.updateNoteFilter()}componentWillUnmount(){window.clearTimeout(this.transitionTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){e.noteListViews===this.props.noteListViews&&t.filter===this.state.filter&&e.searchBlock===this.props.searchBlock||this.updateNoteGroups()}trackEvent(e){this.context.analytics.trackToolGuiEvent("notes",e)}getSortedNoteGroups(){const e={};return this.props.noteListViews.forEach((t=>{const n=this.getDateBucket(t.createdTime);e[n]||(e[n]={dateBucket:n,items:[]}),e[n].items.push(t)})),e}getDateBucket(e){const t=new Date(e),n=new Date;n.setHours(0,0,0,0),t.setHours(0,0,0,0);const i=(n.getTime()-t.getTime())/864e5;if(0===i)return Xe.TODAY;if(1===i)return Xe.YESTERDAY;if(i<7)return Xe.THIS_WEEK;const s=Math.floor(i/7);return 1===s?Xe.ONE_WEEK_AGO:2===s?Xe.TWO_WEEKS_AGO:3===s?Xe.THREE_WEEKS_AGO:Xe.OLDER}openListItem(e,t,n){this.context.commandBinder.issueCommand(new u.Zd(e,t,n))}getEmptyMessage(){const{searchBlock:e}=this.props,{filter:t}=this.state;return this.context.locale.t(e?Qe.NO_MATCHES:t===Ge.$.OPEN?Qe.HAVE_NONE_OPEN:t===Ge.$.RESOLVED?Qe.HAVE_NONE_RESOLVED:Qe.HAVE_NONE)}getAnnotationText(e){let t=e.text;if(""===t){const n=e.numAttachments,i=e.numComments-1;n>0?t=this.context.locale.t(Qe.NUM_ATTACHMENTS,n):0===i&&(t=this.context.locale.t(Qe.CONTENT_DELETED))}return t}getListTitle(){const{noteListViews:e,searchBlock:t}=this.props,n=e.length,s=this.context.locale.t(t?Qe.RESULTS:Qe.NOTES,n);return(0,i.jsxs)("div",{children:[s,(0,i.jsx)("span",Object.assign({className:"word-badge"},{children:"Beta"})),(0,i.jsx)(F.hU,{iconClass:"icon-question",buttonStyle:F.Dd.PLAIN,onClick:this.openNotesIntro})]})}renderAnnotationSummary(e){const t=this.getAnnotationText(e);return(0,i.jsx)("div",Object.assign({className:y()("note-text",{"note-summary-info":!e.text})},{children:(0,i.jsx)(Ze.S,{text:t,textParser:this.textParser,linksActive:!1})}))}renderItem(e,t){const{filteringOutId:n}=this.state,{searchBlock:s}=this.props,{id:r,user:o,color:a,assetType:l,numComments:c}=e,d=`${l}-${r}`,{userData:u}=this.context,h=(0,m.C)(u,p.J.NOTE,e.user),f=(0,m.K)(u,p.J.NOTE,e.user),g=this.getMenuOptions(e,h,f),v=o?u.getUserDisplay(o.email):null,b=c-1,S=this.context.locale.t(Qe.REPLIES,b),E=y()("note-header",{"accordion-item-with-options":g.length,"accordion-item-closing":r===n});return(0,i.jsxs)(qe.Q,Object.assign({sid:d,className:E,enabled:!0,selected:!1,onSelect:this.onSelectListItem},{children:[(0,i.jsx)(J.C,{badgeStyle:{backgroundColor:a,borderColor:a},iconClass:"icon-comment"}),(0,i.jsxs)("div",Object.assign({className:"note-details"},{children:[v&&(0,i.jsx)("span",Object.assign({className:"note-user"},{children:v.name})),b>0&&!s&&(0,i.jsx)("span",Object.assign({className:"note-summary-info note-replies"},{children:S})),this.renderAnnotationSummary(e)]})),!s&&g.length>0&&(0,i.jsx)(X.n,{id:r,menu:g,accordion:!0})]}),d)}renderGroups(){const{listGroups:e,filteringOutId:t}=this.state,n=[];for(const s in e){const r=e[s];n.push((0,i.jsx)(Ye.b,Object.assign({id:s,header:this.context.locale.t(Qe[r.dateBucket]),open:!0,doubleLine:!0,naturalHeight:!!t},{children:r.items.map(((e,t)=>this.renderItem(e,t)))}),s))}return n}renderFilter(){const{filter:e}=this.state,t=[{text:this.context.locale.t(Qe.FILTER_UNRESOLVED),value:Ge.$.OPEN,selected:e===Ge.$.OPEN},{text:this.context.locale.t(Qe.FILTER_RESOLVED),value:Ge.$.RESOLVED,selected:e===Ge.$.RESOLVED},{text:this.context.locale.t(Qe.FILTER_ALL),value:Ge.$.ALL,selected:e===Ge.$.ALL}];return(0,i.jsx)("div",Object.assign({className:"list-menu note-filter"},{children:(0,i.jsx)(We.S,{className:"filter-note-select",menuStyle:We.K.DROPDOWN,onChange:this.onFilterChange,options:t})}))}renderNotesAndComments(){const{noteListViews:e}=this.props;if(0===e.length){const e=this.getEmptyMessage();return(0,i.jsx)("div",Object.assign({className:"empty-message"},{children:e}))}return(0,i.jsx)(Ke.F,{children:this.renderGroups()})}renderSearchHeader(){const{searchBlock:e,onCancelSearch:t}=this.props;return e?(0,i.jsxs)("div",Object.assign({className:"list-search"},{children:[(0,i.jsx)("span",Object.assign({className:"search-term"},{children:e.text})),(0,i.jsx)(R.zx,Object.assign({buttonStyle:R.ZJ.PLAIN,onClick:t},{children:"Clear"}))]})):null}renderSubheader(){return(0,i.jsxs)("div",Object.assign({className:"list-subheaders"},{children:[this.renderSearchHeader(),this.renderFilter()]}))}render(){const{active:e,toolPanelLayout:t,searchBlock:n}=this.props,s=!!n&&n.blockType===M.C.USER,r=!!n&&n.blockType===M.C.HASH;return(0,i.jsxs)(ze.L,Object.assign({active:e,className:"annotations-list-panel",title:this.getListTitle(),subheader:this.renderSubheader(),toolPanelLayout:t,onClose:this.onCloseLayer},{children:[(0,i.jsx)("div",Object.assign({className:y()("list-contents","annotations-list",{"search-results-user":s,"search-results-hash":r})},{children:this.renderNotesAndComments()})),(0,i.jsx)($e.R,{url:"https://forms.gle/LkkQ1kphFKGtBFfUA"})]}))}}NotesList.contextType=o.I;var Je=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let et=class NotesPanel extends s.Component{constructor(e){super(e),this.bindings=[],this.detailPanelClosedTimeout=0,this.updateListViews=()=>{const e=this.props.manager.dataMap.notesViewData.noteListViews;this.setState({noteListViews:e.values()})},this.updateNotesPhase=()=>{this.setState({notesPhase:this.props.manager.dataMap.notesViewData.notesPhase})},this.pinPlaced=e=>{e.pinType===l.Er.NOTE&&this.startOpeningNoteWidget()},this.startClosingDetailPanel=()=>{this.state.detailPanelClosing||(this.setState({detailPanelClosing:!0}),this.detailPanelClosedTimeout=window.setTimeout((()=>{this.setState({currentNote:null,detailPanelClosing:!1})}),a.El))},this.updateCurrentNote=async()=>{const{currentNote:e}=this.state,{notesPhase:t,openNoteView:n}=this.props.manager.dataMap.notesViewData;window.clearTimeout(this.detailPanelClosedTimeout),t===d.U.CREATING?(null==e?void 0:e.id)!==(null==n?void 0:n.id)&&this.startClosingDetailPanel():!e&&n?this.startOpeningNoteWidget():e&&!n?this.startClosingDetailPanel():this.setState({currentNote:n})},this.updateSearchTerm=()=>{const e=this.props.manager.dataMap.notesViewData;this.setState({searchBlock:e.searchBlock})},this.onCancelSearch=()=>{this.context.commandBinder.issueCommand(new u.av)},this.state={detailPanelClosing:!1,noteListViews:[],notesPhase:d.U.CLOSED,currentNote:null,searchBlock:null}}componentDidMount(){const{notesViewData:e}=this.props.manager.dataMap,{messageBus:t}=this.context;this.bindings.push(e.onNotesPhaseChanged(this.updateNotesPhase),e.onOpenNoteViewChanged(this.updateCurrentNote),e.noteListViews.onChanged(this.updateListViews),e.onSearchBlockChanged(this.updateSearchTerm),t.subscribe(c.b0,this.pinPlaced)),this.updateListViews(),this.updateCurrentNote(),this.updateNotesPhase(),this.updateSearchTerm()}componentWillUnmount(){window.clearTimeout(this.detailPanelClosedTimeout);for(const e of this.bindings)e.cancel()}startOpeningNoteWidget(){const e=this.props.manager.dataMap.notesViewData;window.clearTimeout(this.detailPanelClosedTimeout),this.setState({currentNote:e.openNoteView,detailPanelClosing:!1})}render(){const{toolPanelLayout:e,manager:t,modalOpen:n}=this.props,{notesViewData:s}=t.dataMap,{detailPanelClosing:r,searchBlock:o,noteListViews:a,notesPhase:l,currentNote:c}=this.state,d=r||!c,u=s.isNewNote;return(0,i.jsxs)("div",Object.assign({className:"tool-panel notes-panel"},{children:[(0,i.jsx)(He,{manager:t,closing:r,note:c,modalOpen:n,toolPanelLayout:e,notesPhase:l,creatingNote:u,noteListViews:a}),(0,i.jsx)(NotesList,{manager:t,active:d,toolPanelLayout:e,noteListViews:a,searchBlock:o,onCancelSearch:this.onCancelSearch})]}))}};et.contextType=o.I,et=Je([r.Z],et)},56646:(e,t,n)=>{"use strict";n.d(t,{$:()=>Tags});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(36616),c=n(71843),d=n(81111),u=n(14877),h=n(69098),p=n(76641),m=n(14832),f=n(57340),g=n(11679),v=n(5477);const y=new v.Z("embedly");class InvalidImageEmbed{constructor(e){this.msg=e}}class InvalidHtmlError{constructor(e){this.msg=e}}class UnsupportedTypeError{constructor(e){this.msg=e}}const b="Instagram",S="Flickr";class Embedly{constructor(e,t){this.key=e,this.queue=t,this.embedEndpoint="https://api.embed.ly/1/oembed",this.imageEndpoint="https://i.embed.ly/1/display/resize",this.saveProvidersForScripts=[S,b]}static clearCache(){Embedly.embedCache={},Embedly.imageCache={}}async getType(e){const t=await this.fetchFromCache(e);if(t)return t.type;try{const t=await this.getEmbedDetails(e);if(t.type===g.z.rich||t.type===g.z.video)return t.type}catch(e){if(401!==e.status_code&&404!==e.status_code&&501!==e.status_code&&!(e instanceof InvalidImageEmbed))return g.z.error}try{return await this.getImageDetails(e),g.z.photo}catch(e){}return g.z.error}async fetchFromCache(e){const t=await this.getDisplayUrl(e),n=Embedly.imageCache[t];if(n)return n;const i=await this.getOEmbedUrl(e),s=Embedly.embedCache[i];return s||null}async getMediaDetails(e,t){switch(e){case g.z.photo:return this.getImageDetails(t);case g.z.rich:case g.z.video:return this.getEmbedDetails(t)}throw Error("unsupported media type")}async getOEmbedUrl(e){const t=Math.max(window.screen.height,window.screen.width),n=`&maxwidth=${t}&maxheight=${t}`;return`${this.embedEndpoint}?key=${this.key}&url=${encodeURIComponent(e)}${n}`}async getEmbedDetails(e){const t=await this.getOEmbedUrl(e);return Embedly.embedCache[t]?Promise.resolve(Embedly.embedCache[t]):this.loadEmbed(t)}async getDisplayUrl(e){const t=Math.max(window.screen.height,window.screen.width),n=`&url=${encodeURIComponent(e)}&width=${t}&height=${t}`;return`${this.imageEndpoint}?key=${this.key}${n}`}async getImageDetails(e){const t=await this.getDisplayUrl(e);return Embedly.imageCache[t]?Promise.resolve(Embedly.imageCache[t]):this.loadImage(t)}loadEmbed(e){return this.queue.get(e,{responseType:"json"}).then((t=>this.validateAndCacheEmbed(e,t)))}loadImage(e){return new Promise(((t,n)=>this.queue.get(e,{responseType:"arraybuffer"}).then((t=>this.validateAndCacheImage(e,t))).then(t).catch(n)))}validateAndCacheEmbed(e,t){const n=!!(!t.html||!t.html.match(/<script/i))||this.saveProvidersForScripts.includes(t.provider_name);if(!(t.type!==g.z.photo||t.html&&n))throw new InvalidImageEmbed('image can\'t be used as a "rich" type');if(!t||t.type===g.z.rich&&(!t.html||!n))throw new InvalidHtmlError("missing html or html contains Javascript");switch(t.type){case g.z.photo:t.html&&(t.type=g.z.rich);break;case g.z.rich:case g.z.video:break;case g.z.link:{const e="not supporting link types because of existing link functionality";throw y.debug(e),new UnsupportedTypeError(e)}default:{const e=`Did the OEmbed format extend?! Unknown type: ${t.type}`;throw y.debug(e),new UnsupportedTypeError(e)}}const i=(void 0===t.height||void 0===t.width)&&t.thumbnail_width&&t.thumbnail_height,s=i?t.thumbnail_width:t.width,r=i?t.thumbnail_height:t.height,o=t.provider_name,a={width:s,height:r,embedlyResponse:{html:t.html,src:t.url,provider:o},type:t.type};return Embedly.embedCache[e]=a,a}validateAndCacheImage(e,t){return new Promise(((n,i)=>{t||i("Embedly: got an empty response when requesting image");const s=new Uint8Array(t),r=new Blob([s]),o=new Image;o.addEventListener("load",(t=>function(t){const i=t.target,s={width:i.naturalWidth,height:i.naturalHeight,embedlyResponse:{url:a,src:e},type:g.z.photo};Embedly.imageCache[e]=s,n(s)}(t)));const a=URL.createObjectURL(r);o.src=a}))}}Embedly.embedCache={},Embedly.imageCache={};const E=310;var T=n(4117);class OpenLinkEditorMessage extends T.v{constructor(e=!1){super(),this.urlFocus=e}}class CloseLinkEditorMessage extends T.v{}var w,x=n(43985),_=n(81402),M=n(36589),O=n(64921),A=n(17141),C=n(2252);!function(e){e[e.NOT_READY=1]="NOT_READY",e[e.CUED=2]="CUED",e[e.PLAYING=3]="PLAYING",e[e.PAUSED=4]="PAUSED"}(w||(w={}));var N=n(83773),D=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const I=new v.Z("mattertag-media");let L=class MattertagMedia extends s.Component{constructor(e){super(e),this.playerControls=null,this.handleClick=()=>{this.props.mediaType===g.z.photo&&this.props.onClickImage&&this.props.onClickImage()},this.onPlayerLoaded=e=>{this.playerControls=e,e.play()},this.setupPlayerControls=e=>{let t=w.NOT_READY;const n=()=>{t=w.CUED,this.onPlayerLoaded(a)},i=()=>{t=w.PLAYING},s=()=>{t=w.PAUSED},r=()=>{};try{e.on("ready",n),e.on("play",i),e.on("pause",s),e.on("ended",r)}catch(e){I.debug(e)}const o=(0,C.tq)(),a={play:()=>{if(e&&t!==w.NOT_READY&&!o)try{e.play()}catch(e){I.error(e)}},pause:()=>{if(e&&t!==w.NOT_READY)try{e.pause()}catch(e){I.debug(e)}}}},this.setEmbedContentRef=e=>{e&&!this.iframe&&this.createEmbed(e)},this.setContainerRef=e=>{this.mediaContainer=e,this.updateMaxDims()},this.updateMaxDims=()=>{if(this.mediaContainer&&this.props.mediaAspectRatio&&this.props.mediaType===g.z.video){const e=this.mediaContainer.getBoundingClientRect();this.setState({maxWidth:e.width,maxHeight:e.height})}},this.mediaStyles=()=>{const{width:e,height:t,mediaPayload:n,mediaType:i,mediaAspectRatio:s}=this.props,{maxWidth:r,maxHeight:o}=this.state,a={};if(n)switch(i){case g.z.photo:a.backgroundImage=n.url?`url('${n.url}')`:"none";case g.z.rich:void 0!==e&&(a.width=`${e}px`),void 0!==t&&(a.height=`${t}px`,n.provider===b?a.height=`${t+54}px`:a.height=`${t}px`);break;case g.z.video:if(void 0!==e&&void 0!==t){const n=(0,N.lZ)(e,t);a.width=`${e}px`,a.height=`${n}px`}else if(r&&o&&void 0!==s){const e=Math.min(o,(0,N.lZ)(r,r/s)),t=e*s;a.width=`${t}px`,a.height=`${e}px`}}return a},this.state={maxWidth:0,maxHeight:0}}componentDidMount(){this.props.mediaAspectRatio&&this.props.mediaType===g.z.video&&(window.addEventListener("resize",this.updateMaxDims),this.updateMaxDims())}componentWillUnmount(){this.props.mediaAspectRatio&&this.props.mediaType===g.z.video&&window.removeEventListener("resize",this.updateMaxDims)}UNSAFE_componentWillReceiveProps(e){e.mediaPayload!==this.props.mediaPayload&&this.iframe&&this.iframe.parentNode&&(this.iframe.parentNode.removeChild(this.iframe),this.iframe=null),this.playerControls&&this.props.closing!==e.closing&&(e.closing?this.playerControls.pause():this.playerControls.play())}createEmbed(e){const{mediaType:t,mediaPayload:n,width:i,height:s}=this.props,{html:r,provider:o,src:a}=n,l=document.createElement("div");l.innerHTML=r;let c=l.firstChild;if("iframe"!==c.tagName.toLowerCase()){if(c=document.createElement("iframe"),!("srcdoc"in c))return I.warn(`Browser does not support srcdoc, refusing to embed ${r}`),void(this.iframe=null);let e,t;void 0!==i&&(c.width=i.toString()),void 0!==s&&(c.height=s.toString()),c.setAttribute("allow","encrypted-media; autoplay; fullscreen"),c.classList.add("tag-iframe-sandbox","loading"),c.onload=()=>c.classList.remove("loading"),e=o===S&&void 0!==a?`<img src=${a} />`:r,t=o===b?"\n          <style>\n            html, body { padding: 0; margin: 0; border: 0; }\n            img { display: block; max-width: 100%; height: auto; border: 0; }\n            iframe { display: block; max-width: 100%; border: 0; }\n          </style>\n        ":"\n          <style>\n            html, body { padding: 0; margin: 0; border: 0; }\n            img, iframe { display: block; max-width: 100%; height: auto; border: 0; }\n          </style>\n        ";const n=t.replace(/\s+/g," ");c.srcdoc=`<!doctype html>${n}${e}`}else{const e=c.style;e.maxWidth="100%",e.maxHeight="100%",e.minWidth="",e.minHeight=""}if(t===g.z.video&&c.src)try{const e=new A.Player(c);c.addEventListener("load",(()=>this.setupPlayerControls(e)))}catch(e){I.error(e)}this.iframe=c,e.appendChild(c)}render(){const{mediaPayload:e,mediaType:t}=this.props;if(!e)return null;const n=o()({"tag-image":t===g.z.photo,"tag-embed":t===g.z.rich,"tag-video":t===g.z.video}),s=e&&e.html?(0,i.jsx)("div",{className:"tag-embed-content",ref:this.setEmbedContentRef}):null;return(0,i.jsx)("div",Object.assign({ref:this.setContainerRef,className:"tag-media-content",onClick:this.handleClick},{children:(0,i.jsx)("div",Object.assign({className:n,style:this.mediaStyles()},{children:s}))}))}};L=D([f.Z],L);const P=L;var R=n(7383),k=n(91183),U=n(86823),B=n(56829),F=n(13508),V=n(10854);const{MATTERTAGS:H}=V.Z.WORKSHOP;class EditableDescription extends s.Component{constructor(e){super(e),this.textParser=new O.v({links:!0}),this.inputDiv=(0,s.createRef)(),this.getInputDiv=()=>this.inputDiv.current,this.hasTextSelected=()=>this.range&&this.range.startOffset!==this.range.endOffset,this.onSelectionChange=()=>{const e=this.getCurrentSelection();e&&(this.range=e.cloneRange())},this.addFauxHighlight=()=>{this.execCommand("backColor","#ff315840")},this.removeFauxHighlight=()=>{this.execCommand("backColor","transparent")},this.prepareLinkSelection=()=>{const e=this.getAnchorFromSelection();let t=null;const n=window.getSelection();return n&&(e||this.range||!this.inputDiv.current?(this.addFauxHighlight(),e||(t=this.range?this.range.toString():n.toString())):(this.inputDiv.current.focus(),n.selectAllChildren(this.inputDiv.current),n.collapseToEnd(),this.range=n.getRangeAt(0),t=this.range.toString())),e||(t||"")},this.onMouseDown=e=>{e.stopPropagation(),this.removeFauxHighlight(),this.range=null},this.onKeyDown=e=>{const t=e.which||e.keyCode;return e.stopPropagation(),t===x.R.ESCAPE?this.props.onNavigationKey(e):t===x.R.RETURN||t===x.R.TAB?(e.shiftKey||(e.preventDefault(),this.finalizeInput()),this.props.onNavigationKey(e)):void 0},this.onKeyPress=e=>{const{maxLength:t}=this.props;if(t&&this.range&&this.inputDiv&&this.inputDiv.current){const[n,i]=this.textParser.getHTMLWithoutSelection(this.inputDiv.current,this.range),s=this.getTextInsertion(e,n,i);this.textParser.serializeHTMLToMarkdown(`${n}${s}${i}`).length>t&&e.preventDefault()}},this.onInput=()=>{this.props.updateLength()},this.onPaste=e=>{e.preventDefault();const{maxLength:t}=this.props,n=(e.clipboardData||window.clipboardData).getData("text/plain");if(t){if(this.inputDiv.current&&this.range){const[e,i]=this.textParser.getHTMLWithoutSelection(this.inputDiv.current,this.range),s=s=>this.textParser.serializeHTMLToMarkdown(`${e}${n.slice(0,s)}${i}`).length<=t,r=(0,F.$)(n.length,s);if(r>=0){const e=n.slice(0,r);document.execCommand("insertHTML",!1,e)}}}else document.execCommand("insertHTML",!1,n)},this.onFocus=e=>{this.inputDiv.current&&(this.context.messageBus.broadcast(new B.SN(this.inputDiv.current,!0)),this.props.onFocus&&this.props.onFocus())},this.onBlur=()=>{this.inputDiv.current&&(this.context.messageBus.broadcast(new B.SN(this.inputDiv.current,!1)),this.props.onBlur&&this.props.onBlur(),this.finalizeInput())};const t=new k.gm((()=>({})),(e=>document.addEventListener("selectionchange",e)),(e=>document.removeEventListener("selectionchange",e)));this.selectionSubscription=t.createSubscription(this.onSelectionChange)}componentDidMount(){const{description:e,onLinkClick:t}=this.props,n=this.getInputDiv();this.textParser.deserialize(e,!0,t).forEach((e=>{null==n||n.appendChild(e)})),this.selectionSubscription.renew(),setTimeout((()=>{this.props.updateLength()}),0)}componentDidUpdate(e){e.description!==this.props.description&&this.props.updateLength()}componentWillUnmount(){var e;this.selectionSubscription.cancel(),null===(e=this.inputDiv.current)||void 0===e||e.blur()}shouldComponentUpdate(){return!1}getCurrentSelection(){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0);if(this.inputDiv.current&&(this.inputDiv.current===t.commonAncestorContainer||this.inputDiv.current.compareDocumentPosition(t.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY))return t}return null}linkify(e,t){const{descriptionLength:n,maxLength:i}=this.props,s=`link_${Date.now()}`,r=this.createAnchor(e,t);r.id=s;const o=this.textParser.serializeHTMLToMarkdown(r.outerHTML);if(i&&o.length+n>i)return this.context.locale.t(H.LINK_EDITOR_MAX_LENGTH_TIP);this.execCommand("backColor","transparent"),this.execCommand("insertHTML",r.outerHTML);const a=document.getElementById(s);return a&&(a.onclick=this.props.onLinkClick),!1}unlink(e){const t=e.parentNode,n=e.textContent;t&&(t.removeChild(e),n&&!(0,U.j)(n)&&this.execCommand("insertText",n))}updateLink(e,t,n){const{descriptionLength:i,maxLength:s,updateLength:r}=this.props,{serializeHTMLToMarkdown:o}=this.textParser,a=this.createAnchor(t,n),l=o(a.outerHTML),c=o(e.outerHTML);return i+(l.length-c.length)>s?this.context.locale.t(H.LINK_EDITOR_MAX_LENGTH_TIP):(e.href=a.href,e.text=a.text,e.setAttribute("data-value",n),r(),!1)}createAnchor(e,t){const n=document.createElement("a");return n.href=t,n.text=this.textParser.sanitizeText(e),n.classList.add(O.o.LINK),n.setAttribute("data-value",t),n}applyRange(){if(this.range){const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(this.range))}}execCommand(e,t){this.range&&(this.applyRange(),document.execCommand(e,!1,t),this.onSelectionChange())}getAnchorFromSelection(){const e=this.getCurrentSelection();if(!e)return null;let t=e.commonAncestorContainer;for(;t&&"A"!==t.nodeName;){if(t===this.inputDiv.current)return null;t=t.parentNode}return t||null}finalizeInput(){var e;this.props.onFinalizeInput(),null===(e=this.inputDiv.current)||void 0===e||e.blur()}getTextInsertion(e,t,n){if((e.which||e.keyCode)!==x.R.RETURN)return e.key;const i=t.slice(-1),s=n.slice(0,1);return"\n"===i||"\n"===s?"\n":"\n\n"}render(){return(0,i.jsx)("div",{ref:this.inputDiv,className:"inputDiv","data-placeholder":this.props.placeholder,onMouseDown:this.onMouseDown,onKeyDown:this.onKeyDown,onKeyPress:this.onKeyPress,onPaste:this.onPaste,contentEditable:!0,onInput:this.onInput,onFocus:this.onFocus,onBlur:this.onBlur})}}EditableDescription.contextType=a.I;var j=n(87982),G=n(78576),z=n(70329),W=n(29605),K=n(61445);const{MATTERTAGS:Y}=V.Z.WORKSHOP;class LinkEditor extends s.Component{constructor(e){super(e),this.elementRef=(0,s.createRef)(),this.urlInputRef=(0,s.createRef)(),this.textInputRef=(0,s.createRef)(),this.open=e=>{this.elementRef.current&&this.elementRef.current.classList.add("open"),this.focus(e.urlFocus)},this.close=()=>{this.urlInputRef.current&&this.urlInputRef.current.blur(),this.textInputRef.current&&this.textInputRef.current.blur(),this.setState({currentText:"",currentUrl:"",validUrl:!0,errorMessage:void 0}),this.elementRef.current&&this.elementRef.current.classList.remove("open")},this.onEditedUrl=e=>{const{validUrl:t,currentText:n}=this.state;if(!t)return;const i=""!==n?n:e,s=this.props.onSaveLink(i,e);this.setState({errorMessage:s})},this.onInputUrl=e=>{this.setState({validUrl:(0,U.j)(e),currentUrl:e,errorMessage:void 0})},this.onEditedText=e=>{this.focus(!0)},this.onInputText=e=>{this.setState({currentText:e,errorMessage:void 0})},this.onApply=e=>{this.state.currentUrl&&this.onEditedUrl(this.state.currentUrl)},this.onClose=e=>{this.close(),this.props.onCancel()},this.onPreviewUrl=()=>{this.state.validUrl&&window.open(this.state.currentUrl,"_blank")},this.stopPropagation=e=>{e.stopPropagation()},this.state={currentUrl:e.linkUrl,currentText:e.linkText,validUrl:!0,errorMessage:void 0}}componentDidMount(){this.context.messageBus.subscribe(OpenLinkEditorMessage,this.open),this.context.messageBus.subscribe(CloseLinkEditorMessage,this.close)}componentWillUnmount(){this.close(),this.context.messageBus.unsubscribe(OpenLinkEditorMessage,this.open),this.context.messageBus.unsubscribe(CloseLinkEditorMessage,this.close)}componentDidUpdate(e){this.props.linkUrl!==e.linkUrl&&this.setState({currentUrl:this.props.linkUrl}),this.props.linkText!==e.linkText&&this.setState({currentText:this.props.linkText})}focus(e=!1){e?this.urlInputRef.current&&this.urlInputRef.current.focus():this.textInputRef.current&&this.textInputRef.current.focus()}renderButtons(){const{locale:e}=this.context,{validUrl:t,currentUrl:n}=this.state,{onRemoveLink:s,linkText:r,linkUrl:o}=this.props,a=""!==r&&""!==o,l=!n||!t?K.BN.DISABLED:K.BN.ENABLED,c=e.t(Y.LINK_EDITOR_APPLY_CTA),d=e.t(Y.LINK_EDITOR_REMOVE_TIP);return(0,i.jsxs)("div",Object.assign({className:"popover-footer"},{children:[this.renderValidationMessage(),a&&(0,i.jsx)(j.hU,{iconClass:"icon-delete",buttonStyle:j.Dd.CLEAR,tooltipMsg:d,tooltipPosition:G.lZ.UP,onClick:s}),(0,i.jsx)(K.zx,Object.assign({className:"button-inline",buttonStyle:K.ZJ.CLEAR,buttonSize:K.qE.SMALL,buttonState:l,onClick:this.onApply},{children:c}))]}))}renderValidationMessage(){const{locale:e}=this.context,{linkText:t,linkUrl:n}=this.props,{validUrl:s,currentUrl:r,errorMessage:o}=this.state,a=""===t&&""===n&&""===r;return o?(0,i.jsx)("div",Object.assign({className:"popover-message popover-message-error"},{children:o})):!s&&r?(0,i.jsx)("div",Object.assign({className:"popover-message popover-message-error"},{children:e.t(Y.LINK_EDITOR_INVALID_TIP)})):(0,i.jsx)("div",Object.assign({className:"popover-message"},{children:a&&e.t(Y.LINK_EDITOR_TIP_TEXT)}))}render(){const{locale:e}=this.context,{validUrl:t,currentText:n,currentUrl:s}=this.state,r=e.t(Y.LINK_EDITOR_TEXT_LABEL),o=e.t(Y.LINK_EDITOR_URL_LABEL),a=e.t(Y.LINK_EDITOR_PREVIEW_TIP);return(0,i.jsxs)("div",Object.assign({ref:this.elementRef,className:"annotation-popup link-editor",onClick:this.stopPropagation},{children:[(0,i.jsxs)("div",Object.assign({className:"popover-header"},{children:[(0,i.jsx)("div",Object.assign({className:"popover-label"},{children:r})),(0,i.jsx)(z.P,{buttonStyle:z.A.LIGHT,onClose:this.onClose})]})),(0,i.jsx)(W.Z,{ref:this.textInputRef,text:n,className:"text-field-dark",onBlur:this.onEditedText,onInput:this.onInputText}),(0,i.jsxs)("div",Object.assign({className:"url-field"},{children:[(0,i.jsx)("div",Object.assign({className:"popover-label"},{children:o})),(0,i.jsx)(W.Z,{ref:this.urlInputRef,text:s,type:"url",className:"text-field-dark",placeholder:"https://",onBlur:this.onEditedUrl,onInput:this.onInputUrl}),t&&s&&(0,i.jsx)(j.hU,{className:"preview-link",iconClass:"icon-ext-link",buttonStyle:j.Dd.PLAIN,tooltipMsg:a,tooltipPosition:G.lZ.UP,onClick:this.onPreviewUrl})]})),this.renderButtons()]}))}}LinkEditor.contextType=a.I;var q=n(18253),Z=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{MATTERTAGS:$}=V.Z.WORKSHOP;let Q=class EditableBillboardText extends s.Component{constructor(e){super(e),this.textParser=new O.v({links:!0}),this.editableDescriptionRef=(0,s.createRef)(),this.linkElement=null,this.onLabelEdit=e=>{const{manager:t,id:n,onEdited:i}=this.props;t.setLabel(n,e).then(i)},this.onLabelKeyPress=e=>{if(e.keyCode===x.R.ESCAPE)return this.props.onNavigationKey(e);if(e.stopPropagation(),e.keyCode===x.R.TAB){const e=this.editableDescriptionRef.current;if(e){const t=e.getInputDiv();t&&t.focus()}}return!1},this.updateDescriptionLength=()=>{const e=this.editableDescriptionRef.current;if(!e)return;const t=e.getInputDiv();if(!t)return;const n=this.textParser.serialize(t),i=n.length;this.props.onDescriptionInput((0,_.Yv)(n)),this.setState({descriptionLength:i})},this.onDescriptionEdited=()=>{const e=this.editableDescriptionRef.current;if(!e)return;const t=e.getInputDiv();if(t){const{manager:e,id:n,onEdited:i}=this.props,s=this.textParser.serialize(t);e.setDescription(n,s).then(i)}},this.onLabelFocus=()=>{this.closePopover()},this.onDescriptionFocus=()=>{this.setState({editingDescription:!0})},this.onDescriptionBlur=()=>{this.setState({editingDescription:!1})},this.closePopover=()=>{this.setState({linkUrl:"",linkText:""}),this.linkElement=null,this.props.onClosePopover()},this.linkClicked=e=>{if(e.preventDefault(),this.props.linkEditorOpen)this.closePopover();else{e.stopPropagation(),this.linkElement=e.target;const{href:t,text:n}=this.linkElement;this.setState({linkUrl:t,linkText:n}),this.props.onClickLink()}},this.onRemoveLink=()=>{this.onSaveLink("","")},this.onSaveLink=(e,t)=>{let n;const i=this.editableDescriptionRef.current;if(this.linkElement&&i?""!==t?n=i.updateLink(this.linkElement,e,t):i.unlink(this.linkElement):i&&(n=i.linkify(e,t)),n&&"string"==typeof n)return n;this.closePopover(),this.onDescriptionEdited()},this.state={editingDescription:!1,descriptionLength:0,linkUrl:"",linkText:""}}prepareNewLinkSelection(){const e=this.editableDescriptionRef.current;if(!e)return!1;const t=e.prepareLinkSelection();let n,i;return"string"==typeof t?(this.linkElement=null,n="",i=t):(this.linkElement=t,n=t.href,i=t.text),this.setState({linkUrl:n,linkText:i}),""!==i&&""===n}render(){const{locale:e}=this.context,{linkUrl:t,linkText:n,editingDescription:s,descriptionLength:r}=this.state,{label:a,linkEditorOpen:l,onNavigationKey:c,description:d}=this.props,u=`${r}/${q.Us}`,h=e.t($.TITLE_PLACEHOLDER),p=e.t($.DESCRIPTION_PLACEHOLDER);return(0,i.jsxs)("div",Object.assign({className:"editable-text-content"},{children:[(0,i.jsx)("div",Object.assign({className:"mattertag-label-editor"},{children:(0,i.jsx)(R.Z,{text:a,placeholder:h,onEdited:this.onLabelEdit,onInput:this.onLabelEdit,onKeyPress:this.onLabelKeyPress,maxLength:60,closeOnFocusOut:!0,textarea:!0,fractionalCounter:!0,onStartEditing:this.onLabelFocus})})),(0,i.jsx)("div",Object.assign({className:"editable-tag-description"},{children:(0,i.jsx)("div",Object.assign({className:o()("modifiable-text fractional-counter",{editing:s||l,empty:0===r}),"data-fractional-counter":u},{children:(0,i.jsx)(EditableDescription,{ref:this.editableDescriptionRef,maxLength:q.Us,descriptionLength:r,placeholder:p,description:d,updateLength:this.updateDescriptionLength,onFinalizeInput:this.onDescriptionEdited,onNavigationKey:c,onLinkClick:this.linkClicked,onFocus:this.onDescriptionFocus,onBlur:this.onDescriptionBlur})}))})),(0,i.jsx)(LinkEditor,{linkUrl:t,linkText:n,onCancel:this.closePopover,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink})]}))}};Q.contextType=a.I,Q=Z([f.A],Q);var X=n(88629),J=n(39706),ee=n(48558),te=n(8428),ne=n(93510);const{MATTERTAGS:ie}=V.Z.WORKSHOP;class StemSlider extends s.Component{constructor(e){super(e),this.sliderRef=(0,s.createRef)(),this.setStemValue=(e,t=!0)=>{const n=t?(0,ee._F)(e):e;if(n!==this.props.stemHeight){const{manager:e,sid:t,onEdited:i}=this.props;e.setStemHeight(t,n).then(i)}},this.onClickReset=()=>{const e=this.sliderRef.current;e&&(this.setStemValue(this.state.originalStemHeight,!1),e.setValue((0,ee.zy)(this.state.originalStemHeight)))},this.onToggleStemVisibility=()=>{const{manager:e,sid:t,stemVisible:n,onEdited:i}=this.props;e.setStemVisibility(t,!n).then(i)},this.stopPropagation=e=>{e.stopPropagation()},this.updateUnits=()=>{this.setState({units:this.context.settings.tryGetProperty(te.gx.Units,ne.M.IMPERIAL)})},this.formatStemHeight=e=>{if(this.state.units===ne.M.IMPERIAL)return(0,J.KQ)(e);return`${Math.round(100*(0,ee._F)(e))/100}m`},this.state={originalStemHeight:e.stemHeight,units:ne.M.IMPERIAL}}componentDidMount(){const e=this.sliderRef.current;e&&e.setValue((0,ee.zy)(this.props.stemHeight)),this.context.settings.onPropertyChanged(te.gx.Units,this.updateUnits),this.updateUnits()}componentWillUnmount(){this.context.settings.removeOnPropertyChanged(te.gx.Units,this.updateUnits)}render(){const{locale:e}=this.context,{stemVisible:t,stemHeight:n}=this.props,{originalStemHeight:s}=this.state,r=s!==n,a=e.t(ie.STEM_SLIDER_RESET_CTA),l=e.t(ie.SHOW_STEM_LABEL);return(0,i.jsxs)("div",Object.assign({className:"editable-popover stem-popover",onClick:this.stopPropagation},{children:[(0,i.jsx)(X.S,{ref:this.sliderRef,discrete:!1,min:0,max:9,initialValue:(0,ee.zy)(s),onInput:this.setStemValue,displayBounds:!0,width:150,formatNumbers:this.formatStemHeight,tooltipPosition:X.h.DOWN}),(0,i.jsx)("div",Object.assign({className:o()("link-btn","popover-btn","stem-slider-reset",{disabled:!r}),onClick:this.onClickReset},{children:a})),(0,i.jsx)("hr",{}),(0,i.jsxs)("div",Object.assign({className:"stem-checkbox",onClick:this.onToggleStemVisibility},{children:[(0,i.jsx)("div",{className:o()("checkbox icon-checkmark",{checked:t})}),(0,i.jsx)("div",Object.assign({className:"checkbox-text"},{children:l}))]}))]}))}}StemSlider.contextType=a.I;var se=n(99612);const re=["#d44441","#f44336","#e91e63","#f78da7","#9c4b92","#673ab7","#03687d","#03a9f4","#00bcd4","#417505","#51a868","#37d67a","#cddc39","#fbcd00","#ffac17","#ff6900","#abb8c3","#607d8b"];class DiscColorPicker extends s.Component{constructor(e){super(e),this.handleColorPicked=e=>{const{manager:t,sid:n,onEdited:i}=this.props;t.setColor(n,e).then(i)},this.stopPropagation=e=>{e.stopPropagation()}}render(){const{color:e}=this.props;return(0,i.jsx)("div",Object.assign({className:"editable-popover color-editor",onClick:this.stopPropagation},{children:(0,i.jsx)(se.z,{colors:re,defaultColor:e,onColorPicked:this.handleColorPicked})}))}}const{MATTERTAGS:oe}=V.Z.WORKSHOP;var ae;!function(e){e[e.NONE=0]="NONE",e[e.INVALID_URL_SYNTAX=1]="INVALID_URL_SYNTAX",e[e.LOADING=2]="LOADING",e[e.LOADED=3]="LOADED",e[e.ERROR=4]="ERROR"}(ae||(ae={}));class MediaLinkInput extends s.Component{constructor(e){super(e),this.isUnmounting=!1,this.onInput=e=>{const t=(0,U.j)(e)?ae.NONE:ae.INVALID_URL_SYNTAX;this.setState({validationPhase:t,currentUrl:e})},this.onApply=()=>{this.applyDisabled||this.onChangeMedia(this.state.currentUrl)},this.stopPropagation=e=>{e.stopPropagation()},this.onChangeMedia=async e=>{const{sid:t,mediaSrc:n,onEdited:i,manager:s}=this.props;if(e!==n){const n=await this.loadMedia(e);if(n!==g.z.error){if(await s.setEmbed(t,e,n),this.isUnmounting)return;this.setState({validationPhase:ae.LOADED}),i()}else{if(this.isUnmounting)return;this.setState({validationPhase:ae.ERROR})}}else this.props.onCancel()},this.loadMedia=async e=>{let t=g.z.none;return this.setState({validationPhase:ae.NONE}),e&&(this.setState({validationPhase:ae.LOADING}),t=await this.props.embedlyValidator.getType(e)),t},this.state={currentUrl:e.mediaSrc,validationPhase:this.getInitialValidationPhase()}}componentWillUnmount(){this.isUnmounting=!0}getInitialValidationPhase(){return this.props.mediaType===g.z.error?ae.ERROR:this.props.mediaSrc?ae.LOADED:ae.NONE}UNSAFE_componentWillReceiveProps(e){this.props.mediaSrc!==e.mediaSrc&&this.setState({currentUrl:e.mediaSrc})}render(){const{locale:e}=this.context,{onCancel:t}=this.props,{currentUrl:n}=this.state,s=e.t(oe.MEDIA_LINK_LABEL),r=e.t(oe.MEDIA_LINK_SUPPORTED_FORMATS_LINK);return(0,i.jsxs)("div",Object.assign({className:"annotation-popup open media-editor",onClick:this.stopPropagation},{children:[(0,i.jsxs)("div",Object.assign({className:"popover-header"},{children:[(0,i.jsxs)("div",Object.assign({className:"popover-label"},{children:[s,(0,i.jsx)("a",Object.assign({className:"link",target:"_blank",href:MediaLinkInput.supportPage},{children:r}))]})),(0,i.jsx)(z.P,{buttonStyle:z.A.LIGHT,onClose:t})]})),(0,i.jsx)(W.Z,{text:n,type:"url",className:"text-field-dark",placeholder:"https://",onDone:this.onChangeMedia,onInput:this.onInput}),this.renderPopoverFooter()]}))}get applyDisabled(){const{mediaSrc:e}=this.props,{validationPhase:t,currentUrl:n}=this.state;return t===ae.ERROR||t===ae.LOADING||t===ae.INVALID_URL_SYNTAX&&""!==n||n===e&&""===n}renderPopoverFooter(){const{locale:e}=this.context,t=this.applyDisabled?K.BN.DIMMED:K.BN.ENABLED,n=e.t(oe.MEDIA_LINK_APPLY_CTA);return(0,i.jsxs)("div",Object.assign({className:"popover-footer"},{children:[this.renderValidationMessage(),(0,i.jsx)(K.zx,Object.assign({className:"button-inline",buttonStyle:K.ZJ.CLEAR,buttonSize:K.qE.SMALL,buttonState:t,onClick:this.onApply},{children:n}))]}))}renderValidationMessage(){const{locale:e}=this.context;switch(this.state.validationPhase){case ae.ERROR:return(0,i.jsxs)("div",Object.assign({className:"popover-message popover-message-error"},{children:[e.t(oe.MEDIA_LINK_ERROR_MESSAGE),(0,i.jsx)("a",Object.assign({className:"link",target:"_blank",href:MediaLinkInput.supportPage},{children:e.t(oe.MEDIA_LINK_HELP_LINK)}))]}));case ae.LOADING:return(0,i.jsx)("div",Object.assign({className:"popover-message"},{children:e.t(oe.MEDIA_LINK_LOADING_MESSAGE)}));case ae.INVALID_URL_SYNTAX:if(""!==this.state.currentUrl)return(0,i.jsx)("div",Object.assign({className:"popover-message popover-message-error"},{children:e.t(oe.MEDIA_LINK_INVALID_URL_MESSAGE)}))}return(0,i.jsx)("div",{className:"popover-message"})}}MediaLinkInput.contextType=a.I,MediaLinkInput.supportPage="https://support.matterport.com/hc/en-us/articles/115006363868-Add-Multimedia-to-a-Mattertag-Post";var le=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{MATTERTAGS:ce}=V.Z.WORKSHOP;var de;!function(e){e.COLOR="color",e.STEM="stem",e.MEDIA="media",e.LINK="text-link"}(de||(de={}));let ue=class EditableBillboardContent extends s.Component{constructor(e){super(e),this.textParser=new O.v({links:!0}),this.getColorStyle=()=>{const e=this.props.getSavedData().color;if(e)return{backgroundColor:e}},this.toggleVisibility=()=>{const{id:e,manager:t}=this.props;this.closePopover();const n=this.state.currentValues.visible;t.setVisibility(e,!n).then(this.onEdited)},this.onEdited=()=>{const e=this.props.getSavedData();e&&this.setState({currentValues:e,tagEmpty:this.props.manager.isTagEmpty(this.props.id)})},this.onMediaEdited=()=>{this.onEdited(),this.closePopover()},this.onMediaCancel=()=>{this.closePopover()},this.cancelEdits=()=>{this.props.manager.revertChanges()},this.doneEditing=()=>{const{manager:e,id:t}=this.props;e.saveMattertag(t)},this.onAddLinkClicked=e=>{if(e.stopPropagation(),this.state.popover===de.LINK)this.closePopover();else if(this.state.linkCount<5){const e=this.billboardText.prepareNewLinkSelection();this.openLinkEditor(e)}},this.onClickLink=()=>{this.openLinkEditor(!1)},this.onDescriptionInput=e=>{const t=this.props.getSavedData(),n=(0,_.Yv)(t.label)&&(0,_.Yv)(t.mediaSrc)&&e;this.updateLinkCount(this.props.description),this.setState({tagEmpty:n})},this.onNavigationKey=e=>{e.keyCode===x.R.ESCAPE&&this.cancelEdits()},this.billboardClick=e=>{e.stopPropagation();const{popover:t}=this.state;t===de.LINK||t===de.MEDIA||this.closePopover()},this.closePopover=()=>{const{popover:e}=this.state;null!==e&&this.setPopover(e,!1)},this.setBillboardTextRef=e=>{this.billboardText=e};const t=e.getSavedData();this.state={popover:null,linkCount:0,currentValues:Object.assign({},t),tagEmpty:e.manager.isTagEmpty(e.id)},this.clickColor=this.clickMenuIcon.bind(this,de.COLOR),this.clickStem=this.clickMenuIcon.bind(this,de.STEM),this.clickMedia=this.clickMenuIcon.bind(this,de.MEDIA)}componentDidMount(){this.context.analytics.trackToolGuiEvent("mattertags","mattertag_editor_opened"),this.updateLinkCount(this.props.description)}componentDidUpdate(e,t){const n=this.props.manager.dataMap.mattertagsViewData.toolState;t.tagEmpty&&!this.state.tagEmpty&&n===d.rI.PLACED&&this.props.manager.dataMap.mattertagsViewData.setToolState(d.rI.EDITING),this.updateLinkCount(this.props.description)}setPopover(e,t){const n=this.state.popover,i=t?e:null;n!==i&&n===de.LINK&&this.context.messageBus.broadcast(new CloseLinkEditorMessage),this.setState({popover:i})}openLinkEditor(e){this.setPopover(de.LINK,!0),this.context.messageBus.broadcast(new OpenLinkEditorMessage(e))}updateLinkCount(e){let t=0;const n=this.textParser.parse(e);for(const e of n)e.blockType===M.C.LINK&&t++;this.setState({linkCount:t})}clickMenuIcon(e,t){t.stopPropagation(),this.setPopover(e,this.state.popover!==e)}render(){const{locale:e}=this.context,{tagEmpty:t,popover:n}=this.state,s=null!==n,r=n===de.LINK||n===de.MEDIA,a=e.t(ce.EDIT_BILLBOARD_CANCEL_CTA),l=e.t(ce.EDIT_BILLBOARD_DONE_CTA);return(0,i.jsxs)("div",Object.assign({className:o()("editable-billboard-body",{"popover-open":s,"url-popover-open":r}),onClick:this.billboardClick},{children:[(0,i.jsxs)("div",Object.assign({className:"editable-billboard-content",onClick:this.billboardClick},{children:[this.renderTextContent(),this.renderMattertagMedia(),this.renderActivePopover()]})),(0,i.jsxs)("div",Object.assign({className:"billboard-footer",onClick:this.billboardClick},{children:[this.renderMenuItems(),(0,i.jsxs)("div",Object.assign({className:"billboard-cta"},{children:[(0,i.jsx)(K.zx,Object.assign({buttonStyle:K.ZJ.CLEAR,buttonSize:K.qE.SMALL,className:"button-inline",onClick:this.cancelEdits},{children:a})),(0,i.jsx)(K.zx,Object.assign({className:"button-inline",buttonStyle:K.ZJ.CLEAR,buttonSize:K.qE.SMALL,buttonState:t?K.BN.DISABLED:K.BN.ENABLED,onClick:this.doneEditing},{children:l}))]}))]}))]}))}renderActivePopover(){const{id:e,manager:t}=this.props,{popover:n,currentValues:s}=this.state,{stemVisible:r,stemHeight:o,color:a,mediaSrc:l,mediaType:c}=s;switch(n){case de.STEM:return(0,i.jsx)(StemSlider,{sid:e,stemVisible:r,stemHeight:o,onEdited:this.onEdited,manager:t});case de.COLOR:return(0,i.jsx)(DiscColorPicker,{sid:e,color:a,onEdited:this.onEdited,manager:t});case de.MEDIA:return(0,i.jsx)(MediaLinkInput,{sid:e,mediaSrc:l,mediaType:c,embedlyValidator:this.props.embedlyValidator,onEdited:this.onMediaEdited,onCancel:this.onMediaCancel,manager:t});default:return null}}renderMenuItems(){const{locale:e}=this.context,{manager:t,id:n,fullSized:s}=this.props,{popover:r,currentValues:a,linkCount:l}=this.state,{visible:c}=a,d=t.isNewTag(n),u=r===de.COLOR,h=r===de.STEM,p=r===de.MEDIA,m=r===de.LINK,f=l<5,g=e.t(f?ce.LINK_TOOLTIP_MESSAGE:ce.LINK_DISABLED_TOOLTIP_MESSAGE),v=s?G.lZ.UP:G.lZ.DOWN,y=m?K.BN.ACTIVE:f?K.BN.ENABLED:K.BN.DIMMED;return(0,i.jsxs)("div",Object.assign({className:"billboard-menu"},{children:[(0,i.jsx)(j.hU,{iconClass:"icon-link",className:o()("billboard-menu-item","add-link"),buttonState:y,buttonStyle:j.Dd.CLEAR,onClick:this.onAddLinkClicked,tooltipMsg:m?void 0:g,tooltipPosition:v}),(0,i.jsx)(j.hU,Object.assign({className:o()("billboard-menu-item","color"),buttonStyle:j.Dd.CLEAR,buttonState:u?K.BN.ACTIVE:K.BN.ENABLED,onClick:this.clickColor,tooltipMsg:u?void 0:e.t(ce.COLOR_TOOLTIP_MESSAGE),tooltipPosition:v},{children:(0,i.jsx)("span",{className:"color-dot",style:this.getColorStyle()})})),(0,i.jsx)(j.hU,{iconClass:"icon-stem-height",className:o()("billboard-menu-item","stem"),buttonStyle:j.Dd.CLEAR,buttonState:h?K.BN.ACTIVE:K.BN.ENABLED,onClick:this.clickStem,tooltipMsg:h?void 0:e.t(ce.STEM_TOOLTIP_MESSAGE),tooltipPosition:v}),(0,i.jsx)(j.hU,{iconClass:"icon-media-mix",className:o()("billboard-menu-item","media"),buttonStyle:j.Dd.CLEAR,buttonState:p?K.BN.ACTIVE:K.BN.ENABLED,onClick:this.clickMedia,tooltipMsg:p?void 0:e.t(ce.MEDIA_TOOLTIP_MESSAGE),tooltipPosition:v}),!d&&(0,i.jsx)(j.hU,{iconClass:c?"icon-eye-hide":"icon-eye-show",className:"billboard-menu-item",buttonStyle:j.Dd.CLEAR,onClick:this.toggleVisibility,tooltipMsg:e.t(c?ce.HIDE_TOOLTIP_MESSAGE:ce.SHOW_TOOLTIP_MESSAGE),tooltipPosition:v})]}))}renderTextContent(){const{popover:e}=this.state,{id:t,label:n,description:s,manager:r}=this.props,o=e===de.LINK;return(0,i.jsx)(Q,{id:t,ref:this.setBillboardTextRef,label:n,description:s,linkEditorOpen:o,onClickLink:this.onClickLink,onClosePopover:this.closePopover,onDescriptionInput:this.onDescriptionInput,onNavigationKey:this.onNavigationKey,onEdited:this.onEdited,manager:r})}renderMattertagMedia(){const{id:e,mediaType:t,closing:n,media:{hasMedia:s,mediaPayload:r},mediaAspectRatio:o}=this.props;return s?r?(0,i.jsx)(P,{mediaPayload:r,mediaType:t,mediaAspectRatio:o,closing:n},e):(0,i.jsx)("div",Object.assign({className:"loadingSpinner"},{children:(0,i.jsx)("div",{className:"gui-spinner-icon"})})):null}};ue.contextType=a.I,ue=le([f.Z],ue);var he=n(54929);class MouseThrough extends s.Component{constructor(e){super(e),this.mouseThroughElementRef=(0,s.createRef)(),this.eventsToSend={[MouseThrough.SendEvent.HOVER]:!1,[MouseThrough.SendEvent.CLICK]:!1,[MouseThrough.SendEvent.BUTTON]:!1},this.onHoverEvent=e=>{switch(e.type){case"mousemove":this.props.onMouseMove&&this.props.onMouseMove(e);break;case"mouseenter":this.props.onMouseEnter&&this.props.onMouseEnter(e);break;case"mouseleave":this.props.onMouseLeave&&this.props.onMouseLeave(e);break;case"pointermove":this.props.onMouseMove&&this.props.onMouseMove(e);break;case"pointerenter":this.props.onMouseEnter&&this.props.onMouseEnter(e);break;case"pointerleave":this.props.onMouseLeave&&this.props.onMouseLeave(e)}this.eventsToSend[MouseThrough.SendEvent.HOVER]&&this.isValidTarget(e.target)&&this.sendEventThrough(e.type,e)},this.isValidTarget=e=>{const t=this.mouseThroughElementRef.current;return!!t&&(e===t||this.props.includeChildrenEvents&&e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINS)},this.onClick=e=>{this.props.onClick&&this.props.onClick(e),this.eventsToSend[MouseThrough.SendEvent.CLICK]&&this.isValidTarget(e.target)&&(this.sendEventThrough("mousedown",e),window.setTimeout((()=>this.sendEventThrough("mouseup",e)),0))},this.onButtonEvent=e=>{switch(e.type){case"pointerdown":this.props.onPointerDown&&this.props.onPointerDown(e);break;case"pointerup":this.props.onPointerUp&&this.props.onPointerUp(e)}this.eventsToSend[MouseThrough.SendEvent.BUTTON]&&this.isValidTarget(e.target)&&this.sendEventThrough(e.type,e)},this.onClick=this.onClick.bind(this),this.target=e.clickTarget||document.getElementsByTagName("canvas")[0],this.registerEvents()}UNSAFE_componentWillReceiveProps(e){(0,he.NK)(this.props.sendEvents,e.sendEvents)&&this.registerEvents()}render(){return(0,i.jsx)("div",Object.assign({id:this.props.id,ref:this.mouseThroughElementRef,className:this.props.className,style:this.props.style||{},onMouseEnter:this.onHoverEvent,onMouseLeave:this.onHoverEvent,onMouseMove:this.onHoverEvent,onPointerEnter:this.onHoverEvent,onPointerLeave:this.onHoverEvent,onPointerMove:this.onHoverEvent,onMouseDown:this.onButtonEvent,onMouseUp:this.onButtonEvent,onPointerDown:this.onButtonEvent,onPointerUp:this.onButtonEvent,onClick:this.onClick},{children:this.props.children}))}registerEvents(){this.props.sendEvents.length&&(this.eventsToSend[MouseThrough.SendEvent.CLICK]=this.props.sendEvents.indexOf(MouseThrough.SendEvent.CLICK)>-1,this.eventsToSend[MouseThrough.SendEvent.HOVER]=this.props.sendEvents.indexOf(MouseThrough.SendEvent.HOVER)>-1,this.eventsToSend[MouseThrough.SendEvent.BUTTON]=this.props.sendEvents.indexOf(MouseThrough.SendEvent.BUTTON)>-1)}sendEventThrough(e,t){const n=t.nativeEvent;let i;try{i=window.PointerEvent?new PointerEvent(e,n):new MouseEvent(e,n)}catch(t){i=document.createEvent("MouseEvents");const s=n.view;if(!s)return;i.initMouseEvent(e,n.bubbles,n.cancelable,s,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget)}this.target.dispatchEvent(i)}}!function(e){let t;!function(e){e[e.HOVER=1]="HOVER",e[e.CLICK=2]="CLICK",e[e.BUTTON=3]="BUTTON"}(t=e.SendEvent||(e.SendEvent={}))}(MouseThrough||(MouseThrough={}));var pe=n(25551),me=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let fe=class MattertagDescription extends s.Component{constructor(e){super(e),this.formatLink=(e,t)=>ge(e,t,!1),this.linkClicked=e=>t=>{t.preventDefault(),this.props.onLinkClick(e);const{link:n}=e;if(void 0===n)return;switch(n.type){case pe.U.NAVIGATION:n.navigationData&&this.props.linkHandler.handler.openLink({pose:n.navigationData,fullLink:n.url});break;case pe.U.MODEL:try{const e=new URL(n.url);this.props.linkHandler.handler.openLink({modelId:e.searchParams.get("m")||"",fullLink:n.url})}catch(e){}break;case pe.U.EXT_LINK:this.context.messageBus.broadcast(new p.Ik(n.url)),this.props.linkHandler.handler.openLink(n.url)}}}render(){const{description:e,parsedDescription:t}=this.props;let n=e;return t&&t.length>0&&(n=ve(t,this.formatLink,this.linkClicked)),n?(0,i.jsx)("div",Object.assign({className:"tag-description"},{children:n})):null}};fe.contextType=a.I,fe=me([f.Z],fe);const ge=(e,t,n)=>{if(!e.link)return null;const s=e.link,r=s.type===pe.U.NAVIGATION?"Link to position within this model":"Link to external web site";return(0,i.jsxs)("a",Object.assign({className:"link-url",contentEditable:n,href:s.url,onClick:t(e)},{children:[s.label,(0,i.jsx)("i",{className:"icon-ext-link",title:r})]}),s.label)},ve=(e,t,n)=>e.map((e=>{switch(e.type){case g.z.link:if(e.link)return t(e,n);case g.z.text:return(e.text||"").replace("&zwnj;","")}return null}));var ye=n(39864),be=n(41920),Se=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Ee=class MattertagTextContent extends s.Component{constructor(e){super(e),this.scrollbarsRef=(0,s.createRef)(),this.state={height:null,descriptionHeight:0,scrollable:!1,determiningScrollability:!1,scrollClass:be.Ij.None},this.onScrollPositionChange=()=>{const e=this.scrollbarsRef.current;if(!e||this.state.determiningScrollability)return;const t=e.scrollPosition.vertical;this.setState({scrollClass:t})}}UNSAFE_componentWillReceiveProps(e){e.tagWidth!==this.props.tagWidth&&this.setState({height:null,scrollable:!0,determiningScrollability:!0})}componentDidMount(){this.determineScrollability()}componentDidUpdate(){this.state.determiningScrollability&&this.determineScrollability()}determineScrollability(){const e=this.textContainer&&this.textContainer.querySelector(".tag-description");let t={determiningScrollability:!1};if(this.props.description&&e){const n=this.props.mediaTag?65:159;if(e.scrollHeight>n+12){const e=this.textContainer&&this.textContainer.querySelector(".tag-label"),i=this.props.label?n+e.scrollHeight-5:n;t=Object.assign(Object.assign({},t),{height:i,scrollable:!0,scrollClass:be.Ij.Beginning})}else t=Object.assign(Object.assign({},t),{height:null,scrollable:!1,scrollClass:be.Ij.None})}this.setState(t)}render(){const{label:e,description:t,parsedDescription:n,onLinkClick:s}=this.props;if(e||t||n){const r=o()({"tag-text-content":!0,noScroll:!this.state.height||!this.state.scrollable,[this.state.scrollClass]:!0});return(0,i.jsx)("div",Object.assign({className:r,style:{height:this.state.scrollable&&this.state.height||"auto"},ref:e=>{this.textContainer=e}},{children:(0,i.jsxs)(ye.Z,Object.assign({name:"mattertag-text-content",forceHidden:!1,waitToUpdate:this.state.determiningScrollability,singleScrollDirection:be.Nm.vertical,ref:this.scrollbarsRef,onScrollPositionChange:this.onScrollPositionChange},{children:[e&&(0,i.jsx)("div",Object.assign({className:"tag-label",onClick:this.onBoundClick},{children:(0,i.jsx)("span",{children:e})})),(0,i.jsx)(fe,{description:t,parsedDescription:n,onLinkClick:s,linkHandler:this.props.linkHandler})]}))}))}return null}};Ee=Se([f.Z],Ee);const Te=Ee;var we=n(11208),xe=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let _e=class ReadonlyBillboardContent extends s.Component{constructor(e){super(e),this.clickBillboard=()=>{this.props.onClickBillboard()},this.onClickImage=()=>{this.props.allowTagOverlay?this.props.onOpenOverlay():this.props.onClickBillboard()}}render(){const{media:e,style:t,selected:n,allowTagOverlay:s,label:r,description:a,parsedDescription:l}=this.props;return(0,i.jsxs)("div",Object.assign({className:o()("billboard-body",{expandable:s}),onClick:this.clickBillboard},{children:[(0,i.jsxs)("div",Object.assign({className:"billboard-content",style:t.bodyStyle},{children:[(0,i.jsx)(Te,{label:r,description:a,parsedDescription:l,tagWidth:t.width,imgHeight:t.height,mediaTag:e.hasMedia,onLinkClick:this.props.onLinkClick,linkHandler:this.props.linkHandler}),this.renderMattertagMedia(),this.renderCustomWidget()]})),!n&&(0,i.jsx)(MouseThrough,{sendEvents:[MouseThrough.SendEvent.BUTTON],className:"hover-arrow"})]}))}renderMattertagMedia(){const{id:e,allowTagOverlay:t,mediaType:n,style:{width:s,height:r,closing:o},media:{hasMedia:a,mediaPayload:l}}=this.props;return a?l?(0,i.jsx)(P,{mediaPayload:l,mediaType:n,width:s,height:r,onClickImage:t?this.onClickImage:void 0,closing:o},e):(0,i.jsx)("div",Object.assign({className:"loadingSpinner"},{children:(0,i.jsx)("div",{className:"gui-spinner-icon"})})):null}renderCustomWidget(){if(this.props.customWidget)return(0,i.jsx)(we.l,{widget:this.props.customWidget})}};_e=xe([f.A],_e);var Me=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let Oe=class MattertagOverlay extends s.Component{constructor(e){super(e),this.scrollbarsRef=(0,s.createRef)(),this.toggleCollapseText=()=>{this.setState((e=>({collapsed:!e.collapsed})))},this.onScrollPositionChange=()=>{const e=this.scrollbarsRef.current;if(!e||this.state.determiningScrollability)return;const t=e.scrollPosition.vertical;this.setState({scrollClass:t})},this.updateScrollAndCollapse=()=>{const e=this.textContainer?this.textContainer.scrollHeight:0,t=this.textContainer&&this.textContainer.querySelector(".tag-description");let n={determiningScrollability:!1};if(e){const i=Math.max(e-41-this.state.overlayHeight,0),s=i>0,r=e-i,o=t&&t.scrollHeight-i,a=s?be.Ij.Beginning:be.Ij.None,l=t&&e>41;n=Object.assign(Object.assign({},n),{height:r,scrollable:s,descriptionHeight:o,scrollClass:a,collapsible:l})}this.setState(n)},this.updateOverlayDimensions=()=>{const{label:e,description:t,maxWidth:n,maxHeight:i,mediaAspectRatio:s}=this.props,r=n-24,o=i-24-(e||t?41:0),a=s<r/o;this.setState({overlayWidth:a?o*s:r,overlayHeight:a?o:r/s})},this.stopPropagation=e=>{e.stopPropagation()},this.state={overlayWidth:0,overlayHeight:0,collapsible:!!(e.description&&e.description.length>0),collapsed:!1,height:null,descriptionHeight:0,scrollable:!1,determiningScrollability:!1,scrollClass:be.Ij.None}}componentDidMount(){this.updateOverlayDimensions(),this.updateScrollAndCollapse()}componentDidUpdate(e,t){const n=e.mediaAspectRatio!==this.props.mediaAspectRatio,i=e.maxWidth!==this.props.maxWidth,s=e.maxHeight!==this.props.maxHeight;(n||i||s)&&(this.setState({determiningScrollability:!0,scrollable:!1,scrollClass:be.Ij.None,height:0}),window.requestAnimationFrame((()=>{this.updateOverlayDimensions(),this.updateScrollAndCollapse()})))}render(){const{mediaPayload:e,mediaType:t,closing:n}=this.props,{overlayWidth:s,overlayHeight:r,collapsible:a}=this.state;return(0,i.jsx)("div",Object.assign({className:"billboard-body",onClick:this.stopPropagation},{children:(0,i.jsxs)("div",Object.assign({className:o()("billboard-content",{collapsible:a})},{children:[this.renderOverlayText(),(0,i.jsx)(P,{mediaPayload:e,mediaType:t,width:s,height:r,closing:n})]}))}))}renderOverlayText(){const{label:e,description:t,parsedDescription:n,onLinkClick:s,closeImageOverlay:r}=this.props,{collapsible:a,collapsed:l,descriptionHeight:c,scrollable:d,height:u,determiningScrollability:h,scrollClass:p}=this.state,m=h||l?void 0:{maxHeight:u+"px"},f={};return t&&u&&d&&(f.height=c+"px",f.overflow="hidden"),(0,i.jsxs)("div",Object.assign({className:o()("tag-text-content",{collapsed:l,noScroll:!u||!d}),style:m,ref:e=>{this.textContainer=e}},{children:[e&&(0,i.jsx)("div",Object.assign({className:"tag-label",onClick:this.toggleCollapseText},{children:(0,i.jsx)("div",Object.assign({className:"labelText"},{children:e}))})),t&&(0,i.jsx)("div",Object.assign({style:f,className:o()(p,"wrappedDesc")},{children:(0,i.jsx)(ye.Z,Object.assign({name:"mattertag-overlay-text",forceHidden:!1,waitToUpdate:h,singleScrollDirection:be.Nm.vertical,ref:this.scrollbarsRef,onScrollPositionChange:this.onScrollPositionChange},{children:(0,i.jsx)("div",{children:(0,i.jsx)(fe,{description:t,parsedDescription:n,onLinkClick:s,linkHandler:this.props.linkHandler})})}))})),(0,i.jsxs)("div",Object.assign({className:"buttons"},{children:[a&&(0,i.jsx)(j.hU,{className:o()("tag-button","tag-collapse-button"),iconClass:"icon-dpad-down",onClick:this.toggleCollapseText}),(0,i.jsx)(j.hU,{className:"tag-button",iconClass:"icon-close",onClick:r})]}))]}))}};Oe.contextType=a.I,Oe=Me([f.Z],Oe);const Ae=Oe;var Ce=n(68168);class FullSizeOnSmallScreens extends s.Component{constructor(e){super(e),this.onResize=()=>{this.adjustSizing(this.props)},this.adjustSizing=(e=this.props,t=!0)=>{const n=FullSizeOnSmallScreens.isFullSized(e.editing);n!==this.state.fullSized&&(this.context.messageBus.broadcast(new Ce.Zi(n)),t&&this.setState({fullSized:n}))},this.state={fullSized:!1}}static isFullSized(e){return e&&(window.innerWidth<=700||window.innerHeight<=600)}componentDidMount(){window.addEventListener("resize",this.onResize),this.adjustSizing(this.props)}componentDidUpdate(){this.adjustSizing(this.props)}render(){const e=o()({"full-size-on-small-screens":this.state.fullSized,"floating-on-normal-screens":!this.state.fullSized});return(0,i.jsx)("div",Object.assign({className:e},{children:this.props.children}))}componentWillUnmount(){this.adjustSizing({editing:!1},!1),window.removeEventListener("resize",this.onResize)}}FullSizeOnSmallScreens.contextType=a.I;var Ne,De=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const Ie=new v.Z("billboard");var Le;!function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.FAILED=3]="FAILED",e[e.ENABLED=4]="ENABLED"}(Le||(Le={}));let Pe=Ne=class Billboard extends s.Component{constructor(e,t){super(e,t),this.linkCount=0,this.linksClicked=[],this.linkEditorOpened=()=>this.setState({expanded:!0}),this.linkEditorClosed=()=>this.setState({expanded:!1}),this.getSavedData=()=>{const{label:e,description:t,mediaSrc:n,mediaType:i,stemVisible:s,enabled:r}=this.props.tag,{stemHeight:o,color:a}=this.props.view;return{visible:r,color:a,label:e,description:t,stemHeight:o,mediaSrc:n,mediaType:i,stemVisible:s}},this.updateBillboardSize=()=>{const{mediaWidth:e,mediaHeight:t}=this.state,{tag:n}=this.props;if(n.mediaType===g.z.photo||n.mediaType===g.z.rich||n.mediaType===g.z.video){const i=this.getDimensionsForMedia(n.mediaType,e,t);this.setState(Object.assign({},i))}},this.closeImageOverlay=()=>{const{overlay:e,toggleImageOverlay:t,tag:n}=this.props;e&&t(n.sid,!1)},this.onOpenOverlay=()=>{const{toggleImageOverlay:e,allowTagOverlay:t,tag:n}=this.props;t&&e(n.sid,!0)},this.onBillboardClicked=()=>{const{manager:e,toolOpen:t,tag:n,selected:i}=this.props;t&&e&&!i&&e.selectMattertag(n.sid)},this.setBillboardRef=e=>{this.billboardRef=e},this.updateTagDirection=()=>{const{direction:e}=this.state,{getTagContainer:t,tag:n}=this.props,{navigating:i,navigatingPosition:s,position:r,onTagDirectionChanged:o}=this.props.view,a=t();if(!a)return;const[l,c]=[a.offsetWidth,a.offsetHeight];let d;d=i&&s?Ne.getTagDirection(s.x,s.y,l,c):r?Ne.getTagDirection(r.x,r.y,l,c):Ne.getTagDirection(0,0,l,c),d!==e&&(o(n.sid,d),this.setState({direction:d}))},this.onLinkClick=e=>{if(void 0===e.link)return;-1===this.linksClicked.indexOf(e.link)&&this.linksClicked.push(e.link);const t=e.link.type;this.linkCount++,this.context.analytics.track("click_mattertag_link",{link_type:t,link_count:this.linkCount,links_clicked:this.linksClicked.length})};const n=this.getDimensionsForMedia(e.tag.mediaType,1024,1024),i=t.settings.getProperty(q.lc);this.embedly=new Embedly(i,t.queue),this.state={width:n.width,height:190,expanded:!1,mediaWidth:0,mediaHeight:0,mediaPayload:null,landscape:!1,active:!1,mediaLoadingState:e.mediaEnabled?Le.NOT_LOADED:Le.ENABLED,savedData:this.getSavedData(),direction:void 0};const s=e.tag,r=new k.gm((()=>({})),(e=>{s.onPropertyChanged("mediaSrc",e),s.onPropertyChanged("mediaType",e)}),(e=>{s.removeOnPropertyChanged("mediaSrc",e),s.removeOnPropertyChanged("mediaType",e)}));this.tagOnChangedSub=r.createSubscription((()=>{this.loadMedia(!0)}),!1)}componentDidMount(){const{view:e,manager:t}=this.props;this.updateTagDirection(),this.loadMedia(),!e.located||e.navigating&&!e.navigatingPosition||this.setState({active:!0}),window.addEventListener("resize",this.updateBillboardSize),t&&(this.context.messageBus.subscribe(OpenLinkEditorMessage,this.linkEditorOpened),this.context.messageBus.subscribe(CloseLinkEditorMessage,this.linkEditorClosed)),this.tagOnChangedSub.renew()}componentWillUnmount(){this.tagOnChangedSub.cancel(),window.removeEventListener("resize",this.updateBillboardSize),this.props.manager&&(this.context.messageBus.unsubscribe(OpenLinkEditorMessage,this.linkEditorOpened),this.context.messageBus.unsubscribe(CloseLinkEditorMessage,this.linkEditorClosed))}componentDidUpdate(e,t){const{manager:n,editing:i,tag:s,view:r,overlay:o}=this.props,{active:a}=this.state;if(n===e.manager||e.manager||(this.context.messageBus.subscribe(OpenLinkEditorMessage,this.linkEditorOpened),this.context.messageBus.subscribe(CloseLinkEditorMessage,this.linkEditorClosed)),i===e.editing&&o===e.overlay||this.updateBillboardSize(),r.closeTheTag||s&&s.mediaSrc!==e.tag.mediaSrc&&this.loadMedia(!0),a||e.view.navigatingPosition===r.navigatingPosition||this.updateTagDirection(),r.closeTheTag)a&&this.setState({active:!1});else if(a||!r.located||r.navigating&&!r.navigatingPosition||this.setState({active:!0}),i&&(!e.editing||null===this.state.savedData)){const e=this.getSavedData();e&&this.setState({savedData:e})}}loadMedia(e=!1){const{mediaType:t,mediaSrc:n}=this.props.tag,{mediaLoadingState:i}=this.state;if(Ne.isMediaTag(t)&&(e||![Le.LOADING,Le.FAILED,Le.ENABLED].includes(i)))return this.setState({mediaLoadingState:Le.LOADING}),this.embedly.getMediaDetails(t,n).then((e=>{if(e&&this.billboardRef){const n=this.getDimensionsForMedia(t,e.width,e.height);this.setState(Object.assign(Object.assign({},n),{mediaWidth:e.width,mediaHeight:e.height,mediaPayload:e.embedlyResponse,mediaLoadingState:Le.LOADED}))}})).catch((e=>{if(Ie.debug(e),this.billboardRef){const e=this.getDimensionsForMedia(g.z.text,1024,1024);this.setState(Object.assign(Object.assign({},e),{mediaLoadingState:Le.FAILED}))}}))}getDimensionsForMedia(e,t,n){if(e===g.z.text||e===g.z.none||e===g.z.error)return{width:298,height:0,landscape:!1};const{getTagContainer:i,editing:s,overlay:r}=this.props;let o=t,a=n;const l=Math.max(t,1)/Math.max(n,1),c=i();if(c)if(r)o=c.offsetWidth,a=c.offsetHeight;else{const n=e===g.z.photo;let i;i=s?n?150:340:80;const r=c.offsetWidth-100,d=c.offsetHeight-i;o=n?l>1?Math.max(Math.min(t,400,r),E):Math.max(Math.min(t,300),200):Math.max(Math.min(t,350,r),E),a=o/l,a>d&&(a=d,o=a*l)}return{width:o,height:a,landscape:l>1}}render(){const{overlay:e,editing:t,view:n,tag:s}=this.props,{closeTheTag:r}=n,{sid:a,mediaType:l,label:c,description:d}=s,{landscape:u,mediaLoadingState:h,active:p,direction:m,expanded:f}=this.state,v=Ne.isMediaTag(l)&&h!==Le.FAILED&&h!==Le.ENABLED,y=h===Le.LOADING&&l===g.z.photo,b=t||e?void 0:this.getTagPositionStyle(),S=t||e||!m?void 0:"tag"+m.trim().replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase();const E=this.isImageTag(),T=v&&l===g.z.video,w=v&&(l===g.z.rich||y),x=T||w||E,_=c.length>0||d.length>0;return(0,i.jsx)(FullSizeOnSmallScreens,Object.assign({editing:t},{children:(0,i.jsx)("div",Object.assign({className:o()("tag-position",{"billboard-standard-view":!t&&!e,"billboard-overlay":e,"billboard-editing":t,"media-only-mattertag":!_&&x,"media-mattertag":x,"video-mattertag":T,"embed-mattertag":w,"image-mattertag":E,"link-popover-expanded":f}),style:b},{children:(0,i.jsx)("div",Object.assign({className:o()("tag-wrapper",{active:!r&&p})},{children:(0,i.jsx)("div",Object.assign({ref:this.setBillboardRef,className:o()("tag-container",[S],{"media-landscape":x&&u,"media-portrait":x&&!u}),onClick:this.closeImageOverlay},{children:this.renderBillboard(v)}))}))}),a)}))}renderBillboard(e){const{mediaPayload:t,width:n,height:s,savedData:r,mediaWidth:o,mediaHeight:a}=this.state,{overlay:l,selected:c,view:d,tag:u,allowTagOverlay:h}=this.props,p=a>0?o/a:void 0;if(l&&p){const{label:e,description:r,parsedDescription:o,mediaType:a}=u;return(0,i.jsx)(Ae,{label:e,description:r,parsedDescription:o,mediaPayload:t,mediaType:a,maxWidth:n,maxHeight:s,mediaAspectRatio:p,closing:d.closeTheTag,closeImageOverlay:this.closeImageOverlay,onLinkClick:this.onLinkClick,linkHandler:this.props.linkHandler})}{const{sid:o}=u,a={mediaPayload:t,hasMedia:e},l=e&&!t?{width:n+"px"}:{},{editing:m,manager:f}=this.props;if(m&&f){const e=FullSizeOnSmallScreens.isFullSized(m);return(0,i.jsx)(ue,{id:o,getSavedData:this.getSavedData,manager:f,fullSized:e,mediaAspectRatio:p,media:a,mediaType:u.mediaType,closing:d.closeTheTag,label:u.label,description:u.description,originalValues:r,embedlyValidator:this.embedly})}{const e={width:n,height:s,bodyStyle:l,closing:d.closeTheTag};return(0,i.jsx)(_e,{id:o,allowTagOverlay:h,selected:c,style:e,onClickBillboard:this.onBillboardClicked,onOpenOverlay:this.onOpenOverlay,onLinkClick:this.onLinkClick,linkHandler:this.props.linkHandler,media:a,mediaType:u.mediaType,mediaSrc:u.mediaSrc,label:u.label,parsedDescription:u.parsedDescription,description:u.description,customWidget:u.widgetFrame})}}}isImageTag(){const{tag:e}=this.props;return this.state.mediaLoadingState!==Le.FAILED&&this.state.mediaLoadingState!==Le.ENABLED&&e.mediaType===g.z.photo}getTagPositionStyle(){const{view:e}=this.props;if(e.located){const{position:t}=e;return{transform:`translate(${t?t.x:0}px, ${t?t.y:0}px)`}}return{pointerEvents:"none",visibility:"hidden"}}static isMediaTag(e){return e===g.z.photo||e===g.z.video||e===g.z.rich}};Pe.contextType=a.I,Pe.getTagDirection=(e,t,n,i)=>{const s=.2,r=1-(e+1)/(n=n||window.innerWidth)*2,o=1-(t+1)/(i=i||window.innerHeight)*2,a=o<-.2?0:o<s?1:2,l=r<-.2?2:r<s?1:0,c=Math.max(e,n-e);let u;return u=0===l?1===a?d.Pg.RIGHT:0===a?d.Pg.RIGHT_UP:d.Pg.RIGHT_DOWN:2===l?1===a?d.Pg.LEFT:0===a?d.Pg.LEFT_UP:d.Pg.LEFT_DOWN:1===a&&c>E?r<0?d.Pg.RIGHT:d.Pg.LEFT:2===a?d.Pg.DOWN:d.Pg.UP,Ie.debug(`Selected ${u} for [${e}, ${t}] in ${n}x${i} (${l}, ${a})`),u},Pe=Ne=De([f.Z],Pe);Pe.getTagDirection;var Re=n(90525),ke=n(61709),Ue=n(45923),Be=n(16534);class Tags extends s.Component{constructor(e){super(e),this.tagsRootRef=(0,s.createRef)(),this.bindings=[],this.isUnmounting=!1,this.onUpdateSelectedTag=()=>{if(!this.isUnmounting){const{selectedTag:e,overlay:t}=this.state,n=this.mattertagsViewData.selectedTag;n!==e&&(t&&e&&this.toggleImageOverlay(e,!1),this.setState({selectedTag:n}))}},this.onUpdateToolState=()=>!this.isUnmounting&&this.setState({toolState:this.mattertagsViewData.toolState}),this.onUpdateScreenPosition=()=>!this.isUnmounting&&this.setState({screenPosition:this.mattertagsViewData.screenPosition}),this.onUpdateProgress=()=>!this.isUnmounting&&this.setState({creationProgress:this.mattertagsViewData.progress}),this.onUpdateBillboards=()=>!this.isUnmounting&&this.setState({billboards:this.mattertagsViewData.activeBillboards.keys}),this.toggleImageOverlay=async(e,t)=>{if(!this.isUnmounting&&(this.props.allowTagOverlay||!t))if(this.setState({overlay:t}),this.context.commandBinder.issueCommand(new c.Bz(l.P.MATTERTAG_PHOTO,t)),t){this.context.messageBus.broadcast(new p.dJ(e,h.V.OVERLAY));const t=e!==this.state.selectedTag?m.n.Interpolate:m.n.Instant,n=this.mattertagsData.getTag(e);this.context.commandBinder.issueCommand(new Re.Y(n.sid,t))}else this.closeBillboard(e)},this.getTagContainer=()=>this.tagsRootRef.current,this.state={billboards:[],selectedTag:null,overlay:!1,toolState:d.rI.CLOSED,creationProgress:0,screenPosition:null}}componentDidMount(){const e=this.context.market;Promise.all([e.waitForData(ke.n),e.waitForData(d.P5),this.context.engine.getModuleBySymbol(u.y.DEEP_LINKS)]).then((([e,t,n])=>{this.init(e,t,n)}))}init(e,t,n){this.isUnmounting||(this.mattertagsData=e,this.mattertagsViewData=t,this.linkHandler=n,this.bindings.push(this.mattertagsViewData.onSelectedTagChanged(this.onUpdateSelectedTag),this.mattertagsViewData.onChanged(this.onUpdateBillboards),this.mattertagsViewData.onToolStateChanged(this.onUpdateToolState)),this.context.editMode&&this.bindings.push(this.mattertagsViewData.onScreenPositionChanged(this.onUpdateScreenPosition),this.mattertagsViewData.onProgressChanged(this.onUpdateProgress)),this.setState({selectedTag:this.mattertagsViewData.selectedTag,toolState:this.mattertagsViewData.toolState,screenPosition:this.mattertagsViewData.screenPosition,creationProgress:this.mattertagsViewData.progress,billboards:this.mattertagsViewData.activeBillboards.keys}))}componentWillUnmount(){this.isUnmounting=!0,this.bindings.forEach((e=>{e.cancel()})),this.bindings.length=0}componentDidUpdate(e){const{allowTagOverlay:t,toolOpen:n}=this.props;if(this.context.editMode&&(t!==e.allowTagOverlay||n!==e.toolOpen)){const e=this.mattertagsViewData&&this.mattertagsViewData.openTag;e&&(this.state.overlay?t||this.toggleImageOverlay(e,!1):this.closeBillboard(e))}}closeBillboard(e){this.mattertagsViewData.closeBillboard(e)}renderBillboards(){const{settings:e}=this.context,{overlay:t,selectedTag:n,toolState:s,billboards:r}=this.state,{toolOpen:o,manager:a,allowTagOverlay:l}=this.props,c=[],u=s===d.rI.CREATING||s===d.rI.PRESSING||s===d.rI.PLACING,h=!(!o||s!==d.rI.EDITING&&s!==d.rI.PLACED);return u||r.forEach((s=>{const r=n===s,d=h&&r,u=this.mattertagsViewData.getViewData(s),p=this.mattertagsData.getTag(s),m=e.tryGetProperty(Be.sX,!1),f=d||!m;!p||u.closeTheTag&&d||c.push((0,i.jsx)(Pe,{editing:d,selected:r,overlay:t,allowTagOverlay:l,toolOpen:o,view:u,tag:p,manager:a,mediaEnabled:f,toggleImageOverlay:this.toggleImageOverlay,getTagContainer:this.getTagContainer,linkHandler:this.linkHandler},`billboard-${s}`))})),c}renderProgressCircle(){const{mobile:e}=this.props,{creationProgress:t,screenPosition:n,toolState:s}=this.state;if(!(s===d.rI.PRESSING&&t>0&&e)||!n)return null;const r={left:n.x-Tags.creationButtonRadius/2+"px",top:n.y-Tags.creationButtonRadius/2+"px"};return(0,i.jsx)("div",Object.assign({className:"point-button-wrapper",style:r},{children:(0,i.jsx)(Ue.$,Object.assign({className:o()({complete:1===t,reset:0===t}),progress:100*t,innerRadius:Tags.creationButtonRadius,barWidth:Tags.progressBarThickness},{children:(0,i.jsx)("circle",{className:"point",cx:"0",cy:"0",r:"22",transform:"rotate(-90)",fill:"#fff"})}))}))}render(){if(!this.mattertagsData||!this.mattertagsViewData)return null;const{toolOpen:e}=this.props,{toolState:t}=this.state,n=!(!e||t!==d.rI.EDITING&&t!==d.rI.PLACED);return(0,i.jsxs)("div",Object.assign({className:o()("overlay-layer","tags-layer",{"tag-editable":e,"tags-layer-editing":n,"tags-layer-displaying":!n}),ref:this.tagsRootRef},{children:[this.renderProgressCircle(),this.renderBillboards()]}))}}Tags.contextType=a.I,Tags.creationButtonRadius=132,Tags.progressBarThickness=8},11208:(e,t,n)=>{"use strict";n.d(t,{l:()=>CustomWidgetFrame});var i=n(85893),s=n(67294);class CustomWidgetFrame extends s.Component{constructor(){super(...arguments),this.elementRef=(0,s.createRef)()}shouldComponentUpdate(){return!1}componentDidMount(){const e=this.elementRef.current;e&&this.props.widget.frame.mount(e)}componentWillUnmount(){this.elementRef.current&&this.props.widget.frame.unmount()}render(){const{width:e,height:t}=this.props.widget.size,n={};return e&&t&&(n.width=e+"px",n.height=t+"px"),(0,i.jsx)("div",{className:"custom-widget-container",style:n,ref:this.elementRef})}}},6165:(e,t,n)=>{"use strict";n.d(t,{q:()=>v});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=n(60405),c=n(99380),d=n(23676),u=n(99612),h=n(91724),p=n(70329),m=n(10854),f=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{PINS:g}=m.Z.WORKSHOP;let v=class PinAssetEditor extends s.Component{constructor(e){super(e),this.closePinAssetEditor=e=>{e&&e.stopPropagation(),this.props.onClose()},this.handleColorPicked=e=>{this.context.analytics.trackGuiEvent("pin_change_color"),this.props.onSave({color:e})},this.saveStemEnabled=e=>{this.context.analytics.trackGuiEvent(e?"pin_show_stem":"pin_hide_stem"),this.props.onSave({stemEnabled:e})},this.saveStemLength=e=>{this.context.analytics.trackGuiEvent("pin_change_stem_height"),this.props.onSave({stemLength:e})},this.previewStemLength=e=>{const{id:t,pinType:n}=this.props;this.context.commandBinder.issueCommand(new c.tE(t,n,{stemLength:e}))},this.stopPropagation=e=>{e.stopPropagation()}}renderStemEditor(){const{pin:e}=this.props;return(0,i.jsx)(h.r,{stemLength:e.stemLength,stemEnabled:e.stemEnabled,onLengthUpdate:this.previewStemLength,onLengthChanged:this.saveStemLength,onStemEnabledChanged:this.saveStemEnabled})}render(){const{toolPanelLayout:e,open:t,pin:n,colors:s}=this.props,r=e===d.wS.BOTTOM_PANEL;if(!t&&!r)return null;const o=this.context.locale.t(g.COLOR_STEM_EDITOR_TITLE);return(0,i.jsxs)("div",Object.assign({className:a()("pin-tool-editor",{"tool-popup":!r,open:r&&t}),onClick:this.stopPropagation},{children:[(0,i.jsxs)("div",Object.assign({className:"tool-editor-title"},{children:[(0,i.jsx)("span",{children:o}),(0,i.jsx)(p.P,{buttonStyle:p.A.LIGHT,onClose:this.closePinAssetEditor,hideTooltip:!0})]})),(0,i.jsx)(u.z,{colors:s,defaultColor:n.color,onColorPicked:this.handleColorPicked}),this.renderStemEditor()]}))}};v.contextType=l.I,v=f([r.Z],v)},58361:(e,t,n)=>{"use strict";n.d(t,{O:()=>S});var i=n(85893),s=n(3922),r=n(2212),o=n(67294),a=n(94184),l=n.n(a),c=n(60405),d=n(11334),u=n(14909),h=n(10854),p=n(15099),m=n(37363),f=n(56044),g=n(53549),v=n(54119);function y(e){const{label:t,className:n,darkTheme:r,analyticAction:a,urlParams:y,includeCameraView:b,buttonVariant:S}=e,{analytics:E,editMode:T,locale:w,market:x}=(0,o.useContext)(c.I),[_,M]=(0,o.useState)(!1),O=(0,o.useCallback)((e=>{e.stopPropagation()}),[]),A=(0,o.useCallback)((e=>{e.stopPropagation(),_||(!async function(e,t,n){const i=(0,u.rI)();let r;if(n){const[e,n,i,o]=await Promise.all([t.waitForData(p.M_),t.waitForData(m.O),t.waitForData(f.c),t.waitForData(g.Z)]);r=s.K.serialize({cameraData:e,viewmodeData:n,floorsViewData:i,sweepData:o})}else r=s.K.removeNavigationKeys();(0,u.on)(r),Object.keys(e).forEach((t=>r.set(t,e[t]))),i.search=r.toString(),(0,d.v)(i.toString())}(y,x,!!b),M(!0),E.trackGuiEvent(a))}),[y,_,M,E,T,b,x]);(0,o.useEffect)((()=>{if(!_)return()=>{};const e=window.setTimeout((()=>M(!1)),2500);return()=>window.clearTimeout(e)}),[_]);let C=S||(!t?v.Wu.FAB:v.Wu.TERTIARY),N="share",D=t,I=t?void 0:w.t(h.Z.COPY_LINK),L=!1;return _&&(C=v.Wu.TERTIARY,N=void 0,D=w.t(h.Z.SHARE_COPIED),I=void 0,L=!0),(0,i.jsx)("div",Object.assign({className:l()("url-link-copy",n,{"link-copied":_}),onClick:O},{children:(0,i.jsx)(v.zx,{icon:N,label:D,size:v.qE.SMALL,variant:C,theme:r?"dark":"light",disabled:L,tooltip:I,tooltipOptions:{placement:"bottom"},onClick:A})}))}var b=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};function S(e){const{prefix:t,pin:n,id:o}=e,a=b(e,["prefix","pin","id"]),{stemNormal:l,stemLength:c,anchorPosition:d}=n,u={[`${t}`]:o,"pin-pos":s.K.encodeVector3((new r.Vector3).copy(l).setLength(c).add(d))};return(0,i.jsx)(y,Object.assign({urlParams:u},a))}},94511:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i=n(85893),s=n(67294),r=n(60405),o=n(2252),a=n(87982),l=n(78576),c=n(23676),d=n(34612),u=n(10854),h=n(61445),p=n(41345);const{TOOLS:m}=u.Z;function f(e){const{activeTool:t}=e,{commandBinder:n,analytics:u}=(0,s.useContext)(r.I),f=(0,p.b)(),g=t===c.w1.SEARCH,v=(0,o.Jm)();return(0,i.jsx)("span",Object.assign({className:"search-mode-button"},{children:(0,i.jsx)(a.hU,Object.assign({onClick:()=>{n.issueCommand(new d.tT(c.w1.SEARCH,!g)),u.trackToolGuiEvent("search","click_search_button",{interactionSource:"gui"})},buttonStyle:a.Dd.OVERLAY,buttonState:g?h.BN.ACTIVE:h.BN.ENABLED},{children:(0,i.jsx)(l.oO,Object.assign({content:f.t(m.SEARCH),position:l.lZ.DOWN,tooltipTimeout:v?1e3:void 0},{children:(0,i.jsx)("span",{className:"icon icon-magnifying-glass"})}))}))}))}},11923:(e,t,n)=>{"use strict";n.d(t,{F:()=>_});var i=n(85893),s=n(94184),r=n.n(s),o=n(54119),a=n(60405),l=n(67294);var c=n(67779),d=n(83670),u=n(95551),h=n(41345),p=n(46803),m=n(29984);const f=(e,t)=>e.text.localeCompare(t.text),g=new c.f({}),v=new m.d,y={fixtures:"KEYWORDS_FIXTURES"};var b=n(22149);const S=()=>{const e=function(){var e,t;const n=(0,h.b)(),i=(0,p.w)(),s=(0,d.i)(null!==(e=null==i?void 0:i.queryKeywords)&&void 0!==e?e:v),r=(0,u.y)(null!==(t=null==i?void 0:i.keywords)&&void 0!==t?t:g);return(0,l.useMemo)((()=>Object.values(r).map((e=>Object.assign({isSelected:s.includes(e.id),text:y[e.id]?n.t(y[e.id]):e.id},e))).sort(f)),[r,s,n])}(),t=function(e,t){const{engine:n}=(0,l.useContext)(a.I);return(0,l.useCallback)(((...i)=>{const s=t?Array.isArray(t)?t:t(...i):[];n.commandBinder.issueCommand(new e(...s))}),[e,t,n])}(b.M8,(e=>[e.id]));return(0,i.jsx)(o.no,{className:"search-keyword-summary",tokens:e,onTokenClick:t,maxVisibleTruncated:5,allowSelect:!0})};var E=n(83869),T=n(9740),w=n(43368),x=n(41920);const _=({isNarrowScreen:e})=>{const t=(0,E.v)(T.r,"isKeywordSummaryEnabled",!1);return(0,i.jsx)("div",Object.assign({className:r()("search-tool-overlay",e&&"narrow-screen")},{children:t&&(e?(0,i.jsx)(w.Z,Object.assign({direction:x.Nm.horizontal},{children:(0,i.jsx)(S,{})})):(0,i.jsx)(S,{}))}))}},57109:(e,t,n)=>{"use strict";n.d(t,{E:()=>pe});var i=n(85893),s=n(67294),r=n(57340),o=n(29605),a=n(46317),l=n(34612),c=n(23676),d=n(68168),u=n(61445),h=n(94184),p=n.n(h),m=n(60405),f=n(91845),g=n(13729),v=n(28876),y=n(10854),b=n(43873),S=n(28654),E=n(67779),T=n(95551),w=n(46803);const x=new E.f(null);const _=["<mark>","</mark>"];function M(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function O(e,t){const[n,i]=_,s=`${n}|${i}`;let r=!1;if(e.match(new RegExp(s))&&(e=e.replace(new RegExp(`(${s})`,"g"),((e,t)=>t.split("").join("‌"))),r=!0),t){let s;s=r?t.split("").map(M).join("[‌]?"):M(t),e=e.replace(new RegExp(`(${s})`,"gi"),((e,t)=>`${n}${t}${i}`))}return e}const A=O;function C(e,t){return O(function(e,t){var n;const i=e.toLowerCase(),[s,r,o]=[i.indexOf(t),e.length,(null===(n=i.match(new RegExp(`${M(t)}`,"g")))||void 0===n?void 0:n.length)||1];let a=e,l=s;if(r>20&&l>0){if(1===o){const e=Math.floor((20-t.length)/2);e>0&&l>e&&(l-=e)}a=`...${a.substr(l)}`,a.length<20&&(l-=20-a.length,l>0&&(a=`...${e.substr(l)}`))}return a}(e,t),t)}var N=n(54119),D=n(54787),I=n(25379),L=n(14374);function P(e){const{item:t,searchText:n}=e,s=function(){const e=(0,w.w)();return(0,T.y)(e?e.selectedSearchResult:x)}(),r=t.id,o=t.color,a=!!s&&r===s.id,l=(0,L.N)();let c=t.title;c&&(c=A(c,n));let d=t.description;d&&(d=C(d,n));const u=[];if(t.actions)for(const e of t.actions)u.push((0,i.jsx)(N.zx,{icon:e.icon,onClick:t=>{e.handler(t),l()}},r));const h=(0,i.jsxs)(N.hE,{children:[t.actions&&u,t.menuActions&&(0,i.jsx)(I.n,{id:r,disabled:!1,menu:t.menuActions,closeOnMenuItemClick:!0,accordion:!0})]}),p=(0,i.jsx)(b.C,{badgeStyle:void 0!==o?{background:o,borderColor:o}:{},iconClass:t.icon}),m=(0,i.jsxs)("div",Object.assign({className:"item-details"},{children:[(0,i.jsx)("div",Object.assign({className:"item-header"},{children:(0,i.jsx)(S.S,{text:c||"",textParser:t.textParser,markers:_})})),t.textParser&&(0,i.jsx)("div",Object.assign({className:"item-description"},{children:(0,i.jsx)(S.S,{text:d||"",textParser:t.textParser,markers:_})}))]}));return(0,i.jsxs)(D.Q,Object.assign({sid:r,enabled:t.enabled,selected:a,onSelect:()=>{e.onSelect(),t.onSelect()}},{children:[p,m,h]}),r)}var R=n(18814),k=n(59187),U=n(83869),B=n(9740);const F=(0,U.M)(B.r,"grouping",f.l.TYPE),V=(0,k.M)("grouping",F),{SEARCH:H}=y.Z.SHOWCASE;class SearchPanelList extends s.Component{groupItems(){const{grouping:e}=this.props;switch(e){case f.l.TYPE:return this.groupByType();case f.l.FLOOR:return this.groupByFloor();default:return this.groupByType()}}groupByType(){const{searchResults:e,searchGroups:t}=this.props,n={};for(const s of e){const e=t[s.groupId].groupPhraseKey,r=this.context.locale.t(e),o=t[s.groupId].groupMenuActions,a=(0,i.jsx)(N.hE,{children:o&&(0,i.jsx)(I.n,{id:s.groupId,disabled:!1,menu:o,closeOnMenuItemClick:!0,accordion:!0})});e in n||(n[e]={header:r,items:[],actions:a}),n[e].items.push(this.renderItem(s))}return n}groupByFloor(){const{searchResults:e,floorsViewData:t}=this.props,n={};for(const i of e){const e=i.floorId,s=t.getFloorName(e);e in n||(n[e]={header:s,items:[]}),n[e].items.push(this.renderItem(i))}return n}renderItem(e){return(0,i.jsx)(P,{item:e,onSelect:this.props.onSelect,searchText:this.props.searchText},e.id)}render(){const e=[];for(const[t,n]of Object.entries(this.groupItems())){const s=0===n.items.length,{header:r,items:o,actions:a}=n;e.push((0,i.jsx)(g.b,Object.assign({id:t,header:`${r} (${o.length})`,open:!0,doubleLine:!0,collapsible:!s,emptyMessage:this.context.locale.t(H.EMPTY_LIST_MESSAGE),actions:a},{children:n.items}),t))}return(0,i.jsx)(v.F,{children:e})}}SearchPanelList.contextType=m.I;const j=V((0,R.p)(SearchPanelList));var G=n(2252),z=n(20725),W=n(20585),K=n(41920),Y=n(43368);var q=n(21546),Z=n(22149),$=n(34506);const{SEARCH:Q}=y.Z.SHOWCASE;function X(){const e=F(),{commandBinder:t,locale:n}=(0,s.useContext)(m.I),r=(0,s.useCallback)((e=>{if(e){const n=e;t.issueCommand(new Z.SN(n))}}),[t]),o=[{text:n.t(Q.GROUP_TYPE),selectedText:n.t(Q.GROUP_TYPE_SELECTED),value:f.l.TYPE,selected:e===f.l.TYPE},{text:n.t(Q.GROUP_FLOOR),selectedText:n.t(Q.GROUP_FLOOR_SELECTED),value:f.l.FLOOR,selected:e===f.l.FLOOR}];return(0,i.jsx)(N.w0,Object.assign({className:"search-groupings"},{children:(0,i.jsx)($.S,{menuStyle:$.K.DROPDOWN,onChange:r,options:o})}))}var J=n(11334),ee=n(14909),te=n(87982),ne=n(78576);function ie(e){const{collapsedToBottom:t,query:n,queryKeywords:r=[],toolPanelLayout:o}=e,{locale:a,analytics:l,editMode:d}=(0,s.useContext)(m.I),[h,p]=(0,s.useState)(!1),f=(0,s.useCallback)((()=>{!function(e,t){const n=(0,ee.rI)(),i=new URLSearchParams(window.location.search);(0,ee.on)(i);const s=encodeURIComponent(e);if(i.set("q",s),t.length>0){const e=encodeURIComponent(t.join(","));i.set("qK",e)}n.search=i.toString(),(0,J.v)(n.toString())}(n,r),p(!0);const e=d?"workshop_gui":"showcase_gui";l.track(e,{gui_action:"space_search_share_link_clicked"})}),[n,r,d,l]);if((0,s.useEffect)((()=>{if(!h)return()=>{};const e=window.setTimeout((()=>p(!1)),2500);return()=>window.clearTimeout(e)}),[h]),h)return(0,i.jsx)("span",Object.assign({className:"link-copied"},{children:a.t(y.Z.SHARE_COPIED)}));const g=o===c.wS.SIDE_PANEL||!t;return(0,i.jsx)(te.hU,Object.assign({onClick:f,buttonStyle:te.Dd.PLAIN,buttonSize:u.qE.SMALL},{children:g?(0,i.jsx)(ne.oO,Object.assign({content:a.t(y.Z.COPY_URL),position:ne.lZ.DOWN,tooltipTimeout:2e3},{children:(0,i.jsx)("span",{className:"icon icon-share"})})):(0,i.jsx)("span",{className:"icon icon-share"})}))}var se=n(56759);const{SEARCH:re}=y.Z.SHOWCASE;function oe(){const{locale:e}=(0,s.useContext)(m.I),[t,n]=(0,s.useState)(!1),r=(0,s.useCallback)((()=>{n(!t)}),[t]);return(0,i.jsxs)("div",Object.assign({className:"search-advanced-hint"},{children:[(0,i.jsx)("span",Object.assign({className:"search-advanced-label"},{children:e.t(re.ADVANCED_SEARCH_TITLE)})),(0,i.jsxs)("a",Object.assign({className:"link",onClick:r},{children:[e.t(re.ADVANCED_SEARCH_HELP_BUTTON),(0,i.jsx)(se.u,{open:t,message:(0,i.jsx)("p",{children:e.t(re.ADVANCED_SEARCH_INSTRUCTIONS)}),tooltipId:"search-advanced-help-tooltip",className:"search-advanced-help",arrowPos:se.x.TOP_RIGHT,onClose:r})]}))]}))}var ae=n(74715),le=n(68850),ce=n(14827),de=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{SEARCH:ue}=y.Z.SHOWCASE;let he=class SearchPanel extends s.Component{constructor(e){super(e),this.bindings=[],this.detailPanelClosedTimeout=0,this.setTextInputRef=e=>this.textInputRef=e,this.focus=()=>{this.textInputRef&&!(0,G.Jm)()&&this.textInputRef.focus()},this.updateCurrentTag=async()=>{const{currentTag:e}=this.state,{dockedTag:t}=this.props;window.clearTimeout(this.detailPanelClosedTimeout),e&&!t?this.startClosingDetailPanel():t?this.startOpeningTagWidget(t):this.setState({currentTag:null})},this.searchResultsOnChange=e=>{this.setState({searchResults:e.getResults(),searchGroups:e.groups,validationError:e.getValidationError(),searchText:e.getQuery(),queryKeywords:e.getQueryKeywords(),isAdvancedQuery:e.getIsAdvancedQuery()})},this.updateCollapsedState=()=>{this.setState({collapsedToBottom:this.context.toolsData.isPanelCollapsedToBottom()})},this.sendQuery=async e=>{this.context.commandBinder.issueCommand(new Z.H1(e))},this.onDone=e=>{this.state.collapsedToBottom&&this.context.commandBinder.issueCommand(new l.zK(!1)),this.focused=!1},this.selectItem=()=>{this.props.toolPanelLayout===c.wS.BOTTOM_PANEL&&this.context.commandBinder.issueCommand(new l.zK(!0))},this.onCloseLayer=async e=>{e&&e.stopPropagation(),await this.context.commandBinder.issueCommand(new l.tT(c.w1.SEARCH,!1))},this.onClearSearch=()=>{this.sendQuery(""),this.focus()},this.scrollToInputOnResize=()=>{this.focused&&this.state.collapsedToBottom&&(0,G.Jm)()&&this.textInputRef.scrollIntoView()},this.handleFocused=()=>{this.focused=!0},this.state={active:!0,collapsedToBottom:!1,searchText:"",queryKeywords:[],searchResults:[],searchGroups:{},validationError:null,isAdvancedQuery:!1,linkCopied:!1,currentTag:e.dockedTag,detailPanelClosing:!1}}componentDidMount(){const{engine:e}=this.context;this.bindings.push(e.subscribe(z.a,this.scrollToInputOnResize),e.subscribe(d.U7,this.updateCollapsedState)),e.market.waitForData(B.r).then((e=>{this.searchResultsOnChange(e),this.bindings.push(e.onChanged(this.searchResultsOnChange))})),this.updateCollapsedState()}componentDidUpdate(e){e.dockedTag!==this.props.dockedTag&&this.updateCurrentTag()}startOpeningTagWidget(e){window.clearTimeout(this.detailPanelClosedTimeout),this.setState({currentTag:e,detailPanelClosing:!1})}startClosingDetailPanel(){this.state.detailPanelClosing||(this.setState({detailPanelClosing:!0}),this.detailPanelClosedTimeout=window.setTimeout((()=>{this.setState({currentTag:null,detailPanelClosing:!1})}),W.El))}componentWillUnmount(){this.bindings.forEach((e=>e.cancel()))}renderSearchResults(){const{searchResults:e,searchText:t,searchGroups:n}=this.state;return this.state.searchResults.length>0?(0,i.jsx)(j,{searchText:t,searchResults:e,searchGroups:n,onSelect:this.selectItem}):this.renderEmptyMessage()}renderEmptyMessage(){const e=this.context.locale.t(ue.EMPTY_LIST_MESSAGE);return(0,i.jsx)("p",Object.assign({className:"search-empty-message"},{children:e}))}renderSubheader(){const{locale:e}=this.context,{collapsedToBottom:t,validationError:n,isAdvancedQuery:s}=this.state,r=!t;return(0,i.jsxs)("div",Object.assign({className:"list-subheaders"},{children:[this.renderSearchHeader(),n&&(0,i.jsx)("div",Object.assign({className:"search-validation-error"},{children:e.t(ue.VALIDATION_MESSAGE)})),s&&(0,i.jsx)(oe,{}),r&&(0,i.jsx)(X,{})]}))}renderSearchHeader(){const{searchText:e,queryKeywords:t,validationError:n,collapsedToBottom:s}=this.state,{locale:r}=this.context,{toolPanelLayout:a}=this.props,l=r.t(ue.QUERY_PLACEHOLDER),d=r.t(ue.CLEAR_SEARCH).toLocaleUpperCase(),h=t.length>0||""!==e;return(0,i.jsxs)("div",Object.assign({className:p()("list-search",!!n&&"has-validation-msg")},{children:[(0,i.jsx)("span",{className:p()("search-header-icon","icon","icon-magnifying-glass",{"search-header-icon-active":h})}),(0,i.jsx)(o.Z,{text:e,onInput:this.sendQuery,onDone:this.onDone,placeholder:l,onFocus:this.handleFocused,ref:this.setTextInputRef,focusOnMount:a===c.wS.SIDE_PANEL}),(0,i.jsxs)("div",Object.assign({className:"search-header-button-container"},{children:[""!==e&&(0,i.jsx)(u.zx,Object.assign({onClick:this.onClearSearch,buttonStyle:u.ZJ.PLAIN,buttonSize:u.qE.STANDARD},{children:d})),h&&(0,i.jsx)(ie,{query:e,queryKeywords:t,collapsedToBottom:s,toolPanelLayout:a})]}))]}))}getListTitle(){const{searchResults:e}=this.state,t=e.length;return this.context.locale.t(ue.ITEMS,t)}render(){const{active:e,currentTag:t,detailPanelClosing:n}=this.state,{toolPanelLayout:s,toolsData:r}=this.props,o=r.getTool(c.w1.TAGS),l=t&&t.objectAnnotationId;return(0,i.jsxs)("div",Object.assign({className:"tool-panel search-panel"},{children:[o&&l&&(0,i.jsx)(ce.J,{closing:n,manager:o.manager,modalOpen:!1,tag:t,toolPanelLayout:s}),(0,i.jsx)(a.L,Object.assign({active:e,toolPanelLayout:s,title:this.getListTitle(),onClose:this.onCloseLayer,subheader:this.renderSubheader(),subheaderCollapsedHeight:W._U},{children:(0,i.jsx)(Y.Z,Object.assign({direction:K.Nm.vertical},{children:(0,i.jsx)("div",Object.assign({className:"list-contents"},{children:this.renderSearchResults()}))}))}))]}))}};he.contextType=m.I,he=de([r.Z],he);const pe=(0,le.A)((0,ae.P)((me=he,fe=q.e,e=>fe()?(0,i.jsx)(me,Object.assign({},e)):null)));var me,fe},29055:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var i=n(92216),s=n(68077),r=n(83869),o=n(76031);const a=()=>{const e=(0,r.v)(i.I,"applicationKey",null);return(0,s.y)(o.B_,!1)&&!e}},28741:(e,t,n)=>{"use strict";n.d(t,{p:()=>o});var i=n(68077),s=n(67294),r=n(76031);const o=()=>{const e=(0,i.y)(r.My,r.ED);return(0,s.useMemo)((()=>Object.assign({},r.ED,e)),[e])}},14827:(e,t,n)=>{"use strict";n.d(t,{J:()=>fe});var i=n(85893),s=n(67294),r=n(57340),o=n(60405),a=n(23676),l=n(94184),c=n.n(l),d=n(10854),u=n(12366),h=n(59187),p=n(20302),m=n(4752);const f=(0,p.u)(m.b);function g(e){return!!e&&e.uploads.values.length>0}const v=(0,h.M)("uploading",(function(){const e=f(),[t,n]=(0,s.useState)(g(e));return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){n(g(e))}const i=e.uploads.onChanged(t);return t(),()=>i.cancel()}),[e]),t}));var y=n(54119),b=n(2212),S=n(22026),E=n(36589),T=n(36616),w=n(71843),x=n(47931),_=n(9042),M=n(87443),O=n(10047),A=n(19822),C=n(18253),N=n(90636),D=n(51663),I=n(84282),L=n(82068),P=n(7583),R=n(29605),k=n(40895),U=n(16881);const B=/[&?,%]/,F=`Keyword may not include these characters: "${(e=>{const t=e.toString();return t.substring(t.indexOf("[")+1,t.lastIndexOf("]")).split("").join('", "')})(B)}"`,V=e=>({id:e,text:e}),H=e=>B.test(e)?F:void 0,j=(0,s.forwardRef)((({initialKeywords:e,availableKeywords:t,onChange:n},r)=>{const o=(0,s.useCallback)((e=>{n&&n(e.map((e=>e.text)))}),[n]);return(0,i.jsx)(y.rR,{placeholder:"Add keywords",initialTokens:e.map(V),options:t.map(V),onChange:o,ref:r,maxLength:30,maxTokens:10,maxTokensValidationMsg:"Maximum keywords added",helpMessage:"Keywords will display in search",validateNewToken:H})}));var G=n(95987),z=n(22149),W=n(80312);const K=Object.freeze({pink:"#f78da7",plum:"#9c4b92",purple:"#673ab7",teal:"#03687d",cerulean:"#03a9f4",ocean:"#00bcd4",fog:"#abb8c3",iron:"#607d8b",forest:"#417505",emerald:"#51a868",mint:"#37d67a",lime:"#cddc39",canary:"#fbcd00",sunflower:"#ffac17",tangerine:"#ff6900",sunset:"#f44336",sierra:"#d44441",magenta:"#e91e63"}),Y=K.cerulean,q=Object.entries(K).map((([e,t])=>({text:e,id:t,value:t}))),Z=({selectedColor:e,onChange:t})=>(0,i.jsx)(y.Q5,{onChange:t,options:q,selectedColor:e||Y,align:y.jr.JUSTIFY,noSelectionText:"Choose a color..."});var $=n(91724);const Q=({label:e="Appearance",pinAppearance:t,onChange:n})=>{const r=(0,W.z)(),o=(0,s.useCallback)((e=>{r.trackGuiEvent("pin_change_color"),n({color:e})}),[n,r]),a=(0,s.useCallback)((e=>{r.trackGuiEvent(e?"pin_show_stem":"pin_hide_stem"),n({stemEnabled:e})}),[n,r]),l=(0,s.useCallback)((e=>{r.trackGuiEvent("pin_change_stem_height"),n({stemLength:e})}),[n,r]);return(0,i.jsxs)("div",Object.assign({className:"pin-appearance-editor"},{children:[(0,i.jsx)("div",Object.assign({className:"h6"},{children:e})),(0,i.jsx)(Z,{onChange:o,selectedColor:t.color}),(0,i.jsx)($.r,{stemLength:t.stemLength||.3048,stemEnabled:t.stemEnabled||!1,onLengthUpdate:l,onLengthChanged:l,onStemEnabledChanged:a,variant:"inline-value",disabled:!t.stemEnabled})]}))};var X=n(99380),J=n(65143),ee=n(41270),te=n(98461),ne=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{MATTERTAGS:ie,OBJECT_TAG_SUGGESTION:se}=d.Z.WORKSHOP;let re=class TagEditor extends s.Component{constructor(e){super(e),this.uploadTooltipTimeout=0,this.bindings=[],this.keywordInput=(0,s.createRef)(),this.isUnmounting=!1,this.revertPendingAppearanceChanges=()=>{const{tag:e}=this.props;e&&this.isAppearanceDirty()&&this.context.commandBinder.issueCommand(new X.tE(e.id,J.Er.MATTERTAG,{color:e.color,stemEnabled:e.stemEnabled,stemLength:e.stemLength}))},this.updateAttachments=()=>{if(this.isUnmounting||this.state.closing)return;const{tag:e,manager:t}=this.props,{attachmentsData:n}=t.dataMap,i=n.getPendingAttachmentsForAsset(e.id,S.u.MATTERTAG),s=n.getRemovedAttachmentsForAsset(e.id,S.u.MATTERTAG),r=n.failures.values,o=n.uploads.values;this.setState({pendingAttachments:i,removedAttachments:s,failures:r,uploads:o},(()=>{this.updateEmbed(),this.updateDirtyState(),this.updateAttachmentViewer()}))},this.isAppearanceDirty=()=>{const{tag:e}=this.props,{pendingAppearance:t}=this.state;return Object.keys(t).some((n=>e[n]!==t[n]))},this.onDescriptionInput=e=>{this.setState({descriptionLength:e.length},(()=>this.updateDirtyState()))},this.handleDescriptionFocusChange=e=>{this.setState({isDescFocused:e})},this.onLabelInput=e=>{this.setState({label:e},(()=>this.updateDirtyState()))},this.handleKeywordsChanged=e=>{this.setState({keywords:e},(()=>this.updateDirtyState()))},this.onCancel=()=>{this.state.closing||(this.setState({closing:!0}),this.props.creating?this.context.commandBinder.issueCommand(new A.$g):this.closeTag())},this.onSave=async()=>{var e,t;if(this.state.closing)return;if(this.setState({closing:!0}),this.isEmpty())return void this.onCancel();const{tag:n,manager:i}=this.props,{label:s,keywords:r,pendingAppearance:o,showOnlyInSearch:a}=this.state,{commandBinder:l}=this.context,{attachmentsData:c}=i.dataMap,d=this.getDescriptionMarkdown(),{id:u,anchorPosition:h,stemNormal:p,floorId:m,objectAnnotationId:f}=n,g={position:h,normal:p,floorId:m,description:d,label:s,keywords:r,color:new b.Color(o.color||n.color),stemHeight:null!==(e=o.stemLength)&&void 0!==e?e:n.stemLength,stemVisible:null!==(t=o.stemEnabled)&&void 0!==t?t:n.stemEnabled,enabled:!0,objectAnnotationId:f},v=e=>e.category===_.G.UPLOAD,y=c.getPendingAttachmentsForAsset(u,S.u.MATTERTAG).filter(v),E=c.getRemovedAttachmentsForAsset(u,S.u.MATTERTAG).filter(v),T=this.getCurrentEmbed();a?(await l.issueCommand(new X.OL(u,J.Er.MATTERTAG)),await l.issueCommand(new te.I2(u,g,y,T))):await l.issueCommand(new A.QG(u,g,y,E,T)),f&&l.issueCommand(new z.s7),this.setState({pendingAppearance:{}})},this.onLabelDone=e=>{this.textEditor&&this.textEditor.toggleEditing(!0)},this.onDescriptionDone=()=>{this.embedEditor&&this.embedEditor.focus()},this.openLinkEditor=()=>{!(this.props.openModal===T.P.LINK_EDITOR)&&this.textEditor&&(this.trackEvent("tags_editor_add_link"),this.textEditor.prepareLinkForEdit())},this.onClickBlock=e=>{e.blockType===E.C.LINK&&(this.setState({selectedBlock:e}),this.context.commandBinder.issueCommand(new w.Bz(T.P.LINK_EDITOR,!0)))},this.closeLinkEditor=async()=>this.context.commandBinder.issueCommand(new w.Bz(T.P.LINK_EDITOR,!1)),this.onCancelLink=async()=>{await this.closeLinkEditor(),this.textEditor&&this.textEditor.cancelLink()},this.onRemoveLink=()=>{this.trackEvent("tags_editor_remove_link"),this.onSaveLink("","")},this.onSaveLink=(e,t)=>{const{openModal:n}=this.props;n===T.P.LINK_EDITOR&&this.textEditor&&(this.trackEvent("tags_editor_save_link"),this.textEditor.saveLink(e,t),this.updateDirtyState(),this.closeLinkEditor())},this.onFileUpload=e=>{const{tag:t}=this.props,n=Array.from(e),i=this.getAttachmentCount(!1);e.length+i>O.yk&&n.splice(O.yk-i),this.context.commandBinder.issueCommand(new M.It(t.id,S.u.MATTERTAG,n))},this.onDrop=e=>{this.trackEvent("tags_files_dropped"),this.onFileUpload(e)},this.onFilesChosen=e=>{this.trackEvent("tags_files_chosen"),this.onFileUpload(e)},this.onEmbed=async e=>{this.trackEvent("tags_editor_save_embed");const t=this.getCurrentEmbed(e.id);t&&await this.context.commandBinder.issueCommand(new M.$T(t))},this.onViewAttachments=e=>{const t=this.getCurrentAttachments();t.length&&(this.trackEvent("tags_editor_view_attachment"),this.context.commandBinder.issueCommand(new M.xW(!0,t,e)))},this.onToggleShowOnlyInSearch=()=>{this.setState({showOnlyInSearch:!this.state.showOnlyInSearch})},this.setTextEditorRef=e=>this.textEditor=e,this.setEmbedRef=e=>this.embedEditor=e,this.handlePinAppearanceChange=e=>{const{tag:t}=this.props,{pendingAppearance:n}=this.state;if(!t)return;const i=Object.assign(Object.assign({},n),e);this.context.commandBinder.issueCommand(new X.tE(t.id,J.Er.MATTERTAG,i)),this.setState({pendingAppearance:i},(()=>this.updateDirtyState()))},this.state={saveable:!1,closing:!1,showOnlyInSearch:!1,selectedBlock:null,label:e.tag.label,keywords:e.tag.keywords||[],descriptionLength:this.getDescriptionMarkdown().length,mediaSrc:"",pendingAttachments:[],removedAttachments:[],uploads:[],failures:[],pendingAppearance:{color:e.tag.color,stemEnabled:e.tag.stemEnabled,stemLength:e.tag.stemLength},isDescFocused:!1}}componentDidMount(){const{attachmentsData:e}=this.props.manager.dataMap;this.bindings.push(e.onChanged(this.updateAttachments)),this.updateAttachments()}componentWillUnmount(){this.revertPendingAppearanceChanges(),this.isUnmounting=!0,window.clearTimeout(this.uploadTooltipTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){const{tag:n,openModal:i}=this.props;n.id!==e.tag.id&&(this.setState({saveable:!1,label:n.label,descriptionLength:n.description.length}),this.updateAttachments()),e.openModal===T.P.LINK_EDITOR&&e.openModal!==i&&this.setState({selectedBlock:null})}trackEvent(e){this.context.analytics.trackToolGuiEvent("tags",e)}updateEmbed(){const e=this.getCurrentEmbed();this.setState({mediaSrc:e?e.src:""})}isEmpty(){return""===this.getDescriptionMarkdown()&&""===this.state.label.trim()&&0===this.getAttachmentCount(!1)}getDirtyState(){const{tag:e,creating:t}=this.props;if(t)return!0;const{pendingAttachments:n,removedAttachments:i,uploads:s,label:r,keywords:o}=this.state,a=this.getDescriptionMarkdown()!==e.description,l=r!==e.label,c=!(0,G.E8)(o,e.keywords),d=this.isAppearanceDirty();return a||l||c||d||i.length>0||n.length>0||s.length>0}updateDirtyState(){const e=this.getDirtyState(),t=this.isEmpty(),n=!e||t;this.setState({saveable:!n}),this.props.manager.setDirtyTagState(e)}closeTag(){this.context.commandBinder.issueCommand(new A.xb)}getDescriptionMarkdown(){const{tag:e}=this.props;let t;return t=this.textEditor?this.textEditor.getMarkdown():e.description,t.trim()}getCurrentEmbed(e=""){const t=t=>t.category===_.G.EXTERNAL&&t.id!==e,n=this.state.pendingAttachments.find(t);if(n)return n;const{tag:i,manager:s}=this.props,{attachmentsData:r}=s.dataMap,o=i.attachments.filter((e=>t(e)&&!(r&&r.removals.get(e.id))));return o.length>0?o[0]:null}getAttachmentCount(e){const{tag:t}=this.props,{pendingAttachments:n,removedAttachments:i,uploads:s}=this.state;let r=t.attachments.length+n.length+s.length-i.length;return e&&(r-=this.getCurrentAttachments(_.G.EXTERNAL).length),r}isAtMaxAttachments(){return this.getAttachmentCount(!1)>=O.yk}getCurrentAttachments(e){const{tag:t,manager:n}=this.props,{attachmentsData:i}=n.dataMap,{pendingAttachments:s}=this.state;return t.attachments.concat(s).filter((t=>!(e&&t.category!==e||i&&i.removals.get(t.id))))}updateAttachmentViewer(){const{openModal:e}=this.props,{commandBinder:t}=this.context;if(e===T.P.ATTACHMENT){const e=this.getCurrentAttachments();e.length?t.issueCommand(new M.xW(!0,e)):t.issueCommand(new w.Bz(T.P.ATTACHMENT,!1))}}renderLinkOption(){const{locale:e}=this.context,{descriptionLength:t}=this.state,n=e.t(ie.LINK_TOOLTIP_MESSAGE),s=t>=C.Us;return(0,i.jsx)("div",Object.assign({className:"annotation-button-bar"},{children:(0,i.jsx)("div",Object.assign({className:"annotation-editors"},{children:(0,i.jsx)(y.zx,{icon:"add-link",ariaLabel:n,tooltip:n,tooltipOptions:{placement:"bottom"},size:y.qE.LARGE,variant:y.Wu.TERTIARY,disabled:s,onClick:this.openLinkEditor})}))}))}renderEmbed(){const{tag:e}=this.props,{mediaSrc:t}=this.state,n=t?this.getCurrentEmbed():null;return(0,i.jsxs)("div",Object.assign({className:"tag-editor-embeds"},{children:[(0,i.jsx)(P.M,{ref:this.setEmbedRef,url:t,parentId:e.id,parentType:S.u.MATTERTAG,onEmbed:this.onEmbed}),n&&(0,i.jsx)(N.s,{canDelete:!0,inline:!1,attachments:[n],onViewAttachment:this.onViewAttachments})]}))}renderUploadButton(e,t,n){const{tag:s}=this.props,{locale:r}=this.context,{uploads:o}=this.state,a=o.length>0,l=n?r.t(ie.MAX_ATTACHMENTS_MESSAGE,O.yk):a?r.t(ie.UPLOAD_IN_PROGRESS):e?void 0:r.t(ie.UPLOAD_FILE),d=r.t(ie.ADD_FILE),u=c()("file-upload-btn","mp-nova-btn","mp-nova-btn-dark",{"mp-nova-btn-icon":!e,"mp-nova-btn-disabled":!t,"mp-nova-btn-large":!e,"mp-nova-btn-small":e,"mp-nova-btn-primary":e,"mp-nova-btn-multi":e});return(0,i.jsx)(I.p,Object.assign({id:`file-upload-tag-${s.id}`,multi:!0,enabled:t,onUpload:this.onFilesChosen,tooltip:l},{children:(0,i.jsxs)("div",Object.assign({className:u},{children:[(0,i.jsx)(y.JO,{name:"plus"}),e&&(0,i.jsx)("span",{children:d})]}))}))}renderFileAttachments(){const{uploads:e,failures:t}=this.state,{locale:n}=this.context,s=this.isAtMaxAttachments(),r=0===this.getAttachmentCount(!0)&&0===t.length,o=e.length>0,a=!s&&!o,l=this.getCurrentAttachments(_.G.UPLOAD),d=this.renderUploadButton(r,a,s),u=n.t(ie.DROP_FILES_MESSAGE);return(0,i.jsxs)(L.Z,Object.assign({className:c()("tag-attachments",{empty:r}),onDropped:this.onDrop,disabled:!a},{children:[(0,i.jsx)(N.s,Object.assign({inline:!0,canDelete:!0,attachments:l,uploads:e,failures:t,onViewAttachment:this.onViewAttachments},{children:!r&&d})),r&&(0,i.jsxs)(i.Fragment,{children:[d,(0,i.jsx)("div",Object.assign({className:"upload-msg"},{children:(0,i.jsx)("div",{children:u})}))]})]}))}renderDescription(){const{manager:e,tag:t}=this.props,{locale:n}=this.context,s=n.t(ie.DESCRIPTION_PLACEHOLDER);return(0,i.jsx)(D.b,{className:"placeholder",ref:this.setTextEditorRef,textParser:e.textParser,text:t.description,active:!0,clickToEdit:!1,focusOnMount:!1,maxLength:C.Us,placeholder:s,onClickBlock:this.onClickBlock,onInput:this.onDescriptionInput,onDoneEditing:this.onDescriptionDone,onFocusChange:this.handleDescriptionFocusChange,onCancelEditing:this.onCancel})}renderButtons(){const{locale:e}=this.context,{uploads:t,saveable:n,closing:s}=this.state,r=t.length>0,o=!n||r||s,a=r,l=e.t(ie.EDIT_BILLBOARD_CANCEL_CTA),c=e.t(ie.SAVE);return(0,i.jsxs)(y.hE,{children:[(0,i.jsx)(y.zx,{label:l,variant:y.Wu.TERTIARY,size:y.qE.SMALL,disabled:a,onClick:this.onCancel}),(0,i.jsx)(y.zx,{label:c,variant:y.Wu.PRIMARY,size:y.qE.SMALL,disabled:o,onClick:this.onSave})]})}renderShowOnlyInSearchCheckbox(){const{locale:e}=this.context,t=e.t(se.SHOW_ONLY_IN_SEARCH);return(0,i.jsx)(ee.X,{checked:this.state.showOnlyInSearch,onChange:this.onToggleShowOnlyInSearch,stopPropagation:!0,label:t})}render(){const{selectedBlock:e,label:t,descriptionLength:n,isDescFocused:s,pendingAppearance:r}=this.state,{tag:o,availableKeywords:a,creating:l}=this.props,{locale:d}=this.context,u=d.t(ie.TITLE_PLACEHOLDER),h=d.t(ie.TITLE_DESC_LABEL),p=d.t(ie.ATTACHMENTS_LABEL),m=d.t(ie.APPEARANCE_LABEL),f=d.t(ie.KEYWORDS_LABEL),g=this.props.manager.areKeywordsEnabled();let v="",y="";return e&&e.blockType===E.C.LINK&&(v=e.text,y=e.value||""),(0,i.jsxs)("div",Object.assign({className:"tag-editor"},{children:[(0,i.jsx)("div",Object.assign({className:"h6"},{children:h})),(0,i.jsx)(R.Z,{text:t,placeholder:u,maxLength:C.ZF,focusOnMount:!0,onDone:this.onLabelDone,onInput:this.onLabelInput,onCancel:this.onCancel}),(0,i.jsx)(k.R,{current:t.length,max:C.ZF}),(0,i.jsxs)("div",Object.assign({className:c()("annotation-text-box annotating editor-box",s&&"has-focus")},{children:[this.renderDescription(),this.renderLinkOption()]})),(0,i.jsx)(k.R,{current:n,max:C.Us}),(0,i.jsx)("div",Object.assign({className:"h6"},{children:p})),this.renderFileAttachments(),this.renderEmbed(),(0,i.jsx)(Q,{label:m,onChange:this.handlePinAppearanceChange,pinAppearance:r}),g&&(0,i.jsxs)("div",Object.assign({className:"annotation-keyword-input"},{children:[(0,i.jsx)("div",Object.assign({className:"h6"},{children:f})),(0,i.jsx)(j,{ref:this.keywordInput,initialKeywords:o.keywords||[],availableKeywords:a,onChange:this.handleKeywordsChanged})]})),l&&g&&(0,i.jsx)("div",Object.assign({className:"tag-editor-search-only-checkbox"},{children:this.renderShowOnlyInSearchCheckbox()})),(0,i.jsx)("div",Object.assign({className:"button-sticky-footer"},{children:this.renderButtons()})),(0,i.jsx)(U.I,{linkText:v,linkUrl:y,onCancelLink:this.onCancelLink,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink})]}))}};re.contextType=o.I,re=ne([r.Z],re);const oe=(0,x.W)(re);var ae=n(58361),le=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{MATTERTAGS:ce}=d.Z.WORKSHOP,{TAGS:de}=d.Z.SHOWCASE;let ue=class TagWidget extends s.Component{constructor(e){super(e),this.deleteTag=async()=>{const{tag:e}=this.props;return this.context.analytics.trackToolGuiEvent("tags","tags_click_delete_tag"),this.props.manager.confirmAndDeleteTag(e.id,"tags_detail_panel_widget")},this.closeTag=async()=>this.props.manager.closeTag(),this.state={cancellingCreation:!1}}shouldComponentUpdate(){return!this.state.cancellingCreation}render(){const{locale:e,editMode:t}=this.context,{tag:n,manager:s,uploading:r,creatingTag:o}=this.props,a=e.t(ce.BACK),l=e.t(ce.DELETE_LIST_ITEM_OPTION_CTA),d=e.t(de.SHARE_TAG_LABEL);return(0,i.jsxs)("div",Object.assign({className:c()("tag-widget","annotating",{creating:o})},{children:[!o&&(0,i.jsxs)("div",Object.assign({className:"detail-panel-header"},{children:[(0,i.jsx)(y.zx,{label:a,className:"return-btn",icon:"back",size:y.qE.SMALL,variant:y.Wu.TERTIARY,disabled:r,onClick:this.closeTag}),(0,i.jsxs)("div",Object.assign({className:"tag-header-buttons"},{children:[!t&&(0,i.jsx)(ae.O,{prefix:"tag",pin:n,id:n.id,label:d,includeCameraView:!0,analyticAction:"tags_copy_share_link"}),(0,i.jsx)(y.zx,{label:l,className:"delete-btn",icon:"delete",size:y.qE.SMALL,variant:y.Wu.TERTIARY,disabled:r,onClick:this.deleteTag})]}))]})),(0,i.jsx)("div",Object.assign({className:"tag"},{children:(0,i.jsx)(oe,{tag:n,manager:s,availableKeywords:s.getAvailableKeywords(),creating:o},n.id)}))]}))}};ue.contextType=o.I,ue=le([r.Z],ue);const he=v((0,u.l)(ue));var pe=n(37884),me=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let fe=class TagDetailsPanel extends s.Component{constructor(e){super(e),this.setToolPanelRef=e=>{e&&(this.toolPanel=e)}}componentDidUpdate(e){var t;const{modalOpen:n,tag:i}=this.props;this.toolPanel&&((null===(t=e.tag)||void 0===t?void 0:t.id)!==(null==i?void 0:i.id)||e.modalOpen&&!n)&&this.toolPanel.resetScrollTop()}render(){const{tag:e,closing:t,modalOpen:n,toolPanelLayout:s,manager:r}=this.props,o=s===a.wS.BOTTOM_PANEL,l=!(!e||t||o&&n);return(0,i.jsx)(pe.J,Object.assign({ref:this.setToolPanelRef,open:l,toolPanelLayout:s,scrollingDisabled:!1},{children:e&&(0,i.jsx)(he,{manager:r,tag:e})}))}};fe.contextType=o.I,fe=me([r.Z],fe)},98529:(e,t,n)=>{"use strict";n.d(t,{s:()=>h});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(54119),l=n(22149),c=n(60405),d=n(34612),u=n(23676);const h=({keywords:e,className:t,maxVisible:n=2,theme:r})=>{const{engine:h}=(0,s.useContext)(c.I),p=(0,s.useCallback)((({text:e},t)=>{t.stopPropagation(),h.commandBinder.issueCommand(new d.tT(u.w1.SEARCH,!0)),h.commandBinder.issueCommand(new l.FZ([e]))}),[h]);return(0,i.jsx)(a.no,{className:o()("tag-keywords",t),tokens:e.map((e=>({id:e,text:e}))),onTokenClick:p,maxVisibleTruncated:n,tokenSize:"small",tokenTheme:r})}},51551:(e,t,n)=>{"use strict";n.d(t,{Q:()=>TagsManager});var i=n(64921),s=n(6058),r=n(24486),o=n(65453),a=n(14279),l=n(73156),c=n(71907),d=n(4254),u=n(2710),h=n(4752),p=n(56044),m=n(49315),f=n(40825),g=n(69826),v=n(19822);class TagsManager{constructor(e,t){this.engine=e,this.initialized=!1,this.bindings=[],this.textParser=new i.v({links:!0}),this.disabledEditorAssets={[a.U]:!1,[o.Nj]:!1,[r.s]:!1,[l.Mp]:!1},this.settingsToggler=new s.u(t,this.disabledEditorAssets),this.initPromise=this.init()}async init(){const e=this.engine.market;return Promise.all([e.waitForData(g.n),e.waitForData(h.b),e.waitForData(p.c),e.waitForData(m.A),e.waitForData(f.B)]).then((([e,t,n,i,s])=>(this.dataMap={tagsViewData:e,attachmentsData:t,floorsViewData:n,annotationsViewData:i,pinsViewData:s},!0)))}async activate(){const e=this.engine;if(this.initialized)for(const e of this.bindings)e.renew();else this.initialized=!0,await this.initPromise;this.settingsToggler.toggle(!0),await e.commandBinder.issueCommand(new v.yU(!0))}async deactivate(){this.settingsToggler.toggle(!1),await this.engine.commandBinder.issueCommand(new v.yU(!1))}creatingTag(){return this.dataMap.tagsViewData.creatingTag}getAvailableKeywords(){var e,t;return null===(t=null===(e=this.dataMap)||void 0===e?void 0:e.tagsViewData)||void 0===t?void 0:t.getAvailableKeywords()}areKeywordsEnabled(){var e,t;return(null===(t=null===(e=this.dataMap)||void 0===e?void 0:e.tagsViewData)||void 0===t?void 0:t.keywordsEnabled)||!1}async confirmAndDeleteTag(e,t){const n=(0,u.nQ)();if(await this.engine.commandBinder.issueCommand(new c.Q(c.f.DISPLAY,n))!==d.U.CLOSE)return this.deleteTag(e,t)}closeTag(){return this.engine.commandBinder.issueCommand(new v.xb)}deleteTag(e,t){return this.engine.commandBinder.issueCommand(new v.T3(e,t))}editTag(e){return this.engine.commandBinder.issueCommand(new v.zt(e))}setDirtyTagState(e){return this.engine.commandBinder.issueCommand(new v.q4(e))}setTagVisibility(e,t){this.engine.commandBinder.issueCommand(new v.bg(e,t))}}},43008:(e,t,n)=>{"use strict";n.d(t,{O:()=>p});var i=n(85893),s=n(67294),r=n(57340),o=n(60405),a=n(23676),l=n(14832),c=n(19822),d=n(69826),u=n(77492),h=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let p=class TagsNavigationBar extends s.Component{constructor(e){super(e),this.bindings=[],this.isUnmounting=!1,this.updateOpenTag=()=>{if(this.isUnmounting)return;!this.tagsViewData.openTagView&&this.state.navigating||this.setState({openTagView:this.tagsViewData.openTagView,listIndex:this.tagsViewData.getOpenTagFlatListIndex(!1)})},this.updateTags=()=>{this.isUnmounting||(this.setState({numTags:this.tagsViewData.tagViewList.values().length}),this.updateOpenTag())},this.onNavigateList=e=>{const t=this.tagsViewData.getTagViewByIndex(e);if(!t)return;this.setState({listIndex:e,navigating:!0});const{openTagView:n}=this.state,{toolPanelLayout:i,analyticAction:s}=this.props,r=n?i===a.wS.BOTTOM_PANEL?l.n.Instant:l.n.FadeToBlack:l.n.Interpolate;this.context.analytics.trackToolGuiEvent("tags",s),this.context.commandBinder.issueCommand(new c.lt(t.id,r,null)).then((()=>{this.isUnmounting||this.setState({navigating:!1})}))},this.state={openTagView:null,listIndex:-1,numTags:0,navigating:!1}}componentDidMount(){const{market:e}=this.context;Promise.all([e.waitForData(d.n)]).then((e=>{[this.tagsViewData]=e,this.bindings.push(this.tagsViewData.onOpenTagViewChanged(this.updateOpenTag),this.tagsViewData.tagViewList.onChanged(this.updateTags)),this.updateOpenTag(),this.updateTags()}))}componentWillUnmount(){this.isUnmounting=!0;for(const e of this.bindings)e.cancel()}render(){const{overlay:e}=this.props,{openTagView:t,listIndex:n,numTags:s,navigating:r}=this.state;return t&&s>1?(0,i.jsx)(u.$,{index:n,total:s,disabled:r,overlay:e,wrapAround:!0,onNavigate:this.onNavigateList}):null}};p.contextType=o.I,p=h([r.Z],p)},17201:(e,t,n)=>{"use strict";n.d(t,{r:()=>l});var i=n(85893),s=n(47931),r=n(81661),o=n(82289),a=n(43008);n(37067);function l(){const e=(0,s.R)(),t=(0,r.x)(),n=(0,o.T)();return e||t?null:(0,i.jsx)("div",Object.assign({className:"overlay tags-overlay"},{children:(0,i.jsx)("div",Object.assign({className:"overlay-top-center"},{children:(0,i.jsx)("div",Object.assign({className:"overlay-info"},{children:(0,i.jsx)(a.O,{toolPanelLayout:n,overlay:!0,analyticAction:"tags_navigate_in_canvas"})}))}))}))}},37884:(e,t,n)=>{"use strict";n.d(t,{J:()=>DetailPanel});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(60405),c=n(2252),d=n(56829),u=n(23676),h=n(57340),p=n(91033),m=n(37917),f=n(58844),g=n(44450),v=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e.CENTER="center",e.TOP="top"}(i||(i={}));let y=class Scroller extends r.Component{constructor(e){super(e),this.usePointerEvents=window.PointerEvent,this.scrollerRef=(0,r.createRef)(),this.trackRef=(0,r.createRef)(),this.thumbRef=(0,r.createRef)(),this.focusedSelector=null,this.listening=!1,this.startY=0,this.onThumb=!1,this.scrollTop=0,this.isUnmounting=!1,this.handleResize=()=>{this.isUnmounting||(this.computeStateValues(),this.focusedSelector&&this.scrollToSelector(this.focusedSelector))},this.handleWheelEvent=e=>{this.props.disabled||(this.onThumb=!1,this.focusedSelector=null,this.scrollBy(e.deltaY))},this.handleEvent=e=>{if(this.scrollerRef.current&&!this.props.disabled){this.scrollVelocityPixelsMS=0;if("mousedown"===e.type||"pointerdown"===e.type||"touchstart"===e.type){const t=e.target;this.onThumb=t&&t.classList.contains("scroller-thumb")}this.focusedSelector=null,this.inputFilter.handleEvent(e)}},this.handlePressStart=e=>{this.onThumb?this.startY=this.getThumbTop():this.startY=this.getScrollTop()},this.handlePressMove=e=>{const{trackHeight:t,contentsHeight:n}=this.state;let i;this.onThumb?(i=(this.startY-e.y)/t,this.scrollToPercent(i)):(i=(e.y+this.startY)/n,this.scrollToPercent(i))},this.handleDragStart=()=>{},this.handleDragEnd=(e,t)=>{this.scrollVelocityPixelsMS=e.y/t,this.lastScrollTimeMS=void 0,Math.abs(this.scrollVelocityPixelsMS)<1?this.scrollVelocityPixelsMS=0:this.animateScroll()},this.onTrackClick=e=>{const t=this.trackRef.current;if(e.target!==t||!t)return;const n=this.getThumbHeight(),i=this.getThumbTop(),s=t.getBoundingClientRect().top,r=this.state.trackHeight;let o;o=e.clientY<s+i?Math.max(0,(i-n)/r):Math.min(r,(i+n)/r),this.scrollToPercent(o)},this.scrollToPercent=e=>{this.isOverflowing()&&this.scrollerRef.current&&!isNaN(e)&&this.setScrollPosition(Math.max(Math.min(1,e)*this.state.contentsHeight,0))},this.scrollBy=e=>{this.isOverflowing()&&this.scrollerRef.current&&!isNaN(e)&&this.setScrollPosition(Math.max(this.scrollerRef.current.scrollTop+e,0))},this.computeStateValues=()=>{if(this.props.disabled)return;const e=this.scrollerRef.current,t=this.trackRef.current,n=Number(e&&e.clientHeight)||1,i=Number(t&&t.clientHeight)||n,s=Number(this.contents&&this.contents.clientHeight)||1,r=Number(this.contents&&this.contents.offsetTop)||0;this.debouncedSetState({scrollerHeight:n,contentsHeight:s,trackHeight:i,offsetTop:r})},this.debouncedSetState=e=>{new URL(`${document.location}`).searchParams.get("temp-disable-debounce-scroll")?this.setState(e):(cancelAnimationFrame(this.rAFHandle),this.rAFHandle=requestAnimationFrame((()=>{this.isUnmounting||this.setState(e)})))},this.setContentsRef=e=>{e?(this.contents=e,this.resizeObserver.observe(this.contents)):this.contents&&this.resizeObserver.unobserve(this.contents)},this.state={scrollerHeight:1,contentsHeight:1,trackHeight:1,offsetTop:0},this.resizeObserver=new p.Z(this.handleResize),this.resizeSubscription=(0,g.kp)(g.g_.RESIZE,this.handleResize),this.inputFilter=new f.Z({handlePressStart:this.handlePressStart,handlePressMove:this.handlePressMove,handleDragStart:this.handleDragStart,handleDragEnd:this.handleDragEnd})}componentDidMount(){this.toggleEventHandling(!0),this.computeStateValues()}componentWillUnmount(){this.isUnmounting=!0,this.toggleEventHandling(!1),this.resizeObserver&&this.resizeObserver.disconnect()}componentDidUpdate(e,t){this.scrollerRef.current&&e.disabled!==this.props.disabled&&(this.props.disabled?this.toggleEventHandling(!1):this.toggleEventHandling(!0))}resetScrollTop(){this.focusedSelector=null,this.setScrollPosition(0)}getScroller(){return this.scrollerRef.current}getScrollHeight(){return Number(this.contents&&this.contents.clientHeight)||0}scrollToElement(e,t=i.CENTER){const n=this.scrollerRef.current;if(!e||!n)return;if(!(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINS))return;if(!this.isOverflowing())return;const{contentsHeight:s,scrollerHeight:r,offsetTop:o}=this.state;let a=e.offsetTop,l=e;for(;l.parentElement&&(l=l.parentElement,a+=l.offsetTop,l.offsetParent!==this.contents););let c=o+a;t===i.CENTER&&(c+=e.offsetHeight/2-r/2),c=Math.max(Math.min(s,c),0);const d=n.scrollTop,u=c-d;let h=0;const p=e=>{h||(h=e);const t=e-h,i=Math.min(t/500,1);n.scrollTo(0,d+u*i),t<500?window.requestAnimationFrame(p):this.setScrollPosition(c)};window.requestAnimationFrame(p)}scrollToSelector(e){const t=this.scrollerRef.current;if(!t)return;const n=t.querySelector(e);n?(this.focusedSelector=e,this.scrollToElement(n)):this.focusedSelector=null}setScrollPosition(e){const t=this.scrollerRef.current;if(t){const n=t.scrollTop;t.scrollTop=e,this.scrollTop=this.getScrollTop(),this.props.onScrolled&&n!==this.scrollTop&&this.props.onScrolled();const i=this.thumbRef.current;i&&(i.style.height=`${this.getThumbHeight()}px`,i.style.top=`${this.getThumbTop()}px`)}}toggleEventHandling(e){const t=this.scrollerRef.current,n=this.handleEvent,i=m.h?{passive:!0}:void 0;!this.listening&&e&&t?(this.resizeSubscription.renew(),t.addEventListener("wheel",this.handleWheelEvent,i),this.usePointerEvents?(t.addEventListener("pointerdown",n,i),window.addEventListener("pointermove",n,i),window.addEventListener("pointerup",n,i)):(t.addEventListener("touchstart",n,i),t.addEventListener("mousedown",n,i),window.addEventListener("mousemove",n,i),window.addEventListener("mouseleave",n,i),window.addEventListener("mouseup",n,i),window.addEventListener("touchmove",n,i),window.addEventListener("touchend",n,i),window.addEventListener("touchcancel",n,i))):this.listening&&!e&&t&&(this.resizeSubscription.cancel(),t.removeEventListener("wheel",this.handleWheelEvent),this.usePointerEvents?(t.removeEventListener("pointerdown",n),window.removeEventListener("pointermove",n),window.removeEventListener("pointerup",n)):(t.removeEventListener("touchstart",n),t.removeEventListener("mousedown",n),window.removeEventListener("mousemove",n),window.removeEventListener("mouseleave",n),window.removeEventListener("mouseup",n),window.removeEventListener("touchmove",n),window.removeEventListener("touchend",n),window.removeEventListener("touchcancel",n)))}animateScroll(){window.requestAnimationFrame((e=>{void 0===this.lastScrollTimeMS&&(this.lastScrollTimeMS=e);let t=e-this.lastScrollTimeMS;if(t>0){this.scrollBy(this.scrollVelocityPixelsMS*t);const e=this.scrollVelocityPixelsMS>0?-1:1;for(;t>0;)this.scrollVelocityPixelsMS+=this.scrollVelocityPixelsMS*this.scrollVelocityPixelsMS*.01*e,t-=1}Math.abs(this.scrollVelocityPixelsMS)>.001&&this.animateScroll()}))}getThumbTop(){const{contentsHeight:e,trackHeight:t}=this.state;return Math.min(this.scrollTop/e*t,t-this.getThumbHeight())}getThumbHeight(){const{scrollerHeight:e,contentsHeight:t,trackHeight:n}=this.state;return e/t*n}getScrollTop(){return this.scrollerRef.current?this.scrollerRef.current.scrollTop:0}isOverflowing(){const{contentsHeight:e,scrollerHeight:t,offsetTop:n}=this.state;return e+n>t}renderTrack(){const e={height:`${this.getThumbHeight()}px`,top:`${this.getThumbTop()}px`};return(0,s.jsx)("div",Object.assign({ref:this.trackRef,className:"scroller-track",onClick:this.onTrackClick},{children:(0,s.jsx)("div",{ref:this.thumbRef,className:"scroller-thumb",style:e,onPointerDown:this.usePointerEvents?this.handleEvent:void 0,onMouseDown:this.usePointerEvents?void 0:this.handleEvent,onTouchStart:this.usePointerEvents?void 0:this.handleEvent})}))}render(){const{children:e,className:t,hideThumb:n,disabled:i}=this.props,r=!i&&this.isOverflowing();return(0,s.jsxs)("div",Object.assign({className:a()("scroller-container",t)},{children:[(0,s.jsx)("div",Object.assign({className:"scroller-scroller",ref:this.scrollerRef},{children:(0,s.jsx)("div",Object.assign({className:"scroller-contents",ref:this.setContentsRef},{children:e}))})),!n&&r&&this.renderTrack()]}))}};y=v([h.Z],y);class DetailPanel extends r.Component{constructor(e){super(e),this.touchDevice=(0,c.Jm)(),this.bindings=[],this.handleTextBoxFocus=e=>{this.setState({textFocused:e.focused})},this.setScrollerRef=e=>{e&&(this.scroller=e)},this.state={textFocused:!1}}componentDidMount(){if(this.touchDevice){const{messageBus:e}=this.context;this.bindings.push(e.subscribe(d.SN,this.handleTextBoxFocus))}}componentWillUnmount(){this.bindings.map((e=>e.cancel()))}isPanelFitting(){const e=this.scroller&&this.scroller.getScroller();if(!e)return!1;return this.scroller.getScrollHeight()<=(window.visualViewport?window.visualViewport.height:window.innerHeight)-e.getBoundingClientRect().top}resetScrollTop(){this.scroller&&this.scroller.resetScrollTop()}scrollToSelector(e){this.scroller&&this.scroller.scrollToSelector(e)}render(){const{open:e,className:t,children:n,onScrolled:i,toolPanelLayout:r,scrollingDisabled:o}=this.props,{textFocused:l}=this.state,c=r===u.wS.BOTTOM_PANEL,d=this.touchDevice&&l&&c,h=c,p={open:e,"sticky-header":!d,"detail-panel-align-top":d&&!this.isPanelFitting()};return(0,s.jsx)("div",Object.assign({className:a()("detail-panel",p,t)},{children:(0,s.jsx)(y,Object.assign({ref:this.setScrollerRef,hideThumb:h,disabled:o,onScrolled:i},{children:n}))}))}}DetailPanel.contextType=l.I},46317:(e,t,n)=>{"use strict";n.d(t,{L:()=>ListPanel});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(34612),c=n(23676),d=n(68168),u=n(87982),h=n(20585),p=n(84475);class ListPanel extends s.Component{constructor(e){super(e),this.bindings=[],this.updateCollapsedState=()=>{this.setState({collapsedToBottom:this.context.toolsData.isPanelCollapsedToBottom()})},this.onToggleBottomCollapsed=e=>{const{collapsedToBottom:t,collapsing:n}=this.state;e&&e.stopPropagation(),n||(this.context.commandBinder.issueCommand(new l.zK(!t)),t||(this.setState({collapsing:!0}),window.setTimeout((()=>{this.setState({collapsing:!1})}),500)))},this.state={collapsedToBottom:e.toolPanelLayout===c.wS.BOTTOM_PANEL,collapsing:!1}}componentDidMount(){this.bindings.push(this.context.messageBus.subscribe(d.U7,this.updateCollapsedState)),this.updateCollapsedState()}componentWillUnmount(){this.bindings.forEach((e=>e.cancel()))}render(){const{active:e,toolPanelLayout:t,children:n,title:s,onClose:r,className:a,subheader:l,footer:d,subheaderCollapsedHeight:m}=this.props,{collapsedToBottom:f,collapsing:g}=this.state,v=t===c.wS.BOTTOM_PANEL,y=v&&f&&!g,b={active:e,collapsed:y},S=y?"icon-dpad-up":"icon-dpad-down",E=t===c.wS.BOTTOM_PANEL&&m&&f?{height:m+h.c9}:void 0;return(0,i.jsxs)("div",Object.assign({className:o()("list-panel",b,a),style:E},{children:[(s||r)&&(0,i.jsxs)("div",Object.assign({className:"list-panel-header",onClick:v?this.onToggleBottomCollapsed:void 0},{children:[s&&(0,i.jsx)(p._,{children:s}),(0,i.jsxs)("div",{children:[v&&(0,i.jsx)(u.hU,{iconClass:S,buttonStyle:u.Dd.PLAIN,onClick:this.onToggleBottomCollapsed}),r&&(0,i.jsx)(u.hU,{iconClass:"icon-close",buttonStyle:u.Dd.PLAIN,onClick:r})]})]})),m?l:!y&&(l||null),!y&&n,!y&&(d||null)]}))}}ListPanel.contextType=a.I},84475:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(85893),s=n(94184),r=n.n(s);const o=({children:e,className:t=""})=>{if(!e)return null;const n=r()("list-panel-title",t);return(0,i.jsx)("div",Object.assign({className:n},{children:e}))}},49563:(e,t,n)=>{"use strict";n.d(t,{g:()=>g});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=n(23676),c=n(34612),d=n(68168),u=n(60405),h=n(10854),p=n(70680),m=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const{PANELS:f}=h.Z;let g=class Panels extends s.Component{constructor(e){super(e),this.bindings=[],this.onToggleCollapse=e=>{this.setState({collapsed:e.collapsed})},this.toggleSidePanel=()=>{const{activeTool:e,toolPanelLayout:t}=this.props,{analytics:n}=this.context;e&&t===l.wS.SIDE_PANEL&&(n.track("showcase_gui",{gui_action:"toggle_side_panel"}),this.context.commandBinder.issueCommand(new c.zK(!this.state.collapsed)))},this.isPanelOpen=e=>{const{children:t}=this.props;return!(!t||!Array.isArray(t))&&t.some((t=>t&&t.key===e))},this.state={collapsed:!1}}componentDidMount(){this.bindings.push(this.context.engine.subscribe(d.U7,this.onToggleCollapse))}componentWillUnmount(){for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){const{sidePanelCollapsible:n,toolPanelLayout:i}=this.props,{collapsed:s}=this.state;s&&!n&&e.toolPanelLayout!==l.wS.SIDE_PANEL&&i===l.wS.SIDE_PANEL&&this.context.commandBinder.issueCommand(new c.zK(!1))}getPanelTool(){const{activeTool:e}=this.props;if(!e)return null;const t=this.context.toolsData.getTool(e);return t&&t.panel?e:null}renderSideToggle(){const{locale:e}=this.context,{sidePanelCollapsible:t,toolPanelLayout:n}=this.props;if(!(n===l.wS.SIDE_PANEL)||!t)return null;const{collapsed:s}=this.state,r=s?e.t(f.EXPAND_PANEL):e.t(f.COLLAPSE_PANEL),o=s?"icon-dpad-left":"icon-dpad-right";return(0,i.jsx)("div",Object.assign({className:"panel-track"},{children:(0,i.jsx)("div",Object.assign({className:"panel-track-thumb","data-balloon":r,"data-balloon-pos":"left",onClick:this.toggleSidePanel},{children:(0,i.jsx)("span",{className:`icon ${o}`})}))}))}render(){const{children:e,className:t}=this.props,{collapsed:n}=this.state,s=this.getPanelTool(),r=this.isPanelOpen(s),o={"panel-open":r&&!n,"panel-collapsed":r&&n},l=this.renderSideToggle();return(0,i.jsx)(p.N,Object.assign({className:a()("panels",o,t),open:r,firstChild:l||void 0,selectChild:!0,childKey:s||void 0},{children:e}))}};g.contextType=u.I,g=m([r.Z],g)},72366:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var i=n(23676);const s=(()=>{let e=0;return function(t,n){window.clearTimeout(e);const s=t.classList;switch(n){case i.wS.NORMAL:s.remove("narrow-layout"),s.contains("side-panel")?e=window.setTimeout((()=>{s.remove("side-panel")}),900):s.remove("bottom-panel");break;case i.wS.NARROW:s.add("narrow-layout"),s.contains("bottom-panel")?e=window.setTimeout((()=>{s.remove("bottom-panel")}),900):s.remove("side-panel");break;case i.wS.SIDE_PANEL:s.add("side-panel"),s.remove("bottom-panel","narrow-layout");break;case i.wS.BOTTOM_PANEL:s.remove("side-panel"),s.add("narrow-layout","bottom-panel")}}})()},9827:(e,t,n)=>{"use strict";n.d(t,{P:()=>EmptyReel});var i=n(85893),s=n(67294),r=n(60405),o=n(10854);const{HLR:a}=o.Z.SHOWCASE;class EmptyReel extends s.Component{render(){const{locale:e}=this.context,t=e.t(a.EMPTY_REEL_LEARN_MORE),n=e.t(a.EMPTY_REEL_TITLE),s=e.t(a.EMPTY_REEL_MESSAGE);return(0,i.jsx)("div",Object.assign({className:"empty-reel"},{children:(0,i.jsxs)("div",Object.assign({className:"no-highlights-message"},{children:[(0,i.jsx)("p",{children:n}),(0,i.jsxs)("p",{children:[s,(0,i.jsx)("a",Object.assign({className:"link",target:"_blank",href:"https://support.matterport.com/hc/en-us/articles/360019401733"},{children:t}))]})]}))}))}}EmptyReel.contextType=r.I},98683:(e,t,n)=>{"use strict";n.d(t,{i:()=>SimpleReel});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(61116),c=n(83670),d=n(29984),u=n(17445);const h=(0,d.C)([]);function p(){return function(){const e=(0,u.o)();return(0,c.i)(e?e.enabledTourStops:h)}().length}var m=n(84347),f=n(83869),g=n(72699);const v=(0,f.M)(g.k,"tourCurrentSnapshot",-1);var y,b=n(35318);function S(){const e=(0,b.s)(),t=(0,s.useRef)(e);return e.type===m.Aq.FloorChange?t.current:(t.current=e,e)}!function(e){e.FastForwarding="fast-forwarding",e.Idle="idle",e.Completed="completed",e.Paused="paused",e.Playing="playing",e.Rewinding="rewinding",e.Skipping="skipping"}(y||(y={}));const E=[y.FastForwarding,y.Playing,y.Rewinding],T=[m.Aq.Burns,m.Aq.Zoom,m.Aq.Delay];function w(){var e;const t=(0,s.useRef)(null),n=p(),i=v(),r=S(),o=r.toIndex,a=o!==i;let l=y.Idle;a?l=0===o&&i===n-1?y.FastForwarding:Math.abs(o-i)>1?y.Skipping:o<i?y.Rewinding:y.FastForwarding:T.includes(r.type)?l=r.active?y.Playing:y.Paused:r.type===m.Aq.Move&&r.active&&(l=y.Rewinding);let c=!1;if((null===(e=t.current)||void 0===e?void 0:e.index)!==i&&(t.current=null),(l===y.Rewinding||l===y.FastForwarding)&&t.current){const{animation:e,transition:n}=t.current;if(n!==r){const{started:t,stopped:i,duration:s}=n;(i-t)/s>=.99&&(c=!0,e===y.Rewinding&&(l=y.Idle),e!==y.Playing&&e!==y.FastForwarding||(l=y.Completed))}}return E.includes(l)?t.current={transition:r,animation:l,index:i}:c||(t.current=null),l}function x(){const e=(0,b.s)(),t=w(),[n,i]=(0,s.useState)(0),r=t===y.Playing,o=t===y.Idle;return(0,s.useEffect)((()=>{if(!r&&T.includes(e.type)){const{started:t,stopped:n,duration:s}=e;i((n-t)/s)}}),[r,e]),(0,s.useEffect)((()=>{o&&i(0)}),[o]),n}function _({index:e}){const t=p(),n=w(),s=v(),r=S(),a=x(),l=r.duration,c=r.toIndex,d=c===e,u=s===e,h=["story-tour-progress-bar"];if(n===y.Skipping)e>=c?h.push("story-tour-progress-bar--incomplete"):h.push("story-tour-progress-bar--complete");else if(u)switch(n){case y.Completed:h.push("story-tour-progress-bar--complete");break;case y.Playing:h.push("story-tour-progress-bar--playing");break;case y.Paused:h.push("story-tour-progress-bar--paused");break;case y.Rewinding:h.push("story-tour-progress-bar--rewinding");break;case y.FastForwarding:h.push("story-tour-progress-bar--fast-forwarding");break;case y.Idle:h.push("story-tour-progress-bar--incomplete")}else s===t-1&&0===c?h.push("story-tour-progress-bar--complete"):d&&n===y.Rewinding?h.push("story-tour-progress-bar--full-rewinding"):e<s?h.push("story-tour-progress-bar--complete"):e>s&&h.push("story-tour-progress-bar--incomplete");const m={};if(!u||n!==y.Playing&&n!==y.Paused&&n!==y.FastForwarding||(m.animationDuration=`${l}ms`),n===y.Rewinding){const e=a/(a+1);u&&d?m.animationDuration=`${l}ms`:u?m.animationDuration=e*l+"ms":d&&(m.animationDuration=(1-e)*l+"ms",m.animationDelay=e*l+"ms")}return(0,i.jsx)("div",{className:o()(...h),style:m})}function M(){const e=x();return(0,s.useEffect)((()=>{document.documentElement.style.setProperty("--currentTourScenePosition",100*e+"%")}),[e]),null}class SimpleReel extends s.Component{constructor(e){super(e),this.bindings=[],this.isUnmounting=!1,this.onClickSceneBar=async e=>{e.preventDefault();const t=e.target.getAttribute("data-index");if(t){const e=parseInt(t,10),{tourPlaying:n,transition:i}=this.props,{commandBinder:s,analytics:r}=this.context;try{n&&await s.issueCommand(new l.vy({willResume:!0})),i.active||(r.track("showcase_gui",{gui_action:"click_scene_bar"}),await s.issueCommand(new l.rU(e)),n&&await s.issueCommand(new l.TH({index:e})))}catch(e){}}},this.onEnterSceneBar=e=>{const t=e.target.getAttribute("data-index");if(t){const n=parseInt(t,10);this.setState({focusedIndex:n,xOffset:e.clientX})}},this.onLeaveSceneBar=e=>{const t=e.target.getAttribute("data-index");if(t){parseInt(t,10)===this.state.focusedIndex&&this.setState({focusedIndex:-1})}},this.state={focusedIndex:-1,xOffset:0,thumbnails:[]}}componentDidMount(){this.loadThumbnails()}componentWillUnmount(){this.isUnmounting=!0,this.bindings.forEach((e=>{e.cancel()}))}async loadThumbnails(){const e=[];this.props.highlights.forEach((t=>{e.push(t.snapshot.thumbnailUrl.get())})),Promise.all(e).then((e=>{this.isUnmounting||this.setState({thumbnails:e})}))}renderSceneBar(e,t){const{focusedIndex:n}=this.state,s=o()("highlight-bar",{"highlight-bar-hover":t<=n});return(0,i.jsx)("div",Object.assign({className:"highlight-compacted","data-index":t,onClick:this.onClickSceneBar,onMouseEnter:this.onEnterSceneBar,onMouseLeave:this.onLeaveSceneBar,onMouseMove:this.onEnterSceneBar},{children:(0,i.jsx)("div",Object.assign({className:s},{children:(0,i.jsx)(_,{index:t})}))}),`${e.id}_bar_${t}`)}renderHighlightBox(){const{focusedIndex:e,xOffset:t,thumbnails:n}=this.state;if(-1===e)return null;const s=n[e];if(!s)return null;const{highlights:r}=this.props,a=r[e],{name:l}=a.snapshot,c={backgroundImage:`url('${s}')`},d={};return 0===e?(d.left="15px",d.transform="none"):e===r.length-1?(d.right="10px",d.transform="none"):d.left=`${t}px`,(0,i.jsxs)("div",Object.assign({style:d,className:o()("highlight-box",{active:!0})},{children:[(0,i.jsx)("div",{className:"highlight-image",style:c}),(0,i.jsx)("div",Object.assign({className:o()("image-name",{shadowed:!!l})},{children:(0,i.jsx)("span",Object.assign({className:"static-text"},{children:l}))}))]}))}render(){const{highlights:e,tourPlaying:t}=this.props;return(0,i.jsxs)("div",Object.assign({className:o()("tour-story-reel",{"tour-playing":t})},{children:[(0,i.jsx)(M,{}),(0,i.jsx)("div",Object.assign({className:"highlights"},{children:e.map(((e,t)=>this.renderSceneBar(e,t)))})),this.renderHighlightBox()]}))}}SimpleReel.contextType=a.I},82971:(e,t,n)=>{"use strict";n.d(t,{e:()=>w});var i=n(85893),s=n(94184),r=n.n(s),o=n(8259),a=n(70680),l=n(67294),c=n(60405),d=n(5477),u=n(57340),h=n(2252),p=n(61116),m=n(4323),f=n(28439),g=n(79512);class ReelContents extends l.Component{constructor(e){super(e),this.highlights=[],this.highlightList=e=>{const{currentStep:t,onHighlightClicked:n}=this.props;return(0,i.jsx)("div",Object.assign({className:"hlr-container"},{children:(0,i.jsx)("div",Object.assign({className:"highlights",role:"list"},{children:e.items.map(((e,s)=>(0,i.jsx)(g.y,{highlight:e,index:s,active:s===t,editable:!1,onClickHighlight:n,getRef:this.addHighlightRef},`${e.id}_${s}`)))}))}))},this.addHighlightRef=(e,t)=>{this.highlights[e]=t,e===this.props.currentStep&&this.props.setActiveElement&&this.props.setActiveElement(t)}}componentDidUpdate(e){e.currentStep!==this.props.currentStep&&this.props.setActiveElement(this.highlights[this.props.currentStep])}render(){const{highlights:e}=this.props;return e&&e.length?(0,i.jsx)(this.highlightList,{items:e}):null}}n(43479);var v=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const y=new d.Z("highlight-reel");let b=class ReelReadOnly extends l.Component{constructor(e){super(e),this.bindings=[],this.mobile=(0,h.tq)(),this.setActiveElement=e=>{this.setState({activeElement:e})},this.setHighlightClickable=(e=>this.highlightClickable=e).bind(this),this.onHighlightClicked=async e=>{const{commandBinder:t,analytics:n}=this.context;if(this.highlightClickable)try{this.props.tourPlaying&&await t.issueCommand(new p.vy),this.props.transition.active||(n.trackToolGuiEvent("hlr","click_highlight"),await t.issueCommand(new p.rU(e)).catch((e=>{if(!(e instanceof m.z))throw e;y.warn(e.message)})),this.setHighlightClickable(!1))}catch(e){y.debug(e)}},this.state={activeElement:null}}componentWillUnmount(){this.bindings.forEach((e=>{e.cancel()}))}render(){const{activeStep:e,highlights:t,totalSteps:n}=this.props;return(0,i.jsx)("div",Object.assign({id:"reel-container"},{children:(0,i.jsx)(f._,Object.assign({totalSteps:n,activeElement:this.state.activeElement,mobile:this.mobile,highlightClickable:this.setHighlightClickable,thumbScrollingOnly:!1},{children:(0,i.jsx)(ReelContents,{highlights:t,currentStep:e,onHighlightClicked:this.onHighlightClicked,setActiveElement:this.setActiveElement})}))}))}};b.contextType=c.I,b=v([u.Z],b);var S=n(9827),E=n(98683),T=n(1729);function w(e){const{activeStep:t,highlights:n,onToggleHLR:s,openTool:l,reelEnabled:c,reelOpen:d,tourMode:u,tourPlaying:h,transition:p}=e,m=u===o.zz.STORIES,f=(null==n?void 0:n.length)||0;if(m)return c?(0,i.jsx)(E.i,{highlights:n,tourPlaying:h,activeStep:t,transition:p}):null;{const e=0===f;return(0,i.jsxs)(i.Fragment,{children:[c&&(0,i.jsx)(a.N,Object.assign({className:r()("highlight-reel",{"reel-viewing":!e,"reel-empty":e}),open:d},{children:e?(0,i.jsx)(S.P,{}):(0,i.jsx)(b,{highlights:n,tourPlaying:h,activeStep:t,totalSteps:f,transition:p,onToggleHLR:s})})),!l&&(0,i.jsx)(T.c,{activeStep:t,tourPlaying:h,totalSteps:f,reelOpen:d,onToggleHLR:s})]})}}},84128:(e,t,n)=>{"use strict";n.d(t,{m:()=>m});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=n(60405),c=n(23676),d=n(84586),u=n(65171),h=n(70680),p=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let m=class TourStory extends s.Component{constructor(e){super(e),this.bindings=[],this.onTourStepped=()=>{this.setState({inTour:!0})},this.onSweepChange=()=>{this.setState({inTour:!1,showText:!1})},this.state={inTour:!1,showText:!1}}componentDidMount(){const{messageBus:e}=this.context;this.bindings.push(e.subscribe(d.Vx,this.onTourStepped),e.subscribe(u.Z,this.onSweepChange))}componentDidUpdate(e,t){!t.inTour&&this.state.inTour&&this.setState({showText:!0})}componentWillUnmount(){this.bindings.forEach((e=>e.cancel()))}render(){const{highlights:e,currentStep:t,activeStep:n,activeTool:s}=this.props,{inTour:r,showText:o}=this.state,l=s===c.w1.HLR,d=e[t],u=(null==d?void 0:d.title)||"",p=(null==d?void 0:d.description)||"",m=(u||p)&&o&&r&&!(n!==t);return(0,i.jsxs)(h.N,Object.assign({open:r,className:"overlay-layer tour-story-layer"},{children:[(0,i.jsx)("div",{className:a()("tour-story-skrim",{active:m})}),(0,i.jsxs)("div",Object.assign({className:a()("tour-story",{active:m,"reel-open":l})},{children:[(0,i.jsx)("div",Object.assign({className:"tour-story-title"},{children:u})),(0,i.jsx)("div",Object.assign({className:"tour-story-description"},{children:p}))]}))]}))}};m.contextType=l.I,m=p([r.Z],m)},29991:(e,t,n)=>{"use strict";n.d(t,{O:()=>B});var i=n(17403);const s=()=>{},r=()=>null,o=()=>!1,a=()=>Promise.reject(),l=()=>Promise.resolve(),c=()=>"",d=()=>({}),u=()=>[],h=()=>({renew:s,cancel:s}),p={register:s,unregister:s,waitForData:a,tryGetData:r,getModuleNameFromData:()=>""},m={subscribe:h,unsubscribe:s,broadcast:s};var f=n(64177);class NoopCommandBinder extends f.B{constructor(){super(...arguments),this.addBinding=h,this.removeBinding=s,this.issueCommand=a,this.issueCommandWhenBound=a,this.hookCommand=s,this.resetHooks=s}}const g=new NoopCommandBinder,v={mask:0,addLayers:s,removeLayers:s,clone:()=>v},y=()=>v;const b={market:p,msgBus:m,commandBinder:g,getModule:a,getModuleBySymbol:a,getModuleBySymbolSync:function(){throw new Error("getModuleBySymbolSync not supported")},tryGetModuleBySymbolSync:r,getModuleSync:()=>{throw new Error("cannot get module with mock engine")},tryGetModuleSync:r,addComponent:l,removeComponent:l,getComponentByType:r,getComponents:function*(){},claimRenderLayer:y,getRenderLayer:y,subscribe:h,unsubscribe:s,broadcast:s,disposeRenderLayer:s,startGenerator:s,stopGenerator:s,after:l,getXrFrame:()=>{},toggleRendering:s};var S=n(1390);class NoopShowcaseAnalytics extends S.default{constructor(){super(...arguments),this.init=l,this.onUpdate=s,this.dispose=s,this.track=s,this.trackGuiEvent=s,this.trackToolGuiEvent=s,this.getSessionId=c}}const E=new NoopShowcaseAnalytics;var T=n(39142);class NoopLocale extends T.default{constructor(){super(...arguments),this.t=e=>e}get languageCode(){return"en"}}const w=new NoopLocale;var x=n(59114);const _=(0,n(48342).Q)(""),M=()=>_;class NoopUserData extends x.m{constructor(){super(...arguments),this.getUserInfoByEmail=r,this.getUserInfoById=r,this.getUserDisplay=M,this.iterate=s,this.getUsersWhoMayNeedAccess=d,this.getKnownUsers=u,this.getCurrentUser=M,this.isLoggedIn=o,this.isPolicyFlagEnabled=o,this.isOrgAdmin=o,this.isInviter=o,this.isEditor=o,this.isCommenter=o,this.getCurrentUserId=()=>_.id,this.onUsersChanged=h}}const O=new NoopUserData(_,!1,!1);var A=n(25986),C=n(66910),N=n(29410),D=n(23676);const I={activate:l,deactivate:l},L=new N.U({id:D.w1.LABELS,namePhraseKey:"",panel:!1,panelLeft:!1,hidesAppBar:!1,icon:"",analytic:"",toolbar:!1,dimmed:!1,enabled:!1,manager:I,ui:{}}),P=new C.v;class NoopToolsData extends A.t{constructor(){super(...arguments),this.addTools=s,this.iterate=s,this.getTool=()=>L,this.removeTool=s,this.removeAllTools=s,this.setOpenAsset=s,this.onOpenAssetChanged=h,this.getActiveTool=r,this.onToolChanged=h,this.setOpenModal=s,this.onOpenModalChanged=h,this.onToolsLoadedChanged=h,this.setToolAccess=s,this.onToolAssetAccessChanged=h,this.isPanelOpen=o,this.isPanelCollapsedToBottom=o,this.setToolPanelLayout=s,this.onToolPanelLayoutChanged=h,this.onPanelCollapsedChanged=h,this.setPanelCollapsed=s}get toolsMap(){return P}get openAsset(){return null}get activeToolName(){return null}get openModal(){return null}get toolsLoaded(){return!1}get toolAccess(){return D.X$.SCENE}get toolPanelLayout(){return D.wS.NORMAL}get panelCollapsed(){return!1}}const R=new NoopToolsData;var k=n(61903);class NoopSettingsData extends k.e{constructor(){super(...arguments),this.setProperty=s,this.setLocalStorageProperty=s,this.hasProperty=o,this.tryGetProperty=s,this.getProperty=s,this.checkUrlParam=o,this.iterate=s}}const U=new NoopSettingsData,B={editMode:!1,mainDiv:document.createElement("div"),queue:new i.RequestQueue,messageBus:m,userData:O,toolsData:R,settings:U,analytics:E,engine:b,market:p,commandBinder:g,locale:w}},60405:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var i=n(67294),s=n(29991);const r=(0,i.createContext)(s.O)},20302:(e,t,n)=>{"use strict";n.d(t,{u:()=>r,m:()=>o});var i=n(67294),s=n(60405);function r(e){return()=>o(e)}function o(e){const{market:t}=(0,i.useContext)(s.I),[n,r]=(0,i.useState)(t.tryGetData(e));return(0,i.useEffect)((()=>{let n=!1;return t.waitForData(e).then((e=>{n||r(e)})),()=>{n=!0}}),[t,e]),n}},59187:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var i=n(85893),s=n(67294);function r(e,t){return n=>(0,s.forwardRef)(((s,r)=>{const o=t(),a=Object.assign(Object.assign({},s),{[e]:o});return(0,i.jsx)(n,Object.assign({},a,{ref:r}))}))}},83869:(e,t,n)=>{"use strict";n.d(t,{M:()=>r,v:()=>o});var i=n(67294),s=n(20302);function r(e,t,n){return()=>o(e,t,n)}function o(e,t,n){const r=(0,s.m)(e),[o,a]=(0,i.useState)(r?r[t]:n);return(0,i.useEffect)((()=>{if(!r)return()=>{};const e=r.onPropertyChanged(t,a);return a(r[t]),()=>e.cancel()}),[r,t]),o}},14374:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var i=n(67294);function s(){const[,e]=(0,i.useState)(0);return(0,i.useCallback)((()=>{e((e=>e+1))}),[])}},15314:(e,t,n)=>{"use strict";n.d(t,{U:()=>r});var i=n(67294),s=n(60405);function r(e,t){const{messageBus:n}=(0,i.useContext)(s.I);(0,i.useEffect)((()=>{const i=n.subscribe(e,t);return()=>i.cancel()}),[n,e,t])}},83670:(e,t,n)=>{"use strict";n.d(t,{i:()=>s});var i=n(67294);function s(e){const[t,n]=(0,i.useState)(e.values());return(0,i.useEffect)((()=>{const t=()=>{n(e.values())},i=e.onChanged(t);return t(),()=>i.cancel()}),[e]),t}},95551:(e,t,n)=>{"use strict";n.d(t,{y:()=>s});var i=n(67294);function s(e){const[t,n]=(0,i.useState)(e.value);return(0,i.useEffect)((()=>{const t=e.onChanged(n);return n(e.value),()=>t.cancel()}),[e]),t}},68077:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var i=n(67294),s=n(60405);function r(e,t){const{settings:n}=(0,i.useContext)(s.I),[r,o]=(0,i.useState)(n.tryGetProperty(e,t));return(0,i.useEffect)((()=>{if(!e)return o(t),()=>{};const i=()=>{o(n.tryGetProperty(e,t))},s=n.onPropertyChanged(e,i);return i(),()=>s.cancel()}),[n,e,t]),r}},79805:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Gui});var i=n(57227),s=n(14877),r=n(39142),o=n(67294),a=n(20745),l=n(60405),c=n(29991),d=n(85893),u=n(3786),h=n(94184),p=n.n(h),m=n(99280),f=n(70329),g=n(5477),v=n(11325);const y=new g.Z("alert-notification");class AlertNotification extends o.Component{constructor(e){super(e),this.throttledMessages=new Map,this.onClose=()=>{clearTimeout(this.alertTimer),this.setState({open:!1})},this.state={open:!1}}componentDidMount(){this.update()}componentWillUnmount(){this.state.open&&this.props.messageBus.broadcast(new m.c(!1))}UNSAFE_componentWillReceiveProps(e){this.update(e)}componentDidUpdate(e,t){this.state.open!==t.open&&this.props.messageBus.broadcast(new m.c(this.state.open))}update(e=this.props){const{show:t,timeout:n,message:i,throttle:s,type:r}=e,{analytics:o}=this.context;if(t){if(s>0){if(this.throttledMessages.has(i)&&this.throttledMessages.get(i)>Date.now())return void y.debug(`Suppressed alert dialog due to message throttling: ${i}`);this.throttledMessages.set(i,Date.now()+1e3*s)}clearTimeout(this.alertTimer),this.setState({open:!0}),n>0&&(this.alertTimer=window.setTimeout(this.onClose,1e3*n)),o&&o.track("alert_gui",{alert_action:"show",alert_type:r,alert_message:i})}}render(){const{title:e,message:t,type:n}=this.props,{open:i}=this.state,s={active:i,[`notification-${n}`]:!0};return(0,d.jsxs)("aside",Object.assign({className:p()("alert-notification",s)},{children:[(0,d.jsxs)("div",Object.assign({className:"notification-body"},{children:[e&&(0,d.jsx)("h3",Object.assign({className:"notification-title"},{children:e})),(0,d.jsx)("p",Object.assign({className:"notification-text"},{children:t}))]})),(0,d.jsx)(f.P,{buttonStyle:f.A.LIGHT,onClose:this.onClose,hideTooltip:!0})]}))}}AlertNotification.contextType=l.I,AlertNotification.defaultProps={type:v.N.INFO,show:!1,timeout:10,throttle:0};var b=n(96557);class ErrorBar extends o.Component{constructor(e){super(e),this.bindings=[],this.state={guiError:!1,errorMessagePhraseKey:""}}componentDidMount(){const{commandBinder:e}=this.context;this.bindings.push(e.addBinding(u.I,(async e=>{this.showErrorMessage(e.messagePhraseKey,e.options)})))}componentWillUnmount(){this.bindings.forEach((e=>e.cancel())),this.bindings.length=0}componentDidUpdate(e,t){const{guiError:n}=this.state;n&&this.setState({guiError:!1})}showErrorMessage(e,t){this.setState({guiError:!0,errorMessagePhraseKey:e,errorOptions:t})}render(){const{messageBus:e,locale:t}=this.context,{guiError:n,errorMessagePhraseKey:i,errorOptions:s}=this.state;let r=i&&t.t(i);const{error:o}=s||{};return o&&(0,b.bh)(o)&&(r=`${r} (${o.code})`),(0,d.jsx)(AlertNotification,Object.assign({messageBus:e,show:n,message:r},s))}}ErrorBar.contextType=l.I;var S=n(61903),E=n(59114);class Gui extends i.Y{constructor(){super(...arguments),this.name="gui",this.workshopApp=!1,this.onAppReadyChanged=(e,t)=>{this.workshopApp&&(t&&e?this.mainDiv.classList.add("edit-mode"):this.mainDiv.classList.remove("edit-mode"))}}async init(e,t){this.workshopApp=e.workshopApp,this.mainDiv=e.mainDiv,this.container=e.container,this.reactContainer=e.reactContainer,this.queue=e.queue,this.engine=t,this.messageBus=t,this.market=t.market,this.commandBinder=t.commandBinder;const n=t.getModule(r.default),i=t.getModuleBySymbol(s.y.SHOWCASE_ANALYTICS),o=t.market.waitForData(E.m),a=t.market.waitForData(S.e);this.mainArgs=await Promise.all([n,i,a,o]),this.loadErrorBar(this.mainArgs)}dispose(e){this.bindings.forEach((e=>{e.cancel()})),this.bindings=[]}async loadUi(e){let t=[];return t=t.concat(this.mainArgs),t=t.concat([this.mainDiv,this.reactContainer,this.engine,this.messageBus,this.market,this.commandBinder,this.onAppReadyChanged,this.queue]),e.apply(this,t)}loadErrorBar(e){((e,t,n,i,s,r,d)=>{const u=document.createElement("div");u.className="error-bar",i.insertBefore(u,i.firstElementChild);const h=Object.assign(Object.assign({},c.O),{messageBus:e,commandBinder:t,market:n,analytics:s,settings:r,locale:d});(0,a.s)(u).render((0,o.createElement)(l.I.Provider,{value:h},[(0,o.createElement)(ErrorBar,{key:"error-bar"})]))})(this.engine,this.commandBinder,this.market,this.container,e[1],e[2],e[0])}}},56829:(e,t,n)=>{"use strict";n.d(t,{nV:()=>ModalToggledMessage,nZ:()=>PopupMenuOpenedMessage,Z_:()=>LoadIndicatorMessage,bN:()=>LoadIndicatorSuppressMessage,SN:()=>TextBoxFocusMessage});var i=n(4117);class ModalToggledMessage extends i.v{constructor(e,t){super(),this.modal=e,this.open=t}}class PopupMenuOpenedMessage extends i.v{constructor(e){super(),this.id=e}}class LoadIndicatorMessage extends i.v{constructor(e){super(),this.isOpen=e}}class LoadIndicatorSuppressMessage extends i.v{constructor(e){super(),this.suppress=e}}class TextBoxFocusMessage extends i.v{constructor(e,t){super(),this.textElement=e,this.focused=t}}},13729:(e,t,n)=>{"use strict";n.d(t,{b:()=>h});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=n(20585),c=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let d=class AccordionHeader extends s.Component{constructor(e){super(e)}render(){const{label:e,onToggle:t,children:n,className:s,actions:r}=this.props;return(0,i.jsxs)("div",Object.assign({className:a()("accordion-header",s),onClick:t||void 0},{children:[n,(0,i.jsx)("span",Object.assign({className:"accordion-header-label"},{children:e})),!!t&&(0,i.jsx)("button",{className:"icon accordion-icon accordion-toggle-icon"}),r]}))}};d=c([r.Z],d);var u=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let h=class AccordionGroup extends s.Component{constructor(e){super(e),this.toggleGroup=()=>{this.state.expanded?this.animateCollapseGroup():this.animateExpandGroup();const{id:e,onExpandChange:t}=this.props;t&&t(e,this.state.expanded)};const t=!e.header||!!e.open;this.state={expanded:t,showChildren:t};const{id:n,onExpandChange:i}=this.props;i&&i(n,this.state.expanded)}componentDidUpdate(e){!e.open&&this.props.open&&this.animateExpandGroup(),e.open&&!this.props.open&&this.animateCollapseGroup()}componentWillUnmount(){void 0!==this.timeout&&window.clearTimeout(this.timeout)}animateExpandGroup(){this.setState({showChildren:!0},(()=>{this.timeout=window.setTimeout((()=>{delete this.timeout,this.setState({expanded:!0})}))}))}animateCollapseGroup(){this.setState({expanded:!1},(()=>{this.timeout=window.setTimeout((()=>{delete this.timeout,this.state&&!this.state.expanded&&this.setState({showChildren:!1})}),l.g)}))}renderContents(){const{children:e,emptyMessage:t,doubleLine:n,naturalHeight:s}=this.props,{expanded:r,showChildren:o}=this.state,a=n?60:40,l=e&&Array.isArray(e)&&e.length||0,c=l>0;let d;d=r?c?l*a+"px":`${a}px`:"0";const u=s?void 0:{height:`${d}`},h=c?e:(0,i.jsx)("p",Object.assign({className:"hint accordion-empty-message"},{children:t||""}));return(0,i.jsx)("div",Object.assign({className:"accordion-contents",style:u},{children:o&&h}))}renderHeader(){const{header:e,collapsible:t,actions:n}=this.props,{expanded:r}=this.state,o="string"==typeof e?e:void 0;if(o)return(0,i.jsx)(d,{label:o,expanded:r,onToggle:t?this.toggleGroup:void 0,actions:n});if(void 0!==e){const t=e;return(0,s.cloneElement)(t,{expanded:r,onToggle:this.toggleGroup})}return null}render(){const{doubleLine:e}=this.props,{expanded:t}=this.state;return(0,i.jsxs)("div",Object.assign({className:a()("accordion-group",{expanded:t,collapsed:!t,"double-line":e}),"aria-expanded":t?"true":"false"},{children:[this.renderHeader(),this.renderContents()]}))}};h=u([r.Z],h)},54787:(e,t,n)=>{"use strict";n.d(t,{Q:()=>c});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class AccordionItem extends s.Component{constructor(e){super(e),this.onClick=e=>{const t=e.target;this.props.onSelect&&!t.classList.contains("icon-more-vert")&&this.props.onSelect(this.props.sid)}}render(){const{enabled:e,selected:t,children:n,className:s}=this.props,r=o()("accordion-item",{"accordion-item-disabled":!e,"accordion-item-selected":t},s);return(0,i.jsx)("div",Object.assign({className:r,onClick:this.onClick},{children:n}))}};c=l([a.Z],c)},28876:(e,t,n)=>{"use strict";n.d(t,{F:()=>c});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class Accordions extends s.Component{constructor(e){super(e)}render(){const{children:e,className:t}=this.props,n=t||"";return(0,i.jsx)("div",Object.assign({className:a()("accordion-list",[n])},{children:e}))}};c=l([r.Z],c)},11325:(e,t,n)=>{"use strict";var i;n.d(t,{N:()=>i}),function(e){e.INFO="info",e.SUCCESS="success",e.WARNING="warning",e.ERROR="error"}(i||(i={}))},43873:(e,t,n)=>{"use strict";n.d(t,{C:()=>c});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class Badge extends s.Component{constructor(e){super(e)}render(){const{iconClass:e,label:t,badgeStyle:n,onClick:s}=this.props;return(0,i.jsxs)("span",Object.assign({className:a()("badge",{clickable:!!s}),style:n,onClick:s},{children:[e&&(0,i.jsx)("span",{className:`icon badge-icon ${e}`}),t&&(0,i.jsx)("span",Object.assign({className:"badge-label"},{children:t}))]}))}};c=l([r.Z],c)},88794:(e,t,n)=>{"use strict";n.d(t,{h:()=>ButtonGroup});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r);class ButtonGroup extends s.Component{render(){const{children:e,className:t}=this.props;return(0,i.jsx)("div",Object.assign({className:o()("button-group",t)},{children:e}))}}},40552:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(61445),c=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let d=class ButtonWithIcon extends s.Component{constructor(e){super(e)}render(){const{onClick:e,label:t,ariaLabel:n,icon:s,buttonSize:r,buttonStyle:a,buttonState:c,className:d}=this.props;return(0,i.jsxs)(l.zx,Object.assign({className:o()("button-with-icon",d),buttonSize:r,buttonStyle:a,buttonState:c,onClick:e,"aria-label":n||t},{children:[(0,i.jsx)("span",{className:o()("icon",s)}),t]}))}};d=c([a.Z],d)},41270:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,X:()=>d});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(57340),c=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.FILTER=1]="FILTER"}(i||(i={}));let d=class Checkbox extends r.Component{constructor(e){super(e),this.onChange=e=>{this.props.stopPropagation&&e.stopPropagation(),this.setState((e=>({checkedValue:!e.checkedValue})),(()=>{this.props.onChange&&this.props.onChange(this.checkboxElement,...this.props.onChangeArgs||[])}))},this.setCheckboxRef=e=>{this.checkboxElement=e},this.state={checkedValue:e.checked}}UNSAFE_componentWillReceiveProps(e){this.setState({checkedValue:e.checked})}render(){const{checkboxStyle:e=i.DEFAULT,className:t,dataValue:n,enabled:r,error:o,helpText:l,id:c,label:d}=this.props,{checkedValue:u}=this.state,h=!r;return(0,s.jsxs)("div",Object.assign({ref:this.setCheckboxRef,id:c,role:"checkbox","aria-checked":u?"true":"false","aria-disabled":h,"data-value":n,className:a()("checkbox-element",`checkbox-style-${i[e].toLowerCase()}`,{checked:u,disabled:h,error:o},t),onClick:this.onChange},{children:[e!==i.FILTER&&(0,s.jsx)("div",{className:"checkbox icon-checkmark"}),(0,s.jsx)("div",Object.assign({className:"checkbox-text"},{children:d})),l&&(0,s.jsx)("span",Object.assign({className:"help-text"},{children:l}))]}))}};d.defaultProps={enabled:!0,error:!1},d=c([l.Z],d)},45923:(e,t,n)=>{"use strict";n.d(t,{$:()=>u});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(57340),c=n(74170),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let u=i=class CircularProgressBar extends r.Component{constructor(e){super(e),this.strokePattern=[0,100],this.strokeOffset=0,this.innerRadius=15.92,this.strokeWidth=1,this.drawRadius=this.innerRadius+this.strokeWidth/2,this.updateSvgAttributes(e),this.elementId=this.props.id||"circle-progress-"+i.id++}UNSAFE_componentWillReceiveProps(e){this.updateSvgAttributes(e)}updateSvgAttributes(e){this.strokeWidth=e.barWidth||this.strokeWidth,this.innerRadius=e.innerRadius||this.innerRadius,this.drawRadius=this.innerRadius+this.strokeWidth/2;const t=2*this.drawRadius*Math.PI;this.strokeOffset=t*(e.startPosition||this.strokeOffset),this.strokePattern[0]=t*(0,c.uZ)(e.progress,0,100)/100,this.strokePattern[1]=t-this.strokePattern[0]}render(){const{progressColor:e}=this.props,t=2*(this.innerRadius+this.strokeWidth),n=t/2;return(0,s.jsxs)("svg",Object.assign({id:this.elementId,className:a()("circular-progress",this.props.className),viewBox:`${-n} ${-n} ${t} ${t}`},{children:[(0,s.jsx)("circle",{className:"bar-bg",cx:"0",cy:"0",r:this.drawRadius,transform:"rotate(-90) "+(this.props.ccw?"scale(-1 1)":""),strokeDasharray:`${this.strokePattern[1]} ${this.strokePattern[0]}`,strokeDashoffset:this.strokeOffset-this.strokePattern[0],strokeWidth:this.strokeWidth,fill:"none"}),(0,s.jsx)("circle",{className:e?void 0:"progress",cx:"0",cy:"0",r:this.drawRadius,transform:"rotate(-90) "+(this.props.ccw?"scale(-1 1)":""),strokeDasharray:`${this.strokePattern[0]} ${this.strokePattern[1]}`,strokeWidth:this.strokeWidth,stroke:e,fill:"none"}),this.props.children]}))}};u.id=0,u=i=d([l.Z],u)},59379:(e,t,n)=>{"use strict";n.d(t,{i:()=>y});var i=n(85893),s=n(91033),r=n(94184),o=n.n(r),a=n(67294),l=n(87982),c=n(57340),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},u=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};var h;!function(e){e.UP="up",e.DOWN="down"}(h||(h={}));let p=class Dropdown extends a.Component{constructor(e){super(e),this.elementRef=(0,a.createRef)(),this.onOutsideClick=e=>{this.toggleDropdown(!1)},this.onToggleClick=e=>{e.stopPropagation(),this.toggleDropdown()},this.onTransitionEnd=e=>{e&&e.target!==e.currentTarget||(window.clearTimeout(this.transitionTimeout),this.setState({transitioning:!1}))},this.toggleDropdown=e=>{const{open:t}=this.state,n=void 0!==e?e:!t;n?window.addEventListener("click",this.onOutsideClick):window.removeEventListener("click",this.onOutsideClick),this.transitionTimeout=window.setTimeout(this.onTransitionEnd,1e3),this.setState({open:n,transitioning:!0})},this.state={open:!1,transitioning:!1}}componentWillUnmount(){window.removeEventListener("click",this.onOutsideClick)}render(){const{open:e,transitioning:t}=this.state,n=this.props,{children:s,className:r,direction:a}=n,c=u(n,["children","className","direction"]),d={up:a===h.UP,open:e,transitioning:t};return(0,i.jsxs)("div",Object.assign({ref:this.elementRef,className:o()("dropdown",d,r)},c,{children:[(0,i.jsx)("div",Object.assign({className:"dropdown-mask"},{children:(0,i.jsx)("div",Object.assign({className:"dropdown-menu",onTransitionEnd:this.onTransitionEnd},{children:s}))})),(0,i.jsx)("div",Object.assign({className:"dropdown-toggle"},{children:(0,i.jsx)(l.hU,{iconClass:"icon-toolbar-more-horiz",onClick:this.onToggleClick,className:"dropdown-toggle"})}))]}))}};p.defaultProps={direction:h.DOWN},p=d([c.Z],p);var m=n(37796),f=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},g=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};const v="collapsed";let y=class CollapsibleList extends a.Component{constructor(e){super(e),this.contentRef=(0,a.createRef)(),this.collapsedRef=(0,a.createRef)(),this.toggleRef=(0,a.createRef)(),this.onResize=()=>{this.update()},this.update=(0,m.P)((()=>{var e;const t=null===(e=this.toggleRef.current)||void 0===e?void 0:e.elementRef.current,n=this.contentRef.current,i=this.collapsedRef.current;if(!n||!i||!t)return;const s=n.children,r=i.children;if(!s||s.length!==r.length)return;const{collapsed:o}=this.state,a=n.offsetWidth,l=t.offsetWidth||0;let c=0,d=0;for(let e=0;e<s.length;e++){let t=s[e].offsetWidth||0;d||e!==s.length-1||(t-=l),c+=t,c<=a?(s[e].classList.remove(v),r[e].classList.add(v)):(d++,s[e].classList.add(v),r[e].classList.remove(v))}!!d!==o&&this.setState({collapsed:!o})}),50),this.state={collapsed:!1},this.observer=new s.Z(this.onResize)}componentDidMount(){this.connectObserver(),this.update()}componentDidUpdate(){this.update()}componentWillUnmount(){this.disconnectObserver(),this.reset()}connectObserver(){const e=this.contentRef.current;e&&this.observer.observe(e)}disconnectObserver(){this.observer&&this.observer.disconnect()}reset(){const e=this.contentRef.current;if(!e)return;const t=e.querySelectorAll(".collapsed");Array.from(t).forEach((e=>e.classList.remove(v)))}render(){const e=this.props,{children:t,className:n}=e,s=g(e,["children","className"]),{collapsed:r}=this.state,a=`collapsible-list ${n}`,l={hidden:!r};return t&&Array.isArray(t)?(0,i.jsxs)("div",Object.assign({className:o()(a)},s,{children:[(0,i.jsx)("div",Object.assign({ref:this.contentRef,className:"collapsible-list-items"},{children:t})),(0,i.jsx)(p,Object.assign({ref:this.toggleRef,direction:h.UP,className:o()(l)},{children:(0,i.jsx)("div",Object.assign({ref:this.collapsedRef,className:"collapsible-list-menu"},{children:t}))}))]})):t}};y.defaultProps={},y=f([c.Z],y)},99612:(e,t,n)=>{"use strict";n.d(t,{z:()=>c});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class ColorPicker extends s.Component{constructor(e){super(e),this.clickColor=e=>{const t=e.currentTarget;if(t&&t.dataset){const n=t.dataset.value;n&&(e.stopPropagation(),this.props.onColorPicked(n),this.setState({activeColor:n}))}},this.renderColorSwatch=e=>{const{activeColor:t}=this.state,n={backgroundColor:e},s=o()({"color-swatch":!0,"icon-checkmark":!0,active:e===t});return(0,i.jsx)("div",{className:s,style:n,"data-value":e,onClick:this.clickColor},e)},this.state={activeColor:e.defaultColor||""}}UNSAFE_componentWillReceiveProps(e){e.defaultColor&&!this.state.activeColor&&this.setState({activeColor:e.defaultColor})}render(){const{colors:e}=this.props;return(0,i.jsx)("div",Object.assign({className:"color-picker"},{children:e.map((e=>this.renderColorSwatch(e)))}))}};c=l([a.Z],c)},78576:(e,t,n)=>{"use strict";n.d(t,{lZ:()=>i,ig:()=>s,oO:()=>u});var i,s,r=n(85893),o=n(67294),a=n(57340),l=n(94184),c=n.n(l),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e.UP="up",e.DOWN="down",e.LEFT="left",e.RIGHT="right",e.UP_LEFT="up-left",e.UP_RIGHT="up-right",e.DOWN_LEFT="down-left",e.DOWN_RIGHT="down-right"}(i||(i={})),function(e){e.SMALL="small",e.MEDIUM="medium",e.LARGE="large",e.XLARGE="xlarge",e.FIT="fit"}(s||(s={}));let u=class DataBalloon extends o.Component{constructor(e){super(e),this.onClick=e=>{this.props.showOnClick&&this.setState((e=>({persist:!e.persist}))),void 0!==this.props.tooltipTimeout&&window.setTimeout((()=>{this.setState({tooltipEnabled:!1})}),this.props.tooltipTimeout)},this.onMouseEnter=e=>{this.enableTooltip(),this.adjustBalloonPosIfNeeded(e)},this.enableTooltip=()=>{this.setState({tooltipEnabled:!0})},this.state={currentPosition:null,tooltipEnabled:!0,persist:!1}}render(){const{children:e,position:t,content:n,className:i,tooltipWidth:s}=this.props,{currentPosition:o,tooltipEnabled:a,persist:l}=this.state;return(0,r.jsx)("div",Object.assign({role:"button","data-balloon":n,"data-balloon-pos":o||t,"data-balloon-width":s,"data-balloon-persist":l||void 0,className:c()("data-balloon",i,{disabled:!a}),onClick:this.onClick,onTouchStart:this.enableTooltip,onMouseEnter:this.onMouseEnter},{children:e}))}adjustBalloonPosIfNeeded(e){const{currentPosition:t}=this.state;if(null===t){const t=e.target,{position:n}=this.props;let s=n;if(n!==i.LEFT&&n!==i.RIGHT){const e=window.getComputedStyle(t,":after"),r=e.width?parseInt(e.width,10):0;if(r>0){const e=t.getBoundingClientRect(),o=(r-e.width)/2,a=n===i.UP||n===i.UP_RIGHT||n===i.UP_LEFT;e.left-o<=0?s=a?i.UP_RIGHT:i.DOWN_RIGHT:(n===i.UP_LEFT||n===i.DOWN_LEFT)&&e.left-r<=0?s=a?i.UP:i.DOWN:e.right+o>=window.innerWidth?s=a?i.UP_LEFT:i.DOWN_LEFT:(n===i.UP_RIGHT||n===i.DOWN_RIGHT)&&e.right+r>=window.innerWidth&&(s=a?i.UP:i.DOWN)}}this.setState({currentPosition:s})}}};u=d([a.Z],u)},87982:(e,t,n)=>{"use strict";n.d(t,{Dd:()=>s,hU:()=>m});var i,s,r=n(85893),o=n(67294),a=n(94184),l=n.n(a),c=n(57340),d=n(2252),u=n(78576),h=n(61445),p=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e.CLEAR="clear",e.PLAIN="plain",e.OVERLAY="overlay",e.PRIMARY="primary",e.SOCIAL="social",e.TOOLBAR="toolbar"}(s||(s={}));let m=i=class IconButton extends o.Component{constructor(e){super(e),this.onClick=e=>{const t=this.props.buttonState;t!==h.BN.BUSY&&t!==h.BN.DISABLED&&this.props.onClick&&this.props.onClick(e)},this.onMouseDown=e=>{const{onMouseDown:t,onClick:n,buttonState:s}=this.props;if(t)t(e);else if(i.iMobile&&n&&s!==h.BN.BUSY&&s!==h.BN.DISABLED){const t=document.activeElement;t&&e.cancelable&&(t.blur(),e.preventDefault())}}}render(){const{ariaLabel:e,breakoutTooltip:t,buttonSize:n,buttonState:i,buttonStyle:o,children:a,className:c,dataValue:d,iconClass:p,id:m,onClick:f,onMouseUp:g,tooltipMsg:v,tooltipPersist:y,tooltipPosition:b,tooltipPreformatted:S,tooltipWidth:E}=this.props,T=i===h.BN.DISABLED,w=i===h.BN.BUSY,x=i===h.BN.DECORATIVE,_=!T&&!w&&!x,M=v?b||u.lZ.DOWN:void 0,O=v?!!S:void 0,A={"button-small":n===h.qE.SMALL,"button-large":n===h.qE.LARGE,"button-disabled":T,"button-dimmed":i===h.BN.DIMMED,"button-active":i===h.BN.ACTIVE,"button-busy":w,"button-interactive":_,"icon-button-primary":o===s.PRIMARY,"icon-button-overlay":o===s.OVERLAY,"icon-button-plain":o===s.PLAIN,"icon-button-social":o===s.SOCIAL,"icon-button-toolbar":o===s.TOOLBAR,"icon-button-breakout-tooltip":t},C={id:m,role:"button","aria-label":e||v,"aria-disabled":T,"data-value":d,className:l()("icon-button",A,c),onClick:f?this.onClick:void 0,onMouseUp:g,onMouseDown:this.onMouseDown},N={"data-balloon":v,"data-balloon-pos":M,"data-balloon-width":E,"data-balloon-pre":O,"data-balloon-persist":y};return t||Object.assign(C,N),(0,r.jsxs)("div",Object.assign({},C,{children:[t&&(0,r.jsx)("div",Object.assign({className:"icon-button-breakout-tooltip-container"},{children:(0,r.jsx)("div",Object.assign({className:"icon-button-breakout-tooltip-trigger"},N))})),p&&(0,r.jsx)("span",{className:`icon ${p}`}),a]}))}};m.iMobile=(0,d.Tt)()||(0,d._1)(),m=i=p([c.Z],m)},77492:(e,t,n)=>{"use strict";n.d(t,{$:()=>l});var i=n(85893),s=n(67294),r=n(57340),o=n(54119),a=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let l=class ListNavigation extends s.Component{constructor(){super(...arguments),this.onGotoNext=()=>{const e=this.getNextIndex();-1!==e&&this.props.onNavigate(e)},this.onGotoPrev=()=>{const e=this.getPrevIndex();-1!==e&&this.props.onNavigate(e)}}getNextIndex(){const{total:e,index:t,wrapAround:n}=this.props;return t+1<e?t+1:n?0:-1}getPrevIndex(){const{total:e,index:t,wrapAround:n}=this.props;return t>0?t-1:n?e-1:-1}render(){const{total:e,index:t,disabled:n,overlay:s}=this.props;if(e<2||-1===t)return null;const r=s?"dark":"light",a=s?void 0:o.qE.LARGE,l=`${t+1} of ${e}`;return(0,i.jsxs)("div",Object.assign({className:"list-nav"},{children:[(0,i.jsx)(o.zx,{icon:"dpad-left",variant:o.Wu.TERTIARY,size:a,disabled:n,theme:r,onClick:this.onGotoPrev}),(0,i.jsx)("span",Object.assign({className:"list-nav-label"},{children:l})),(0,i.jsx)(o.zx,{icon:"dpad-right",variant:o.Wu.TERTIARY,size:a,disabled:n,theme:r,onClick:this.onGotoNext})]}))}};l=a([r.Z],l)},25379:(e,t,n)=>{"use strict";n.d(t,{n:()=>OptionsButton});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(56829),c=n(87982),d=n(56759),u=n(61445);class OptionsButton extends s.Component{constructor(e){super(e),this.popupMenuRef=(0,s.createRef)(),this.isUnmounting=!1,this.popupOpened=e=>{if(this.isUnmounting)return;const{id:t}=this.props;e.id!==t&&this.setState({open:!1})},this.toggleMenu=e=>{if(e.stopPropagation(),!this.popupMenuRef.current)return;const t=e.clientY+this.popupMenuRef.current.offsetHeight+d.u.POPUP_OFFSET>window.innerHeight?d.x.BOTTOM_RIGHT:d.x.TOP_RIGHT;this.setState((e=>{const n=!e.open;return n&&this.context.messageBus.broadcast(new l.nZ(this.props.id)),this.props.onMenuToggled&&this.props.onMenuToggled(n),{arrowPosition:t,open:n}}))},this.onClose=()=>{this.setState({open:!1})},this.state={open:!1,arrowPosition:d.x.TOP_RIGHT}}componentDidMount(){this.context.messageBus.subscribe(l.nZ,this.popupOpened)}componentWillUnmount(){this.isUnmounting=!0,this.context.messageBus.unsubscribe(l.nZ,this.popupOpened)}renderMenu(){const{menu:e,closeOnMenuItemClick:t}=this.props,{locale:n}=this.context;return(0,i.jsx)("div",Object.assign({className:"tooltip-menu"},{children:e.map((([e,s,r])=>(0,i.jsx)("div",Object.assign({className:o()("tpMsg",{disabled:r}),onClick:r?void 0:e=>{e.stopPropagation(),s(),t&&this.onClose()}},{children:n.t(e)}),e)))}))}render(){const{arrowPosition:e,open:t}=this.state,{id:n,disabled:s,accordion:r}=this.props,a=o()("options-button",{"accordion-options-button":r}),l=o()("icon-more-vert","item-more-options",{"accordion-icon":r}),h=o()({"options-button__tooltip-container":r});return(0,i.jsx)(c.hU,Object.assign({dataValue:n,className:a,buttonStyle:c.Dd.PLAIN,buttonState:!0===s?u.BN.DISABLED:void 0,iconClass:l,onClick:this.toggleMenu},{children:(0,i.jsx)("div",Object.assign({className:h,ref:this.popupMenuRef},{children:(0,i.jsx)(d.u,{open:t,onClose:this.onClose,message:this.renderMenu(),arrowPos:e,bodyClassName:"item-tooltip"})}))}))}}OptionsButton.contextType=a.I},72329:(e,t,n)=>{"use strict";n.d(t,{E:()=>c});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class RadioButton extends s.Component{constructor(e){super(e),this.onChange=e=>{this.props.onChange(e)}}render(){const{id:e,name:t,value:n,checked:s,children:r,enabled:a}=this.props,l=!a;return(0,i.jsxs)("div",Object.assign({className:o()("radio-element","radio-button",{disabled:l})},{children:[(0,i.jsx)("input",{type:"radio",id:e,name:t,value:n,checked:s,onChange:this.onChange}),(0,i.jsx)("label",Object.assign({htmlFor:e},{children:r}))]}))}};c=l([a.Z],c)},34506:(e,t,n)=>{"use strict";n.d(t,{S:()=>SelectMenu,K:()=>i});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(56759);class SelectMenu extends r.Component{constructor(e){super(e),this.onSelectOption=e=>{const{onChange:t}=this.props,n=e.target.getAttribute("data-value");this.closeMenu(),t(n)},this.onClick=e=>{const{open:t}=this.state;return t?this.closeMenu():this.openMenu()},this.onTooltipClose=()=>{this.closeMenu()},this.state={open:!1}}getSelectedOption(){return this.props.options.find((e=>e.selected))||null}openMenu(){this.setState({open:!0})}closeMenu(){this.setState({open:!1})}renderPopupContents(){const e=[];return this.props.options.forEach(((t,n)=>{const i=t.className||"";e.push((0,s.jsx)("div",Object.assign({"data-value":t.value,className:a()({tpMsg:!0,disabled:!!t.disabled,[i]:!!i}),onClick:this.onSelectOption},{children:t.text}),`${n}-${t.value}`))})),(0,s.jsx)("div",Object.assign({className:"tooltip-menu"},{children:e}))}render(){const{arrowPos:e,className:t,id:n,label:r,menuStyle:o,placeholder:c}=this.props,{open:d}=this.state,u=this.getSelectedOption(),h=o===i.BUTTON,p=o===i.DROPDOWN,m=a()("select-popup",{"select-button":h,"select-dropdown":p},t),f=u?u.selectedText||u.text:c||"";return(0,s.jsxs)("div",Object.assign({className:m,id:n},{children:[r&&(0,s.jsx)("label",Object.assign({className:"select-label"},{children:r})),(0,s.jsxs)("div",Object.assign({className:"select-trigger",onClick:this.onClick},{children:[(0,s.jsx)("span",Object.assign({className:"select-menu-text"},{children:f})),(0,s.jsx)("span",{className:"icon icon-dpad-down"}),(0,s.jsx)(l.u,{open:!!d,onClose:this.onTooltipClose,message:this.renderPopupContents(),arrowPos:e||l.x.NONE,bodyClassName:"item-tooltip"})]}))]}))}}!function(e){e[e.DROPDOWN=0]="DROPDOWN",e[e.BUTTON=1]="BUTTON"}(i||(i={}))},89794:(e,t,n)=>{"use strict";n.d(t,{J:()=>l});var i=n(85893),s=n(67294),r=n(57340),o=n(56759),a=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let l=class SettingsBox extends s.Component{constructor(){super(...arguments),this.stopClickPropagation=e=>{e.stopPropagation()}}render(){const{children:e,open:t,className:n,close:s,arrowPosition:r}=this.props,a=(0,i.jsx)("div",Object.assign({className:"settings-container settings-box",onClick:this.stopClickPropagation,onMouseDown:this.stopClickPropagation,onTouchStart:this.stopClickPropagation},{children:e}));return(0,i.jsx)(o.u,{open:t,message:a,className:n,arrowPos:r,onClose:s})}};l=a([r.Z],l)},20680:(e,t,n)=>{"use strict";n.d(t,{w:()=>c});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class SettingsToggle extends s.Component{render(){const{label:e,children:t,className:n}=this.props;return(0,i.jsxs)("div",Object.assign({className:o()("settings-toggle",n)},{children:[e&&(0,i.jsx)("div",Object.assign({className:"settings-label"},{children:e})),t]}))}};c=l([a.Z],c)},43368:(e,t,n)=>{"use strict";n.d(t,{Z:()=>SingleScrollbar});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(74170),l=n(55580),c=n(41920),d=n(24180),u=n(98878),h=n(58844),p=n(65270),m=n(44450),f=n(87982),g=n(61445);class SingleScrollbar extends s.Component{constructor(e){super(e),this.outerWrapperRef=(0,s.createRef)(),this.innerWrapperRef=(0,s.createRef)(),this.contentContainerRef=(0,s.createRef)(),this.dragStartScroll=0,this.listening=!1,this.animation=null,this.handlingPaused=!1,this.isUnmounting=!1,this.handleEvent=e=>{"mousedown"!==e.type&&"pointerdown"!==e.type&&"touchstart"!==e.type||(this.handlingPaused=!1),this.props.suppressDrag||this.handlingPaused||this.inputFilter.handleEvent(e)},this.getScrolledOffset=()=>{if(!this.innerWrapperRef.current||0===this.state.contentSize)return 0;const e=this.props.direction===c.Nm.vertical?"scrollTop":"scrollLeft";return this.innerWrapperRef.current[e]/this.state.contentSize},this.getScrollableContainer=()=>this.innerWrapperRef.current||void 0,this.pauseScrollHandling=()=>{this.handlingPaused=!0,this.toggleDownEventListening(!1)},this.scrollWithScrollBar=e=>{if(!this.props.suppressDrag){const t=this.getAxis();e.hasOwnProperty(t)&&this.scrollTo(e[t])}},this.scrollTo=e=>{void 0===e||isNaN(e)||(this.setScrollPosition(Math.max(Math.min(1,e)*this.state.contentSize,0)),this.setState({scrollOffset:this.getScrollPosition()}))},this.handleDragStart=()=>{this.setState({scrollCenter:null})},this.handlePressStart=()=>{this.dragStartScroll=this.getScrollPosition()},this.handlePressMove=e=>{if(!this.props.suppressDrag){const t=(e[this.getAxis()]+this.dragStartScroll)/this.state.contentSize;this.scrollTo(t)}},this.handleWheelEvent=e=>{if(this.props.suppressDrag)return void e.preventDefault();this.props.direction===c.Nm.horizontal&&0===e.deltaX&&0!==e.deltaY?(this.handlePressStart(),this.handlePressMove({x:e.deltaY,y:0})):(this.setState({scrollCenter:null}),this.handleExternalChange())},this.handleClick=e=>{this.props.handleClick&&this.props.handleClick(e)},this.handleDragEnd=(e,t)=>{const n=e[this.getAxis()]/t,i=Math.min(c.UI,Math.abs(c.UI*n)),s=this.getScrollPosition(),r=n*i/2;this.animation=new u.Z({duration:i,startValue:s/this.state.contentSize,endValue:Math.max(0,Math.min((s+r)/this.state.contentSize,1)),easingFunction:p.hl})},this.debouncedSetState=e=>{new URL(`${document.location}`).searchParams.get("temp-disable-debounce-scroll")?this.setState(e):(cancelAnimationFrame(this.rAFHandle),this.rAFHandle=requestAnimationFrame((()=>{this.isUnmounting||this.setState(e)})))},this.onManualScroll=()=>{this.props.onScrolled&&this.props.onScrolled()},this.onButtonScroll=e=>{if(this.contentContainerRef.current&&this.props.steps){const t=this.props.direction===c.Nm.vertical?"offsetHeight":"offsetWidth",n=this.contentContainerRef.current[t]/this.props.steps,i=this.getScrollPosition();let s;s=e?(i+n)/this.state.contentSize:(i-n)/this.state.contentSize,this.scrollTo((0,a.uZ)(s,0,1))}},this.onScrollBack=()=>{this.onButtonScroll(!1)},this.onScrollForward=()=>{this.onButtonScroll(!0)},this.onHoldScrollBack=()=>{this.mouseInterval=window.setInterval(this.onScrollBack,300)},this.onHoldScrollForward=()=>{this.mouseInterval=window.setInterval(this.onScrollForward,300)},this.onScrollButtonUp=()=>{window.clearInterval(this.mouseInterval)},this.renderScrollBackButton=()=>{const e=this.getScrollPosition(),t=this.props.direction===c.Nm.vertical?"icon-dpad-up":"icon-dpad-left",n=0===e?g.BN.DISABLED:g.BN.ENABLED;return(0,i.jsx)(f.hU,{className:o()("scroll-button","scroll-back"),iconClass:t,buttonStyle:f.Dd.CLEAR,buttonState:n,onClick:this.onScrollBack,onMouseDown:this.onHoldScrollBack,onMouseUp:this.onScrollButtonUp})},this.renderScrollForwardButton=()=>{const e=this.contentContainerRef.current,t=this.innerWrapperRef.current;if(!e||!t)return null;const n=this.getScrollPosition(),s=this.props.direction===c.Nm.vertical?"offsetHeight":"offsetWidth",r=this.props.direction===c.Nm.vertical?"icon-dpad-down":"icon-dpad-right",a=e[s]-t[s]-n>0?g.BN.ENABLED:g.BN.DISABLED;return(0,i.jsx)(f.hU,{className:o()("scroll-button","scroll-forward"),iconClass:r,buttonStyle:f.Dd.CLEAR,buttonState:a,onClick:this.onScrollForward,onMouseDown:this.onHoldScrollForward,onMouseUp:this.onScrollButtonUp})},this.state={scrollCenter:null,scrollOffset:0,innerSize:0,contentSize:0},this.resizeSubscription=(0,m.kp)(m.g_.RESIZE,(()=>this.handleExternalChange(m.g_.RESIZE))),this.inputFilter=new h.Z({handlePressStart:this.handlePressStart,handlePressMove:this.handlePressMove,handleDragStart:this.handleDragStart,handleDragEnd:this.handleDragEnd,handleClick:this.handleClick})}componentDidMount(){this.resizeSubscription.renew(),this.props.thumbScrollingOnly?this.innerWrapperRef.current&&this.innerWrapperRef.current.addEventListener("click",this.handleClick):this.toggleDownEventListening(!0),this.toggleDragHandling(!0),this.innerWrapperRef.current&&this.innerWrapperRef.current.addEventListener("wheel",this.handleWheelEvent),this.inputFilter.setEnabled(!this.props.suppressDrag),this.handleExternalChange()}componentWillUnmount(){this.isUnmounting=!0,this.resizeSubscription.cancel(),this.innerWrapperRef.current&&this.innerWrapperRef.current.removeEventListener("wheel",this.handleWheelEvent),this.toggleDragHandling(!1),this.props.thumbScrollingOnly?this.innerWrapperRef.current&&this.innerWrapperRef.current.removeEventListener("click",this.handleClick):this.toggleDownEventListening(!1)}UNSAFE_componentWillReceiveProps(e){e.thumbScrollingOnly&&!this.props.thumbScrollingOnly?(this.innerWrapperRef.current&&this.innerWrapperRef.current.addEventListener("click",this.handleClick),this.toggleDownEventListening(!1)):!e.thumbScrollingOnly&&this.props.thumbScrollingOnly&&(this.toggleDownEventListening(!0),this.innerWrapperRef.current&&this.innerWrapperRef.current.removeEventListener("click",this.handleClick)),e.suppressDrag!==this.props.suppressDrag&&this.inputFilter.setEnabled(!e.suppressDrag)}componentDidUpdate(e,t){this.props.waitToUpdate||this.handleExternalChange();const n=this.animation;if(n)if(n.isAnimating){const e=n.getUpdatedValue();window.requestAnimationFrame((()=>{this.innerWrapperRef.current&&this.scrollTo(e)}))}else this.animation=null;t.scrollOffset!==this.state.scrollOffset&&this.props.onScrolled&&this.props.onScrolled()}toggleDownEventListening(e){const t=this.handleEvent;this.innerWrapperRef.current&&(e?window.PointerEvent?this.innerWrapperRef.current.addEventListener("pointerdown",t):(this.innerWrapperRef.current.addEventListener("mousedown",t),this.innerWrapperRef.current.addEventListener("touchstart",t)):window.PointerEvent?this.innerWrapperRef.current.removeEventListener("pointerdown",t):(this.innerWrapperRef.current.removeEventListener("mousedown",t),this.innerWrapperRef.current.removeEventListener("touchstart",t)))}toggleDragHandling(e){const t=this.handleEvent;!this.listening&&e?(this.listening=!0,window.PointerEvent?(window.addEventListener("pointermove",t),window.addEventListener("pointerup",t)):(window.addEventListener("mousemove",t),window.addEventListener("mouseleave",t),window.addEventListener("mouseup",t),window.addEventListener("touchmove",t),window.addEventListener("touchend",t),window.addEventListener("touchcancel",t))):this.listening&&!e&&(this.listening=!1,window.PointerEvent?(window.removeEventListener("pointermove",t),window.removeEventListener("pointerup",t)):(window.removeEventListener("mousemove",t),window.removeEventListener("mouseleave",t),window.removeEventListener("mouseup",t),window.removeEventListener("touchmove",t),window.removeEventListener("touchend",t),window.removeEventListener("touchcancel",t)))}getScrollPosition(){if(!this.innerWrapperRef.current)return 0;const e=this.props.direction===c.Nm.vertical?"scrollTop":"scrollLeft";return this.innerWrapperRef.current[e]}setScrollPosition(e){if(!this.innerWrapperRef.current)return;const t=this.props.direction===c.Nm.vertical?"scrollTop":"scrollLeft";this.innerWrapperRef.current[t]=e}getAxis(){return this.props.direction===c.Nm.vertical?"y":"x"}scrollToPercentage(e,t){this.animation=new u.Z({duration:t,startValue:this.getScrolledOffset(),endValue:Math.max(0,Math.min(1,e))})}scrollToElement(e){const t=this.innerWrapperRef.current,n=this.outerWrapperRef.current;if(!e||!t||!n)return;if(!(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINS))return;const i=this.props.direction===c.Nm.vertical;this.setState({scrollCenter:e});const s=i?"offsetTop":"offsetLeft",r=i?"offsetHeight":"offsetWidth";let o=e[s]+e[r]/2,a=e;for(;a.parentElement&&a!==t;)a=a.parentElement,o+=a[s];const l=(o-n.parentElement[r]/2)/this.state.contentSize;this.animation=new u.Z({duration:c.UI,startValue:this.getScrollPosition()/this.state.contentSize,endValue:Math.max(0,Math.min(1,l))})}handleExternalChange(e){if(this.isUnmounting||!this.innerWrapperRef.current||!this.contentContainerRef.current)return;this.state.scrollCenter&&e&&e===m.g_.RESIZE&&this.scrollToElement(this.state.scrollCenter);const t=this.props.direction===c.Nm.vertical?"clientHeight":"clientWidth",n={innerSize:Number(this.innerWrapperRef.current&&this.innerWrapperRef.current[t])||1,contentSize:Number(this.contentContainerRef.current&&this.contentContainerRef.current[t])||1,scrollOffset:this.innerWrapperRef.current&&this.getScrollPosition()};(0,l.g)(this.state,n)&&this.debouncedSetState(n)}needScrolling(){if(!this.contentContainerRef.current||!this.outerWrapperRef.current)return!1;const e=this.props.direction===c.Nm.vertical?"offsetHeight":"offsetWidth";return this.contentContainerRef.current[e]>this.outerWrapperRef.current[e]}render(){const{hideScrollbar:e,children:t,onScrollableChanged:n,scrollButtons:s,steps:r,onScrollPositionChange:a,direction:l,className:c}=this.props,{innerSize:u,contentSize:h,scrollOffset:p}=this.state,m=s&&!!r&&this.needScrolling();return(0,i.jsxs)("div",Object.assign({className:o()("outerScrollbarWrapper",[l],[c],{"button-scrolling":m}),ref:this.outerWrapperRef},{children:[m&&this.renderScrollBackButton(),(0,i.jsx)("div",Object.assign({className:"innerScrollbarWrapper",ref:this.innerWrapperRef},{children:(0,i.jsx)("div",Object.assign({className:"paddingScrollbarWrapper",ref:this.contentContainerRef},{children:t}))})),(0,i.jsx)(d.L,{direction:l,wrapperLength:u,childLength:h,scrollOffset:p,scrollTo:this.scrollWithScrollBar,forceHidden:!!e,onVisibilityChange:n,onScrollPositionChange:a,onThumbDrag:this.onManualScroll}),m&&this.renderScrollForwardButton()]}))}}},88629:(e,t,n)=>{"use strict";n.d(t,{h:()=>X,S:()=>SliderWithTooltip});var i=n(85893),s=n(67294);var r=function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}Object.create;Object.create;var a=function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};Object.create;function l(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,s,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(s)throw s.error}}return o}function d(e,t,n){if(n||2===arguments.length)for(var i,s=0,r=t.length;s<r;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}Object.create;var u=n(94184),h=n.n(u),p=function(e){return(Array.isArray(e)?e:[e]).filter((function(e){return!!e})).map((function(e){return"mdc-theme--"+e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}))},m=s.forwardRef((function(e,t){var n=e.tag,i=void 0===n?"div":n,r=(e.theme,e.element),o=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n}(e,["tag","theme","element"]),l=r?r.props(o):o,c=r?f(t,r.setRef):t;return s.createElement(i,a({},l,{ref:c}))})),f=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n,i;try{for(var s=l(e),r=s.next();!r.done;r=s.next()){var o=r.value;"function"==typeof o?o(t):o&&"current"in o&&(o.current=t)}}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}}},g=function(e,t){"function"==typeof e?e(t):e&&"current"in e&&(e.current=t)};function v(e){var t=s.forwardRef(e),n=function(e,t){return s.createElement(s.Fragment,null)};return n.displayName=e.constructor.name||"RMWCComponent",t.displayName=n.displayName,t}var y={blur:"onBlur",cancel:"onCancel",click:"onClick",close:"onClose",contextmenu:"onContextMenu",copy:"onCopy",cut:"onCut",auxclick:"onAuxClick",doubleclick:"onDoubleClick",dragend:"onDragEnd",dragstart:"onDragStart",drop:"onDrop",focus:"onFocus",input:"onInput",invalid:"onInvalid",keydown:"onKeyDown",keypress:"onKeyPress",keyup:"onKeyUp",mousedown:"onMouseDown",mouseup:"onMouseUp",paste:"onPaste",pause:"onPause",play:"onPlay",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerup:"onPointerUp",ratechange:"onRateChange",reset:"onReset",seeked:"onSeeked",submit:"onSubmit",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchstart:"onTouchStart",volumechange:"onVolumeChange",abort:"onAbort",animationend:"onAnimationEnd",animationiteration:"onAnimationIteration",animationstart:"onAnimationStart",canplay:"onCanPlay",canplaythrough:"onCanPlayThrough",drag:"onDrag",dragenter:"onDragEnter",dragexit:"onDragExit",dragleave:"onDragLeave",dragover:"onDragOver",durationchange:"onDurationChange",emptied:"onEmptied",encrypted:"onEncrypted",ended:"onEnded",error:"onError",gotpointercapture:"onGotPointerCapture",load:"onLoad",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetadata",loadstart:"onLoadStart",lostpointercapture:"onLostPointerCapture",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseover:"onMouseOver",playing:"onPlaying",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",progress:"onProgress",scroll:"onScroll",seeking:"onSeeking",stalled:"onStalled",suspend:"onSuspend",timeupdate:"onTimeUpdate",toggle:"onToggle",touchmove:"onTouchMove",transitionend:"onTransitionEnd",waiting:"onWaiting",wheel:"onWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",change:"onChange",select:"onSelect",beforeinput:"onBeforeInput",compositionend:"onCompositionEnd",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate"},b=function(e){return y[e]||e},S=function(){function e(e){this._classes=new Set,this._events={},this._style={},this._props={},this._ref=null,this._onChange=null,this._onChange=e,this.onChange=this.onChange.bind(this),this.addClass=this.addClass.bind(this),this.removeClass=this.removeClass.bind(this),this.hasClass=this.hasClass.bind(this),this.setProp=this.setProp.bind(this),this.getProp=this.getProp.bind(this),this.removeProp=this.removeProp.bind(this),this.setStyle=this.setStyle.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.setRef=this.setRef.bind(this)}return e.prototype.onChange=function(){this._onChange&&this._onChange()},e.prototype.destroy=function(){var e=this;this._onChange=null,this._events={},this._style={},this._props={},this._classes=new Set,setTimeout((function(){e._ref=null}))},e.prototype.addClass=function(e){this._classes.has(e)||(this._classes.add(e),this.onChange())},e.prototype.removeClass=function(e){this._classes.has(e)&&(this._classes.delete(e),this.onChange())},e.prototype.hasClass=function(e){return this._classes.has(e)},e.prototype.setProp=function(e,t,n){void 0===n&&(n=!1),this._props[e]!==t&&(this._props[e]=t,!n&&this.onChange())},e.prototype.getProp=function(e){return this._props[e]},e.prototype.removeProp=function(e){void 0!==this._props[e]&&(delete this._props[e],this.onChange())},e.prototype.props=function(e){var t=this,n=e.className,i=void 0===n?"":n,s=e.style,r=void 0===s?{}:s,o=Object.entries(e).reduce((function(e,n){var i=c(n,2),s=i[0],r=i[1],o=t._events[s];if("function"==typeof r&&"function"==typeof o){e[s]=function(e){return o(e),r(e)}}return e}),a({},this._events)),l=h()(i,d([],c(this._classes))),u=a(a({},this._style),r);return a(a(a(a({},e),this._props),o),{style:u,className:l})},e.prototype.setStyle=function(e,t){e=e.startsWith("--")?e:e.replace(/(-[a-z])/g,(function(e){return e.toUpperCase().replace("-","")})),this._style[e]!==t&&(this._style[e]=t,this.onChange())},e.prototype.addEventListener=function(e,t){var n=b(e);this._events[n]!==t&&(this._events[n]=t,this.onChange())},e.prototype.removeEventListener=function(e,t){var n=b(e);this._events[n]&&(delete this._events[n],this.onChange())},e.prototype.setRef=function(e){e&&(this._ref=e)},Object.defineProperty(e.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),e}(),E=function(e){return function(t,n,i){var s;void 0===i&&(i=!1),s=new CustomEvent(t,{detail:n,bubbles:i}),Object.defineProperty(s,"target",{value:n,writable:!1}),Object.defineProperty(s,"currentTarget",{value:n,writable:!1});var r=t;return e[r]&&e[r](s),s}},T={bottom:0,height:0,left:0,right:0,top:0,width:0},w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var x=function(){return(x=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};var _={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}},M={animationend:{cssProperty:"animation",prefixed:"webkitAnimationEnd",standard:"animationend"},animationiteration:{cssProperty:"animation",prefixed:"webkitAnimationIteration",standard:"animationiteration"},animationstart:{cssProperty:"animation",prefixed:"webkitAnimationStart",standard:"animationstart"},transitionend:{cssProperty:"transition",prefixed:"webkitTransitionEnd",standard:"transitionend"}};function O(e){return Boolean(e.document)&&"function"==typeof e.document.createElement}var A=function(){function e(e){void 0===e&&(e={}),this.adapter_=e}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();var C={ACTIVE:"mdc-slider--active",DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",FOCUS:"mdc-slider--focus",HAS_TRACK_MARKER:"mdc-slider--display-markers",IN_TRANSIT:"mdc-slider--in-transit",IS_DISCRETE:"mdc-slider--discrete"},N={ARIA_DISABLED:"aria-disabled",ARIA_VALUEMAX:"aria-valuemax",ARIA_VALUEMIN:"aria-valuemin",ARIA_VALUENOW:"aria-valuenow",CHANGE_EVENT:"MDCSlider:change",INPUT_EVENT:"MDCSlider:input",PIN_VALUE_MARKER_SELECTOR:".mdc-slider__pin-value-marker",STEP_DATA_ATTR:"data-step",THUMB_CONTAINER_SELECTOR:".mdc-slider__thumb-container",TRACK_MARKER_CONTAINER_SELECTOR:".mdc-slider__track-marker-container",TRACK_SELECTOR:".mdc-slider__track"},D={PAGE_FACTOR:4},I=["mousedown","pointerdown","touchstart"],L=["mouseup","pointerup","touchend"],P={mousedown:"mousemove",pointerdown:"pointermove",touchstart:"touchmove"},R="ArrowDown",k="ArrowLeft",U="ArrowRight",B="ArrowUp",F="End",V="Home",H="PageDown",j="PageUp",G=function(e){function t(n){var i=e.call(this,x({},t.defaultAdapter,n))||this;return i.savedTabIndex_=NaN,i.active_=!1,i.inTransit_=!1,i.isDiscrete_=!1,i.hasTrackMarker_=!1,i.handlingThumbTargetEvt_=!1,i.min_=0,i.max_=100,i.step_=0,i.value_=0,i.disabled_=!1,i.preventFocusState_=!1,i.thumbContainerPointerHandler_=function(){return i.handlingThumbTargetEvt_=!0},i.interactionStartHandler_=function(e){return i.handleDown_(e)},i.keydownHandler_=function(e){return i.handleKeydown_(e)},i.focusHandler_=function(){return i.handleFocus_()},i.blurHandler_=function(){return i.handleBlur_()},i.resizeHandler_=function(){return i.layout()},i}return function(e,t){function n(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return C},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return N},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return D},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabIndex:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){},registerThumbContainerInteractionHandler:function(){},deregisterThumbContainerInteractionHandler:function(){},registerBodyInteractionHandler:function(){},deregisterBodyInteractionHandler:function(){},registerResizeHandler:function(){},deregisterResizeHandler:function(){},notifyInput:function(){},notifyChange:function(){},setThumbContainerStyleProperty:function(){},setTrackStyleProperty:function(){},setMarkerValue:function(){},setTrackMarkers:function(){},isRTL:function(){return!1}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;this.isDiscrete_=this.adapter_.hasClass(C.IS_DISCRETE),this.hasTrackMarker_=this.adapter_.hasClass(C.HAS_TRACK_MARKER),I.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.interactionStartHandler_),e.adapter_.registerThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.registerInteractionHandler("keydown",this.keydownHandler_),this.adapter_.registerInteractionHandler("focus",this.focusHandler_),this.adapter_.registerInteractionHandler("blur",this.blurHandler_),this.adapter_.registerResizeHandler(this.resizeHandler_),this.layout(),this.isDiscrete_&&0===this.getStep()&&(this.step_=1)},t.prototype.destroy=function(){var e=this;I.forEach((function(t){e.adapter_.deregisterInteractionHandler(t,e.interactionStartHandler_),e.adapter_.deregisterThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.deregisterInteractionHandler("keydown",this.keydownHandler_),this.adapter_.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter_.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter_.deregisterResizeHandler(this.resizeHandler_)},t.prototype.setupTrackMarker=function(){this.isDiscrete_&&this.hasTrackMarker_&&0!==this.getStep()&&this.adapter_.setTrackMarkers(this.getStep(),this.getMax(),this.getMin())},t.prototype.layout=function(){this.rect_=this.adapter_.computeBoundingRect(),this.updateUIForCurrentValue_()},t.prototype.getValue=function(){return this.value_},t.prototype.setValue=function(e){this.setValue_(e,!1)},t.prototype.getMax=function(){return this.max_},t.prototype.setMax=function(e){if(e<this.min_)throw new Error("Cannot set max to be less than the slider's minimum value");this.max_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(N.ARIA_VALUEMAX,String(this.max_)),this.setupTrackMarker()},t.prototype.getMin=function(){return this.min_},t.prototype.setMin=function(e){if(e>this.max_)throw new Error("Cannot set min to be greater than the slider's maximum value");this.min_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(N.ARIA_VALUEMIN,String(this.min_)),this.setupTrackMarker()},t.prototype.getStep=function(){return this.step_},t.prototype.setStep=function(e){if(e<0)throw new Error("Step cannot be set to a negative number");this.isDiscrete_&&("number"!=typeof e||e<1)&&(e=1),this.step_=e,this.setValue_(this.value_,!1,!0),this.setupTrackMarker()},t.prototype.isDisabled=function(){return this.disabled_},t.prototype.setDisabled=function(e){this.disabled_=e,this.toggleClass_(C.DISABLED,this.disabled_),this.disabled_?(this.savedTabIndex_=this.adapter_.getTabIndex(),this.adapter_.setAttribute(N.ARIA_DISABLED,"true"),this.adapter_.removeAttribute("tabindex")):(this.adapter_.removeAttribute(N.ARIA_DISABLED),isNaN(this.savedTabIndex_)||this.adapter_.setAttribute("tabindex",String(this.savedTabIndex_)))},t.prototype.handleDown_=function(e){var t=this;if(!this.disabled_){this.preventFocusState_=!0,this.setInTransit_(!this.handlingThumbTargetEvt_),this.handlingThumbTargetEvt_=!1,this.setActive_(!0);var n=function(e){t.handleMove_(e)},i=P[e.type],s=function(){t.handleUp_(),t.adapter_.deregisterBodyInteractionHandler(i,n),L.forEach((function(e){return t.adapter_.deregisterBodyInteractionHandler(e,s)}))};this.adapter_.registerBodyInteractionHandler(i,n),L.forEach((function(e){return t.adapter_.registerBodyInteractionHandler(e,s)})),this.setValueFromEvt_(e)}},t.prototype.handleMove_=function(e){e.preventDefault(),this.setValueFromEvt_(e)},t.prototype.handleUp_=function(){this.setActive_(!1),this.adapter_.notifyChange()},t.prototype.getClientX_=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].clientX:e.clientX},t.prototype.setValueFromEvt_=function(e){var t=this.getClientX_(e),n=this.computeValueFromClientX_(t);this.setValue_(n,!0)},t.prototype.computeValueFromClientX_=function(e){var t=this.max_,n=this.min_,i=(e-this.rect_.left)/this.rect_.width;return this.adapter_.isRTL()&&(i=1-i),n+i*(t-n)},t.prototype.handleKeydown_=function(e){var t=this.getKeyId_(e),n=this.getValueForKeyId_(t);isNaN(n)||(e.preventDefault(),this.adapter_.addClass(C.FOCUS),this.setValue_(n,!0),this.adapter_.notifyChange())},t.prototype.getKeyId_=function(e){return e.key===k||37===e.keyCode?k:e.key===U||39===e.keyCode?U:e.key===B||38===e.keyCode?B:e.key===R||40===e.keyCode?R:e.key===V||36===e.keyCode?V:e.key===F||35===e.keyCode?F:e.key===j||33===e.keyCode?j:e.key===H||34===e.keyCode?H:""},t.prototype.getValueForKeyId_=function(e){var t=this,n=t.max_,i=t.min_,s=t.step_||(n-i)/100;switch(this.adapter_.isRTL()&&(e===k||e===U)&&(s=-s),e){case k:case R:return this.value_-s;case U:case B:return this.value_+s;case V:return this.min_;case F:return this.max_;case j:return this.value_+s*D.PAGE_FACTOR;case H:return this.value_-s*D.PAGE_FACTOR;default:return NaN}},t.prototype.handleFocus_=function(){this.preventFocusState_||this.adapter_.addClass(C.FOCUS)},t.prototype.handleBlur_=function(){this.preventFocusState_=!1,this.adapter_.removeClass(C.FOCUS)},t.prototype.setValue_=function(e,t,n){if(void 0===n&&(n=!1),e!==this.value_||n){var i=this.min_,s=this.max_,r=e===i||e===s;this.step_&&!r&&(e=this.quantize_(e)),e<i?e=i:e>s&&(e=s),e=e||0,this.value_=e,this.adapter_.setAttribute(N.ARIA_VALUENOW,String(this.value_)),this.updateUIForCurrentValue_(),t&&(this.adapter_.notifyInput(),this.isDiscrete_&&this.adapter_.setMarkerValue(e))}},t.prototype.quantize_=function(e){return Math.round(e/this.step_)*this.step_},t.prototype.updateUIForCurrentValue_=function(){var e=this,t=this,n=t.max_,i=t.min_,s=(t.value_-i)/(n-i),r=s*this.rect_.width;this.adapter_.isRTL()&&(r=this.rect_.width-r);var o=function(e,t){if(O(e)&&t in _){var n=e.document.createElement("div"),i=_[t],s=i.standard,r=i.prefixed;return s in n.style?s:r}return t}(window,"transform"),a=function(e,t){if(O(e)&&t in M){var n=e.document.createElement("div"),i=M[t],s=i.standard,r=i.prefixed;return i.cssProperty in n.style?s:r}return t}(window,"transitionend");if(this.inTransit_){var l=function(){e.setInTransit_(!1),e.adapter_.deregisterThumbContainerInteractionHandler(a,l)};this.adapter_.registerThumbContainerInteractionHandler(a,l)}requestAnimationFrame((function(){e.adapter_.setThumbContainerStyleProperty(o,"translateX("+r+"px) translateX(-50%)"),e.adapter_.setTrackStyleProperty(o,"scaleX("+s+")")}))},t.prototype.setActive_=function(e){this.active_=e,this.toggleClass_(C.ACTIVE,this.active_)},t.prototype.setInTransit_=function(e){this.inTransit_=e,this.toggleClass_(C.IN_TRANSIT,this.inTransit_)},t.prototype.toggleClass_=function(e,t){t?this.adapter_.addClass(e):this.adapter_.removeClass(e)},t}(A);var z=function(e){var t=(0,s.useRef)(),n=(0,s.useRef)(),i=function(e){var t=e.foundation,n=e.props,i=e.elements,r=e.api,o=c((0,s.useState)(0),2)[1],l=(0,s.useRef)(n);l.current=n;var u=(0,s.useMemo)((function(){return Object.keys(i).reduce((function(e,t){return e[t]=new S((function(){o((function(e){return e+1}))})),e}),{})}),[]),h=(0,s.useMemo)((function(){var e=t(a(a({},u),{getProps:function(){return l.current},emit:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return E(l.current).apply(void 0,d([],c(e)))}}));return r&&g(l.current.apiRef,r(a({foundation:e},u))),e}),[]);return(0,s.useEffect)((function(){var e=h;return e.init(),r&&g(l.current.apiRef,r(a({foundation:e},u))),g(l.current.foundationRef,e),function(){e.destroy(),g(l.current.apiRef,null),g(l.current.foundationRef,null),Object.values(u).map((function(e){return e.destroy()})),l.current={}}}),[h,u]),a({foundation:h},u)}({props:e,elements:{rootEl:!0,thumbContainerEl:!0,sliderPinEl:!0},foundation:function(e){var i,s,r,o=e.rootEl,a=e.thumbContainerEl,c=e.sliderPinEl,d=e.emit;return new G({hasClass:function(e){return o.hasClass(e)},addClass:function(e){return o.addClass(e)},removeClass:function(e){return o.removeClass(e)},getAttribute:function(e){return o.getProp(e)},setAttribute:(i=function(e,t){return o.setProp(e,t)},s=300,function(){var e=this,t=arguments,n=function(){r=null,i.apply(e,t)};null!==r&&clearTimeout(r),r=setTimeout(n,s)}),removeAttribute:function(e){return o.removeProp(e)},computeBoundingRect:function(){return o.ref?o.ref.getBoundingClientRect():T},getTabIndex:function(){return o.ref?o.ref.tabIndex:0},registerInteractionHandler:function(e,t){o.addEventListener(e,t)},deregisterInteractionHandler:function(e,t){o.removeEventListener(e,t)},registerThumbContainerInteractionHandler:function(e,t){a.addEventListener(e,t)},deregisterThumbContainerInteractionHandler:function(e,t){a.removeEventListener(e,t)},registerBodyInteractionHandler:function(e,t){document.body&&document.body.addEventListener(e,t)},deregisterBodyInteractionHandler:function(e,t){document.body&&document.body.removeEventListener(e,t)},registerResizeHandler:function(e){window.addEventListener("resize",e)},deregisterResizeHandler:function(e){window.removeEventListener("resize",e)},notifyInput:function(){d("onInput",{value:l.getValue()})},notifyChange:function(){d("onChange",{value:l.getValue()})},setThumbContainerStyleProperty:function(e,t){a.setStyle(e,t)},setTrackStyleProperty:function(e,n){var i;null===(i=t.current)||void 0===i||i.style.setProperty(e,n)},setMarkerValue:function(e){c.setProp("value",e)},setTrackMarkers:function(e,t,i){var s,r=e.toLocaleString(),o="linear-gradient(to right, currentColor 2px, transparent 0) "+("0 center / calc((100% - 2px) / "+("(("+t.toLocaleString()+" - "+i.toLocaleString()+") / "+r+")")+") 100% repeat-x");null===(s=n.current)||void 0===s||s.style.setProperty("background",o)},isRTL:function(){return!!o.ref&&"rtl"===getComputedStyle(o.ref).direction}})}}),l=i.foundation,u=o(i,["foundation"]);return(0,s.useEffect)((function(){void 0!==e.max&&l.setMax(+e.max)}),[e.max,l]),(0,s.useEffect)((function(){void 0!==e.min&&l.setMin(+e.min)}),[e.min,l]),(0,s.useEffect)((function(){var t=void 0!==e.value?Number(e.value):l.getValue(),n=l.getMin(),i=l.getMax();t<n&&(console.warn("Attempted to set slider to "+t+" which is less than min: "+n),t=n),t>i&&(console.warn("Attempted to set slider to "+t+" which is greater than max: "+i),t=i),l.setValue(t)}),[e.value,l]),(0,s.useEffect)((function(){void 0!==e.step&&l.setStep(+e.step)}),[e.step,l]),(0,s.useEffect)((function(){void 0!==e.disabled&&l.setDisabled(e.disabled)}),[e.disabled,l]),(0,s.useEffect)((function(){void 0!==e.discrete&&(l.isDiscrete_=e.discrete),e.discrete&&0===l.getStep()&&l.setStep(1)}),[e.discrete,l]),(0,s.useEffect)((function(){var t=l.hasTrackMarker_;void 0!==e.displayMarkers&&e.displayMarkers!==t&&(l.hasTrackMarker_=e.displayMarkers,window.requestAnimationFrame((function(){return l.setupTrackMarker()})))}),[e.displayMarkers,l]),(0,s.useEffect)((function(){var e=l.handleDown_.bind(l);l.handleDown_=function(t){t.persist(),e(t)}}),[l]),r({setTrackRef:function(e){return t.current=e},setTrackMarkerContainerRef:function(e){return n.current=e}},u)},W=s.memo(s.forwardRef((function(e,t){return s.createElement("div",{ref:t,className:"mdc-slider__track"})}))),K=s.memo(s.forwardRef((function(e,t){return s.createElement("div",{ref:t,className:"mdc-slider__track-marker-container"})}))),Y=s.memo((function(e){var t=e.value;return s.createElement("div",{className:"mdc-slider__pin"},s.createElement("span",{className:"mdc-slider__pin-value-marker"},t))})),q=s.memo((function(){return s.createElement("svg",{className:"mdc-slider__thumb",width:"21",height:"21"},s.createElement("circle",{cx:"10.5",cy:"10.5",r:"7.875"}))})),Z=s.memo((function(){return s.createElement("div",{className:"mdc-slider__focus-ring"})})),$=v((function(e,t){var n=z(e),i=n.rootEl,a=n.thumbContainerEl,l=n.sliderPinEl,u=n.setTrackRef,f=n.setTrackMarkerContainerRef,g=e.value,v=(e.min,e.max),y=e.discrete,b=e.displayMarkers,S=e.step,E=e.disabled,T=(e.onChange,e.onInput,e.children),w=(e.foundationRef,o(e,["value","min","max","discrete","displayMarkers","step","disabled","onChange","onInput","children","foundationRef"])),x=function(e,t){return h().apply(void 0,d(d([e.className],c(e.theme?p(e.theme):[])),c("function"==typeof t?t(e):t)))}(e,["mdc-slider",{"mdc-slider--discrete":y,"mdc-slider--display-markers":b&&y}]),_=S?{"data-step":S}:{};return b&&!y&&console.warn("The 'displayMarkers' prop on rmwc Slider will\n        only work in conjunction with the 'discrete' prop"),s.createElement(m,r({tabIndex:0,role:"slider","aria-valuemax":v,"aria-valuenow":g,"aria-label":"Select Value"},E?{"aria-disabled":E}:{},_,w,{ref:t,element:i,className:x}),s.createElement("div",{className:"mdc-slider__track-container"},s.createElement(W,{ref:u}),b&&s.createElement(K,{ref:f})),s.createElement(m,{element:a,className:"mdc-slider__thumb-container"},y&&s.createElement(Y,{value:l.getProp("value")}),s.createElement(q,null),s.createElement(Z,null)),T)}));n(85925);let Q=0;class SliderWithTooltip extends s.Component{constructor(e){super(e),this.mdcRef=(0,s.createRef)(),this.setValue=e=>{this.setState({value:e})},this.onSliderInput=e=>{var t;const n=e.detail.value;this.layoutRecalculated||(null===(t=this.mdcRef.current)||void 0===t||t.layout(),this.layoutRecalculated=!0),this.setState({value:n}),this.props.onInput&&this.props.onInput(n)},this.onSliderChange=e=>{const t=e.detail.value;this.setState({value:t}),this.props.onChange&&this.props.onChange(t)},this.getLeftOffset=()=>100*(this.state.value-this.props.min)/(this.props.max-this.props.min)+"%",this.getSliderId=()=>`slider-with-tooltip-${this.id}`,this.getStyleElement=()=>`#${this.getSliderId()} .mdc-slider__thumb-container {\n        left: ${this.getLeftOffset()}\n    }`,this.getDisplayValue=e=>{const{formatNumbers:t,units:n}=this.props;return(t?t(e):e)+(n||"")},this.setActive=e=>()=>this.setState({active:e}),this.hasChanged=()=>{this.setState({hasChanged:!1})},this.onMouseDown=e=>{this.props.onInputStart&&this.props.onInputStart()},this.onEventMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.onMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.id=Q++,this.state={value:void 0!==e.initialValue?e.initialValue:(e.max+e.min)/2,active:!1,hasChanged:!1},this.setActiveSlider=this.setActive(!0),this.setInactiveSlider=this.setActive(!1)}componentDidMount(){document.addEventListener("mouseup",this.onEventMouseUp),document.addEventListener("mouseleave",this.onEventMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.onEventMouseUp),document.removeEventListener("mouseleave",this.onEventMouseUp)}componentDidUpdate(e,t){t.value!==this.state.value&&(clearTimeout(this.hasChangedTimeout),this.setState({hasChanged:!0}),this.hasChangedTimeout=window.setTimeout(this.hasChanged,450))}render(){const{width:e,displayBounds:t,min:n,max:s,discrete:r,tooltipPosition:o,variant:a="default",disabled:l}=this.props,{active:c,hasChanged:d,value:u}=this.state,p={left:this.getLeftOffset()},m="inline-value"===a,f=!m&&t,g=!m;return(0,i.jsxs)("div",Object.assign({id:this.getSliderId(),className:h()("slider-with-tooltip",{displayBounds:t,disabled:l}),style:{width:`${e}px`},onMouseEnter:this.setActiveSlider,onMouseLeave:this.setInactiveSlider},{children:[g&&o===X.UP&&(0,i.jsx)("div",{className:h()("slider-tooltip",{active:c||d}),"data-balloon":this.getDisplayValue(u),"data-balloon-pos":X.UP,style:p}),f&&(0,i.jsx)("div",Object.assign({className:"min-amount"},{children:this.getDisplayValue(n)})),m&&(0,i.jsx)("div",Object.assign({className:"min-amount"},{children:this.getDisplayValue(u)})),(0,i.jsx)($,{discrete:r,min:n,max:s,value:u,onInput:this.onSliderInput,onChange:this.onSliderChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,foundationRef:this.mdcRef,disabled:l}),f&&(0,i.jsx)("div",Object.assign({className:"max-amount"},{children:this.getDisplayValue(s)})),(0,i.jsx)("style",{dangerouslySetInnerHTML:{__html:this.getStyleElement()}}),g&&o===X.DOWN&&(0,i.jsx)("div",{className:h()("slider-tooltip",{active:c||d}),"data-balloon":this.getDisplayValue(u),"data-balloon-pos":X.DOWN,style:p})]}))}}var X;!function(e){e.UP="up",e.DOWN="down"}(X||(X={}))},39706:(e,t,n)=>{"use strict";n.d(t,{KQ:()=>i});const i=e=>{let t="";t+=Math.floor(e)+"'";const n=Math.floor(e%1*12);return n<10&&(t+="0"),t+=n+"''",t}},91724:(e,t,n)=>{"use strict";n.d(t,{r:()=>StemEditor});var i=n(85893),s=n(67294),r=n(60405),o=n(8428),a=n(93510),l=n(88629),c=n(48558),d=n(39706),u=n(41270);class StemEditor extends s.Component{constructor(e){super(e),this.sliderRef=(0,s.createRef)(),this.stemLengthUpdating=(e,t=!0)=>{const n=t?(0,c._F)(e):e;n!==this.props.stemLength&&this.props.onLengthUpdate(n)},this.saveStemLength=(e,t=!0)=>{const n=t?(0,c._F)(e):e;this.props.onLengthChanged(n)},this.onChangeStemEnabled=e=>{const t=e.classList.contains("checked");this.props.onStemEnabledChanged(t)},this.stopPropagation=e=>e.stopPropagation(),this.updateUnits=()=>{this.setState({units:this.context.settings.tryGetProperty(o.gx.Units,a.M.IMPERIAL)})},this.formatStemHeight=e=>{if(this.state.units===a.M.IMPERIAL)return(0,d.KQ)(e);return`${Math.round(100*(0,c._F)(e))/100}m`},this.state={units:a.M.IMPERIAL}}componentDidMount(){this.updateUnits(),this.sliderRef.current&&this.sliderRef.current.setValue((0,c.zy)(this.props.stemLength)),this.context.settings.onPropertyChanged(o.gx.Units,this.updateUnits)}componentWillUnmount(){this.context.settings.removeOnPropertyChanged(o.gx.Units,this.updateUnits)}UNSAFE_componentWillReceiveProps(e){e.stemLength!==this.props.stemLength&&this.sliderRef.current&&this.sliderRef.current.setValue((0,c.zy)(e.stemLength))}render(){const{stemEnabled:e,stemLength:t,variant:n,disabled:s}=this.props;return(0,i.jsxs)("div",Object.assign({className:"stem-editor",onClick:this.stopPropagation},{children:[(0,i.jsx)("div",Object.assign({className:"stem-slider"},{children:(0,i.jsx)(l.S,{ref:this.sliderRef,discrete:!1,min:.1,max:9,initialValue:(0,c.zy)(t),onChange:this.saveStemLength,onInput:this.stemLengthUpdating,displayBounds:!0,width:150,formatNumbers:this.formatStemHeight,tooltipPosition:l.h.DOWN,variant:n,disabled:s})})),(0,i.jsx)(u.X,{enabled:!0,checked:e,label:"Show Stem",onChange:this.onChangeStemEnabled})]}))}}StemEditor.contextType=r.I},7383:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(43985),c=n(57340),d=n(39864),u=n(41920),h=n(2252),p=n(56829),m=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let f=class TextInput extends s.Component{constructor(e){super(e),this.touchDevice=(0,h.Jm)(),this.isUnmounting=!1,this.handleOutsideClick=e=>{if(!this.state.editing||!this.input.current)return;const t=this.getTextString(this.input.current.value,this.props.defaultText);this.stopEditing(t,!0)},this.stopEditing=(e,t=!0)=>{this.setState({editing:!1}),t&&this.props.text!==e?(this.setState({currentText:e}),this.props.onEdited&&this.props.onEdited(e)):this.props.onCancelEditing&&this.props.onCancelEditing()},this.stopPropagation=e=>{e.stopPropagation()},this.onBlur=()=>{this.input.current&&this.context.engine.broadcast(new p.SN(this.input.current,!1))},this.onFocus=()=>{this.input.current&&this.context.engine.broadcast(new p.SN(this.input.current,!0))},this.startEditing=e=>{clearTimeout(this.startEditingTimeout),this.startEditingTimeout=window.setTimeout((()=>{if(!this.input.current||this.isUnmounting)return;e&&e.stopPropagation();const{onStartEditing:t,autoSelect:n,defaultText:i}=this.props,{currentText:s}=this.state;this.setState({editing:!0}),t&&t(),this.input.current.focus(),(n||i&&this.input.current.select&&s===i)&&this.input.current.select()}),0)},this.onKeyPress=e=>{var t;if(e.stopPropagation(),this.props.onKeyPress&&this.props.onKeyPress(e))return;const n=e.which||e.keyCode;if(!("keydown"===e.type&&n!==l.R.TAB||n!==l.R.RETURN&&n!==l.R.TAB||e.shiftKey)){e.preventDefault(),null===(t=this.input.current)||void 0===t||t.blur(),this.setState({editing:!1});const n=this.getTextString(e.target.value,this.props.defaultText);this.props.onEdited&&this.props.onEdited(n)}},this.onInput=e=>{const t=e.target.value;this.setState({currentText:t}),this.props.onInput&&this.props.onInput(t)},this.state={editing:!1,currentText:this.props.text},this.input=(0,s.createRef)()}componentDidMount(){this.input.current&&(this.props.closeOnFocusOut&&this.input.current.addEventListener("focusout",this.handleOutsideClick),(this.props.editing||this.props.autofocus)&&this.startEditing())}componentWillUnmount(){this.isUnmounting=!0,this.input.current&&(this.props.closeOnFocusOut&&this.input.current.removeEventListener("focusout",this.handleOutsideClick),this.input.current.blur())}UNSAFE_componentWillReceiveProps(e){if(e.editing&&!this.props.editing&&this.startEditing(),e.text!==this.props.text){const t=this.getTextString(e.text,e.defaultText);this.setState({currentText:t})}}componentDidUpdate(e,t){this.input.current&&(!t.editing&&this.state.editing?this.input.current.focus():t.editing&&!this.state.editing&&this.input.current.blur())}getTextString(e,t){return""===e&&void 0!==t?t:e}setCurrentText(e){this.setState({currentText:e}),this.focusInput(),this.props.onEdited&&this.props.onEdited(e)}getCurrentText(){return this.state.currentText}focusInput(){this.input.current&&this.input.current.focus()}getFractionalCounter(){if(this.props.maxLength&&this.props.fractionalCounter)return`${this.state.currentText.length}/${this.props.maxLength}`}render(){const{editing:e,currentText:t}=this.state,{hint:n,isDisabled:r,placeholder:a,noFocusedPlaceholder:l,clickToEdit:c,maxLength:h,tabIndex:p,textarea:m,readOnlyText:f,autocapitalize:g,fractionalCounter:v,showUnderline:y,className:b}=this.props,S=!(t||!a||e&&l),E=S?a:void 0,T=!1!==c?this.startEditing:void 0,w=(0,i.jsx)("div",Object.assign({className:"current-text",onClick:T,"data-hint":n},{children:t||a||""}));return(0,i.jsxs)("div",Object.assign({className:o()("modifiable-text",b,{editing:e,"fractional-counter":v,default:!t,"has-hint":!!n,"has-placeholder":S}),"data-hint":n,"data-fractional-counter":this.getFractionalCounter()},{children:[m?(0,i.jsx)(d.Z,Object.assign({name:"text-input",singleScrollDirection:u.Nm.vertical,forceHidden:!1},{children:w})):w,(0,s.createElement)(m?"textarea":"input",{ref:this.input,className:o()("inputDiv",{editing:e}),type:"text",value:t,placeholder:E,maxLength:h,onInput:this.onInput,onClick:this.props.propagateMouseEvent?void 0:this.stopPropagation,onKeyPress:this.onKeyPress,disabled:r,readOnly:this.props.readOnlyMode,onKeyDown:this.onKeyPress,onKeyUp:this.stopPropagation,tabIndex:p,autoCapitalize:g,onBlur:this.touchDevice?this.onBlur:void 0,onFocus:this.touchDevice?this.onFocus:void 0}),f&&(0,i.jsx)("div",Object.assign({className:"read-only-text"},{children:f})),y&&(0,i.jsx)("div",{className:"editable-line"})]}))}};f.contextType=a.I,f=m([c.Z],f);const g=f},29605:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(85893),s=n(67294),r=n(57340),o=n(60405),a=n(94184),l=n.n(a),c=n(43985),d=n(56829),u=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let h=class TextInputBox extends s.Component{constructor(e){super(e),this.onInput=e=>{if(this.props.onInput){const t=e.target;this.props.onInput(t.value)}},this.onKeyPress=e=>{e.stopPropagation();const t=e.which||e.keyCode,n=[c.R.TAB,c.R.RETURN,c.R.ESCAPE];if("keydown"===e.type&&!n.includes(t))return!1;const i=e.target;switch(this.props.maxLength&&i.value.length>this.props.maxLength&&e.preventDefault(),t){case c.R.ESCAPE:this.props.onCancel&&this.props.onCancel();break;case c.R.TAB:case c.R.RETURN:this.props.onBlur||e.shiftKey||(e.preventDefault(),this.blur())}return!1},this.stopPropagation=e=>e.stopPropagation(),this.onFocus=e=>{this.context.messageBus.broadcast(new d.SN(this.input,!0)),this.props.onFocus&&this.props.onFocus(e)},this.onBlur=e=>{this.context.messageBus.broadcast(new d.SN(this.input,!1));const t=e.target.value,{onBlur:n,onDone:i}=this.props;n?n(t):i&&i(t)},this.setRef=e=>this.input=e,this.state={currentText:e.text}}componentWillUnmount(){this.input&&this.input.blur()}componentDidMount(){this.props.focusOnMount&&this.focus()}UNSAFE_componentWillReceiveProps(e){e.text!==this.props.text&&this.setState({currentText:e.text})}getText(){return this.input?this.input.value:""}focus(){this.input.focus()}blur(){this.input.blur()}scrollIntoView(e){this.input.scrollIntoView(e)}render(){const{placeholder:e,tabIndex:t,maxLength:n,type:s,className:r}=this.props,{currentText:o}=this.state;return(0,i.jsx)("div",Object.assign({className:l()("text-field",r)},{children:(0,i.jsx)("input",{ref:this.setRef,className:"text-input-box",type:s||"text",value:o,placeholder:e,maxLength:n,onInput:this.onInput,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyPress,onKeyUp:this.stopPropagation,onBlur:this.onBlur,onFocus:this.onFocus,tabIndex:t})}))}};h.contextType=o.I,h=u([r.Z],h);const p=h},75060:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i,s=n(85893),r=n(67294),o=n(57340),a=n(94184),l=n.n(a),c=n(60405),d=n(43985),u=n(56829),h=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e[e.OUTLINED=0]="OUTLINED",e[e.ADJUSTABLE=1]="ADJUSTABLE"}(i||(i={}));const p=function*(){let e=0;for(;;)yield e++}();let m=class Textarea extends r.Component{constructor(e){super(e),this.elementRef=(0,r.createRef)(),this.onInput=e=>{if(this.props.onInput){const t=e.target;this.props.onInput(t.value)}},this.onKeyPress=e=>{e.stopPropagation();const t=e.which||e.keyCode,n=[d.R.RETURN];if("keydown"===e.type&&!n.includes(t))return!1;const i=e.target;switch(this.props.maxLength&&i.value.length>this.props.maxLength&&e.preventDefault(),t){case d.R.RETURN:e.shiftKey||(e.preventDefault(),this.blur(),this.props.onDone(i.value))}return!1},this.stopPropagation=e=>e.stopPropagation(),this.onChange=e=>{this.updateHeight()},this.onFocus=e=>{this.context.messageBus.broadcast(new u.SN(this.input,!0)),this.props.onFocus&&this.props.onFocus(e),this.setState({isFocused:!0})},this.onBlur=e=>{this.context.messageBus.broadcast(new u.SN(this.input,!1)),this.props.onBlur&&this.props.onBlur(e),this.setState({isFocused:!1})},this.setRef=e=>this.input=e,this.instanceId=`textarea-${p.next().value}`,this.state={currentText:e.text,isFocused:!1}}componentDidMount(){this.props.focusOnMount&&this.input&&this.input.focus(),this.props.scrollIntoViewOnMount&&this.input&&this.input.scrollIntoView(),this.updateHeight()}componentWillUnmount(){this.input&&this.input.blur()}UNSAFE_componentWillReceiveProps(e){e.text!==this.props.text&&this.setState({currentText:e.text})}componentDidUpdate(e,t){t.currentText!==this.state.currentText&&this.updateHeight()}getText(){return this.input?this.input.value:""}focus(){this.input.focus()}blur(){this.input.blur()}updateHeight(){if(this.props.inputStyle===i.ADJUSTABLE){const e=this.elementRef.current;if(!this.input||!e)return;e.style.height="",this.input.style.overflowY="";const t=this.input.scrollHeight;e.style.height=`${t}px`,t>e.scrollHeight&&(this.input.style.overflowY="auto")}}render(){const{placeholder:e,tabIndex:t,maxLength:n,inputStyle:r=i.OUTLINED,label:o,name:a,readOnly:c,rows:d}=this.props,{currentText:u,isFocused:h}=this.state,p=a||this.instanceId,m=""===u,f=o&&(r!==i.ADJUSTABLE||h||!m),g=r===i.ADJUSTABLE?1:d;return(0,s.jsxs)("div",Object.assign({className:l()("textarea-container",`textarea-style-${i[r].toLowerCase()}`,{focused:h,readonly:c,placeholder:m}),ref:this.elementRef},{children:[f&&(0,s.jsx)("label",Object.assign({className:"label",htmlFor:p},{children:o})),(0,s.jsx)("textarea",{className:"textarea",value:u,ref:this.setRef,name:p,placeholder:e,maxLength:n,onInput:this.onInput,onChange:this.onChange,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyPress,onKeyUp:this.stopPropagation,onBlur:this.onBlur,onFocus:this.onFocus,rows:g,tabIndex:t,readOnly:c})]}))}};m.contextType=c.I,m=h([o.Z],m);const f=m},77477:(e,t,n)=>{"use strict";n.d(t,{L:()=>ShowToastrCommand,Q:()=>HideToastrCommand});var i=n(93037);class ShowToastrCommand extends i.m{constructor(e){super(),this.id="SHOW_TOASTR",this.payload=e}}class HideToastrCommand extends i.m{constructor(){super(...arguments),this.id="HIDE_TOASTR"}}},78522:(e,t,n)=>{"use strict";n.d(t,{C:()=>u});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(57340),c=n(77477),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let u=class Toastr extends s.Component{constructor(e){super(e),this.getInitialState=()=>({messagePhraseKey:"",active:!1,ctaPhraseKey:"",timeout:0,multiline:!1,dismissesOnAction:!1,actionHandler:()=>{}}),this.triggerAction=e=>{e.stopPropagation(),this.state.actionHandler&&this.state.actionHandler(),this.state.dismissesOnAction&&this.hide()},this.hide=async()=>{window.clearTimeout(this.timeout),this.setState({active:!1})},this.show=async e=>{const t=Object.assign(this.getInitialState(),e,{active:!0});this.setState(t),window.clearTimeout(this.timeout),t.timeout>0&&(this.timeout=window.setTimeout((()=>{this.setState({active:!1})}),t.timeout))},this.state=this.getInitialState()}componentDidMount(){this.context.commandBinder.addBinding(c.L,this.show),this.context.commandBinder.addBinding(c.Q,this.hide)}componentWillUnmount(){window.clearTimeout(this.timeout),this.context.commandBinder.removeBinding(c.L,this.show),this.context.commandBinder.removeBinding(c.Q,this.hide)}render(){const{locale:e}=this.context,t=this.props.className||"",{active:n,multiline:s,messagePhraseKey:r,ctaPhraseKey:a,dismissesOnAction:l}=this.state,c={active:n,multiline:s},d=r?e.t(r):null,u=a?e.t(a):null;return(0,i.jsx)("div",Object.assign({className:"toastr-wrapper",onClick:l?this.hide:void 0},{children:(0,i.jsxs)("div",Object.assign({className:o()("toastr-contents",`${t}`,c)},{children:[(0,i.jsx)("div",Object.assign({className:"toastr-text"},{children:d})),u&&(0,i.jsx)("a",Object.assign({className:"link",onClick:this.triggerAction},{children:u}))]}))}))}};u.contextType=a.I,u=d([l.A],u)},59997:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=n(60405),c=n(10854),d=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let u=class Toggle extends s.Component{constructor(e,t){super(e),this.onClick=()=>{this.props.enabled&&this.props.onToggle()},this.locale={onSettingString:t.locale.t(c.Z.ON),offSettingString:t.locale.t(c.Z.OFF)};const n=Math.max(this.props.toggleTime||300);this.trackTransitionStyle={transition:`backgroundColor ${n}ms`},this.thumbTransitionStyle={transition:`backgroundColor ${n}ms, left ${n}ms`}}render(){const{id:e,toggled:t,enabled:n,onOffLabel:s,className:r}=this.props,o=t?this.locale.onSettingString:this.locale.offSettingString;return(0,i.jsxs)("div",Object.assign({className:a()("reusable-toggle",r,{"toggle-on":t,enabled:n}),id:e,onClick:this.onClick},{children:[s&&(0,i.jsx)("span",Object.assign({className:"toggle-label"},{children:o})),(0,i.jsx)("div",{style:this.trackTransitionStyle,className:"track"}),(0,i.jsx)("div",{style:this.thumbTransitionStyle,className:"thumb"})]}))}};u.contextType=l.I,u=d([r.Z],u)},70680:(e,t,n)=>{"use strict";n.d(t,{N:()=>d});var i,s=n(85893),r=n(67294),o=n(94184),a=n.n(o),l=n(57340),c=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e.OPEN="open",e.UNLOADING="unloading",e.CLOSED="closed"}(i||(i={}));let d=class TransitionedUnload extends r.Component{constructor(e){super(e),this.ref=(0,r.createRef)(),this.onTransitionCancel=e=>{e.target===e.currentTarget&&this.state.phase===i.UNLOADING&&this.setState({phase:i.CLOSED,activeChild:null})},this.onTransitionEnd=e=>{e.target===e.currentTarget&&this.state.phase===i.UNLOADING&&this.setState({phase:i.CLOSED,activeChild:null})},this.onClick=e=>{this.props.onClick&&this.props.onClick(e)},this.onPointerDown=e=>{this.props.onPointerDown&&this.props.onPointerDown(e)},this.onPointerUp=e=>{this.props.onPointerUp&&this.props.onPointerUp(e)},this.state={phase:e.open?i.OPEN:i.CLOSED,activeChild:e.selectChild&&e.childKey||null}}componentDidMount(){this.ref.current&&this.ref.current.addEventListener("transitioncancel",this.onTransitionCancel)}componentWillUnmount(){this.ref.current&&this.ref.current.removeEventListener("transitioncancel",this.onTransitionCancel)}UNSAFE_componentWillReceiveProps(e){const{open:t,childKey:n}=this.props;t&&!e.open?this.setState({phase:i.UNLOADING}):!t&&e.open?this.setState({phase:i.OPEN,activeChild:e.selectChild&&e.childKey||null}):n!==e.childKey&&this.setState({activeChild:e.selectChild&&e.childKey||null})}renderChildren(){const{children:e,selectChild:t}=this.props,{phase:n,activeChild:s}=this.state;return n===i.CLOSED||t&&!s?null:t?e&&Array.isArray(e)&&e.length&&e.find((e=>e&&e.key===s))||null:e}render(){const{className:e,firstChild:t}=this.props,{phase:n}=this.state,r=a()({unloading:n===i.UNLOADING},e);return(0,s.jsxs)("div",Object.assign({ref:this.ref,className:r,onTransitionEnd:this.onTransitionEnd,onClick:this.onClick,onPointerDown:this.onPointerDown,onPointerUp:this.onPointerUp},{children:[t||null,this.renderChildren()]}))}};d=c([l.Z],d)},61445:(e,t,n)=>{"use strict";n.d(t,{BN:()=>s,qE:()=>r,ZJ:()=>o,zx:()=>m});var i,s,r,o,a=n(85893),l=n(67294),c=n(94184),d=n.n(c),u=n(57340),h=n(2252),p=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e.ENABLED="enabled",e.DISABLED="disabled",e.DECORATIVE="decorative",e.DIMMED="dimmed",e.ACTIVE="active",e.BUSY="busy"}(s||(s={})),function(e){e[e.STANDARD=0]="STANDARD",e[e.MINI=1]="MINI",e[e.SMALL=2]="SMALL",e[e.LARGE=3]="LARGE"}(r||(r={})),function(e){e[e.PRIMARY=0]="PRIMARY",e[e.SECONDARY=1]="SECONDARY",e[e.TERTIARY=2]="TERTIARY",e[e.OUTLINE=3]="OUTLINE",e[e.OVERLAY=4]="OVERLAY",e[e.LIGHT=5]="LIGHT",e[e.SECONDARY_LIGHT=6]="SECONDARY_LIGHT",e[e.CLEAR=7]="CLEAR",e[e.TOOLBAR=8]="TOOLBAR",e[e.PLAIN=9]="PLAIN"}(o||(o={}));let m=i=class Button extends l.Component{constructor(e){super(e),this.handlingClick=!1,this.mouseupTimeout=0,this.onMouseDown=e=>{if(this.handlingClick=!1,this.props.onMouseDown)this.props.onMouseDown(e);else if(i.iMobile&&this.props.onClick){const t=document.activeElement;t&&e.cancelable&&(this.handlingClick=!0,e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),t.blur(),window.addEventListener("mouseup",(t=>{this.handlingClick&&(this.handleClick(e),window.clearTimeout(this.mouseupTimeout))}),{once:!0}),this.mouseupTimeout=window.setTimeout((()=>{this.handlingClick=!1}),300))}},this.onClick=e=>{this.handlingClick||this.handleClick(e)}}handleClick(e){const{buttonState:t,onClickArgs:n=[]}=this.props,i=t===s.DISABLED,r=t===s.BUSY,o=t===s.DECORATIVE;!this.props.onClick||i||r||o?e.stopPropagation():this.props.onClick(e,...n)}render(){const{ariaLabel:e,buttonSize:t,buttonState:n,buttonStyle:i,children:l,className:c,dataValue:u,id:h,multiline:p,onMouseEnter:m,onMouseLeave:f,tooltipMsg:g,tooltipPosition:v,tooltipPreformatted:y}=this.props,b=n===s.DISABLED,S=n===s.BUSY,E=n===s.DECORATIVE,T=i===o.SECONDARY||i===o.SECONDARY_LIGHT,w=i===o.TERTIARY,x=i===o.LIGHT||i===o.SECONDARY_LIGHT,_={"button-small":t===r.SMALL,"button-large":t===r.LARGE,"button-mini":t===r.MINI,"button-secondary":T,"button-tertiary":w,"button-outline":i===o.OUTLINE,"button-light":x,"button-primary":i===o.PRIMARY,"button-overlay":i===o.OVERLAY,"button-clear":i===o.CLEAR,"button-plain":i===o.PLAIN,"button-toolbar":i===o.TOOLBAR,"button-active":n===s.ACTIVE,"button-dimmed":n===s.DIMMED,"button-busy":S,"button-disabled":b,"button-decorative":E,"button-multiline":p,"button-with-tooltip":!!g};return(0,a.jsx)("div",Object.assign({id:h,role:"button","aria-label":e||g,"aria-disabled":b,className:d()("button",_,c),"data-value":u,onClick:this.onClick,onMouseEnter:m,onMouseLeave:f,onMouseDown:this.onMouseDown,"data-balloon":g||null,"data-balloon-pre":!!y,"data-balloon-pos":v||null},{children:l}))}};m.iMobile=(0,h.Tt)()||(0,h._1)(),m=i=p([u.Z],m)},70329:(e,t,n)=>{"use strict";n.d(t,{A:()=>h,P:()=>CloseButton});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(87982),l=n(78576),c=n(10854),d=n(60405);const{CLOSE_BUTTON_TOOLTIP_MESSAGE:u}=c.Z.REUSABLES;var h;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.LIGHT=1]="LIGHT",e[e.SHADOW=2]="SHADOW",e[e.OVERLAY=3]="OVERLAY",e[e.TOOLBAR=4]="TOOLBAR"}(h||(h={}));class CloseButton extends s.Component{constructor(){super(...arguments),this.handleMouseDown=e=>{const{closeOnMouseDown:t,onClose:n}=this.props;t&&n&&n(e)}}getIconButtonStyle(){switch(this.props.buttonStyle){case h.LIGHT:case h.SHADOW:return a.Dd.CLEAR;case h.OVERLAY:return a.Dd.OVERLAY;case h.TOOLBAR:return a.Dd.TOOLBAR;default:return a.Dd.PLAIN}}render(){const{locale:e}=this.context,{buttonStyle:t,buttonState:n,onClose:s,hideTooltip:r}=this.props,c=r?void 0:e.t(u),d=r?e.t(u):void 0,p=o()("close-button",{"close-button-shadow":t===h.SHADOW,"close-button-light":t===h.LIGHT});return(0,i.jsx)(a.hU,{className:p,ariaLabel:d,iconClass:"icon-close",buttonStyle:this.getIconButtonStyle(),buttonState:n,tooltipMsg:c,tooltipPosition:l.lZ.DOWN,onClick:s,onMouseDown:this.handleMouseDown})}}CloseButton.contextType=d.I},90786:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i=n(85893),s=n(10854),r=n(41345);const{REUSABLES:o}=s.Z;function a({phraseKey:e,url:t}){const n=(0,r.b)(),s=e?n.t(e):n.t(o.FEEDBACK_LINK_LABEL);return(0,i.jsx)("div",Object.assign({className:"feedback-link"},{children:(0,i.jsxs)("a",Object.assign({className:"link",href:t,target:"_blank",rel:"noopener"},{children:[s,(0,i.jsx)("span",{className:"icon icon-comment-outline"})]}))}))}},82068:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(85893),s=n(67294),r=n(57340),o=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let a=class FileDropZone extends s.Component{constructor(e){super(e),this.active=!1,this.dropZone=null,this.onDragOver=e=>{e.dataTransfer&&e.dataTransfer.types&&e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.stopPropagation(),this.activate())},this.onDrop=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer&&e.dataTransfer.files&&this.props.onDropped(e.dataTransfer.files),this.deactivate()},this.onDragEnd=e=>{e.preventDefault(),e.stopPropagation(),this.deactivate()},this.onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.deactivate()},this.setDropZoneRef=e=>{this.dropZone=e}}activate(){!this.active&&this.dropZone&&(this.props.onActivate&&this.props.onActivate(!0),this.active=!0,this.dropZone.classList.add("active"))}deactivate(){this.active&&this.dropZone&&(this.active=!1,this.dropZone.classList.remove("active"),this.props.onDone&&this.props.onDone())}render(){const{className:e,children:t,disabled:n}=this.props;return(0,i.jsxs)("div",Object.assign({className:e,onDragEnter:n?void 0:this.onDragOver,onDragLeave:n?void 0:this.onDragLeave,onDragOver:n?void 0:this.onDragOver,onDragEnd:n?void 0:this.onDragEnd,onDrop:n?void 0:this.onDrop},{children:[(0,i.jsxs)("div",Object.assign({className:"file-drop-zone",ref:this.setDropZoneRef},{children:[(0,i.jsx)("span",{className:"icon icon-attach"}),(0,i.jsx)("label",{children:"Upload file"})]})),t]}))}};a=o([r.Z],a)},84282:(e,t,n)=>{"use strict";n.d(t,{p:()=>c});var i=n(85893),s=n(67294),r=n(57340),o=n(94184),a=n.n(o),l=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let c=class FileUpload extends s.Component{constructor(e){super(e),this.handleUpload=e=>{const t=e.target;if(!t)return;const n=t.files;n&&this.props.onUpload(n),t.value=""}}render(){const{accept:e,id:t,multi:n,enabled:s,children:r,className:o,tooltip:l}=this.props,c=`file-upload-${t}`;return(0,i.jsxs)("div",Object.assign({className:a()("file-upload-button",o,{disabled:!s})},{children:[(0,i.jsx)("label",Object.assign({className:"file-upload-trigger",htmlFor:c,"data-balloon":l,"data-balloon-pos":"down"},{children:r})),s&&(0,i.jsx)("input",{type:"file",className:"file-input",id:c,accept:e,multiple:!!n,onChange:this.handleUpload})]}))}};c=l([r.Z],c)},16881:(e,t,n)=>{"use strict";n.d(t,{I:()=>E});var i=n(85893),s=n(67294),r=n(10854),o=n(60405),a=n(47931),l=n(36616),c=n(94184),d=n.n(c),u=n(86823),h=n(54119);const{MATTERTAGS:p}=r.Z.WORKSHOP;function m(e){const{url:t,text:n,error:r,newLink:a}=e,{locale:l}=(0,s.useContext)(o.I),c=""===n&&""===t&&a?l.t(p.LINK_EDITOR_TIP_TEXT):null,u=r?l.t(p.LINK_EDITOR_INVALID_TIP):null,h=d()("modal-message",{"modal-message-error":!!r}),m=u||c||"";return(0,i.jsx)("div",Object.assign({className:h},{children:m}))}const{MATTERTAGS:f,MODAL:g}=r.Z.WORKSHOP;function v(e){return(0,u.j)(e)}function y(e){const{linkUrl:t,linkText:n,onSaveLink:r,onRemoveLink:a,onCancelLink:l}=e,{locale:c}=(0,s.useContext)(o.I),[u,p]=(0,s.useState)(!1),[y,b]=(0,s.useState)(n),[S,E]=(0,s.useState)(t),[T,w]=(0,s.useState)(v(t));(0,s.useEffect)((()=>(E(t),b(n),w(v(t)),p(!1),()=>{})),[n,t]);const x=(0,s.useCallback)((()=>{T&&window.open(S,"_blank","noreferrer")}),[S,T]),_=(0,s.useCallback)(((e,t)=>{const n=void 0!==t?t:S;r((void 0!==e?e:y)||n,n)}),[S,y,r]),M=(0,s.useCallback)((()=>{_(y,S)}),[y,S]),O=(0,s.useCallback)(((e,t)=>{const n=v(e);w(n),p(!n&&""!==e),t&&n&&_(y,e)}),[y,_]),A=(0,s.useCallback)((e=>{b(e)}),[]),C=(0,s.useCallback)((e=>{E(e);const t=v(e);w(t),u&&t&&p(!1)}),[O,u]),N=(0,s.useCallback)((()=>{O(S,!1)}),[S,O]),D=(0,s.useCallback)((()=>{O(S,!0)}),[S,O]),I=!t,L=c.t(f.LINK_EDITOR_TEXT_PLACEHOLDER),P=c.t(g.SAVE),R=c.t(g.CANCEL),k=c.t(f.LINK_EDITOR_PREVIEW_TIP),U=c.t(f.LINK_EDITOR_REMOVE_TIP),B=!I&&a;return(0,i.jsxs)("div",Object.assign({className:"modal-contents"},{children:[(0,i.jsxs)("div",Object.assign({className:"modal-body"},{children:[(0,i.jsx)("div",Object.assign({className:"link-editor-field link-text-field"},{children:(0,i.jsx)(h.oi,{text:y,placeholder:L,focused:!n,onInput:A,onCancel:l})})),(0,i.jsxs)("div",Object.assign({className:"link-editor-field link-url-field"},{children:[(0,i.jsx)(h.oi,{text:S,type:"url",placeholder:"https://",focused:!!n,onBlur:N,onReturn:D,onInput:C,onCancel:l}),T&&S&&(0,i.jsx)(h.zx,{className:"preview-link",icon:"ext-link",variant:h.Wu.TERTIARY,size:h.qE.SMALL,tooltip:k,onClick:x})]})),(0,i.jsx)(m,{newLink:I,text:n,url:S,error:u})]})),(0,i.jsx)("div",Object.assign({className:"modal-footer"},{children:(0,i.jsxs)(h.hE,Object.assign({className:d()("modal-footer",{stretch:B})},{children:[B&&(0,i.jsx)(h.zx,{icon:"delete",label:U,className:"remove-link",variant:h.Wu.TERTIARY,size:h.qE.SMALL,onClick:a}),(0,i.jsxs)(h.hE,Object.assign({spacing:"small"},{children:[(0,i.jsx)(h.zx,{label:R,variant:h.Wu.SECONDARY,size:h.qE.SMALL,onClick:l}),(0,i.jsx)(h.zx,{label:P,variant:h.Wu.PRIMARY,disabled:!T,size:h.qE.SMALL,onClick:M})]}))]}))}))]}))}var b=n(24487);const{MATTERTAGS:S}=r.Z.WORKSHOP;function E(e){const{linkUrl:t,linkText:n,onSaveLink:r,onRemoveLink:c,onCancelLink:d}=e,{locale:u}=(0,s.useContext)(o.I),h=(0,a.R)(),p=""===t?u.t(S.LINK_EDITOR_LINK_ADD_LABEL):u.t(S.LINK_EDITOR_LINK_EDIT_LABEL),m=h===l.P.LINK_EDITOR;return(0,i.jsx)(b.H,Object.assign({open:m,title:p,fullModal:!1,className:"link-editor-modal"},{children:(0,i.jsx)(y,{linkText:n,linkUrl:t,onCancelLink:d,onSaveLink:r,onRemoveLink:c})}))}},80860:(e,t,n)=>{"use strict";var i;n.d(t,{F:()=>i,W:()=>s}),function(e){e.HandsRaised="hands-raised",e.RotatePhone="rotate-phone"}(i||(i={}));const s=new Map;s.set(i.HandsRaised,{alt:"Hands Raised",json:n(22016),fallback:n(63064)}),s.set(i.RotatePhone,{alt:"Rotate your device to portrait orientation",json:n(10105),fallback:n(34458)})},37145:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>c});var i=n(85893),s=n(67294),r=n(57340),o=n(80860),a=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let l=class Lottie extends s.Component{constructor(e){super(e),this.lottieTargetRef=(0,s.createRef)(),this.isUnmounting=!1,this.loadLottie=async()=>this.lottieLib?this.lottieLib:await n.e(932).then(n.t.bind(n,11248,23)),this.updateAnimation=async()=>{const{animation:e,loop:t=!1}=this.props;let n;this.setState({fallbackActive:!1});try{n=await this.loadLottie()}catch(e){if(this.isUnmounting)return;return void this.setState({fallbackActive:!0})}const i=o.W.get(e);if(n&&i&&this.lottieTargetRef.current){const e=n.loadAnimation({loop:t,container:this.lottieTargetRef.current,renderer:"svg",autoplay:!1,animationData:i.json});e.addEventListener("data_failed",(()=>{this.isUnmounting||this.setState({fallbackActive:!0})})),setTimeout((()=>{this.isUnmounting||e.play()}),50)}},this.renderFallback=()=>{const{animation:e}=this.props,t=o.W.get(e);return t?(0,i.jsx)("img",{className:"lottie-fallback",src:t.fallback,alt:t.alt}):null},this.state={fallbackActive:!1}}componentDidMount(){this.updateAnimation()}componentDidUpdate(e){e.animation===this.props.animation&&e.loop===this.props.loop||this.updateAnimation()}componentWillUnmount(){this.isUnmounting=!0}render(){return(0,i.jsxs)("div",Object.assign({className:"lottie"},{children:[(0,i.jsx)("div",{className:"lottie-animation",ref:this.lottieTargetRef}),this.state.fallbackActive&&this.renderFallback()]}))}};l=a([r.Z],l);const c=l},24487:(e,t,n)=>{"use strict";n.d(t,{H:()=>m});var i=n(85893),s=n(67294),r=n(73935),o=n(94184),a=n.n(o),l=n(10854),c=n(60405),d=n(54119),u=n(71843),h=n(70680);const{REUSABLES:p}=l.Z;function m(e){const{children:t,className:n,title:o,open:l,onClose:m,fullModal:f}=e,{locale:g,commandBinder:v}=(0,s.useContext)(c.I);let y=!1;const b=(0,s.useCallback)((()=>{v.issueCommand(new u.rE),m&&m()}),[v,m]),S=(0,s.useCallback)((e=>{e.stopPropagation()}),[]),E=(0,s.useCallback)((()=>{y=!0,window.setTimeout((()=>{y=!1}),500)}),[]),T=(0,s.useCallback)((()=>{y&&(y=!1,b())}),[b]),w=g.t(p.CLOSE_BUTTON_TOOLTIP_MESSAGE),x=document.querySelector("#react-render-root")||document.body,_=a()("modal",n,{open:l,"full-modal":f});return(0,r.createPortal)((0,i.jsx)(h.N,Object.assign({open:l,className:a()("modal-background",{open:l}),onPointerUp:T,onPointerDown:E},{children:(0,i.jsxs)("dialog",Object.assign({className:_,onClick:S,onPointerUp:S,onPointerDown:S},{children:[(0,i.jsxs)("header",Object.assign({className:"modal-header"},{children:[(0,i.jsx)("div",Object.assign({className:"modal-title"},{children:o})),(0,i.jsx)(d.zx,{icon:"close",ariaLabel:w,variant:d.Wu.TERTIARY,onClick:b})]})),t]}))})),x)}},39864:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Scrollbars});var i=n(85893),s=n(67294),r=n(41920),o=n(24180),a=n(55580),l=n(98878),c=n(58844),d=n(65270),u=n(94184),h=n.n(u),p=n(44450);class Scrollbars extends s.Component{constructor(e){super(e),this.horizontal=(0,r.Sv)(),this.vertical=(0,r.Sv)(),this.prevSuppressDrag=!1,this.manuallyMoved=!1,this.isUnmounting=!1,this.scrollPosition={horizontal:r.Ij.Beginning,vertical:r.Ij.End},this.handleEvent=e=>{this.inputFilter.handleEvent(e)},this.getScrollableContainer=()=>this.innerWrapper,this.getScrolledOffset=e=>{const t=r.uG[e].scrollOffset;return this.innerWrapper[t]/this.state[e].childLength},this.debouncedSetState=e=>{new URL(`${document.location}`).searchParams.get("temp-disable-debounce-scroll")?this.setState(e):(cancelAnimationFrame(this.rAFHandle),this.rAFHandle=requestAnimationFrame((()=>{this.isUnmounting||this.setState(e)})))},this.state={horizontal:(0,r.cL)(),vertical:(0,r.cL)()},this.resizeSubscription=(0,p.kp)(p.g_.RESIZE,(()=>this.handleExternalChange(p.g_.RESIZE))),this.scrollTo=this.scrollTo.bind(this),this.handlePressStart=this.handlePressStart.bind(this),this.handlePressMove=this.handlePressMove.bind(this),this.handleDragEnd=this.handleDragEnd.bind(this),this.handleDragStart=this.handleDragStart.bind(this),this.handleWheelEvent=this.handleWheelEvent.bind(this),this.handleClick=this.handleClick.bind(this),this.toggleVisibility=this.toggleVisibility.bind(this),this.hasManuallyMoved=this.hasManuallyMoved.bind(this),this.prevSuppressDrag=!!e.suppressDrag,this.inputFilter=new c.Z({handlePressStart:this.handlePressStart,handlePressMove:this.handlePressMove,handleDragStart:this.handleDragStart,handleDragEnd:this.handleDragEnd,handleClick:this.handleClick});const t=this.handleEvent;window.PointerEvent||(window.addEventListener("mousemove",t),window.addEventListener("mouseleave",t),window.addEventListener("mouseup",t)),window.addEventListener("pointermove",t),window.addEventListener("pointerup",t),window.addEventListener("touchmove",t),window.addEventListener("touchend",t),window.addEventListener("touchcancel",t)}componentDidMount(){if(this.resizeSubscription.renew(),this.innerWrapper.addEventListener("wheel",this.handleWheelEvent,!0),this.props.thumbScrollingOnly)this.innerWrapper.addEventListener("click",this.handleClick);else{const e=this.handleEvent;this.innerWrapper.addEventListener("mousedown",e),this.innerWrapper.addEventListener("pointerdown",e),this.innerWrapper.addEventListener("touchstart",e)}this.firstChild=this.innerWrapper.firstElementChild,this.props.onScrollPositionChange&&this.props.onScrollPositionChange(),this.props.hasOwnProperty("suppressDrag")&&this.inputFilter.setEnabled(!!this.props.suppressDrag)}componentWillUnmount(){this.isUnmounting=!0;const e=this.handleEvent;this.resizeSubscription.cancel(),window.PointerEvent||(window.removeEventListener("mousemove",e),window.removeEventListener("mouseleave",e),window.removeEventListener("mouseup",e)),window.removeEventListener("pointermove",e),window.removeEventListener("touchmove",e),window.removeEventListener("pointerup",e),window.removeEventListener("touchend",e),window.removeEventListener("touchcancel",e),this.innerWrapper.removeEventListener("wheel",this.handleWheelEvent,!0),this.props.thumbScrollingOnly?this.innerWrapper.removeEventListener("click",this.handleClick):(this.innerWrapper.removeEventListener("mousedown",e),this.innerWrapper.removeEventListener("pointerdown",e),this.innerWrapper.removeEventListener("touchstart",e))}componentDidUpdate(){if(this.props.waitToUpdate||this.handleExternalChange(),this.prevSuppressDrag!==this.props.suppressDrag&&(this.inputFilter.setEnabled(!!this.props.suppressDrag),this.props.suppressDrag&&(this.manuallyMoved=!1),this.prevSuppressDrag=!!this.props.suppressDrag),!this.horizontal.animation&&!this.vertical.animation)return;const e={};for(const t in this.state){const n=t;this[n].animation&&(this[n].animation.isAnimating?e[(0,r.O1)(n)]=this[n].animation.getUpdatedValue():this[n].animation=null)}Object.keys(e).length>0&&window.requestAnimationFrame((()=>{this.innerWrapper&&this.scrollTo(e)}))}scrollTo(e){if(!e.hasOwnProperty(r.RD.x)&&!e.hasOwnProperty(r.RD.y))return;const t={};for(const n of this.getVisibleAxes(e)){const i=(0,r.UC)(n),s=r.uG[i].scrollOffset,o=e[n];if(void 0!==o){if(isNaN(o))return;this.innerWrapper[s]=Math.max(Math.min(1,o)*this.state[i].childLength,0),t[i]=Object.assign(Object.assign({},this.state[i]),{scrollOffset:this.innerWrapper[s]})}}this.setState(t)}animatedScrollTo(e,t){if(e.hasOwnProperty(r.RD.x)||e.hasOwnProperty(r.RD.y))for(const n of this.getVisibleAxes(e)){const i=(0,r.UC)(n),s=r.uG[i].scrollOffset;this[i].animation=new l.Z({duration:t||r.UI,startValue:this.innerWrapper[s]/this.state[i].childLength,endValue:Math.max(0,Math.min(1,e[n]))})}}setScrollCenter(e){if(!(e&&e.compareDocumentPosition(this.innerWrapper)&Node.DOCUMENT_POSITION_CONTAINS))return;this.scrollCenter=e;const t={},n={};for(const i of this.getVisibleAxes(this.state)){const s=(0,r.O1)(i);t[s]=e[r.uG[i].positionOffset]+e[r.uG[i].offsetLength]/2;let o=e;for(;o.parentElement&&o!==this.innerWrapper;)o=o.parentElement,t[s]+=o[r.uG[i].positionOffset];const a=this.outerWrapper.parentElement[r.uG[i].offsetLength];n[s]=(t[s]-a/2)/this.state[i].childLength}Object.keys(n).length>0&&this.animatedScrollTo(n)}getVisibleAxes(e){const t=[];for(const n in e)(e[n]||"number"==typeof e[n])&&(n in r.RD&&this.state[(0,r.UC)(n)].isVisible||n in r.Nm&&this.state[n].isVisible)&&t.push(n);return t}handleDragStart(){delete this.scrollCenter,this.hasManuallyMoved()}handlePressStart(){this.horizontal.dragStartScroll=this.innerWrapper.scrollLeft,this.vertical.dragStartScroll=this.innerWrapper.scrollTop}handlePressMove(e){const t={};for(const n of this.getVisibleAxes(e)){const i=(0,r.UC)(n);t[n]=(e[n]+this[i].dragStartScroll)/this.state[i].childLength}this.scrollTo(t)}handleWheelEvent(e){this.props.singleScrollDirection===r.Nm.horizontal&&0===e.deltaX&&0!==e.deltaY?(this.handlePressStart(),this.handlePressMove({x:e.deltaY,y:0})):(this.hasManuallyMoved(),this.handleExternalChange())}handleClick(e){this.props.handleClick&&this.props.handleClick(e)}toggleVisibility(e){return t=>{const n=Object.assign(Object.assign({},this.state[e]),{isVisible:t});if((0,a.g)(this.state[e],n)){const t={};t[e]=n,this.setState(t),this.props.onScrollbarVisibilityChange&&this.props.onScrollbarVisibilityChange()}}}toggleScrollPosition(e){return t=>{this.scrollPosition[e]=t,this.props.onScrollPositionChange&&this.props.onScrollPositionChange(t)}}handleDragEnd(e,t){for(const n of this.getVisibleAxes(e)){const i=(0,r.UC)(n),s=e[n]/t,o=Math.min(r.UI,Math.abs(r.UI*s)),a=this.innerWrapper[r.uG[i].scrollOffset],c=s*o/2;this[i].animation=new l.Z({duration:o,startValue:a/this.state[i].childLength,endValue:Math.max(0,Math.min((a+c)/this.state[i].childLength,1)),easingFunction:d.hl})}this.setState({})}handleExternalChange(e){if(this.isUnmounting)return;this.scrollCenter&&e&&e===p.g_.RESIZE&&this.setScrollCenter(this.scrollCenter);const t={};for(const e in this.state){const n=e,i=r.uG[n].clientLength,s=Object.assign(Object.assign({},this.state[n]),{wrapperLength:Number(this.innerWrapper&&this.innerWrapper[i])||1,childLength:Number(this.firstChild&&this.firstChild[i])||1,scrollOffset:this.innerWrapper&&this.innerWrapper[r.uG[n].scrollOffset]});(0,a.g)(this.state[n],s)&&(t[n]=s)}Object.keys(t).length>0&&this.debouncedSetState(t)}hasManuallyMoved(){this.manuallyMoved=!0,this.props.onScrolled&&this.props.onScrolled()}resetManuallyMoved(){this.manuallyMoved=!1}renderScrollbar(e,t){const{forceHidden:n}=this.props,{wrapperLength:s,childLength:r,scrollOffset:a}=t;return(0,i.jsx)(o.L,{direction:e,ref:e=>{this.horizontal.scrollbar=e},wrapperLength:s,childLength:r,scrollOffset:a,scrollTo:this.scrollTo,onVisibilityChange:this.toggleVisibility(e),onScrollPositionChange:this.toggleScrollPosition(e),forceHidden:n,onThumbDrag:this.hasManuallyMoved})}render(){const{scrollbarHeight:e,singleScrollDirection:t,name:n,children:s}=this.props,o={maxHeight:e||""},a=t||`${r.Nm.vertical} ${r.Nm.horizontal}`;return(0,i.jsxs)("div",Object.assign({className:h()("outerScrollbarWrapper",a,`scrollbar-${n}`),ref:e=>{this.outerWrapper=e},style:o},{children:[(0,i.jsx)("div",Object.assign({className:"innerScrollbarWrapper",ref:e=>{this.innerWrapper=e}},{children:(0,i.jsx)("div",Object.assign({className:"paddingScrollbarWrapper"},{children:s}))})),t!==r.Nm.vertical&&this.renderScrollbar(r.Nm.horizontal,this.state.horizontal),t!==r.Nm.horizontal&&this.renderScrollbar(r.Nm.vertical,this.state.vertical)]}))}}},41920:(e,t,n)=>{"use strict";n.d(t,{UI:()=>i,cL:()=>s,Sv:()=>r,Nm:()=>o,RD:()=>a,O1:()=>l,UC:()=>c,uG:()=>d,Ij:()=>u,w5:()=>h});const i=250,s=()=>({wrapperLength:1,childLength:1,scrollOffset:1,isVisible:!1}),r=()=>({scrollbar:null,animation:null,dragStartScroll:0});var o,a;!function(e){e.horizontal="horizontal",e.vertical="vertical"}(o||(o={})),function(e){e.x="x",e.y="y"}(a||(a={}));const l=e=>{switch(e){case o.horizontal:return a.x;case o.vertical:return a.y}throw Error()},c=e=>{switch(e){case a.x:return o.horizontal;case a.y:return o.vertical}throw Error()},d={[o.horizontal]:{scrollOffset:"scrollLeft",offsetLength:"offsetWidth",clientLength:"clientWidth",positionOffset:"offsetLeft",lengthName:"width",offsetName:"left",eventPosition:"clientX",delta:a.x},[o.vertical]:{scrollOffset:"scrollTop",offsetLength:"offsetHeight",clientLength:"clientHeight",positionOffset:"offsetTop",lengthName:"height",offsetName:"top",eventPosition:"clientY",delta:a.y}};var u;!function(e){e.Beginning="Beginning",e.Middle="Middle",e.End="End",e.None="None"}(u||(u={}));const h=(e,t)=>t?e<.01?u.Beginning:1-e<.01?u.End:u.Middle:u.None},24180:(e,t,n)=>{"use strict";n.d(t,{L:()=>Scrollbar});var i=n(85893),s=n(67294),r=n(55580),o=n(58844),a=n(41920);class Scrollbar extends s.Component{constructor(e){super(e),this.state={visible:!1,trackLength:1,thumbLength:1,thumbOffset:0},this.direction=a.uG[e.direction],this.handlePressStart=this.handlePressStart.bind(this),this.handlePressMove=this.handlePressMove.bind(this),this.handleTrackClick=this.handleTrackClick.bind(this),this.inputFilter=new o.Z({handlePressStart:this.handlePressStart,handlePressMove:this.handlePressMove}),window.PointerEvent||(window.addEventListener("mousemove",this.inputFilter.handleEvent),window.addEventListener("mouseleave",this.inputFilter.handleEvent),window.addEventListener("mouseup",this.inputFilter.handleEvent)),window.addEventListener("pointermove",this.inputFilter.handleEvent),window.addEventListener("pointerup",this.inputFilter.handleEvent)}componentWillUnmount(){window.PointerEvent||(window.removeEventListener("mousemove",this.inputFilter.handleEvent),window.removeEventListener("mouseleave",this.inputFilter.handleEvent),window.removeEventListener("mouseup",this.inputFilter.handleEvent)),window.removeEventListener("pointermove",this.inputFilter.handleEvent),window.removeEventListener("pointerup",this.inputFilter.handleEvent)}getTrackLength(){return Number(this.thumbTrack&&this.thumbTrack[this.direction.clientLength]||window.innerWidth)}handleTrackClick(e){if(e.target!==this.thumbTrack)return;const t=this.direction.eventPosition,n=this.thumbTrack.getBoundingClientRect()[this.direction.offsetName],i=e[t]<n+this.state.thumbOffset,s=this.getTrackLength();let r=0;r=i?Math.max(0,(this.state.thumbOffset-this.state.thumbLength)/s):Math.min(s,(this.state.thumbOffset+this.state.thumbLength)/s),this.props.scrollTo({[(0,a.O1)(this.props.direction)]:r})}handlePressStart(e){this.dragStartThumbOffset=this.state.thumbOffset}handlePressMove(e){const t=this.getTrackLength(),n=(this.dragStartThumbOffset-e[this.direction.delta])/t;this.props.scrollTo({[(0,a.O1)(this.props.direction)]:n}),this.props.onThumbDrag&&this.props.onThumbDrag()}componentDidUpdate(){const{wrapperLength:e,childLength:t,scrollOffset:n}=this.props;if(e>0&&t>0){const i=this.getTrackLength(),s=e/t*i,o={thumbLength:s,visible:t>e,thumbOffset:Math.min(n/t*i,i-s)};if((0,r.g)(this.state,o)){const e=this.state.visible!==o.visible;e&&this.props.onVisibilityChange&&this.props.onVisibilityChange(o.visible);const t=(0,a.w5)(o.thumbOffset/(i-s),o.visible);(t!==this.scrollPosition||e)&&(this.scrollPosition=t,this.props.onScrollPositionChange&&this.props.onScrollPositionChange(t)),this.setState(o)}}}render(){const e={[`${this.direction.lengthName}`]:this.state.thumbLength+"px",[`${this.direction.offsetName}`]:this.state.thumbOffset+"px"},t=this.inputFilter.handleEvent,n=window.PointerEvent,s=n?t:void 0,r=n?void 0:t,o=n?void 0:t;return(0,i.jsx)("div",{children:this.state.visible&&!this.props.forceHidden&&(0,i.jsx)("div",Object.assign({className:"scrollbarTrack "+this.props.direction,onClick:this.handleTrackClick,ref:e=>{this.thumbTrack=e}},{children:(0,i.jsx)("div",{className:"scrollbarThumb",style:e,onPointerDown:s,onMouseDown:o,onTouchStart:r})}))})}}},33009:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});var i=n(3922);function s(e){return e.get("m")||e.get("model")}function r(e){const t=-1!==e.indexOf("matterport.com/show"),n=-1!==e.indexOf(window.location.host+"/show");if(t||n){const t=new URL(e),n=i.K.deserialize(e)||void 0,r=s(t.searchParams),o=s(new URLSearchParams(window.location.search));return{url:e,pose:n,modelId:r&&r!==o?r:void 0}}return{url:e}}},28654:(e,t,n)=>{"use strict";n.d(t,{S:()=>m});var i=n(85893),s=n(94184),r=n.n(s),o=n(36589),a=n(64921),l=n(67294);function c(e){const{text:t,keyPrefix:n,markers:s}=e,[r,o]=s,a=[];let c=t,d=c.search(`${r}|${o}`),u=c.search(r);for(;d>-1;){const e=d===u,s=c.slice(0,d),h=t.length-c.length,p=`${n},${h}-${h+d}`;e?a.push((0,i.jsx)(l.Fragment,{children:s},p)):a.push((0,i.jsx)("span",Object.assign({"data-blocktype":"marker"},{children:s}),p)),c=c.slice(d+(e?r.length:o.length),c.length),d=c.search(`${r}|${o}`),u=c.search(r)}if(c.length){const e=`${n},${t.length-c.length}-${t.length}`;a.push((0,i.jsx)(l.Fragment,{children:c},e))}return 0===a.length?(0,i.jsx)(i.Fragment,{children:t}):(0,i.jsx)(i.Fragment,{children:a})}function d(e){const{block:t,children:n,onClick:s}=e;return s?(0,i.jsx)("a",Object.assign({className:`link-annotation ${a.o.USER}`,onClick:s,"data-id":t.id||void 0,"data-value":t.value||void 0,"data-blocktype":t.blockType},{children:n})):(0,i.jsx)("span",Object.assign({"data-blocktype":t.blockType},{children:n}))}function u(e){const{block:t,children:n,onClick:s}=e;return s?(0,i.jsx)("a",Object.assign({className:`link-annotation ${a.o.USER}`,onClick:s,"data-blocktype":t.blockType},{children:n})):(0,i.jsx)("span",Object.assign({"data-blocktype":t.blockType},{children:n}))}function h(e){const{block:t,children:n,linksActive:s,onClick:r}=e;return r||s?(0,i.jsx)("a",Object.assign({href:`${t.value}`,target:"_blank",className:`link-annotation ${a.o.LINK}`,onClick:r,"data-blocktype":t.blockType,"data-value":t.value},{children:n})):(0,i.jsx)("span",Object.assign({"data-blocktype":t.blockType,"data-value":t.value},{children:n}))}function p(e){const{block:t,keyPrefix:n,markers:s}=e,{blockType:r,text:a}=t,l=s?(0,i.jsx)(c,{keyPrefix:n,text:a,markers:s}):(0,i.jsx)(i.Fragment,{children:a});return r===o.C.USER?(0,i.jsx)(d,Object.assign({},e,{children:l})):r===o.C.HASH?(0,i.jsx)(u,Object.assign({},e,{children:l})):r===o.C.LINK&&t.value?(0,i.jsx)(h,Object.assign({},e,{children:l})):l}function m(e){const t=e.textParser.parse(e.text),n=r()("text-box-text",e.className);return(0,i.jsx)("div",Object.assign({className:n},{children:t.map(((t,n)=>(0,i.jsx)(p,{keyPrefix:`${t.blockType}${n}`,block:t,linksActive:!!e.linksActive,onClick:e.onClick,markers:e.markers},`${t.blockType}${n}`)))}))}},51663:(e,t,n)=>{"use strict";n.d(t,{b:()=>b});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(60405),l=n(57340),c=n(83233),d=n(43985),u=n(86823),h=n(76223),p=n(36589),m=n(64921),f=n(42201),g=n(43873),v=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};const y="​";let b=class SmartTextEditor extends s.Component{constructor(e){super(e),this.emailMention=!1,this.wordToken=null,this.endTokens={"@":[","," ","!","?","/",";",":","(",")"],"#":[","," ",".","!","?","/",";",":"]},this.wordElement=null,this.linkElement=null,this.onClickAnchor=e=>{const t=e.target,n=t.dataset.blocktype;this.props.active?(e.preventDefault(),n===p.C.LINK&&this.prepareLinkForEdit(t)):n&&this.props.onClickBlock({blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id},e)},this.onSelectionChange=()=>{const e=this.getCurrentRange();if(e){this.range=e.cloneRange();const t=this.wordElement&&null===this.wordElement.parentElement,n=!!this.wordElement&&this.wordElement!==this.getAnchorFromSelection();(t||n)&&this.wordElement&&(this.wordElement.classList.add("link-annotation-active"),this.endWordMatching()),this.insertFocusNodeIfNeeded()}},this.addFauxHighlight=()=>{this.execCommand("backColor","#ff315840")},this.removeFauxHighlight=()=>{this.execCommand("backColor","transparent")},this.isEmailMention=(e="")=>e.lastIndexOf("@")>0,this.onInput=e=>{var t;const n=e.nativeEvent,i=n.inputType,s=i.startsWith("insert"),r="insertLineBreak"===i,o=n.data,a=this.startTokens;e.stopPropagation();const{isLinkNode:l,isSpecialNode:c,anchorNode:d}=this.tryGetAnchorNode();if(a.length&&!l&&!r){let r=o&&o.length>0?o.charAt(o.length-1):"";const l=this.getTextElement(),u=((null==l?void 0:l.innerText)||"").trim().length;if(l&&i.startsWith("delete")&&0===u&&(l.innerHTML=""),this.updateWordElement(n,c,d),!this.wordToken&&a.includes(r)?(e.preventDefault(),this.wordToken=r,this.emailMention=!1,this.createWordElement(r),this.updateSuggestions()):!this.wordToken&&o&&o.length>1&&a.includes(o[0])&&(e.preventDefault(),this.wordToken=o[0],r=o[o.length-1],this.emailMention=this.isEmailMention(o),this.createWordElement(o),this.updateSuggestions()),this.wordToken&&this.wordElement){const n=this.wordElement.textContent||"",i=this.getMatches(n),o=i.length,a=null===(t=this.endTokens[this.wordToken])||void 0===t?void 0:t.includes(r);1===o&&this.sanitizeForSearch(n)===this.sanitizeForSearch(i[0].text)&&s?(e.preventDefault(),this.chooseMatch(i[0].text,i[0].value,i[0].id)):a&&"#"===this.wordToken?(e.preventDefault(),this.finishWordElement(!0)):a&&"@"===this.wordToken?(e.preventDefault(),this.emailMention?this.finishWordElement(!0):0===o&&this.clearWordElement()):"@"===this.wordToken?(this.updateUserMatches(),this.isEmailMention(n)&&(this.wordElement.classList.add("link-annotation-active"),this.emailMention=!0)):this.filterSuggestions()}}this.props.onInput(this.getMarkdown())},this.updateUserMatches=(0,c.D)((()=>this.fetchUserMatches()),350),this.onClickMatch=e=>{const t=e.currentTarget;if(t){const n=t.dataset.value,i=t.dataset.id,s=t.dataset.text||t.innerText;e.stopPropagation(),e.preventDefault(),this.chooseMatch(s,n,i)}},this.onHoverMatch=e=>{const t=e.currentTarget;if(t){const e=parseInt(t.dataset.index||"0",10);this.setState({activeMatch:e})}},this.onClick=e=>{const{active:t,clickToEdit:n,onStartEditing:i}=this.props;t?(this.removeFauxHighlight(),this.range=null):n&&i&&i(e)},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e&&e(!0)},this.onBlur=()=>{this.endWordMatching(),this.setState({sortedSuggestions:[]});const{onFocusChange:e}=this.props;e&&e(!1)},this.onDone=()=>{const{onDoneEditing:e}=this.props;e?e():this.toggleEditing(!1)},this.onKeyDown=e=>{const{onCancelEditing:t}=this.props,{matches:n,activeMatch:i}=this.state;e.stopPropagation(),this.range||(this.range=this.getCurrentRange());switch(e.which||e.keyCode){case d.R.ESCAPE:return void(t&&t());case d.R.TAB:case d.R.RETURN:if(n.length&&i>-1)e.preventDefault(),this.chooseMatch(n[i].text,n[i].value,n[i].id);else{const{isSpecialNode:t,anchorNode:n}=this.tryGetAnchorNode();t&&n&&this.range&&(e.preventDefault(),this.insertAndFocusCharacter(n,!1,"\n​")),this.wordToken&&(e.preventDefault(),this.finishWordElement(!1,!0)),e.shiftKey||(e.preventDefault(),this.onDone())}return;case d.R.DOWNARROW:return void(n.length&&(e.preventDefault(),this.setState((e=>{const t=(e.activeMatch+1)%n.length;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.R.UPARROW:return void(n.length&&(e.preventDefault(),this.setState((e=>{const t=0===e.activeMatch?n.length-1:e.activeMatch-1;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.R.B:case d.R.I:case d.R.U:if(e.ctrlKey||e.metaKey)return void e.preventDefault();break;case d.R.BACKSPACE:case d.R.SHIFT:case d.R.CONTROL:case d.R.ALT:case d.R.LEFTARROW:case d.R.RIGHTARROW:case d.R.DELETE:return}},this.saveRef=e=>{this.textBox=e},this.bindSuggestionMenuRef=e=>{this.suggestionMenuRef=e},this.state={activeMatch:-1,matches:[],sortedSuggestions:[]}}componentDidMount(){this.props.active&&this.toggleEditing(!0,this.props.focusOnMount)}componentWillUnmount(){this.toggleEditing(!1),this.wordElement=null}componentDidUpdate(e,t){const{active:n}=this.props;n!==e.active&&this.toggleEditing(n)}toggleEditing(e,t){this.textBox&&this.textBox.toggleEditing(e,t),this.endWordMatching(),this.setState({sortedSuggestions:[]}),e?document.addEventListener("selectionchange",this.onSelectionChange):document.removeEventListener("selectionchange",this.onSelectionChange)}ensureActiveMatchIsVisible(e){if(!this.suggestionMenuRef)return;const{scrollTop:t,offsetHeight:n}=this.suggestionMenuRef,i=this.suggestionMenuRef.querySelector(`[data-index="${e}"]`);if(!i)return;const{offsetTop:s,offsetHeight:r}=i,o=t>s;if(t+n<s+r||o){const e=o;i.scrollIntoView(e)}}getTextElement(){var e;return null===(e=this.textBox)||void 0===e?void 0:e.getTextElement()}focus(){this.textBox&&this.textBox.focus()}getMarkdown(){const e=this.getTextElement();return e?this.props.textParser.serialize(e):""}hasTextSelected(){return!(!this.range||this.range.startOffset===this.range.endOffset)}createAnchor(e,t){const n=document.createElement("a");return n.href=t,n.text=this.props.textParser.sanitizeText(e),n.classList.add(m.o.LINK),n.setAttribute("data-value",t),n}prepareLinkForEdit(e){const t=e||this.getAnchorFromSelection();let n="";const i=window.getSelection();if(i){const e=this.getTextElement();t||this.range||!e?(this.addFauxHighlight(),t||(n=this.range?this.range.toString():i.toString())):(this.focus(),i.selectAllChildren(e),i.collapseToEnd(),this.range=i.getRangeAt(0),n=this.range.toString())}n===y&&(n=""),this.linkElement=t;const s=t?t.innerText:n,r=t?t.dataset.value||t.href:"";this.props.onClickBlock({blockType:p.C.LINK,text:s,value:r})}saveLink(e,t){this.linkElement?""!==t?this.updateLink(this.linkElement,e,t):this.unlink(this.linkElement):this.linkify(e,t)}updateLink(e,t,n){const{maxLength:i,textParser:s}=this.props,r=this.getMarkdown(),o=this.createAnchor(t,n);if(i){const t=s.serializeHTMLToMarkdown(o.outerHTML),n=s.serializeHTMLToMarkdown(e.outerHTML),a=t.length-n.length;if(r.length+a>i)return!1}return e.href=o.href,e.text=o.text,e.setAttribute("data-value",n),!0}cancelLink(){this.focus(),this.removeFauxHighlight()}linkify(e,t){this.removeFauxHighlight(),this.execCommand("createLink",t);let n=this.getAnchorFromSelection();!n&&this.range&&(n=document.createElement("a"),n.href=t,this.range.insertNode(n)),n&&(n.text=e,n.className=`link-annotation ${m.o.LINK}`,n.setAttribute("data-blocktype",p.C.LINK),n.setAttribute("data-value",t),n.onclick=this.onClickAnchor,this.insertAndFocusCharacter(n))}insertAndFocusCharacter(e,t=!1,n="​"){if(this.range=this.getCurrentRange(),this.range){const i=document.createTextNode(n),s=t?"setStartBefore":"setStartAfter",r=t?"setEndBefore":"setEndAfter";this.range[s](e),this.range[r](e),this.range.insertNode(i),this.range.selectNodeContents(i),n!==y&&this.range.collapse(!1),this.applyRange()}}unlink(e){const t=e.parentNode,n=e.textContent;t&&(t.removeChild(e),n&&!(0,u.j)(n)&&this.execCommand("insertText",n))}execCommand(e,t){this.range&&(this.applyRange(),document.execCommand(e,!1,t),this.onSelectionChange())}applyRange(){if(this.range){const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(this.range))}}getAnchorFromSelection(){const e=this.getCurrentRange();if(!e)return null;let t=e.commonAncestorContainer;for(;t&&"A"!==t.nodeName;){if(t===this.getTextElement())return null;t=t.parentNode}return t||null}insertFocusNodeIfNeeded(){var e,t;const n=window.getSelection();if(!n||!this.range)return;const{anchorNode:i,isLinkNode:s}=this.tryGetAnchorNode();if(i){const r=null!==(t=null===(e=i.textContent)||void 0===e?void 0:e.length)&&void 0!==t?t:0,o=0===n.focusOffset&&r>0,a=null===i.nextSibling&&r===n.focusOffset&&s;(o||a)&&this.insertAndFocusCharacter(i,o)}}getCurrentRange(){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),n=this.getTextElement();if(n&&(n===t.commonAncestorContainer||n.compareDocumentPosition(t.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY))return t}return null}sortWords(e){return e.sort(((e,t)=>e.text.toLowerCase()<t.text.toLowerCase()?-1:1))}tryGetAnchorNode(){var e;const t=this.getAnchorFromSelection();if(t&&t instanceof HTMLAnchorElement){const n=null===(e=t.dataset)||void 0===e?void 0:e.blocktype,i=n===p.C.USER||n===p.C.HASH,s=n===p.C.LINK;return{isSpecialNode:i,isLinkNode:s,anchorNode:i||s?t:null}}return{isSpecialNode:!1,isLinkNode:!1,anchorNode:null}}updateWordElement(e,t,n){const i=e.inputType.startsWith("delete"),s=window.getSelection(),r=this.startTokens;if(!this.wordElement||this.wordElement.parentElement){if(t&&n&&n.parentElement&&s){const e=n.textContent||"";if(!r.includes(e[0]||""))return void this.clearWordElement();const t=e.substr(0,s.focusOffset),o=s&&s.focusOffset<e.length,a=i||o;if(this.wordElement=n,this.wordToken=t[0],this.emailMention=this.isEmailMention(t),this.updateSuggestions(),this.range=this.getCurrentRange(),a&&this.range){this.range.selectNode(n);const i=this.range.extractContents();if(i&&i.firstElementChild&&i.firstElementChild instanceof HTMLElement){const n=e.substring(t.length),s=document.createTextNode(n);i.firstElementChild.innerText=t,i.firstElementChild.classList.remove("link-annotation-active"),i.firstElementChild.removeAttribute("data-value"),i.firstElementChild.removeAttribute("data-id"),i.appendChild(s),this.range.insertNode(i),this.range.setStartBefore(s),this.range.setEndBefore(s),this.range.collapse(!1),this.range.selectNodeContents(this.wordElement),this.range.collapse(!1),this.applyRange()}}}}else this.endWordMatching()}get startTokens(){const{hashtags:e,userMentions:t}=this.props,n=[];return t&&n.push("@"),e&&n.push("#"),n}fetchUserMatches(){const e=this.wordElement?this.wordElement.textContent:null;if(this.props.active&&this.wordToken&&e){const t=this.sanitizeForSearch(e,!0);this.context.commandBinder.issueCommand(new h.V1(t)).then((()=>{this.updateSuggestions()}))}}filterSuggestions(){const{wordToken:e,wordElement:t}=this;if(e&&t&&t.textContent){const e=this.sanitizeForSearch(t.textContent),n=this.getMatches(e),i=n.length>0?0:-1;this.setState({matches:n,activeMatch:i})}}sanitizeForSearch(e="",t){if(!this.wordToken)return e;let n=(e.startsWith(this.wordToken)?e.substr(1):e).toLowerCase().trim().replace(/\s\s+/g," ");if(t){const e=/([^\s]+)/.exec(n);n=e&&e[0]||""}return n}getMatches(e){const{sortedSuggestions:t=[]}=this.state,n=this.sanitizeForSearch(e)||"";return 0===n.length?t:t.filter((e=>{let t=0===this.sanitizeForSearch(e.text).indexOf(n);return!t&&"@"===this.wordToken&&e.value&&(t=0===this.sanitizeForSearch(e.value).indexOf(n)),t}))}chooseMatch(e,t,n){const i=this.wordElement;if(i){const s=this.wordToken&&!e.startsWith(this.wordToken)?this.wordToken:"";i.innerHTML=`${s}${e}`,i.classList.add("link-annotation-active"),t&&i.setAttribute("data-value",t),n&&i.setAttribute("data-id",n),this.finishWordElement(!1,!0),this.props.onInput(this.getMarkdown())}}updateSuggestions(){const{wordToken:e}=this,{hashtags:t,userMentions:n}=this.props;let i=[];if("#"===e&&t)i=this.sortWords(t.map((e=>({text:e,blockType:p.C.HASH}))));else if("@"===e&&n){const e=this.context.userData.getKnownUsers();i=this.sortWords(e.map((e=>({text:e.name,id:e.id,value:e.email,blockType:p.C.USER}))))}this.setState({sortedSuggestions:i},this.filterSuggestions)}endWordMatching(){this.setState({matches:[],activeMatch:-1}),this.wordToken=null,this.wordElement=null,this.emailMention=!1}createWordElement(e){const t=window.getSelection(),n=this.range;if(!n||!t||!this.wordToken)return;const i=document.createElement("a");i.removeAttribute("href"),i.innerText=e,"#"===this.wordToken?(i.className=`link-annotation ${m.o.HASH}`,i.setAttribute("data-blocktype",p.C.HASH)):"@"===this.wordToken&&(i.className=`link-annotation ${m.o.USER}`,i.setAttribute("data-blocktype",p.C.USER));const s=n.startContainer,r=n.startOffset,o=n.endOffset+e.length,a=Math.max(0,(s.textContent||"").length);try{n.setStart(s,Math.min(r,a)),n.setEnd(s,Math.min(o,a))}catch(e){n.selectNodeContents(s)}n.deleteContents(),n.insertNode(i),n.selectNodeContents(i),n.collapse(!1),this.applyRange(),this.wordElement=i}clearWordElement(){const e=this.range,t=window.getSelection();e&&t&&this.wordElement&&this.wordToken&&(this.stripAnchorFromNode(this.wordElement),this.endWordMatching())}stripAnchorFromNode(e){const t=this.range;if(!t)return;const n=e.textContent;if(this.focus(),t.selectNode(e),t.deleteContents(),t.collapse(!1),n){const e=document.createTextNode(n);t.insertNode(e),t.selectNodeContents(e),t.collapse(!1)}this.applyRange()}isValidSpecialWord(e,t){return 0!==this.sanitizeForSearch(t).length||(this.clearWordElement(),!1)}finishWordElement(e,t){const{range:n,wordElement:i,wordToken:s}=this,r=window.getSelection();if(!(n&&r&&i&&s))return;i.contentEditable="true",i.classList.add("link-annotation-active");let o="";const a=i.textContent;if(this.isValidSpecialWord(s,a||"")){if(e&&a&&a.length>1?(o=a.charAt(a.length-1),i.textContent=a.slice(0,-1)):t&&(o=" "),this.focus(),n.setStartAfter(i),o){const e=document.createTextNode(o);n.insertNode(e),n.selectNodeContents(e),n.collapse(!1)}this.applyRange(),this.endWordMatching()}else this.clearWordElement()}renderMatch(e,t){const{activeMatch:n}=this.state,s=t===n,r=e.blockType===p.C.USER,a=r&&e.value?this.context.userData.getUserDisplay(e.value):null,l=r?e.value:void 0,c=`${e.text}-${t}`;return(0,i.jsxs)("div",Object.assign({className:o()("suggestion",{selected:s}),onMouseDown:this.onClickMatch,onMouseEnter:this.onHoverMatch,"data-value":e.value,"data-id":e.id,"data-text":e.text,"data-index":t},{children:[r&&a&&(0,i.jsx)(g.C,{badgeStyle:{color:a.color,borderColor:a.color,backgroundColor:"transparent"},label:a.initials}),(0,i.jsx)("span",Object.assign({className:"suggestion-text"},{children:e.text})),l&&(0,i.jsxs)("p",Object.assign({className:"suggestion-hint"},{children:["(",l,")"]}))]}),c)}renderMatches(){if(!this.props.active)return null;const{matches:e}=this.state,t=e.length>0;return(0,i.jsx)("div",Object.assign({className:o()("suggestion-menu",{open:t}),ref:this.bindSuggestionMenuRef},{children:t&&e.map(((e,t)=>this.renderMatch(e,t)))}))}render(){const{text:e,textParser:t,clickToEdit:n,placeholder:s,tabIndex:r,maxLength:a,className:l,active:c}=this.props;return(0,i.jsxs)("div",Object.assign({className:o()("smart-text-box",l)},{children:[(0,i.jsx)(f.Z,{ref:this.saveRef,text:e,textParser:t,active:c,placeholder:s,tabIndex:r,clickToEdit:n&&!c,maxLength:a,onClick:this.onClick,onInput:this.onInput,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.handleFocus,onClickAnchor:this.onClickAnchor}),this.renderMatches()]}))}};b.contextType=a.I,b=v([l.A],b)},42201:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(85893),s=n(67294),r=n(94184),o=n.n(r),a=n(57340),l=n(60405),c=n(43985),d=n(56829),u=n(13508),h=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};let p=class TextBox extends s.Component{constructor(e){super(e),this.textElement=(0,s.createRef)(),this.editing=!1,this.isUnmounting=!1,this.stopPropagation=e=>e.stopPropagation(),this.onPaste=e=>{if(!e.clipboardData||!this.textElement.current)return;const{maxLength:t,textParser:n}=this.props,i=e.clipboardData.getData("text/plain");if(e.preventDefault(),t){const e=this.getSelectionRange();if(!e)return;const[s,r]=n.getHTMLWithoutSelection(this.textElement.current,e),o=e=>n.serializeHTMLToMarkdown(`${s}${i.slice(0,e)}${r}`).length<=t,a=(0,u.$)(i.length,o);if(a>=0){const e=i.slice(0,a);document.execCommand("insertHTML",!1,e)}}else document.execCommand("insertHTML",!1,i)},this.onKeyDown=e=>{if(!this.textElement.current)return;const{maxLength:t,onKeyDown:n,textParser:i}=this.props,s=this.getSelectionRange();if(t&&s){const[n,r]=i.getHTMLWithoutSelection(this.textElement.current,s),o=this.getTextInsertion(e,n,r);if(i.serializeHTMLToMarkdown(`${n}${o}${r}`).length>t)return e.preventDefault(),void e.stopPropagation()}(e.which||e.keyCode)===c.R.RETURN&&(e.shiftKey||e.altKey)?document.execCommand("insertText",!1,"\n"):n&&n(e)},this.onMouseDown=e=>{const{onClick:t,clickToEdit:n,readonly:i}=this.props;t&&(e.stopPropagation(),t(e)),i||!this.editing&&n&&this.toggleEditing(!0)},this.onFocus=e=>{this.textElement.current&&(this.context.messageBus.broadcast(new d.SN(this.textElement.current,!0)),this.props.onFocus&&this.props.onFocus(e))},this.onBlur=e=>{this.textElement.current&&(this.context.messageBus.broadcast(new d.SN(this.textElement.current,!1)),this.props.onBlur&&this.props.onBlur(e))}}componentDidMount(){this.replaceTextContent(this.props.text)}componentWillUnmount(){this.isUnmounting=!0,this.textElement.current&&this.textElement.current.blur()}componentDidUpdate(e){const{text:t,active:n}=this.props;t===e.text&&n===e.active||this.replaceTextContent(t)}shouldComponentUpdate(){return!1}getTextElement(){return this.textElement.current}getPlainText(){var e;return(null===(e=this.textElement.current)||void 0===e?void 0:e.innerText)||""}focus(){this.editing&&this.textElement.current&&this.textElement.current.focus()}toggleEditing(e,t=!0){clearTimeout(this.toggleEditingTimeout),this.toggleEditingTimeout=window.setTimeout((()=>{this.textElement.current&&!this.isUnmounting&&(this.editing!==e&&(this.editing=e,this.textElement.current.contentEditable=e?"true":"false",e?this.textElement.current.classList.add("editing"):this.textElement.current.classList.remove("editing")),e&&t?this.textElement.current.focus():this.textElement.current.blur())}),0)}replaceTextContent(e){clearTimeout(this.replaceTextContentTimeout),this.replaceTextContentTimeout=window.setTimeout((()=>{if(!this.textElement.current||this.isUnmounting)return;for(;this.textElement.current.firstChild;)this.textElement.current.removeChild(this.textElement.current.firstChild);const t=document.createDocumentFragment(),{textParser:n,markers:i,onClickAnchor:s,active:r,readonly:o,maxLength:a,clickableLinks:l}=this.props,c=void 0!==l?l:!r,d=n.deserialize(e,c,s,i);let u=0,h=!d.every((e=>{var n;const i=(null===(n=e.textContent)||void 0===n?void 0:n.length)||0;if(o&&a&&u+i>a){if("#text"===e.nodeName){const n=e.textContent||"";e.textContent=n.substring(0,a-u),t.appendChild(e)}return!1}return!o&&r&&"A"===e.nodeName&&(e.contentEditable="true"),u+=i,t.appendChild(e),!0}));h&&t.appendChild(document.createTextNode("...")),this.textElement.current.appendChild(t),this.focus(),o&&!h&&this.props.maxLines&&this.textElement.current.scrollHeight>this.textElement.current.offsetHeight&&(h=!0,this.textElement.current.appendChild(document.createTextNode("..."))),this.props.onTextReplaced&&this.props.onTextReplaced(h)}),0)}getSelectionRange(){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0);if(this.textElement.current&&(this.textElement.current===t.commonAncestorContainer||this.textElement.current.compareDocumentPosition(t.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY))return t}return null}getTextInsertion(e,t,n){switch(e.which||e.keyCode){case c.R.LEFTARROW:case c.R.UPARROW:case c.R.RIGHTARROW:case c.R.DOWNARROW:case c.R.BACKSPACE:return"";case c.R.RETURN:const i=t.slice(-1),s=n.slice(0,1);return"\n"===i||"\n"===s?"\n":"\n\n";default:return e.key}}render(){const{placeholder:e,tabIndex:t,onInput:n,readonly:s,maxLines:r,text:a}=this.props,l=s&&r,c=l?{WebkitLineClamp:r}:{},d=o()("text-box-text",{clamped:l,placeholder:!!e&&!a});return(0,i.jsx)("div",{ref:this.textElement,className:d,style:c,role:"textbox",draggable:!1,spellCheck:!0,contentEditable:!1,placeholder:e,onMouseDown:this.onMouseDown,onKeyDown:s?void 0:this.onKeyDown,onKeyUp:s?void 0:this.stopPropagation,onFocus:s?void 0:this.onFocus,onBlur:s?void 0:this.onBlur,onInput:s?void 0:n,onPaste:s?void 0:this.onPaste,tabIndex:t})}};p.contextType=l.I,p=h([a.A],p);const m=p},64921:(e,t,n)=>{"use strict";n.d(t,{o:()=>i,v:()=>TextParser});var i,s=n(36589),r=n(2252);!function(e){e.TEXT="",e.LINK="link-url",e.HASH="link-hashtag",e.USER="link-user"}(i||(i={}));class TextParser{constructor(e){this.serialize=e=>{const t=[],n=[].slice.call(e.childNodes);for(const e of n)switch(e.nodeName){case"#text":t.push(this.serializeText(e));break;case"A":t.push(this.serializeAnchor(e));break;case"P":case"DIV":t.push(this.serializeElement(e,!0));break;case"SPAN":t.push(this.serializeElement(e,!1));break;case"BR":t.push(this.serializeBreak(e));break;default:t.push(this.serialize(e))}return t.join("")},this.deserialize=(e,t,n,i=this.markers)=>{const s=this.parse(e).map((e=>this.createNode(e,t,n)));return i?this.parseMarkers(s,i):s},this.serializeHTMLToMarkdown=e=>{const t=document.createElement("div");t.innerHTML=e;const n=this.serialize(t);return t.remove(),n},this.serializeText=e=>{let t=this.sanitizeText(e.textContent||"");if(this.links){const e=new RegExp(/https?:\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?/gi),n=document.createElement("a");t=t.replace(e,(e=>(n.href=e,`[${e}](${n.href})`))),n.remove()}return this.hashtags&&(t=t.replace(/(#\w*)/,(e=>`[${e}]`))),t.replace(/\<\s*br\s*\/?>/gi,"\n")},this.serializeAnchor=e=>{const t=e.dataset.blocktype,n=this.sanitizeText(e.innerText||"");let i=n;switch(t){case s.C.HASH:i=`[${n}]`;break;case s.C.USER:if(this.users){let t=e.dataset.id||"",n=e.dataset.value||"";if(!t&&!n&&(n="@"===i[0]?i.substr(1):i,n)){const e=this.users.getUserInfoByEmail(n);e&&(t=e.id)}(t||this.validateEmail(n))&&(i=`[@${t}](${n})`)}break;case s.C.LINK:const t=e.dataset.value||e.href;t&&(i=`[${n}](${t})`);break;default:e.href&&(i=`[${n}](${e.href})`)}return i},this.serializeElement=(e,t)=>{let n=t?"\n":" ";return e.childNodes.length>0&&(n+=this.serialize(e)),n},this.serializeBreak=e=>"\n",this.validateEmail=(()=>{const e=/\S+@\S+\.\S+/,t=document.createElement("input");return t.type="email",t.required=!0,n=>(t.value=n,"function"==typeof t.checkValidity?t.checkValidity():e.test(n))})();const{links:t,hashtags:n,users:i,markers:r}=e;this.links=t||!1,this.hashtags=n||!1,this.users=i,this.markers=r}parseMarkers(e,t){const[n,i]=t;let s=!1;const r=new RegExp(n+"|"+i);for(let t=0;t<e.length;t++){const n=e[t],{nodeType:i,textContent:o}=n,a=3===i;if(!o)continue;a?e.splice(t,1):n.textContent=null;const l=o.split(r);l.forEach(((i,r)=>{if(""!==i){let r;if(s){const e=document.createElement("span");e.setAttribute("data-blocktype","marker"),r=e,r.textContent=i}else r=document.createTextNode(i);a?e.splice(t++,0,r):n.appendChild(r)}r<l.length-1&&(s=!s)})),a&&t--}return e}createNode(e,t,n){switch(e.blockType){case s.C.USER:const r=document.createElement(n?"a":"span");if(r.setAttribute("data-blocktype",e.blockType),n){const t=r;t.className=`link-annotation ${i.USER}`,t.removeAttribute("href"),n&&(t.onclick=n);const s=e.id||"",o=e.value||"";s&&t.setAttribute("data-id",s),o&&t.setAttribute("data-value",o)}return r.textContent=`${e.text}`,r;case s.C.HASH:const o=document.createElement(n?"a":"span");if(o.setAttribute("data-blocktype",e.blockType),n){const e=o;e.className=`link-annotation ${i.HASH}`,e.removeAttribute("href"),n&&(e.onclick=n)}return o.textContent=`${e.text}`,o;case s.C.LINK:if(e.value){const s=document.createElement(n||t?"a":"span");if(s.setAttribute("data-blocktype",e.blockType),s.setAttribute("data-value",e.value),n||t){const r=s;t&&(r.href=`${e.value}`),r.target="_blank",r.className=`link-annotation ${i.LINK}`,n&&(r.onclick=n)}return s.textContent=`${e.text}`,s}}return document.createTextNode(""+e.text)}parse(e){const t=[];if(!e)return[];const n=e.split("[").map(((e,t)=>0===t?e:"["+e));let i=0;for(;i<n.length;){const e=this.parseIntoBlocks(n[i],t);e&&n.splice(i+1,0,e),i++}return t}getPlainText(e){return this.parse(e).map((e=>e.text)).join("")}searchMarkdown(e,t){let n=-1,i=0,s=0;const r=this.parse(e).map((e=>{let r;return this.matchTextBlock(e,t)?(s++,-1===n&&(n=i),r=e.markdown):r=e.text,i+=e.text.length,r}));return-1===n?null:{markdown:r.join(""),matchIndex:n,textLength:i,numMatches:s}}getUserMentions(e){return this.parse(e).filter((e=>e.blockType===s.C.USER&&e.value)).map((e=>e.value||""))}matchTextBlock(e,t){if(e.blockType===t.blockType)if(e.blockType===s.C.USER){if(e.id===t.id)return!0;if(e.value===t.value)return!0}else if(e.blockType===s.C.HASH)return e.text===t.text;return!1}getHTMLWithoutSelection(e,t){let n=!1,i="",s=!1,r="";return e.childNodes.forEach((e=>{const o=e instanceof HTMLElement?e.outerHTML:e.nodeValue;o&&(n&&s&&(r+=o),e===t.startContainer&&(i+=o.slice(0,t.startOffset),n=!0),e===t.endContainer&&(r+=o.slice(t.endOffset,o.length),s=!0),n||s||(i+=o))})),[i,r]}parseIntoBlocks(e,t){if(this.users){const n=this.getUserBlock(e);if(n)return t.push(n),e.slice(n.markdown.length)}if(this.links){const n=this.getLinkBlock(e);if(n&&n.value&&-1===n.value.indexOf("javascript:"))return t.push(n),e.slice(n.markdown.length)}if(this.hashtags){const n=this.getHashBlock(e);if(n)return t.push(n),e.slice(n.markdown.length)}const n=this.getTextBlock(e);return n&&t.push(n),null}getTextBlock(e){return 0===e.length?null:{blockType:s.C.TEXT,text:e,markdown:e}}getHashBlock(e){const t=e.match(TextParser.hashRegex);return!t||t.length<2?null:{blockType:s.C.HASH,markdown:t[0],text:t[1]}}getUserBlock(e){if(!this.users)return null;const t=e.match(TextParser.userRegex);if(!t||t.length<3)return null;let n=t[1].substr(1),i=t[2];const r=i?this.users.getUserInfoByEmail(i):this.users.getUserInfoById(n),o=r?r.name:"";return n=r?r.id:n,i=r?r.email:i,{blockType:s.C.USER,markdown:t[0],id:n,value:i,text:`@${o||i}`}}getLinkBlock(e){const t=e.match(TextParser.linkRegEx);if(!t)return null;const n=t[2];let i=1,r=0;for(;r<n.length&&("("===n[r]?i++:")"===n[r]&&i--,0!==i);)r++;const o=n.length-r;let a=this.conditionallyEncode(t[2].substring(0,r));return-1===a.indexOf("://")&&(a="http://"+a),{blockType:s.C.LINK,markdown:t[0].substring(0,t[0].length-o),text:t[1],value:a}}conditionallyEncode(e){return this.needsEncoding(e)?encodeURI(e):e}needsEncoding(e){if(e.match(r.jx))return!0;let t=e;try{t=decodeURI(e)}catch(e){}return!1}sanitizeText(e){return e.replace(/\]\(/g,"]&zwnj;(").replace(/[\u200B]/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"')}}TextParser.hashRegex=/\[(#(\w|-)*)\]/,TextParser.userRegex=/\[(@\w*)\]\(([^\)\(\[\]]*)\)/,TextParser.linkRegEx=/\[([^\]]*)\]\((.*)\)/},56759:(e,t,n)=>{"use strict";n.d(t,{x:()=>s,u:()=>h});var i,s,r=n(85893),o=n(67294),a=n(94184),l=n.n(a),c=n(57340),d=n(70329),u=function(e,t,n,i){var s,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(r<3?s(o):r>3?s(t,n,o):s(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o};!function(e){e.NONE="no-arrow",e.TOP_LEFT="position-top-left",e.TOP_RIGHT="position-top-right",e.TOP_CENTER="position-top-center",e.BOTTOM_RIGHT="position-bottom-right",e.BOTTOM_LEFT="position-bottom-left",e.BOTTOM_CENTER="position-bottom-center",e.RIGHT_BOTTOM="position-right-bottom"}(s||(s={}));let h=i=class Tooltip extends o.Component{constructor(e){super(e),this.tooltipWrapperRef=(0,o.createRef)(),this.tooltipContentRef=(0,o.createRef)(),this.maxDurationTimeout=0,this.addClickListenerTimeout=0,this.closeTooltip=()=>{this.setState({showing:!1}),window.removeEventListener("click",this.handleOutsideClick),window.removeEventListener("touchstart",this.handleOutsideClick)},this.timeoutTooltip=()=>{this.closeTooltip(),this.props.onTimeout&&this.props.onTimeout()},this.openTooltip=e=>{this.setState({showing:!0}),this.addClickListenerTimeout=window.setTimeout((()=>{window.addEventListener("click",this.handleOutsideClick),window.addEventListener("touchstart",this.handleOutsideClick),void 0!==e&&(this.maxDurationTimeout=window.setTimeout(this.timeoutTooltip,e))}),0)},this.getContentPosition=()=>{if(!this.tooltipWrapperRef.current||!this.tooltipContentRef.current)return{};const e=this.tooltipWrapperRef.current.parentElement,t=this.tooltipContentRef.current;switch(this.props.arrowPos){case s.BOTTOM_RIGHT:return{transform:`translate(${15-t.offsetWidth}px, ${-t.offsetHeight-e.getBoundingClientRect().height-22}px)`};case s.BOTTOM_LEFT:return{transform:`translate(${-15}px, ${-t.offsetHeight-e.getBoundingClientRect().height-33}px)`};case s.RIGHT_BOTTOM:return{transform:`translate(${-t.offsetWidth-7}px, ${9-t.offsetHeight}px)`};default:return{}}},this.handleOutsideClick=e=>{this.props.onClose&&this.props.onClose(e)},this.state={showing:e.open};const t=i.count++;this.wrapperId=`tooltip-wrapper-${e.name||t}`,this.id=`${e.tooltipId||`tooltip-${t}`}`}static clearCount(){this.count=0}componentDidMount(){this.props.open&&this.openTooltip(this.props.maxMsOpen)}componentWillUnmount(){window.clearTimeout(this.maxDurationTimeout),window.clearTimeout(this.addClickListenerTimeout),window.removeEventListener("click",this.handleOutsideClick),window.removeEventListener("touchstart",this.handleOutsideClick)}UNSAFE_componentWillReceiveProps(e){e.open&&!this.props.open?this.openTooltip(e.maxMsOpen):!e.open&&this.props.open&&this.closeTooltip()}render(){const{arrowPos:e,title:t,message:n,onClose:i,closeButton:o,darkTheme:a,appendHTML:c,bodyClassName:u,className:h}=this.props,{showing:p}=this.state,m={emulatedDialog:!0,open:p,dark:a,[void 0===e?s.TOP_CENTER:e]:!0};return(0,r.jsx)("div",Object.assign({id:this.wrapperId,className:l()(m,h),ref:this.tooltipWrapperRef},{children:(0,r.jsxs)("div",Object.assign({id:this.id,className:l()("tooltip",u),style:this.getContentPosition(),ref:this.tooltipContentRef},{children:[t&&(0,r.jsx)("div",Object.assign({className:"title"},{children:t})),o&&i&&(0,r.jsx)(d.P,{onClose:i}),n,c]}))}))}};h.POPUP_OFFSET=28,h.count=0,h=i=u([c.Z],h)},20585:(e,t,n)=>{"use strict";n.d(t,{MN:()=>i,OR:()=>s,LH:()=>r,c9:()=>o,_U:()=>a,g:()=>l,El:()=>c});const i=767,s=()=>window.innerWidth>i,r=375,o=55,a=70,l=500,c=750},98878:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Animation});var i=n(65270);class Animation{constructor(e){this.isAnimating=!0,this.duration=e.duration,this.startValue=e.startValue,this.changeValue=e.endValue-this.startValue,this.easingFunction=e.easingFunction||i.to}getUpdatedValue(){this.startTime||(this.startTime=Date.now());const e=Date.now()-this.startTime;return e>this.duration&&(this.isAnimating=!1),this.easingFunction(Math.min(e,this.duration),this.startValue,this.changeValue,this.duration)}}},55580:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i=(e,t)=>{for(const n in t)if(e[n]!==t[n])return!0;return!1}},94805:(e,t,n)=>{"use strict";n.d(t,{u:()=>v,a:()=>y});var i=n(14832),s=n(23676),r=n(34612),o=n(38562),a=n(8765),l=n(69826),c=n(19822),d=n(77477),u=n(87100),h=n(10854),p=n(3922),m=n(2212);const{TAGS:f,NOTES:g}=h.Z.SHOWCASE,v=function(e,t,n){const i=e.tryGetProperty("tool","").toUpperCase();return t&&e.tryGetProperty("tag","")?s.w1.TAGS:n&&e.tryGetProperty("note","")?s.w1.NOTES:i||null},y=function(e,t){const{commandBinder:n,market:h,settings:v}=t,y=(t,s,r,o,a,l)=>{if(e===t){const e=v.tryGetProperty(s,"");if(e)return v.setProperty(s,""),h.waitForData(r).then((t=>{const s=o(t,e);if(s){const t=(new m.Vector3).copy(s.stemNormal).setLength(s.stemLength).add(s.anchorPosition),n=p.K.decodeVector3(v.tryGetProperty("pin-pos",p.K.encodeVector3(t))),r=n&&n.distanceTo(t)>.1||null===p.K.deserialize()?i.n.FadeToBlack:null;a(e,r)}else{const e={messagePhraseKey:l,timeout:4e3,dismissesOnAction:!0};n.issueCommand(new d.L(e))}})),!0}return!1};y(s.w1.NOTES,"note",o.X,((e,t)=>e.getNoteView(t)),((e,t)=>{n.issueCommand(new a.yW(e,!0,(0,u.FU)().comment,t))}),g.MISSING_MESSAGE)||y(s.w1.TAGS,"tag",l.n,((e,t)=>e.getTagView(t)),((e,t)=>{n.issueCommand(new c.lt(e,t,!0))}),f.MISSING_MESSAGE)||e&&(v.setProperty("tool",""),n.issueCommandWhenBound(new r.tT(e,!0)))}},58844:(e,t,n)=>{"use strict";n.d(t,{Z:()=>InputFilter});var i=n(5314),s=n(87727);class InputFilter{constructor(e){this.couldBeDrag=!1,this.isDragging=!1,this.shouldHandleEvents=!0,this.handleEvent=e=>{if(this.shouldHandleEvents)switch(e.stopPropagation(),e.type){case"mousedown":case"touchstart":case"pointerdown":this.onPressStart(e);break;case"mousemove":case"pointermove":case"touchmove":this.onPressMove(e);break;case"mouseup":case"pointerup":case"mouseleave":case"touchend":case"touchcancel":case"pointercancel":case"pointerleave":this.onPressEnd(e)}},this.callbacks=e}setEnabled(e){this.shouldHandleEvents=e,this.couldBeDrag=this.couldBeDrag&&e}getPosition(e){return(0,i.z6)(e)?{x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}:{x:e.clientX,y:e.clientY}}onPressStart(e){this.couldBeDrag=!0,this.dragEvents=[],this.dragStart=this.getPosition(e),this.callbacks.handlePressStart&&this.callbacks.handlePressStart(this.getPosition(e))}onPressMove(e){if(!this.couldBeDrag)return;const t=this.getPosition(e);this.addDragEvent(t),this.isDragging||Math.sqrt(Math.pow(t.x-this.dragStart.x,2)+Math.pow(t.y-this.dragStart.y,2))>s.JU&&(this.isDragging=!0,this.callbacks.handleDragStart&&this.callbacks.handleDragStart()),this.callbacks.handlePressMove&&this.callbacks.handlePressMove({x:this.dragStart.x-t.x,y:this.dragStart.y-t.y})}onPressEnd(e){if(this.couldBeDrag){if(this.couldBeDrag=!1,this.isDragging){if(!this.dragEvents||!this.dragEvents[0])return;const e=this.dragEvents[0],t=this.dragEvents[this.dragEvents.length-1];if(this.callbacks.handleDragEnd){const n={x:0,y:0};Date.now()-t.timestamp<InputFilter.dragMoveTimeout&&(n.x=e.position.x-t.position.x,n.y=e.position.y-t.position.y),this.callbacks.handleDragEnd(n,t.timestamp-e.timestamp)}}else this.callbacks.handleClick&&this.callbacks.handleClick(e);this.isDragging=!1}}addDragEvent(e){this.dragEvents.push({position:e,timestamp:Date.now()}),this.dragEvents.length>10&&this.dragEvents.shift()}}InputFilter.dragMoveTimeout=100},45590:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});const i=e=>e.innerWidth<487||e.innerHeight<487},86823:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var i=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");const s=e=>(e=>i.test(e))(e)&&/^https?:\/\//.test(e)},95847:(e,t,n)=>{"use strict";n.d(t,{z:()=>HoverEvent,A:()=>UnhoverEvent});var i=n(59017);class HoverEvent extends i.G{constructor(){super(...arguments),this.type="hover"}}class UnhoverEvent extends i.G{constructor(){super(...arguments),this.type="unhover"}}},59017:(e,t,n)=>{"use strict";n.d(t,{G:()=>InputEvent});class InputEvent{constructor(){this.eventType="input"}}},3035:(e,t,n)=>{"use strict";n.d(t,{T:()=>ClickCancelEvent,R:()=>ClickEvent});var i=n(7928);class ClickCancelEvent extends i.C{constructor(e,t){super(),this.position=e,this.buttons=t}}class ClickEvent extends i.C{constructor(e,t){super(),this.position=e,this.button=t}}},76922:(e,t,n)=>{"use strict";n.d(t,{E0:()=>DragBeginEvent,_t:()=>DragEvent,_R:()=>DragEndEvent,u4:()=>DragGestureStartEvent,Zv:()=>DragGestureEndEvent});var i=n(7928);class DragBeginEvent extends i.C{constructor(e,t){super(),this.position=e,this.buttons=t}}class DragEvent extends i.C{constructor(e,t,n,i){super(),this.position=e,this.clientPosition=i,this.delta=t,this.buttons=n}}class DragEndEvent extends i.C{constructor(e,t,n,i,s){super(),this.position=e,this.delta=t,this.buttons=n,this.timeSinceLastMove=i,this.fullDelta=s}}class DragGestureStartEvent extends i.C{constructor(e,t){super(),this.position=e,this.pointer=t}}class DragGestureEndEvent extends i.C{constructor(e,t){super(),this.position=e,this.fullDelta=t}}},7928:(e,t,n)=>{"use strict";n.d(t,{C:()=>GestureEvent});var i=n(59017);class GestureEvent extends i.G{}},94267:(e,t,n)=>{"use strict";n.d(t,{DG:()=>LongPressMoveEvent,PC:()=>LongPressProgressEvent,Vh:()=>LongPressStartEvent,$b:()=>LongPressSuccessEvent,pt:()=>LongPressEndEvent});var i=n(7928);class LongPressMoveEvent extends i.C{constructor(e,t,n,i){super(),this.position=e,this.clientPosition=t,this.delta=n,this.buttons=i}}class LongPressProgressEvent extends i.C{constructor(e,t,n,i,s){super(),this.position=e,this.clientPosition=t,this.delta=n,this.buttons=i,this.progress=s}}class LongPressStartEvent extends i.C{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.buttons=n}}class LongPressSuccessEvent extends i.C{constructor(e,t){super(),this.position=e,this.clientPosition=t}}class LongPressEndEvent extends i.C{constructor(e,t,n){super(),this.position=e,this.clientPosition=t,this.cancelled=n}}},46158:(e,t,n)=>{"use strict";n.d(t,{d:()=>MultiSwipeEvent,h:()=>MultiSwipeEndEvent});var i=n(7928);class MultiSwipeEvent extends i.C{constructor(e,t,n){super(),this.pointerCount=e,this.position=Object.assign({},t),this.delta=Object.assign({},n)}}class MultiSwipeEndEvent extends i.C{constructor(e,t,n,i){super(),this.pointerCount=e,this.position=Object.assign({},t),this.delta=Object.assign({},n),this.timeSinceLastMove=i}}},69054:(e,t,n)=>{"use strict";n.d(t,{G:()=>PinchEvent,i:()=>PinchEndEvent});var i=n(7928);class PinchEvent extends i.C{constructor(e){super(),this.pinchDelta=e}}class PinchEndEvent extends i.C{constructor(e,t){super(),this.pinchDelta=e,this.timeSinceLastMove=t}}},36540:(e,t,n)=>{"use strict";n.d(t,{h:()=>RawPointersEvent});var i=n(7928);class RawPointersEvent extends i.C{constructor(e){super(),this.pointers=e}}},93145:(e,t,n)=>{"use strict";n.d(t,{D:()=>RotateEvent,u:()=>RotateEndEvent});var i=n(7928);class RotateEvent extends i.C{constructor(e){super(),this.rotateDelta=e}}class RotateEndEvent extends i.C{constructor(e,t){super(),this.rotateDelta=e,this.timeSinceLastMove=t}}},17921:(e,t,n)=>{"use strict";n.d(t,{a:()=>ScrollEvent});var i=n(7928);class ScrollEvent extends i.C{constructor(e,t){super(),this.position=e,this.delta=t}}},51573:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>InputIni});var i=n(57227),s=n(15697),r=n(5314),o=n(8054),a=n(70399),l=n(37917),c=n(81402),d=n(2252);class InputPointer{constructor(e,t,n,i){if(this.config=e,this.canvasData=n,this.handledTouchesAsPointer=0,this.lastTouchEnd=0,this.activeButtons=o.r3.NONE,this.preventDoubleTap=e=>{e.cancelable&&e.timeStamp-this.lastTouchEnd<=InputPointer.doubleTapThreshold&&e.preventDefault(),this.lastTouchEnd=e.timeStamp},this.preventMultiTouchGesture=e=>{const t=e.touches&&e.touches.length>1,n="scale"in e&&1!==e.scale;(t||n)&&e.cancelable&&e.preventDefault()},this.onEventCallback=i,window.PointerEvent||(t.addEventListener("mousedown",(e=>this.onMouseDown(e))),t.addEventListener("mouseup",(e=>this.onMouseUp(e))),t.addEventListener("mousemove",(e=>this.onMouseMove(e))),t.addEventListener("mouseenter",(e=>this.onMouseEnter(e)))),t.addEventListener("contextmenu",(e=>e.preventDefault())),t.addEventListener("touchstart",(e=>this.onTouchStart(e))),t.addEventListener("touchend",(e=>this.onTouchEnd(e))),t.addEventListener("touchmove",(e=>this.onTouchMove(e))),t.addEventListener("touchcancel",(e=>this.onTouchEnd(e))),t.addEventListener("pointerdown",(e=>this.onPointerDown(e))),t.addEventListener("pointerup",(e=>this.onPointerUp(e))),t.addEventListener("pointermove",(e=>this.onPointerMove(e))),t.addEventListener("pointercancel",(e=>this.onPointerUp(e))),t.addEventListener("pointerenter",(e=>this.onMouseEnter(e))),(0,d.Tt)()||(0,d._1)()){const e=!!l.h&&{passive:!1};document.addEventListener("touchmove",this.preventMultiTouchGesture,e),document.addEventListener("touchend",this.preventDoubleTap,e)}}onMouseDown(e){e.currentTarget.focus(),this.tryPreventDefault(e),this.activeButtons|=1<<e.button;const{ndc:t,client:n}=this.getPointerPosition(e);this.onEventCallback(new a.er(this.getPointerId(e),t,n,e.button,!0,a._A.MOUSE))}onMouseUp(e){this.tryPreventDefault(e),this.activeButtons&=~(1<<e.button);const{ndc:t,client:n}=this.getPointerPosition(e);this.onEventCallback(new a.er(this.getPointerId(e),t,n,e.button,!1,a._A.MOUSE))}onMouseMove(e){this.tryPreventDefault(e);const{ndc:t,client:n}=this.getPointerPosition(e);this.onEventCallback(new a.mE(this.getPointerId(e),t,n,this.activeButtons,a._A.MOUSE))}onMouseEnter(e){const t=(0,c.lY)(e.buttons,o.MP.MIDDLE,o.MP.SECONDARY),n=(this.activeButtons^t)&~t;for(let t=o.MP.PRIMARY;t<o.MP.COUNT;++t){const i=(0,o.AF)(t);if(i&&(n&i)>0){const{ndc:n,client:i}=this.getPointerPosition(e);this.onEventCallback(new a.er(this.getPointerId(e),n,i,t,!1,a._A.MOUSE))}}this.activeButtons=t}onTouchStart(e){if(e.currentTarget.focus(),e.cancelable&&e.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches.item(t),{ndc:i,client:s}=this.getTouchPosition(n);this.onEventCallback(new a.er(n.identifier,i,s,o.MP.PRIMARY,!0,a._A.TOUCH))}}onTouchEnd(e){if(e.cancelable&&e.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches.item(t),{ndc:i,client:s}=this.getTouchPosition(n);this.onEventCallback(new a.er(n.identifier,i,s,o.MP.PRIMARY,!1,a._A.TOUCH))}}onTouchMove(e){if(e.cancelable&&e.preventDefault(),this.handledTouchesAsPointer)--this.handledTouchesAsPointer;else for(let t=0;t<e.changedTouches.length;t++){const n=e.changedTouches.item(t),{ndc:i,client:s}=this.getTouchPosition(n),r=new a.mE(n.identifier,i,s,o.r3.PRIMARY,a._A.TOUCH);this.onEventCallback(r)}}onPointerDown(e){switch(this.tryPreventDefault(e),e.pointerType){case a._A.MOUSE:this.onMouseDown(e);break;case a._A.GAMEPAD:case a._A.TOUCH:++this.handledTouchesAsPointer;const{ndc:t,client:n}=this.getPointerPosition(e);this.onEventCallback(new a.er(e.pointerId,t,n,o.MP.PRIMARY,!0,e.pointerType))}}onPointerUp(e){switch(this.tryPreventDefault(e),e.pointerType){case a._A.MOUSE:this.onMouseUp(e);break;case a._A.GAMEPAD:case a._A.TOUCH:++this.handledTouchesAsPointer;const{ndc:t,client:n}=this.getPointerPosition(e);this.onEventCallback(new a.er(e.pointerId,t,n,o.MP.PRIMARY,!1,e.pointerType))}}onPointerMove(e){switch(this.tryPreventDefault(e),e.pointerType){case a._A.MOUSE:-1!==e.button?this.activeButtons<e.buttons?this.onMouseDown(e):this.activeButtons>e.buttons&&this.onMouseUp(e):this.onMouseMove(e);break;case a._A.GAMEPAD:case a._A.TOUCH:++this.handledTouchesAsPointer;const{ndc:t,client:n}=this.getPointerPosition(e);this.onEventCallback(new a.mE(e.pointerId,t,n,o.r3.PRIMARY,e.pointerType))}}getPointerId(e){return(0,r.bX)(e)?e.pointerId:0}getPointerPosition(e){return{ndc:this.normalizePosition(e.clientX,e.clientY),client:{x:e.clientX-this.canvasData.x,y:e.clientY-this.canvasData.y}}}getTouchPosition(e){return{ndc:this.normalizePosition(e.clientX,e.clientY),client:{x:e.clientX-this.canvasData.x,y:e.clientY-this.canvasData.y}}}normalizePosition(e,t){return{x:2*(e-this.canvasData.x)/this.canvasData.width-1,y:-2*(t-this.canvasData.y)/this.canvasData.height+1}}tryPreventDefault(e){this.config.pointerPreventDefault&&e.cancelable&&e.preventDefault()}}InputPointer.doubleTapThreshold=300;var u,h=n(43985),p=n(19926),m=n(94113);!function(e){e[e.SEMICOLON=59]="SEMICOLON",e[e.PLUSEQUALS=61]="PLUSEQUALS",e[e.DASHUNDERSCORE=173]="DASHUNDERSCORE"}(u||(u={}));class InputKey{constructor(e){this.keysDown={},this.onEventCallback=e,this.bindHandlers()}bindHandlers(){if(window&&window.document){const e=window.document;window.addEventListener("blur",(()=>{Object.keys(this.keysDown).forEach((e=>this.keysDown[e]=!1))})),e.addEventListener("keydown",(e=>{if(!e.ctrlKey&&!e.metaKey){e.preventDefault();const t=this.translateFirefoxKeys(e.which||e.keyCode);this.keysDown[t]=!0,this.onEventCallback(new m.e(t,p.M.DOWN,e))}})),e.addEventListener("keyup",(e=>{if(!e.ctrlKey&&!e.metaKey){e.preventDefault();const t=this.translateFirefoxKeys(e.which||e.keyCode);this.keysDown[t]&&this.onEventCallback(new m.e(t,p.M.PRESSED,e)),this.keysDown[t]=!1,this.onEventCallback(new m.e(t,p.M.UP,e))}}))}}translateFirefoxKeys(e){switch(e){case u.SEMICOLON:return h.R.SEMICOLON;case u.PLUSEQUALS:return h.R.PLUSEQUALS;case u.DASHUNDERSCORE:return h.R.DASHUNDERSCORE}return e}}var f,g=n(2212);!function(e){e[e.WAITING=0]="WAITING",e[e.WAITINGTOEXCEEDTHRESHOLD=1]="WAITINGTOEXCEEDTHRESHOLD",e[e.GESTURING=2]="GESTURING"}(f||(f={}));var v=n(3035);class ClickGesturer{constructor(e=.04,t=300){this.startPosition=new g.Vector2,this.pointerDelta=new g.Vector2,this.activeButtons=o.r3.NONE,this.state=f.WAITING,this.dragLimit=e,this.holdLimit=t}start(e){if(this.state===f.WAITING&&this.startPosition.copy(e.position),0==(e.buttons&e.buttons-1))this.startTime=Date.now(),this.activeButtons=e.buttons,this.state=f.WAITINGTOEXCEEDTHRESHOLD;else if(this.activeButtons)return this.state=f.GESTURING,new v.T(e.position,this.activeButtons)}stop(){let e;return this.state===f.WAITINGTOEXCEEDTHRESHOLD&&Date.now()-this.startTime<this.holdLimit&&(e=new v.R(this.startPosition.add(this.pointerDelta),(0,o.L2)(this.activeButtons)),this.pointerDelta.set(0,0)),this.state=f.WAITING,e}onMove(e){if(this.state===f.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(e.position).sub(this.startPosition),this.pointerDelta.length()>this.dragLimit))return this.state=f.GESTURING,new v.T(e.position,e.buttons)}compareState(e){return e===this.state}}var y=n(76922);class DragGesturer{constructor(e,t=.04){this.onEventCallback=e,this.startPosition=new g.Vector2,this.previousPosition=new g.Vector2,this.pointerDelta=new g.Vector2,this.lastPointerMove=Date.now(),this.state=f.WAITING,this.threshold=t}start(e){return this.state===f.WAITING&&(this.startPosition.copy(e.position),this.previousPosition.copy(this.startPosition),this.state=f.WAITINGTOEXCEEDTHRESHOLD),new y.E0(e.position,e.buttons)}stop(){const e=(new g.Vector2).copy(this.previousPosition).sub(this.startPosition);this.state===f.GESTURING&&this.onEventCallback(new y.Zv(this.startPosition,e)),this.state===f.WAITING&&this.pointerDelta.set(0,0),this.state=f.WAITING;const t=Date.now()-this.lastPointerMove;return new y._R(this.previousPosition,this.pointerDelta,o.r3.NONE,t,e)}onMove(e){let t;return this.state===f.WAITINGTOEXCEEDTHRESHOLD&&(this.pointerDelta.copy(e.position).sub(this.startPosition),this.pointerDelta.length()>this.threshold&&(this.state=f.GESTURING,this.onEventCallback(new y.u4(this.startPosition,e)))),this.state===f.GESTURING&&(this.pointerDelta.copy(e.position).sub(this.previousPosition),this.pointerDelta.length()>0&&(t=new y._t(this.previousPosition,this.pointerDelta,e.buttons,e.clientPosition))),this.previousPosition.copy(e.position),this.lastPointerMove=Date.now(),t}compareState(e){return e===this.state}compareStartPoint(e){return e.equals(this.startPosition)}compareDelta(e){return e.equals(this.pointerDelta)}}var b=n(69054);class PointerMovement{constructor(e=new g.Vector2,t=new g.Vector2,n=0){this.lastPosition=e,this.velocity=t,this.samePositionTicks=n}start(e){this.lastPosition.copy(e),this.velocity.set(0,0),this.samePositionTicks=0}update(e){if(this.lastPosition.distanceTo(e)<=.01){if(this.samePositionTicks++,this.samePositionTicks<2)return}else this.samePositionTicks=0;this.velocity.copy(this.lastPosition).sub(e),this.lastPosition.copy(e)}stationary(){return this.samePositionTicks>=2||this.velocity.length()<.01}}const S=2*Math.SQRT2;class PinchGesturer{constructor(e=.04){this.threshold=e,this.startDistance=0,this.previousDistance=0,this.pointerDelta=new g.Vector2,this.lastPointerMove=Date.now(),this.pinchDelta=0,this.state=f.WAITING,this.pointerMovement1=new PointerMovement,this.pointerMovement2=new PointerMovement}start(e,t){this.state===f.WAITING&&(this.restart(e,t),this.pointerMovement1.start(e.position),this.pointerMovement2.start(t.position))}stop(){this.state=f.WAITING;const e=Date.now()-this.lastPointerMove;return new b.i(this.pinchDelta,e)}onMove(e,t){this.pointerMovement1.update(e.position),this.pointerMovement2.update(t.position);if(!(this.pointerMovement1.stationary()||this.pointerMovement2.stationary()||this.pointerMovement1.velocity.dot(this.pointerMovement2.velocity)<0))return void this.restart(e,t);this.pointerDelta.copy(e.position).sub(t.position);const n=this.pointerDelta.length()/S;if(this.state===f.WAITINGTOEXCEEDTHRESHOLD){const e=n-this.startDistance;Math.abs(e)>this.threshold&&(this.state=f.GESTURING)}let i;if(this.state===f.GESTURING){const e=n-this.previousDistance;Math.abs(e)>0&&(this.pinchDelta=e,i=new b.G(e))}return this.previousDistance=n,this.lastPointerMove=Date.now(),i}restart(e,t){this.state=f.WAITINGTOEXCEEDTHRESHOLD,this.startDistance=e.position.distanceTo(t.position)/S,this.previousDistance=this.startDistance}}var E=n(74170),T=n(93145);class RotateGesturer{constructor(e=.1){this.startPointerDelta=new g.Vector2,this.previousPointerDelta=new g.Vector2,this.pointerDelta=new g.Vector2,this.lastPointerMove=Date.now(),this.angleWithDirection=0,this.state=f.WAITING,this.threshold=e}start(e,t){this.state===f.WAITING&&(this.state=f.WAITINGTOEXCEEDTHRESHOLD,this.startPointerDelta.copy(e.position).sub(t.position).normalize(),this.pointerDelta.copy(this.startPointerDelta),this.previousPointerDelta.copy(this.pointerDelta))}stop(){this.state=f.WAITING;const e=Date.now()-this.lastPointerMove;return new T.u(this.angleWithDirection,e)}onMove(e,t){if(this.pointerDelta.copy(e.position).sub(t.position).normalize(),this.state===f.WAITINGTOEXCEEDTHRESHOLD){Math.acos((0,E.uZ)(this.pointerDelta.dot(this.startPointerDelta),-1,1))>this.threshold&&(this.state=f.GESTURING)}let n;if(this.state===f.GESTURING){const e=Math.acos((0,E.uZ)(this.pointerDelta.dot(this.previousPointerDelta),-1,1));if(e>0){const t=this.previousPointerDelta.x*this.pointerDelta.y-this.previousPointerDelta.y*this.pointerDelta.x;this.angleWithDirection=t>=0?e:-e,n=new T.D(this.angleWithDirection)}}return this.previousPointerDelta.copy(this.pointerDelta),this.lastPointerMove=Date.now(),n}compareState(e){return e===this.state}}var w=n(28861),x=n(46158);class MultiSwipeGesturer{constructor(e=.04){this.startEpicenter=new g.Vector2,this.previousEpicenter=new g.Vector2,this.deltaEpicenter=new g.Vector2,this.currentEpicenter=new g.Vector2,this.pointerCount=0,this.lastPointerMove=Date.now(),this.state=f.WAITING,this.pointerMovements=[],this.threshold=e}start(e){this.state===f.WAITING&&(this.restart(e),this.pointerMovements=e.map((e=>new PointerMovement)),e.forEach(((e,t)=>{this.pointerMovements[t].start(e.position)})))}stop(){this.state=f.WAITING;const e=this.pointerCount;this.pointerCount=0;const t=Date.now()-this.lastPointerMove;return new x.h(e,this.currentEpicenter,this.deltaEpicenter,t)}onMove(e){(0,w.V)(this.getPointerPositions(e),this.currentEpicenter),e.forEach(((e,t)=>{this.pointerMovements[t].update(e.position)}));if(this.pointerMovements.find((e=>e.stationary())))return void this.restart(e);const t=this.pointerMovements[0].velocity;if(this.pointerMovements.find((e=>t.dot(e.velocity)<0)))return void this.restart(e);if(this.state===f.WAITINGTOEXCEEDTHRESHOLD){this.currentEpicenter.distanceTo(this.startEpicenter)>this.threshold&&(this.state=f.GESTURING)}let n;return this.state===f.GESTURING&&(this.deltaEpicenter.copy(this.currentEpicenter).sub(this.previousEpicenter),n=new x.d(e.length,this.currentEpicenter,this.deltaEpicenter)),this.previousEpicenter.copy(this.currentEpicenter),this.lastPointerMove=Date.now(),n}getPointerPositions(e){return e.map((e=>e.position))}restart(e){(0,w.V)(this.getPointerPositions(e),this.startEpicenter),this.previousEpicenter.copy(this.startEpicenter),this.currentEpicenter.copy(this.previousEpicenter),this.state=f.WAITINGTOEXCEEDTHRESHOLD,this.pointerCount=e.length}}var _=n(17921),M=n(94267);const O=new(n(5477).Z)("longpress");var A;!function(e){e[e.IDLE=0]="IDLE",e[e.WAITING=1]="WAITING",e[e.STARTED=2]="STARTED",e[e.SUCCESSFUL=3]="SUCCESSFUL"}(A||(A={}));class LongPressGesturer{constructor(e,t=500){this.onEventCallback=e,this.state=A.IDLE,this.ndcStartPosition=new g.Vector2,this.pointerDelta=new g.Vector2,this.ndcPosition=new g.Vector2,this.clientPosition=new g.Vector2,this.pressConfirmThreshold=this.pressStartThreshold=Math.max(t,1e-4)}start(e){this.state!==A.IDLE&&this.stop(),this.state===A.IDLE&&0==(e.buttons&e.buttons-1)&&(this.ndcStartPosition.copy(e.position),this.state=A.WAITING,this.buttons=e.buttons,this.pointerDelta.set(0,0),this.ndcPosition.copy(e.position),this.clientPosition.copy(e.clientPosition),this.holdTimeout=window.setTimeout((()=>{this.state=A.STARTED,O.debug("STARTED"),this.startTime=Date.now(),this.progress(0),this.onEventCallback(new M.Vh(e.position,e.clientPosition,e.buttons)),this.successTimeout=window.setTimeout((()=>{O.debug("SUCCESSFUL"),this.state=A.SUCCESSFUL,this.progress(1),this.onEventCallback(new M.$b(this.ndcPosition,this.clientPosition))}),this.pressConfirmThreshold)}),this.pressStartThreshold))}stop(){const e=this.state;if(this.state=A.IDLE,window.clearTimeout(this.holdTimeout),window.clearTimeout(this.successTimeout),e>A.WAITING){O.debug("DONE, cancelled:",e<A.SUCCESSFUL);const t=e<A.SUCCESSFUL;this.onEventCallback(new M.pt(this.ndcPosition,this.clientPosition,t))}}onMove(e){const t=this.state===A.STARTED||this.state===A.WAITING,n=this.state===A.STARTED||this.state===A.SUCCESSFUL;(t||n)&&(this.ndcPosition.copy(e.position),this.clientPosition.copy(e.clientPosition),this.pointerDelta.copy(this.ndcPosition).sub(this.ndcStartPosition)),t&&this.pointerDelta.length()>.1?this.stop():n&&this.onEventCallback(new M.DG(this.ndcPosition,this.clientPosition,this.pointerDelta,this.buttons))}tick(){if(this.state===A.STARTED){const e=1-(this.pressStartThreshold-(Date.now()-this.startTime))/this.pressStartThreshold;this.progress(Math.min(1,e))}}progress(e){this.onEventCallback(new M.PC(this.ndcPosition,this.clientPosition,this.pointerDelta,this.buttons,e))}}var C=n(36540),N=n(14877);class InputDebugMenu{constructor(){this.displayTouches=!1,this.touches=new Map}async init(e){const[t]=await Promise.all([e.getModuleBySymbol(N.y.SETTINGS)]);t.registerMenuButton({header:"Input",buttonName:"Toggle pointer visualization",callback:()=>{this.displayTouches=!this.displayTouches}})}addPointer(e,t){this.displayTouches&&(this.touches.set(e,this.createPointer(t)),this.movePointer(e,t))}removePointer(e){const t=this.touches.get(e);t&&(document.body.removeChild(t),this.touches.delete(e))}movePointer(e,t){const n=this.touches.get(e);n&&(n.style.left=t.x-25+"px",n.style.top=t.y-25+"px")}createPointer(e){const t=document.createElement("div");return t.style.position="fixed",t.style.backgroundColor="#aa11aa",t.style.width="50px",t.style.height="50px",t.style.zIndex="99999",t.style.pointerEvents="none",t.style.touchAction="none",t.style.borderRadius="50px",document.body.appendChild(t),t}}var D;!function(e){e[e.NONE=0]="NONE",e[e.CLICK_DRAG_LONGPRESS=1]="CLICK_DRAG_LONGPRESS",e[e.PINCH_ROTATE=2]="PINCH_ROTATE",e[e.MULTI_SWIPE_ONLY=3]="MULTI_SWIPE_ONLY"}(D||(D={}));class InputGesture{constructor(){this.activeGesture=D.NONE,this.pointers=[],this.couldBeClick=!1}async init(e,t,n){this.onEventCallback=t,this.clicker=new ClickGesturer(e.dragThreshold),this.longPress=new LongPressGesturer(t,e.holdThreshold),this.dragger=new DragGesturer(t,e.dragThreshold),this.pincher=new PinchGesturer(e.pinchThreshold),this.rotater=new RotateGesturer(e.rotateThreshold),this.multiswiper=new MultiSwipeGesturer(e.dragThreshold);const i=await n.getModuleBySymbol(N.y.CANVAS);e.disableWheel||this.bindWheelHandlers(i.element),this.inputDebug=new InputDebugMenu,this.inputDebug.init(n)}get activePointers(){return this.pointers.length}onPointerChange(e){this.isMoveEvent(e)?this.onPointerMove(e):this.onPointerButton(e)}isMoveEvent(e){return!e.hasOwnProperty("down")}onPointerMove(e){this.movePointer(e.id,e.position,e.clientPosition,e.buttons),this.inputDebug.movePointer(e.id,e.clientPosition)}onPointerButton(e){e.down?(this.addPointer(e.id,e.position,e.clientPosition,e.button),this.inputDebug.addPointer(e.id,e.clientPosition)):(this.removePointer(e.id,e.button),this.inputDebug.removePointer(e.id))}bindWheelHandlers(e){e.addEventListener("wheel",(e=>{e.preventDefault(),this.onEventCallback(new _.a({x:e.clientX,y:e.clientY},{x:this.normalizeWheelDelta(e.deltaMode,e.deltaX),y:this.normalizeWheelDelta(e.deltaMode,e.deltaY)}))}))}normalizeWheelDelta(e,t){if(e===WheelEvent.DOM_DELTA_LINE){return.7*t*t*t+13*t}return t}addPointer(e,t,n,i){const s=(0,o.AF)(i);if(!s)return;const r=this.getPointer(e);r&&0==(r.buttons&s)?(r.buttons|=s,r.activeButtons++):this.pointers.push({id:e,position:new g.Vector2(t.x,t.y),clientPosition:new g.Vector2(n.x,n.y),buttons:s,activeButtons:1}),this.toggleGestures()}removePointer(e,t){const n=(0,o.AF)(t);if(!n)return;const i=this.getPointerIndex(e);if(-1!==i){const e=this.pointers[i];0!=(e.buttons&n)&&(e.buttons&=~n,e.activeButtons--),e.activeButtons||this.pointers.splice(i,1),this.toggleGestures()}}movePointer(e,t,n,i){const s=this.getPointer(e);if(s)switch(s.position.copy(t),s.clientPosition.copy(n),s.buttons!==i?this.updateOffscreenPointer(s,i):this.onEventCallback(new C.h(this.pointers)),this.activeGesture){case D.CLICK_DRAG_LONGPRESS:const e=this.clicker.onMove(s);e&&this.onEventCallback(e);const t=this.dragger.onMove(s);t&&this.onEventCallback(t),this.longPress.onMove(s);break;case D.PINCH_ROTATE:const n=this.pincher.onMove(this.pointers[0],this.pointers[1]),i=this.rotater.onMove(this.pointers[0],this.pointers[1]);n&&this.onEventCallback(n),i&&this.onEventCallback(i);case D.MULTI_SWIPE_ONLY:const r=this.multiswiper.onMove(this.pointers);r&&this.onEventCallback(r)}}getPointer(e){const t=this.getPointerIndex(e);if(-1!==t)return this.pointers[t]}toggleGestures(){this.onEventCallback(new C.h(this.pointers));const e=this.activeGesture;if(this.activeGesture=this.pointers.length,e===D.CLICK_DRAG_LONGPRESS&&this.activeGesture===D.NONE&&this.couldBeClick){const e=this.clicker.stop();e&&this.onEventCallback(e)}if(this.couldBeClick=e===D.NONE&&this.activeGesture===D.CLICK_DRAG_LONGPRESS,this.activeGesture===D.CLICK_DRAG_LONGPRESS){const e=this.clicker.start(this.pointers[0]);e&&this.onEventCallback(e);const t=this.dragger.start(this.pointers[0]);t&&this.onEventCallback(t),this.longPress.start(this.pointers[0])}else if(e===D.CLICK_DRAG_LONGPRESS){const e=this.dragger.stop();this.longPress.stop(),this.onEventCallback(e)}this.activeGesture===D.PINCH_ROTATE?(this.pincher.start(this.pointers[0],this.pointers[1]),this.rotater.start(this.pointers[0],this.pointers[1]),this.multiswiper.start(this.pointers)):e===D.PINCH_ROTATE&&(this.onEventCallback(this.pincher.stop()),this.onEventCallback(this.rotater.stop()),this.onEventCallback(this.multiswiper.stop())),this.activeGesture===D.MULTI_SWIPE_ONLY?this.multiswiper.start(this.pointers):e===D.MULTI_SWIPE_ONLY&&this.onEventCallback(this.multiswiper.stop())}getPointerIndex(e){for(let t=0;t<this.pointers.length;t++){if(this.pointers[t].id===e)return t}return-1}updateOffscreenPointer(e,t){if(e.buttons=t,0===t){const t=this.getPointerIndex(e.id);this.pointers.splice(t,1),this.toggleGestures()}}tick(){this.longPress.tick()}}var I=n(89741),L=n(95847),P=n(82722);class InputSubscription{constructor(e,t,n){this._renew=e,this._cancel=t,this.active=n}renew(){this.active()||this._renew()}cancel(){this.active()&&this._cancel()}}class InputIni extends i.Y{constructor(){super(...arguments),this.name="input-ini",this.fallbackHandlerMap={},this.meshHandlerMap={},this.priorityHandlerMap={},this.unfilteredHandlerMap={},this.captureHandlerMap={},this.gesturing=!1,this.gestureCapture=new I.Z((e=>e.object.id)),this.activeIntersections=new I.Z((e=>e.object.id)),this.eventTypeLookup=new s.cj,this.meshTypeLookup=new s.cj,this.hoveredMesh={object:null,instanceId:void 0,index:void 0},this.registerUnfilteredHandler=(e,t)=>{this.insertHandler(e,this.unfilteredHandlerMap,t);const n=this.eventTypeLookup.getKeyByType(e);return new InputSubscription((()=>this.registerUnfilteredHandler(e,t)),(()=>this.unregisterUnfilteredHandler(e,t)),(()=>-1!==this.unfilteredHandlerMap[n].indexOf(t)))},this.registerMesh=(e,t,n)=>{this.raycaster.targets.addTarget(e,t,n)},this.unregisterMesh=e=>{this.raycaster.targets.removeTarget(e)},this.onPointerEvent=e=>{const t=!e.hasOwnProperty("down"),n=!t&&e.down,i=!n&&!t;if(t||n){this.raycaster.pointer.updatePointer(e.position),this.activeIntersections.clear();for(const e of this.raycaster.pointer.cast())this.activeIntersections.add(e);if(!this.gesturing){this.gestureCapture.clear();for(const e of this.activeIntersections)this.gestureCapture.add(e);this.updateHoveredMesh()}n&&(this.gesturing=!0),this.onEvent(e)}this.inputGesture.onPointerChange(e),i&&this.onEvent(e),0===this.inputGesture.activePointers&&(this.activeIntersections.clear(),this.gestureCapture.clear(),this.gesturing&&this.updateHoveredMesh(),this.gesturing=!1)},this.onEvent=e=>{const t=this.eventTypeLookup.getKeyByInstance(e),n=this.captureHandlerMap[t];if(n&&n.length>0){for(const t of n)t(e);return void(n.length=0)}const i=this.unfilteredHandlerMap[t];if(i)for(const t of i)t(e);const s=this.iterateMeshCallbacks(e,this.gesturing?this.gestureCapture:this.activeIntersections),r=this.fallbackHandlerMap[t];if(!s&&r)for(const t of r)t(e)}}async init(e,t){const n={disableWheel:!!e.disableWheel},i=await t.getModuleBySymbol(N.y.CANVAS),s=await t.market.waitForData(P.W);this.raycaster=await t.getModuleBySymbol(N.y.RAYCASTER),new InputPointer({pointerPreventDefault:e.pointerPreventDefault},i.element,s,this.onPointerEvent),new InputKey(this.onEvent),this.inputGesture=new InputGesture,this.inputGesture.init(n,this.onEvent,t)}registerHandler(e,t){this.insertHandler(e,this.fallbackHandlerMap,t);const n=this.eventTypeLookup.getKeyByType(e,!0);return new InputSubscription((()=>this.registerHandler(e,t)),(()=>this.unregisterHandler(e,t)),(()=>-1!==this.fallbackHandlerMap[n].indexOf(t)))}unregisterHandler(e,t){this.removeHandler(e,this.fallbackHandlerMap,t)}registerMeshHandler(e,t,n){return this._registerMeshHandler(e,{comparator:t,callback:n})}_registerMeshHandler(e,t){const n=this.eventTypeLookup.getKeyByType(e,!0);this.meshHandlerMap[n]||(this.meshHandlerMap[n]=[]);const i=this.meshHandlerMap[n];return i.push(t),new InputSubscription((()=>this._registerMeshHandler(e,t)),(()=>this.unregisterMeshHandler(e,t)),(()=>-1!==i.indexOf(t)))}unregisterMeshHandler(e,t){const n=this.eventTypeLookup.getKeyByType(e,!0);if(this.meshHandlerMap[n]){const e=this.meshHandlerMap[n],i=e.indexOf(t);i>-1&&e.splice(i,1)}}registerPriorityHandler(e,t,n){const i=this.eventTypeLookup.getKeyByType(e,!0),r=this.meshTypeLookup.getKeyByType(t,!0);this.priorityHandlerMap[i]||(this.priorityHandlerMap[i]={});const o=this.priorityHandlerMap[i];if(o[r]){const n=(0,s.z$)(e),i=(0,s.z$)(t);throw Error(`${n} already has a priority handler registered for mesh type: ${i}`)}return o[r]=n,new InputSubscription((()=>this.registerPriorityHandler(e,t,n)),(()=>this.unregisterPriorityHandler(e,t,n)),(()=>void 0!==o[r]))}unregisterPriorityHandler(e,t,n){const i=this.eventTypeLookup.getKeyByType(e),s=this.priorityHandlerMap[i];if(s){const e=this.meshTypeLookup.getKeyByType(t),i=s[e];i&&n===i&&delete s[e]}}unregisterUnfilteredHandler(e,t){this.removeHandler(e,this.unfilteredHandlerMap,t)}captureNext(e,t){return this.insertHandler(e,this.captureHandlerMap,t),t}removeCaptureHandler(e,t){this.removeHandler(e,this.captureHandlerMap,t)}registerSnappingMeshGeometry(e,t,n,i){this.raycaster.snapping.addMeshGeometry(e,t,n,i)}unregisterSnappingMeshGeometry(e){this.raycaster.snapping.removeMeshGeometry(e)}updateHoveredMesh(){const e=this.activeIntersections.getByIndex(0),t=e&&e.object===this.hoveredMesh.object&&e.instanceId===this.hoveredMesh.instanceId&&e.index===this.hoveredMesh.index;let n=!1;if(this.hoveredMesh.object&&(void 0===e||!t)){const t=this.getMeshHandler(L.A,(0,s.oL)(this.hoveredMesh.object),this.priorityHandlerMap);if(t&&(n=t(new L.A,this.hoveredMesh.object,e)||!1),!n){const t=this.meshHandlerMap[this.eventTypeLookup.getKeyByType(L.A)];if(t)for(const n of t)n.comparator.compare(this.hoveredMesh.object)&&n.callback(new L.A,this.hoveredMesh.object,e)}}let i=!1;if(e&&!t){const t=this.getMeshHandler(L.z,(0,s.oL)(e.object),this.priorityHandlerMap);if(t&&(i=t(new L.z,e.object,e)||!1),!i){const t=this.meshHandlerMap[this.eventTypeLookup.getKeyByType(L.z)];if(t)for(const n of t)n.comparator.compare(e.object)&&n.callback(new L.z,e.object,e)}}this.hoveredMesh.object=e&&e.object||null,this.hoveredMesh.instanceId=null==e?void 0:e.instanceId,this.hoveredMesh.index=null==e?void 0:e.index}iterateMeshCallbacks(e,t){let n=!1;const i=this.eventTypeLookup.getKeyByInstance(e);for(let s=0;s<t.count();s++){const r=t.getByIndex(s);if(!r)continue;if(n)break;const o=r.object,a=this.activeIntersections.get(o.id)||r;for(const t in this.priorityHandlerMap[i])if(r.object instanceof this.meshTypeLookup.getTypeByKey(t)){const s=this.priorityHandlerMap[i]&&this.priorityHandlerMap[i][t];if(s&&(n=!0,s(e,o,a)))return!0}const l=this.meshHandlerMap[i];if(l)for(const t of l)if(t.comparator.compare(o)){const i=t.callback(e,o,a);(i||void 0===i)&&(n=!0)}}return n}insertHandler(e,t,n){const i=this.eventTypeLookup.getKeyByType(e,!0);t[i]||(t[i]=[]),t[i].push(n)}removeHandler(e,t,n){const i=t[this.eventTypeLookup.getKeyByType(e)];if(i)for(let e=0;e<i.length;e++)if(i[e]===n){i.splice(e,1);break}}getMeshHandler(e,t,n){const i=n[this.eventTypeLookup.getKeyByType(e)];if(i){return i[this.meshTypeLookup.getKeyByType(t)]}return null}onUpdate(){this.inputGesture.tick()}}},94113:(e,t,n)=>{"use strict";n.d(t,{e:()=>KeyEvent});var i=n(59017);class KeyEvent extends i.G{constructor(e,t,n){super(),this.key=e,this.state=t,this.modifiers=n}}},19926:(e,t,n)=>{"use strict";var i;n.d(t,{M:()=>i}),function(e){e[e.DOWN=0]="DOWN",e[e.PRESSED=1]="PRESSED",e[e.UP=2]="UP"}(i||(i={}))},43985:(e,t,n)=>{"use strict";var i;n.d(t,{R:()=>i}),function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.RETURN=13]="RETURN",e[e.SHIFT=16]="SHIFT",e[e.CONTROL=17]="CONTROL",e[e.ALT=18]="ALT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.HASH=35]="HASH",e[e.LEFTARROW=37]="LEFTARROW",e[e.UPARROW=38]="UPARROW",e[e.RIGHTARROW=39]="RIGHTARROW",e[e.DOWNARROW=40]="DOWNARROW",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.AT=64]="AT",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.SEMICOLON=186]="SEMICOLON",e[e.PLUSEQUALS=187]="PLUSEQUALS",e[e.DASHUNDERSCORE=189]="DASHUNDERSCORE",e[e.OPENBRACKET=219]="OPENBRACKET"}(i||(i={}))},8054:(e,t,n)=>{"use strict";var i,s;n.d(t,{MP:()=>i,r3:()=>s,AF:()=>r,L2:()=>o}),function(e){e[e.PRIMARY=0]="PRIMARY",e[e.MIDDLE=1]="MIDDLE",e[e.SECONDARY=2]="SECONDARY",e[e.BACK=3]="BACK",e[e.FORWARD=4]="FORWARD",e[e.COUNT=5]="COUNT"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.PRIMARY=1]="PRIMARY",e[e.SECONDARY=4]="SECONDARY",e[e.MIDDLE=2]="MIDDLE",e[e.BACK=8]="BACK",e[e.FORWARD=16]="FORWARD",e[e.ALL=31]="ALL"}(s||(s={}));const r=e=>{const t=s[i[e]];return"number"==typeof t?t:void 0},o=e=>{const t=i[s[e]];return"number"==typeof t?t:void 0}},70399:(e,t,n)=>{"use strict";n.d(t,{_A:()=>i,er:()=>PointerButtonEvent,mE:()=>PointerMoveEvent});var i,s=n(59017);class PointerEvent extends s.G{}!function(e){e.MOUSE="mouse",e.TOUCH="touch",e.PEN="pen",e.GAMEPAD="gamepad"}(i||(i={}));class PointerButtonEvent extends PointerEvent{constructor(e,t,n,i,s,r){super(),this.id=e,this.position=t,this.clientPosition=n,this.button=i,this.down=s,this.device=r}}class PointerMoveEvent extends PointerEvent{constructor(e,t,n,i,s){super(),this.id=e,this.position=t,this.clientPosition=n,this.buttons=i,this.device=s}}},51167:(e,t,n)=>{"use strict";var i,s;n.d(t,{s:()=>i,f:()=>s}),function(e){e.Desktop="desktop",e.Mobile="mobile",e.VrOrientOnly="xr.orientonly",e.VrWithController="xr.controller",e.VrWithTrackedController="xr.trackedcontroller"}(i||(i={})),function(e){e.None="interaction.none",e.Direct="interaction.direct",e.Key="interaction.key",e.Gui="interaction.gui",e.Mouse="interaction.mouse",e.Touch="interaction.touch",e.Pen="interaction.pen",e.XRController="interaction.xr.controller",e.XRGaze="interaction.xr.gaze",e.XRScreen="interaction.xr.screen"}(s||(s={}))},59057:(e,t,n)=>{"use strict";n.d(t,{Z:()=>InteractionmodeData});var i=n(35424),s=n(51167);class InteractionmodeData extends i.V{constructor(){super(...arguments),this.name="interaction",this._source=InteractionmodeData.defaultSource,this._mode=InteractionmodeData.defaultMode}static get defaultMode(){return s.s.Desktop}static get defaultSource(){return s.f.None}get mode(){return this._mode}get source(){return this._source}updateSource(e){this._source=e}updateMode(e){this._mode=e}hasController(e=this.mode){return e===s.s.VrWithController||e===s.s.VrWithTrackedController}isVR(e=this.mode){return e===s.s.VrOrientOnly||e===s.s.VrWithController||e===s.s.VrWithTrackedController}isMobile(e=this.mode){return e===s.s.Mobile}}},18961:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>InteractionModeModule});var i=n(57227),s=n(14877),r=n(70399),o=n(94113),a=n(59057),l=n(51167),c=n(36742),d=n(2252);class InteractionModeModule extends i.Y{constructor(){super(...arguments),this.name="interactionmode",this.onPointerButtonEvent=e=>{let t=this.data.source;switch(e.device){case r._A.TOUCH:t=l.f.Touch;break;case r._A.MOUSE:t=l.f.Mouse;break;case r._A.PEN:t=l.f.Pen;break;case r._A.GAMEPAD:this.renderer.xr.enabled&&this.renderer.xr.isPresenting&&(t=l.f.XRController);break;default:this.log.debug("source:",e.device,e)}this.updateSource(t)},this.onKeyEvent=()=>{this.updateSource(l.f.Key)}}async init(e,t){this.engine=t,this.data=new a.Z,this.mobileBrowser=(0,d.tq)();const n=await t.getModuleBySymbol(s.y.WEBGL_RENDERER);this.renderer=n.threeRenderer,this.updateMode(this.getInteractionMode(),this.data.mode),this.engine.market.register(this,a.Z,this.data),t.getModuleBySymbol(s.y.INPUT).then((e=>{this.bindings.push(e.registerHandler(r.er,this.onPointerButtonEvent),e.registerHandler(o.e,this.onKeyEvent))}))}onUpdate(e){const t=this.getInteractionMode();this.updateMode(t,this.data.mode)}getInteractionMode(){if(this.renderer.xr.enabled&&this.renderer.xr.isPresenting){const e=this.renderer.xr.getSession();if(null!==e&&e.inputSources.length>0)switch(e.inputSources[0].targetRayMode){case"gaze":case"screen":return l.s.VrOrientOnly;case"tracked-pointer":return l.s.VrWithTrackedController}return l.s.VrOrientOnly}return this.mobileBrowser?l.s.Mobile:l.s.Desktop}updateMode(e,t){e!==this.data.mode&&(this.data.updateMode(e),this.data.commit(),this.engine.broadcast(new c.m(this.data.mode,t)))}updateSource(e){e!==this.data.source&&(this.data.updateSource(e),this.data.commit(),this.engine.broadcast(new c.a(this.data.source)))}}},36742:(e,t,n)=>{"use strict";n.d(t,{m:()=>InteractionModeChangeMessage,a:()=>InteractionSourceChangeMessage});var i=n(4117);class InteractionModeChangeMessage extends i.v{constructor(e,t){super(),this.mode=e,this.fromMode=t}}class InteractionSourceChangeMessage extends i.v{constructor(e){super(),this.source=e}}},88507:(e,t,n)=>{"use strict";n.d(t,{D:()=>LabelData});var i=n(35424),s=n(66910),r=n(81402);const o=new(n(5477).Z)("label-data");class LabelData extends i.V{constructor(e){super(),this.name="label",this.has=e=>this.map.has(e),this.getLabel=e=>this.map.get(e),this.map=(0,s.q)(e||{})}getCount(){return this.map.length}add(e){let t=e.sid;return this.map.has(t)&&o.warn("Label already tracked:",{sid:t,label:e,existing:this.getLabel(t)}),t=t||this.generateSid(),e.sid=t,e.commit(),this.map.set(e.sid,e),t}generateSid(){let e="";for(;!e||this.map.has(e);)e=(0,r.O1)(11);return e}remove(e){return!!this.map.has(e)&&(this.map.delete(e),!0)}clear(){for(const e of this.map.keys)this.map.delete(e)}getCollection(){return this.map}iterate(e){for(const t of this.map.keys)e(this.map.get(t),t)}isEqual(e){if(this.map.length!==e.map.length)return!1;for(const t of this.map){const n=e.map.get(t.sid);if(!n||!LabelData.labelsAreEqual(t,n))return!1}return!0}static labelsAreEqual(e,t){return e.floorId===t.floorId&&e.roomId===t.roomId&&e.position.x===t.position.x&&e.position.y===t.position.y&&e.position.z===t.position.z&&e.sid===t.sid&&e.text===t.text&&e.floorId===t.floorId&&e.roomId===t.roomId&&e.visible===t.visible}getLabelsForRoom(e){const t=[];return this.iterate((n=>{n.roomId===e&&t.push(n)})),t}}},65453:(e,t,n)=>{"use strict";n.d(t,{Nj:()=>i,Cu:()=>s});const i="features/labels",s="features/3d_labels_enabled"},98142:(e,t,n)=>{"use strict";n.d(t,{V:()=>RTLDisabledRoomnavMessage});var i=n(4117);class RTLDisabledRoomnavMessage extends i.v{}},67233:(e,t,n)=>{"use strict";n.d(t,{R:()=>LayersData});var i=n(35424),s=n(5477),r=n(29984),o=n(5005),a=n(21396);const l=new s.Z("layers-data");class LayersData extends i.V{constructor(e){super(),this.currentViewId="",this.initialViewId="",this.initialViewId=e.id,this.viewsObservable=(0,r.C)([e]),this.setCurrentView(e.id)}setCurrentView(e){if(e===this.currentViewId)return;const t=this.getView(e);if(!t)throw new o.SN("Model View not found");l.debug(`Active view set to ${e} (${t.viewType})`),this.currentViewId=e,this.commit()}getCurrentView(){const e=this.getView(this.currentViewId);if(!e)throw new o.SN("Missing current model view");return e}getCurrentViewId(){return this.currentViewId}getInitialView(){const e=this.getView(this.initialViewId);if(!e)throw new o.SN("Missing initial model view");return e}addView(e){this.viewsObservable.push(e)}canDeleteView(e){const t=this.getView(e);return t&&t.viewType===a.X.USER}canDeleteActiveView(){return this.canDeleteView(this.getCurrentViewId())}getViewName(e,t,n){const i=this.getView(e);if(!i)throw new o.SN(`Model View not found: ${e}`);return i.name?i.name:i.viewType===a.X.BASE?n:t}setViews(e){this.viewsObservable.replace(e)}getView(e){const t=this.viewsObservable.find((t=>t.id===e));if(!t)throw new o.SN(`Model View not found: ${e}`);return t}deleteView(e){const t=this.viewsObservable.findIndex((t=>t.id===e));-1!==t&&this.viewsObservable.remove(t)}getStandardModelViews(){return this.viewsObservable.filter((e=>e.viewType===a.X.BASE||e.viewType===a.X.USER))}onModelViewsChanged(e){return this.viewsObservable.onChanged(e)}getWorkshopSessionView(){return this.viewsObservable.find((e=>e.viewType===a.X.SESSION))}getBaseModelView(){return this.viewsObservable.find((e=>e.viewType===a.X.BASE))}getBaseModelId(){var e;return(null===(e=this.getBaseModelView())||void 0===e?void 0:e.id)||this.initialViewId}}},37614:(e,t,n)=>{"use strict";n.d(t,{wG:()=>SetActiveModelViewCommand,Bv:()=>AddUserViewCommand,qP:()=>DeleteUserViewCommand});var i=n(93037);class SetActiveModelViewCommand extends i.m{constructor(e){super(),this.id="SET_MODEL_VIEW_COMMAND",this.payload={viewId:e}}}class AddUserViewCommand extends i.m{constructor(e){super(),this.id="ADD_USER_VIEW_COMMAND",this.payload={name:e}}}class DeleteUserViewCommand extends i.m{constructor(e){super(),this.id="DELETE_USER_VIEW_COMMAND",this.payload={id:e}}}},21396:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i}),function(e){e.BASE="base",e.TRUEPLAN="trueplan",e.SESSION="session",e.USER="user",e.SYNDICATION="syndication"}(i||(i={}))},81658:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var i=n(67294),s=n(53033);function r(){const e=(0,s._)(),[t,n]=(0,i.useState)((null==e?void 0:e.getCurrentView())||void 0);return(0,i.useEffect)((()=>{if(!e)return()=>{};function t(){n((null==e?void 0:e.getCurrentView())||void 0)}const i=e.onPropertyChanged("currentViewId",t);return t(),()=>i.cancel()}),[e]),t}},53033:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(20302),s=n(67233);const r=(0,i.u)(s.R)},93590:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var i=n(67294),s=n(53033);function r(){const e=(0,s._)(),[t,n]=(0,i.useState)((null==e?void 0:e.getStandardModelViews())||[]);return(0,i.useEffect)((()=>{if(!e)return()=>{};function t(){n((null==e?void 0:e.getStandardModelViews())||[])}const i=e.onModelViewsChanged(t);return t(),()=>i.cancel()}),[e]),t}},76061:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddUserViewCommand:()=>i.Bv,DeleteUserViewCommand:()=>i.qP,LayersData:()=>o.R,LayersModule:()=>LayersModule,LayersViewError:()=>LayersViewError,ModelView:()=>ModelView,ModelViewType:()=>s.X,SetActiveModelViewCommand:()=>i.wG,default:()=>LayersModule});var i=n(37614),s=n(21396),r=n(40603);class LayersViewError extends r.y{constructor(e,t="80001"){super(e),this.name="LayersViewError",this.code=t}}var o=n(67233),a=n(57227);var l=n(61903),c=n(66225),d=n(97236),u=n(34612),h=n(23676);class ModelView{constructor(e={}){this.viewType=null,this.rawViewType="",this.name="",Object.assign(this,e)}}var p=n(33669),m=n(5005),f=n(38636),g=n(5477);const v=new g.Z("mds-modelview-deserializer");class ModelViewDeserializer{deserialize(e){return e&&e.id&&e.type?new ModelView({id:e.id,viewType:this.getModelViewType(e),rawViewType:e.type,name:e.name||""}):(v.debug("Deserialized invalid ModelView data from MDS",e),null)}getModelViewType(e){const t={"matterport.workshop.session":s.X.SESSION,"matterport.model.default":s.X.BASE,"trueplan.session":s.X.TRUEPLAN,"matterport.user.view":s.X.USER,"matterport.syndication":s.X.SYNDICATION};return e.type in t?t[e.type]:null}}var y=n(53306),b=n(12621);const S=new g.Z("MdsModelViewStore");class MdsModelViewStore extends c.u{constructor(e){super(e),this.prefetchKey=b.SJ,this.deserializer=new ModelViewDeserializer}async read(){if(!this.viewId)throw new m.SN("Cannot read Views, no initial view configured");const e=await this.query(y.GetViews,{modelId:this.viewId}).catch((e=>{throw new m.Zb(e)})),t=(0,f.q)(e,"data.model.views"),n=[];if(t)for(const e of t){const t=this.deserializer.deserialize(e);t&&n.push(t)}return n}async create(e){const t=c.u.baseViewId;return this.mutate(y.AddUserView,{modelId:t,name:e}).then((e=>this.deserializer.deserialize((0,f.q)(e,"data.addView"))))}async delete(e){const t=c.u.baseViewId;if(e===t)throw new m.SN("Cannot delete the base view");const n=await this.mutate(y.DeleteUserView,{modelId:t,viewId:e}),i=(0,f.q)(n,"data.deleteView")||!1;return i||S.error("View deletion failed!"),i}}class LayersModule extends a.Y{constructor(){super(...arguments),this.name="layers"}async init(e,t){const{baseUrl:n,inWorkshop:s,viewId:r}=e,[a]=await Promise.all([t.market.waitForData(l.e)]);this.settingsData=a,this.config=e,this.store=new MdsModelViewStore({readonly:!s,baseUrl:n,viewId:r}),this.engine=t,this.data=new o.R(new ModelView({id:r})),await this.loadViews(),this.setInitialView();const u=this.data.getBaseModelId();c.u.setBaseViewId(u),d.U.setBaseViewId(u),this.bindings.push(t.commandBinder.addBinding(i.wG,(e=>this.setActiveModelView(e.viewId)))),s&&this.bindings.push(t.commandBinder.addBinding(i.Bv,(e=>this.addUserView(e.name))),t.commandBinder.addBinding(i.qP,(e=>this.deleteUserView(e.id)))),t.market.register(this,o.R,this.data)}setInitialView(){const{viewId:e,inWorkshop:t}=this.config;let n=e;if(!this.settingsData.tryGetProperty(p.In,!1)&&((i=n)&&11===i.length)&&t){const e=this.data.getWorkshopSessionView();e?n=e.id:this.log.warn("No workshop session view")}var i;this.setActiveModelView(n)}async loadViews(){const e=await this.store.read();e.length>0&&(this.data.setViews(e),this.log.debug("Loaded views",e))}async setActiveModelView(e){if(e===this.data.getCurrentViewId())return;const t=this.data.getView(e);t?(this.log.debug(`Switching to default view type '${t.viewType}'`),c.u.setCurrentViewId(e),this.data.setCurrentView(t.id)):this.log.warn(`Missing model view '${e}'`)}async addUserView(e){if(!this.settingsData.tryGetProperty(p.In,!1))return void this.log.debug("Layers not enabled");const t=await this.store.create(e);t&&(this.data.addView(t),this.log.debug("Added new view"),this.setActiveModelView(t.id),this.engine.commandBinder.issueCommand(new u.tT(h.w1.LAYERS,!0)))}async deleteUserView(e){if(!this.settingsData.tryGetProperty(p.In,!1))return void this.log.debug("Layers not enabled");if(!this.data.canDeleteView(e))throw new LayersViewError("Cannot delete model view");const t=e===this.data.currentViewId;await this.store.delete(e)&&this.data.atomic((()=>{if(this.data.deleteView(e),this.log.debug("Deleted user view"),t){const e=this.data.getBaseModelId();if(!e)throw new LayersViewError("No base view");this.setActiveModelView(e)}}))}}},33669:(e,t,n)=>{"use strict";n.d(t,{In:()=>i});const i="layers"},13462:(e,t,n)=>{"use strict";n.d(t,{c:()=>LineSegment});var i=n(2212),s=n(26517),r=n(77136);class LineEndpoint extends i.Mesh{constructor(e,t,n=r.V9.endpointSelected,i=r.V9.endpointDefault){super(e,t),this.selectedSize=n,this.defaultSize=i,this.currentSize=r.V9.endpointDefault,this.currentSize=this.defaultSize,this.scale.set(r.Ey,r.Ey,r.Ey)}dispose(){this.material.dispose(),this.geometry.dispose()}billboardScale(e,t,n){const i=(0,s.mY)(t,e,this.position,n,.5),o=Math.max(Math.min(1/i*this.currentSize,r.g4),r.Ey);this.scale.set(o,o,o)}updateSelected(e){this.currentSize=e?this.selectedSize:this.defaultSize}}var o=n(6436),a=n(82919),l=n(99295),c=n(28845),d=n(19945);class LineSegment{constructor(e,t,n,r,u){this.lineMaterial=n,this.options=r,this.endpointMaterial=u,this.startPosition=new i.Vector3,this.endPosition=new i.Vector3,this.endpoints=!1,this.isVisible=!0,this.meshToLinePartMap={},this.opacity=e=>(this.endpointMaterial&&this.endpointMaterial.setOpacity(e),this.lineMesh.material.setOpacity(e),this),this.updatePositions=(e,t)=>(this.startPosition.copy(e),this.endPosition.copy(t),this.options.beforeUpdatePositions&&(e=this.options.beforeUpdatePositions(e),t=this.options.beforeUpdatePositions(t)),this.lineMesh.geometry.setPositions([e.x,e.y,e.z,t.x,t.y,t.z]),this.endpoints&&(this.endMesh.position.copy(t),this.startMesh.position.copy(e),this.lastBillboardOptions&&this.updateBillboard(this.lastBillboardOptions)),this.lineMesh.material.dashed&&this.lineMesh.computeLineDistances(),this),this.updateBillboard=e=>{if(this.endpoints&&(e.rotation&&(this.endMesh.quaternion.copy(e.rotation),this.startMesh.quaternion.copy(e.rotation)),e.position&&e.projection&&!(0,s.s1)(e.projection))){const t=this.lineMesh.material.resolution.y;this.endMesh.billboardScale(e.position,e.projection,t),this.startMesh.billboardScale(e.position,e.projection,t)}return this.lastBillboardOptions=e,this},this.updateSelected=e=>(this.lineMesh.material.updateSelected(e),this.endpoints&&(this.endMesh.material.updateHovered(e),this.endMesh.updateSelected(e),this.startMesh.updateSelected(e)),this),this.setRenderLayer=e=>{this.children.forEach((t=>t.layers.mask=e.mask))},this.setRenderOrder=e=>{this.children.forEach((t=>t.renderOrder=e))},this.updateResolution=(e,t)=>(this.lineMesh.material.resolution.set(e,t),this),this.hide=()=>{this.options.onHide&&this.options.onHide(),this.isVisible=!1},this.show=()=>{this.options.onShow&&this.options.onShow(),this.isVisible=!0},this.toggle=e=>(e?this.show():this.hide(),this),this.dispose=()=>{this.options.onHide&&this.options.onHide(),this.lineMesh.geometry.dispose(),this.lineMesh.material.dispose(),this.endMesh&&this.endMesh.dispose(),this.startMesh&&this.startMesh.dispose(),this.meshToLinePartMap={}},this.overrideLineMaterial=e=>{this.lineMesh.material=e},this.restoreLineMaterial=()=>{this.lineMesh.material=this.lineMaterial},this.startPosition.copy(e),this.endPosition.copy(t),this.lineMesh=new o.x(new a.L,n),this.lineMesh.matrixAutoUpdate=!1,this.lineMesh.part=c.B.line,this.lineMesh.renderOrder=l.z.lines,this.meshToLinePartMap[c.B.line]=this.lineMesh,u&&(this.endpoints=!0,this.endMesh=new LineEndpoint((0,d.fc)(),u),this.endMesh.part=c.B.end,this.endMesh.renderOrder=l.z.endpoints,this.meshToLinePartMap[c.B.end]=this.endMesh,this.startMesh=new LineEndpoint((0,d.fc)(),u),this.startMesh.part=c.B.start,this.startMesh.renderOrder=l.z.endpoints,this.meshToLinePartMap[c.B.start]=this.startMesh),this.updatePositions(this.startPosition,this.endPosition),this.updateSelected(!1)}get currentOpacity(){return this.lineMesh.material.getOpacity()}getMesh(e){return this.meshToLinePartMap[e]}get children(){return Object.keys(this.meshToLinePartMap).map((e=>this.meshToLinePartMap[e]))}get visible(){return this.isVisible}}},28845:(e,t,n)=>{"use strict";var i;n.d(t,{B:()=>i}),function(e){e.line="line",e.start="start",e.end="end"}(i||(i={}))},4400:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Lines});var i,s=n(57227),r=n(14877),o=n(2212),a=n(13462),l=n(89034),c=n(91975),d=n(40886),u=n(71370),h=n(88296);!function(e){e[e.LINE_DEFAULT=0]="LINE_DEFAULT",e[e.LINE_HOVER=1]="LINE_HOVER",e[e.END_DEFAULT=2]="END_DEFAULT",e[e.END_HOVER=3]="END_HOVER"}(i||(i={}));class LineTextures{constructor(){const e=(0,l.p)(c),t=(0,l.p)(d),n=(0,l.p)(u),s=(0,l.p)(h);this.textures={[i.LINE_DEFAULT]:n,[i.LINE_HOVER]:s,[i.END_DEFAULT]:e,[i.END_HOVER]:t},n.minFilter=o.LinearFilter,s.minFilter=o.LinearFilter,e.minFilter=o.LinearFilter,t.minFilter=o.LinearFilter}get(e){return this.textures[e]}dispose(){for(const e in this.textures){const t=Number(e);this.get(t).dispose()}}}var p=n(97137);class LineEndpointMaterial extends o.RawShaderMaterial{constructor(e,t,n){const i=o.UniformsUtils.clone(p.T.endpoint.uniforms);super({fragmentShader:p.T.endpoint.fragmentShader,vertexShader:p.T.endpoint.vertexShader,uniforms:i,name:"LineEndpointMaterial",transparent:!0,depthWrite:!1,depthTest:!0}),this.color=e,this.defaultTex=t,this.hoverTex=n,this.uniforms.bg.value=t,this.uniforms.color.value.copy(this.color)}clone(){return new LineEndpointMaterial(this.color,this.defaultTex,this.hoverTex).copy(this)}setOpacity(e){this.uniforms&&e!==this.uniforms.opacity.value&&(this.uniforms.opacity.value=e)}getOpacity(){return this.uniforms.opacity.value}updateHovered(e){const t=e?this.hoverTex:this.defaultTex;this.uniforms.bg.value!==t&&(this.uniforms.bg.value=t)}}var m=n(36173),f=n(15099),g=n(83804),v=n(82722),y=n(77136);class Lines extends s.Y{constructor(){super(...arguments),this.name="lines",this.makeLineMaterial=(e,t,n={},i,s)=>Lines.makeLineMaterial(e,t,n,i,s),this.makeEndpointMaterial=(e,t,n)=>Lines.makeEndpointMaterial(e,t,n),this.onCanvasChange=e=>{for(const t of this.segments)t.updateResolution(e.width,e.height)}}static get textures(){return Lines._textures||(Lines._textures=new LineTextures),Lines._textures}async init(e,t){Lines._textures||(Lines._textures=new LineTextures);const n=await t.getModuleBySymbol(r.y.WEBGL_RENDERER);this.scene=n.getScene(),this.canvas=await t.market.waitForData(v.W),this.cameraData=await t.market.waitForData(f.M_),this.bindings.push(this.canvas.onChanged(this.onCanvasChange)),this.cameraPosition=new o.Vector3,this.segments=[]}onUpdate(){this.cameraPosition.copy(this.cameraData.pose.position)}dispose(e){super.dispose(e),this.segments.forEach((e=>e.dispose()))}makeLine(e,t,n,i,s=(()=>!1)){const r=s()?y.iV.OFFSET_TOWARDS_CAMERA:0,o=s()?e=>this.cameraPosition.clone().sub(e).setLength(r).add(e):e=>e,l=new a.c(e,t,n,{beforeUpdatePositions:o,onShow:()=>l.children.forEach((e=>this.scene.addChild(g.a.Root,e))),onHide:()=>l.children.forEach((e=>this.scene.removeChild(g.a.Root,e)))},i);return l.updateResolution(this.canvas.width,this.canvas.height),l.opacity(1),l.show(),l.updatePositions(e,t),this.segments.push(l),l}}Lines.makeLineMaterial=(e,t,n={},s,r)=>{const a=r||Lines.textures.get(i.LINE_HOVER),l=s||Lines.textures.get(i.LINE_DEFAULT),c=new o.Vector2(window.innerWidth,window.innerHeight);return t?new m.Y(Object.assign({color:new o.Color(e),resolution:c},n),a,l):new m.Y(Object.assign({color:new o.Color(e)},n))},Lines.makeEndpointMaterial=(e,t,n)=>{const s=n||Lines.textures.get(i.END_HOVER),r=t||Lines.textures.get(i.END_DEFAULT);return new LineEndpointMaterial(new o.Color(e),r,s)}},6436:(e,t,n)=>{"use strict";n.d(t,{x:()=>Line});var i=n(2212),s=n(28845);class Line extends i.Mesh{constructor(e,t){super(),this.type="Line",this.part=s.B.line,this.computeLineDistances=(()=>{const e=new i.Vector3,t=new i.Vector3;return()=>{const n=this.geometry,s=n.attributes.instanceStart,r=n.attributes.instanceEnd,o=new Float32Array(2*s.data.count);for(let n=0,i=0,a=s.data.count;n<a;n++,i+=2)e.fromBufferAttribute(s,n),t.fromBufferAttribute(r,n),o[i]=0===i?0:o[i-1],o[i+1]=o[i]+e.distanceTo(t);return this.instanceDistanceBuffer?(this.instanceDistanceBuffer.set(o,0),this.instanceDistanceBuffer.needsUpdate=!0):(this.instanceDistanceBuffer=new i.InstancedInterleavedBuffer(o,2,1),n.setAttribute("instanceDistanceStart",new i.InterleavedBufferAttribute(this.instanceDistanceBuffer,1,0,!1)),n.setAttribute("instanceDistanceEnd",new i.InterleavedBufferAttribute(this.instanceDistanceBuffer,1,1,!1))),this}})(),this.geometry=e,this.material=t}copy(e){throw Error("not implemented")}}},82919:(e,t,n)=>{"use strict";n.d(t,{L:()=>LineGeometry});var i=n(86464);class LineGeometry extends i.z{constructor(){super(),this.type="LineGeometry",this.isLineGeometry=!0}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return i.z.prototype.setPositions.call(this,n),this}setColors(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return i.z.prototype.setColors.call(this,n),this}fromLine(e){throw new Error("LineGeometry.fromLine not converted to TS yet")}copy(e){return this}}},36173:(e,t,n)=>{"use strict";n.d(t,{Y:()=>LineMaterial});var i=n(2212),s=n(97137),r=n(77136);class LineMaterial extends i.RawShaderMaterial{constructor(e,t,n,o=r.V9.lineSelected){super(),this.parameters=e,this.hoverTexture=t,this.defaultTexture=n,this.selectedWidth=o,this.type="LineMaterial",this.isLineMaterial=!0,this.defaultWidth=r.V9.lineDefault,this.setValues({uniforms:i.UniformsUtils.clone(s.T.line.uniforms),vertexShader:s.T.line.vertexShader,fragmentShader:s.T.line.fragmentShader,transparent:!0,depthWrite:!1,depthTest:!0,opacity:1}),this.setValues(e),n&&(this.mask=n),this.defaultWidth=e&&e.linewidth?e.linewidth:r.V9.lineDefault}updateSelected(e){const t=e?this.hoverTexture:this.defaultTexture;t&&this.mask!==t&&(this.mask=t,e?this.setLinewidth(this.selectedWidth):this.setLinewidth(this.defaultWidth))}setLinewidth(e){this.uniforms.linewidth||(this.uniforms=i.UniformsUtils.clone(s.T.line.uniforms)),this.getLinewidth()!==e&&(this.uniforms.linewidth.value=e)}getLinewidth(){return this.uniforms.linewidth.value}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}getOpacity(){return this.uniforms.opacity.value}setOpacity(e){this.uniforms||(this.uniforms=i.UniformsUtils.clone(s.T.line.uniforms)),this.getOpacity()!==e&&(this.uniforms.opacity.value=e)}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}set dashed(e){e?this.defines.USE_DASH="":delete this.defines.USE_DASH,this.needsUpdate=!0}get dashed(){return"USE_DASH"in this.defines}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value=e}set mask(e){this.uniforms.mask.value!==e&&(e?this.defines.USE_MASK="":delete this.defines.USE_MASK,this.uniforms.mask.value=e,this.needsUpdate=!0)}get mask(){return this.uniforms.mask.value}copy(e){return i.RawShaderMaterial.prototype.copy.call(this,e),this.parameters=e.parameters,this.color.copy(e.color),this.defaultWidth=e.defaultWidth,this.setLinewidth(e.getLinewidth()),this.resolution.copy(e.resolution),this.defaultTexture=e.defaultTexture,this.hoverTexture=e.hoverTexture,this.mask=e.mask,this.setOpacity(e.getOpacity()),this.dashed=e.dashed,this.dashScale=e.dashScale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}},86464:(e,t,n)=>{"use strict";n.d(t,{z:()=>LineSegmentsGeometry});var i=n(2212);class LineSegmentsGeometry extends i.InstancedBufferGeometry{constructor(){super(),this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new i.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new i.Float32BufferAttribute([0,1,.5,1,0,.5,.5,.5,0,0,.5,0,0,1,.5,1],2))}applyMatrix(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),n.applyMatrix4(e),this.positionBuffer.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;return e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e)),t&&(this.positionBuffer?(this.positionBuffer.set(t,0),this.positionBuffer.needsUpdate=!0):(this.positionBuffer=new i.InstancedInterleavedBuffer(t,6,1),this.setAttribute("instanceStart",new i.InterleavedBufferAttribute(this.positionBuffer,3,0,!1)),this.setAttribute("instanceEnd",new i.InterleavedBufferAttribute(this.positionBuffer,3,3,!1))),this.computeBoundingBox(),this.computeBoundingSphere()),this}setColors(e){let t;return e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e)),t&&(this.colorBuffer?(this.colorBuffer.set(t,0),this.colorBuffer.needsUpdate=!0):(this.colorBuffer=new i.InstancedInterleavedBuffer(t,6,1),this.setAttribute("instanceColorStart",new i.InterleavedBufferAttribute(this.colorBuffer,3,0,!1)),this.setAttribute("instanceColorEnd",new i.InterleavedBufferAttribute(this.colorBuffer,3,3,!1)))),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new i.WireframeGeometry(e.geometry)),this}fromLineSegements(e){const t=e.geometry;return t instanceof i.BufferGeometry&&this.setPositions(t.position.array),this}computeBoundingBox(){this.boundingBox||(this.boundingBox=new i.Box3),this.box||(this.box=new i.Box3);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),this.box.setFromBufferAttribute(t),this.boundingBox.union(this.box))}computeBoundingSphere(){this.tempVector||(this.tempVector=new i.Vector3),this.boundingSphere||(this.boundingSphere=new i.Sphere),this.boundingBox||this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let s=0,r=e.count;s<r;s++)this.tempVector.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(this.tempVector)),this.tempVector.fromBufferAttribute(t,s),i=Math.max(i,n.distanceToSquared(this.tempVector));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}},97137:(e,t,n)=>{"use strict";n.d(t,{T:()=>s});var i=n(2212);const s={endpoint:{uniforms:{opacity:{type:"f",value:1},color:{type:"c",value:new i.Color},bg:{type:"t",value:null}},vertexShader:n(64656),fragmentShader:n(33404)},line:{uniforms:i.UniformsUtils.merge([i.UniformsLib.common,i.UniformsLib.fog,{linewidth:{value:4},resolution:{value:new i.Vector2(0,0)},dashScale:{value:1},dashSize:{value:.025},gapSize:{value:.05},mask:{value:null}}]),vertexShader:n(86676),fragmentShader:n(42154)}}},77136:(e,t,n)=>{"use strict";n.d(t,{iV:()=>i,V9:()=>s,Ey:()=>r,g4:()=>o});const i={FADE_DURATION:300,LABEL_HIDDEN_OPACITY:.15,DEPTH_WRITE_THRESHOD:.15,ALIGN_LABELS:!1,LABEL_SIZING:.14,LABEL_NDC_SCALEFACTOR:.5,LABEL_ASPECT_SCALEFACTOR:.035,OFFSET_TOWARDS_CAMERA:.25,HIDE_LABELS:!1},s={dottedLineDefault:2,lineDefault:6,lineSelected:6,endpointDefault:2.5,endpointSelected:3.75},r=.01,o=5},10854:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>s}),function(e){e.LOADING="LOADING",e.PRESENTED_BY_CAPS="PRESENTED_BY_CAPS",e.EXPLORE_3D_SPACE="EXPLORE_3D_SPACE",e.POWERED_BY="POWERED_BY",e.SC_LOCKOUT_MESSAGE="SC_LOCKOUT_MESSAGE",e.SC_LOCKOUT_TITLE="SC_LOCKOUT_TITLE",e.SC_PASSWORD_TITLE="SC_PASSWORD_TITLE",e.SC_PASSWORD_INVALID="SC_PASSWORD_INVALID",e.SC_PASSWORD_PLACEHOLDER="SC_PASSWORD_PLACEHOLDER",e.SC_PASSWORD_SUBMIT="SC_PASSWORD_SUBMIT",e.VIEW_INSIDE="VIEW_INSIDE",e.VIEW_INSIDE_MESH="VIEW_INSIDE_MESH",e.VIEW_DOLLHOUSE="VIEW_DOLLHOUSE",e.VIEW_FLOORPLAN="VIEW_FLOORPLAN",e.VIEW_FULLSCREEN="VIEW_FULLSCREEN",e.EXIT_FULLSCREEN="EXIT_FULLSCREEN",e.OPEN_HIGHLIGHTS="OPEN_HIGHLIGHTS",e.CLOSE_HIGHLIGHTS="CLOSE_HIGHLIGHTS",e.PAUSE="PAUSE",e.SOCIAL_SHARING="SOCIAL_SHARING",e.VIEW_IN_VR="VIEW_IN_VR",e.FLOOR_NAME="FLOOR_NAME",e.FLOOR_ALL="FLOOR_ALL",e.PRESENTED_BY="PRESENTED_BY",e.MORE="MORE",e.LESS="LESS",e.LEARN_MORE="LEARN_MORE",e.FEEDBACK="FEEDBACK",e.TERMS="TERMS",e.HELP="HELP",e.ALT_MATTERPORT_LOGO="ALT_MATTERPORT_LOGO",e.TERMS_FAIL="TERMS_FAIL",e.HELP_NAVIGATION_TAB="HELP_NAVIGATION_TAB",e.HELP_MORE_HELP_TAB="HELP_MORE_HELP_TAB",e.HELP_DESKTOP_360_2A="HELP_DESKTOP_360_2A",e.HELP_DESKTOP_360_2B="HELP_DESKTOP_360_2B",e.HELP_DESKTOP_DOLLHOUSE_1A="HELP_DESKTOP_DOLLHOUSE_1A",e.HELP_DESKTOP_DOLLHOUSE_1B="HELP_DESKTOP_DOLLHOUSE_1B",e.HELP_DESKTOP_DOLLHOUSE_2A="HELP_DESKTOP_DOLLHOUSE_2A",e.HELP_DESKTOP_DOLLHOUSE_3A="HELP_DESKTOP_DOLLHOUSE_3A",e.HELP_DESKTOP_FLOORPLAN_1A="HELP_DESKTOP_FLOORPLAN_1A",e.HELP_DESKTOP_FLOORPLAN_2A="HELP_DESKTOP_FLOORPLAN_2A",e.HELP_DESKTOP_FLOORPLAN_2B="HELP_DESKTOP_FLOORPLAN_2B",e.HELP_DESKTOP_FLOORPLAN_3A="HELP_DESKTOP_FLOORPLAN_3A",e.HELP_DESKTOP_FLOORPLAN_3B="HELP_DESKTOP_FLOORPLAN_3B",e.HELP_DESKTOP_MORE_360_B="HELP_DESKTOP_MORE_360_B",e.HELP_DESKTOP_MORE_DOLLHOUSE_B="HELP_DESKTOP_MORE_DOLLHOUSE_B",e.HELP_DESKTOP_MORE_FLOORS_B="HELP_DESKTOP_MORE_FLOORS_B",e.HELP_DESKTOP_MORE_FULLSCREEN_B="HELP_DESKTOP_MORE_FULLSCREEN_B",e.HELP_DESKTOP_MORE_HLR_B="HELP_DESKTOP_MORE_HLR_B",e.HELP_DESKTOP_MORE_INSIDE_B="HELP_DESKTOP_MORE_INSIDE_B",e.HELP_DESKTOP_MORE_MATTERTAG_B="HELP_DESKTOP_MORE_MATTERTAG_B",e.HELP_DESKTOP_MORE_TOUR_B="HELP_DESKTOP_MORE_TOUR_B",e.HELP_DESKTOP_MORE_VR_B="HELP_DESKTOP_MORE_VR_B",e.HELP_DESKTOP_MORE_ZOOM_B="HELP_DESKTOP_MORE_ZOOM_B",e.HELP_DESKTOP_PANORAMA_1A="HELP_DESKTOP_PANORAMA_1A",e.HELP_DESKTOP_PANORAMA_1B="HELP_DESKTOP_PANORAMA_1B",e.HELP_DESKTOP_PANORAMA_2A="HELP_DESKTOP_PANORAMA_2A",e.HELP_DESKTOP_PANORAMA_2B="HELP_DESKTOP_PANORAMA_2B",e.HELP_DESKTOP_PANORAMA_3A="HELP_DESKTOP_PANORAMA_3A",e.HELP_DESKTOP_PANORAMA_3B="HELP_DESKTOP_PANORAMA_3B",e.HELP_MOBILE_3="HELP_MOBILE_3",e.HELP_MOBILE_360_2="HELP_MOBILE_360_2",e.HELP_MOBILE_DOLLHOUSE_1="HELP_MOBILE_DOLLHOUSE_1",e.HELP_MOBILE_DOLLHOUSE_2="HELP_MOBILE_DOLLHOUSE_2",e.HELP_MOBILE_FLOORPLAN_1="HELP_MOBILE_FLOORPLAN_1",e.HELP_MOBILE_FLOORPLAN_2="HELP_MOBILE_FLOORPLAN_2",e.HELP_MOBILE_MORE_360_B="HELP_MOBILE_MORE_360_B",e.HELP_MOBILE_MORE_DOLLHOUSE_B="HELP_MOBILE_MORE_DOLLHOUSE_B",e.HELP_MOBILE_MORE_INSIDE_B="HELP_MOBILE_MORE_INSIDE_B",e.HELP_MOBILE_MORE_MATTERTAG_B="HELP_MOBILE_MORE_MATTERTAG_B",e.HELP_MOBILE_MORE_VR_B="HELP_MOBILE_MORE_VR_B",e.HELP_MOBILE_PANORAMA_1="HELP_MOBILE_PANORAMA_1",e.HELP_MOBILE_PANORAMA_2="HELP_MOBILE_PANORAMA_2",e.HELP_MORE_360_A="HELP_MORE_360_A",e.HELP_MORE_DOLLHOUSE_A="HELP_MORE_DOLLHOUSE_A",e.HELP_MORE_FLOORS_A="HELP_MORE_FLOORS_A",e.HELP_MORE_FLOORPLAN_A="HELP_MORE_FLOORPLAN_A",e.HELP_MORE_FULLSCREEN_A="HELP_MORE_FULLSCREEN_A",e.HELP_MORE_HLR_A="HELP_MORE_HLR_A",e.HELP_MORE_INSIDE_A="HELP_MORE_INSIDE_A",e.HELP_MORE_MATTERTAG_A="HELP_MORE_MATTERTAG_A",e.HELP_MORE_TOUR_A="HELP_MORE_TOUR_A",e.HELP_MORE_VR_A="HELP_MORE_VR_A",e.HELP_MORE_ZOOM_A="HELP_MORE_ZOOM_A",e.VR_APP_INSTRUCT="VR_APP_INSTRUCT",e.VR_APP_RECCOMMENDED="VR_APP_RECCOMMENDED",e.VR_ENTER="VR_ENTER",e.VR_LEARN_MORE_CAPS="VR_LEARN_MORE_CAPS",e.VR_QUEST="VR_QUEST",e.VR_RECOMMENDED="VR_RECOMMENDED",e.VR_SUPPORTS="VR_SUPPORTS",e.VR_VIEW_SPACE="VR_VIEW_SPACE",e.ERROR_WEBGL_UNSUPPORTED_PROBLEM="ERROR_WEBGL_UNSUPPORTED_PROBLEM",e.ERROR_BROWSER_SOLUTION="ERROR_BROWSER_SOLUTION",e.ERROR_BROWSER_EXPLANATION="ERROR_BROWSER_EXPLANATION",e.ERROR_CONTEXT_LOST_PROBLEM="ERROR_CONTEXT_LOST_PROBLEM",e.ERROR_CONTEXT_LOST_ACTIONS="ERROR_CONTEXT_LOST_ACTIONS",e.ERROR_LOADING_FAILED_PROBLEM="ERROR_LOADING_FAILED_PROBLEM",e.ERROR_LOADING_FAILED_ACTIONS="ERROR_LOADING_FAILED_ACTIONS",e.ERROR_GENERIC_PROBLEM="ERROR_GENERIC_PROBLEM",e.ERROR_GENERIC_SOLUTION="ERROR_GENERIC_SOLUTION",e.ERROR_GENERIC_ACTIONS="ERROR_GENERIC_ACTIONS",e.ERROR_GENERIC_ACTIONS_MOBILE="ERROR_GENERIC_ACTIONS_MOBILE",e.DESKTOP_SHORT_CTA="DESKTOP_SHORT_CTA",e.MOBILE_SHORT_CTA="MOBILE_SHORT_CTA",e.ROTATE="ROTATE",e.MOVE="MOVE",e.PLAY="PLAY",e.INSIDE="INSIDE",e.ZOOM="ZOOM",e.MEASUREMENT="MEASUREMENT",e.MEASUREMENT_START_ADDING="MEASUREMENT_START_ADDING",e.MEASUREMENT_CONTINUOUS_LINES="MEASUREMENT_CONTINUOUS_LINES",e.MEASUREMENT_SNAPPING="MEASUREMENT_SNAPPING",e.MEASUREMENT_UNITS="MEASUREMENT_UNITS",e.MEASUREMENT_IMPERIAL="MEASUREMENT_IMPERIAL",e.MEASUREMENT_METRIC="MEASUREMENT_METRIC",e.MEASUREMENT_SETTINGS="MEASUREMENT_SETTINGS",e.MEASUREMENT_HELP_CLICK_ANYWHERE="MEASUREMENT_HELP_CLICK_ANYWHERE",e.MEASUREMENT_HELP_ESCAPE="MEASUREMENT_HELP_ESCAPE",e.MEASUREMENT_HELP_PRESS_START="MEASUREMENT_HELP_PRESS_START",e.MEASUREMENT_HELP_DRAG_EDIT="MEASUREMENT_HELP_DRAG_EDIT",e.MEASUREMENT_HELP_PRESS_END="MEASUREMENT_HELP_PRESS_END",e.MEASUREMENT_MODE="MEASUREMENT_MODE",e.MEASUREMENT_HELP_MODAL_SUB_HEADER="MEASUREMENT_HELP_MODAL_SUB_HEADER",e.MEASUREMENT_HELP_MODAL_BODY_1="MEASUREMENT_HELP_MODAL_BODY_1",e.MEASUREMENT_HELP_MODAL_BODY_2="MEASUREMENT_HELP_MODAL_BODY_2",e.MEASUREMENT_NUDGE_TITLE="MEASUREMENT_NUDGE_TITLE",e.MEASUREMENT_NUDGE_MESSAGE="MEASUREMENT_NUDGE_MESSAGE",e.NOTES_MODE="NOTES_MODE",e.NOTES_NUDGE_TITLE="NOTES_NUDGE_TITLE",e.NOTES_NUDGE_MESSAGE="NOTES_NUDGE_MESSAGE",e.ON="ON",e.OFF="OFF",e.CLOSE="CLOSE",e.COPY="COPY",e.COPY_URL="COPY_URL",e.COPY_LINK="COPY_LINK",e.SHARE="SHARE",e.SHARE_COPIED="SHARE_COPIED",e.SHARE_CURRENT_LOCATION="SHARE_CURRENT_LOCATION",e.SHARE_DEFAULT_LOCATION="SHARE_DEFAULT_LOCATION",e.SHARE_ERROR_SWEEP_DISABLED="SHARE_ERROR_SWEEP_DISABLED",e.SHARE_EXPLORE="SHARE_EXPLORE",e.SHARE_LINK_TO_LOCATION="SHARE_LINK_TO_LOCATION",e.SHARE_AT="SHARE_AT",e.SHARE_WITH="SHARE_WITH",e.SHARE_3D="SHARE_3D",e.SHARE_MODAL_TITLE="SHARE_MODAL_TITLE",e.SHARED_TITLE="SHARED_TITLE",e.SHARED_MESSAGE="SHARED_MESSAGE",e.SHARED_MESSAGE_HASHTAG="SHARED_MESSAGE_HASHTAG",e.DOLLHOUSE_NUDGE_TITLE="DOLLHOUSE_NUDGE_TITLE",e.DOLLHOUSE_NUDGE_MESSAGE="DOLLHOUSE_NUDGE_MESSAGE"}(i||(i={})),function(e){let t,n,i,s,r,o,a;!function(e){e.COLLAPSE_PANEL="PANELS.COLLAPSE_PANEL",e.EXPAND_PANEL="PANELS.EXPAND_PANEL"}(t=e.PANELS||(e.PANELS={})),function(e){e.CLOSE_BUTTON_TOOLTIP_MESSAGE="REUSABLES.CLOSE_BUTTON_TOOLTIP_MESSAGE",e.HELP_BUTTON_TOOLTIP_MESSAGE="REUSABLES.HELP_BUTTON_TOOLTIP_MESSAGE",e.EMOJI_ALT_DISAPPOINTED="REUSABLES.EMOJI_ALT_DISAPPOINTED",e.EMOJI_ALT_UNSATISFIED="REUSABLES.EMOJI_ALT_UNSATISFIED",e.EMOJI_ALT_NEUTRAL="REUSABLES.EMOJI_ALT_NEUTRAL",e.EMOJI_ALT_SATISFIED="REUSABLES.EMOJI_ALT_SATISFIED",e.EMOJI_ALT_HAPPY="REUSABLES.EMOJI_ALT_HAPPY",e.FEEDBACK_LINK_LABEL="REUSABLES.FEEDBACK_LINK_LABEL"}(n=e.REUSABLES||(e.REUSABLES={})),function(e){e.PINK="COLORS.PINK",e.PLUM="COLORS.PLUM",e.PURPLE="COLORS.PURPLE",e.COBALT="COLORS.COBALT",e.CERULEAN="COLORS.CERULEAN",e.TEAL="COLORS.TEAL",e.FOG="COLORS.FOG",e.IRON="COLORS.IRON",e.FOREST="COLORS.FOREST",e.EMERALD="COLORS.EMERALD",e.MINT="COLORS.MINT",e.LIME="COLORS.LIME",e.CANARY="COLORS.CANARY",e.SUNFLOWER="COLORS.SUNFLOWER",e.TANGERINE="COLORS.TANGERINE",e.SUNSET="COLORS.SUNSET",e.SIERRA="COLORS.SIERRA",e.MAGENTA="COLORS.MAGENTA"}(i=e.COLORS||(e.COLORS={})),function(e){let t,n,i,s,r,o,a,l,c,d,u,h,p;!function(e){e.UPLOAD_TOOLTIP="SHOWCASE.ANNOTATIONS.UPLOAD_TOOLTIP",e.EMBED_TOOLTIP="SHOWCASE.ANNOTATIONS.EMBED_TOOLTIP",e.MAX_ATTACHMENTS_TOOLTIP="SHOWCASE.ANNOTATIONS.MAX_ATTACHMENTS_TOOLTIP",e.LINK_TOOLTIP="SHOWCASE.ANNOTATIONS.LINK_TOOLTIP",e.ADD_CTA="SHOWCASE.ANNOTATIONS.ADD_CTA",e.SAVE_CTA="SHOWCASE.ANNOTATIONS.SAVE_CTA",e.CANCEL_CTA="SHOWCASE.ANNOTATIONS.CANCEL_CTA",e.CONTENT_DELETED="SHOWCASE.ANNOTATIONS.CONTENT_DELETED",e.READ_MORE_MESSAGE="SHOWCASE.ANNOTATIONS.READ_MORE_MESSAGE"}(t=e.ANNOTATIONS||(e.ANNOTATIONS={})),function(e){e.ERROR_UPLOAD_FAIL="SHOWCASE.ATTACHMENTS.ERROR_UPLOAD_FAIL",e.ERROR_FILE_TOO_LARGE="SHOWCASE.ATTACHMENTS.ERROR_FILE_TOO_LARGE",e.ERROR_EMPTY_FILE="SHOWCASE.ATTACHMENTS.ERROR_EMPTY_FILE",e.ERROR_OVER_QUOTA="SHOWCASE.ATTACHMENTS.ERROR_OVER_QUOTA",e.ERROR_PERMISSION_DENIED="SHOWCASE.ATTACHMENTS.ERROR_PERMISSION_DENIED",e.REMOVE_TOOLTIP="SHOWCASE.ATTACHMENTS.REMOVE_TOOLTIP",e.CLOSE_TOOLTIP="SHOWCASE.ATTACHMENTS.CLOSE_TOOLTIP",e.DELETE_ATTACHMENT_TOOLTIP="SHOWCASE.ATTACHMENTS.DELETE_ATTACHMENT_TOOLTIP",e.DOWNLOAD_TOOLTIP="SHOWCASE.ATTACHMENTS.DOWNLOAD_TOOLTIP",e.EXPAND_ATTACHMENT_TOOLTIP="SHOWCASE.ATTACHMENTS.EXPAND_ATTACHMENT_TOOLTIP",e.VIEWER_INDEX_COUNT="SHOWCASE.ATTACHMENTS.VIEWER_INDEX_COUNT",e.FAILED_TO_LOAD_MESSAGE="SHOWCASE.ATTACHMENTS.FAILED_TO_LOAD_MESSAGE"}(n=e.ATTACHMENTS||(e.ATTACHMENTS={})),function(e){e.DEFAULT_NAME="SHOWCASE.FLOORS.DEFAULT_NAME"}(i=e.FLOORS||(e.FLOORS={})),function(e){e.ALT_GESTURE_DRAG="SHOWCASE.HELP.ALT_GESTURE_DRAG",e.ALT_GESTURE_DRAGTWOFINGER="SHOWCASE.HELP.ALT_GESTURE_DRAGTWOFINGER",e.ALT_GESTURE_POSITION="SHOWCASE.HELP.ALT_GESTURE_POSITION",e.ALT_GESTURE_PINCH="SHOWCASE.HELP.ALT_GESTURE_PINCH",e.ALT_GESTURE_PLAY="SHOWCASE.HELP.ALT_GESTURE_PLAY",e.ALT_GESTURE_POSITIONTWOFINGER="SHOWCASE.HELP.ALT_GESTURE_POSITIONTWOFINGER",e.ALT_GESTURE_TAP="SHOWCASE.HELP.ALT_GESTURE_TAP",e.ALT_GESTURE_TAPINSIDE="SHOWCASE.HELP.ALT_GESTURE_TAPINSIDE",e.ALT_KEYBOARD_ALL="SHOWCASE.HELP.ALT_KEYBOARD_ALL",e.ALT_KEYBOARD_INSIDE="SHOWCASE.HELP.ALT_KEYBOARD_INSIDE",e.ALT_KEYBOARD_LEFTRIGHT="SHOWCASE.HELP.ALT_KEYBOARD_LEFTRIGHT",e.ALT_KEYBOARD_UPDOWN="SHOWCASE.HELP.ALT_KEYBOARD_UPDOWN",e.ALT_KEYBOARD_ZOOM="SHOWCASE.HELP.ALT_KEYBOARD_ZOOM",e.ALT_MOUSE_CLICK="SHOWCASE.HELP.ALT_MOUSE_CLICK",e.ALT_MOUSE_CLICKINSIDE="SHOWCASE.HELP.ALT_MOUSE_CLICKINSIDE",e.ALT_MOUSE_DRAGLEFT="SHOWCASE.HELP.ALT_MOUSE_DRAGLEFT",e.ALT_MOUSE_DRAGRIGHT="SHOWCASE.HELP.ALT_MOUSE_DRAGRIGHT",e.ALT_MOUSE_PLAY="SHOWCASE.HELP.ALT_MOUSE_PLAY",e.ALT_MOUSE_POSITIONLEFT="SHOWCASE.HELP.ALT_MOUSE_POSITIONLEFT",e.ALT_MOUSE_POSITIONRIGHT="SHOWCASE.HELP.ALT_MOUSE_POSITIONRIGHT",e.ALT_MOUSE_ZOOM="SHOWCASE.HELP.ALT_MOUSE_ZOOM"}(s=e.HELP||(e.HELP={})),function(e){e.EMPTY_REEL_TITLE="SHOWCASE.HLR.EMPTY_REEL_TITLE",e.EMPTY_REEL_MESSAGE="SHOWCASE.HLR.EMPTY_REEL_MESSAGE",e.EMPTY_REEL_LEARN_MORE="SHOWCASE.HLR.EMPTY_REEL_LEARN_MORE"}(r=e.HLR||(e.HLR={})),function(e){e.SEARCH_GROUP_HEADER="SHOWCASE.LABELS.SEARCH_GROUP_HEADER"}(o=e.LABELS||(e.LABELS={})),function(e){e.SEARCH_GROUP_HEADER="SHOWCASE.MEASUREMENTS.SEARCH_GROUP_HEADER"}(a=e.MEASUREMENTS||(e.MEASUREMENTS={})),function(e){e.TODAY="SHOWCASE.NOTES.TODAY",e.YESTERDAY="SHOWCASE.NOTES.YESTERDAY",e.THIS_WEEK="SHOWCASE.NOTES.THIS_WEEK",e.ONE_WEEK_AGO="SHOWCASE.NOTES.ONE_WEEK_AGO",e.TWO_WEEKS_AGO="SHOWCASE.NOTES.TWO_WEEKS_AGO",e.THREE_WEEKS_AGO="SHOWCASE.NOTES.THREE_WEEKS_AGO",e.OLDER="SHOWCASE.NOTES.OLDER",e.NO_MATCHES="SHOWCASE.NOTES.NO_MATCHES",e.HAVE_NONE="SHOWCASE.NOTES.HAVE_NONE",e.HAVE_NONE_OPEN="SHOWCASE.NOTES.HAVE_NONE_OPEN",e.HAVE_NONE_RESOLVED="SHOWCASE.NOTES.HAVE_NONE_RESOLVED",e.CONTENT_DELETED="SHOWCASE.NOTES.CONTENT_DELETED",e.RESULTS="SHOWCASE.NOTES.RESULTS",e.NUM_ATTACHMENTS="SHOWCASE.NOTES.ATTACHMENTS",e.NOTES="SHOWCASE.NOTES.NOTES",e.REPLIES="SHOWCASE.NOTES.REPLIES",e.FILTER_RESOLVED="SHOWCASE.NOTES.FILTER_RESOLVED",e.FILTER_UNRESOLVED="SHOWCASE.NOTES.FILTER_UNRESOLVED",e.FILTER_ALL="SHOWCASE.NOTES.FILTER_ALL",e.CANCEL="SHOWCASE.NOTES.CANCEL",e.DELETE="SHOWCASE.NOTES.DELETE",e.EDIT="SHOWCASE.NOTES.EDIT",e.MARK_AS_RESOLVED="SHOWCASE.NOTES.MARK_AS_RESOLVED",e.UNRESOLVE="SHOWCASE.NOTES.UNRESOLVE",e.FEEDBACK="SHOWCASE.NOTES.FEEDBACK",e.NAV_BACK="SHOWCASE.NOTES.NAV_BACK",e.NAV_CLOSE="SHOWCASE.NOTES.NAV_CLOSE",e.REPLY_PLACEHOLDER="SHOWCASE.NOTES.REPLY_PLACEHOLDER",e.EDIT_LIST_ITEM_OPTION_CTA="SHOWCASE.NOTES.EDIT_LIST_ITEM_OPTION_CTA",e.DELETE_LIST_ITEM_OPTION_CTA="SHOWCASE.NOTES.DELETE_LIST_ITEM_OPTION_CTA",e.MISSING_MESSAGE="SHOWCASE.NOTES.MISSING_MESSAGE",e.MODAL_TITLE="SHOWCASE.NOTES.MODAL_TITLE",e.MODAL_COPY="SHOWCASE.NOTES.MODAL_COPY",e.MODAL_CTA="SHOWCASE.NOTES.MODAL_CTA",e.ADD_CTA_TOOLTIP="SHOWCASE.NOTES.ADD_CTA_TOOLTIP",e.ADD_TOOLTIP="SHOWCASE.NOTES.ADD_TOOLTIP",e.CANCEL_TOOLTIP="SHOWCASE.NOTES.CANCEL_TOOLTIP",e.COLOR_STEM_TOOLTIP="SHOWCASE.NOTES.COLOR_STEM_TOOLTIP",e.DELETE_TOOLTIP="SHOWCASE.NOTES.DELETE_TOOLTIP",e.OVERLAY_ADD_TOUCH="SHOWCASE.NOTES.OVERLAY_ADD_TOUCH",e.OVERLAY_ADD_CLICK="SHOWCASE.NOTES.OVERLAY_ADD_TOUCH",e.OVERLAY_PLACE_TOUCH="SHOWCASE.NOTES.OVERLAY_ADD_TOUCH",e.OVERLAY_PLACE_CLICK="SHOWCASE.NOTES.OVERLAY_ADD_TOUCH",e.SEARCH_GROUP_HEADER="SHOWCASE.NOTES.SEARCH_GROUP_HEADER"}(l=e.NOTES||(e.NOTES={})),function(e){e.CLOSE_TAG_LABEL="SHOWCASE.TAGS.CLOSE_TAG_LABEL",e.DOCK_TAG_LABEL="SHOWCASE.TAGS.DOCK_TAG_LABEL",e.EDIT_TAG_LABEL="SHOWCASE.TAGS.EDIT_TAG_LABEL",e.MISSING_MESSAGE="SHOWCASE.TAGS.MISSING_MESSAGE",e.SEARCH_GROUP_HEADER="SHOWCASE.TAGS.SEARCH_GROUP_HEADER",e.SHARE_TAG_LABEL="SHOWCASE.TAGS.SHARE_TAG_LABEL",e.UNDOCK_TAG_LABEL="SHOWCASE.TAGS.UNDOCK_TAG_LABEL",e.NAV_BACK_LABEL="SHOWCASE.TAGS.NAV_BACK_LABEL"}(c=e.TAGS||(e.TAGS={})),function(e){e.QUERY_PLACEHOLDER="SHOWCASE.SEARCH.QUERY_PLACEHOLDER",e.CLEAR_SEARCH="SHOWCASE.SEARCH.CLEAR_SEARCH",e.GROUP_FLOOR="SHOWCASE.SEARCH.GROUP_FLOOR",e.GROUP_FLOOR_SELECTED="SHOWCASE.SEARCH.GROUP_FLOOR_SELECTED",e.GROUP_TYPE="SHOWCASE.SEARCH.GROUP_TYPE",e.GROUP_TYPE_SELECTED="SHOWCASE.SEARCH.GROUP_TYPE_SELECTED",e.ITEMS="SHOWCASE.SEARCH.ITEMS",e.EMPTY_LIST_MESSAGE="SHOWCASE.SEARCH.EMPTY_LIST_MESSAGE",e.VALIDATION_MESSAGE="SHOWCASE.SEARCH.VALIDATION_MESSAGE",e.ADVANCED_SEARCH_INSTRUCTIONS="SHOWCASE.SEARCH.ADVANCED_SEARCH_INSTRUCTIONS",e.ADVANCED_SEARCH_HELP_BUTTON="SHOWCASE.SEARCH.ADVANCED_SEARCH_HELP_BUTTON",e.ADVANCED_SEARCH_TITLE="SHOWCASE.SEARCH.ADVANCED_SEARCH_TITLE"}(d=e.SEARCH||(e.SEARCH={})),function(e){e.BANNER_CTA_LINK_TEXT="SHOWCASE.SUBSCRIBER_PROMPT.BANNER_CTA_LINK_TEXT",e.POPUP_CTA_HEADING="SHOWCASE.SUBSCRIBER_PROMPT.POPUP_CTA_HEADING",e.POPUP_CTA_LINK_TEXT="SHOWCASE.SUBSCRIBER_PROMPT.POPUP_CTA_LINK_TEXT"}(u=e.SUBSCRIBER_PROMPT||(e.SUBSCRIBER_PROMPT={})),function(e){e.HEADING="SHOWCASE.SUMMARY.HEADING",e.LABEL_ADDRESS="SHOWCASE.SUMMARY.LABEL_ADDRESS",e.LABEL_CONTACT="SHOWCASE.SUMMARY.LABEL_CONTACT",e.LABEL_INFORMATION="SHOWCASE.SUMMARY.LABEL_INFORMATION",e.LABEL_LOCATION="SHOWCASE.SUMMARY.LABEL_LOCATION",e.LABEL_LEARN_MORE="SHOWCASE.SUMMARY.LABEL_LEARN_MORE"}(h=e.SUMMARY||(e.SUMMARY={})),function(e){e.TOUR_BUTTON_LABEL="SHOWCASE.TOURS.TOUR_BUTTON_LABEL"}(p=e.TOURS||(e.TOURS={}))}(s=e.SHOWCASE||(e.SHOWCASE={})),function(e){e.BLUR="TOOLS.BLUR",e.BLUR_HELP_MESSAGE="TOOLS.BLUR_HELP_MESSAGE",e.HLR="TOOLS.HLR",e.HLR_HELP_MESSAGE="TOOLS.HLR_HELP_MESSAGE",e.LABELS="TOOLS.LABELS",e.LABELS_HELP_MESSAGE="TOOLS.LABELS_HELP_MESSAGE",e.LAYERS="TOOLS.LAYERS",e.LAYERS_HELP_MESSAGE="TOOLS.LAYERS_HELP_MESSAGE",e.MATTERTAGS="TOOLS.MATTERTAGS",e.MATTERTAGS_HELP_MESSAGE="TOOLS.MATTERTAGS_HELP_MESSAGE",e.MEASUREMENTS="TOOLS.MEASUREMENTS",e.MEASUREMENTS_HELP_MESSAGE="TOOLS.MEASUREMENTS_HELP_MESSAGE",e.MESH_TRIM="TOOLS.MESH_TRIM",e.MESH_TRIM_HELP_MESSAGE="TOOLS.MESH_TRIM_HELP_MESSAGE",e.NOTES="TOOLS.NOTES",e.PHOTOS="TOOLS.PHOTOS",e.PHOTOS_HELP_MESSAGE="TOOLS.PHOTOS_HELP_MESSAGE",e.SCANS_3D="TOOLS.SCANS_3D",e.SCANS_3D_HELP_MESSAGE="TOOLS.SCANS_3D_HELP_MESSAGE",e.SETTINGS_PANEL="TOOLS.SETTINGS_PANEL",e.START_LOCATION="TOOLS.START_LOCATION",e.START_LOCATION_HELP_MESSAGE="TOOLS.START_LOCATION_HELP_MESSAGE",e.SUMMARY="TOOLS.SUMMARY",e.TAGS="TOOLS.TAGS",e.TAGS_HELP_MESSAGE="TOOLS.TAGS_HELP_MESSAGE",e.TOURS="TOOLS.TOURS",e.TOURS_HELP_MESSAGE="TOOLS.TOURS_HELP_MESSAGE",e.VIEW_360="TOOLS.VIEW_360",e.VIEW_360_HELP_MESSAGE="TOOLS.VIEW_360_HELP_MESSAGE",e.VR_PATH="TOOLS.VR_PATH",e.VR_PATH_HELP_MESSAGE="TOOLS.VR_PATH_HELP_MESSAGE",e.SEARCH="TOOLS.SEARCH"}(r=e.TOOLS||(e.TOOLS={})),function(e){e.INVITE_USER="USERS.INVITE_USER",e.INVITE_USER_FAILED="USERS.INVITE_USER_FAILED",e.INVITE_BUTTON="USERS.INVITE_BUTTON",e.INVITE_USERS="USERS.INVITE_USERS",e.INVITE_USERS_FAILED="USERS.INVITE_USERS_FAILED",e.INVITE_VISIBLE_MSG="USERS.INVITE_VISIBLE_MSG",e.UNKNOWN_USER="USERS.UNKNOWN_USER",e.UNKNOWN_USERS="USERS.UNKNOWN_USERS"}(o=e.USERS||(e.USERS={})),function(e){let t,n,i,s,r,o,a,l,c,d,u,h,p,m,f,g,v,y,b,S,E,T,w;!function(e){e.DELETE_SELECTED_CTA="WORKSHOP.ACCORDION.DELETE_SELECTED_CTA",e.SELECT_ALL_CTA="WORKSHOP.ACCORDION.SELECT_ALL_CTA",e.ENTER_SELECT_MODE_CTA="WORKSHOP.ACCORDION.ENTER_SELECT_MODE_CTA",e.EXIT_SELECT_MODE_CTA="WORKSHOP.ACCORDION.EXIT_SELECT_MODE_CTA",e.DELETE_FOOTER_CTA="WORKSHOP.ACCORDION.DELETE_FOOTER_CTA",e.TOGGLE_VISIBILITY_FOOTER_CTA="WORKSHOP.ACCORDION.TOGGLE_VISIBILITY_FOOTER_CTA",e.BATCH_DELETE_MODAL_TITLE="WORKSHOP.ACCORDION.BATCH_DELETE_MODAL_TITLE",e.BATCH_DELETE_MODAL_MESSAGE="WORKSHOP.ACCORDION.BATCH_DELETE_MODAL_MESSAGE",e.RENAME_HEADER_OPTION_CTA="WORKSHOP.ACCORDION.RENAME_HEADER_OPTION_CTA"}(t=e.ACCORDION||(e.ACCORDION={})),function(e){e.CHANGES_SAVED_MESSAGE="WORKSHOP.APP_SWITCH.CHANGES_SAVED_MESSAGE",e.EDIT_CTA="WORKSHOP.APP_SWITCH.EDIT_CTA",e.UNSUPPORTED_TOOLTIP_MESSAGE="WORKSHOP.APP_SWITCH.UNSUPPORTED_TOOLTIP_MESSAGE",e.UNSUPPORTED_TOOLTIP_TITLE="WORKSHOP.APP_SWITCH.UNSUPPORTED_TOOLTIP_TITLE",e.PUBLIC_PUBLISH_TOOLTIP_TITLE="WORKSHOP.APP_SWITCH.PUBLIC_PUBLISH_TOOLTIP_TITLE",e.PRIVATE_PUBLISH_TOOLTIP_TITLE="WORKSHOP.APP_SWITCH.PRIVATE_PUBLISH_TOOLTIP_TITLE",e.PUBLIC_PUBLISH_TOOLTIP_MESSAGE="WORKSHOP.APP_SWITCH.PUBLIC_PUBLISH_TOOLTIP_MESSAGE",e.PRIVATE_PUBLISH_TOOLTIP_MESSAGE="WORKSHOP.APP_SWITCH.PRIVATE_PUBLISH_TOOLTIP_MESSAGE",e.PUBLISH_CHANGES_CTA="WORKSHOP.APP_SWITCH.PUBLISH_CHANGES_CTA",e.PUBLISHING_CHANGES_CTA="WORKSHOP.APP_SWITCH.PUBLISHING_CHANGES_CTA",e.REVERT_CHANGES_MODAL_TITLE="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_TITLE",e.REVERT_CHANGES_MODAL_HEADER="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_HEADER",e.REVERT_CHANGES_MODAL_EXPLANATION="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_EXPLANATION",e.REVERT_CHANGES_MODAL_WARNING="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_WARNING",e.REVERT_CHANGES_MODAL_LEARN_MORE_CTA="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_LEARN_MORE_CTA",e.REVERT_CHANGES_MODAL_CANCEL_CTA="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_CANCEL_CTA",e.REVERT_CHANGES_MODAL_REVERT_CTA="WORKSHOP.APP_SWITCH.REVERT_CHANGES_MODAL_REVERT_CTA",e.FLOORS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.FLOORS_CHECKBOX_LABEL",e.MEASUREMENTS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.MEASUREMENTS_CHECKBOX_LABEL",e.MATTERTAGS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.MATTERTAGS_CHECKBOX_LABEL",e.TAGS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.TAGS_CHECKBOX_LABEL",e.LABELS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.LABELS_CHECKBOX_LABEL",e.HIGHLIGHTS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.HIGHLIGHTS_CHECKBOX_LABEL",e.START_LOCATION_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.START_LOCATION_CHECKBOX_LABEL",e.SETTINGS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.SETTINGS_CHECKBOX_LABEL",e.SWEEPS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.SWEEPS_CHECKBOX_LABEL",e.BLURS_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.BLURS_CHECKBOX_LABEL",e.NO_UNPUBLISHED_CHANGES_CHECKBOX_LABEL="WORKSHOP.APP_SWITCH.NO_UNPUBLISHED_CHANGES_CHECKBOX_LABEL",e.EXIT_EDIT_MODE_CTA="WORKSHOP.APP_SWITCH.EXIT_EDIT_MODE_CTA",e.EXIT_EDIT_MODE_TOOLTIP_MESSAGE="WORKSHOP.APP_SWITCH.EXIT_EDIT_MODE_TOOLTIP_MESSAGE",e.DISCARD_CHANGES_TOOLTIP_MESSAGE="WORKSHOP.APP_SWITCH.DISCARD_CHANGES_TOOLTIP_MESSAGE",e.PREVIEW_CHANGES_CTA="WORKSHOP.APP_SWITCH.PREVIEW_CHANGES_CTA",e.TIMESTAMP_UNPUBLISHED_CHANGES="WORKSHOP.APP_SWITCH.TIMESTAMP_UNPUBLISHED_CHANGES",e.TIMESTAMP_GREATER_THAN_ONE_MONTH="WORKSHOP.APP_SWITCH.TIMESTAMP_GREATER_THAN_ONE_MONTH",e.TIMESTAMP_DAY="WORKSHOP.APP_SWITCH.TIMESTAMP_DAY",e.TIMESTAMP_HOUR="WORKSHOP.APP_SWITCH.TIMESTAMP_HOUR",e.TIMESTAMP_MINUTE="WORKSHOP.APP_SWITCH.TIMESTAMP_MINUTE",e.TIMESTAMP_LESS_THAN_ONE_MINUTE="WORKSHOP.APP_SWITCH.TIMESTAMP_LESS_THAN_ONE_MINUTE",e.TIMESTAMP_LAST_PUBLISHED_MESSAGE="WORKSHOP.APP_SWITCH.TIMESTAMP_LAST_PUBLISHED_MESSAGE",e.UNABLE_TO_SAVE_CHANGES_ERROR_MESSAGE="WORKSHOP.APP_SWITCH.UNABLE_TO_SAVE_CHANGES_ERROR_MESSAGE",e.UNABLE_TO_PUBLISH_CHANGES_ERROR_MESSAGE="WORKSHOP.APP_SWITCH.UNABLE_TO_PUBLISH_CHANGES_ERROR_MESSAGE",e.UNABLE_TO_REVERT_CHANGES_ERROR_MESSAGE="WORKSHOP.APP_SWITCH.UNABLE_TO_REVERT_CHANGES_ERROR_MESSAGE",e.UNAUTHORIZED_ERROR_MESSAGE="WORKSHOP.APP_SWITCH.UNAUTHORIZED_ERROR_MESSAGE"}(n=e.APP_SWITCH||(e.APP_SWITCH={})),function(e){e.ACCEPT_ALL_SUGGESTIONS="WORKSHOP.BLURS.ACCEPT_ALL_SUGGESTIONS",e.ACCEPT_SUGGESTION_TOOLTIP="WORKSHOP.BLURS.ACCEPT_SUGGESTION_TOOLTIP",e.ALREADY_PROCESSING_ALERT_MESSAGE="WORKSHOP.BLURS.ALREADY_PROCESSING_ALERT_MESSAGE",e.ALREADY_PROCESSING_ALERT_TITLE="WORKSHOP.BLURS.ALREADY_PROCESSING_ALERT_TITLE",e.APPLY_BLURS_CTA="WORKSHOP.BLURS.APPLY_BLURS_CTA",e.APPLYING="WORKSHOP.BLURS.APPLYING",e.APPLY_MODAL_CONFIRM="WORKSHOP.BLURS.APPLY_MODAL_CONFIRM",e.APPLY_MODAL_MESSAGE="WORKSHOP.BLURS.APPLY_MODAL_MESSAGE",e.APPLY_MODAL_RETRY="WORKSHOP.BLURS.APPLY_MODAL_RETRY",e.APPLY_MODAL_TITLE="WORKSHOP.BLURS.APPLY_MODAL_TITLE",e.APPLY_MODAL_TRUNCATED="WORKSHOP.BLURS.APPLY_MODAL_TRUNCATED",e.APPLY_MODAL_WARNING="WORKSHOP.BLURS.APPLY_MODAL_WARNING",e.BATCH_SELECT="WORKSHOP.BLURS.BATCH_SELECT",e.BLUR_STATUS="WORKSHOP.BLURS.BLUR_STATUS",e.BLUR_STATUS_ALL="WORKSHOP.BLURS.BLUR_STATUS_ALL",e.BLUR_STATUS_APPLIED="WORKSHOP.BLURS.BLUR_STATUS_APPLIED",e.BLUR_STATUS_FAILED="WORKSHOP.BLURS.BLUR_STATUS_FAILED",e.BLUR_STATUS_PENDING="WORKSHOP.BLURS.BLUR_STATUS_PENDING",e.BLUR_STATUS_PROCESSING="WORKSHOP.BLURS.BLUR_STATUS_PROCESSING",e.BLUR_STATUS_SUGGESTED="WORKSHOP.BLURS.BLUR_STATUS_SUGGESTED",e.BRUSH_TOOLTIP_MESSAGE="WORKSHOP.BLURS.BRUSH_TOOLTIP_MESSAGE",e.BRUSH_TOOLTIP_TITLE="WORKSHOP.BLURS.BRUSH_TOOLTIP_TITLE",e.CLOSE_SUGGESTIONS="WORKSHOP.BLURS.CLOSE_SUGGESTIONS",e.CREATE_TOOLTIP_MESSAGE="WORKSHOP.BLURS.CREATE_TOOLTIP_MESSAGE",e.CREATE_TOOLTIP_TITLE="WORKSHOP.BLURS.CREATE_TOOLTIP_TITLE",e.DEFAULT_ALERT_CONFIRMATION="WORKSHOP.BLURS.DEFAULT_ALERT_CONFIRMATION",e.DEFAULT_ALERT_TITLE="WORKSHOP.BLURS.DEFAULT_ALERT_TITLE",e.DEFAULT_BLUR_NAME="WORKSHOP.BLURS.DEFAULT_BLUR_NAME",e.DELETE_BLUR_CTA="WORKSHOP.BLURS.DELETE_BLUR_CTA",e.GROUP_BY="WORKSHOP.BLURS.GROUP_BY",e.GROUP_BY_FLOOR="WORKSHOP.BLURS.GROUP_BY_FLOOR",e.GROUP_BY_SCAN="WORKSHOP.BLURS.GROUP_BY_SCAN",e.HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.BLURS.HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.MULTI_FLOOR_EMPTY_MESSAGE="WORKSHOP.BLURS.MULTI_FLOOR_EMPTY_MESSAGE",e.NO_BLURS="WORKSHOP.BLURS.NO_BLURS",e.NO_SUGGESTIONS="WORKSHOP.BLURS.NO_SUGGESTIONS",e.NO_SUGGESTIONS_ON_FLOOR="WORKSHOP.BLURS.NO_SUGGESTIONS_ON_FLOOR",e.NUM_TYPE="WORKSHOP.BLURS.NUM_TYPE",e.OTHER_GROUP_LABEL="WORKSHOP.BLURS.OTHER_GROUP_LABEL",e.OVERLAY_MESSAGE="WORKSHOP.BLURS.OVERLAY_MESSAGE",e.OVERLAY_MESSAGE_TOUCH="WORKSHOP.BLURS.OVERLAY_MESSAGE_TOUCH",e.REJECT_ALL_SUGGESTIONS="WORKSHOP.BLURS.REJECT_ALL_SUGGESTIONS",e.REJECT_SUGGESTION_TOOLTIP="WORKSHOP.BLURS.REJECT_SUGGESTION_TOOLTIP",e.SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.BLURS.SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.SINGLE_FLOOR_EMPTY_MESSAGE="WORKSHOP.BLURS.SINGLE_FLOOR_EMPTY_MESSAGE",e.SORT="WORKSHOP.BLURS.SORT",e.SORT_CREATED_ASC="WORKSHOP.BLURS.SORT_CREATED_ASC",e.SORT_CREATED_DESC="WORKSHOP.BLURS.SORT_CREATED_DESC",e.STATUS="WORKSHOP.BLURS.STATUS",e.SUGGESTED_BLUR="WORKSHOP.BLURS.SUGGESTED_BLUR",e.SUGGESTIONS_AVAILABLE_MESSAGE="WORKSHOP.BLURS.SUGGESTIONS_AVAILABLE_MESSAGE",e.SUGGESTIONS_FOUND_MESSAGE="WORKSHOP.BLURS.SUGGESTIONS_FOUND_MESSAGE",e.TYPE="WORKSHOP.BLURS.TYPE",e.VIEW_SUGGESTIONS="WORKSHOP.BLURS.VIEW_SUGGESTIONS"}(i=e.BLURS||(e.BLURS={})),function(e){e.TYPE="WORKSHOP.SUGGESTIONS.TYPE"}(s=e.SUGGESTIONS||(e.SUGGESTIONS={})),function(e){e.HELP_LINK="WORKSHOP.EDIT_BAR.HELP_LINK",e.BETA_TAG="WORKSHOP.EDIT_BAR.BETA_TAG",e.COLLAPSE_LIST_TOOLTIP_MESSAGE="WORKSHOP.EDIT_BAR.COLLAPSE_LIST_TOOLTIP_MESSAGE",e.EXPAND_LIST_TOOLTIP_MESSAGE="WORKSHOP.EDIT_BAR.EXPAND_LIST_TOOLTIP_MESSAGE",e.NEW_BADGE="WORKSHOP.EDIT_BAR.NEW_BADGE"}(r=e.EDIT_BAR||(e.EDIT_BAR={})),function(e){e.APPLY_CTA="WORKSHOP.EMBED.APPLY_CTA",e.HELP_CTA="WORKSHOP.EMBED.HELP_CTA",e.ERROR_MESSAGE="WORKSHOP.EMBED.ERROR_MESSAGE",e.LOADING_MESSAGE="WORKSHOP.EMBED.LOADING_MESSAGE",e.INVALID_URL_MESSAGE="WORKSHOP.EMBED.INVALID_URL_MESSAGE",e.SUPPORTED_FORMATS_MESSAGE="WORKSHOP.EMBED.SUPPORTED_FORMATS_MESSAGE",e.MEDIA_LINK_LABEL="WORKSHOP.EMBED.MEDIA_LINK_LABEL",e.PROVIDER_NOT_SUPPORTED_MESSAGE="WORKSHOP.EMBED.PROVIDER_NOT_SUPPORTED_MESSAGE",e.LINK_TYPE_NOT_SUPPORTED_MESSAGE="WORKSHOP.EMBED.LINK_TYPE_NOT_SUPPORTED_MESSAGE"}(o=e.EMBED||(e.EMBED={})),function(e){e.ADD_FROM_PHOTOS_TOOLTIP_MESSAGE="WORKSHOP.HLR.ADD_FROM_PHOTOS_TOOLTIP_MESSAGE",e.ADD_HIGHLIGHT_CTA="WORKSHOP.HLR.ADD_HIGHLIGHT_CTA",e.ADD_HIGHLIGHT_DISABLED_CTA="WORKSHOP.HLR.ADD_HIGHLIGHT_DISABLED_CTA",e.ADD_HIGHLIGHT_INSTRUCTIONS="WORKSHOP.HLR.ADD_HIGHLIGHT_INSTRUCTIONS",e.APPLY_TO_ALL_CTA="WORKSHOP.HLR.APPLY_TO_ALL_CTA",e.CLEAR_HLR_MODAL_MESSAGE="WORKSHOP.HLR.CLEAR_HLR_MODAL_MESSAGE",e.CLEAR_HLR_MODAL_TITLE="WORKSHOP.HLR.CLEAR_HLR_MODAL_TITLE",e.CLEAR_REEL_CTA="WORKSHOP.HLR.CLEAR_REEL_CTA",e.CLOSE_SETTINGS_CTA="WORKSHOP.HLR.CLOSE_SETTINGS_CTA",e.DELETE_HIGHLIGHT_TOOLTIP_MESSAGE="WORKSHOP.HLR.DELETE_HIGHLIGHT_TOOLTIP_MESSAGE",e.DISMISS_TOOLTIP_CTA="WORKSHOP.HLR.DISMISS_TOOLTIP_CTA",e.DOLLHOUSE_ROTATION_SPEED_SETTING_LABEL="WORKSHOP.HLR.DOLLHOUSE_ROTATION_SPEED_SETTING_LABEL",e.EDIT_HIGHLIGHT_TOOLTIP_MESSAGE="WORKSHOP.HLR.EDIT_HIGHLIGHT_TOOLTIP_MESSAGE",e.EDIT_SETTINGS_TOOLTIP_MESSAGE="WORKSHOP.HLR.EDIT_SETTINGS_TOOLTIP_MESSAGE",e.HIGHLIGHT_CAPTION_HINT="WORKSHOP.HLR.HIGHLIGHT_CAPTION_HINT",e.HIGHLIGHT_CAPTION_PLACEHOLDER="WORKSHOP.HLR.HIGHLIGHT_CAPTION_PLACEHOLDER",e.HIGHLIGHT_DESCRIPTION_HINT="WORKSHOP.HLR.HIGHLIGHT_DESCRIPTION_HINT",e.HIGHLIGHT_DESCRIPTION_PLACEHOLDER="WORKSHOP.HLR.HIGHLIGHT_DESCRIPTION_PLACEHOLDER",e.HIGHLIGHT_SCENE_HINT="WORKSHOP.HLR.HIGHLIGHT_SCENE_HINT",e.HIGHLIGHT_SCENE_PLACEHOLDER="WORKSHOP.HLR.HIGHLIGHT_SCENE_PLACEHOLDER",e.HIGHLIGHT_TITLE_HINT="WORKSHOP.HLR.HIGHLIGHT_TITLE_HINT",e.HIGHLIGHT_TITLE_PLACEHOLDER="WORKSHOP.HLR.HIGHLIGHT_TITLE_PLACEHOLDER",e.INDIVIDUAL_PAN_DIRECTION_SETTING_LABEL="WORKSHOP.HLR.INDIVIDUAL_PAN_DIRECTION_SETTING_LABEL",e.INDIVIDUAL_TRANSITION_SETTING_LABEL="WORKSHOP.HLR.INDIVIDUAL_TRANSITION_SETTING_LABEL",e.NUM_TYPE="WORKSHOP.HLR.NUM_TYPE",e.PANNING_SETTINGS_TAB_TITLE="WORKSHOP.HLR.PANNING_SETTINGS_TAB_TITLE",e.PAN_DIRECTION_SETTING_AUTO="WORKSHOP.HLR.PAN_DIRECTION_SETTING_AUTO",e.PAN_DIRECTION_SETTING_LABEL="WORKSHOP.HLR.PAN_DIRECTION_SETTING_LABEL",e.PAN_DIRECTION_SETTING_LEFT="WORKSHOP.HLR.PAN_DIRECTION_SETTING_LEFT",e.PAN_DIRECTION_SETTING_RIGHT="WORKSHOP.HLR.PAN_DIRECTION_SETTING_RIGHT",e.PREVIEW_SETTINGS_CTA="WORKSHOP.HLR.PREVIEW_SETTINGS_CTA",e.REMOVE_HIGHLIGHT_TOOLTIP_MESSAGE="WORKSHOP.HLR.REMOVE_HIGHLIGHT_TOOLTIP_MESSAGE",e.RESTORE_DEFAULTS_CTA="WORKSHOP.HLR.RESTORE_DEFAULTS_CTA",e.ROTATION_ANGLE_SETTING_LABEL="WORKSHOP.HLR.ROTATION_ANGLE_SETTING_LABEL",e.ROTATION_SPEED_SETTING_LABEL="WORKSHOP.HLR.ROTATION_SPEED_SETTING_LABEL",e.SCAN_GENERIC_HIDDEN_TOOLTIP_TITLE="WORKSHOP.HLR.SCAN_GENERIC_HIDDEN_TOOLTIP_TITLE",e.SCAN_NOT_HIDDEN_TOOLTIP_TITLE="WORKSHOP.HLR.SCAN_NOT_HIDDEN_TOOLTIP_TITLE",e.SCAN_NUMBER_HIDDEN_TOOLTIP_TITLE="WORKSHOP.HLR.SCAN_NUMBER_HIDDEN_TOOLTIP_TITLE",e.SETTINGS_MODAL_TITLE="WORKSHOP.HLR.SETTINGS_MODAL_TITLE",e.SLIDESHOW_SPEED_SETTING_LABEL="WORKSHOP.HLR.SLIDESHOW_SPEED_SETTING_LABEL",e.SPEED_SETTING_FAST="WORKSHOP.HLR.SPEED_SETTING_FAST",e.SPEED_SETTING_MEDIUM="WORKSHOP.HLR.SPEED_SETTING_MEDIUM",e.SPEED_SETTING_SLOW="WORKSHOP.HLR.SPEED_SETTING_SLOW",e.TOAST_ERROR_CTA="WORKSHOP.HLR.TOAST_ERROR_CTA",e.TOAST_ERROR_MESSAGE="WORKSHOP.HLR.TOAST_ERROR_MESSAGE",e.TOUR_EDITOR_BEHAVIORS_TAB="WORKSHOP.HLR.TOUR_EDITOR_BEHAVIORS_TAB",e.TOUR_EDITOR_LABELS_TAB="WORKSHOP.HLR.TOUR_EDITOR_LABELS_TAB",e.TOUR_EDITOR_EMPTY_MESSAGE="WORKSHOP.HLR.TOUR_EDITOR_EMPTY_MESSAGE",e.TOUR_EDITOR_EMPTY_TITLE="WORKSHOP.HLR.TOUR_EDITOR_EMPTY_TITLE",e.TOUR_SETTINGS_LABEL="WORKSHOP.HLR.TOUR_SETTINGS_LABEL",e.TRANSITION_AFTER_360_DISABLED_MESSAGE="WORKSHOP.HLR.TRANSITION_AFTER_360_DISABLED_MESSAGE",e.TRANSITION_EDITOR_TITLE="WORKSHOP.HLR.TRANSITION_EDITOR_TITLE",e.TRANSITION_IS_360_DISABLED_MESSAGE="WORKSHOP.HLR.TRANSITION_IS_360_DISABLED_MESSAGE",e.TRANSITION_NO_ROTATION_DISABLED_MESSAGE="WORKSHOP.HLR.TRANSITION_NO_ROTATION_DISABLED_MESSAGE",e.TRANSITION_SAME_SWEEP_DISABLED_MESSAGE="WORKSHOP.HLR.TRANSITION_SAME_SWEEP_DISABLED_MESSAGE",e.TRANSITION_SETTINGS_TAB_TITLE="WORKSHOP.HLR.TRANSITION_SETTINGS_TAB_TITLE",e.TRANSITION_SETTING_LABEL="WORKSHOP.HLR.TRANSITION_SETTING_LABEL",e.TRANSITION_SETTING_SLIDESHOW="WORKSHOP.HLR.TRANSITION_SETTING_SLIDESHOW",e.TRANSITION_SETTING_WALKTHROUGH="WORKSHOP.HLR.TRANSITION_SETTING_WALKTHROUGH",e.TYPE="WORKSHOP.HLR.TYPE",e.WALKTHROUGH_SPEED_SETTING_LABEL="WORKSHOP.HLR.WALKTHROUGH_SPEED_SETTING_LABEL",e.ZOOM_SPEED_SETTING_LABEL="WORKSHOP.HLR.ZOOM_SPEED_SETTING_LABEL"}(a=e.HLR||(e.HLR={})),function(e){e.TYPE="WORKSHOP.LABELS.TYPE",e.NUM_TYPE="WORKSHOP.LABELS.NUM_TYPE",e.EDIT_TEXT_CANCEL_CTA="WORKSHOP.LABELS.EDIT_TEXT_CANCEL_CTA",e.EDIT_TEXT_DONE_CTA="WORKSHOP.LABELS.EDIT_TEXT_DONE_CTA",e.INPUT_PLACEHOLDER="WORKSHOP.LABELS.INPUT_PLACEHOLDER",e.MOBILE_OVERLAY_MESSAGE="WORKSHOP.LABELS.MOBILE_OVERLAY_MESSAGE",e.ADD_LABEL_TOOLTIP_MESSAGE="WORKSHOP.LABELS.ADD_LABEL_TOOLTIP_MESSAGE",e.RENAME_LIST_ITEM_OPTION_CTA="WORKSHOP.LABELS.RENAME_LIST_ITEM_OPTION_CTA",e.DELETE_LIST_ITEM_OPTION_CTA="WORKSHOP.LABELS.DELETE_LIST_ITEM_OPTION_CTA",e.LIST_ITEM_INPUT_PLACEHOLDER="WORKSHOP.LABELS.LIST_ITEM_INPUT_PLACEHOLDER",e.MULTI_FLOOR_EMPTY_MESSAGE="WORKSHOP.LABELS.MULTI_FLOOR_EMPTY_MESSAGE",e.SINGLE_FLOOR_EMPTY_MESSAGE="WORKSHOP.LABELS.SINGLE_FLOOR_EMPTY_MESSAGE",e.HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.LABELS.HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.LABELS.SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.EDIT_LABEL="WORKSHOP.LABELS.EDIT_LABEL"}(l=e.LABELS||(e.LABELS={})),function(e){e.KITCHEN="WORKSHOP.LABEL_SUGGESTIONS.KITCHEN",e.PRIMARY_BEDROOM="WORKSHOP.LABEL_SUGGESTIONS.PRIMARY_BEDROOM",e.BEDROOM="WORKSHOP.LABEL_SUGGESTIONS.BEDROOM",e.PRIMARY_BATHROOM="WORKSHOP.LABEL_SUGGESTIONS.PRIMARY_BATHROOM",e.BATHROOM="WORKSHOP.LABEL_SUGGESTIONS.BATHROOM",e.LIVING_ROOM="WORKSHOP.LABEL_SUGGESTIONS.LIVING_ROOM",e.FAMILY_ROOM="WORKSHOP.LABEL_SUGGESTIONS.FAMILY_ROOM",e.DINING_ROOM="WORKSHOP.LABEL_SUGGESTIONS.DINING_ROOM",e.PATIO="WORKSHOP.LABEL_SUGGESTIONS.PATIO",e.BALCONY="WORKSHOP.LABEL_SUGGESTIONS.BALCONY",e.BACKYARD="WORKSHOP.LABEL_SUGGESTIONS.BACKYARD",e.FRONT_YARD="WORKSHOP.LABEL_SUGGESTIONS.FRONT_YARD",e.HALLWAY="WORKSHOP.LABEL_SUGGESTIONS.HALLWAY",e.LAUNDRY="WORKSHOP.LABEL_SUGGESTIONS.LAUNDRY",e.PANTRY="WORKSHOP.LABEL_SUGGESTIONS.PANTRY",e.CLOSET="WORKSHOP.LABEL_SUGGESTIONS.CLOSET",e.GARAGE="WORKSHOP.LABEL_SUGGESTIONS.GARAGE",e.DRIVEWAY="WORKSHOP.LABEL_SUGGESTIONS.DRIVEWAY",e.BASEMENT="WORKSHOP.LABEL_SUGGESTIONS.BASEMENT",e.FACADE="WORKSHOP.LABEL_SUGGESTIONS.FACADE",e.GARDEN="WORKSHOP.LABEL_SUGGESTIONS.GARDEN",e.LOBBY="WORKSHOP.LABEL_SUGGESTIONS.LOBBY",e.OFFICE="WORKSHOP.LABEL_SUGGESTIONS.OFFICE",e.POOL="WORKSHOP.LABEL_SUGGESTIONS.POOL",e.UNFURNISHED="WORKSHOP.LABEL_SUGGESTIONS.UNFURNISHED",e.STAIRWAY="WORKSHOP.LABEL_SUGGESTIONS.STAIRWAY",e.ELEVATOR="WORKSHOP.LABEL_SUGGESTIONS.ELEVATOR",e.ESCALATOR="WORKSHOP.LABEL_SUGGESTIONS.ESCALATOR",e.STUDY="WORKSHOP.LABEL_SUGGESTIONS.STUDY",e.SPA="WORKSHOP.LABEL_SUGGESTIONS.SPA",e.RECEPTION="WORKSHOP.LABEL_SUGGESTIONS.RECEPTION",e.MEETING_ROOM="WORKSHOP.LABEL_SUGGESTIONS.MEETING_ROOM",e.STORAGE="WORKSHOP.LABEL_SUGGESTIONS.STORAGE",e.BREAK_ROOM="WORKSHOP.LABEL_SUGGESTIONS.BREAK_ROOM",e.LUNCH_ROOM="WORKSHOP.LABEL_SUGGESTIONS.LUNCH_ROOM",e.CONFERENCE_ROOM="WORKSHOP.LABEL_SUGGESTIONS.CONFERENCE_ROOM"}(c=e.LABEL_SUGGESTIONS||(e.LABEL_SUGGESTIONS={})),function(e){e.ADD_VIEW_ITEM="WORKSHOP.LAYERS.ADD_VIEW_ITEM",e.DELETE_VIEW_ITEM="WORKSHOP.LAYERS.DELETE_VIEW_ITEM"}(d=e.LAYERS||(e.LAYERS={})),function(e){e.ADD="WORKSHOP.MATTERTAGS.ADD",e.ADD_FILE="WORKSHOP.MATTERTAGS.ADD_FILE",e.ADD_MATTERTAG_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.ADD_MATTERTAG_TOOLTIP_MESSAGE",e.ATTACHMENTS_LABEL="WORKSHOP.MATTERTAGS.ATTACHMENTS_LABEL",e.APPEARANCE_LABEL="WORKSHOP.MATTERTAGS.APPEARANCE_LABEL",e.BACK="WORKSHOP.MATTERTAGS.BACK",e.COLOR_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.COLOR_TOOLTIP_MESSAGE",e.DEFAULT_LIST_ITEM_TEXT="WORKSHOP.MATTERTAGS.DEFAULT_LIST_ITEM_TEXT",e.DEFAULT_TAG_TITLE="WORKSHOP.MATTERTAGS.DEFAULT_TAG_TITLE",e.DELETE_LIST_ITEM_OPTION_CTA="WORKSHOP.MATTERTAGS.DELETE_LIST_ITEM_OPTION_CTA",e.DELETE_MATTERTAGS_MODAL_MESSAGE="WORKSHOP.MATTERTAGS.DELETE_MATTERTAGS_MODAL_MESSAGE",e.DELETE_MATTERTAGS_MODAL_TITLE="WORKSHOP.MATTERTAGS.DELETE_MATTERTAGS_MODAL_TITLE",e.DELETE_TAGS_MODAL_MESSAGE="WORKSHOP.MATTERTAGS.DELETE_TAGS_MODAL_MESSAGE",e.DELETE_TAGS_MODAL_TITLE="WORKSHOP.MATTERTAGS.DELETE_TAGS_MODAL_TITLE",e.DESCRIPTION_PLACEHOLDER="WORKSHOP.MATTERTAGS.DESCRIPTION_PLACEHOLDER",e.DISCARD_MATTERTAG_MODAL_MESSAGE="WORKSHOP.MATTERTAGS.DISCARD_MATTERTAG_MODAL_MESSAGE",e.DISCARD_MATTERTAG_MODAL_TITLE="WORKSHOP.MATTERTAGS.DISCARD_MATTERTAG_MODAL_TITLE",e.DROP_FILES_MESSAGE="WORKSHOP.MATTERTAGS.DROP_FILES_MESSAGE",e.EDIT_BILLBOARD_CANCEL_CTA="WORKSHOP.MATTERTAGS.EDIT_BILLBOARD_CANCEL_CTA",e.EDIT_BILLBOARD_DONE_CTA="WORKSHOP.MATTERTAGS.EDIT_BILLBOARD_DONE_CTA",e.EDIT_LIST_ITEM_OPTION_CTA="WORKSHOP.MATTERTAGS.EDIT_LIST_ITEM_OPTION_CTA",e.HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.HIDE_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.HIDE_TOOLTIP_MESSAGE",e.KEYWORDS_LABEL="WORKSHOP.MATTERTAGS.KEYWORDS_LABEL",e.LINK_DISABLED_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.LINK_DISABLED_TOOLTIP_MESSAGE",e.LINK_EDITOR_APPLY_CTA="WORKSHOP.MATTERTAGS.LINK_EDITOR_APPLY_CTA",e.LINK_EDITOR_INVALID_TIP="WORKSHOP.MATTERTAGS.LINK_EDITOR_INVALID_TIP",e.LINK_EDITOR_LINK_ADD_LABEL="WORKSHOP.MATTERTAGS.LINK_EDITOR_LINK_ADD_LABEL",e.LINK_EDITOR_LINK_EDIT_LABEL="WORKSHOP.MATTERTAGS.LINK_EDITOR_LINK_EDIT_LABEL",e.LINK_EDITOR_MAX_LENGTH_TIP="WORKSHOP.MATTERTAGS.LINK_EDITOR_MAX_LENGTH_TIP",e.LINK_EDITOR_PREVIEW_TIP="WORKSHOP.MATTERTAGS.LINK_EDITOR_PREVIEW_TIP",e.LINK_EDITOR_REMOVE_TIP="WORKSHOP.MATTERTAGS.LINK_EDITOR_REMOVE_TIP",e.LINK_EDITOR_TEXT_LABEL="WORKSHOP.MATTERTAGS.LINK_EDITOR_TEXT_LABEL",e.LINK_EDITOR_TEXT_PLACEHOLDER="WORKSHOP.MATTERTAGS.LINK_EDITOR_TEXT_PLACEHOLDER",e.LINK_EDITOR_TIP_TEXT="WORKSHOP.MATTERTAGS.LINK_EDITOR_TIP_TEXT",e.LINK_EDITOR_URL_LABEL="WORKSHOP.MATTERTAGS.LINK_EDITOR_URL_LABEL",e.LINK_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.LINK_TOOLTIP_MESSAGE",e.LIST_BY_FLOOR_ALPHABETICAL_LABEL="WORKSHOP.MATTERTAGS.LIST_BY_FLOOR_ALPHABETICAL_LABEL",e.LIST_BY_FLOOR_ORDERED_LABEL="WORKSHOP.MATTERTAGS.LIST_BY_FLOOR_ORDERED_LABEL",e.LIST_IN_TAG_ORDER_LABEL="WORKSHOP.MATTERTAGS.LIST_IN_TAG_ORDER_LABEL",e.MAX_ATTACHMENTS_MESSAGE="WORKSHOP.MATTERTAGS.MAX_ATTACHMENTS_MESSAGE",e.MEDIA_LINK_APPLY_CTA="WORKSHOP.MATTERTAGS.MEDIA_LINK_APPLY_CTA",e.MEDIA_LINK_ERROR_MESSAGE="WORKSHOP.MATTERTAGS.MEDIA_LINK_ERROR_MESSAGE",e.MEDIA_LINK_HELP_LINK="WORKSHOP.MATTERTAGS.MEDIA_LINK_HELP_LINK",e.MEDIA_LINK_INVALID_URL_MESSAGE="WORKSHOP.MATTERTAGS.MEDIA_LINK_INVALID_URL_MESSAGE",e.MEDIA_LINK_LABEL="WORKSHOP.MATTERTAGS.MEDIA_LINK_LABEL",e.MEDIA_LINK_LOADING_MESSAGE="WORKSHOP.MATTERTAGS.MEDIA_LINK_LOADING_MESSAGE",e.MEDIA_LINK_SUPPORTED_FORMATS_LINK="WORKSHOP.MATTERTAGS.MEDIA_LINK_SUPPORTED_FORMATS_LINK",e.MEDIA_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.MEDIA_TOOLTIP_MESSAGE",e.MOBILE_OVERLAY_MESSAGE="WORKSHOP.MATTERTAGS.MOBILE_OVERLAY_MESSAGE",e.MOBILE_REORDER_MODAL_MESSAGE="WORKSHOP.MATTERTAGS.MOBILE_REORDER_MODAL_MESSAGE",e.MOBILE_REORDER_MODAL_TITLE="WORKSHOP.MATTERTAGS.MOBILE_REORDER_MODAL_TITLE",e.MULTI_FLOOR_EMPTY_MESSAGE="WORKSHOP.MATTERTAGS.MULTI_FLOOR_EMPTY_MESSAGE",e.NUM_TYPE="WORKSHOP.MATTERTAGS.NUM_TYPE",e.SAVE="WORKSHOP.MATTERTAGS.SAVE",e.SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.SHOW_STEM_LABEL="WORKSHOP.MATTERTAGS.SHOW_STEM_LABEL",e.SHOW_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.SHOW_TOOLTIP_MESSAGE",e.SINGLE_FLOOR_EMPTY_MESSAGE="WORKSHOP.MATTERTAGS.SINGLE_FLOOR_EMPTY_MESSAGE",e.STEM_SLIDER_RESET_CTA="WORKSHOP.MATTERTAGS.STEM_SLIDER_RESET_CTA",e.STEM_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.STEM_TOOLTIP_MESSAGE",e.SUPPORTED_FORMATS_MESSAGE="WORKSHOP.MATTERTAGS.SUPPORTED_FORMATS_MESSAGE",e.TAG_NUM_TYPE="WORKSHOP.MATTERTAGS.TAG_NUM_TYPE",e.TAG_REORDER_ENTER_LABEL="WORKSHOP.MATTERTAGS.TAG_REORDER_ENTER_LABEL",e.TAG_REORDER_EXIT_LABEL="WORKSHOP.MATTERTAGS.TAG_REORDER_EXIT_LABEL",e.TAG_RESET_ORDER="WORKSHOP.MATTERTAGS.TAG_RESET_ORDER",e.TAG_TYPE="WORKSHOP.MATTERTAGS.TAG_TYPE",e.TAGS_EMPTY_MULTI_FLOOR_MESSAGE="WORKSHOP.MATTERTAGS.TAGS_EMPTY_MULTI_FLOOR_MESSAGE",e.TAGS_EMPTY_SINGLE_FLOOR_MESSAGE="WORKSHOP.MATTERTAGS.TAGS_EMPTY_SINGLE_FLOOR_MESSAGE",e.TAGS_HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.TAGS_HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.TAGS_ORDERED_BY_CUSTOM_LABEL="WORKSHOP.MATTERTAGS.TAGS_ORDERED_BY_CUSTOM_LABEL",e.TAGS_ORDERED_BY_LOCATION_LABEL="WORKSHOP.MATTERTAGS.TAGS_ORDERED_BY_LOCATION_LABEL",e.TAGS_RESET_MODAL_BODY="WORKSHOP.MATTERTAGS.TAGS_RESET_MODAL_BODY",e.TAGS_RESET_MODAL_TITLE="WORKSHOP.MATTERTAGS.TAGS_RESET_MODAL_TITLE",e.TAGS_SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.MATTERTAGS.TAGS_SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.TITLE_DESC_LABEL="WORKSHOP.MATTERTAGS.TITLE_DESC_LABEL",e.TITLE_PLACEHOLDER="WORKSHOP.MATTERTAGS.TITLE_PLACEHOLDER",e.TYPE="WORKSHOP.MATTERTAGS.TYPE",e.UPLOAD_FILE="WORKSHOP.MATTERTAGS.UPLOAD_FILE",e.UPLOAD_IN_PROGRESS="WORKSHOP.MATTERTAGS.UPLOAD_IN_PROGRESS"}(u=e.MATTERTAGS||(e.MATTERTAGS={})),function(e){e.TYPE="WORKSHOP.MEASUREMENTS.TYPE",e.NUM_TYPE="WORKSHOP.MEASUREMENTS.NUM_TYPE",e.HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.MEASUREMENTS.HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.MEASUREMENTS.SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.OTHER_GROUP_LABEL="WORKSHOP.MEASUREMENTS.OTHER_GROUP_LABEL",e.RENAME_LIST_ITEM_OPTION_CTA="WORKSHOP.MEASUREMENTS.RENAME_LIST_ITEM_OPTION_CTA",e.DELETE_LIST_ITEM_OPTION_CTA="WORKSHOP.MEASUREMENTS.DELETE_LIST_ITEM_OPTION_CTA",e.LIST_ITEM_INPUT_PLACEHOLDER="WORKSHOP.MEASUREMENTS.LIST_ITEM_INPUT_PLACEHOLDER",e.MULTI_FLOOR_EMPTY_MESSAGE="WORKSHOP.MEASUREMENTS.MULTI_FLOOR_EMPTY_MESSAGE",e.SINGLE_FLOOR_EMPTY_MESSAGE="WORKSHOP.MEASUREMENTS.SINGLE_FLOOR_EMPTY_MESSAGE"}(h=e.MEASUREMENTS||(e.MEASUREMENTS={})),function(e){e.ERROR_TITLE="WORKSHOP.MODAL.ERROR_TITLE",e.SAVING_ERROR_TITLE="WORKSHOP.MODAL.SAVING_ERROR_TITLE",e.SAVING_ERROR_MESSAGE="WORKSHOP.MODAL.SAVING_ERROR_MESSAGE",e.NO="WORKSHOP.MODAL.NO",e.YES="WORKSHOP.MODAL.YES",e.CANCEL="WORKSHOP.MODAL.CANCEL",e.OK="WORKSHOP.MODAL.OK",e.DISCARD="WORKSHOP.MODAL.DISCARD",e.SAVE="WORKSHOP.MODAL.SAVE"}(p=e.MODAL||(e.MODAL={})),function(e){e.HAPPINESS_TITLE="WORKSHOP.MODEL_RATING.HAPPINESS_TITLE",e.HAPPINESS_BODY="WORKSHOP.MODEL_RATING.HAPPINESS_BODY",e.QUALITY_ISSUES_TITLE="WORKSHOP.MODEL_RATING.QUALITY_ISSUES_TITLE",e.QUALITY_ISSUES_LIGHTING="WORKSHOP.MODEL_RATING.QUALITY_ISSUES_LIGHTING",e.QUALITY_ISSUES_3D_MESH="WORKSHOP.MODEL_RATING.QUALITY_ISSUES_3D_MESH",e.QUALITY_ISSUES_COLORING="WORKSHOP.MODEL_RATING.QUALITY_ISSUES_COLORING",e.QUALITY_ISSUES_IMAGE_QUALITY="WORKSHOP.MODEL_RATING.QUALITY_ISSUES_IMAGE_QUALITY",e.NAVIGATION_ISSUES_TITLE="WORKSHOP.MODEL_RATING.NAVIGATION_ISSUES_TITLE",e.NAVIGATION_ISSUES_BLOCKED_DOORWAYS="WORKSHOP.MODEL_RATING.NAVIGATION_ISSUES_BLOCKED_DOORWAYS",e.NAVIGATION_ISSUES_OBSTRUCTIONS="WORKSHOP.MODEL_RATING.NAVIGATION_ISSUES_OBSTRUCTIONS",e.NAVIGATION_ISSUES_MISALIGNED_SCANS="WORKSHOP.MODEL_RATING.NAVIGATION_ISSUES_MISALIGNED_SCANS",e.NAVIGATION_ISSUES_FLOOR_SEPARATION="WORKSHOP.MODEL_RATING.NAVIGATION_ISSUES_FLOOR_SEPARATION",e.NAVIGATION_ISSUES_DISAPPEARING_FLOORS="WORKSHOP.MODEL_RATING.NAVIGATION_ISSUES_DISAPPEARING_FLOORS",e.FEEDBACK_TITLE="WORKSHOP.MODEL_RATING.FEEDBACK_TITLE",e.FEEDBACK_LABEL="WORKSHOP.MODEL_RATING.FEEDBACK_LABEL",e.THANK_YOU_HEADING="WORKSHOP.MODEL_RATING.THANK_YOU_HEADING",e.THANK_YOU_BODY="WORKSHOP.MODEL_RATING.THANK_YOU_BODY",e.THANK_YOU_CTA="WORKSHOP.MODEL_RATING.THANK_YOU_CTA",e.THANK_YOU_CTA_LINK_TEXT="WORKSHOP.MODEL_RATING.THANK_YOU_CTA_LINK_TEXT",e.SAVE="WORKSHOP.MODEL_RATING.SAVE",e.NEXT="WORKSHOP.MODEL_RATING.NEXT",e.PROGRESS="WORKSHOP.MODEL_RATING.PROGRESS"}(m=e.MODEL_RATING||(e.MODEL_RATING={})),function(e){e.SEARCH_GROUP_HEADER="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_GROUP_HEADER",e.SEARCH_GROUP_HIDE_ALL="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_GROUP_HIDE_ALL",e.SEARCH_GROUP_SHOW_ALL="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_GROUP_SHOW_ALL",e.SEARCH_GROUP_DELETE_ALL="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_GROUP_DELETE_ALL",e.SEARCH_ITEM_HIDE_TOOLTIP="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_ITEM_HIDE_TOOLTIP",e.SEARCH_ITEM_SHOW_TOOLTIP="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_ITEM_SHOW_TOOLTIP",e.SEARCH_ITEM_EDIT="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_ITEM_EDIT",e.SEARCH_ITEM_DELETE="WORKSHOP.OBJECT_TAG_SUGGESTION.SEARCH_ITEM_DELETE",e.SHOW_ONLY_IN_SEARCH="WORKSHOP.OBJECT_TAG_SUGGESTION.SHOW_ONLY_IN_SEARCH"}(f=e.OBJECT_TAG_SUGGESTION||(e.OBJECT_TAG_SUGGESTION={})),function(e){e.TYPE="WORKSHOP.PHOTOS.TYPE",e.NUM_TYPE="WORKSHOP.PHOTOS.NUM_TYPE",e.ADD_PHOTOS_CTA="WORKSHOP.PHOTOS.ADD_PHOTOS_CTA",e.ADDING_PHOTOS_CTA="WORKSHOP.PHOTOS.ADDING_PHOTOS_CTA",e.MODAL_TITLE="WORKSHOP.PHOTOS.MODAL_TITLE",e.NUM_SELECTED="WORKSHOP.PHOTOS.NUM_SELECTED",e.SELECT_ALL_CTA="WORKSHOP.PHOTOS.SELECT_ALL_CTA",e.UNSELECT_ALL_CTA="WORKSHOP.PHOTOS.UNSELECT_ALL_CTA",e.SAVING_TOAST_MESSAGE="WORKSHOP.PHOTOS.SAVING_TOAST_MESSAGE",e.SAVED_TOAST_MESSAGE="WORKSHOP.PHOTOS.SAVED_TOAST_MESSAGE",e.SAVED_TOAST_CTA="WORKSHOP.PHOTOS.SAVED_TOAST_CTA",e.ERROR_MODAL_TITLE="WORKSHOP.PHOTOS.ERROR_MODAL_TITLE",e.ERROR_MODAL_MESSAGE="WORKSHOP.PHOTOS.ERROR_MODAL_MESSAGE",e.CAMERA_PITCH_RESET_MESSAGE="WORKSHOP.PHOTOS.CAMERA_PITCH_RESET_MESSAGE",e.ZOOM_RESET_MESSAGE="WORKSHOP.PHOTOS.ZOOM_RESET_MESSAGE",e.ZOOM_IN_MESSAGE="WORKSHOP.PHOTOS.ZOOM_IN_MESSAGE",e.ZOOM_OUT_MESSAGE="WORKSHOP.PHOTOS.ZOOM_OUT_MESSAGE",e.CANNOT_SAVE_TOOLTIP_MESSAGE="WORKSHOP.PHOTOS.CANNOT_SAVE_TOOLTIP_MESSAGE",e.CANNOT_SAVE_SCAN_NUMBER_TOOLTIP_MESSAGE="WORKSHOP.PHOTOS.CANNOT_SAVE_SCAN_NUMBER_TOOLTIP_MESSAGE",e.CANNOT_SAVE_TOOLTIP_TITLE="WORKSHOP.PHOTOS.CANNOT_SAVE_TOOLTIP_TITLE",e.CANNOT_SAVE_TOOLTIP_CTA="WORKSHOP.PHOTOS.CANNOT_SAVE_TOOLTIP_CTA",e.CAN_TAKE_2D_PHOTO_TOOLTIP_MESSAGE="WORKSHOP.PHOTOS.CAN_TAKE_2D_PHOTO_TOOLTIP_MESSAGE",e.CAN_TAKE_360_PHOTO_TOOLTIP_MESSAGE="WORKSHOP.PHOTOS.CAN_TAKE_360_PHOTO_TOOLTIP_MESSAGE",e.CANNOT_TAKE_360_PHOTO_TOOLTIP_MESSAGE="WORKSHOP.PHOTOS.CANNOT_TAKE_360_PHOTO_TOOLTIP_MESSAGE",e.PANO_CTA="WORKSHOP.PHOTOS.PANO_CTA",e.SETTINGS_TOOLTIP_MESSAGE="WORKSHOP.PHOTOS.SETTINGS_TOOLTIP_MESSAGE",e.ASSETS_SETTING_LABEL="WORKSHOP.PHOTOS.ASSETS_SETTING_LABEL",e.SHOW_GRID_SETTING_LABEL="WORKSHOP.PHOTOS.SHOW_GRID_SETTING_LABEL",e.SNAPSHOT_ERROR_TOAST_MESSAGE="WORKSHOP.PHOTOS.SNAPSHOT_ERROR_TOAST_MESSAGE",e.SNAPSHOT_ERROR_TOAST_CTA="WORKSHOP.PHOTOS.SNAPSHOT_ERROR_TOAST_CTA"}(g=e.PHOTOS||(e.PHOTOS={})),function(e){e.COLOR_STEM_EDITOR_TITLE="WORKSHOP.PINS.COLOR_STEM_EDITOR_TITLE"}(v=e.PINS||(e.PINS={})),function(e){e.TYPE="WORKSHOP.SCANS.TYPE",e.NUM_TYPE="WORKSHOP.SCANS.NUM_TYPE",e.BATCH_SHOW_CTA="WORKSHOP.SCANS.BATCH_SHOW_CTA",e.BATCH_HIDE_CTA="WORKSHOP.SCANS.BATCH_HIDE_CTA",e.HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.SCANS.HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.SCANS.SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.LIST_ITEM_TEXT="WORKSHOP.SCANS.LIST_ITEM_TEXT",e.FLOOR_EMPTY_MESSAGE="WORKSHOP.SCANS.FLOOR_EMPTY_MESSAGE",e.NO_HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.SCANS.NO_HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.HLR_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.SCANS.HLR_LIST_ITEM_TOOLTIP_MESSAGE",e.START_LOCATION_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.SCANS.START_LOCATION_LIST_ITEM_TOOLTIP_MESSAGE",e.OVERLAY_HIDE_CTA="WORKSHOP.SCANS.OVERLAY_HIDE_CTA",e.OVERLAY_SHOW_CTA="WORKSHOP.SCANS.OVERLAY_SHOW_CTA",e.OVERLAY_HIDE_SCAN_CTA="WORKSHOP.SCANS.OVERLAY_HIDE_SCAN_CTA",e.OVERLAY_SHOW_SCAN_CTA="WORKSHOP.SCANS.OVERLAY_SHOW_SCAN_CTA",e.OVERLAY_PANORAMA_INFO="WORKSHOP.SCANS.OVERLAY_PANORAMA_INFO",e.OVERLAY_INFO="WORKSHOP.SCANS.OVERLAY_INFO",e.START_LOCATION_TOOLTIP_TITLE="WORKSHOP.SCANS.START_LOCATION_TOOLTIP_TITLE",e.START_LOCATION_TOOLTIP_MESSAGE="WORKSHOP.SCANS.START_LOCATION_TOOLTIP_MESSAGE",e.START_LOCATION_TOOLTIP_CTA="WORKSHOP.SCANS.START_LOCATION_TOOLTIP_CTA",e.REMOVE_HLR_MODAL_TITLE="WORKSHOP.SCANS.REMOVE_HLR_MODAL_TITLE",e.REMOVE_HLR_MODAL_MESSAGE="WORKSHOP.SCANS.REMOVE_HLR_MODAL_MESSAGE",e.REMOVE_HLR_MODAL_BATCH_MESSAGE="WORKSHOP.SCANS.REMOVE_HLR_MODAL_BATCH_MESSAGE",e.REMOVE_HLR_MODAL_WARNING="WORKSHOP.SCANS.REMOVE_HLR_MODAL_WARNING",e.REMOVE_SCANS_FROM_HLR_MODAL_TITLE="WORKSHOP.SCANS.REMOVE_SCANS_FROM_HLR_MODAL_TITLE",e.REMOVE_SCAN_FROM_HLR_MODAL_MESSAGE="WORKSHOP.SCANS.REMOVE_SCAN_FROM_HLR_MODAL_MESSAGE",e.REMOVE_BATCH_FROM_HLR_MODAL_SCANS_MESSAGE="WORKSHOP.SCANS.REMOVE_BATCH_FROM_HLR_MODAL_SCANS_MESSAGE",e.REMOVE_BATCH_FROM_HLR_MODAL_HIGHLIGHTS_MESSAGE="WORKSHOP.SCANS.REMOVE_BATCH_FROM_HLR_MODAL_HIGHLIGHTS_MESSAGE"}(y=e.SCANS||(e.SCANS={})),function(e){e.ADVANCED_SPACE_SEARCH_LABEL="WORKSHOP.SETTINGS.ADVANCED_SPACE_SEARCH_LABEL",e.ADVANCED_SPACE_SEARCH_MESSAGE="WORKSHOP.SETTINGS.ADVANCED_SPACE_SEARCH_MESSAGE",e.ADVANCED_DOLLHOUSE_LABEL="WORKSHOP.SETTINGS.ADVANCED_DOLLHOUSE_LABEL",e.ADVANCED_DOLLHOUSE_MESSAGE="WORKSHOP.SETTINGS.ADVANCED_DOLLHOUSE_MESSAGE",e.ADVANCED_FLOORPLAN_LABEL="WORKSHOP.SETTINGS.ADVANCED_FLOORPLAN_LABEL",e.ADVANCED_FLOORPLAN_MESSAGE="WORKSHOP.SETTINGS.ADVANCED_FLOORPLAN_MESSAGE",e.ADVANCED_FLOOR_SELECTION_LABEL="WORKSHOP.SETTINGS.ADVANCED_FLOOR_SELECTION_LABEL",e.ADVANCED_FLOOR_SELECTION_MESSAGE="WORKSHOP.SETTINGS.ADVANCED_FLOOR_SELECTION_MESSAGE",e.ADVANCED_HEADER="WORKSHOP.SETTINGS.ADVANCED_HEADER",e.ADVANCED_MEASUREMENT_MODE_LABEL="WORKSHOP.SETTINGS.ADVANCED_MEASUREMENT_MODE_LABEL",e.ADVANCED_MEASUREMENT_MODE_MENU_LABEL="WORKSHOP.SETTINGS.ADVANCED_MEASUREMENT_MODE_MENU_LABEL",e.ADVANCED_MEASUREMENT_MODE_MESSAGE="WORKSHOP.SETTINGS.ADVANCED_MEASUREMENT_MODE_MESSAGE",e.ADVANCED_ROOM_LABELS_LABEL="WORKSHOP.SETTINGS.ADVANCED_ROOM_LABELS_LABEL",e.ADVANCED_ROOM_LABELS_MESSAGE="WORKSHOP.SETTINGS.ADVANCED_ROOM_LABELS_MESSAGE",e.ADVANCED_ROOM_LABELS_MENU_LABEL="WORKSHOP.SETTINGS.ADVANCED_ROOM_LABELS_MENU_LABEL",e.HIDE_LABELS_IN_DOLLHOUSE_OPTION="WORKSHOP.SETTINGS.HIDE_LABELS_IN_DOLLHOUSE_OPTION",e.HIDE_SAVED_MEASUREMENTS_OPTION="WORKSHOP.SETTINGS.HIDE_SAVED_MEASUREMENTS_OPTION",e.HLR_OPTION_LABEL="WORKSHOP.SETTINGS.HLR_OPTION_LABEL",e.HLR_OPTION_MESSAGE="WORKSHOP.SETTINGS.HLR_OPTION_MESSAGE",e.NAV_OPTION_ADVANCED="WORKSHOP.SETTINGS.NAV_OPTION_ADVANCED",e.NAV_OPTION_PRESENTATION="WORKSHOP.SETTINGS.NAV_OPTION_PRESENTATION",e.NAV_OPTION_TOUR_HLR="WORKSHOP.SETTINGS.NAV_OPTION_TOUR_HLR",e.NAV_OPTION_UNITS="WORKSHOP.SETTINGS.NAV_OPTION_UNITS",e.SHOW_SAVED_MEASUREMENTS_OPTION="WORKSHOP.SETTINGS.SHOW_SAVED_MEASUREMENTS_OPTION",e.SHOW_LABELS_IN_DOLLHOUSE_OPTION="WORKSHOP.SETTINGS.SHOW_LABELS_IN_DOLLHOUSE_OPTION",e.PRESENTATION_BACKGROUND_BLACK_LABEL="WORKSHOP.SETTINGS.PRESENTATION_BACKGROUND_BLACK_LABEL",e.PRESENTATION_BACKGROUND_GREY_LABEL="WORKSHOP.SETTINGS.PRESENTATION_BACKGROUND_GREY_LABEL",e.PRESENTATION_BACKGROUND_HEADER="WORKSHOP.SETTINGS.PRESENTATION_BACKGROUND_HEADER",e.PRESENTATION_BACKGROUND_SUBHEADER="WORKSHOP.SETTINGS.PRESENTATION_BACKGROUND_SUBHEADER",e.PRESENTATION_BACKGROUND_WHITE_LABEL="WORKSHOP.SETTINGS.PRESENTATION_BACKGROUND_WHITE_LABEL",e.PRESENTATION_HEADER="WORKSHOP.SETTINGS.PRESENTATION_HEADER",e.PRESENTATION_INFORMATION_EVERYTHING_LABEL="WORKSHOP.SETTINGS.PRESENTATION_INFORMATION_EVERYTHING_LABEL",e.PRESENTATION_INFORMATION_EVERYTHING_MESSAGE="WORKSHOP.SETTINGS.PRESENTATION_INFORMATION_EVERYTHING_MESSAGE",e.PRESENTATION_INFORMATION_COMPACT_LABEL="WORKSHOP.SETTINGS.PRESENTATION_INFORMATION_COMPACT_LABEL",e.PRESENTATION_INFORMATION_COMPACT_MESSAGE="WORKSHOP.SETTINGS.PRESENTATION_INFORMATION_COMPACT_MESSAGE",e.PRESENTATION_INFORMATION_HEADER="WORKSHOP.SETTINGS.PRESENTATION_INFORMATION_HEADER",e.PRESENTATION_INFORMATION_NONE_LABEL="WORKSHOP.SETTINGS.PRESENTATION_INFORMATION_NONE_LABEL",e.TOUR_AND_HLR_HEADER="WORKSHOP.SETTINGS.TOUR_AND_HLR_HEADER",e.TOUR_MODE_LEGACY_LABEL="WORKSHOP.SETTINGS.TOUR_MODE_LEGACY_LABEL",e.TOUR_MODE_LEGACY_MESSAGE="WORKSHOP.SETTINGS.TOUR_MODE_LEGACY_MESSAGE",e.TOUR_MODE_NONE_LABEL="WORKSHOP.SETTINGS.TOUR_MODE_NONE_LABEL",e.TOUR_MODE_STORY_LABEL="WORKSHOP.SETTINGS.TOUR_MODE_STORY_LABEL",e.TOUR_MODE_STORY_MESSAGE="WORKSHOP.SETTINGS.TOUR_MODE_STORY_MESSAGE",e.TOUR_OPTION_LABEL="WORKSHOP.SETTINGS.TOUR_OPTION_LABEL",e.TOUR_OPTION_MESSAGE="WORKSHOP.SETTINGS.TOUR_OPTION_MESSAGE",e.UNITS_HEADER="WORKSHOP.SETTINGS.UNITS_HEADER",e.UNITS_IMPERIAL_CTA="WORKSHOP.SETTINGS.UNITS_IMPERIAL_CTA",e.UNITS_METRIC_CTA="WORKSHOP.SETTINGS.UNITS_METRIC_CTA",e.UNITS_SUBHEADER="WORKSHOP.SETTINGS.UNITS_SUBHEADER"}(b=e.SETTINGS||(e.SETTINGS={})),function(e){e.ENABLED_TOOLTIP_TITLE="WORKSHOP.START_LOCATION.ENABLED_TOOLTIP_TITLE",e.DISABLED_TOOLTIP_TITLE="WORKSHOP.START_LOCATION.DISABLED_TOOLTIP_TITLE",e.HIDDEN_SWEEP_MESSAGE="WORKSHOP.START_LOCATION.HIDDEN_SWEEP_MESSAGE",e.UNPLACED_360_MESSAGE="WORKSHOP.START_LOCATION.UNPLACED_360_MESSAGE",e.ENABLED_MESSAGE="WORKSHOP.START_LOCATION.ENABLED_MESSAGE",e.TOOLTIP_CTA="WORKSHOP.START_LOCATION.TOOLTIP_CTA",e.SET_NEW_LOCATION_CTA="WORKSHOP.START_LOCATION.SET_NEW_LOCATION_CTA",e.SETTING_NEW_LOCATION_CTA="WORKSHOP.START_LOCATION.SETTING_NEW_LOCATION_CTA",e.THUMBNAIL_PREVIEW_CTA="WORKSHOP.START_LOCATION.THUMBNAIL_PREVIEW_CTA",e.TAG_ORDER_RESET_TITLE="WORKSHOP.START_LOCATION.TAG_ORDER_RESET_TITLE",e.TAG_ORDER_RESET_MESSAGE="WORKSHOP.START_LOCATION.TAG_ORDER_RESET_MESSAGE",e.TAG_ORDER_RESET_CONFIRM="WORKSHOP.START_LOCATION.TAG_ORDER_RESET_CONFIRM",e.TAG_ORDER_RESET_CANCEL="WORKSHOP.START_LOCATION.TAG_ORDER_RESET_CANCEL"}(S=e.START_LOCATION||(e.START_LOCATION={})),function(e){e.NUM_TYPE="WORKSHOP.TRIM.NUM_TYPE",e.HIDE_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.TRIM.HIDE_LIST_ITEM_TOOLTIP_MESSAGE",e.SHOW_LIST_ITEM_TOOLTIP_MESSAGE="WORKSHOP.TRIM.SHOW_LIST_ITEM_TOOLTIP_MESSAGE",e.DELETE_LIST_ITEM_OPTION_CTA="WORKSHOP.TRIM.DELETE_LIST_ITEM_OPTION_CTA",e.RENAME_LIST_ITEM_OPTION_CTA="WORKSHOP.TRIM.RENAME_LIST_ITEM_OPTION_CTA",e.LIST_ITEM_INPUT_PLACEHOLDER="WORKSHOP.TRIM.LIST_ITEM_INPUT_PLACEHOLDER",e.DEFAULT_NAME="WORKSHOP.TRIM.DEFAULT_NAME",e.ALL_FLOORS="WORKSHOP.TRIM.ALL_FLOORS",e.EMPTY_FLOOR_MESSAGE="WORKSHOP.TRIM.EMPTY_FLOOR_MESSAGE",e.SIDE_POSE_CTA="WORKSHOP.TRIM.SIDE_POSE_CTA",e.TOP_POSE_CTA="WORKSHOP.TRIM.TOP_POSE_CTA",e.PERSPECTIVE_POSE_CTA="WORKSHOP.TRIM.PERSPECTIVE_POSE_CTA",e.SIDE_POSE_TOOLTIP="WORKSHOP.TRIM.SIDE_POSE_TOOLTIP",e.LEFT_SIDE_POSE_TOOLTIP="WORKSHOP.TRIM.LEFT_SIDE_POSE_TOOLTIP",e.RIGHT_SIDE_POSE_TOOLTIP="WORKSHOP.TRIM.RIGHT_SIDE_POSE_TOOLTIP",e.TOP_POSE_TOOLTIP="WORKSHOP.TRIM.TOP_POSE_TOOLTIP",e.PERSPECTIVE_POSE_TOOLTIP="WORKSHOP.TRIM.PERSPECTIVE_POSE_TOOLTIP",e.UNABLE_TO_SAVE_CHANGES_ERROR_MESSAGE="WORKSHOP.TRIM.UNABLE_TO_SAVE_CHANGES_ERROR_MESSAGE",e.ADD_INDIVIDUAL_FLOOR_TRIM_TOOLTIP="WORKSHOP.TRIM.ADD_INDIVIDUAL_FLOOR_TRIM_TOOLTIP",e.ADD_ALL_FLOORS_TRIM_TOOLTIP="WORKSHOP.TRIM.ADD_ALL_FLOORS_TRIM_TOOLTIP",e.MAX_INDIVIDUAL_FLOOR_TRIMS_TOOLTIP="WORKSHOP.TRIM.MAX_INDIVIDUAL_FLOOR_TRIMS_TOOLTIP",e.MAX_ALL_FLOORS_TRIMS_TOOLTIP="WORKSHOP.TRIM.MAX_ALL_FLOORS_TRIMS_TOOLTIP",e.MAX_TRIMS_ERROR_MESSAGE="WORKSHOP.TRIM.MAX_TRIMS_ERROR_MESSAGE",e.KEEP_TOGGLE="WORKSHOP.TRIM.KEEP_TOGGLE",e.REMOVE_TOGGLE="WORKSHOP.TRIM.REMOVE_TOGGLE",e.TOOL_ROTATION_CTA="WORKSHOP.TRIM.TOOL_ROTATION_CTA",e.TOOL_POSITION_CTA="WORKSHOP.TRIM.TOOL_POSITION_CTA",e.TOOL_SCALE_CTA="WORKSHOP.TRIM.TOOL_SCALE_CTA",e.TOOL_ROTATION_TOOLTIP="WORKSHOP.TRIM.TOOL_ROTATION_TOOLTIP",e.TOOL_POSITION_TOOLTIP="WORKSHOP.TRIM.TOOL_POSITION_TOOLTIP",e.TOOL_SCALE_TOOLTIP="WORKSHOP.TRIM.TOOL_SCALE_TOOLTIP",e.DELETE_TRIM="WORKSHOP.TRIM.DELETE_TRIM",e.COMPLETE_TRIM="WORKSHOP.TRIM.COMPLETE_TRIM",e.ADD_TRIM="WORKSHOP.TRIM.ADD_TRIM",e.RESET_ROTATION="WORKSHOP.TRIM.RESET_ROTATION",e.HIDE_PANO_LIST_ITEM_TOOLTIP="WORKSHOP.TRIM.HIDE_PANO_LIST_ITEM_TOOLTIP",e.SHOW_PANO_LIST_ITEM_TOOLTIP="WORKSHOP.TRIM.SHOW_PANO_LIST_ITEM_TOOLTIP",e.MOVE_TRIM_ALL_FLOORS="WORKSHOP.TRIM.MOVE_TRIM_ALL_FLOORS"}(E=e.TRIM||(e.TRIM={})),function(e){e.NUM_TYPE="WORKSHOP.VIEWS_360.NUM_TYPE",e.START_LOCATION_REMOVAL_MESSAGE="WORKSHOP.VIEWS_360.START_LOCATION_REMOVAL_MESSAGE",e.START_LOCATION_MARKER_MESSAGE="WORKSHOP.VIEWS_360.START_LOCATION_MARKER_MESSAGE",e.DEFAULT_NAME="WORKSHOP.VIEWS_360.DEFAULT_NAME",e.OVERLAY_MESSAGE="WORKSHOP.VIEWS_360.OVERLAY_MESSAGE",e.OVERLAY_INFO_MISSING_SWEEP="WORKSHOP.VIEWS_360.OVERLAY_INFO_MISSING_SWEEP",e.OVERLAY_INFO_CURRENT_SWEEP="WORKSHOP.VIEWS_360.OVERLAY_INFO_CURRENT_SWEEP",e.OVERLAY_INFO_SELECTED_SWEEP="WORKSHOP.VIEWS_360.OVERLAY_INFO_SELECTED_SWEEP",e.ROTATE_TOOLTIP_TITLE="WORKSHOP.VIEWS_360.ROTATE_TOOLTIP_TITLE",e.ROTATE_TOOLTIP_MESSAGE="WORKSHOP.VIEWS_360.ROTATE_TOOLTIP_MESSAGE",e.ROTATE_TOOLTIP_CTA="WORKSHOP.VIEWS_360.ROTATE_TOOLTIP_CTA",e.UNPLACED_CARD_MESSAGE="WORKSHOP.VIEWS_360.UNPLACED_CARD_MESSAGE",e.RENAME_ITEM_OPTION_CTA="WORKSHOP.VIEWS_360.RENAME_ITEM_OPTION_CTA",e.REMOVE_ITEM_OPTION_CTA="WORKSHOP.VIEWS_360.REMOVE_ITEM_OPTION_CTA",e.NO_VIEWS_MESSAGE="WORKSHOP.VIEWS_360.NO_VIEWS_MESSAGE"}(T=e.VIEWS_360||(e.VIEWS_360={})),function(e){e.TOAST_MESSAGE="WORKSHOP.VR.TOAST_MESSAGE",e.TOAST_CTA="WORKSHOP.VR.TOAST_CTA"}(w=e.VR||(e.VR={}))}(a=e.WORKSHOP||(e.WORKSHOP={}))}(i||(i={}));const s=i},93510:(e,t,n)=>{"use strict";var i;function s(e){return e.match(/us|mm|lr$/i)?i.IMPERIAL:i.METRIC}n.d(t,{M:()=>i,z:()=>s}),function(e){e.IMPERIAL="imperial",e.METRIC="metric"}(i||(i={}))},37367:(e,t,n)=>{"use strict";n.d(t,{i:()=>s,y:()=>r});var i=n(88599);function s(e){if(!e)return i.k$;if(r(e))return e;const t=e.toLocaleLowerCase();if(t in i.Xy)return i.Xy[t];const[n]=t.split("-");return n in i.Xy?i.Xy[n]:(i.E7.find((e=>e.startsWith(t))),i.k$)}function r(e){return i.E7.includes(e)}},41345:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});var i=n(67294),s=n(60405);function r(){const{locale:e}=(0,i.useContext)(s.I);return e}},39142:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>LocaleModule});var i=n(57227),s=n(14877),r=n(54078),o=n(88599);async function a(e,t){const n=function(e){return e===o.k$?"./locale/strings.json":`./locale/messages/strings_${e}.json`}(e),i=await t.get(n);return JSON.parse(i)}var l=n(2252),c=n(19718),d=n(87100),u=n(37367);class LocaleModule extends i.Y{constructor(){super(...arguments),this.name="locale"}async init(e,t){this._languageCode=function(e){var t;const n=(0,d.eY)("lang",""),i=(0,l.ht)(),s=null!==(t=(0,c.$)("SESSvl",""))&&void 0!==t?t:"",r=""===s||-1!==s.search(/^en/),o=n||(e?r?i:s:i);return(0,u.i)(o)}(e.isLoggedIn);const n=this._languageCode.substr(0,2);this.polyglot=new r({locale:n,interpolation:{prefix:"%{",suffix:"}"},onMissingKey:e=>(this.log.warn("Missing phrase key:"+e),LocaleModule.missingPrefix+e)});const i=await async function(e,t){const n=await a(e,t);if(e===o.k$)return n;const i=await a(o.k$,t);return Object.assign(Object.assign({},i),n)}(this._languageCode,e.queue);this.polyglot.extend(i),this.registerSettings(t)}t(e,t){return this.polyglot.t(e,t)}get languageCode(){return this._languageCode}async registerSettings(e){(await e.getModuleBySymbol(s.y.SETTINGS)).registerSetting("Locale",o.Zs,this.languageCode,!1)}}LocaleModule.missingPrefix="FIX-"},88599:(e,t,n)=>{"use strict";n.d(t,{E7:()=>i,k$:()=>s,Xy:()=>r,Zs:()=>o});const i=["en-US","es","fr","de","ru","ja","zh-CN","zh-TW","ko","nl","it","pt"],s="en-US",r=Object.assign(Object.assign({},i.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.toLowerCase()]:t})),{})),{en:"en-US",zh:"zh-CN",cn:"zh-CN",jp:"ja"}),o="language_code"},95998:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>LoginRedirect});var i=n(67294),s=n(20745),r=n(57227),o=n(39142),a=n(31013),l=n(85893),c=n(94184),d=n.n(c),u=n(92759),h=n(61445);class LoginRedirectUi extends i.Component{constructor(e){super(e),this.signup=()=>{window.top&&(window.top.location.href=this.props.registerUrl)}}render(){const{loginUrl:e,backgroundUrl:t}=this.props,n=t||u;return(0,l.jsx)("div",Object.assign({className:"login-redirect-screen",style:{backgroundImage:`url(${n})`}},{children:(0,l.jsx)("div",Object.assign({className:d()("login-redirect",{skrim:!!t})},{children:(0,l.jsxs)("div",Object.assign({className:"login-redirect-body"},{children:[(0,l.jsx)("h1",Object.assign({className:"login-redirect-title"},{children:"You have been invited to this space, create an account to join the conversation."})),(0,l.jsx)("div",Object.assign({className:"login-redirect-create"},{children:(0,l.jsx)(h.zx,Object.assign({buttonSize:h.qE.LARGE,buttonStyle:h.ZJ.LIGHT,onClick:this.signup},{children:"Create an Account"}))})),(0,l.jsxs)("div",Object.assign({className:"login-redirect-link"},{children:["Already have an account?",(0,l.jsx)("a",Object.assign({className:"link",href:e},{children:"Sign in"}))]}))]}))}))}))}}class LoginRedirect extends r.Y{constructor(){super(...arguments),this.name="login-redirect",this.authenticated=!1}async init(e,t){this.config=e,this.engine=t}async loadUi(){var e;const{container:t,loginUrl:n,registerUrl:r}=this.config,l=await this.engine.getModule(o.default),c=encodeURIComponent((null===(e=window.top)||void 0===e?void 0:e.location.href)||"");return this.reactContainer=document.createElement("div"),this.reactContainer.id="login-redirect-container",t.appendChild(this.reactContainer),this.reactRoot=(0,s.s)(this.reactContainer),this.reactRoot.render((0,i.createElement)(LoginRedirectUi,{locale:l,backgroundUrl:this.getBackground(),loginUrl:`${n}?target=${c}`,registerUrl:`${r}?target=${c}`})),new a.Q}async unloadUi(){return!!this.reactContainer&&(this.reactRoot.unmount(),this.reactContainer.remove(),delete this.reactContainer,!0)}getBackground(){const{baseUrl:e,modelId:t}=this.config;if(!t||!e)return;const n=window.devicePixelRatio||1;return`${e}/api/v1/player/models/${t}/thumb?width=${Math.max(window.innerWidth,400)}&dpr=${n}&disable=upscale`}}},1001:(e,t,n)=>{"use strict";n.d(t,{$:()=>DescriptionParser});var i=n(25551),s=n(3922),r=n(11679),o=n(2252);class DescriptionParser{constructor(e){this.modelSID=e.model,this.capabilites={links:{enable:e.supportLinks,keepLabels:e.keepLinkLabels}}}parse(e){const t=[];if(!e)return[];return e.split("[").map((function(e,t){return 0===t?e:"["+e})).forEach((e=>{const n=this.findLink(e);n?-1===n.url.indexOf("javascript:")&&(this.addLinkChunk(t,n),this.addTextChunk(t,e.slice(n.markdown.length))):this.addTextChunk(t,e)})),t}findLink(e){const t=e.match(/\[([^\]]*)\]\((.*)\)/);if(!t)return null;const n=t[2];let i=1,s=0;for(;s<n.length&&("("===n[s]?i++:")"===n[s]&&i--,0!==i);)s++;const r=n.length-s;return{markdown:t[0].substring(0,t[0].length-r),label:t[1],url:this.conditionallyEncode(t[2].substring(0,s))}}conditionallyEncode(e){return this.needsEncoding(e)?encodeURI(e):e}needsEncoding(e){if(e.match(o.jx))return!0;let t=e;try{t=decodeURI(e)}catch(e){}return!1}addTextChunk(e,t){0!==t.length&&e.push({type:r.z.text,text:t})}addLinkChunk(e,t){if(!this.capabilites.links.enable)return void(this.capabilites.links.keepLabels&&this.addTextChunk(e,t.label));const n={label:t.label,url:t.url,type:i.U.EXT_LINK};-1===n.url.indexOf("://")&&(n.url="http://"+n.url);const o=-1!==n.url.indexOf("matterport.com/show"),a=-1!==n.url.indexOf(window.location.host+"/show");if(o||a){const e=-1!==n.url.indexOf(this.modelSID),t=s.K.deserialize(n.url);e&&t?(n.type=i.U.NAVIGATION,n.navigationData=t):(n.type=i.U.MODEL,n.url+="&play=1")}e.push({type:r.z.link,link:n})}static getNumLinks(e){let t=0;return e.forEach((e=>{"link"===e.type&&void 0!==e.link&&t++})),t}}},25551:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i}),function(e){e[e.NAVIGATION=0]="NAVIGATION",e[e.MODEL=1]="MODEL",e[e.EXT_LINK=2]="EXT_LINK"}(i||(i={}));i.NAVIGATION,i.MODEL,i.EXT_LINK},484:(e,t,n)=>{"use strict";n.d(t,{U:()=>Mattertag});var i=n(2212),s=n(77364),r=n(11679),o=n(48558),a=n(98254);class Mattertag extends a.T{constructor(e){super(),this.sid="",this.created=new Date,this.modified=new Date,this.enabled=!0,this.label="",this.description="",this.parsedDescription=[],this.anchorPosition=new i.Vector3,this.anchorNormal=new i.Vector3(0,1,0),this.stemVector=new i.Vector3(0,0,(0,o._F)(1)),this.stemHeight=(0,o._F)(1),this.stemVisible=!0,this.fileAttachments=[],this.externalAttachments=[],this.sandboxAttachments=[],this.color=s.I.MATTERTAG_BLUE.clone(),this.mediaType=r.z.none,this.mediaSrc="",this.widgetFrame=null,this.keywords=[],e&&Object.assign(this,e)}copy(e){this.anchorNormal.copy(e.anchorNormal),this.anchorPosition.copy(e.anchorPosition),this.color.copy(e.color),this.created.setTime(e.created.getTime()),this.description=e.description,this.enabled=e.enabled,this.floorId=e.floorId,this.roomId=e.roomId,this.label=e.label,this.mediaType=e.mediaType,this.mediaSrc=e.mediaSrc,this.modified.setTime(e.modified.getTime()),this.sid=e.sid,this.stemVector.copy(e.stemVector),this.stemHeight=e.stemHeight,this.stemVisible=e.stemVisible,this.fileAttachments=e.fileAttachments,this.externalAttachments=e.externalAttachments,this.sandboxAttachments=e.sandboxAttachments,this.objectAnnotationId=e.objectAnnotationId,this.keywords=e.keywords,this.parsedDescription=[];for(const t of e.parsedDescription)this.parsedDescription.push({link:t.link&&{label:t.link.label.slice(),url:t.link.url.slice(),type:t.link.type,navigationData:t.link.navigationData&&{floorVisibility:t.link.navigationData.floorVisibility,mode:t.link.navigationData.mode,sweepIndex:t.link.navigationData.sweepIndex,panoId:t.link.navigationData.panoId,position:t.link.navigationData.position&&t.link.navigationData.position.clone(),quaternion:t.link.navigationData.quaternion.clone(),zoom:t.link.navigationData.zoom}},text:t.text,type:t.type});return this.copyWidgetFrame(e.widgetFrame),this.commit(),this}clone(){return(new Mattertag).copy(this)}copyWidgetFrame(e){e?this.widgetFrame?(!function(e,t,...n){for(const i of n)e[i]=t[i]}(this.widgetFrame.size,e.size,"width","height"),this.widgetFrame.frame=e.frame):this.widgetFrame=Object.assign({},e):this.widgetFrame=null}refresh(e){this.fileAttachments.forEach((t=>{const n=e[t.id];n&&(t.thumbnailUrl.refreshFrom(n.thumbnailUrl),t.url.refreshFrom(n.url))}))}getPin(){const{anchorPosition:e,color:t,enabled:n,floorId:i,roomId:s,stemVector:r,stemHeight:o}=this;return{anchorPosition:e,color:t.getHexString(),floorId:i,roomId:s,stemEnabled:n,stemNormal:r,stemLength:o}}updateFromOptions(e,t){void 0!==e.color&&(this.color=new i.Color(e.color.r,e.color.g,e.color.b)),void 0!==e.enabled&&(this.enabled=e.enabled),void 0!==e.stemHeight&&(this.stemHeight=e.stemHeight,this.stemVector.copy(this.anchorNormal).setLength(e.stemHeight)),void 0!==e.stemVisible&&(this.stemVisible=e.stemVisible),void 0!==e.label&&(this.label=e.label.slice()),void 0!==e.description&&(this.description=e.description,this.parsedDescription=t.parse(this.description)),void 0!==e.floorId&&(this.floorId=e.floorId),void 0!==e.normal&&(this.anchorNormal.copy(e.normal).normalize(),this.stemVector.copy(e.normal).setLength(this.stemHeight)),void 0!==e.position&&this.anchorPosition.copy(e.position),void 0!==e.keywords&&(this.keywords=e.keywords.slice()),void 0!==e.objectAnnotationId&&(this.objectAnnotationId=e.objectAnnotationId)}}},11679:(e,t,n)=>{"use strict";var i;n.d(t,{z:()=>i}),function(e){e.text="text",e.link="link",e.photo="photo",e.video="video",e.rich="rich",e.none="none",e.error="error"}(i||(i={})),function(e){e.parse=t=>null!==t&&t in e?e[t]:e.none}(i||(i={}))},69098:(e,t,n)=>{"use strict";n.d(t,{V:()=>i,s:()=>MattertagDataAnalytics});var i,s=n(61709),r=n(81111),o=n(76641),a=n(11679);!function(e){e.OVERLAY="overlay",e.HOVER="hover",e.OPEN="open"}(i||(i={}));class MattertagDataAnalytics{constructor(){this.handlers=[{msgType:o.QY,func:(e,t,n)=>{const i=n.tryGetData(s.n),o=n.tryGetData(r.P5);if(!i||!o)return;const l=i.getTagCount(),c=o.getVisitedTags().length,d=o.getViewedTagCount(),u=i.getTag(t.sid);u&&e.track("tag_opened",{tag_count:l,tag_id:t.sid,tags_visited:c,tag_view_count:d,has_media:u.mediaType!==a.z.none})}},{msgType:o.dJ,func:(e,t,n)=>{const i=n.tryGetData(s.n),o=n.tryGetData(r.P5);if(!i||!o)return;const a=i.getTagCount(),l=o.getVisitedTags().length,c=o.getViewedTagCount(),d=i.getTag(t.sid);if(d){const n={mattertag_sid:t.sid,mattertag_view:t.view,mattertag_media:d.mediaType,mattertags_count:a,mattertags_total_views:c,mattertags_visited:l};e.track("mattertag_view",n)}}}]}}},23400:(e,t,n)=>{"use strict";n.d(t,{cH:()=>GetDiscPositionsCommand,Fz:()=>AddMattertagCommand,Gn:()=>RemoveMattertagCommand,Ek:()=>EditMattertagCommand,Mm:()=>SaveNewMattertagCommand,qq:()=>SaveMattertagChangesCommand});var i=n(93037);class GetDiscPositionsCommand extends i.m{constructor(e){super(),this.id="MATTERTAG_DISC_POSITIONS",this.payload={tags:e}}}class AddMattertagCommand extends i.m{constructor(e,t,n){super(),this.id="ADD_MATTERTAG",this.payload={positionOptions:e,standardOptions:t,mediaOptions:n}}}class RemoveMattertagCommand extends i.m{constructor(e){super(),this.id="DELETE_MATTERTAG",this.payload={sid:e}}}class EditMattertagCommand extends i.m{constructor(e,t,n,i){super(),this.payload={sid:e,standardOptions:t,mediaOptions:n,positionOptions:i}}}class SaveNewMattertagCommand extends i.m{constructor(e,t,n=[],i){super(),this.payload={id:e,properties:t,fileAttachments:n,embed:i}}}class SaveMattertagChangesCommand extends i.m{constructor(e,t,n=[],i=[],s){super(),this.payload={id:e,properties:t,pendingAttachments:n,removedAttachments:i,embed:s}}}},61709:(e,t,n)=>{"use strict";n.d(t,{n:()=>MattertagsData});var i=n(35424),s=n(66910),r=n(28129);class MattertagsData extends i.V{constructor(e){if(super(),this.name="tag",this.mattertags=(0,s.q)(),e)for(const t of e)this.mattertags.set(t.sid,t);this.commit()}clear(){for(const e of this.mattertags)this.removeTag(e.sid)}clone(){return(new MattertagsData).copy(this)}copy(e){return MattertagsData.copyTagCollection(this,e),this}static copyTagCollection(e,t){const n=e.mattertags,i=t.mattertags;for(const t of n.keys)i.has(t)||e.removeTag(t);for(const t of i)e.addTag(t)}get collection(){return this.mattertags}addTag(e){this.mattertags.has(e.sid)?this.mattertags.get(e.sid).copy(e):this.mattertags.set(e.sid,e.clone())}removeTag(e){return this.mattertags.delete(e)}getTag(e){return this.mattertags.get(e)}getTagList(){return this.mattertags.keys}getTagCount(){return this.mattertags.length}getTagKeywords(){let e=[];return this.iterate((t=>{t.enabled&&t.keywords.length&&(e=e.concat(t.keywords))})),e}iterate(e){for(const t of this.mattertags)e(t)}*[Symbol.iterator](){for(const e of this.mattertags)yield e}set onStale(e){this.hydrate=e}updateOnStaleCallbacks(e){if(!this.hydrate)return;const t=e?this.getTag(e):this.mattertags;(0,r.s)(t,(async()=>{const e=await this.hydrate();this.iterate((t=>{t.refresh(e)}))}))}}},62630:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>MattertagDataModule});var i=n(57227),s=n(14877),r=n(484),o=n(81402),a=n(52549),l=n(7819),c=n(52012),d=n(48697),u=n(36154),h=n(47063),p=n(60673),m=n(67495),f=n(18537),g=n(23400),v=n(47497),y=n(11679),b=n(61709),S=n(1001),E=n(29474);class ListSerializer{constructor(e){this.config=e}serialize(e){const{serializer:t}=this.config;if(!e||!Array.isArray(e)||!t)return null;const n=[];for(const i of e){const e=t.serialize(i);e&&n.push(e)}return n}deserialize(e){const{deserializer:t}=this.config;if(!e||!Array.isArray(e)||!t)return null;const n=[];for(const i of e){const e=t.deserialize(i);e&&n.push(e)}return n}}var T=n(66225),w=n(5477),x=n(38636),_=n(15878),M=n(96294),O=n(4951);const A=new w.Z("mds-mattertag-serializer");class MdsMattertagCreateSerializer{constructor(e,t){this.updateSerializer=e,this.mediaSerializer=t}serialize(e){const t=this.mediaSerializer.serialize(e),n=this.updateSerializer.serialize(e),i=null!==t?Object.assign(Object.assign({},t),n):n;return this.validate(i)?i:null}validate(e){if(!e)return!1;const t=["label","description","mediaUrl"].some((t=>t in e)),n=["floorId","enabled","anchorPosition"].filter((t=>!(t in e))),i=0===n.length,s=!!e.anchorPosition&&(0,O.u)(e.anchorPosition),r=i&&t&&s;return r||A.debug("Invalid MattertagDetails:",{missingFields:n,validPosition:s}),r}}var C=n(22026),N=n(63336),D=n(63387),I=n(2212);const L=new w.Z("mds-mattertag-serializer");class MdsMattertagDeserializer{constructor(e,t){this.fileAttachmentDeserializer=e,this.externalAttachmentDeserializer=t}deserialize(e){var t;if(!e||!this.validate(e))return L.debug("Deserialized invalid Mattertag data from MDS",e),null;const n=e.anchorPosition?D.ep.fromVisionVector(e.anchorPosition):void 0,i=e.stemNormal?D.ep.fromVisionVector(e.stemNormal):void 0,s=new r.U;if(s.sid=e.id,s.label=e.label||"",s.description=e.description||"",s.enabled=!!e.enabled,e.color&&(s.color=new I.Color(e.color)),s.created=(0,N.p)(e.created),s.modified=(0,N.p)(e.modified),e.floor&&e.floor.id&&(s.floorId=e.floor.id),e.room&&e.room.id&&(s.roomId=e.room.id),n&&(s.anchorPosition=n),e.media&&(s.mediaSrc=e.media),e.mediaType&&(s.mediaType=(0,v.m7)(e.mediaType)),s.fileAttachments=this.getFileAttachments(s,e),s.externalAttachments=this.getExternalAttachments(s,e),void 0!==e.stemLength&&(s.stemHeight=e.stemLength),i&&i instanceof I.Vector3){const t=i.clone().setLength(s.stemHeight);s.anchorNormal=i,s.stemVector=t,s.stemVisible=!!e.stemEnabled}else s.stemVector=new I.Vector3(0,0,0),s.stemVisible=!!e.stemEnabled;return s.objectAnnotationId=null===(t=e.objectAnnotation)||void 0===t?void 0:t.id,s.keywords=e.keywords||[],s}validate(e){if(!e)return!1;return["id","created","modified","enabled"].every((t=>t in e))}getFileAttachments(e,t){return this.fileAttachmentDeserializer?this.deserializeFileAttachments(t).sort(((e,t)=>e.created.getTime()-t.created.getTime())):[]}getExternalAttachments(e,t){if(!this.externalAttachmentDeserializer)return[];const n=this.deserializeExternalAttachments(t);if(t.media&&t.mediaType){const i=(0,v.Nc)(e.sid,t.media,t.mediaType);i&&n.push(i)}return n.sort(((e,t)=>e.created.getTime()-t.created.getTime()))}deserializeExternalAttachments(e){const t=(0,x.q)(e,"externalAttachments")||[],n=[];return t.forEach((t=>{var i;const s=null===(i=this.externalAttachmentDeserializer)||void 0===i?void 0:i.deserialize(t);s&&(s.parentId=e.id,s.parentType=C.u.MATTERTAG,n.push(s))})),n}deserializeFileAttachments(e){const t=(0,x.q)(e,"fileAttachments")||[],n=[];return t.forEach((t=>{var i;const s=null===(i=this.fileAttachmentDeserializer)||void 0===i?void 0:i.deserialize(t);s&&(s.parentId=e.id,s.parentType=C.u.MATTERTAG,n.push(s))})),n}}class MdsMattertagMediaRemoveSerializer{serialize(e){return this.validate(e)?{sid:e.sid}:null}validate(e){const t=null!==e&&!!e.mediaType&&e.mediaType===y.z.none;return null!==e&&!!e.sid&&t}}var P=n(40330);const R=new w.Z("mds-mattertag-serializer");class MdsMattertagMediaUpdateSerializer{serialize(e){const t=this.extractMedia(e);return this.validate(t)?t:null}validate(e){if(!e)return!1;const t=["mediaUrl","mediaType"].every((t=>t in e)),n=void 0!==e.mediaType&&["rich","photo","video"].includes(e.mediaType),i=t&&n;return i||R.debug("invalid media",e,{hasRequiredFields:t,hasValidMediaType:n}),i}extractMedia(e){const t={};return e.mediaSrc&&(t.mediaUrl=e.mediaSrc),e.mediaType&&e.mediaType in k&&(t.mediaType=e.mediaType),t.mediaUrl&&t.mediaType?t:null}}const k={[y.z.photo]:[P.L.PHOTO],[y.z.rich]:[P.L.RICH],[y.z.video]:[P.L.VIDEO]};var U=n(28124);const B=new w.Z("mds-mattertag-serializer");class MdsMattertagUpdateSerializer{serialize(e){if(!e)return null;const t={};return void 0!==e.enabled&&(t.enabled=e.enabled),void 0!==e.stemVisible&&(t.stemEnabled=e.stemVisible),void 0!==e.label&&(t.label=e.label),void 0!==e.description&&(t.description=e.description),void 0!==e.color&&(0,U.D5)(e.color)&&(t.color=(0,U.Ex)(e.color)),void 0!==e.anchorPosition&&(0,O.u)(e.anchorPosition)&&(t.anchorPosition=D.ep.toVisionVector(e.anchorPosition)),void 0!==e.anchorNormal&&(0,O.u)(e.anchorNormal)&&(t.stemNormal=D.ep.toVisionVector(e.anchorNormal)),void 0!==e.stemHeight&&(t.stemLength=e.stemHeight),void 0!==e.keywords&&(t.keywords=e.keywords),e.floorId&&(t.floorId=e.floorId),e.roomId&&(t.roomId=e.roomId),e.objectAnnotationId&&(t.objectAnnotationId=e.objectAnnotationId),t&&this.validate(t)?t:null}validate(e){if(!e)return!1;const t=["floorId","roomId","color","label","description","enabled","stemEnabled","stemLength","stemNormal","stemDirection","anchorPosition","objectAnnotationId","keywords"],n=Object.keys(e).length>0,i=Object.keys(e).every((e=>t.includes(e))),s=i&&n;return s||B.debug("Invalid MattertagPatch:",{hasContents:n,hasValidFields:i,data:e}),s}}class MdsMattertagFileAttachmentSerializer{serialize(e){const t=e.fileAttachments;return void 0===t||0===t.length?null:{fileAttachments:t.map((e=>e.id))}}}var F=n(6850);const V=new w.Z("MdsMattertagStore");class MdsMattertagStore extends T.u{constructor(e,t){super(e),this.prefetchKey="data.model.mattertags";const n=t?new _.d:void 0;this.fileAttachmentDeserializer=t?new M.O:void 0,this.fileAttachmentSerializer=new MdsMattertagFileAttachmentSerializer,this.patchSerializer=new MdsMattertagUpdateSerializer,this.mediaUpdateSerializer=new MdsMattertagMediaUpdateSerializer,this.mediaRemovalSerializer=new MdsMattertagMediaRemoveSerializer,this.createSerializer=new MdsMattertagCreateSerializer(this.patchSerializer,this.mediaUpdateSerializer),this.tagDeserializer=new MdsMattertagDeserializer(this.fileAttachmentDeserializer,n),this.deserializer=new ListSerializer({deserializer:this.tagDeserializer})}async read(e){const{includeDisabled:t=!1}=this.config,n={modelId:this.getViewId(),includeDisabled:t};return this.query(F.GetMattertags,n,e).then((e=>{var t,n;const i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.mattertags;if(!i||!Array.isArray(i))return null;return(this.deserializer.deserialize(i)||[]).reduce(((e,t)=>(e[t.sid]=t,e)),{})}))}async refreshFileAttachments(e){if(!this.fileAttachmentDeserializer)return{};const{includeDisabled:t=!1}=this.config,n={modelId:this.getViewId(),includeDisabled:t};return this.query(F.RefreshTagFileAttachments,n,e).then((e=>{var t,n;const i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.mattertags;if(!i||!Array.isArray(i))return{};const s=[];for(const e of i){if(!e.id)throw V.error("Failure refreshing tag file attachments"),new Error("Failure refreshing tag file attachments");e.fileAttachments.forEach((e=>{var t;const n=null===(t=this.fileAttachmentDeserializer)||void 0===t?void 0:t.deserialize(e);n&&s.push(n)}))}return s.reduce(((e,t)=>(e[t.id]=t,e)),{})}))}async create(e){const t=this.getViewId();return Promise.all(e.map((e=>{const n=this.createSerializer.serialize(e);if(!n)throw V.error("Failure saving tag:",e.sid,e),new Error("Could not save Mattertag");const i=e.sid;let s=", $data: MattertagDetails!";const o={modelId:t,mattertagId:i,data:n},a=this.fileAttachmentSerializer.serialize(e);a&&(s+=", $fileAttachments: [ID!]",o.fileAttachments=a.fileAttachments);const l=`\n        addMattertag(\n          modelId: $modelId,\n          mattertagId: "${i}",\n          mattertag: $data) {\n            id\n            created\n            modified\n          }\n        ${a?`addMattertagAttachments(\n            modelId: $modelId,\n            mattertagId: "${i}",\n            fileAttachments: $fileAttachments) {\n              id\n            }`:""}\n      `,c=E.Ps`
        mutation AddMattertag($modelId: ID! ${s}) {
          ${l}
        }
      `;return this.mutate(c,o).then((t=>{const n=(0,x.q)(t,"data.addMattertag"),i=(new r.U).copy(e);return i.sid=n.id,i.commit(),i}))})))}async update(e,t){if(!e||0===e.length)return;const n=this.getViewId();let i="";const s={};s.modelId=n;let r="";for(const t of e){const e=t.sid,n=this.mediaUpdateSerializer.serialize(t),o=this.mediaRemovalSerializer.serialize(t),a=this.patchSerializer.serialize(t),l=this.fileAttachmentSerializer.serialize(t);if(!(a||n||o||l))return void V.debug(`Nothing to update for tag ${e}`,t);a&&(i+=`, $patch${e}: MattertagPatch!`,s[`patch${e}`]=a),l&&(i+=`, $fileAttachments${e}: [ID!]`,s[`fileAttachments${e}`]=l.fileAttachments),s[`mediaType${e}`]=n&&n.mediaType,s[`mediaUrl${e}`]=n&&n.mediaUrl;r+=`\n        update${e}:\n        ${a?`patchMattertag(\n            modelId: $modelId,\n            mattertagId: "${e}",\n            patch: $patch${e}) {\n              id\n            }`:""}\n        ${o?`removeMattertagMedia(\n            modelId: $modelId,\n            mattertagId: "${e}") {\n              id\n            }`:""}\n        ${n?`updateMattertagMediaUrl(\n            modelId: $modelId,\n            mattertagId: "${e}",\n            type: ${n&&n.mediaType},\n            url: "${n&&n.mediaUrl}") {\n              id\n            }`:""}\n        ${l?`addMattertagAttachments(\n            modelId: $modelId,\n            mattertagId: "${e}",\n            fileAttachments: $fileAttachments${e}) {\n              id\n            }`:""}\n      `}for(const e of t)(null==e?void 0:e.id)&&(null==e?void 0:e.parentId)&&e.parentType?(i+=`, $parentType${e.id}: ParentType!`,s[`parentType${e.id}`]=e.parentType,r+=`\n        unattach${e.id}:\n        removeFileAttachment(modelId: $modelId,\n                             attachmentId: "${e.id}",\n                             parentType: $parentType${e.id},\n                             parentId: "${e.parentId}") `):V.debug("MattertagStore.update: unable to remove file attachment");const o=E.Ps`
      mutation tagUpdate($modelId: ID! ${i}) {
        ${r}
      }
    `;return this.mutate(o,s).then((()=>{}))}async delete(e){if(!e||0===e.length)return;const t=this.getViewId();let n="";for(const t of e){if(!t||t&&!t.sid)throw new Error("MattertagStore.delete failed");n+=`delete${t.sid}: deleteMattertag(modelId: $modelId, mattertagId: "${t.sid}") `}const i=E.Ps`
      mutation batchDeleteMattertag($modelId: ID!) {
        ${n}
      }
    `;return this.mutate(i,{modelId:t}).then((()=>{}))}}var H=n(15099),j=n(7692),G=n(87100),z=n(18568),W=n(52903),K=n(9986),Y=n(36032),q=n(61903),Z=n(6058),$=n(99380),Q=n(65143),X=n(18253),J=n(14832),ee=n(18236),te=n(47357),ne=n(90525),ie=n(29686),se=n(48730),re=n(2252);class SharedTagSearchResultItem extends ie.K{constructor(e,t,n,i){super(e),this.mattertag=t,this.groupId=i,this.id=this.mattertag.sid,this.title=this.mattertag.label,this.description=this.textParser.getPlainText(this.mattertag.description),this.icon="icon-simple-tag",this.floorId=this.mattertag.floorId,this.color=function(e){return`rgb(${255*e.r}, ${255*e.g}, ${255*e.b})`}(this.mattertag.color),this.textParser=n}}class TagSearchResultItem extends SharedTagSearchResultItem{constructor(){super(...arguments),this.onSelect=async()=>{super.onSelect(),this.commandBinder.issueCommand(new ee.yL),await this.commandBinder.issueCommand(new se.OR({pinPosition:this.mattertag.getPin(),transition:J.n.FadeToBlack})),(0,re.tq)()?this.commandBinder.issueCommand(new ee.bd(this.id,te.J.TAG)):this.commandBinder.issueCommand(new ee.oM(this.id,te.J.TAG))}}}class MattertagSearchResultItem extends SharedTagSearchResultItem{constructor(){super(...arguments),this.onSelect=()=>{super.onSelect(),this.commandBinder.issueCommand(new ee.yL),this.commandBinder.issueCommand(new ne.Y(this.mattertag.sid,J.n.FadeToBlack))}}}var oe=n(64921),ae=n(65800),le=n(19822),ce=n(22149),de=n(10854);const{TAGS:ue}=de.Z.SHOWCASE,he=new oe.v({links:!0}),pe="0"===(0,G.eY)("mt"),me="MP_MATTERTAG_SEARCH_GROUP";async function fe(e,t,n){const i=await e.market.waitForData(q.e),r=await e.market.waitForData(K.pu),o=await e.getModuleBySymbol(s.y.PINS);n&&await e.getModuleBySymbol(s.y.TAGS);const a=t=>new(n?TagSearchResultItem:MattertagSearchResultItem)(e.commandBinder,t,he,me),l=(t,i)=>{n?e.commandBinder.issueCommand(new $.ik(t,Q.Er.MATTERTAG,i)):o.pinRenderer.setPinVisible(t,i)},c=(e,n,i=[])=>{const s=[];return t.iterate((t=>{if(!t.enabled)return;if(t.objectAnnotationId)return;let n=e(t.label,he.getPlainText(t.description));n&&i.length>0&&(n=t.keywords.length>0&&t.keywords.some((e=>i.includes(e)))),l(t.sid,n),n&&s.push(a(t))})),s},d=e=>{const n=[];return t.iterate((t=>{if(!t.enabled)return;const i=function(e){if(function(e=""){return e.trim().startsWith("{")}(e.description))try{const t=JSON.parse(e.description);return t.title=e.label,t}catch(e){}return null}(t),s=e(i);l(t.sid,s),s&&n.push(a(t))})),n},u=new Z.u(i,{[X.re]:!0}),h=t=>{n?t?e.commandBinder.issueCommand(new le.$D):e.commandBinder.issueCommand(new le.yo):t?e.commandBinder.issueCommand(new ae.H):e.commandBinder.issueCommand(new ae.u),u.toggle(t)},p={renew:()=>{e.commandBinder.issueCommandWhenBound(new ce.c6({id:me,groupPhraseKey:ue.SEARCH_GROUP_HEADER,getSimpleMatches:c,getAdvancedMatches:d,registerChangeObserver:e=>t.onChanged(e),onActivatedChanged:h,getKeywords:t.getTagKeywords.bind(t)}))},cancel:()=>{e.commandBinder.issueCommandWhenBound(new ce.Pe(me))}},m=e=>{const t=e===K.Mx.WORKSHOP;!pe||t?p.renew():p.cancel()},f=r.onPropertyChanged("application",m);return m(r.application),new Y.V(p,f)}var ge=n(98461);class MattertagDataModule extends i.Y{constructor(){super(...arguments),this.name="mattertag-data",this.monitor=null,this.filesToUnattach=[],this.getDiscPositions=(()=>{const e=[],t={},n={},i=new I.Vector3;return async s=>(e.length=0,s.tags.forEach((s=>{const r=this.data.getTag(s);r&&(n[s]||(n[s]=new I.Vector3),n[s].copy(r.anchorPosition).add(r.stemVector),t[s]||(t[s]=new I.Vector2),(0,j.q9)(this.cameraData,n[s],t[s],i),e.push({sid:s,screen:i.z>1?null:t[s],world:n[s]}))})),e)})(),this.addTag=async e=>{const{positionOptions:t,standardOptions:n,mediaOptions:i}=e,s=Object.assign(Object.assign({},t),n),r=this.createTag((0,o.O1)(11),s,[],i);return r.modified=new Date,r.commit(),r.sid},this.editTag=async e=>{const{sid:t,positionOptions:n,standardOptions:i,mediaOptions:s}=e,r=Object.assign(Object.assign({},n),i),o=this.data.getTag(t);o&&(this.updateTag(o,r,s),o.modified=new Date,o.commit())},this.removeTag=async e=>{const t=this.data.getTag(e.sid);if(void 0!==t&&this.data.removeTag(e.sid))return t&&t.objectAnnotationId&&this.engine.commandBinder.issueCommand(new ge.AQ(t.objectAnnotationId)),e.sid},this.saveNewTag=async e=>{const{id:t,properties:n,embed:i,fileAttachments:s}=e,r=i?{mediaSrc:i.src,mediaType:(0,v.F5)(i.mediaType)}:void 0;return this.createTag(t,n,s,r),this.engine.commandBinder.issueCommand(new h.VQ({dataTypes:[a.g.MATTERTAGS]}))},this.saveTag=async e=>{const{id:t,properties:n,pendingAttachments:i,removedAttachments:s,embed:r}=e,o=this.data.getTag(t);if(!o)return void this.log.debug("Cannot save non-existent tag");const l=r?(0,v.F5)(r.mediaType):y.z.none,c=r?r.src:"";void 0!==r&&(c===o.mediaSrc&&l!==o.mediaType||this.updateExternalAttachment(o,r));const d=void 0!==r?{mediaSrc:c,mediaType:l}:void 0;return this.updateTag(o,n,d),i.forEach((e=>{o.fileAttachments.push(e)})),this.removeFileAttachments(o,s),this.data.addTag(o),this.data.updateOnStaleCallbacks(t),this.engine.commandBinder.issueCommand(new h.VQ({dataTypes:[a.g.MATTERTAGS]}))}}async init(e,t){const{readonly:n,baseUrl:i,newTagsEnabled:r,parserOptions:o}=e;this.engine=t,this.config=e,this.descParser=new S.$({model:o.model,supportLinks:!0,keepLinkLabels:!0}),this.store=new MdsMattertagStore({readonly:n,includeDisabled:!n,baseUrl:i},r);const u=await this.store.read()||{};this.meshQueryModule=await t.getModuleBySymbol(s.y.MESH_QUERY),this.cameraData=await t.market.waitForData(H.M_);const h=await t.getModule(l.F);if(this.data=t.market.tryGetData(b.n)||new b.n,this.initializeTagData(u,t.market,e.parserOptions),this.bindings.push(t.commandBinder.addBinding(g.cH,this.getDiscPositions),t.commandBinder.addBinding(g.Fz,this.addTag),t.commandBinder.addBinding(g.Ek,this.editTag),t.commandBinder.addBinding(g.Gn,this.removeTag)),!n){this.bindings.push(t.commandBinder.addBinding(g.Mm,this.saveNewTag),t.commandBinder.addBinding(g.qq,this.saveTag),h.onSave((()=>this.save()),{dataType:a.g.MATTERTAGS}),h.onPublish((()=>this.onAfterPublish()),{dataType:a.g.MATTERTAGS,phase:c.Q.AFTER}));const e=await t.market.waitForData(d.Q);e.setRevertableType(a.g.MATTERTAGS),e.setPublishableType(a.g.MATTERTAGS),this.monitor=new m.c(this.data.collection,{aggregationType:f.E.Manual,shallow:!0}),this.configureTrash()}fe(t,this.data,r).then((e=>this.bindings.push(e)))}async save(){if(this.monitor&&this.monitor.commitChanges(),!this.store||!this.monitor)return void this.log.warn("Mattertags changes will NOT be saved");const e=this.monitor.getDiffRecord();this.monitor.clearDiffRecord();const t=e,n=t.filter((e=>e.action===p.KI.removed)).map((e=>({sid:e.index}))),i=t.filter((e=>e.action===p.KI.added)).map((e=>this.data.getTag(e.index))),s=t.filter((e=>e.action===p.KI.updated)).map((e=>{const t=Object.assign({sid:e.index},e.diff);return"mediaSrc"in t&&(t.mediaType=this.data.getTag(e.index).mediaType),t.objectAnnotationId=this.data.getTag(e.index).objectAnnotationId,t}));return Promise.all([this.store.delete(n),this.store.create(i),this.store.update(s,this.filesToUnattach)]).then((()=>{this.filesToUnattach=[]}))}clearDiffRecord(){this.monitor&&this.monitor.clearDiffRecord()}initializeTagData(e,t,n){const i=n?new S.$(n):this.descParser;for(const t in e){const n=e[t];n.parsedDescription=i.parse(e[t].description),this.meshQueryModule.inferMeshIdsFromPoint(n,n.anchorPosition),this.data.addTag(n)}this.data.onStale=()=>this.store.refreshFileAttachments(),this.data.updateOnStaleCallbacks(),t.register(this,b.n,this.data)}createTag(e,t,n,i){let s=e;for(;this.data.getTag(s);)s=(0,o.O1)(11);const a=new r.U;if(a.sid=s,this.config.newTagsEnabled&&i){const e=(0,v.gj)(i.mediaType);if(i.mediaSrc&&e){const t=(0,v.Nc)(s,i.mediaSrc,e);t&&a.externalAttachments.push(t)}}return t.objectAnnotationId&&(a.objectAnnotationId=t.objectAnnotationId),t.keywords&&(a.keywords=t.keywords),n.forEach((e=>{a.fileAttachments.push(e)})),this.updateTag(a,t,i),this.data.addTag(a),this.data.updateOnStaleCallbacks(s),a}updateTag(e,t,n){e.updateFromOptions(t,this.descParser),void 0!==(null==n?void 0:n.mediaType)&&(e.mediaType=n.mediaType),void 0!==(null==n?void 0:n.mediaSrc)&&(e.mediaSrc=n.mediaSrc.slice())}removeFileAttachments(e,t){const{fileAttachments:n}=e;t.forEach((e=>{const t=n.findIndex((t=>t.id===e.id));-1!==t?(n.splice(t,1),this.filesToUnattach.push(e)):this.log.debug("Attempting to remove an attachment that is not in the tag")}))}updateExternalAttachment(e,t){const{mediaSrc:n}=e;n&&(e.externalAttachments=[]),t&&(e.externalAttachments=[t])}async onAfterPublish(){this.verifyDataIntegrity()}async verifyDataIntegrity(){const e="data-integrity"===(0,G.eY)("error",""),t=this.data.getTagCount(),n=await this.store.read().catch((e=>{this.log.debug("Mattertag integrity check failed",e)}))||{},i=Object.keys(n).length;(i!==t||e)&&this.engine.broadcast(new u.Qq(`Unexpected tag count after publish (${i}/${t})`,a.g.MATTERTAGS,e))}async configureTrash(){const{readonly:e}=this.config,{commandBinder:t}=this.engine;if(e)return;const n=a.g.MATTERTAGS,i=new MdsMattertagDeserializer,s={objectType:n,create:e=>new z.F({label:e.label||(0,o.aS)(e.description||"",100)||"Mattertag",objectId:e.id,objectType:n,created:new Date,value:e}),restore:e=>{const t=i.deserialize(e.value);t&&this.data.addTag(t)}},r=await t.issueCommandWhenBound(new W.B(s));this.bindings.push(r)}}},76641:(e,t,n)=>{"use strict";n.d(t,{QY:()=>MattertagNavigatedMessage,Ik:()=>MattertagLinkOpenedMessage,dJ:()=>MattertagViewedMessage});var i=n(4117);class MattertagNavigatedMessage extends i.v{constructor(e){super(),this.sid=e}}class MattertagLinkOpenedMessage extends i.v{constructor(e){super(),this.url=e}}class MattertagViewedMessage extends i.v{constructor(e,t){super(),this.sid=e,this.view=t}}},18253:(e,t,n)=>{"use strict";n.d(t,{re:()=>i,lc:()=>s,Us:()=>r,ZF:()=>o});const i="features/mattertags",s="embedlyKey",r=1e3,o=60},47497:(e,t,n)=>{"use strict";n.d(t,{m7:()=>u,F5:()=>h,gj:()=>p,Nc:()=>f});var i=n(40330),s=n(22026),r=n(11679),o=n(48452),a=n(67731),l=n(9042),c=n(89142),d=n(28129);function u(e){const t={[i.L.VIDEO]:r.z.video,[i.L.PHOTO]:r.z.photo,[i.L.RICH]:r.z.rich};return e in t?t[e]:r.z.none}function h(e){switch(e){case o.DD.VIDEO:return r.z.video;case o.DD.IMAGE:return r.z.photo;case o.DD.RICH:return r.z.rich}return r.z.none}function p(e){switch(e){case r.z.video:return i.L.VIDEO;case r.z.photo:return i.L.PHOTO;case r.z.rich:return i.L.RICH}return null}function m(e){return{[i.L.VIDEO]:o.DD.VIDEO,[i.L.PHOTO]:o.DD.IMAGE,[i.L.RICH]:o.DD.RICH}[e]}function f(e,t,n){return t?new a.P({id:(0,c.fV)(),created:new Date,parentId:e,parentType:s.u.MATTERTAG,mediaType:m(n),src:t,url:new d.n(t,null),thumbnailUrl:new d.n(t,null),category:l.G.EXTERNAL}):null}},46446:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>MattertagMeshModule});var i=n(57227),s=n(14877),r=n(61903),o=n(61709),a=n(65143),l=n(34118),c=n(18253),d=n(81111),u=n(89034),h=n(64366),p=n(78947);class MattertagMeshModule extends i.Y{constructor(){super(...arguments),this.name="mattertag-mesh",this.visibilityDirty=!0,this.unanchoredTagOpacity=1,this.anchoredTagOpacity=1,this.addNewTagMesh=(e,t)=>{this.settings.tryGetProperty(l.RY,!1)||this.pinRenderer.updatePin(e.sid,a.Er.MATTERTAG,Object.assign(Object.assign({},e),{stemNormal:e.stemVector,stemLength:e.stemHeight,stemEnabled:e.stemVisible,color:`#${e.color.getHexString()}`}),this.backgroundTexture,this.maskTexture)},this.removeTagMesh=(e,t)=>{this.pinRenderer.removePin(e.sid)},this.updateTagMesh=(e,t)=>{this.addNewTagMesh(e,e.sid)},this.initializeTagVisibility=()=>{if(this.settings.tryGetProperty(l.RY,!1))return;const e=this.settings.tryGetProperty(c.re,!0);this.pinRenderer.setPinOpacityByType(a.Er.MATTERTAG,e?1:0),e&&this.mattertagData.iterate((e=>{this.pinRenderer.setPinVisible(e.sid,e.enabled)}))},this.updateTagVisibility=()=>{if(this.settings.tryGetProperty(l.RY,!1))return;this.settings.tryGetProperty(c.re,!1)?this.fadePinsToState():this.pinRenderer.fadePinOpacityByType(a.Er.MATTERTAG,0)},this.selectedTagChanged=()=>{if(!this.settings.tryGetProperty(l.RY,!1)){if(this.mattertagViewData.selectedTag&&!this.mattertagViewData.navigating){const e=this.mattertagData.getTag(this.mattertagViewData.selectedTag);this.pinRenderer.showSelectedMesh(a.Er.MATTERTAG,e.sid)}this.mattertagViewData.selectedTag||this.pinRenderer.hideSelectedMesh()}}}async init(e,t){const[n,i,a,l]=await Promise.all([t.market.waitForData(o.n),t.getModuleBySymbol(s.y.PINS),t.market.waitForData(r.e),t.market.waitForData(d.P5)]);this.settings=a,this.mattertagData=n,this.mattertagViewData=l,this.pinRenderer=i.pinRenderer;const m=()=>{this.visibilityDirty=!0};this.bindings.push(this.mattertagData.collection.onElementChanged({onAdded:this.addNewTagMesh,onRemoved:this.removeTagMesh,onUpdated:this.updateTagMesh}),this.mattertagViewData.onToolStateChanged(m),this.settings.onPropertyChanged(c.re,m),this.mattertagData.onChanged(m),this.mattertagViewData.onSelectedTagChanged(this.selectedTagChanged),this.mattertagViewData.onNavigatingTagChanged(this.selectedTagChanged),this.mattertagViewData.onPropertyChanged("suspendVisibilityUpdates",m)),this.backgroundTexture=(0,u.p)(h),this.maskTexture=(0,u.p)(p),this.mattertagData.iterate((e=>{this.addNewTagMesh(e,e.sid)})),this.initializeTagVisibility()}dispose(e){this.pinRenderer.removePinsByType(a.Er.MATTERTAG),this.backgroundTexture.dispose(),this.maskTexture.dispose(),super.dispose(e)}onUpdate(e){this.visibilityDirty&&!this.mattertagViewData.suspendVisibilityUpdates&&(this.visibilityDirty=!1,this.updateTagVisibility())}showAnchorMesh(e){this.pinRenderer.showAnchorMesh(a.Er.MATTERTAG,e.sid,Object.assign(Object.assign({},e),{stemNormal:e.stemVector,stemLength:e.stemHeight})),this.unanchoredTagOpacity=.5,this.anchoredTagOpacity=1,this.anchorTagId=e.sid,this.fadePinsToState()}hideAnchorMesh(){this.unanchoredTagOpacity=1,this.anchoredTagOpacity=1,this.anchorTagId=void 0,this.pinRenderer.hideAnchorMesh(),this.fadePinsToState()}resetPinOpacity(){this.fadePinsToState()}changeDiscOpacity(e,t){this.pinRenderer.setPinOpacity(e,t)}setTagVisibility(e){this.pinRenderer.setPinTypeVisible(a.Er.MATTERTAG,e)}setTagVisible(e,t){this.pinRenderer.setPinVisible(e,t)}setOverrideMaterial(e,t,n){this.pinRenderer.setPinRenderOverrides(e,t,n)}fadePinsToState(){const{selectedTag:e}=this.mattertagViewData;this.mattertagData.iterate((t=>{const n=t.enabled||e===t.sid;this.pinRenderer.setPinVisible(t.sid,n);const i=t.sid===this.anchorTagId?this.anchoredTagOpacity:this.unanchoredTagOpacity;this.pinRenderer.fadePinOpacity(t.sid,n?i:0)}))}}},90525:(e,t,n)=>{"use strict";n.d(t,{Y:()=>NavigateToMattertagCommand});var i=n(93037);class NavigateToMattertagCommand extends i.m{constructor(e,t,n=!1){super(),this.id="MATTERTAG_NAVIGATE",this.payload={sid:e,transition:t,navigateToDisabled:n}}}},81111:(e,t,n)=>{"use strict";n.d(t,{Pg:()=>i,rI:()=>s,P5:()=>MattertagsViewData,ZJ:()=>BillboardData});var i,s,r=n(35424),o=n(29984),a=n(67779),l=n(66910),c=n(98254);!function(e){e.UP="Up",e.DOWN="Down",e.LEFT="Left",e.LEFT_UP="LeftUp",e.LEFT_DOWN="LeftDown",e.RIGHT="Right",e.RIGHT_UP="RightUp",e.RIGHT_DOWN="RightDown"}(i||(i={})),function(e){e.CLOSED="closed",e.IDLE="idle",e.DISABLED="disabled",e.CREATING="creating",e.PRESSING="pressing",e.PLACING="placing",e.PLACED="placed",e.EDITING="editing"}(s||(s={}));class MattertagsViewData extends r.V{constructor(e){super(),this.mattertags=e,this.name="tag-view",this.visitedTags=new o.d,this.navigatingTag=(0,a.Y)(null),this.toolStateObservable=(0,a.Y)(s.CLOSED),this.openTagObservable=(0,a.Y)(null),this.selectedTagObservable=(0,a.Y)(null),this.uncommittedTagObservable=(0,a.Y)(null),this.progressObservable=new a.f(-1),this.screenPositionObservable=new a.f(null),this.viewedTags=0,this.suspendVisibilityUpdates=!1,this.creatingNewMattertag=!1,this.tagCapabilities={},this.getViewData=e=>{const t=this.mattertags.getTag(e),n=this.derivedData[e];return t&&!n&&this.makeViewData&&(this.derivedData[e]=this.makeViewData(t)),this.derivedData[e]},this.derivedData={},this.activeBillboards=(0,l.q)()}setViewDataFactory(e){this.makeViewData=e}openBillboard(e){this.openTag&&this.openTag!==e&&this.closeBillboard(this.openTag),this.openTag!==e&&this.setOpenTag(e)}hideBillboard(e){this.openTag===e&&this.setOpenTag(null)}closeBillboard(e){this.openTag===e&&this.setOpenTag(null),this.selectedTag===e&&this.setSelectedTag(null)}closeOpenBillboard(){this.openTag&&this.closeBillboard(this.openTag)}setTagCapabilities(e,t){const n=this.tagCapabilities[e]||{};n.opening=t.opening,n.navigating=t.navigating,this.tagCapabilities[e]=n,this.openTag!==e||this.tagCapabilities.opening||this.closeBillboard(e)}getTagCount(){return this.mattertags.collection.length}get navigating(){return this.navigatingTag.value}setNavigatingTag(e){this.navigatingTag.value=e}onNavigatingTagChanged(e){return this.navigatingTag.onChanged(e)}setSelectedTag(e){this.selectedTagObservable.value=e}get selectedTag(){return this.selectedTagObservable.value}onSelectedTagChanged(e){return this.selectedTagObservable.onChanged(e)}setUncommittedTag(e){this.uncommittedTagObservable.value=e}get uncommittedTag(){return this.uncommittedTagObservable.value}onUncommittedChanged(e){return this.uncommittedTagObservable.onChanged(e)}setProgress(e){this.progressObservable.value=e}get progress(){return this.progressObservable.value}onProgressChanged(e){return this.progressObservable.onChanged(e)}get screenPosition(){return this.screenPositionObservable.value}setScreenPosition(e){this.screenPositionObservable.value=e}onScreenPositionChanged(e){return this.screenPositionObservable.onChanged(e)}setToolState(e){switch(e){case s.CREATING:this.creatingNewMattertag=!0;break;case s.IDLE:case s.CLOSED:this.creatingNewMattertag=!1}this.toolStateObservable.value=e}get toolState(){return this.toolStateObservable.value}onToolStateChanged(e){return this.toolStateObservable.onChanged(e)}get openTag(){return this.openTagObservable.value}setOpenTag(e){this.openTagObservable.value=e}onOpenTagChanged(e){return this.openTagObservable.onChanged(e)}isCreatingNewMattertag(){return this.creatingNewMattertag}visitTag(e){this.viewedTags++,-1===this.visitedTags.indexOf(e)&&this.visitedTags.push(e)}getViewedTagCount(){return this.viewedTags}getVisitedTags(){return this.visitedTags.values()}setNavigatingPosition(e){this.navigatingPosition=e}getNavigatingPosition(){return this.navigatingPosition}}class BillboardData extends c.T{constructor(e){super(),this.sid=e,this.closing=!1,this.position=null,this.distance=0,this.timeoutId=0}}},65800:(e,t,n)=>{"use strict";n.d(t,{H:()=>SuspendMattertagVisibilityUpdates,u:()=>ResumeMattertagVisibilityUpdates});var i=n(93037);class SuspendMattertagVisibilityUpdates extends i.m{}class ResumeMattertagVisibilityUpdates extends i.m{}},63452:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>MattertagViewDataModule});var i=n(2212),s=n(57227),r=n(14877),o=n(61709),a=n(23400),l=n(15099),c=n(76641),d=n(65171),u=n(92214),h=n(41907),p=n(14832),m=n(69098),f=n(9986),g=n(22878),v=n(18253),y=n(34118),b=n(61903),S=n(90525),E=n(81111),T=n(48730),w=n(77280),x=n(65800),_=n(65143),M=n(57183);class MattertagViewDataModule extends s.Y{constructor(){super(...arguments),this.name="mattertags-viewdata",this.distance=new i.Vector3,this.cameraPosition=new i.Vector3,this.hoverTimeout=0,this.updateViewData=()=>{this.data.iterate((e=>{this.viewData.derivedData[e.sid]=this.makeViewDataForMattertag(e)})),this.viewData.commit()},this.makeViewDataForMattertag=e=>{const t=this.viewData.activeBillboards.get(e.sid),n=this.viewData.selectedTag===e.sid,i=t?t.position:null,s=t?t.distance:0;return{position:i,selected:n,located:!(!i||!s),closeTheTag:!t||t.closing||!(n||!this.viewData.selectedTag),navigating:!(!this.viewData.navigating||this.viewData.navigating!==e.sid),navigatingPosition:n?this.viewData.getNavigatingPosition():void 0,positioned:!1,distance:s,stemHeight:e.stemHeight,visible:e.enabled,color:`#${e.color.getHexString()}`,onTagDirectionChanged:this.onTagDirectionChanged}},this.onCameraUpdate=e=>{this.viewData.activeBillboards.keys.length>0&&(this.cameraPosition.copy(e.pose.position),this.updateActiveBillboards(this.viewData.activeBillboards.keys),this.viewData.commit())},this.updateBillboardData=(e,t)=>{const n=this.viewData.activeBillboards.get(e);n&&(Object.assign(n,t),n.commit())},this.addActiveBillboard=e=>{this.viewData.activeBillboards.has(e)||this.viewData.activeBillboards.set(e,new E.ZJ(e))},this.removeFromActiveBillboards=e=>{this.viewData.activeBillboards.has(e)&&this.viewData.activeBillboards.delete(e)},this.handleOpenBillboardChanged=()=>{const e=this.viewData.openTag;this.viewData.activeBillboards.atomic((()=>{e&&(this.viewData.activeBillboards.get(e)?(window.clearTimeout(this.viewData.activeBillboards.get(e).timeoutId),this.updateBillboardData(e,{timeoutId:0,closing:!1})):this.addActiveBillboard(e),this.updateActiveBillboards([e]));for(const t of this.viewData.activeBillboards.keys){if(t===e)return;this.updateBillboardData(t,{closing:!0,direction:void 0,timeoutId:window.setTimeout((()=>{this.removeFromActiveBillboards(t)}),1e3)})}}))},this.updateActiveBillboards=async e=>{try{await this.engine.commandBinder.issueCommand(new a.cH(e)).then((e=>{for(const t of e)this.updateBillboardData(t.sid,{distance:this.distance.copy(this.cameraPosition).distanceToSquared(t.world),position:t.screen})}))}catch(e){this.log.error(`Could not get Disc Positions for tags - ${e}`)}},this.onSweepChosen=e=>{this.viewData.setNavigatingPosition(e)},this.onDiscHoverChange=e=>{if(this.settings.tryGetProperty(y.RY,!1))return;if(e.pinType!==_.Er.MATTERTAG)return;const t=this.viewData.toolState;if(t!==E.rI.CLOSED&&this.viewData.selectedTag)return;const n=this.data.getTag(e.id);if(n&&n.enabled)if(clearTimeout(this.hoverTimeout),e.hovering)t!==E.rI.EDITING&&(this.hoverTimeout=window.setTimeout((()=>this.discHoverChange(e.id,e.hovering)),125));else{if(e.id===this.viewData.selectedTag)return;this.discHoverChange(e.id,!1)}},this.onDiscClicked=e=>{if(this.settings.tryGetProperty(y.RY,!1))return;const t=this.viewData.toolState;e.pinType===_.Er.MATTERTAG&&t===E.rI.CLOSED&&(e.id===this.viewData.selectedTag?this.closeBillboard(e.id):(this.viewData.setSelectedTag(e.id),this.navigateToTag(e.id,p.n.Interpolate)))},this.onSweepExit=e=>{e.toSweep&&e.fromSweep!==e.toSweep&&(this.viewData.isCreatingNewMattertag()||this.viewData.closeOpenBillboard())},this.onAppChange=e=>{this.currentApp=e.application,this.viewData.closeOpenBillboard(),this.viewData.setSelectedTag(null)},this.onViewmodeChange=e=>{null===this.viewData.navigating&&(0,g.Bw)(e.fromMode)&&this.viewData.closeOpenBillboard()},this.onTagDirectionChanged=(e,t)=>{this.updateBillboardData(e,{direction:t})},this.suspendMattertagVisibilityUpdates=async()=>{this.viewData.suspendVisibilityUpdates=!0,this.viewData.commit()},this.resumeMattertagVisibilityUpdates=async()=>{this.viewData.suspendVisibilityUpdates=!1,this.viewData.commit()}}async init(e,t){this.engine=t;const[n,i,s,a]=await Promise.all([t.market.waitForData(o.n),t.market.waitForData(b.e),t.market.waitForData(l.M_),t.getModuleBySymbol(r.y.PINS)]);this.data=n,this.settings=i,this.cameraData=s,this.pinRenderer=a.pinRenderer,this.viewData=t.market.tryGetData(E.P5)||new E.P5(this.data),t.market.register(this,E.P5,this.viewData),this.viewData.setViewDataFactory(this.makeViewDataForMattertag),this.updateViewData(),this.settings.onPropertyChanged(v.re,(e=>{0!==e&&this.viewData.closeOpenBillboard()})),this.bindings.push(t.subscribe(M.tP,this.onDiscHoverChange),t.subscribe(M.F7,this.onDiscClicked),t.subscribe(d.Z,this.onSweepExit),t.subscribe(u.Z,this.onViewmodeChange),t.subscribe(h.bS,this.onAppChange),this.cameraData.onChanged(this.onCameraUpdate),this.data.onChanged(this.updateViewData),this.viewData.onOpenTagChanged(this.handleOpenBillboardChanged),this.viewData.activeBillboards.onChanged(this.updateViewData),t.commandBinder.addBinding(x.H,this.suspendMattertagVisibilityUpdates),t.commandBinder.addBinding(x.u,this.resumeMattertagVisibilityUpdates)),this.engine.commandBinder.addBinding(S.Y,(async e=>this.navigateToTag(e.sid,e.transition,e.navigateToDisabled)))}openBillboard(e){const t=this.viewData.tagCapabilities[e];t&&!t.opening||this.viewData.openBillboard(e)}closeBillboard(e){this.viewData.closeBillboard(e)}async navigateToTag(e,t,n=!1){if(this.settings.tryGetProperty(y.RY,!1))return;const i=this.data.getTag(e);if(!i)throw new Error("No tag with that sid was found");if(!i.enabled&&!n)throw new Error("Cannot navigate to a disabled mattertag");const s=this.viewData.tagCapabilities[e];if(s&&!s.navigating)return;this.viewData.setNavigatingTag(e);const r=this.viewData.activeBillboards.get(e),o=r&&r.direction,a=this.tagDirectionToOrientationAdjust(o);return this.engine.commandBinder.issueCommand(new T.OR({pinPosition:i.getPin(),transition:t,orientationAdjust:a,onSweepChosen:this.onSweepChosen})).then((()=>{this.viewData.setSelectedTag(e),this.onTagVisited(e),this.openBillboard(e),this.viewData.setNavigatingTag(null),this.viewData.setNavigatingPosition(void 0)})).catch((e=>{this.log.debug(e),this.viewData.setNavigatingTag(null),this.viewData.setNavigatingPosition(void 0)}))}onTagVisited(e){this.viewData.visitTag(e),this.engine.broadcast(new c.dJ(e,m.V.OPEN)),this.engine.broadcast(new c.QY(e))}discHoverChange(e,t){if(this.settings.tryGetProperty(y.RY,!1))return;if(!this.data.getTag(e))return;const n=this.viewData.openTag===e;t&&!n?(this.currentApp===f.Mx.SHOWCASE&&this.engine.broadcast(new c.dJ(e,m.V.HOVER)),this.openBillboard(e),this.pinRenderer.setPinColorVariant(e,_.K_.HIGHLIGHTED)):!t&&n&&(this.closeBillboard(e),this.pinRenderer.setPinColorVariant(e,_.K_.DEFAULT)),this.viewData.commit()}tagDirectionToOrientationAdjust(e,t=new i.Quaternion){const n=.25;let s=0,r=0;if(e){switch(e){case E.Pg.RIGHT:case E.Pg.RIGHT_DOWN:case E.Pg.RIGHT_UP:s=-.25;break;case E.Pg.LEFT:case E.Pg.LEFT_DOWN:case E.Pg.LEFT_UP:s=n}switch(e){case E.Pg.UP:case E.Pg.LEFT_UP:case E.Pg.RIGHT_UP:r=n;break;case E.Pg.DOWN:case E.Pg.LEFT_DOWN:case E.Pg.RIGHT_DOWN:s=-.25}}else s=-.25,r=-.25;return t.setFromAxisAngle(w.f.RIGHT,r),t.multiply((new i.Quaternion).setFromAxisAngle(w.f.UP,s)),t}}},57073:(e,t,n)=>{"use strict";n.d(t,{X:()=>MeasurementModeData});var i=n(35424),s=n(64792),r=n(67779),o=n(91183);class MeasurementModeData extends i.V{constructor(){super(...arguments),this.name="measure-mode",this._groups=[],this._groupMap={},this.onDataChangedCallbacks=new Set,this._editingGroupId=null,this._creatingGroupId=null,this.phaseObservable=(0,r.Y)(s.au.CLOSED),this.selectedGroupIndexObservable=new r.f(-1),this.pressProgressObservable=new r.f(-1),this.pointPositionObservable=new r.f(null)}modeActive(){return this.phase!==s.au.CLOSED}*groups(){for(const e of this._groups)yield e}get selectedGroupSid(){const e=this.selectedGroupInfo;return e&&e.info.sid?e.info.sid:null}get selectedGroupInfo(){return-1===this.selectedGroupIndex?null:this.getGroupInfo(this.selectedGroupIndex)}get phase(){return this.phaseObservable.value}get creatingGroupId(){return this._creatingGroupId}set creatingGroupId(e){this._creatingGroupId=e}get editingGroupId(){return this._editingGroupId}set editingGroupId(e){this._editingGroupId=e}setPhase(e){this.phase!==e&&(this.phaseObservable.value=e)}onPhaseChanged(e){return this.phaseObservable.onChanged(e)}notifyDataChanged(){this.onDataChangedCallbacks.forEach((e=>e()))}onDataChanged(e){return(0,o.k1)((()=>this.onDataChangedCallbacks.add(e)),(()=>this.onDataChangedCallbacks.delete(e)),!0)}get groupCount(){return this._groups.length}get selectedGroupIndex(){return this.selectedGroupIndexObservable.value}setSelectedGroupIndex(e){this.selectedGroupIndexObservable.value=e}onSelectedGroupIndexChanged(e){return this.selectedGroupIndexObservable.onChanged(e)}get pointPosition(){return this.pointPositionObservable.value}setPointPosition(e){this.pointPositionObservable.value=e}onPointPositionChanged(e){return this.pointPositionObservable.onChanged(e)}setPressProgress(e){this.pressProgressObservable.value=e}get pressProgress(){return this.pressProgressObservable.value}onPressProgressChanged(e){return this.pressProgressObservable.onChanged(e)}getGroupInfo(e){return e<0||e>=this._groups.length?null:this._groups[e]}getGroupInfoBySid(e){return e?this._groupMap[e]:null}repopulate(e){this.clear();for(const t of e){const e=t.clone();this._groups.push(e),this._groupMap[t.info.sid]=e}this.notifyDataChanged()}clear(){this._groups=[],this._groupMap={}}}},64792:(e,t,n)=>{"use strict";var i;n.d(t,{au:()=>i,Pj:()=>s,Ph:()=>r,q8:()=>o,WN:()=>a}),function(e){e[e.CLOSED=0]="CLOSED",e[e.IDLE=1]="IDLE",e[e.EDITING=2]="EDITING",e[e.CREATING=3]="CREATING",e[e.POINT_PLACED=4]="POINT_PLACED",e[e.CREATING_NEXT_POINT=5]="CREATING_NEXT_POINT",e[e.CONFIRMING_POINT=6]="CONFIRMING_POINT"}(i||(i={}));const s={mobile:{[i.POINT_PLACED]:!0,[i.EDITING]:!0},desktop:{[i.CREATING]:!0,[i.CREATING_NEXT_POINT]:!0,[i.EDITING]:!0}},r={mobile:{[i.CREATING_NEXT_POINT]:!0,[i.POINT_PLACED]:!0,[i.EDITING]:!0},desktop:{[i.CREATING]:!0,[i.CREATING_NEXT_POINT]:!0,[i.EDITING]:!0}},o={[i.IDLE]:!0,[i.EDITING]:!0},a={[i.IDLE]:!0,[i.EDITING]:!0}},4559:(e,t,n)=>{"use strict";n.d(t,{Ev:()=>MeasurementDeleteSelectedCommand,Tn:()=>MeasurementDeleteCommand,JM:()=>MeasurementListDeletionCommand});var i=n(93037);class MeasurementDeleteSelectedCommand extends i.m{}class MeasurementDeleteCommand extends i.m{constructor(e){super(),this.payload={index:e}}}class MeasurementListDeletionCommand extends i.m{constructor(...e){super(),this.payload={sids:e}}}},8483:(e,t,n)=>{"use strict";n.d(t,{O:()=>MeasurementModeToggle});var i=n(93037);class MeasurementModeToggle extends i.m{constructor(e,t,n=!0){super(),this.payload={on:e,dimWhileActive:void 0!==t?t:e,editable:n}}}},63930:(e,t,n)=>{"use strict";n.d(t,{c:()=>MeasurementNewline});var i=n(93037);class MeasurementNewline extends i.m{}},2753:(e,t,n)=>{"use strict";n.d(t,{R:()=>MeasurementRenameCommand});var i=n(93037);class MeasurementRenameCommand extends i.m{constructor(e,t=""){super(),this.id="RENAME_MEASUREMENT",this.payload={sid:e,text:t}}}},5947:(e,t,n)=>{"use strict";n.d(t,{B:()=>MeasurementStop});var i=n(93037);class MeasurementStop extends i.m{}},97082:(e,t,n)=>{"use strict";n.d(t,{W:()=>MeasurementVisibilityCommand});var i=n(93037);class MeasurementVisibilityCommand extends i.m{constructor(e,...t){super(),this.id="VISIBILITY_MEASUREMENT",this.payload={sids:t,visible:e}}}},34e3:(e,t,n)=>{"use strict";n.d(t,{l:()=>NavigateToMeasurementCommand});var i=n(93037);class NavigateToMeasurementCommand extends i.m{constructor(e){super(),this.payload={groupId:e}}}},24133:(e,t,n)=>{"use strict";n.d(t,{rf:()=>MeasurementSegmentCreatedMessage,u6:()=>MeasurementCreatedMessage,ff:()=>MeasurementCreationCancelledMessage,ty:()=>MeasurementTitleAddedMessage,mM:()=>MeasurementTitleChangedMessage,$Z:()=>MeasurementDeletedMessage,av:()=>MeasurementUpdatedMessage,$n:()=>MeasurementModeToggledMessage});var i=n(4117);class MeasurementSegmentCreatedMessage extends i.v{constructor(e){super(),this.data=e}}class MeasurementCreatedMessage extends i.v{constructor(e){super(),this.data=e}}class MeasurementCreationCancelledMessage extends i.v{}class MeasurementTitleAddedMessage extends i.v{constructor(e,t){super(),this.sid=e,this.text=t}}class MeasurementTitleChangedMessage extends i.v{constructor(e,t,n){super(),this.sid=e,this.oldText=t,this.newText=n}}class MeasurementDeletedMessage extends i.v{constructor(e){super(),this.data=e}}class MeasurementUpdatedMessage extends i.v{constructor(e){super(),this.data=e}}class MeasurementModeToggledMessage extends i.v{constructor(e,t,n){super(),this.opened=e,this.viewmode=t,this.count=n}}},54068:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});const i="features/measurements-nudge"},31991:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ModelDataLoadedMessage});var i=n(4117);class ModelDataLoadedMessage extends i.v{constructor(e,t){super(),this.sid=e,this.vrSupported=t}}},97966:(e,t,n)=>{"use strict";n.d(t,{T:()=>ModelData});var i=n(35424),s=n(53995);class ModelData extends i.V{constructor(e){super(),this.name="model",this.model=e}hasDiscoverUrl(){return[s.L.PUBLIC,s.L.UNLISTED].includes(this.model.visibility)}}},53995:(e,t,n)=>{"use strict";var i;n.d(t,{L:()=>i}),function(e){e.PUBLIC="public",e.UNLISTED="unlisted",e.PASSWORD="password",e.PRIVATE="private",e.UNKNOWN="unknown"}(i||(i={}))},13847:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var i=n(20302),s=n(97966);const r=(0,i.u)(s.T)},62667:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});var i=n(67294),s=n(13847);function r(){const e=(0,s.n)(),[t,n]=(0,i.useState)((null==e?void 0:e.model.details.name)||"");return(0,i.useEffect)((()=>{if(!e)return()=>{};const t=e.onChanged(n);return n(e.model.details.name),()=>t.cancel()}),[e]),t}},42374:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ModelDataModule});var i=n(57227),s=n(14877),r=n(48697),o=n(13350),a=n(17403),l=n(85111),c=n(5477),d=n(14909);const u=new c.Z("modelurls");class UrlContainerNoop{constructor(){this.version=3,this.baseUrl="",this.expires=0}validate(e){return!0}update(e){return Promise.resolve()}get(e){if(!this.isSigned(e))throw new Error("Tried getting relative model url with no signed urls configured.");return e}isSigned(e){if(!e.match(/^https?:/))return!1;const t=e.indexOf("?");if(-1===t)return!1;return new URLSearchParams(e.substr(t)).has("t")}}class UrlContainerV3 extends UrlContainerNoop{constructor(){super(...arguments),this.version=3,this.baseUrl="",this.absoluteUrl="",this.expires=0}validate(e){return e.templates&&e.catalog_file}update(e){if(!e.templates)throw new Error("No templates found.");return this.baseUrl=e.templates[0],this.absoluteUrl=this.baseUrl.split("{{filename}}").shift()||"",e.expires?this.expires=1e3*e.expires:this.expires=Date.now()+l.Z.signedUrlDefaultExpireTime,Promise.resolve()}get(e){return this.baseUrl&&this.baseUrl.replace("{{filename}}",e.replace(this.absoluteUrl,""))}}class ModelUrls{constructor(e,t){this.api=e,this.endpoint=t,this.urlContainer=null,this.previousRefreshPromise=null,this.containerClasses=[UrlContainerNoop],t?this.containerClasses=[UrlContainerV3]:this.urlContainer=new UrlContainerNoop}needsRefresh(){if(null===this.endpoint)return!1;const e=this.urlContainer?this.urlContainer.expires:Date.now();return Date.now()+l.Z.signedUrlRefreshBuffer>e}refresh(){if(!this.needsRefresh())return Promise.resolve();if(!this.previousRefreshPromise){u.debug("Refreshing urls...");const e=this;this.previousRefreshPromise=this._refresh().then((function(){u.debug("Refreshed"),e.previousRefreshPromise=null}),(function(t){u.error("Failed url refresh, urls might go stale soon",t),e.previousRefreshPromise=null}))}return this.previousRefreshPromise}async _refresh(e=!0){const t=this.endpoint?await this.api.get(this.endpoint,{responseType:"json",prefetchFrom:e?"files":void 0,priority:a.RequestPriority.HIGHEST}):null;if(this.urlContainer&&this.urlContainer.validate(t))return this.urlContainer.update(t);for(const e of this.containerClasses){const n=new e;if(n.validate(t))return u.info("Using urls version "+n.version),this.urlContainer=n,this.urlContainer.update(t)}if(e)return this._refresh(!1);throw new Error("missing-urls")}isSigned(e){var t;return(null===(t=this.urlContainer)||void 0===t?void 0:t.isSigned(e))||!1}async getSignedUrl(e){if(e.startsWith("blob:"))return e;if(await this.refresh(),!this.urlContainer)throw new Error("Tried to use ModelUrls.get before urlContainer is established.");const t=this.urlContainer.get(e);if(!t)throw new Error(`Could not get signed URL for path ${e}`);return t}async getFile(e,t,n){const i=this.isSigned(e)?e:await this.getSignedUrl(e),s=(0,d.bf)(i,n);return this.api.getOnStoreQueue(s,t)}async getImage(e,t,n){const i=this.isSigned(e)?e:await this.getSignedUrl(e),s=(0,d.bf)(i,n);return this.api.getImage(s,t)}async getImageBitmap(e,t,n,i,s){const r=this.isSigned(e)?e:await this.getSignedUrl(e),o=(0,d.bf)(r,s);return this.api.getImageBitmap(o,t,n,i)}}var h,p,m,f,g,v=n(28129),y=n(97966),b=n(31991),S=n(91985),E=n(10943),T=n(66225);!function(e){e.STAGING="staging",e.PROCESSING="processing",e.FAILED="failed",e.INACTIVATION_PENDING="inactivation_pending",e.INACTIVATING="inactivating",e.INACTIVE="inactive",e.ACTIVATION_PENDING="activation_pending",e.ACTIVATING="activating",e.ACTIVE="active"}(h||(h={})),function(e){e.AVAILABLE="available",e.LOCKED="locked",e.UNAVAILABLE="unavailable"}(p||(p={})),function(e){e.MAX="max",e.LOD0="lod0",e.LOD1="lod1",e.LOD2="lod2",e.LOD3="lod3"}(m||(m={})),function(e){e.custom="custom",e.basic1="basic1",e.basic2="basic2",e.medium1="medium1",e.medium2="medium2"}(f||(f={})),function(e){e.PUBLIC="public",e.PRIVATE="private"}(g||(g={}));var w=n(63336),x=n(38636);class Model{constructor(){this.lastPublished=null}refresh(e){var t;for(const t in this.textures)e.textures[t]&&this.textures[t].refreshFrom(e.textures[t]);null===(t=this.meshUrls)||void 0===t||t.forEach(((t,n)=>{var i,s;const r=null===(s=null===(i=e.meshUrls)||void 0===i?void 0:i[n])||void 0===s?void 0:s.url;t.url&&r&&t.url.refreshFrom(r)})),this.tileset&&e.tileset&&this.tileset.urlTemplate.refreshFrom(e.tileset.urlTemplate),this.imagePose&&e.imagePose&&this.imagePose.refresh(e.imagePose)}}var _=n(16534),M=n(87100),O=n(40603);class ModelLoadException extends O.y{constructor(e,t){super(e),this.name="ModelLoadException",this.code=t}}var A=n(16752),C=n(53995);const N=new c.Z("mds-snapshot-serializer");class MdsModelDeserializer{deserialize(e){var t,n,i;if(!e||!this.validate(e))return N.debug("Deserialized invalid model data from MDS",e),null;const s=null!==(t=e.state)&&void 0!==t?t:h.ACTIVE;if(s!==h.ACTIVE)throw N.error(`model unavailable, status: ${s}`,e),new ModelLoadException("model unavailable",s);const r=e.publication||{},o=r.contact||{},a=e.options,l=new Model;l.sid=e.id,l.organizationId=e.organization||null,l.image=e.image?e.image.id:"",l.imagePose=null,l.details={sid:e.id,name:e.name||"",presentedBy:r.presentedBy||"",summary:r.summary||"",formattedAddress:r.address||"",contact:{email:o.email||"",name:o.name||"",phone:o.phoneNumber||"",formattedPhone:o.phoneNumber||""},externalUrl:r.externalUrl||""},l.created=(0,w.p)(e.created,null),l.options={urlBranding:null===(n=a.urlBrandingEnabled)||void 0===n||n,socialSharing:!!a.socialSharingEnabled,isPublic:!!r.published,isVR:!!a.vrEnabled},r.lastPublished&&(l.lastPublished=(0,w.p)(r.lastPublished,null));const c=e.assets.textures.filter((e=>"high"===e.quality))[0],d=e.assets.textures.filter((e=>"low"===e.quality))[0];l.textures={},c&&(l.textures.high=new v.n(c,(0,w.p)(c.validUntil,null))),d&&(l.textures.low=new v.n(d,(0,w.p)(d.validUntil,null)));const u=this.getDamFileUrls(e);(null==u?void 0:u.length)&&(l.meshUrls=u);const p=null===(i=e.assets.tilesets)||void 0===i?void 0:i[0];if(this.validateTileset(p)&&(l.tileset=this.getTileset(p,e.lod),l.textures.max=this.getTilesetTextures(p)),!l.meshUrls&&!l.tileset)throw N.error("No DAM or tileset info found for model",l),new ModelLoadException("No DAM or tileset info found for model",s);return l.visibility=this.getModelVisibility(e),l}validate(e){return["id","assets","publication"].every((t=>t in e))}getDamFileUrls(e){return((0,x.q)(e,"assets.meshes")||[]).reduce(((e,t)=>{if(t.status===p.AVAILABLE){const n={url:new v.n(t.url,(0,w.p)(t.validUntil,null)),suffix:t.resolution?`_${t.resolution}`:"",extension:t.format||""};"50k"===t.resolution?e.unshift(n):e.push(n)}return e}),[])}validateTileset(e){var t;if(!e)return!1;const n=A.o.lt(null!==(t=e.tilesetVersion)&&void 0!==t?t:"0","1.0.0");return e&&e.status===p.AVAILABLE&&!n}getTileset(e,t){var n;const i=this.getTilesetMaxLOD(e,t),s=this.getRootTilesetFilename(e,t),r=this.getUrlTemplate(e);return{maxLOD:i,rootFilename:s,urlTemplate:new v.n(r,(0,w.p)(e.validUntil,null)),tilesetVersion:null!==(n=e.tilesetVersion)&&void 0!==n?n:"beta"}}getTilesetMaxLOD(e,t){var n,i;let s=2;if(void 0!==e.tilesetPreset&&"basic1"!==e.tilesetPreset&&void 0!==e.tilesetDepth)return e.tilesetDepth;switch(null===(n=null==t?void 0:t.options)||void 0===n?void 0:n[0]){case m.MAX:s=void 0!==e.tilesetDepth?e.tilesetDepth:4,A.o.lt(null!==(i=e.tilesetVersion)&&void 0!==i?i:"0","1.1.0")&&(s=3);break;case m.LOD3:s=3;break;case m.LOD2:s=2;break;case m.LOD1:s=1;break;case m.LOD0:s=0}return 1===(0,M.eY)("debugTiles",0)&&(0,M.eY)("maxLOD",s)!==s&&(s=(0,M.eY)("maxLOD",s)),s}getRootTilesetFilename(e,t){if(1===(0,M.eY)("debugTiles",0)&&""!==(0,M.eY)("tilesetroot",""))return(0,M.eY)("tilesetroot","");if(e.tilesetPreset===f.custom)return"tileset.json";return`${this.getTilesetMaxLOD(e,t)}.json`}getTilesetTextures(e){const t=this.getUrlTemplate(e);return new v.n({id:"tiled",resolution:"*",textures:1/0,quality:"max",format:"jpg",urlTemplate:t.replace(_.d_.urlTemplateToken,"<folder>/<texture>.jpg"),validUntil:e.validUntil},(0,w.p)(e.validUntil,null))}getUrlTemplate(e){return _.d_.urlTemplateOverride?_.d_.urlTemplateOverride+_.d_.urlTemplateToken+"?t=fake":e.urlTemplate}getModelVisibility(e){return void 0===e.visibility||e.visibility===g.PUBLIC?e.discoverable?C.L.PUBLIC:C.L.UNLISTED:e.visibility===g.PRIVATE?C.L.PRIVATE:C.L.UNKNOWN}}class MdsModelStore extends T.u{constructor(){super(...arguments),this.serializer=new MdsModelDeserializer,this.photoDeserializer=new E.f,this.prefetchKey="data.model"}async read(e){var t,n,i;const s={modelId:this.getViewId()},r=await this.query(S.GetModelDetails,s,e),o=this.serializer.deserialize(null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.model);return o&&(o.imagePose=this.photoDeserializer.deserialize(null===(i=null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.model)||void 0===i?void 0:i.image)),o}async refresh(){return this.refreshPromise||(this.refreshPromise=this.read({fetchPolicy:"no-cache"}).finally((()=>{this.refreshPromise=void 0}))),this.refreshPromise}}class ModelDataModule extends i.Y{constructor(){super(...arguments),this.name="model-data"}async init(e,t){this.engine=t;const{baseUrl:n,readonly:i}=e;this.store=new MdsModelStore({readonly:i,baseUrl:n});const a=await this.store.read();if(!a)throw Error("Could not fetch model data");(0,v.s)(a,(async()=>{const e=await this.store.refresh();e&&a.refresh(e)})),this.model=a;const l=new y.T(this.model);t.market.register(this,y.T,l),this.registerSettings(l),async function(e,t,n){(await n.getModuleBySymbol(s.y.ANALYTICS)).setOptions({model_mesh_type:e.model.tileset&&t.tiledMeshEnabled?"streamed":"dam"})}(l,e,t),t.market.waitForData(r.Q).then((e=>{a.lastPublished&&(e.lastPublished=a.lastPublished.getTime())}));const c=(await t.getModule(o.default)).getApi();this.signedUrls=new ModelUrls(c,null),this.signedUrls.meshUrls=this.model.meshUrls,t.broadcast(new b.Z(this.model.sid,this.model.vrSupported))}async registerSettings(e){const t=await this.engine.getModuleBySymbol(s.y.SETTINGS),n="Model Options",{urlBranding:i=!0,socialSharing:r,isPublic:o,isVR:a}=e.model.options||{};t.registerSetting(n,_.Yo,r),t.registerSetting(n,"is_public",o),t.registerSetting(n,"is_vr",a);const l=!i||!!(0,M.eY)("brand",!0),c=i?(0,M.eY)("mls","0"):"0",d=i?(0,M.eY)("title","1"):"1";t.registerSetting(n,_.Zz,"0"!==d&&"2"!==c),t.registerSetting(n,_.DU,"0"!==d&&"2"!==d),t.registerSetting(n,_.L,l),t.registerSetting(n,_.sX,"1"===c||"2"===c)}getSignedUrls(){return this.signedUrls}}},16534:(e,t,n)=>{"use strict";n.d(t,{Yo:()=>s,L:()=>r,sX:()=>o,DU:()=>a,Zz:()=>l,r4:()=>c,d_:()=>d});var i=n(87100);const s="social_sharing",r="branding_enabled",o="presentation_mls_mode",a="presentation_title",l="presentation_about",c="discover_space_url",d={urlTemplateToken:"<file>",urlTemplateOverride:(0,i.eY)("tiledtemplate",null)}},24838:(e,t,n)=>{"use strict";var i;n.d(t,{S:()=>i}),function(e){e[e.Standard=0]="Standard",e[e.Depth=1]="Depth",e[e.Transparent=2]="Transparent",e[e.Wireframe=3]="Wireframe"}(i||(i={}))},75977:(e,t,n)=>{"use strict";n.d(t,{S:()=>ModelColliderTarget});var i=n(2212);class ModelColliderTarget extends i.Mesh{constructor(){super(...arguments),this.raycastEnabled=!0}}},54374:(e,t,n)=>{"use strict";n.d(t,{g:()=>RoomMesh});var i=n(2212),s=n(33299),r=n(19945),o=n(75977),a=n(99295),l=n(56483);class RoomMesh extends o.S{constructor(e,t,n=s.o.ALL){super(),this._opacity=1,this._chunks=[],this.size=new i.Vector3,this.center=new i.Vector3,this.built=!1,this.layers.mask=n.mask,this.name=`RoomMesh:${e}-${t}`,this.meshGroup=e,this.meshSubgroup=t,this.renderOrder=a.z.default,this.onBeforeRender=(e,t,n,s,r,o)=>{r instanceof i.RawShaderMaterial&&(o?this.chunks[o.materialIndex].onBeforeDraw(r):this.chunks.length&&this.chunks[0].onBeforeDraw(r))}}dispose(){this.reset()}reset(){this._chunks.length=0,this.geometry.dispose(),this.built=!1}addChunk(e){-1===this._chunks.indexOf(e)&&this._chunks.push(e)}getChunk(e){return this._chunks[e]}build(){if(this.built)throw new Error("build() should only be called once");if(!this._chunks.length)return;const e=(0,r.qf)(this._chunks.map((e=>e.geometry)));e.clearGroups();let t=0;this.material=[],this._chunks.forEach(((n,i)=>{n.geometry&&n.geometry.index&&(e.addGroup(t,n.geometry.index.count,i),t+=n.geometry.index.count,n.geometry.dispose(),n.geometry=e,n.notifyOnMaterialUpdated((e=>{Array.isArray(this.material)&&(this.material[i]=e)})),n.onOpacityUpdate=e=>{this.opacity=e})})),this.geometry=e,this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere(),this.material=this._chunks.map((e=>e.material)),this.size=this.boundingBox.getSize(this.size),this.center=this.boundingBox.getCenter(this.center),this.built=!0}buildWithTileChunk(e){if(this.built)return;const{meshGroup:t,meshSubgroup:n,lod:i}=e;this.name=`RoomMesh:${i}-${t}-${n}-${e.chunkIndex}`,this.meshGroup=t,this.meshSubgroup=n,this._chunks.push(e),e.notifyOnMaterialUpdated((e=>{this.material=e})),e.onOpacityUpdate=e=>{this.opacity=e},this.size=this.boundingBox.getSize(this.size),this.center=this.boundingBox.getCenter(this.center),this.built=!0}get boundingBox(){return(0,r.A5)(this.geometry)}set opacity(e){e!==this.opacity&&(this._opacity=e,this.raycastEnabled=e>l.xx.FADE_CLICKABLE_THRESHOLD,this.renderOrder=e<l.xx.FADE_OPAQUE?a.z.ghostFloor:a.z.default)}get opacity(){return this._opacity}get chunks(){return this._chunks}getSortKey(){return this.chunks.length?this._chunks[0].getSortKey():0}}},73694:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i}),function(e){e[e.NONE=0]="NONE",e[e.RAYCAST=1]="RAYCAST"}(i||(i={}))},42249:(e,t,n)=>{"use strict";n.d(t,{U:()=>SetChunkRenderModeCommand});var i=n(93037),s=n(24838);class SetChunkRenderModeCommand extends i.m{constructor(e){super(),this.id="SET_CHUNK_RENDER_MODE",this.payload={mode:e}}}SetChunkRenderModeCommand.modes=s.S},39808:(e,t,n)=>{"use strict";n.d(t,{_:()=>MeshData});var i=n(35424),s=n(2212),r=n(41252);const o=[-5,-5,-5,5,5,5];class MeshData extends i.V{constructor(e,t=o,n=o){super(),this.name="mesh-data",this.extendedBounds=new s.Box3,this.extendedSize=new s.Vector3,this.meshBounds=new s.Box3,this.meshCenter=new s.Vector3,this.meshSize=new s.Vector3,this.meshRadius=0,this.maxPlacementRadius=0,this._meshGroups={floors:new Set,rooms:new Map,roomsByFloor:new Map},this.meshGroupVisuals={floorOpacity:new Map,floorFadeDist:new Map},this.meshSubGroupsFromPoint=e=>{const t=[];for(const[n,i]of this.meshGroups.rooms)i.boundingBox.containsPoint(e)&&t.push(n);return t},this.meshTextureOpacity=new r.z(e),this.meshBounds.setFromArray(t),this.meshBounds.getCenter(this.meshCenter),this.meshBounds.getSize(this.meshSize),this.meshRadius=this.meshSize.clone().multiplyScalar(.5).length(),this.maxPlacementRadius=3*this.meshRadius,this.extendedBounds.setFromArray(n),this.extendedBounds.getSize(this.extendedSize)}get meshGroups(){return this._meshGroups}}},60050:(e,t,n)=>{"use strict";var i;n.d(t,{V:()=>i}),function(e){e[e.Min=0]="Min",e[e.Standard=1]="Standard",e[e.High=2]="High",e[e.Detail=3]="Detail"}(i||(i={}))},43816:(e,t,n)=>{"use strict";n.d(t,{T0:()=>r,Pv:()=>o,Nr:()=>a});var i=n(75977);const s=e=>e instanceof i.S,r=e=>s(e),o=e=>s(e)&&e.raycastEnabled&&e.visible,a=e=>{let t=e.visible;t&&e.traverseAncestors((e=>{t&&(t=e.visible)}));return!r(e)&&t||o(e)}},73201:(e,t,n)=>{"use strict";var i;n.d(t,{h:()=>i}),function(e){e.PanoTexture="PANO_TEXTURE",e.PanoTextureTransition="PANO_TEXTURE_TRANSITION",e.MeshTexture="MESH_TEXTURE",e.ColorOverlay="COLOR_OVERLAY",e.MeshPreviewSphere="MESH_PREVIEW_SPHERE",e.Wireframe="WIREFRAME",e.FlatShading="FLAT_SHADING",e.PanoOverlay="PANO_OVERLAY",e.PanoOverlayTransition="PANO_OVERLAY_TRANSITION",e.MeshTrimVertex="MESH_TRIM_VERTEX",e.MeshTrimPixel="MESH_TRIM_PIXEL"}(i||(i={}))},88965:(e,t,n)=>{"use strict";n.d(t,{oR:()=>s,$4:()=>r});var i=n(54374);const s=e=>!!e&&e instanceof i.g,r={hasMeshGroup:e=>"object"==typeof e&&!!e&&"meshGroup"in e,hasMeshSubgroup:e=>"object"==typeof e&&!!e&&"meshSubgroup"in e,isRoomMesh:s,isVisibleRoomMesh:e=>s(e)&&e.raycastEnabled&&e.visible}},43585:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ModelLoadProgressMessage});var i=n(4117);class ModelLoadProgressMessage extends i.v{constructor(e,t){super(),this.loaded=e,this.total=t}}},56483:(e,t,n)=>{"use strict";n.d(t,{EJ:()=>s,ZP:()=>r,Lp:()=>o,iT:()=>a,xx:()=>l});var i=n(87100);const s={flipDownload:(0,i.eY)("flipDownload",!0),flipUpload:(0,i.eY)("flipUpload",!0),debugLOD:(0,i.eY)("debuglod",!1),debugRttQuality:(0,i.eY)("debugQuality",!1),debugRttScores:(0,i.eY)("debugScores",!1),debugRttClear:(0,i.eY)("debuglodrtt",!0),debugPauseTexStream:(0,i.eY)("textureStreamPause",!1),sightingMaxAge:(0,i.eY)("meshSightingMaxAge",600),textureTileSize:(0,i.eY)("chunkTileSize",512)},r=s,o="wireframeEnabled",a="features/tiled_mesh",l={FADE_OPAQUE:1,FADE_ABOVE:.024,FADE_BELOW:.1,FADE_CLICKABLE_THRESHOLD:.025,FADE_IN_VALUE:.08,FADE_DEPTH_WRITE_THRESHOLD:(0,i.eY)("chunkDepthWrite",.5),FADE_IN_END_ANGLE:45,FADE_IN_START_ANGLE:22,FADE_IN_HOVER_BOOST_VALUE:.2,FADE_BELOW_START:0,FADE_BELOW_MULT:1,DISCARD_FOCAL_MULTI:.125}},81674:(e,t,n)=>{"use strict";n.d(t,{t:()=>r,Z:()=>o});var i=n(2212),s=n(73201);const r=10,o={cube:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:n(65723),fragmentShader:n(56128)},blurCube:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1},dir:{type:"v2",value:new i.Vector2(0,0)}},vertexShader:n(64937),fragmentShader:n(81254)},modelChunk:{uniforms:{[s.h.MeshTexture]:{map:{type:"t",value:null},meshOpacity:{type:"f",value:0},opacity:{type:"f",value:1},transparentDiscardDist:{type:"f",value:0}},[s.h.MeshTrimVertex]:{meshTrimMatrices:{type:"mat4array",value:[]},meshTrimsDiscardContents:{type:"barray",value:new Array(r).fill(!0)},hasKeepVolume:{type:"b",value:!1}},[s.h.MeshTrimPixel]:{meshTrimMatrices:{type:"mat4array",value:[]},meshTrimsDiscardContents:{type:"barray",value:new Array(r).fill(!0)},hasKeepVolume:{type:"b",value:!1}},[s.h.PanoTexture]:{pano0Map:{type:"t",value:null},pano0Position:{type:"v3",value:new i.Vector3},pano0Matrix1:{type:"m4",value:new i.Matrix4},pano0Matrix2:{type:"m4",value:new i.Matrix4},panoOpacity:{type:"f",value:1}},[s.h.PanoTextureTransition]:{progress:{type:"f",value:0},pano1Map:{type:"t",value:null},pano1Position:{type:"v3",value:new i.Vector3},pano1Matrix1:{type:"m4",value:new i.Matrix4},pano1Matrix2:{type:"m4",value:new i.Matrix4}},[s.h.PanoOverlay]:{overlay0Map:{type:"t",value:null},overlay0Matrix:{type:"m4",value:new i.Matrix4}},[s.h.PanoOverlayTransition]:{overlay1Map:{type:"t",value:null},overlay1Matrix:{type:"m4",value:new i.Matrix4}},[s.h.ColorOverlay]:{colorOverlay:{type:"v4",value:null}},[s.h.MeshPreviewSphere]:{meshPreviewCenter:{type:"v3",value:null},meshPreviewSize:{type:"f",value:.3}},[s.h.Wireframe]:{time:{type:"f",value:0},fill:{type:"c",value:new i.Color(16711680)},stroke:{type:"c",value:new i.Color(16777215)},dualStroke:{type:"b",value:!1},fillEnabled:{type:"b",value:!1},insideAltColor:{type:"b",value:!1},thickness:{type:"f",value:.1},secondThickness:{type:"f",value:.1},dashEnabled:{type:"b",value:!1},dashRepeats:{type:"f",value:10},dashOverlap:{type:"b",value:!1},dashLength:{type:"f",value:.1,range:[0,1]},dashAnimate:{type:"b",value:!1},squeeze:{type:"b",value:!1},squeezeMin:{type:"f",value:.1},squeezeMax:{type:"f",value:1},wireframeOpacity:{type:"f",value:1,range:[0,1]}}},vertexShader:n(17513),fragmentShader:n(36328)},modelOutside:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1},colorOverlay:{type:"v4",value:new i.Vector4(0,0,0,0)}},vertexShader:n(68842),fragmentShader:n(14522)},depth:{uniforms:{opacity:{type:"f",value:1},maxDistance:{type:"f",value:20}},vertexShader:n(2835),fragmentShader:n(51095)}}},83229:(e,t,n)=>{"use strict";n.d(t,{S7:()=>i,O7:()=>f,qT:()=>h,Pm:()=>p});var i,s=n(28124),r=n(2212),o=n(60050),a=n(63387),l=n(56483);class TextureQualityMap{constructor(){this._configs={},this._orders={},this._maxLod=-1/0,this._maxTs=1/0,this._streamAbove=0,this.resetOnNextRegisterOnce=!1,this.dynamic=!1}static encodeKey(e,t){return e-t}get maxLod(){return this._maxLod}get maxTexelSize(){return this._maxTs}limitStreamingBelow(e){this._streamAbove=e}order(e,t=!1){return t&&!this._orders[e]&&(this._orders[e]=[]),this._orders[e]}reset(){this._configs={},this._orders={},this.dynamic=!1,this._maxTs=1/0,this._maxLod=-1/0}get isDynamic(){return this.dynamic}valid(e){return e in this._configs}get(e){if(!this.valid(e))throw new Error("invalid quality level "+e);return this._configs[e]}max(e){return e<this._streamAbove?this.min(e):this.order(e)[this.order(e).length-1]}min(e){return this.order(e)[0]}fromPixelSize(e,t){const n=this.order(e),i=this.min(e);let s=this.max(e);for(let e=n.length-1;e>=0;e--)t>this.get(n[e]).texelSize&&n.indexOf(s)>n.indexOf(i)&&(s=n[e]);return s}moreDetailed(e,t){let n=this.min(e);const i=this.max(e),s=this.order(e),r=s.indexOf(t);return r+1===s.length?i:(-1!==r&&(n=Math.min(i,s[r+1%s.length])),n)}lessDetailed(e,t){const n=this.order(e),i=n.indexOf(t);let s=t;return-1!==i&&(s=n[Math.max(0,i-1)]),s}minSize(){return Object.values(this._configs).sort(c)[0]}maxSize(){const e=Object.values(this._configs).sort(c);return e[e.length-1]}nearestQuality(e,t){const n=this.order(e),i=this.max(e),s=(0,a.et)(t,1,4,0,n.length-1);return Math.min(i,n[Math.round(s)])}registerQualities(e,t,n,i,s="max"){this.dynamic=!0,this.resetOnNextRegisterOnce&&(this.reset(),this.resetOnNextRegisterOnce=!1);const r=this._configs,o=this.order(e,!0),a=t*i;for(let i=t,c=n;i>=a;i*=.5,c*=2){const n=TextureQualityMap.encodeKey(e,c),a=r[n];(!a||a&&a.assetSize<t)&&(this._maxTs=Math.min(this._maxTs,c),this._maxLod=Math.max(this._maxLod,e),r[n]={key:n,lod:e,texelSize:c,textureSize:i,assetSize:t,assetType:s,tileSize:Math.min(i,l.ZP.textureTileSize)}),-1===o.indexOf(n)&&o.push(n)}o.sort(((e,t)=>r[t].texelSize-r[e].texelSize))}}function c(e,t){return e.textureSize>t.textureSize?1:-1}!function(e){e[e.LOW=1]="LOW",e[e.MEDIUM=2]="MEDIUM",e[e.HIGH=3]="HIGH",e[e.ULTRA=4]="ULTRA"}(i||(i={}));const d=new TextureQualityMap;var u;(u=d).reset(),u.registerQualities(o.V.Standard,512,.048,.5,"low"),u.registerQualities(o.V.Standard,2048,.012,.5,"high"),u.dynamic=!1,u.resetOnNextRegisterOnce=!0;const h=()=>d;const p=e=>{const t=h();if(!t.isDynamic){const n=t.order(0).map(((e,n)=>({index:n,level:t.get(e)})));for(const{index:t,level:i}of n)if(i.textureSize===e)return t}throw new Error(`Not a valid texture size: ${e}`)},m={[i.LOW]:new r.Vector4(1,0,0,.5),[i.MEDIUM]:new r.Vector4(1,1,0,.5),[i.HIGH]:new r.Vector4(0,1,0,.5),[i.ULTRA]:new r.Vector4(0,1,1,.5)};function f(e){return e in m?m[e]:(0,s.G1)(.5,e)}},31055:(e,t,n)=>{"use strict";n.d(t,{P:()=>ModelRatingViewData});var i=n(35424),s=n(67779);class ModelRatingViewData extends i.V{constructor(){super(),this.name="model-rating-view-data",this.isDialogVisible=new s.f(!1),this.setDialogVisible=e=>{this.isDialogVisible.value=void 0!==e?e:!this.isDialogVisible.value}}onDialogVisibleChanged(e){return this.isDialogVisible.onChanged(e)}getIsDialogVisible(){return this.isDialogVisible.value}}},17116:(e,t,n)=>{"use strict";n.d(t,{m:()=>ToggleModelRatingDialogCommand,M:()=>SubmitModelRatingCommand});var i=n(93037);class ToggleModelRatingDialogCommand extends i.m{constructor(e){super(),this.payload={toVisible:e}}}ToggleModelRatingDialogCommand.id="TOGGLE_MODEL_RATING_DIALOG";class SubmitModelRatingCommand extends i.m{constructor(e,t=!1){super(),this.payload={rating:e,didFinish:t}}}SubmitModelRatingCommand.id="SUBMIT_MODEL_RATING"},19582:(e,t,n)=>{"use strict";n.d(t,{E:()=>ModelRatedMessage});var i=n(4117);class ModelRatedMessage extends i.v{constructor(e){super(),this.rating=e}}},7765:(e,t,n)=>{"use strict";n.d(t,{i:()=>i,j:()=>s});const i="features/model-rating-dialog",s="features/model-rating-dialog-prompt"},10830:(e,t,n)=>{"use strict";n.d(t,{u:()=>SetMouseCursorCommand});var i=n(93037);class SetMouseCursorCommand extends i.m{constructor(e=null){super(),this.id="SET_MOUSE_CURSOR",this.payload={cursor:e}}}},42226:(e,t,n)=>{"use strict";var i;n.d(t,{C:()=>i}),function(e){e.NONE="none",e.DEFAULT="default",e.MOVE="move",e.MOVE_LF="col-resize",e.MOVE_UD="row-resize",e.XHAIR="crosshair",e.PLUS="cell",e.QUESTION="help",e.NOPE="not-allowed",e.FINGER="pointer",e.TEXT="text",e.TEXT_VERT="vertical-text",e.ZOOM_IN="zoom-in",e.ZOOM_OUT="zoom-in",e.GRAB="grab",e.GRABBING="grabbing",e.ARROW_R="e-resize",e.ARROW_L="w-resize",e.ARROW_U="n-resize",e.ARROW_D="s-resize",e.ARROW_UR="ne-resize",e.ARROW_UL="nw-resize",e.ARROW_DR="se-resize",e.ARROW_DL="sw-resize",e.ARROW_LR="ew-resize",e.ARROW_UD="ns-resize",e.ARROW_URDL="nesw-resize",e.ARROW_ULDR="nwse-resize"}(i||(i={}))},88770:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Cursor:()=>s.C,SetMouseCursorCommand:()=>r.u,default:()=>MouseCursor});var i=n(57227),s=n(42226),r=n(10830);class MouseCursor extends i.Y{constructor(){super(...arguments),this.name="mouse-cursor",this.activeCursor=null}async init(e,t){this.config=Object.assign({classPrefix:"cursor"},e),this.bindings.push(t.commandBinder.addBinding(r.u,(async e=>this.changeCursor(e.cursor))))}changeCursor(e){const{container:t,classPrefix:n}=this.config;e!==this.activeCursor&&(this.activeCursor&&t.classList.remove(`${n}-${this.activeCursor}`),e&&t.classList.add(`${n}-${e}`),this.activeCursor=e)}}},48730:(e,t,n)=>{"use strict";n.d(t,{ZK:()=>LockNavigationCommand,Lp:()=>UnlockNavigationCommand,Np:()=>NavigateToBox,zs:()=>FocusOnPointInsideCommand,OR:()=>FocusOnPinInsideCommand,ju:()=>NavigateToSweepCommand,Cs:()=>NavigateToLabelCommand,L4:()=>NavigateToPoseCommand});var i=n(93037);class LockNavigationCommand extends i.m{constructor(){super(),this.id="LOCK_NAVIGATION"}}class UnlockNavigationCommand extends i.m{constructor(){super(),this.id="UNLOCK_NAVIGATION"}}class NavigateToBox extends i.m{constructor(e){super(),this.payload=e,this.id="NAVIGATE_TO_BOX"}}class FocusOnPointInsideCommand extends i.m{constructor(e){super(),this.payload=e,this.id="FOCUS_ON_POINT_INSIDE"}}class FocusOnPinInsideCommand extends i.m{constructor(e){super(),this.payload=e,this.id="FOCUS_ON_PIN_INSIDE"}}class NavigateToSweepCommand extends i.m{constructor(e){super(),this.id="MOVE_TO_SWEEP",this.payload=Object.assign({},e)}}class NavigateToLabelCommand extends i.m{constructor(e){super(),this.payload=e,this.id="NAVIGATE_TO_LABEL"}}class NavigateToPoseCommand extends i.m{constructor(e){super(),this.id="NAVIGATE_TO_POSE",this.payload={pose:e}}}},98226:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Navigation});var i=n(57227),s=n(61903),r=n(14877),o=n(15099),a=n(14832),l=n(18984),c=n(59057),d=n(48730),u=n(40603);class NavigationException extends u.y{constructor(e){super(e),this.name="NavigationException"}}const h={Locked:"Cannot move while navigation is locked",InsideOnly:"Cannot navigate between panos when not in Panorama mode",InvalidSweep:"Not at a valid sweep",InTransition:"Cannot move while in a transition",NoDestinationFound:"Cannot move in that direction"};var p=n(3035),m=n(95847),f=n(16493),g=n(91825),v=n(2212),y=n(37632),b=n(43816),S=n(9682),E=n(28757),T=n(10830),w=n(42226),x=n(23676),_=n(32683);class NavigationInputFocus{constructor(e,t,n,i,s,r,o,a,l,c,d){this.canStartTransition=e,this.commandBinder=t,this.input=n,this.floorsViewData=i,this.navigation=s,this.navigationDollhouse=r,this.sweepData=o,this.cameraModule=a,this.toolsData=l,this.settingsData=c,this.meshQuery=d,this.bindings=[],this.cancelTransition=!1,this.didSetCursor=!1,this.targetFloorId=null,this.targetHitPoint=new v.Vector3,this.toggleInput=e=>{this.bindings.forEach((t=>e?t.renew():t.cancel()))},this.onRoomClick=(e,t,n)=>{if(this.shouldIgnore())return!1;if(!this.canStartTransition())return!1;if(!n||!n.point)return!1;const i=this.meshQuery.floorIdFromObject(t);if(!i)return!1;if(!this.floorsViewData.isNavigable(i))return this.onBackgroundClick();if(this.cancelTransition)return!0;const s=this.floorsViewData.currentFloorId;return 1!==this.floorsViewData.totalFloors&&i!==s?(this.targetFloorId||(this.targetFloorId=i,this.targetHitPoint.copy(n.point)),!s&&(this.changeFloorIfNeeded(),!0)):this.floorsViewData.roomSelectModeActive||this.floorsViewData.floorSelectModeActive?(this.cancelTransition=!0,this.cameraModule.cancelTransition().then((()=>this.navigation.navigateToPanoNearIntersection(n))).then((()=>{this.cancelTransition=!1})),this.commandBinder.issueCommand(new T.u(w.C.DEFAULT)),!0):this.floorsViewData.floorSelectModeActive?(this.cancelTransition=!1,!1):(this.navigationDollhouse.navigateToPoint(n.point).then((()=>{this.cancelTransition||this.setFocusSweep(n),this.cancelTransition=!1})),!0)},this.onBackgroundClick=()=>!this.shouldIgnore()&&(!!this.canStartTransition()&&(!this.targetFloorId&&(!!this.cancelTransition||(this.cancelTransition=!0,void this.cameraModule.cancelTransition().then((()=>this.commandBinder.issueCommand(new y.Vw(null,!1)))).then((()=>{this.cancelTransition=!1})))))),this.onBackgroundHover=()=>{if(this.shouldIgnore())return!1;const{activeToolName:e}=this.toolsData;return null!==this.floorsViewData.currentFloorId&&e!==x.w1.LABELS&&(this.didSetCursor=!0,this.commandBinder.issueCommand(new T.u(w.C.FINGER))),!1},this.onBackgroundUnhover=()=>(this.shouldIgnore()||this.didSetCursor&&(this.commandBinder.issueCommand(new T.u(w.C.DEFAULT)),this.didSetCursor=!1),!1),this.onFloorChange=()=>{this.shouldIgnore()||null===this.floorsViewData.currentFloorId&&this.commandBinder.issueCommand(new T.u(w.C.DEFAULT))},this.clearFloorChange=()=>{this.targetFloorId=null},this.changeFloorIfNeeded=async()=>{this.targetFloorId&&(await this.commandBinder.issueCommand(new y.Vw(this.targetFloorId,!1,void 0,this.targetHitPoint)),this.targetFloorId=null)},this.bindings.push(this.input.registerMeshHandler(p.R,f.s.is(b.Pv),this.onRoomClick),this.input.registerUnfilteredHandler(p.R,this.clearFloorChange),this.input.registerHandler(p.R,this.changeFloorIfNeeded),this.input.registerMeshHandler(p.R,f.s.isType(g.i),this.onBackgroundClick),this.input.registerMeshHandler(m.z,f.s.isType(g.i),this.onBackgroundHover),this.input.registerMeshHandler(m.A,f.s.isType(g.i),this.onBackgroundUnhover),this.floorsViewData.makeFloorChangeSubscription(this.onFloorChange))}async setFocusSweep(e){if(!this.canStartTransition())return;if(this.cancelTransition)return;const t=(0,S.bG)(this.sweepData,!1,e,this.meshQuery);t.length>0&&t[0].sweep&&await this.commandBinder.issueCommand(new E.aK(t[0].sweep.id))}shouldIgnore(){return!this.settingsData.tryGetProperty(_.Q5,!1)}}var M=n(77280),O=n(43985),A=n(17921),C=n(94113),N=n(19926),D=n(75977),I=n(8054),L=n(5477);const P=new L.Z("nav-input");class NavigationInputInside{constructor(e,t,n){this.navigation=e,this.inputIni=t,this.insideNav=[],this.insideVrNav=[],this.toggleInput=e=>{this.insideNav.forEach((t=>e?t.renew():t.cancel()))},this.toggleVrInput=e=>{this.insideVrNav.forEach((t=>e?t.renew():t.cancel()))},this.registerInsideClickHandlers=e=>[e.registerMeshHandler(p.R,f.s.is(b.Pv),((e,t,n)=>this.tryExecuteAction(((e,t)=>B(e)&&R(t)),((e,t)=>R(t)&&this.navigation.navigateTowardsIntersection(t)),e,n))),e.registerMeshHandler(p.R,f.s.isType(g.i),((e,t,n)=>this.tryExecuteAction(((e,t)=>B(e)&&R(t)),((e,t)=>R(t)&&this.navigation.navigateTowardsIntersection(t)),e,n)))],this.registerVrClickHandlers=e=>[e.registerMeshHandler(p.R,f.s.isInstanceOf(D.S),((e,t,n)=>this.tryExecuteAction(((e,t)=>B(e)&&R(t)),((e,t)=>R(t)&&this.navigation.navigateToPanoNearIntersection(t)),e,n)))],this.registerWheelInput=e=>[e.registerHandler(A.a,(e=>this.tryExecuteAction((e=>!0),(e=>{if(e instanceof A.a){const t=new v.Vector3(0,0,Math.sign(e.delta.y));return!!this.navigation.navigateInLocalDirection(t)}return!1}),e)))],this.hotkeys=e=>[e.registerHandler(C.e,(e=>this.tryExecuteAction((e=>(k(e)||U(e))&&e.key in NavigationInputInside.hotkeyDirections),(e=>{if(k(e)){this.continuousMovementHotkey=e.key;const t=NavigationInputInside.hotkeyDirections[e.key];this.navigation.setContinuousNavigationLocalDirection(t)}else U(e)&&e.key===this.continuousMovementHotkey&&this.navigation.setContinuousNavigationLocalDirection();return!1}),e)))],this.tryExecuteAction=(e,t,n,i)=>{let s=!1;try{this.navigation.isNavigationInputAllowed()&&e(n,i)&&(s=t(n,i))}catch(e){if(!(e instanceof NavigationException))throw P.warn(e),e;P.debug(e)}return s},this.insideVrNav.push(...this.registerVrClickHandlers(this.inputIni)),this.insideNav.push(...this.registerInsideClickHandlers(this.inputIni),...this.hotkeys(this.inputIni)),n&&this.insideNav.push(...this.registerWheelInput(this.inputIni))}get bindings(){return[...this.insideNav,...this.insideVrNav]}}function R(e){return void 0!==e&&void 0!==e.point}function k(e){return e instanceof C.e&&e.state===N.M.DOWN}function U(e){return e instanceof C.e&&e.state===N.M.UP}function B(e){return e instanceof p.R&&e.button===I.MP.PRIMARY}NavigationInputInside.hotkeyDirections={[O.R.W]:M.f.FORWARD,[O.R.A]:M.f.LEFT,[O.R.S]:M.f.BACK,[O.R.D]:M.f.RIGHT,[O.R.UPARROW]:M.f.FORWARD,[O.R.DOWNARROW]:M.f.BACK};const F=new L.Z("nav-input");class NavigationInputOutside{constructor(e,t,n){this.navigation=e,this.input=t,this.settings=n,this.bindings=[],this.toggleInput=e=>{F.debug("toggling dollhouse input",e),this.bindings.forEach((t=>e?t.renew():t.cancel()))},this.bindings.push(...this.registerEnterPanoHandler())}registerEnterPanoHandler(){return[this.input.registerMeshHandler(p.R,f.s.isInstanceOf(D.S),((e,t,n)=>!this.settings.tryGetProperty(_.Q5,!1)&&(!!this.navigation.isNavigationInputAllowed()&&(e.button===I.MP.PRIMARY&&void 0!==n&&this.navigation.navigateToPanoNearIntersection(n)))))]}}var V=n(53549),H=n(12622),j=n(37363),G=n(22878),z=n(11620),W=n(56044),K=n(31998),Y=n(25986),q=n(98370),Z=n(994),$=n(26517),Q=n(12712),X=n(31013);class NavigationDollhouse{constructor(e,t,n){this.canStartTransition=e,this.pose=t,this.cameraModule=n,this.navigateToPoint=async e=>{if(!this.canStartTransition())return;const t=this.pose.focalDistance,n=(0,$.fd)(this.pose.rotation,e,t);await this.cameraModule.cancelTransition(),await this.cameraModule.moveTo({pose:{position:n},transitionType:a.n.Interpolate,focalDistance:t,transitionTime:Q.E.TRANSITION_TIME_DH})},this.navigateToBox=e=>{if(!this.canStartTransition())return X.Q.resolve();const{position:t,rotation:n,focalDistance:i}=this.getPoseForBox(e);return this.cameraModule.moveTo({pose:{position:t,rotation:n},transitionType:a.n.Interpolate,focalDistance:i,transitionTime:Q.E.TRANSITION_TIME_DH})},this.getPoseForBox=e=>{const t=e.getCenter(new v.Vector3),n=e.getSize(new v.Vector3),i=n.z>n.x;let s=this.pose.rotation;s=i?s.angleTo(J.LANDSCAPE_LEFT)>s.angleTo(J.LANDSCAPE_RIGHT)?J.LANDSCAPE_LEFT:J.LANDSCAPE_RIGHT:s.angleTo(J.PORTRAIT_RIGHT)>s.angleTo(J.PORTRAIT_LEFT)?J.PORTRAIT_LEFT:J.PORTRAIT_RIGHT;const r=-85*Z.Ue,o=2*Math.atan(1/this.pose.projection.elements[5]),a=(0,$.YN)(t,s,r,e,1.2*o,this.pose.aspect()),l=t.distanceTo(a.position);return{position:a.position,rotation:a.rotation,focalDistance:l}}}}const J={LANDSCAPE_LEFT:(new v.Quaternion).setFromAxisAngle(M.f.UP,45*Z.Ue),LANDSCAPE_RIGHT:(new v.Quaternion).setFromAxisAngle(M.f.UP,-45*Z.Ue),PORTRAIT_LEFT:(new v.Quaternion).setFromAxisAngle(M.f.UP,25*Z.Ue),PORTRAIT_RIGHT:(new v.Quaternion).setFromAxisAngle(M.f.UP,-25*Z.Ue)};var ee=n(78720),te=n(99931),ne=n(63387),ie=n(7692),se=n(20751);const re=!0,oe=8,ae=.1,le=-25,ce=500,de=-2,ue=32,he=32;class NavigationPoint{constructor(e,t,n,i,s){this.cameraData=e,this.sweepData=t,this.viewmodeModule=n,this.picking=i,this.issueCommand=s,this.tryNavigateToPoint=async(e,t,n,i,s,r)=>{const o=[],l=r?r.slice():[];if(o.push(ee._T()),o.push(ee._k()),l.push(this.scoreByLatitude(e,ue)),t===a.n.Interpolate&&(0,G.Bw)(this.viewmodeModule.currentMode)&&this.sweepData.currentSweep){const t=this.sweepData.currentSweep,n=this.sweepData.getSweep(t),i=n.position.clone().sub(e).normalize();o.push(ee.T3(n)),l.push(te.o7(e,i))}o.push(this.withinLatitudeFilter(e)),o.push(this.notTooCloseFilter(e)),re||o.push(this.notTooFarFilter(e)),l.push(te.Dv(e,de));const c=this.sweepData.sortByScore(o,l),u=this.sweepData.currentSweepObject,h=new v.Vector3;let p=null,m=!1,f=null;const g=(0,G.Bw)(this.viewmodeModule.currentMode),y=null!=s?s:15,b=g&&u?new Set(u.neighbours.filter((e=>this.sweepData.getSweep(e).position.distanceTo(u.position)<y)).concat([u.id])):new Set;for(const s of c)if(this.sweepCanSeeNote(e,s.sweep)){if(f=s.sweep,t===a.n.Interpolate||b.has(f.id)){h.copy(e).sub(f.position).normalize(),m=!0;const s=this.getSweepToPointRotation(f.position,e,i),r=this.cameraData.pose.projection.asThreeMatrix4(),{width:o,height:l}=this.cameraData,c=(0,ie.bD)(e,f.position,s,o,l,r);n&&n(c),p=g?this.issueCommand(new d.ju({transition:a.n.Interpolate,sweep:f.id,rotation:s})):this.viewmodeModule.switchToMode(G.Ey.Panorama,t,{rotation:s,sweepID:f.id})}break}return!(!f||!m&&t===a.n.Interpolate)&&(p||(p=this.issueCommand(new d.ju({transition:t,transitionTime:ce,sweep:f.id,rotation:this.getSweepToPointRotation(f.position,e,i)}))),p&&await p,!0)},this.getSweepToPointRotation=(e,t,n)=>{const i=(0,$.n0)(e,t);return n&&i.multiply(n),(0,ne.Z)(i)},this.sweepCanSeeNote=(()=>{const e=new v.Vector3;return(t,n)=>{e.copy(t).sub(n.position);const i=e.length();e.normalize();let s=this.picking.pick(n.position,e,b.Pv);return(!s||s.distance>i)&&(s=this.picking.pick(t,e.negate(),b.Pv)),!s||i<=s.distance}})(),this.notTooCloseFilter=e=>t=>Math.abs(t.position.x-e.x)>ae||Math.abs(t.position.z-e.z)>ae,this.notTooFarFilter=e=>t=>t.position.distanceTo(e)>oe,this.withinLatitudeFilter=e=>t=>{const n=(new v.Vector3).copy(e).sub(t.position),i=-Math.atan(n.y/Math.sqrt(n.x*n.x+n.z*n.z)),s=(0,Z.Id)(le);return se.zf-s<i&&i<se.uQ+s},this.scoreByLatitude=(()=>{const e=new v.Vector3;return(t,n)=>i=>{e.copy(t).sub(i.position);const s=Math.abs(Math.atan(e.y/Math.sqrt(e.x*e.x+e.z*e.z)))/(Math.PI/2),r=Math.floor(20*s)/20;return n*(1-r)}})(),this.scoreByDirection=(()=>{const e=new v.Vector3,t=new v.Vector3;return(n,i,s)=>r=>{if(Math.abs(i.dot(M.f.UP))>.75)return 0;t.copy(i).normalize(),e.copy(n).sub(r.position).normalize();return-1*e.dot(t)*s}})(),this.scoreByFloor=(e,t)=>n=>n.floorId===e?t:0}async focusPin(e,t,n,i,s){const{anchorPosition:r,stemNormal:o,stemLength:a}=e,l=r.clone().add(o.clone().setLength(a)),c=[this.scoreByDirection(l,o,he),this.scoreByFloor(e.floorId,32)];return this.focusPoint(l,t,n,i,s,c)}async focusPoint(e,t,n,i,s,r){if(this.cameraData.canTransition()&&this.sweepData.canTransition()&&!await this.tryNavigateToPoint(e,t,n,i,s,r)){if(t!==a.n.Interpolate)return this.goToNearestSweep(e,t,n,i);try{await this.issueCommand(new H._i(H.BD.DOLLHOUSE,a.n.Interpolate))}catch(s){await this.goToNearestSweep(e,t,n,i)}await this.tryNavigateToPoint(e,t,n,i,s)||await this.goToNearestSweep(e,t,n,i)}}async goToNearestSweep(e,t,n,i){const s=e,r=this.sweepData.getClosestSweep(s,!0);if(!r)throw new Error("Cannot find sweep closest to Mattertag disc");const o=this.getSweepToPointRotation(r.position,s,i),l=this.cameraData.pose.projection.asThreeMatrix4(),{width:c,height:u}=this.cameraData,h=(0,ie.bD)(s,r.position,o,c,u,l);n&&n(h),await this.issueCommand(new d.ju({sweep:r.id,rotation:o,transition:t||a.n.Interpolate}))}}var pe=n(37008),me=n(98254);class DynamicNumber extends me.T{constructor(e=1,t=0){super(),this._slowdown=!0,this._initialSpeed=0,this._speed=0,this._acceleration=1,this._desiredAcceleration=1,this._jerk=1,this._maxSpeed=1,this._minSpeed=.05,this._startValue=0,this._value=0,this._endValue=e,this._delay=t}get active(){return this._active}get currentValue(){return this._value}get endValue(){return this._endValue}get speed(){return this._speed}get isSlowingDown(){return this._isSlowingDown}get maxSpeed(){return this._maxSpeed}get acceleration(){return this._acceleration}getProgressPercent(){return(this._value-this._startValue)/(this._endValue-this._startValue)}onComplete(e){return this._onComplete=e,this}setStartValue(e){return this._startValue=e,this}setCurrentValue(e){return this._value=e,this}setEndValue(e){return this._endValue=e,this}setInitialSpeed(e){return this._initialSpeed=e,this}setMaxSpeed(e){return this._maxSpeed=e,this}setDesiredAcceleration(e){return this._desiredAcceleration=e,this._jerk=3*Math.abs(this._desiredAcceleration-this._acceleration),this}activate(e){return this._active=e,this}setAccel(e){return this._acceleration=Math.abs(e),this}start(){this._active=!0,this._value=this._startValue,this._speed=this._initialSpeed}setSlowdown(e){return this._slowdown=e,this}tick(e){if(!this._active||e<=0)return;if(this._delay>0)return void(this._delay-=e);e>33&&(e=33);const t=.001*e,n=this._value,i=this._speed*t,s=(0,ne.r_)(n,this.endValue,i),r=this._endValue-n<=this.getSlowdownDistance(),o=this._slowdown&&r,a=o?this._minSpeed:this._maxSpeed,l=this.acceleration*t;this._speed=(0,ne.r_)(this._speed,a,l),this._isSlowingDown=o;const c=this._desiredAcceleration,d=this._jerk*t;return this._acceleration=(0,ne.r_)(this._acceleration,c,d),this._value=s,s===this.endValue?(this.activate(!1),this.commit(),void(this._onComplete&&this._onComplete())):void 0}getSlowdownDistance(){const e=this.speed,t=this._acceleration,n=e/(0===t?1e-5:t);return this.speed*n+.5*t*n*n}stop(e){this._active=!1,this._endValue=e,this.commit()}}var fe=n(49702);const ge=new L.Z("walk");class NavigationWalking{constructor(e,t,n,i,s,r,o){this.cameraPose=e,this.sweepTransition=t,this.sweepControl=n,this.cameraControl=i,this.generators=s,this.navigation=r,this.active=!1,this.path=[],this.lastQueueTime=0,this.repeatedQueueDelayMS=150,this.positionTracker=(new DynamicNumber).setAccel(15).setMaxSpeed(5),this.baseTransitionTime=l.Z.camera.baseTransitionTime,this.baseTransitionSpeed=l.Z.camera.transitionSpeed,o.onPropertyChanged(fe.baseTransitionSpeedKey,(e=>{this.baseTransitionTime=e}))}get isActive(){return this.active}get targetSweep(){return this.nextSweep}setContinuousMovementDirection(e){this.continuousMovementDirection=e,!this.active&&e&&this.navigation.navigateInLocalDirection(e)}stop(){this.path.length=0,this.cameraControl.endExternalTransition(),this.startingSweep=void 0,this.nextSweep=void 0,this.active=!1,this.generator&&(this.generators.stopGenerator(this.generator),this.generator=null)}appendNode(e,t){if(!this.canQueueSweeps(e))return Promise.resolve();if(!e)return Promise.resolve();if(this.path.push(e),this.lastQueueTime=Date.now(),!this.active){this.startingSweep=t;const{generator:n,deferred:i}=this.createTransition();this.generators.startGenerator(n),this.generator=n,this.activePromise=i.nativePromise().then((()=>{this.activePromise=null})),this.positionTracker.setEndValue(this.getDistanceToSweep(e)),this.checkForSpeedIncrease(e)}return this.activePromise?this.activePromise:Promise.resolve()}canQueueSweeps(e){if(e&&this.path.indexOf(e)>=0)return!1;return!(this.path.length>=2)&&!(this.active&&Date.now()-this.lastQueueTime<this.repeatedQueueDelayMS)}attemptContinuousNavigation(){try{this.continuousMovementDirection&&this.navigation.navigateInLocalDirection(this.continuousMovementDirection)}catch(e){if(!(e instanceof NavigationException))throw ge.warn(e),e;ge.debug(e)}}createTransition(){const e=this,t=new X.Q;return{generator:function*(){e.active=!0;let n=Date.now();e.cameraControl.beginExternalTransition();const i=(new v.Vector3).copy(e.cameraPose.position),s=new v.Vector3,r=new v.Vector3,o=e.positionTracker;for(o.setMaxSpeed(5).setAccel(15);e.path.length>0;){const t=e.nextSweep?e.nextSweep.id:e.startingSweep,a=e.path.shift();if(!a){e.nextSweep=void 0;break}e.nextSweep=a,i.copy(e.cameraPose.position);const l=i.distanceTo(a.position);for(o.setStartValue(0).setEndValue(l).setInitialSpeed(o.speed).activate(!0),r.subVectors(a.position,i),r.normalize(),yield new pe.M8(e.sweepControl.activateSweepUnsafe({sweepId:a.id}).then((()=>{e.sweepControl.beginSweepTransition({sweepId:a.id,internalProgress:!1,prevSweepId:t})}))),o.start(),e.checkForSpeedIncrease(a);o.active;){const t=Date.now()-n,l=0===e.path.length;let c=!1,d=!1;if(!l){const t=e.path[0];c=o.endValue-o.currentValue+a.position.distanceTo(t.position)<o.getSlowdownDistance();const n=s.subVectors(t.position,a.position);n.normalize();r.dot(n)<.3&&(d=!0)}o.setSlowdown(l||c||d),o.tick(t);const u=o.getProgressPercent();e.cameraControl.updateCameraPosition(s.lerpVectors(i,a.position,u)),e.sweepTransition.progress.modifyAnimation(u,1,0),n=Date.now(),e.continuousMovementDirection&&e.canQueueSweeps()&&o.isSlowingDown&&e.attemptContinuousNavigation(),o.active&&(yield new pe.Jj)}e.sweepControl.endSweepTransition({sweepId:a.id,prevSweepId:t})}t.resolve(),e.stop()},deferred:t}}getDistanceToSweep(e){return(this.nextSweep?this.nextSweep.position:this.cameraPose.position).distanceTo(e.position)}checkForSpeedIncrease(e){const t=this.positionTracker,n=this.getDistanceToSweep(e),i=t.endValue-t.currentValue,s=i+n-t.getSlowdownDistance();if(i+n>12){const e=this.baseTransitionTime,n=this.baseTransitionSpeed,i=.001*(e+Math.log2(1+s)*fe.TRANSITION_DISTANCE_MULTIPLIER*n)-t.maxSpeed/t.acceleration,r=s/i;i>0&&t.setMaxSpeed(r).setDesiredAcceleration(3*r)}else t.setMaxSpeed(5).setDesiredAcceleration(15)}}var ve=n(65270),ye=n(8428);class NavigationLabel{constructor(e,t,n,i,s,r,o){this.engine=e,this.settingsData=t,this.cameraData=n,this.cameraModule=i,this.viewmodeData=s,this.floorsViewData=r,this.toolsData=o}async enforceLabelEditorFriendlyViewmode(e){var t;let n=this.settingsData.tryGetProperty(_.Q5,!1)&&this.viewmodeData.isDollhouse();this.toolsData.activeToolName!==x.w1.LABELS&&(n&=this.settingsData.tryGetProperty(ye.gx.LabelsDollhouse,!0));let i=!0;if(await(null===(t=this.cameraData.transition.promise)||void 0===t?void 0:t.nativePromise()),!this.viewmodeData.isFloorplan()&&!n)try{await this.engine.commandBinder.issueCommand(new H._i(H.BD.FLOORPLAN,a.n.Interpolate))}catch(e){i=!1}return(e&&e!==this.floorsViewData.currentFloorId||null===this.floorsViewData.currentFloorId)&&await this.engine.commandBinder.issueCommand(new y.Vw(e||this.floorsViewData.getHighestVisibleFloorId())),i}async navigateToLabel(e){const t=await this.enforceLabelEditorFriendlyViewmode(e.floorId);return this.viewmodeData.isFloorplan()?await this.panToLabelFloorplan(e.position):this.viewmodeData.isDollhouse()&&await this.panToLabelDollhouse(e.position),t}async panToLabelDollhouse(e){this.cameraData.canTransition()||await this.cameraModule.cancelTransition();const t=new v.Box3;t.setFromCenterAndSize(new v.Vector3(0,1,0).add(e),new v.Vector3(4,4,4)),await this.engine.commandBinder.issueCommand(new d.Np({box:t}))}async panToLabelFloorplan(e){this.cameraData.canTransition()||await this.cameraModule.cancelTransition();const t=new v.Plane,n=new v.Vector3(0,0,1).applyQuaternion(this.cameraData.pose.rotation),i=e;t.setFromNormalAndCoplanarPoint(n,i);const s=(0,$.Fe)(this.cameraData.pose.position,this.cameraData.pose.rotation,t);if(!s)return;const r=(new v.Vector3).copy(i).sub(s),o=(new v.Vector3).copy(this.cameraData.pose.position).add(r);await this.cameraModule.moveTo({transitionType:a.n.Interpolate,pose:{position:o},transitionTime:1e3,easing:ve.hl})}}var be=n(69524),Se=n(14547);class Navigation extends i.Y{constructor(){super(...arguments),this.name="navigation",this.navigationEnabled=!0,this.inputOutside=[],this.navigationRules=[()=>!0],this.addNavigationRule=e=>{-1===this.navigationRules.indexOf(e)&&this.navigationRules.push(e)},this.removeNavigationRule=e=>{const t=this.navigationRules.indexOf(e);-1!==t&&this.navigationRules.splice(t,1)},this.isNavigationInputAllowed=()=>{const e=this.navigationRules.reduce(((e,t)=>e&&t()),!0);return!(!this.navigationEnabled||!e)||(this.log.debug("Cannot move while navigation is locked",{blockedByRules:!e,blockedByCommand:!this.navigationEnabled}),!1)}}async init(e,t){const{market:n}=t;this.commandBinder=t.commandBinder,this.bindings.push(this.commandBinder.addBinding(d.ZK,(async()=>this.lockNavigation())),this.commandBinder.addBinding(d.Lp,(async()=>this.unlockNavigation())),this.commandBinder.addBinding(d.Np,(async e=>this.navigateToBox(e.box))),this.commandBinder.addBinding(d.zs,(async e=>{const{focusPosition:t,transition:n,orientationAdjust:i,onSweepChosen:s,neighborDistanceThreshold:r}=e;return this.navigationPoint.focusPoint(t,n,s,i,r)})),this.commandBinder.addBinding(d.OR,(async e=>{const{pinPosition:t,transition:n,orientationAdjust:i,onSweepChosen:s,neighborDistanceThreshold:r}=e;return this.navigationPoint.focusPin(t,n,s,i,r)})),this.commandBinder.addBinding(d.ju,(e=>this.navigateToSweep(e.sweep,e.rotation,e.transition,e.transitionTime,e.transitionSpeedMultiplier))),this.commandBinder.addBinding(d.Cs,(async({position:e,floorId:t,viewmodeOnly:n})=>n?this.navigationLabel.enforceLabelEditorFriendlyViewmode():!(!e||!t)&&this.navigationLabel.navigateToLabel({position:e,floorId:t}))),this.commandBinder.addBinding(d.L4,(async e=>this.navigateToPose(e.pose)))),[this.settingsData,this.sweepData,this.sweepModule,this.viewmodeData,this.viewmodeModule,this.cameraData,this.cameraModule,this.interactionmodeData,this.meshQuery]=await Promise.all([n.waitForData(s.e),n.waitForData(V.Z),t.getModule(K.default),n.waitForData(j.O),t.getModule(q.default),n.waitForData(o.M_),t.getModuleBySymbol(r.y.CAMERA),n.waitForData(c.Z),t.getModuleBySymbol(r.y.MESH_QUERY)]);const[i,a,l]=await Promise.all([t.getModuleBySymbol(r.y.RAYCASTER),n.waitForData(Y.t),n.waitForData(W.c)]);this.navigationPoint=new NavigationPoint(this.cameraData,this.sweepData,this.viewmodeModule,null==i?void 0:i.picking,t.commandBinder.issueCommand),this.navigationLabel=new NavigationLabel(t,this.settingsData,this.cameraData,this.cameraModule,this.viewmodeData,l,a);const u=await t.getModuleBySymbol(r.y.INPUT);this.inputOutside.push(new NavigationInputOutside(this,u,this.settingsData));const h=()=>this.isNavigationInputAllowed()&&this.viewmodeData.canStartTransition()&&!l.transitionActive&&this.sweepData.canTransition(),p=()=>h()&&(this.viewmodeData.isDollhouse()||this.viewmodeData.isFloorplan()||this.viewmodeData.isOrthographic());this.navigationDollhouse=new NavigationDollhouse(p,this.cameraData.pose,this.cameraModule),this.inputOutside.push(new NavigationInputFocus(p,t.commandBinder,u,l,this,this.navigationDollhouse,this.sweepData,this.cameraModule,a,this.settingsData,this.meshQuery)),this.inputInside=new NavigationInputInside(this,u,!!e.enableWheel),this.inputOutside.forEach((e=>this.bindings.push(...e.bindings))),this.bindings.push(...this.inputInside.bindings),this.updateInputBindings(),this.bindings.push(this.viewmodeData.makeModeChangeSubscription((()=>{this.viewmodeData.currentMode!==G.Ey.Transition&&this.updateInputBindings()}))),this.navigationWalk=new NavigationWalking(this.cameraData.pose,this.sweepData.transition,this.sweepModule,this.cameraModule,t,this,this.settingsData),t.broadcast(new be.em(Se.Y.Navigation))}updateInputBindings(){const e=this.interactionmodeData.isVR(),t=this.viewmodeData.isInside();this.inputInside.toggleInput(t&&!e),this.inputInside.toggleVrInput(t&&e),this.inputOutside.forEach((e=>e.toggleInput(!t)))}navigateInLocalDirection(e){const t=this.cameraData.pose.rotation;return this.navigateInDirection(e.clone().applyQuaternion(t))}setContinuousNavigationLocalDirection(e){this.navigationWalk.setContinuousMovementDirection(e)}navigateTowardsIntersection(e){try{this.navigateInDirection(e.point.clone().sub(this.cameraData.pose.position))}catch(e){return!1}return!0}navigateToPanoNearIntersection(e){const t=(0,S.bG)(this.sweepData,this.viewmodeData.isInside(),e,this.meshQuery),n=t.length>0?t[0].sweep:this.sweepData.getClosestSweep(e.point,!0),i=l.y[this.interactionmodeData.mode];if(this.viewmodeData.isInside()&&n)return this.navigateToSweep(n.id,void 0,i),!0;if(this.viewmodeData.canSwitchViewMode(G.Ey.Panorama)){const e=n?n.id:void 0;return this.commandBinder.issueCommand(new H._i(H.BD.INSIDE,i,{sweepID:e})),!0}return!1}navigateInDirection(e){if(!this.viewmodeData.isInside())throw new NavigationException(h.InsideOnly);if(!this.sweepData.currentSweep)throw new NavigationException(h.InvalidSweep);const t=l.y[this.interactionmodeData.mode],n=(0,S.Tq)(this.sweepData,e,this.navigationWalk.isActive?.65:void 0,this.navigationWalk.isActive?this.navigationWalk.targetSweep:void 0);if(n.length>0&&n[0].sweep)return this.navigateToSweep(n[0].sweep.id,void 0,t);throw new NavigationException(h.NoDestinationFound)}async navigateToBox(e){return this.navigationDollhouse.navigateToBox(e)}lockNavigation(){this.navigationEnabled=!1,this.log.debug("Navigation input locked")}unlockNavigation(){this.navigationEnabled=!0,this.log.debug("Navigation input unlocked")}async navigateToSweep(e,t,n,i,s){const r=this.settingsData.tryGetProperty(z.gj,a.n.Interpolate);let o;void 0===n&&(n=r);const l=this.sweepData.currentSweep;if(n===a.n.Interpolate){const t=!l||this.sweepData.isSweepAligned(l),i=this.sweepData.isSweepAligned(e),s=l!==e,r=!t||!i,o=this.viewmodeData.isInside();s&&r&&o&&(n=a.n.FadeToBlack)}if(this.viewmodeData.isInside()){const r=void 0===t&&void 0===i&&void 0===s,l=this.cameraData.canTransition()&&this.sweepData.canTransition();if(n===a.n.Interpolate&&this.sweepData.currentSweep!==e&&r&&(l||this.navigationWalk.isActive)){const t=this.sweepData.getSweep(e);o=this.navigationWalk.appendNode(t,this.sweepData.currentSweep)}else{if(!l)return this.sweepData.currentSweep;o=this.sweepModule.moveToSweep({transitionType:n,sweepId:e,rotation:t,transitionTime:i,transitionSpeedMultiplier:s})}}else o=this.viewmodeModule.switchToMode(G.Ey.Panorama,n,{sweepID:e,rotation:t});return await o,this.sweepData.currentSweep}navigateToPose(e){const t={2:H.BD.DOLLHOUSE,3:H.BD.FLOORPLAN},{sweepIndex:n,quaternion:i,mode:s}=e;let{panoId:r,position:o}=e;if(!r&&void 0!==n){const e=this.sweepData.getSweepByIndex(n);e&&(r=e.id)}if(r)this.commandBinder.issueCommand(new d.ju({sweep:r,rotation:i,transition:a.n.FadeToBlack}));else{if(!(s in t))throw new Error("Unknown navigation link pose: "+JSON.stringify(e));this.commandBinder.issueCommand(new H._i(t[s],a.n.Interpolate,{rotation:i,position:o}))}}}},12712:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i={longerTransitionMaxDist:10,TRANSITION_TIME_DH:650}},9682:(e,t,n)=>{"use strict";n.d(t,{Tq:()=>o,bG:()=>l});var i=n(78720),s=n(99931),r=n(12712);const o=(e,t,n,i,...s)=>a({sweepData:e,direction:t,directionFactor:n,sourceSweep:i,ignoreSweeps:s}),a=e=>{const{sweepData:t,direction:n,sourceSweep:r,ignoreSweeps:o,directionFactor:a}=e;if(!t.currentSweepObject)return[];const l=r||t.currentSweepObject,c=[i.ff(l),i._k(),i.vO(l),i.pI(l.position,n,a)];for(const e of o)c.push(i.ff(e));const d=[s.o7(l.position,n),s.TE(l.position)],u=t.getSweepNeighbours(l);return t.sortByScore(c,d,u)},l=(e,t,n,o)=>{const a=[i._k(),i._T()],l=[s.Dv(n.point)],c=e.currentSweepObject;t&&c&&a.push(i.ff(c),i.SF(c.position,r.E.longerTransitionMaxDist),i.vO(c)),n.face&&a.push(i.D5(n.point,n.face.normal));const d=o.floorIdFromObject(n.object);d&&l.push(s.Bv(d));const u=e.sortByScore(a,l);if(0===u.length){const t=e.getClosestSweep(n.point,!0);u.push({sweep:t,score:0})}return u}},69670:(e,t,n)=>{"use strict";n.d(t,{c:()=>HashtagData});var i=n(35424),s=n(29984);class HashtagData extends i.V{constructor(){super(...arguments),this.name="hashtag-data",this.hashtags=(0,s.C)([])}addHashtags(e){this.atomic((()=>{e.forEach((e=>{this.addHashtag(e)}))}))}addHashtag(e){const t=e.trim().toLowerCase();-1===this.hashtags.map((e=>e.trim().toLowerCase())).indexOf(t)&&this.hashtags.push(e)}getHashtags(){return this.hashtags.values()}}},57756:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i}),function(e){e.CLOSED="closed",e.IDLE="idle",e.CREATING="creating",e.OPENING="opening",e.OPEN="open",e.EDITING="editing"}(i||(i={}))},38562:(e,t,n)=>{"use strict";n.d(t,{X:()=>NotesViewData});var i=n(35424),s=n(67779),r=n(29984),o=n(36589),a=n(91754),l=n(57756),c=n(77534);class NotesViewData extends i.V{constructor(e,t,n,i,o){super(),this.data=e,this.textParser=t,this.linkHandler=n,this.backgroundTexture=i,this.maskTexture=o,this.name="notes-view-data",this.notes=(0,r.C)([]),this.noteListViewsObservable=(0,r.C)([]),this.creatingNewNote=!1,this.openNoteViewObservable=(0,s.Y)(null),this.focusedCommentObservable=(0,s.Y)(null),this.listIndexObservable=(0,s.Y)(-1),this.activeNotationObservable=(0,s.Y)(null),this.suspendVisibilityUpdates=!1,this.notesPhaseObservable=(0,s.Y)(l.U.CLOSED),this.notesFilterObservable=(0,s.Y)(c.$.OPEN),this.searchBlockObservable=(0,s.Y)(null),this.updateViewData(null)}getNotesList(){return this.notes}onNotesChanged(e){return this.notes.onChanged(e)}getNoteView(e){const t=this.notes.findIndex((t=>t.id===e));return-1!==t?this.notes.get(t):null}getTextParser(){return this.textParser}getLinkHandler(){return this.linkHandler}getComment(e,t){const n=this.getNote(e);return(null==n?void 0:n.comments.find((e=>e.id===t)))||null}getAttachment(e,t,n){var i;const s=(null===(i=this.getNote(e))||void 0===i?void 0:i.comments.find((e=>e.id===t)))||null;return(null==s?void 0:s.attachments.find((e=>e.id===n)))||null}updateViewData(e){const t=[];this.data.iterate((e=>{var n;const i=this.createNoteView(e);t.push(i),(null===(n=this.openNoteView)||void 0===n?void 0:n.id)===i.id&&this.setOpenNoteView(i)})),this.notes.replace(t);const n=this.getFilteredNotes(),i=e?this.getSearchResults(n,e):this.getNoteListViews(n);this.noteListViewsObservable.replace(i.sort(((e,t)=>t.createdTime-e.createdTime)))}createNoteView(e){return Object.assign(Object.assign({},e),{backgroundTexture:this.backgroundTexture,maskTexture:this.maskTexture})}get noteListViews(){return this.noteListViewsObservable}getFilteredNotes(){const e=this.notesFilter===c.$.ALL,t=this.notesFilter===c.$.RESOLVED,n=[];return this.notes.forEach((i=>{(e||i.resolved===t)&&n.push(i)})),n}getNoteListViews(e){return e.map((e=>{const t=e.comments.get(0);if(!t)throw new Error("No root comment in a note");return{id:e.id,text:t.text,user:e.user,color:e.color,createdTime:e.lastCommentMs,assetType:a.h.NOTE,numAttachments:t.attachments.length,numComments:e.comments.length,commentId:t.id}}))}getSearchResults(e,t){const n=[];return e.forEach((e=>{e.comments.forEach((i=>{const{text:s,user:r}=i;let l=this.getSearchSnippet(s,t);null===l&&t.blockType===o.C.USER&&t.id===r.id&&(l=this.textParser.getPlainText(s)),null!==l&&n.push({id:i.id,text:l,user:i.user,color:e.color,createdTime:i.created.getTime(),assetType:a.h.COMMENT,numAttachments:i.attachments.length,numComments:0,noteId:e.id})}))})),n}getCommentUserMentions(e,t){const n=[];return this.textParser.getUserMentions(e).forEach((e=>{const i=t[e];i&&n.push(i)})),n}getSearchSnippet(e,t){const n=this.textParser.searchMarkdown(e,t);if(!n)return null;const{textLength:i,numMatches:s,matchIndex:r,markdown:o}=n;let a=o,l=r;if(i>20&&l>0){if(1===s){const e=Math.floor((20-t.text.length)/2);e>0&&l>e&&(l-=e)}a=`...${a.substr(l)}`,a.length<20&&(l-=20-a.length,l>0&&(a=`...${o.substr(l)}`))}return a}getNote(e){const t=this.notes.findIndex((t=>t.id===e));return this.notes.get(t)}getNoteAttachments(e){const t=[],n=this.getNote(e);return n&&n.comments.forEach((e=>{t.push(...e.attachments)})),t}get isNewNote(){return this.creatingNewNote}setCreatingNote(e){this.creatingNewNote=e}getPendingNote(){return this.creatingNewNote&&this.openNoteView?this.openNoteView:null}setNotesPhase(e){this.notesPhaseObservable.value=e}get notesPhase(){return this.notesPhaseObservable.value}onNotesPhaseChanged(e){return this.notesPhaseObservable.onChanged(e)}setNotesFilter(e){this.notesFilterObservable.value=e}get notesFilter(){return this.notesFilterObservable.value}onNotesFilterChanged(e){return this.notesFilterObservable.onChanged(e)}setActiveNotation(e){this.activeNotationObservable.value=e}get activeNotation(){return this.activeNotationObservable.value}onActiveNotationChanged(e){return this.activeNotationObservable.onChanged(e)}setListIndex(e){this.listIndexObservable.value=e}get listIndex(){return this.listIndexObservable.value}onListIndexChanged(e){return this.listIndexObservable.onChanged(e)}setOpenNoteView(e){this.openNoteViewObservable.value=e}get openNoteView(){return this.openNoteViewObservable.value}onOpenNoteViewChanged(e){return this.openNoteViewObservable.onChanged(e)}resetOpenNoteView(){const e=this.openNoteView;if(e){const t=this.data.getNoteProperties(e.id);t&&this.updateOpenNoteView(t)}}updateOpenNoteView(e){const t=this.openNoteView;t&&Object.assign(t,e)}setFocusedComment(e){this.focusedCommentObservable.value=e}get focusedComment(){return this.focusedCommentObservable.value}onFocusedCommentChanged(e){return this.focusedCommentObservable.onChanged(e)}setSearchBlock(e){this.searchBlockObservable.value=e}get searchBlock(){return this.searchBlockObservable.value}onSearchBlockChanged(e){return this.searchBlockObservable.onChanged(e)}}},8765:(e,t,n)=>{"use strict";n.d(t,{yK:()=>NotesModeToggleCommand,yW:()=>OpenNoteToCommentCommand,VI:()=>StartNewNoteCommand,FB:()=>SaveNewNoteCommand,gc:()=>CancelNewNoteCommand,_N:()=>CloseNoteCommand,kd:()=>SaveNoteChangesCommand,oH:()=>CancelCommentChangesCommand,df:()=>ToggleNoteToolEditorCommand,oE:()=>SaveNoteAppearanceCommand,yp:()=>ResolveNoteCommand,sG:()=>DeleteNoteCommand,Zd:()=>OpenNoteListViewCommand,x4:()=>EditCommentCommand,Df:()=>AddCommentCommand,Uw:()=>UpdateCommentCommand,mH:()=>DeleteCommentCommand,av:()=>CancelCommentSearchCommand,Kr:()=>SuspendNoteVisibilityUpdates,qZ:()=>ResumeNoteVisibilityUpdates});var i=n(93037),s=n(14832);class NotesModeToggleCommand extends i.m{constructor(e){super(),this.payload={opened:e}}}class OpenNoteToCommentCommand extends i.m{constructor(e,t,n,i=s.n.FadeToBlack){super(),this.payload={noteId:e,docked:t,commentId:n,transitionType:i}}}class StartNewNoteCommand extends i.m{constructor(){super()}}class SaveNewNoteCommand extends i.m{constructor(e){super(),this.payload={text:e}}}class CancelNewNoteCommand extends i.m{constructor(){super()}}class CloseNoteCommand extends i.m{constructor(){super()}}class SaveNoteChangesCommand extends i.m{constructor(e,t){super(),this.payload={noteId:e,text:t}}}class CancelCommentChangesCommand extends i.m{}class ToggleNoteToolEditorCommand extends i.m{constructor(e){super(),this.payload={opened:e}}}class SaveNoteAppearanceCommand extends i.m{constructor(e,t){super(),this.payload={noteId:e,properties:t}}}class ResolveNoteCommand extends i.m{constructor(e,t){super(),this.payload={noteId:e,resolved:t}}}class DeleteNoteCommand extends i.m{constructor(e){super(),this.payload={noteId:e}}}class OpenNoteListViewCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,isComment:t,editText:n}}}class EditCommentCommand extends i.m{constructor(e){super(),this.payload={id:e}}}class AddCommentCommand extends i.m{constructor(e,t,n){super(),this.payload={noteId:e,text:t,replyId:n}}}class UpdateCommentCommand extends i.m{constructor(e,t,n){super(),this.payload={noteId:e,commentId:t,text:n}}}class DeleteCommentCommand extends i.m{constructor(e,t){super(),this.payload={noteId:e,commentId:t}}}class CancelCommentSearchCommand extends i.m{constructor(){super()}}class SuspendNoteVisibilityUpdates extends i.m{}class ResumeNoteVisibilityUpdates extends i.m{}},77534:(e,t,n)=>{"use strict";var i,s;n.d(t,{$:()=>i,Y:()=>s}),function(e){e.OPEN="open",e.RESOLVED="resolved",e.ALL="all"}(i||(i={})),function(e){e.DEFAULT="default",e.HIGHLIGHTED="highlighted",e.DIMMED="dimmed"}(s||(s={}))},95361:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var i=n(20302),s=n(38562);const r=(0,i.u)(s.X)},89673:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddCommentCommand:()=>ie.Df,CancelCommentChangesCommand:()=>ie.oH,CancelCommentSearchCommand:()=>ie.av,CancelNewNoteCommand:()=>ie.gc,CloseNoteCommand:()=>ie._N,Comment:()=>Comment,DeleteCommentCommand:()=>ie.mH,DeleteNoteCommand:()=>ie.sG,EditCommentCommand:()=>ie.x4,FocusCommentMessage:()=>se.JL,HashtagData:()=>ne.c,Note:()=>Note,NoteColorVariant:()=>K.Y,NoteResolutionChangeMessage:()=>se.hY,NotesData:()=>NotesData,NotesFilter:()=>K.$,NotesModeOpenedMessage:()=>se.Ey,NotesModeToggleCommand:()=>ie.yK,NotesPhase:()=>W.U,NotesViewData:()=>te.X,OpenNoteListViewCommand:()=>ie.Zd,OpenNoteToCommentCommand:()=>ie.yW,ResolveNoteCommand:()=>ie.yp,ResumeNoteVisibilityUpdates:()=>ie.qZ,SaveNewNoteCommand:()=>ie.FB,SaveNoteAppearanceCommand:()=>ie.oE,SaveNoteChangesCommand:()=>ie.kd,StartNewNoteCommand:()=>ie.VI,SuspendNoteVisibilityUpdates:()=>ie.Kr,ToggleNoteToolEditorCommand:()=>ie.df,UpdateCommentCommand:()=>ie.Uw,default:()=>Me});var i=n(57227),s=n(14877),r=n(91183),o=n(89034),a=n(28636),l=n(27314),c=n(81402),d=n(14832),u=n(64921),h=n(36589),p=n(23676),m=n(68168),f=n(34612),g=n(25986),v=n(71843),y=n(22026),b=n(91754),S=n(59114),E=n(10969),T=n(76223),w=n(9986),x=n(41907),_=n(53549),M=n(37363),O=n(61903),A=n(59057),C=n(39823),N=n(56044),D=n(12757),I=n(36742),L=n(48730),P=n(99380),R=n(65143),k=n(40825),U=n(57183),B=n(18236),F=n(47357),V=n(49315),H=n(50566),j=n(13912),G=n(87443),z=n(85553),W=n(57756),K=n(77534),Y=n(2212),q=n(98254),Z=n(29984),$=n(48342),Q=n(73156);class Note extends q.T{constructor(e){super(),this.id="",this.color=Q.Rn,this.anchorPosition=new Y.Vector3,this.stemNormal=new Y.Vector3,this.stemLength=Q.ZP.stem.length,this.stemEnabled=!0,this.created=new Date,this.modified=new Date,this.lastCommentMs=(new Date).getTime(),this.resolved=!1,this.user=(0,$.Q)(""),this.comments=(0,Z.C)([]),e&&Object.assign(this,e)}copy(e){return this.id=e.id,this.user=e.user,this.resolved=e.resolved,this.color=e.color,this.floorId=e.floorId,this.roomId=e.roomId,this.anchorPosition.copy(e.anchorPosition),this.stemNormal.copy(e.stemNormal),this.stemLength=e.stemLength,this.stemEnabled=e.stemEnabled,this.created.setTime(e.created.getTime()),this.modified.setTime(e.modified.getTime()),this.lastCommentMs=e.lastCommentMs,this.comments.replace(e.comments.values()),this.commit(),this}getComment(e){return this.comments.find((t=>t.id===e))||null}updateComment(e){const t=this.comments.findIndex((t=>t.id===e.id));-1!==t&&(e.assetId=this.id,this.comments.update(t,e))}}var X=n(35424),J=n(66910);class NotesData extends X.V{constructor(e){super(),this.name="notes-data",this.notes=(0,J.q)(e)}iterate(e){for(const t of this.notes)e(t)}updateNote(e){this.notes.has(e.id)?this.notes.get(e.id).copy(e):this.notes.set(e.id,e)}updateNoteProperties(e,t){if(this.notes.has(e)){const n=this.notes.get(e);let i=!1;void 0!==t.resolved&&t.resolved!==n.resolved&&(n.resolved=t.resolved,i=!0),void 0!==t.color&&t.color!==n.color&&(n.color=t.color,i=!0),void 0!==t.anchorPosition&&t.anchorPosition!==n.anchorPosition&&(n.anchorPosition=t.anchorPosition,i=!0),void 0!==t.stemNormal&&t.stemNormal!==n.stemNormal&&(n.stemNormal=t.stemNormal,i=!0),void 0!==t.stemLength&&t.stemLength!==n.stemLength&&(n.stemLength=t.stemLength,i=!0),void 0!==t.stemEnabled&&t.stemEnabled!==n.stemEnabled&&(n.stemEnabled=t.stemEnabled,i=!0),void 0!==t.floorId&&t.floorId!==n.floorId&&(n.floorId=t.floorId,i=!0),void 0!==t.roomId&&t.roomId!==n.roomId&&(n.roomId=t.roomId,i=!0),i&&n.commit()}}removeNote(e){this.notes.has(e)&&(this.notes.delete(e),this.commit())}getNote(e){return this.notes.get(e)}getNoteProperties(e){const t=this.notes.get(e);if(!t)return null;return Object.assign({},t)}get collection(){return this.notes}}var ee,te=n(38562),ne=n(69670),ie=n(8765),se=n(51073),re=n(66225),oe=n(38636),ae=n(5477),le=n(15878),ce=n(96294);!function(e){e.RESOLVED="resolved",e.OPEN="open"}(ee||(ee={}));var de=n(4951),ue=n(63387);const he=new ae.Z("mds-note-serialize");class MdsNoteCreateSerializer{constructor(){this.getNoteDetails=(e,t)=>{const n={enabled:!0,floorId:"",roomId:void 0};void 0!==e.floorId&&""!==e.floorId&&(n.floorId=e.floorId),void 0!==e.roomId&&""!==e.roomId&&(n.roomId=e.roomId),void 0!==e.color&&""!==e.color&&(n.color=e.color),void 0!==e.stemEnabled&&(n.stemEnabled=e.stemEnabled),void 0!==e.stemLength&&(n.stemLength=e.stemLength),void 0!==e.anchorPosition&&(0,de.u)(e.anchorPosition)&&(n.anchorPosition=ue.ep.toVisionVector(e.anchorPosition)),void 0!==e.stemNormal&&(0,de.u)(e.stemNormal)&&(n.stemNormal=ue.ep.toVisionVector(e.stemNormal)),void 0!==e.resolved&&(n.resolution=e.resolved?ee.RESOLVED:ee.OPEN);const i={text:t};return n.comment=i,Object.keys(n).length>0?n:null},this.validate=e=>{if(!e)return!1;const t=["floorId","roomId","enabled"].filter((t=>!(t in e))),n=0===t.length,i=!!e.floorId&&"string"==typeof e.floorId,s=!!e.anchorPosition&&(0,de.u)(e.anchorPosition),r=n&&i&&s;return r||he.debug("Note invalid:",{missingFields:t,validPosition:s}),r}}serialize(e,t){const n=this.getNoteDetails(e,t);return this.validate(n)?n:null}}class MdsNotePatchSerializer{constructor(){this.getNotePatch=e=>{if(!e)return null;const t={};return void 0!==e.floorId&&""!==e.floorId&&(t.floorId=e.floorId),void 0!==e.roomId&&""!==e.roomId&&(t.roomId=e.roomId),void 0!==e.color&&""!==e.color&&(t.color=e.color),void 0!==e.stemEnabled&&(t.stemEnabled=e.stemEnabled),void 0!==e.stemLength&&(t.stemLength=e.stemLength),void 0!==e.anchorPosition&&(0,de.u)(e.anchorPosition)&&(t.anchorPosition=ue.ep.toVisionVector(e.anchorPosition)),void 0!==e.stemNormal&&(0,de.u)(e.stemNormal)&&(t.stemNormal=ue.ep.toVisionVector(e.stemNormal.normalize())),Object.keys(t).length>0?t:null},this.validate=e=>{if(!e)return!1;const t=["floorId","roomId","color","anchorPosition","stemNormal","stemLength","stemEnabled","stemNormal","enabled"];return Object.keys(e).every((e=>t.includes(e)))}}serialize(e){const t=this.getNotePatch(e);return t&&this.validate(t)?t:null}}var pe=n(63336);const me=new ae.Z("mds-note-deserializer");class MdsNoteDeserializer{constructor(e,t){this.commentDeserializer=e,this.userData=t,this.validate=e=>{if(!e)return!1;const t=["id","created","modified","floor","resolution"].filter((t=>!(t in e))),n=0===t.length,i=!(!e.floor||!e.floor.id);return n&&i||me.debug("Note invalid:",{missingFields:t,validFloor:i}),n&&i}}deserialize(e){if(!e||!this.validate(e))return me.debug("Deserialized invalid Note data from MDS",e),null;const t=new Note;t.id=e.id,t.floorId=e.floor.id,e.room&&e.room.id&&(t.roomId=e.room.id),t.resolved=e.resolution===ee.RESOLVED,t.created=(0,pe.p)(e.created),t.modified=(0,pe.p)(e.modified),t.user=this.userData.loadContributor(e.createdBy),t.lastCommentMs=(0,pe.p)(e.lastCommentAt).getTime();const n=this.deserializeComments(e);if(!(n.length>0))return me.error("Note without a comment:",t.id),null;t.comments.replace(n),e.color&&(t.color=e.color);const i=e.anchorPosition?ue.ep.fromVisionVector(e.anchorPosition):void 0;i&&(t.anchorPosition=i),void 0!==e.stemLength&&(t.stemLength=e.stemLength);const s=e.stemNormal?ue.ep.fromVisionVector(e.stemNormal):void 0;return s?(t.stemNormal=s,t.stemEnabled=!!e.stemEnabled):(t.stemNormal=new Y.Vector3(0,0,0),t.stemEnabled=!!e.stemEnabled),t}deserializeComments(e){const t=(0,oe.q)(e,"comments.results")||[],n=[];return t.forEach((t=>{const i=this.commentDeserializer.deserialize(t);i&&(i.assetId=e.id,i.assetType=b.h.NOTE,n.push(i))})),n}}class MdsCommentSerializer{constructor(){this.validate=e=>!!e}serialize(e){if(void 0===e.text)return null;const t={text:e.text};return t&&this.validate(t)?t:null}}class Comment extends q.T{constructor(e){super(),this.id="",this.assetId="",this.assetType=b.h.NOTE,this.text="",this.user=(0,$.Q)(""),this.created=new Date,this.modified=new Date,this.edited=!1,this.attachments=(0,Z.C)([]),e&&Object.assign(this,e)}copy(e){return this.id=e.id,this.user=e.user,this.assetId=e.assetId,this.assetType=e.assetType,this.created.setTime(e.created.getTime()),this.modified.setTime(e.modified.getTime()),this.text=e.text,this.edited=e.edited,this.attachments=e.attachments,this.commit(),this}}const fe=new ae.Z("mds-comment-deserializer");class MdsCommentDeserializer{constructor(e,t,n){this.fileDeserializer=e,this.embedDeserializer=t,this.userData=n}deserialize(e){if(!e||!this.validate(e))return fe.debug("Deserialized invalid Comment data from MDS",e),null;const t=new Comment;t.id=e.id,t.created=(0,pe.p)(e.created),t.modified=(0,pe.p)(e.modified),e.text&&(t.text=e.text),t.edited=e.edited,t.user=this.userData.loadContributor(e.createdBy);const n=this.deserializeExternalAttachments(e),i=this.deserializeFileAttachments(e),s=n.concat(i).sort(((e,t)=>e.created.getTime()-t.created.getTime()));return s.length>0&&t.attachments.replace(s),t}deserializeExternalAttachments(e){const t=(0,oe.q)(e,"externalAttachments")||[],n=[];return t.forEach((t=>{const i=this.embedDeserializer.deserialize(t);i&&(i.parentId=e.id,i.parentType=y.u.COMMENT,n.push(i))})),n}deserializeFileAttachments(e){const t=(0,oe.q)(e,"fileAttachments")||[],n=[];return t.forEach((t=>{const i=this.fileDeserializer.deserialize(t);i&&(i.parentId=e.id,i.parentType=y.u.COMMENT,n.push(i))})),n}validate(e){if(!e)return!1;const t=["id","created","modified","edited","createdBy"].filter((t=>!(t in e))),n=0===t.length;return n||fe.debug("Comment invalid:",{missingFields:t}),n}}var ge=n(11764),ve=n(70129);const ye=new ae.Z("MdsNoteStore");class MdsNoteStore extends re.u{constructor(e,t){super(e),this.userData=t,this.prefetchKey="data.model.notes",this.embedDeserializer=new le.d,this.fileDeserializer=new ce.O,this.commentDeserializer=new MdsCommentDeserializer(this.fileDeserializer,this.embedDeserializer,this.userData),this.deserializer=new MdsNoteDeserializer(this.commentDeserializer,this.userData),this.createSerializer=new MdsNoteCreateSerializer,this.patchSerializer=new MdsNotePatchSerializer,this.commentSerializer=new MdsCommentSerializer}read(e){const t={modelId:this.getViewId()};return this.query(ge.GetNotes,t,e).then((e=>{var t,n;const i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.notes;if(!i||!Array.isArray(i))return{};const s=[];for(const e of i){const t=this.deserializer.deserialize(e);t&&s.push(t)}return s.reduce(((e,t)=>(e[t.id]=t,e)),{})}))}async readNote(e,t){const n={modelId:this.getViewId(),ids:[e]};return this.query(ge.GetNotes,n,t).then((e=>{var t,n;const i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.notes;return i&&Array.isArray(i)&&1===i.length?this.deserializer.deserialize(i[0]):null}))}async create(e,t){const n=this.getViewId(),i=this.createSerializer.serialize(e,t);if(!i)throw ye.error("Failure creating note:",e.id,e),new Error("Could not create Note");return this.mutate(ge.AddNote,{modelId:n,data:i}).then((e=>this.deserializer.deserialize((0,oe.q)(e,"data.addNote"))))}async update(e){const t=this.getViewId(),n=e.id,i=this.patchSerializer.serialize(e);if(!i)throw ye.error("Failure updating note:",n),new Error("Could not update Note");return this.mutate(ge.PatchNote,{modelId:t,noteId:n,data:i}).then((e=>this.deserializer.deserialize((0,oe.q)(e,"data.patchNote"))))}async updateResolution(e,t){const n=this.getViewId(),i=t?ge.ResolveNote:ge.ReopenNote,s=t?"data.resolveNote":"data.reopenNote";return this.mutate(i,{modelId:n,noteId:e}).then((e=>(0,oe.q)(e,s)))}async delete(e){const t=this.getViewId();return Promise.all(e.map((e=>{if(!e||e&&!e.id)throw new Error("MdsNoteStore.delete failed");return this.mutate(ge.DeleteNote,{modelId:t,noteId:e.id})})))}async createComment(e,t){const n=this.getViewId(),i=this.commentSerializer.serialize(t);if(!i)throw ye.error("Failure creating comment:",t),new Error("Could not create Comment");return this.mutate(ge.AddNoteComment,{modelId:n,noteId:e,data:i}).then((e=>this.commentDeserializer.deserialize((0,oe.q)(e,"data.addNoteComment"))))}async updateComment(e){const t=this.getViewId(),n=e.id,i=this.commentSerializer.serialize(e);if(!i)throw ye.error("Failure updating comment:",n),new Error("Could not update Comment");return this.mutate(ve.PatchComment,{modelId:t,commentId:n,data:i}).then((e=>(ye.debug(Object.assign({type:"PatchComment"},e)),this.commentDeserializer.deserialize((0,oe.q)(e,"data.patchComment")))))}async deleteComment(e){const t=this.getViewId();if(!e||e&&!e.id)throw new Error("MdsNoteStore.deleteComment failed");return this.mutate(ve.DeleteComment,{modelId:t,commentId:e.id})}}var be=n(36032),Se=n(6058),Ee=n(29686);class CommentSearchResultItem extends Ee.K{constructor(e,t,n,i,s){super(e),this.comment=t,this.note=n,this.textParser=i,this.groupId=s,this.id=this.comment.id,this.title=this.comment.user.name,this.description=this.textParser.getPlainText(this.comment.text),this.icon="icon-comment",this.floorId=this.note.floorId,this.color=this.note.color,this.onSelect=async()=>{super.onSelect(),this.commandBinder.issueCommand(new ie.yW(this.note.id,!1,this.id))}}}var Te=n(22149),we=n(10854);const{NOTES:xe}=we.Z.SHOWCASE,_e="MP_NOTE_SEARCH_GROUP";class NotesModule extends i.Y{constructor(){super(...arguments),this.name="notes",this.activated=!1,this.registered=!1,this.activeBindings=[],this.refreshPromise=null,this.pollOnNotes=()=>{let e;return(0,r.k1)((()=>{clearInterval(e),e=window.setInterval((()=>{this.refreshNotes()}),1e3*Q.GR)}),(()=>{window.clearInterval(e)}),!0)},this.updatePerSettings=()=>{if(this.viewData.suspendVisibilityUpdates)return;const e=this.settingsData.tryGetProperty(Q.Mp,!1),t=!this.in360View(),n=!this.interactionmodeData.isVR(),i=t&&n&&e,s=i?this.getFilteredNoteIds(!1):[];this.engine.commandBinder.issueCommand(new P.kb(R.Er.NOTE,i?1:0,s))},this.userOpenedNotesMode=()=>{this.toolsData.setToolAccess(p.X$.TOOL)},this.toggleNotesMode=async e=>{e.opened?this.activateTool():this.deactivateTool()},this.togglePinAssetEditor=async e=>{this.viewData.setActiveNotation(null),e.opened?this.changeNotesPhase(W.U.EDITING):this.viewData.notesPhase===W.U.EDITING&&this.changeNotesPhase(W.U.OPEN)},this.openNoteToComment=async e=>{const{noteId:t,commentId:n,docked:i}=e,s=this.viewData,r=s.getNoteView(t);if(!r)return;const{notesFilter:o}=s,a=o===K.$.RESOLVED;o!==K.$.ALL&&(null==r?void 0:r.resolved)!==a&&s.setNotesFilter(K.$.ALL),this.setFocusedNoteComment(r,n),await this.openNote(t,e.transitionType,i),this.openAnnotation(t,i)},this.onAppChange=()=>{this.deactivateTool(),this.updatePerSettings()},this.onNotesPhaseChanged=()=>{let e=!0;const t=this.toolsData.toolPanelLayout===p.wS.BOTTOM_PANEL;switch(this.viewData.notesPhase){case W.U.EDITING:case W.U.CREATING:e=!1;break;case W.U.OPENING:case W.U.OPEN:e=!t}this.engine.broadcast(new m.ps(e))},this.changeNotesPhase=e=>{e!==this.viewData.notesPhase&&this.viewData.setNotesPhase(e)},this.onCloseNote=async()=>{this.closeNote()},this.pinAddCancelled=e=>{e.pinType===R.Er.NOTE&&this.cancelNoteCreation(!1)},this.onCancelNewNote=async()=>{this.cancelNoteCreation(!0)},this.cancelNoteCreation=e=>{var t;if(!this.userData.isCommenter())return;const n=this.viewData,i=null===(t=n.openNoteView)||void 0===t?void 0:t.id;i&&(e&&this.engine.commandBinder.issueCommand(new P.tT(i,R.Er.NOTE)),this.engine.commandBinder.issueCommand(new B.Aj(i,F.J.NOTE))),this.cancelAttachmentChanges(),n.setActiveNotation(null),n.setOpenNoteView(null),n.setFocusedComment(null),n.setCreatingNote(!1),this.changeNotesPhase(W.U.IDLE)},this.noteWasAdded=(e,t)=>{this.updateNotePin(e)},this.noteWasUpdated=(e,t)=>{this.updateNotePin(e)},this.updateNotes=()=>{this.activated&&(this.parseNotes(),this.updateNoteViewData()),this.displayNotes()},this.onNoteFilterChanged=()=>{this.viewData.setOpenNoteView(null),this.viewData.setFocusedComment(null),this.updateNoteViewData(),this.displayNotes()},this.onSearchBlockChanged=()=>{this.closeNote(),this.updateNoteViewData()},this.onViewModeOrFloorChanged=()=>{this.updatePerSettings()},this.onOpenNoteViewChanged=()=>{const e=this.viewData.openNoteView;e&&this.updateNotePin(e)},this.startNoteCreation=async()=>{if(!this.userData.isCommenter())return;const e=this.viewData;let t=(0,c.O1)(11);for(;this.notesData.getNote(t);)t=(0,c.O1)(11);const n=new Note;n.user=this.userData.getCurrentUser(),n.id=t,n.floorId=this.floorsViewData.getHighestVisibleFloor().id;const i=e.createNoteView(n);e.setCreatingNote(!0),this.changeNotesPhase(W.U.CREATING),e.setOpenNoteView(i),e.setFocusedComment(null),this.engine.commandBinder.issueCommand(new P.fM(n.id,i,R.Er.NOTE,i.backgroundTexture,i.maskTexture)),this.engine.commandBinder.issueCommand(new ie.av)},this.saveNewNote=async e=>{if(!this.userData.isCommenter())return;const{text:t}=e,n=this.viewData,i=n.getPendingNote();if(i){const e=await this.store.create(i,t);if(!e)return void this.log.error("MDS Note saved failed");const s=e.comments.get(0);if(!s)throw new Error("No root comment in the new note");const r=await this.confirmAttachmentChanges(s.id,i.id);this.notesData.updateNote(e),r&&await this.refreshNote(e.id),this.parseMarkdown(t),n.setOpenNoteView(n.getNoteView(e.id));const o=n.openNoteView;if(o){const t=(0,j.C)(this.userData,F.J.NOTE,o.user);this.engine.commandBinder.issueCommand(new P.Ar(e.id,R.Er.NOTE,t)),this.engine.commandBinder.issueCommand(new P.OL(i.id,R.Er.NOTE))}n.setActiveNotation(null),n.setCreatingNote(!1),this.updateNoteViewData(),n.setListIndex(this.getListIndex(e.id,b.h.NOTE))}else this.log.debug("No pending note")},this.pinMoved=e=>{const{id:t,pinType:n,pinPos:i}=e,s=this.viewData.openNoteView;if(s&&n===R.Er.NOTE&&t===s.id){if(this.notesData.getNote(t)){const{anchorPosition:e,stemNormal:n,floorId:s,roomId:r}=i;this.store.update({id:t,anchorPosition:e,stemNormal:n,floorId:s,roomId:r}).then((e=>{e&&this.notesData.updateNote(e)}))}else this.log.debug("Cannot move a non-existent note")}},this.pinPlaced=e=>{const t=this.viewData.openNoteView;t&&e.pinType===R.Er.NOTE&&e.id===t.id&&(this.viewData.updateOpenNoteView(e.pinPos),this.changeNotesPhase(W.U.OPEN),this.viewData.setActiveNotation(t.id),this.openAnnotation(t.id,!0))},this.onPinUnselected=e=>{const{openNoteView:t,notesPhase:n,activeNotation:i}=this.viewData;i||t&&e.pinType===R.Er.NOTE&&e.id===t.id&&(n===W.U.CLOSED||this.appData.application===w.Mx.WORKSHOP?this.closeNote():n!==W.U.OPEN&&n!==W.U.IDLE||this.engine.commandBinder.issueCommand(new f.tT(p.w1.NOTES,!1)))},this.handleOpeningFromList=async e=>{const t=this.viewData,n=t.noteListViews.values(),{id:i,editText:s,isComment:r}=e,o=n.findIndex((e=>{const t=e.assetType===b.h.COMMENT===r;return e.id===i&&t}));if(-1===o)return void this.log.debug("note/comment id not in list");const a=n[o];if(!a)return void this.log.debug("Cannot open non-existent list view");const l=this.toolsData.toolPanelLayout===p.wS.SIDE_PANEL?d.n.FadeToBlack:d.n.Instant,c=r?i:a.commentId,u=r?a.noteId:i,h=u&&t.getNoteView(u);u&&h?(this.setFocusedNoteComment(h,c),await this.dockNote(u,l,o,s),this.openAnnotation(u,!0)):this.log.debug("cannot find note to open")},this.onEditComment=async e=>{this.viewData.setActiveNotation(e.id)},this.handlePinFocusChange=async()=>{const{openNoteView:e,isNewNote:t}=this.viewData;if(t)return;const{commandBinder:n}=this.engine,{focusedPin:i,selectedPin:s}=this.pinsViewData,{billboardAnnotation:r,billboardSelected:o}=this.annotationsViewData;if(!i)return void(r&&r.annotationType===F.J.NOTE&&r.id!==(null==s?void 0:s.id)&&n.issueCommand(new B.Aj(r.id,F.J.NOTE)));const a=(null==e?void 0:e.id)===(null==r?void 0:r.id)&&o,l=e&&(null==e?void 0:e.id)===(null==i?void 0:i.id);if(e&&a&&!l&&this.closeNote(),i.pinType===R.Er.NOTE){const t=this.viewData.getNoteView(i.id);if(!t)return void this.log.debug("Focused pin changed, but no note view.");t.id!==(null==e?void 0:e.id)&&n.issueCommand(new B.Kw(t.id,F.J.NOTE))}},this.handleAnnotationClosed=e=>{var t;e.annotationType===F.J.NOTE&&(null===(t=this.viewData.openNoteView)||void 0===t?void 0:t.id)===e.id&&this.closeNote()},this.handleAnnotationOpening=e=>{var t;const{id:n,annotationType:i,docked:s}=e;if(i!==F.J.NOTE)return void this.closeNote();const r=null===(t=this.viewData.focusedComment)||void 0===t?void 0:t.id;r&&!this.viewData.getComment(n,r)&&this.viewData.setFocusedComment(null),this.openNote(n,null,s)},this.handlePinSelection=async e=>{const{id:t,pinType:n}=e;this.viewData.activeNotation||(n===R.Er.NOTE?(this.viewData.setFocusedComment(null),await this.dockNote(t,d.n.Interpolate),this.openAnnotation(t,!0)):this.closeNote())},this.handleViewingAttachment=e=>{const{annotationType:t,id:n,attachmentId:i}=e;if(t!==F.J.NOTE)return;const s=this.viewData.getNoteAttachments(n),r=s.find((e=>e.id===i));if(r&&(0,z.lV)(r)){const e=s.filter((e=>(0,z.lV)(e)));this.engine.commandBinder.issueCommand(new G.xW(!0,e,i))}},this.deleteNote=async e=>{const t=e.noteId,n=this.notesData.getNote(t);if(n){this.engine.commandBinder.issueCommand(new v.rE),this.store.delete([n]),this.notesData.removeNote(t);const e=this.viewData.openNoteView;e&&e.id===t&&this.closeNote(),this.engine.commandBinder.issueCommand(new P.OL(t,R.Er.NOTE))}else this.log.debug("Cannot delete a non-existent note")},this.onResolveNoteCommand=async e=>{const{noteId:t,resolved:n}=e;n?this.resolveNote(t):this.reopenNote(t)},this.onSaveNoteChanges=async e=>{const{noteId:t,text:n}=e,i=this.notesData.getNote(t);if(i){const e=i.comments.get(0);if(e)return this.updateNoteComment(t,e.id,n);this.log.warn("no root comment")}else this.log.debug("Cannot update a non-existent note")},this.cancelCommentChanges=async e=>{this.cancelAttachmentChanges(),this.viewData.setActiveNotation(null)},this.saveNoteAppearance=async e=>{const t=this.notesData,{noteId:n,properties:i}=e;if(t.getNote(n)){const e=this.viewData,{openNoteView:s}=e;if(Object.keys(i)){const r=await this.store.update(Object.assign({id:n},i));r&&(this.updateNotePin(r),t.updateNote(r),(null==s?void 0:s.id)===n&&e.updateOpenNoteView(i))}}else this.log.debug("Cannot update a non-existent note")},this.addComment=async e=>{const{noteId:t,text:n,replyId:i}=e,s=this.notesData.getNote(t);if(s){s.resolved&&(this.viewData.setNotesFilter(K.$.ALL),this.reopenNote(s.id));const e=await this.store.createComment(t,{text:n});return e?(this.viewData.setActiveNotation(null),this.parseMarkdown(n),await this.confirmAttachmentChanges(e.id,i),await this.refreshNote(s.id),this.refreshNotes(),e):(this.log.error("Cannot create MDS comment"),null)}return this.log.debug("Cannot add a comment to a non-existent note"),null},this.onUpdateComment=async e=>{const{noteId:t,commentId:n,text:i}=e;return this.updateNoteComment(t,n,i)},this.deleteComment=async e=>{const{commentId:t,noteId:n}=e,i=this.notesData.getNote(n);if(i){const e=i.getComment(t);e&&await this.store.deleteComment(e),this.refreshNotes()}else this.log.debug("Cannot delete a comment in a non-existent note")},this.cancelSearch=async()=>{this.viewData.searchBlock&&this.viewData.setSearchBlock(null)},this.notationBlockClicked=e=>{const{annotationType:t,block:n}=e;t===F.J.NOTE&&(n.blockType!==h.C.USER&&n.blockType!==h.C.HASH||this.viewData.setSearchBlock(n))},this.suspendNoteVisibilityUpdates=async()=>{this.viewData.suspendVisibilityUpdates=!0,this.viewData.commit()},this.resumeNoteVisibilityUpdates=async()=>{this.viewData.suspendVisibilityUpdates=!1,this.viewData.commit()}}async init(e,t){const[n,i,r]=await Promise.all([t.market.waitForData(O.e),t.market.waitForData(A.Z),t.market.waitForData(S.m)]);if(!r.isLoggedIn()||i.isVR()||!n.tryGetProperty(Q.IA,!1))return;this.engine=t,this.config=e,this.interactionmodeData=i,this.userData=r,this.settingsData=n;const[c,d,h,p,m,f,v,y]=await Promise.all([t.market.waitForData(w.pu),t.market.waitForData(g.t),t.market.waitForData(_.Z),t.market.waitForData(M.O),t.market.waitForData(C.i),t.market.waitForData(N.c),t.market.waitForData(V.A),t.getModuleBySymbol(s.y.DEEP_LINKS)]);this.appData=c,this.toolsData=d,this.sweepData=h,this.viewmodeData=p,this.floorsViewData=f,this.annotationsViewData=v,this.linkHandler=y,this.store=this.getStore(m);const b=await this.store.read();this.notesData=new NotesData(b||{}),t.market.register(this,NotesData,this.notesData),this.textParser=new u.v({links:!0,hashtags:!0,users:this.userData}),this.maskTexture=(0,o.p)(l),this.backgroundTexture=(0,o.p)(a),this.viewData=new te.X(this.notesData,this.textParser,this.linkHandler,this.backgroundTexture,this.maskTexture),this.hashtagData=new ne.c,t.market.register(this,ne.c,this.hashtagData),this.pinsViewData=await t.market.waitForData(k.B),this.bindings.push(n.onPropertyChanged(Q.Mp,this.updatePerSettings),t.commandBinder.addBinding(ie.yK,this.toggleNotesMode),this.pinsViewData.onFocusedPinChanged(this.handlePinFocusChange),t.subscribe(U.Q4,this.handlePinSelection),t.subscribe(U.WM,this.onPinUnselected),t.subscribe(H.do,this.handleAnnotationOpening),t.subscribe(H.Ps,this.handleAnnotationClosed),t.subscribe(H.qk,this.handleViewingAttachment),t.commandBinder.addBinding(ie.yW,this.openNoteToComment),t.subscribe(x.bS,this.onAppChange),p.makeModeChangeSubscription(this.onViewModeOrFloorChanged),f.makeFloorChangeSubscription(this.onViewModeOrFloorChanged),t.subscribe(D.Z,this.updatePerSettings),t.subscribe(I.m,this.updatePerSettings),t.subscribe(se.Ey,this.userOpenedNotesMode),t.commandBinder.addBinding(ie.Kr,this.suspendNoteVisibilityUpdates),t.commandBinder.addBinding(ie.qZ,this.resumeNoteVisibilityUpdates),this.viewData.onPropertyChanged("suspendVisibilityUpdates",this.updatePerSettings),this.pollOnNotes()),t.market.register(this,te.X,this.viewData),this.updatePerSettings(),this.displayNotes(),this.parseNotes(),async function(e,t,n,i,s){const r=await e.market.waitForData(w.pu),o=(i,s,r=[])=>{const o=[];return t.iterate((t=>{if(t.resolved)return;let s=0;t.comments.forEach((a=>{0===r.length&&i(a.user.name,n.getPlainText(a.text))&&(s+=1,o.push(new CommentSearchResultItem(e.commandBinder,a,t,n,_e)))}));const a=s>0;e.commandBinder.issueCommand(new P.ik(t.id,R.Er.NOTE,a))})),o},a=new Se.u(s,{[Q.Mp]:!0}),l=t=>{t?e.commandBinder.issueCommand(new ie.Kr):e.commandBinder.issueCommand(new ie.qZ),a.toggle(t)},c=e=>new be.V(t.onChanged(e),i.onChanged(e)),d={renew:()=>{e.commandBinder.issueCommandWhenBound(new Te.c6({id:_e,groupPhraseKey:xe.SEARCH_GROUP_HEADER,getSimpleMatches:o,registerChangeObserver:c,onActivatedChanged:l}))},cancel:()=>{e.commandBinder.issueCommandWhenBound(new Te.Pe(_e))}},u=()=>{const e=r.application===w.Mx.WORKSHOP;s.tryGetProperty(Q.IA,!1)||e?d.renew():d.cancel()},h=r.onPropertyChanged("application",u),p=s.onPropertyChanged(Q.IA,u);return u(),new be.V(d,h,p)}(t,this.notesData,this.textParser,this.userData,this.settingsData).then((e=>this.bindings.push(e)))}dispose(e){this.deactivateTool(),this.bindings.forEach((e=>{e.cancel()})),this.bindings=[],this.activeBindings=[],this.engine.commandBinder.issueCommand(new P.zM(R.Er.NOTE)),this.maskTexture.dispose(),this.backgroundTexture.dispose(),this.cancelSearch(),super.dispose(e)}onUpdate(){}async refreshNotes(){var e;if(this.refreshPromise)return;const t=this.viewData,{isNewNote:n,notesPhase:i}=t;if(n||i===W.U.EDITING)return;this.refreshPromise=this.store.read().finally((()=>{this.refreshPromise=null}));const s=await this.refreshPromise,r=Object.values(s),o=null===(e=t.openNoteView)||void 0===e?void 0:e.id,{collection:a}=this.notesData;this.notesData.atomic((()=>{const e=a.keys.filter((e=>!s[e]));e.length&&e.forEach((e=>{e===o&&(this.log.debug("Open note was deleted"),t.setOpenNoteView(null),t.setFocusedComment(null),t.setActiveNotation(null)),a.delete(e)})),r.length&&r.forEach((e=>{this.notesData.updateNote(e)}))}))}async refreshNote(e){if(this.refreshPromise)return;const t=await this.store.readNote(e);t&&(this.notesData.updateNote(t),this.updateNotePin(t))}activateTool(){this.activated||(this.engine.commandBinder.issueCommand(new B.yL(F.J.NOTE)),this.config.workshop&&this.appData.application===w.Mx.WORKSHOP&&this.engine.commandBinder.issueCommand(new v.Mn(!1)),this.userData.isCommenter()&&this.engine.commandBinder.issueCommand(new P.Ki(!0)),this.changeNotesPhase(W.U.IDLE),this.updateNoteViewData(),this.registered?this.activeBindings.forEach((e=>{e.renew()})):this.registerHandlers(),this.activated=!0)}deactivateTool(e){var t;if(!this.activated)return;const{isNewNote:n,openNoteView:i}=this.viewData,s=(null===(t=this.annotationsViewData.dockedAnnotation)||void 0===t?void 0:t.annotationType)===F.J.NOTE;n?this.cancelNoteCreation(!0):i&&(e||s)&&this.closeNote(),this.viewData.setSearchBlock(null),this.changeNotesPhase(W.U.CLOSED),this.engine.commandBinder.issueCommand(new P.Ki(!1)),this.config.workshop&&this.appData.application===w.Mx.WORKSHOP&&this.engine.commandBinder.issueCommand(new v.Mn(!0)),this.activeBindings.forEach((e=>{e.cancel()})),this.activated=!1}getStore(e){const{viewId:t,baseUrl:n,readonly:i}=this.config;return new MdsNoteStore({readonly:i,includeDisabled:!0,baseUrl:n,viewId:t},this.userData)}registerHandlers(){const e=this.engine.commandBinder;this.activeBindings.push(this.engine.subscribe(U.b0,this.pinPlaced),this.engine.subscribe(U.bV,this.pinMoved),this.engine.subscribe(U.hu,this.pinAddCancelled),this.engine.subscribe(H.iP,this.notationBlockClicked),e.addBinding(ie.VI,this.startNoteCreation),e.addBinding(ie.FB,this.saveNewNote),e.addBinding(ie.gc,this.onCancelNewNote),e.addBinding(ie._N,this.onCloseNote),e.addBinding(ie.kd,this.onSaveNoteChanges),e.addBinding(ie.oH,this.cancelCommentChanges),e.addBinding(ie.Zd,this.handleOpeningFromList),e.addBinding(ie.x4,this.onEditComment),e.addBinding(ie.sG,this.deleteNote),e.addBinding(ie.yp,this.onResolveNoteCommand),e.addBinding(ie.Df,this.addComment),e.addBinding(ie.Uw,this.onUpdateComment),e.addBinding(ie.mH,this.deleteComment),e.addBinding(ie.oE,this.saveNoteAppearance),e.addBinding(ie.df,this.togglePinAssetEditor),e.addBinding(ie.av,this.cancelSearch),this.viewData.onSearchBlockChanged(this.onSearchBlockChanged),this.viewData.onNotesFilterChanged(this.onNoteFilterChanged),this.viewData.onOpenNoteViewChanged(this.onOpenNoteViewChanged),this.viewData.onNotesPhaseChanged(this.onNotesPhaseChanged),this.notesData.onChanged(this.updateNotes),this.notesData.collection.onElementChanged({onAdded:this.noteWasAdded,onUpdated:this.noteWasUpdated})),this.registered=!0}async parseNotes(){const e=[],t=[];return this.notesData.iterate((n=>{n.comments.forEach((n=>{const i=this.getUserMentionsAndHashtags(n.text);i.emails.forEach((t=>{e.push({email:t,userStatus:E.J.MENTIONED})})),t.push(...i.hashtags)}))})),this.hashtagData.addHashtags(t),this.engine.commandBinder.issueCommand(new T.Vu(e))}async parseMarkdown(e){const t=[],n=this.getUserMentionsAndHashtags(e);return n.emails.forEach((e=>{t.push({email:e,userStatus:E.J.MENTIONED})})),this.hashtagData.addHashtags(n.hashtags),this.engine.commandBinder.issueCommand(new T.Vu(t))}getUserMentionsAndHashtags(e){const t=[],n=[];for(const i of this.textParser.parse(e))i.blockType===h.C.USER&&i.value?t.push(i.value):i.blockType===h.C.HASH&&n.push(i.text);return{emails:t,hashtags:n}}openAnnotation(e,t){t?this.engine.commandBinder.issueCommand(new B.bd(e,F.J.NOTE)):this.engine.commandBinder.issueCommand(new B.oM(e,F.J.NOTE))}in360View(){const e=this.sweepData.currentSweep?this.sweepData.currentSweep:"";return this.viewmodeData.isInside()&&this.sweepData.isSweepUnaligned(e)}async closeNote(){const{commandBinder:e}=this.engine,{openNoteView:t,notesPhase:n}=this.viewData;if(this.viewData.setActiveNotation(null),this.viewData.setOpenNoteView(null),this.viewData.setFocusedComment(null),n!==W.U.CLOSED&&this.changeNotesPhase(W.U.IDLE),t){const n=t.id;this.cancelAttachmentChanges(),e.issueCommand(new G.xW(!1));this.notesData.getNote(n)&&(e.issueCommand(new P.RH(n,R.Er.NOTE)),e.issueCommand(new P.ik(n,R.Er.NOTE,this.getNoteVisibility(n,t.resolved)))),await e.issueCommand(new B.Aj(n,F.J.NOTE))}}updateNoteViewData(){this.viewData.updateViewData(this.viewData.searchBlock)}getFilteredNoteIds(e){const t=[];return this.notesData.iterate((n=>{this.getNoteVisibility(n.id,n.resolved)===e&&t.push(n.id)})),t}getNoteVisibility(e,t){const{notesFilter:n,openNoteView:i}=this.viewData;return(null==i?void 0:i.id)===e||n===K.$.ALL||t&&n===K.$.RESOLVED||!t&&n===K.$.OPEN}displayNotes(){const e=[];this.notesData.iterate((t=>{e.push(Object.assign(Object.assign({},t),{pinType:R.Er.NOTE,backgroundTexture:this.backgroundTexture,maskTexture:this.maskTexture,visible:this.getNoteVisibility(t.id,t.resolved)}))})),this.engine.commandBinder.issueCommand(new P.mE(e))}updateNotePin(e){const t=Object.assign(Object.assign({},e),{pinType:R.Er.NOTE,backgroundTexture:this.backgroundTexture,maskTexture:this.maskTexture,visible:this.getNoteVisibility(e.id,e.resolved)});this.engine.commandBinder.issueCommand(new P.mE([t]))}async confirmAttachmentChanges(e,t){return this.engine.commandBinder.issueCommand(new G.iu(e,y.u.COMMENT,t))}async cancelAttachmentChanges(){return this.engine.commandBinder.issueCommand(new G.Ze)}setFocusedNoteComment(e,t){if(t){const n=this.viewData.getComment(e.id,t);this.viewData.setFocusedComment(n)}else this.viewData.setFocusedComment(null)}async openNote(e,t,n,i=-1,s=!1){var r;const o=(null===(r=this.annotationsViewData.dockedAnnotation)||void 0===r?void 0:r.annotationType)===F.J.NOTE;return(null!==n?n:o)?this.dockNote(e,t,i,s):this.selectNote(e,t)}async selectNote(e,t){var n;const{commandBinder:i}=this.engine,s=this.viewData.getNoteView(e);if(s){const{openNoteView:r}=this.viewData,o=(null==r?void 0:r.id)===e,a=(null===(n=this.annotationsViewData.dockedAnnotation)||void 0===n?void 0:n.id)===e;if(o&&!a&&r)return void this.log.debug("Note is already selected");this.activated&&await i.issueCommand(new f.tT(p.w1.NOTES,!1)),i.issueCommand(new G.xW(!1)),r&&(i.issueCommand(new B.Aj(r.id,F.J.NOTE)),i.issueCommand(new P.RH(r.id,R.Er.NOTE))),this.viewData.setOpenNoteView(s),await i.issueCommand(new P.Ar(e,R.Er.NOTE,!1)),null!==t&&await i.issueCommand(new L.OR({pinPosition:s,transition:t}))}else this.log.debug("Cannot select a non-existent note")}async dockNote(e,t,n=-1,i=!1){var s,r;const{toolsData:o,viewData:a,engine:l,activated:c,userData:d}=this,u=a.getNoteView(e);if(u){const{openNoteView:h}=this.viewData,m=(null==h?void 0:h.id)===e,g=(null===(s=this.annotationsViewData.dockedAnnotation)||void 0===s?void 0:s.id)===e;if(this.toolsData.panelCollapsed&&l.commandBinder.issueCommand(new f.zK(!1)),m&&g&&h)return void this.log.debug("Note is already docked");l.commandBinder.issueCommand(new v.rE),c?-1!==n&&o.toolAccess===p.X$.TOOL&&o.setToolAccess(p.X$.LIST):(await l.commandBinder.issueCommand(new f.tT(p.w1.NOTES,!0)),o.setToolAccess(p.X$.SCENE)),m||a.setOpenNoteView(u);const y=(0,j.C)(d,F.J.NOTE,u.user);l.commandBinder.issueCommand(new P.Ar(e,R.Er.NOTE,y)),this.changeNotesPhase(W.U.OPENING),null!==t&&await l.commandBinder.issueCommand(new L.OR({pinPosition:u,transition:t})),this.changeNotesPhase(W.U.OPEN);const S=null===(r=a.focusedComment)||void 0===r?void 0:r.id;if(i){const t=S||e;a.setActiveNotation(t)}else a.setActiveNotation(null);if(S||!m){const e=S||u.comments.get(0).id;l.broadcast(new se.JL(e))}let E=n;-1===E&&(E=this.getListIndex(u.id,b.h.NOTE)),this.viewData.setListIndex(E)}else this.log.debug("Cannot open a non-existent note")}getListIndex(e,t){return this.viewData.noteListViews.values().findIndex((n=>n.assetType===t&&n.id===e))}async resolveNote(e){const t=this.notesData.getNote(e);if(t){if(t.resolved)return;this.closeNote(),await(0,c.gw)(350),this.engine.broadcast(new se.hY(e,!0));await this.store.updateResolution(e,!0)?this.notesData.updateNoteProperties(e,{resolved:!0}):this.log.error("Resolving note failed")}else this.log.debug("Cannot resolve a non-existent note")}reopenNote(e){const t=this.notesData.getNote(e);if(t){if(!t.resolved)return;this.viewData.updateOpenNoteView({resolved:!1}),this.notesData.updateNoteProperties(e,{resolved:!1}),this.store.updateResolution(e,!1)}else this.log.debug("Cannot reopen a non-existent note")}async updateNoteComment(e,t,n){const i=this.notesData.getNote(e);if(i){const s=i.getComment(t);if(s)if(s.user.id===this.userData.getCurrentUserId()){const r=await this.confirmAttachmentChanges(t,y.u.COMMENT);if(n!==s.text){const e=await this.store.updateComment({id:t,text:n});e&&i.updateComment(e),this.parseMarkdown(n)}(r||n!==s.text)&&(await this.refreshNote(i.id),i.resolved&&(this.viewData.setNotesFilter(K.$.ALL),this.reopenNote(e))),this.viewData.setActiveNotation(null)}else this.log.debug("Cannot update another user's comment");else this.log.debug("Cannot update a non-existent comment")}else this.log.debug("Cannot update a comment in a non-existent note")}}const Me=NotesModule},51073:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>NotesModeOpenedMessage,hY:()=>NoteResolutionChangeMessage,JL:()=>FocusCommentMessage});var i=n(4117);class NotesModeOpenedMessage extends i.v{}class NoteResolutionChangeMessage extends i.v{constructor(e,t){super(),this.id=e,this.resolved=t}}class FocusCommentMessage extends i.v{constructor(e){super(),this.commentId=e}}},73156:(e,t,n)=>{"use strict";n.d(t,{IA:()=>s,Mp:()=>r,pE:()=>o,uE:()=>a,GR:()=>l,E8:()=>c,AT:()=>d,TM:()=>u,Ko:()=>h,Rn:()=>p,ZP:()=>m});var i=n(94170);const s="features/notes-mode",r="features/notes",o="features/notes-nudge",a="spaces.notes",l=30,c=15,d=i.x.VIEWER,u=500,h=500,p="#5c7fff",m=Object.freeze({noteMesh:{scale:{nearBound:1.5,farBound:4.8,maxSize:80,minSize:40,baseViewportSize:800,responsiveness:100}},colors:["#d44441","#f44336","#e91e63","#f78da7","#9c4b92","#673ab7","#5c7fff","#03a9f4","#417505","#00bcd4","#51a868","#37d67a","#cddc39","#fbcd00","#ffac17","#ff6900","#abb8c3","#607d8b"],stem:{length:.23,width:1,opacity:1,transparent:!1,color:"white",alphaTest:.05},anchor:{size:.1},navigation:{anyDistance:!0,visibleDistance:8,cameraClearance:.1,tiltTolerance:25}})},91997:(e,t,n)=>{"use strict";n.d(t,{h:()=>ObjectTagSuggestionsData});var i=n(35424),s=n(67779);class ObjectTagSuggestionsData extends i.V{constructor(e){super(),this.store=e,this.suggestions=[],this.isLoadingObjects=(0,s.Y)(!1),this.classifications=[]}getObjectTagIds(){const e=[];for(const t of this.suggestions)e.push(t.id);return e}async create(e,t){return this.store.createObjectTag(e,t).then((t=>(t&&(e.id=t.id,this.add(e)),t)))}add(...e){this.atomic((()=>{for(const t of e)this.suggestions.push(t)})),this.commit()}async accept(...e){return this.store.accept(...e)}async reject(...e){return this.store.reject(...e)}async dismiss(...e){return this.store.dismiss(...e)}async setEnabled(e,...t){return this.store.toggleEnabled(e,...t)}}},98461:(e,t,n)=>{"use strict";n.d(t,{yJ:()=>FilterObjectTagSuggestionCommand,w$:()=>NavigateToObjectTagSuggestionCommand,xN:()=>CloseSelectedTagSuggestionCommand,Bh:()=>ToggleObjectTagEnabledCommand,AQ:()=>DismissObjectTagsCommand,I2:()=>CreateObjectTagCommand});var i=n(93037);class FilterObjectTagSuggestionCommand extends i.m{constructor(e){super(),this.id="FILTER_TAG_SUGGESTION",this.payload={ids:e}}}class NavigateToObjectTagSuggestionCommand extends i.m{constructor(e){super(),this.id="NAVIGATE_TO_TAG_SUGGESTION",this.payload={id:e}}}class CloseSelectedTagSuggestionCommand extends i.m{constructor(){super(),this.id="CLOSE_SELECTED_TAG_SUGGESTION"}}class ToggleObjectTagEnabledCommand extends i.m{constructor(e,...t){super(),this.id="TOGGLE_OBJECT_TAG_ENABLED",this.payload={ids:t,enabled:e}}}class DismissObjectTagsCommand extends i.m{constructor(...e){super(),this.id="DISMISS_OBJECT_TAG",this.payload={ids:e}}}class CreateObjectTagCommand extends i.m{constructor(e,t,n,i){super(),this.id="CREATE_OBJECT_TAG",this.payload={id:e,options:t,pendingAttachments:n,embed:i}}}},91988:(e,t,n)=>{"use strict";n.d(t,{M:()=>i,K:()=>s});const i="spaces.object_detection",s=.065},86413:(e,t,n)=>{"use strict";n.d(t,{W:()=>OrderedListData});var i=n(35424),s=n(66910);class OrderedListData extends i.V{constructor(e){super(),this.name="ordered-list-data",this.lists=(0,s.q)(e)}getOrderedLists(){return this.lists.values}getOrderedList(e){return this.lists.get(e)}updateOrderedList(e){this.lists.has(e.name)?this.lists.get(e.name).copy(e):this.lists.set(e.name,e)}}},28253:(e,t,n)=>{"use strict";n.d(t,{wg:()=>SaveNamedOrderedListCommand,Bd:()=>CreateOrderedListCommand,ui:()=>UpdateOrderedListCommand});var i=n(93037);class SaveNamedOrderedListCommand extends i.m{constructor(e,t){super(),this.payload={name:e,entries:t}}}class CreateOrderedListCommand extends i.m{constructor(e,t){super(),this.payload={name:e,entries:t}}}class UpdateOrderedListCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,name:t,entries:n}}}},57524:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i}),function(e){e.TAG="tag"}(i||(i={}))},59227:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CreateOrderedListCommand:()=>v.Bd,MdsOrderedListDeserializer:()=>MdsOrderedListDeserializer,MdsOrderedListStore:()=>MdsOrderedListStore,OrderedList:()=>OrderedList,OrderedListData:()=>g.W,OrderedListEntryType:()=>y.l,SaveNamedOrderedListCommand:()=>v.wg,TAG_ORDERED_LIST_NAME:()=>b.q,UpdateOrderedListCommand:()=>v.ui,default:()=>S});var i=n(57227),s=n(52549),r=n(47063),o=n(7819),a=n(48697),l=n(98254);class OrderedList extends l.T{constructor(e){super(),this.id="",this.name="",this.description="",this.entries=[],e&&Object.assign(this,e)}copy(e){return this.id=e.id,this.name=e.name,e.description&&(this.description=e.description),this.entries=e.entries.slice(),this.commit(),this}}var c=n(66225),d=n(29474),u=n(38636),h=n(5477),p=n(60344);const m=new h.Z("ordered-list-deserializer");class MdsOrderedListDeserializer{deserialize(e){return e&&this.validate(e)?new OrderedList({id:e.id,name:e.label,entries:e.entries.map((e=>({id:e.id,type:e.type})))}):(m.debug("Deserialized invalid ordered list data from Mds",e),null)}validate(e){return["id","label","entries"].every((t=>t in e))}}const f=new h.Z("MdsOrderedListStore");class MdsOrderedListStore extends c.u{constructor(e){super(e),this.deserializer=new MdsOrderedListDeserializer}async read(){const e=this.getViewId();return this.query(p.GetOrderedLists,{modelId:e,ids:[]}).then((e=>{const t=(0,u.q)(e,"data.model.orderedLists");if(!t||!Array.isArray(t))return f.debug("GetOrderedLists failed"),{};return t.reduce(((e,t)=>{const n=this.deserializer.deserialize(t);return n&&(e[n.name]&&f.debug(`Duplicate orderedList found with label: ${n.name}`),e[n.name]=n),e}),{})}))}async create(e){if(0===e.length)return[];const t=this.getViewId();return Promise.all(e.map((e=>this.mutate(p.AddOrderedList,{modelId:t,label:e.name,description:e.description,entries:e.entries}).then((e=>this.deserializer.deserialize((0,u.q)(e,"data.addOrderedList")))))))}async update(e){if(0===e.length)return;const t=this.getViewId();let n="";const i={};i.modelId=t;let s="";for(const t of e){const e=t.id;n+=`\n        , $label${e}: String!\n        , $description${e}: String!\n        , $entries${e}: [EntryInput!]\n      `,i[`label${e}`]=t.name,i[`description${e}`]=t.description,i[`entries${e}`]=t.entries,s+=`\n        update${e}:\n        patchOrderedList(modelId: $modelId,\n                         orderedListId: "${e}",\n                         label: $label${e},\n                         description: $description${e},\n                         entries: $entries${e}) {\n          id\n          label\n          entries {\n            id\n            type\n          }\n        }\n      `}const r=d.Ps`
      mutation orderedListsUpdate($modelId: ID! ${n}) {
        ${s}
      }
    `;return this.mutate(r,i).then((e=>{f.debug(Object.assign({type:"patchOrderedList"},Object.values((0,u.q)(e,"data"))))}))}}var g=n(86413),v=n(28253);class OrderedListsModule extends i.Y{constructor(){super(...arguments),this.name="ordered-lists",this.saveNamedOrderedList=async e=>{const{name:t,entries:n}=e;let i=this.data.getOrderedList(t);return i?i.entries=n:i=new OrderedList({name:t,entries:n}),this.data.updateOrderedList(i),this.engine.commandBinder.issueCommand(new r.VQ({dataTypes:[s.g.ORDERED_LISTS]}))}}async init(e,t){const{baseUrl:n,workshop:i}=e;this.engine=t,this.store=new MdsOrderedListStore({baseUrl:n,readonly:!i});const r=await this.store.read();if(this.data=new g.W(r||{}),i){const e=await t.getModule(o.F);this.bindings.push(t.commandBinder.addBinding(v.wg,this.saveNamedOrderedList),e.onSave((()=>this.save()),{dataType:s.g.ORDERED_LISTS}));const n=await t.market.waitForData(a.Q);n.setPublishableType(s.g.ORDERED_LISTS),n.setRevertableType(s.g.ORDERED_LISTS)}t.market.register(this,g.W,this.data)}dispose(e){this.bindings.forEach((e=>{e.cancel()})),this.bindings=[],super.dispose(e)}onUpdate(){}async save(){const e=this.data.getOrderedLists(),t=[],n=[];e.forEach((e=>{""===e.id?t.push(e):n.push(e)}));return Promise.all([this.store.create(t),this.store.update(n)]).then((e=>{e[0].forEach((e=>{e&&this.data.updateOrderedList(e)}))}))}}var y=n(57524),b=n(24497);const S=OrderedListsModule},24497:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});const i="mp.tags"},29949:(e,t,n)=>{"use strict";n.d(t,{B:()=>CameraControls});var i=n(2212),s=n(95703),r=n(87727),o=n(85111),a=n(63387),l=n(26517),c=n(14894),d=n(31013);class CameraControls extends c.Z{constructor(e,t,n,o=!1){super(),this.cameraModule=e,this.targetProjection=new s.M,this.currentOrientation=new i.Quaternion,this.currentPosition=new i.Vector3,this.positionDelta=new i.Vector3,this.linearAccel=new i.Vector2,this.linearVelocity=new i.Vector2,this.zoomAccel=0,this.zoomVelocity=0,this.scale=1,this.maxZoom=0,this.minZoom=r.Tm,this.checkBounds=o,this.bounds=t.clone(),this.boundsCenter=n.clone(),this.setupBounds(),this.transition={active:!1,startTime:0,elapsed:0,duration:0,linearVelocity:new i.Vector2,zoomVelocity:0,easeOut:!1}}start(){this.scale=1,this.maxZoom=this.cameraModule.getData(!1).defaultZoom()*r.Ct}setPanAcceleration(e,t=!1,n){if(!this.transition.active){t&&this.haltVelocity(e,this.linearVelocity);const i=this.cameraModule.getData(!1),s=i.pose.projection.elements[0],r=i.pose.projection.elements[5];this.linearAccel.x=void 0!==e.x?e.x/s:this.linearAccel.x,this.linearAccel.y=void 0!==e.y?e.y/r:this.linearAccel.y,void 0!==n&&this.linearAccel.setLength(n)}}setZoomAcceleration(e){this.transition.active||(this.zoomAccel=e)}haltVelocity(e,t){e.x&&t.x&&Math.sign(e.x)!==Math.sign(t.x)&&(t.x=0),e.y&&t.y&&Math.sign(e.y)!==Math.sign(t.y)&&(t.y=0)}startRotateTransition(e,t,n){return Promise.resolve()}startTranslateTransition(e,t,n=!0){return this.startTransition(e,0,t.clone().multiplyScalar(r.SI),0,n).nativePromise()}startZoomTransition(e,t,n){return this.startTransition(e,0,new i.Vector2(0,0),t,n).nativePromise()}startTransition(e,t,n,i,s){const r=new d.Q;return this.transition.active=!0,this.transition.duration=e,this.transition.elapsed=0,this.transition.startTime=Date.now(),this.transition.deferred=r,this.transition.linearVelocity.copy(n),this.transition.zoomVelocity=i,this.transition.easeOut=s,this.linearAccel.set(0,0),this.zoomAccel=0,this.linearVelocity.copy(n),this.zoomVelocity=i,this.cameraModule.beginExternalTransition(),r.promise()}stopTransition(){this.transition.active&&(this.cameraModule.endExternalTransition(),this.transition.active=!1),this.transition.deferred&&(this.transition.deferred.resolve(),this.transition.deferred=void 0)}updateTransition(e,t,n){this.transition.elapsed+=e;const i=this.getTransitionScale(e);t&&(this.linearVelocity.copy(this.transition.linearVelocity).multiplyScalar(i),this.pan(this.linearVelocity)),n&&(this.zoomVelocity=this.transition.zoomVelocity*i,this.zoom(this.zoomVelocity)),this.transition.elapsed>=this.transition.duration&&(this.stop(this.transition.easeOut),this.transition.active=!1)}getTransitionScale(e){if(this.transition.elapsed>=this.transition.duration){return(this.transition.duration-(this.transition.elapsed-e))/e}return e/r.SI}updateDefault(e,t,n){const i=e/r.SI;t&&(this.linearVelocity.addScaledVector(this.linearAccel,i),this.pan(this.linearVelocity),this.linearVelocity.multiplyScalar(Math.pow(1-r.O8,i))),n&&(this.zoomVelocity=this.zoomVelocity+this.zoomAccel*i,this.zoom(this.zoomVelocity),this.zoomVelocity*=Math.pow(1-r.TD,i))}update(e){const t=this.linearAccel.length()>o.Z.epsilon||this.linearVelocity.length()>o.Z.epsilon,n=Math.abs(this.zoomAccel)>o.Z.epsilon||Math.abs(this.zoomVelocity)>o.Z.epsilon;this.transition.active?this.updateTransition(e,t,n):this.updateDefault(e,t,n)}stopMomentum(){this.transition.active||(this.linearVelocity.set(0,0),this.zoomVelocity=0)}stopAcceleration(){this.transition.active||(this.setPanAcceleration({x:0,y:0}),this.setZoomAcceleration(0))}stop(e=!1){this.stopTransition(),this.stopAcceleration(),e||this.stopMomentum()}pan(e){const t=this.cameraModule.getData(!1);this.positionDelta.x=e.x,this.positionDelta.y=e.y,this.positionDelta.z=0,this.positionDelta.applyQuaternion(t.pose.rotation),this.currentPosition.copy(t.pose.position).add(this.positionDelta),this.checkBounds&&!this.insideBounds(this.currentPosition,t.pose.rotation,t.pose.projection)||this.cameraModule.updateCameraPosition(this.currentPosition)}zoom(e){const t=this.cameraModule.getData(!1);this.targetProjection.copy(t.pose.projection);const n=this.scale*(1-e);if(Math.abs(n-this.scale)>o.Z.epsilon){this.targetProjection.elements[0]*=n/this.scale,this.targetProjection.elements[5]*=n/this.scale;const i=(0,l.S3)(this.targetProjection);if(e<0&&i<=this.minZoom||e>0&&i>=this.maxZoom)return;if(this.checkBounds&&!this.insideBounds(t.pose.position,t.pose.rotation,this.targetProjection))return;this.scale=n,this.cameraModule.updateCameraProjection(this.targetProjection.clone())}}setupBounds(){this.bounds.min.x=this.adjustBound(this.bounds.min.x,2),this.bounds.min.y=this.adjustBound(this.bounds.min.y,2),this.bounds.min.z=this.adjustBound(this.bounds.min.z,2),this.bounds.max.x=this.adjustBound(this.bounds.max.x,-2),this.bounds.max.y=this.adjustBound(this.bounds.max.y,-2),this.bounds.max.z=this.adjustBound(this.bounds.max.z,-2),this.worldBounds=(new i.Box3).setFromCenterAndSize(this.boundsCenter,new i.Vector3(this.bounds.max.x-this.bounds.min.x,this.bounds.max.y-this.bounds.min.y,this.bounds.max.z-this.bounds.min.z))}insideBounds(e,t,n){return!!(0,a.cb)(e,t,n,this.worldBounds)}adjustBound(e,t){return Math.sign(e+t)===Math.sign(e)?e+t:0}}},87727:(e,t,n)=>{"use strict";n.d(t,{SI:()=>s,O8:()=>r,Gu:()=>o,bC:()=>a,JU:()=>l,Ct:()=>c,Tm:()=>d,TD:()=>u,mP:()=>h,jX:()=>p,N4:()=>m});var i=n(2252);const s=1e3/60,r=.05,o=.1/60,a=.02,l=25,c=3,d=3,u=.16,h=(0,i.V5)()?45:(0,i.Kr)()?20:35,p=.01,m=2},79846:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>OrthographicControls});var i,s=n(57227),r=n(2212),o=n(29949),a=n(87727),l=n(37363),c=n(8054),d=n(43985),u=n(19926),h=n(22878),p=n(92214),m=n(50084),f=n(17921),g=n(76922),v=n(69054),y=n(94113),b=n(24673),S=n(39808),E=n(63387),T=n(14877);!function(e){e[e.NONE=c.r3.NONE]="NONE",e[e.PAN=c.r3.PRIMARY]="PAN",e[e.ROTATE=c.r3.SECONDARY]="ROTATE",e[e.ZOOM=c.r3.MIDDLE]="ZOOM"}(i||(i={}));class OrthographicControls extends s.Y{constructor(){super(...arguments),this.name="orthographic-controls",this.controlState=i.NONE,this.controlsEngaged=!1,this.movementKeys=new r.Vector2,this.resetControlState=()=>{this.controlState=i.NONE}}async init(e,t){const[n,i,s,r]=await Promise.all([t.market.waitForData(S._),t.getModuleBySymbol(T.y.CAMERA),t.getModule(b.default),t.market.waitForData(l.O)]);this.meshData=n,this.cameraModule=i,this.viewmodeData=r,this.modelSize=Math.max(n.extendedSize.length(),1),this.commonControlsModule=s,this.createCameraControls(n),t.getModuleBySymbol(T.y.INPUT).then((e=>{this.bindings.push(e.registerHandler(f.a,(e=>{this.validateViewmode()&&this.onScrollWheel(e)}))),this.bindings.push(e.registerHandler(g.E0,(e=>{this.validateViewmode()&&this.onDragBegin(e.buttons)}))),this.bindings.push(e.registerHandler(g._t,(e=>{this.validateViewmode()&&(this.controlsEngaged=!0,this.onDrag(e.delta),this.controls.update(a.SI),this.controls.stop())}))),this.bindings.push(e.registerHandler(g._R,(e=>{this.validateViewmode()&&this.controlsEngaged&&(e.timeSinceLastMove<100&&(this.onDrag(e.delta),this.controls.update(a.SI),this.controls.stopAcceleration()),this.onDragEnd(e.delta,e.buttons),this.controlsEngaged=!1)}))),this.bindings.push(e.registerHandler(v.G,(e=>{this.validateViewmode()&&(this.controls.setZoomAcceleration(-e.pinchDelta*a.N4),this.controls.update(a.SI),this.controls.stop())}))),this.bindings.push(e.registerHandler(v.i,this.resetControlState)),this.bindings.push(e.registerHandler(y.e,(e=>{this.validateViewmode()&&e.state!==u.M.PRESSED&&this.onKey(e)})))})),this.bindings.push(t.subscribe(p.Z,(e=>{this.controls.stop(),this.resetControlState()}))),this.bindings.push(t.subscribe(m.Z,(e=>{this.validateViewmode()&&this.controls.start()})))}onUpdate(e){this.validateViewmode()&&this.controls.update(e)}createCameraControls(e){this.controls=new o.B(this.cameraModule,e.extendedBounds,e.meshCenter,!0),this.commonControlsModule.addControls(h.Ey.Orthographic,this.controls)}onScrollWheel(e){if(0!==e.delta.y){const t=(0,E.et)(this.modelSize,1,1500,2,.125);this.controls.setZoomAcceleration(e.delta.y*a.jX/(t*a.mP)),this.controls.update(a.SI),this.controls.setZoomAcceleration(0)}}onDragBegin(e){if(this.controlState===i.NONE){const t=e;this.controlState=t}this.controls.stop()}onDrag(e){switch(this.controlState){case i.PAN:const t=e;this.controls.setPanAcceleration({x:-t.x,y:-t.y});break;case i.ZOOM:0!==e.y&&this.controls.setZoomAcceleration(-e.y)}}onDragEnd(e,t){t&this.controlState||(this.controlState=i.NONE)}onKey(e){const{key:t,state:n}=e,i=n===u.M.DOWN;let s=!1;switch(t){case d.R.A:this.movementKeys.x=i?-1:0,s=!0;break;case d.R.D:this.movementKeys.x=i?1:0,s=!0;break;case d.R.W:this.movementKeys.y=i?1:0,s=!0;break;case d.R.S:this.movementKeys.y=i?-1:0,s=!0;break;case d.R.K:this.controls.setZoomAcceleration(i?a.Gu:0);break;case d.R.I:this.controls.setZoomAcceleration(i?-a.Gu:0)}if(s){const e=this.movementKeys;this.controls.setPanAcceleration({x:e.x,y:e.y},!1,a.bC)}}validateViewmode(){return this.viewmodeData.currentMode===h.Ey.Orthographic}}},20751:(e,t,n)=>{"use strict";n.d(t,{SI:()=>s,uQ:()=>r,zf:()=>o,O8:()=>a,WI:()=>l});var i=n(994);const s=1e3/60,r=(0,i.Id)(70),o=-r,a=.05,l=.1/60},82702:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>PanoramaControls,lookAccelerationKey:()=>w});var i=n(57227),s=n(2212),r=n(77280),o=n(20751),a=n(85111),l=n(74170),c=n(14894),d=n(31013);class CameraControls extends c.Z{constructor(e){super(),this.lookVelocity=new s.Vector2,this.lookAccel=new s.Vector2,this.tempAxis=new s.Vector3,this.tempOrientation=new s.Quaternion,this.currentOrientation=new s.Quaternion,this.tempEuler=new s.Euler,this.cameraModule=e,this.transition={active:!1,startTime:0,elapsed:0,duration:0,velocity:new s.Vector2,easeOut:!1}}setLookAcceleration(e,t=!1){this.transition.active||(t&&(e.x&&this.lookVelocity.x&&Math.sign(e.x)!==Math.sign(this.lookVelocity.x)&&(this.lookVelocity.x=0),e.y&&this.lookVelocity.y&&Math.sign(e.y)!==Math.sign(this.lookVelocity.y)&&(this.lookVelocity.y=0)),this.lookAccel.x=void 0!==e.x?e.x:this.lookAccel.x,this.lookAccel.y=void 0!==e.y?e.y:this.lookAccel.y)}startTransition(e,t,n){const i=new d.Q;return this.transition.active=!0,this.transition.duration=e,this.transition.elapsed=0,this.transition.startTime=Date.now(),this.transition.deferred=i,this.transition.velocity.copy(t),this.transition.easeOut=n,this.lookAccel.set(0,0),this.lookVelocity.copy(t),this.cameraModule.beginExternalTransition(),i.promise()}stopTransition(){this.transition.active&&(this.cameraModule.endExternalTransition(),this.transition.active=!1),this.transition.deferred&&(this.transition.deferred.resolve(),this.transition.deferred=void 0)}updateTransition(e){const t=e/o.SI;if(this.lookVelocity.copy(this.transition.velocity),this.transition.elapsed+=e,this.transition.elapsed>=this.transition.duration){const t=this.transition.duration-(this.transition.elapsed-e);this.lookVelocity.multiplyScalar(t/e)}else this.lookVelocity.multiplyScalar(t)}updateCameraParameters(){const e=this.cameraModule.getData(!1);this.tempEuler.setFromQuaternion(e.pose.rotation,"YXZ");const t=this.tempEuler.x,n=(0,l.uZ)(this.lookVelocity.y,o.zf-t,o.uQ-t);this.tempAxis.copy(r.f.RIGHT),this.tempOrientation.setFromAxisAngle(this.tempAxis.applyQuaternion(e.pose.rotation),n),this.currentOrientation.copy(e.pose.rotation).premultiply(this.tempOrientation),this.tempOrientation.setFromAxisAngle(r.f.UP,this.lookVelocity.x),this.currentOrientation.premultiply(this.tempOrientation),e.pose.rotation.equals(this.currentOrientation)||(this.tempOrientation.copy(this.currentOrientation).normalize(),this.cameraModule.updateCameraRotation(this.tempOrientation))}update(e){const t=this.cameraModule.getData(!1),n=e/o.SI;t.pose.rotation.equals(this.currentOrientation)||this.currentOrientation.copy(t.pose.rotation),this.transition.active?(this.updateTransition(e),this.updateCameraParameters(),this.transition.elapsed>=this.transition.duration&&(this.stop(this.transition.easeOut),this.transition.active=!1)):(this.lookAccel.length()>a.Z.epsilon||this.lookVelocity.length()>a.Z.epsilon)&&(this.lookVelocity.addScaledVector(this.lookAccel,n),this.updateCameraParameters(),this.lookVelocity.multiplyScalar(Math.pow(1-o.O8,n)))}stop(e=!1){this.stopTransition(),this.lookAccel.set(0,0),e||this.lookVelocity.set(0,0)}startRotateTransition(e,t,n){const i=this.cameraModule.getData(!1);return i.transition&&i.transition.activeInternal&&i.transition.to.rotation&&(i.transition.to.rotation=void 0),this.startTransition(e,t.clone().multiplyScalar(o.SI),n).nativePromise()}startTranslateTransition(e,t,n=!0){throw new Error("Panning isn't supported in Panorama Controls")}startZoomTransition(e,t,n){throw new Error("Zooming isn't supported in Panorama Controls")}}var u=n(37363),h=n(59057),p=n(22878),m=n(8054),f=n(43985),g=n(19926),v=n(92214),y=n(76922),b=n(94113),S=n(24673),E=n(61903),T=n(14877);const w="Rotation speed";class PanoramaControls extends i.Y{constructor(){super(...arguments),this.name="panorama-controls",this.controlsEngaged=!1,this.lookAccelerationSpeed=o.WI,this.calcRotationAngle=(()=>{const e=new s.Matrix4,t=new s.Vector3,n=new s.Vector3;return(i,r,o)=>{const a=i.getData(!1);e.copy(a.pose.projection.asThreeMatrix4()),e.invert(),t.set(r.x-o.x,r.y-o.y,-1).applyMatrix4(e),n.set(r.x,r.y,-1).applyMatrix4(e);const l=Math.sqrt(t.x*t.x+t.z*t.z),c=Math.sqrt(n.x*n.x+n.z*n.z),d=Math.atan2(t.y,l),u=Math.atan2(n.y,c)-d;t.y=0,n.y=0,t.normalize(),n.normalize();const h=Math.acos(t.dot(n));let p=0;return isNaN(h)||(p=h,o.x>0&&(p*=-1)),new s.Vector2(-p,-u)}})()}async init(e,t){const n=await t.getModuleBySymbol(T.y.CAMERA);this.controls=new CameraControls(n);const i=await t.getModule(S.default);i.addControls(p.Ey.Panorama,this.controls),i.addControls(p.Ey.Mesh,this.controls),this.market=t.market,this.bindings.push(t.subscribe(v.Z,(e=>{this.controls.stop()}))),t.getModuleBySymbol(T.y.INPUT).then((e=>{e.registerHandler(y.E0,(e=>{this.validateViewmode()&&this.controls.stop()})),e.registerHandler(y._t,(e=>{this.validateViewmode()&&e.buttons&m.r3.PRIMARY&&(this.controlsEngaged=!0,this.onDrag(n,e.position,e.delta),this.controls.update(o.SI),this.controls.stop())})),e.registerHandler(y._R,(e=>{this.validateViewmode()&&this.controlsEngaged&&(e.timeSinceLastMove<100&&!(e.buttons&m.r3.PRIMARY)&&(this.onDrag(n,e.position,e.delta),this.controls.update(o.SI),this.controls.setLookAcceleration({x:0,y:0})),this.controlsEngaged=!1)})),e.registerHandler(b.e,(e=>{this.validateViewmode()&&this.onKey(e.key,e.state)}))}))}onUpdate(e){this.validateViewmode()&&this.controls.update(e)}onDrag(e,t,n){this.controls.setLookAcceleration(this.calcRotationAngle(e,t,n))}onKey(e,t){let n=null;const i=this.market.tryGetData(E.e);i&&(n=i.tryGetProperty(w,null)),this.lookAccelerationSpeed=n?n*(Math.PI/180)/60:this.lookAccelerationSpeed;const s=t===g.M.DOWN;switch(e){case f.R.LEFTARROW:case f.R.J:this.controls.setLookAcceleration({x:s?this.lookAccelerationSpeed:0},!0);break;case f.R.RIGHTARROW:case f.R.L:this.controls.setLookAcceleration({x:s?-this.lookAccelerationSpeed:0},!0);break;case f.R.K:this.controls.setLookAcceleration({y:s?-this.lookAccelerationSpeed:0},!0);break;case f.R.I:this.controls.setLookAcceleration({y:s?this.lookAccelerationSpeed:0},!0)}}validateViewmode(){const e=this.market.tryGetData(u.O),t=this.market.tryGetData(h.Z);return!e||!t||e.isInside()&&!t.isVR()}}},15019:(e,t,n)=>{"use strict";n.d(t,{z:()=>InstancedPinHeads});var i=n(99295),s=n(5477),r=n(2212),o=n(6244),a=n(45877);const l=new s.Z("InstancedPinHeads");class InstancedPinHeads extends r.InstancedMesh{constructor(e,t,n,s){const l=new r.PlaneBufferGeometry(a.l,a.l),c=new Float32Array(e),d=new r.InstancedBufferAttribute(c,1);l.setAttribute("instanceAlpha",d);super(l,s&&n?new o.Vp(t,n):new o.m0(t,!0),e),this.maxCount=e,this.opacityArray=c,this.opacityAttrib=d,this.setColorAt(0,new r.Color),this.renderedPins=[],this.renderOrder=i.z.pins}update(e){let t=0;this.renderedPins.length=0;for(const n of e)n.visible&&(t>=this.maxCount?l.error("Instance count is too small!"):(this.setMatrixAt(t,n.pinHeadMatrix),this.setColorAt(t,n.pinColor),this.opacityArray[t]=n.opacity*n.opacityAnimation.value,t++,this.renderedPins.push(n)));this.count=t,this.visible=this.count>0,this.instanceMatrix.needsUpdate=!0,this.opacityAttrib.needsUpdate=!0,this.instanceColor?this.instanceColor.needsUpdate=!0:l.error("Instance color should be defined")}}},13773:(e,t,n)=>{"use strict";n.d(t,{$:()=>PinHeadMesh});var i=n(85111),s=n(99295),r=n(2212),o=n(78261),a=n(74170),l=n(45877);class PinHeadMesh extends r.Mesh{constructor(e,t,n,i){super(t,n),this.geomScale=new r.Vector3(1,1,1),this.userData.sid=e,this.worldPosition=new r.Vector3,this.cameraPosition=new r.Vector3,this.layers.mask=i.mask,this.renderOrder=s.z.pins,this.scale.set(.01,.01,.01)}dispose(){this.material.dispose(),this.geometry.dispose()}updatePosition(e){this.position.copy(e.stemNormal).setLength(Math.max(e.stemLength,.01))}update(e,t,n){const s=l.Z.pinHeadMesh.scale;this.getWorldPosition(this.worldPosition);const c=e.getWorldPosition(this.cameraPosition).distanceTo(this.worldPosition);this.quaternion.copy(e.quaternion);const d=s.maxSize-(s.maxSize-s.minSize)*(0,o.C)(c,s.nearBound,s.farBound),u=this.worldPosition.clone().project(e),h=new r.Vector3(n.width/2,n.height/2,1).multiply(u),p=new r.Vector3(d/2,0,0).add(h),m=new r.Vector3(2/n.width,2/n.height,1).multiply(p).clone().unproject(e).clone().distanceTo(this.worldPosition)*(1+s.responsiveness/100*(t-1)),f=(0,a.uZ)(m,i.Z.epsilon,m);this.scale.set(f*this.geomScale.x,f*this.geomScale.y,f*this.geomScale.z)}}},6244:(e,t,n)=>{"use strict";n.d(t,{Vp:()=>InstancedPinHeadMaterial,uW:()=>InstancedPinStemMaterial,m0:()=>PinHeadCustomMaterial,Nv:()=>PinHeadMaterial,Dx:()=>PinSelectedMaterial,l0:()=>PinStemMaterial});var i=n(2212),s=n(45877);const r={pinHead:{uniforms:{alpha:{type:"f",value:1},color:{type:"c",value:new i.Color},bg:{type:"t",value:null},mask:{type:"t",value:null}},vertexShader:n(27662),fragmentShader:n(12944)},pinStem:{uniforms:{pinHeadMatrix:{value:new i.Matrix4},resolution:{value:new i.Vector2},alpha:{value:1}},vertexShader:n(43934),fragmentShader:n(6324)},pinSelected:{vertexShader:n(36257),fragmentShader:n(6182)}};class PinHeadMaterial extends i.RawShaderMaterial{constructor(e,t,n,s){const o=i.UniformsUtils.clone(r.pinHead.uniforms);o.bg.value=t,o.mask.value=n,o.color.value.copy(e),o.alpha.value=s,super({fragmentShader:r.pinHead.fragmentShader,vertexShader:r.pinHead.vertexShader,uniforms:o,name:"PinHeadMaterial",transparent:!0})}}class PinStemMaterial extends i.RawShaderMaterial{constructor(){const e=i.UniformsUtils.clone(r.pinStem.uniforms);super({fragmentShader:r.pinStem.fragmentShader,vertexShader:r.pinStem.vertexShader,uniforms:e,name:"PinStemMaterial",linewidth:s.Z.stem.width,opacity:s.Z.stem.opacity,transparent:s.Z.stem.transparent,alphaTest:s.Z.stem.opacity*s.Z.stem.alphaTest})}}class InstancedPinStemMaterial extends i.RawShaderMaterial{constructor(){const e=i.UniformsUtils.clone(r.pinStem.uniforms);super({defines:{INSTANCED:!0},fragmentShader:r.pinStem.fragmentShader,vertexShader:r.pinStem.vertexShader,uniforms:e,name:"InstancedPinStemMaterial",linewidth:s.Z.stem.width,opacity:s.Z.stem.opacity,transparent:s.Z.stem.transparent,alphaTest:s.Z.stem.opacity*s.Z.stem.alphaTest})}}class InstancedPinHeadMaterial extends i.RawShaderMaterial{constructor(e,t){const n=i.UniformsUtils.clone(r.pinHead.uniforms);n.bg.value=e,n.mask.value=t,super({defines:{INSTANCED:!0},fragmentShader:r.pinHead.fragmentShader,vertexShader:r.pinHead.vertexShader,uniforms:n,name:"InstancedPinHeadMaterial",transparent:!0})}}class PinHeadCustomMaterial extends i.RawShaderMaterial{constructor(e,t){super({defines:{INSTANCED:t},vertexShader:n(64656),fragmentShader:n(87686),uniforms:{alpha:{value:1},tDiffuse:{value:e}},name:"InstancedPinHeadCustomMaterial",transparent:!0})}}class PinSelectedMaterial extends i.RawShaderMaterial{constructor(){super({depthTest:!0,depthWrite:!1,transparent:!0,side:i.DoubleSide,vertexShader:r.pinSelected.vertexShader,fragmentShader:r.pinSelected.fragmentShader})}}},40825:(e,t,n)=>{"use strict";n.d(t,{B:()=>PinsViewData});var i=n(35424),s=n(67779),r=n(65143);class PinsViewData extends i.V{constructor(){super(),this.name="pins-view-data",this.pins=new Map,this.creatingPin=!1,this.pinEditorStateObservable=(0,s.Y)(r.V8.IDLE),this.selectedPinObservable=(0,s.Y)(null),this.focusedPinObservable=(0,s.Y)(null),this.editableObservable=(0,s.Y)(!0),this.progressObservable=(0,s.Y)(-1),this.screenPositionObservable=(0,s.Y)(null),this.canPlaceObservable=(0,s.Y)(!0),this.canAddObservable=(0,s.Y)(!0)}updatePin(e){this.pins.set(e.id,e)}getPin(e){return this.pins.get(e)}removePin(e){this.pins.get(e)&&this.pins.delete(e)}removePinsByType(e){this.pins.forEach(((t,n)=>{t.pinType===e&&this.pins.delete(t.id)}))}get creatingNewPin(){return this.creatingPin}updateSelectedPin(e){const t=this.selectedPin;if(t){const n=Object.assign(Object.assign({},t),e);this.updatePin(n),this.setSelectedPin(n)}}setSelectedPin(e){this.selectedPinObservable.value=e}get selectedPin(){return this.selectedPinObservable.value}onSelectedPinChanged(e){return this.selectedPinObservable.onChanged(e)}setFocusedPin(e){this.focusedPinObservable.value=e}get focusedPin(){return this.focusedPinObservable.value}onFocusedPinChanged(e){return this.focusedPinObservable.onChanged(e)}setPinEditorState(e){switch(e){case r.V8.IDLE:this.creatingPin=!1;break;case r.V8.CREATING:this.creatingPin=!0}this.pinEditorStateObservable.value=e}get pinEditorState(){return this.pinEditorStateObservable.value}onPinEditorStateChanged(e){return this.pinEditorStateObservable.onChanged(e)}setProgress(e){this.progressObservable.value=e}get progress(){return this.progressObservable.value}onProgressChanged(e){const t=this.progressObservable.onChanged(e);return t.renew(),t}get screenPosition(){return this.screenPositionObservable.value}setScreenPosition(e){this.screenPositionObservable.value=e}onScreenPositionChanged(e){return this.screenPositionObservable.onChanged(e)}get isPinEditable(){return this.editableObservable.value}setEditablePin(e){this.editableObservable.value=e}onPinEditableChanged(e){return this.editableObservable.onChanged(e)}get canAdd(){return this.canAddObservable.value}setCanAdd(e){this.canAddObservable.value=e}onCanAddChanged(e){return this.canAddObservable.onChanged(e)}get canPlace(){return this.canPlaceObservable.value}setCanPlace(e){this.canPlaceObservable.value=e}onCanPlaceChanged(e){return this.canPlaceObservable.onChanged(e)}}},99380:(e,t,n)=>{"use strict";n.d(t,{Ki:()=>EnablePinCreationCommand,Ar:()=>SelectPinCommand,RH:()=>UnselectPinCommand,fM:()=>CreatePinCommand,tT:()=>CancelNewPinCommand,OL:()=>RemovePinCommand,zM:()=>RemovePinsByTypeCommand,mE:()=>UpdatePinViewsCommand,tE:()=>UpdatePinCommand,ik:()=>ChangePinVisibilityCommand,qN:()=>ChangePinVisibilityByTypeCommand,_Y:()=>ChangePinOpacityCommand,kb:()=>ChangePinOpacityByTypeCommand,yR:()=>ClickOffPinCommand,ip:()=>PlacePinCommand,I$:()=>MovePinCommand});var i=n(93037);class EnablePinCreationCommand extends i.m{constructor(e){super(),this.payload={enabled:e}}}class SelectPinCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,pinType:t,editable:n}}}class UnselectPinCommand extends i.m{constructor(e,t){super(),this.payload={id:e,pinType:t}}}class CreatePinCommand extends i.m{constructor(e,t,n,i,s){super(),this.payload={id:e,pin:t,pinType:n,backgroundTexture:i,maskTexture:s}}}class CancelNewPinCommand extends i.m{constructor(e,t){super(),this.payload={id:e,pinType:t}}}class RemovePinCommand extends i.m{constructor(e,t){super(),this.payload={id:e,pinType:t}}}class RemovePinsByTypeCommand extends i.m{constructor(e){super(),this.payload={pinType:e}}}class UpdatePinViewsCommand extends i.m{constructor(e){super(),this.payload={pinViews:e}}}class UpdatePinCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,pinType:t,properties:n}}}class ChangePinVisibilityCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,pinType:t,visible:n}}}class ChangePinVisibilityByTypeCommand extends i.m{constructor(e,t){super(),this.payload={pinType:e,visible:t}}}class ChangePinOpacityCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,pinType:t,opacity:n}}}class ChangePinOpacityByTypeCommand extends i.m{constructor(e,t,n=[]){super(),this.payload={pinType:e,opacity:t,skipIds:n}}}class ClickOffPinCommand extends i.m{constructor(){super()}}class PlacePinCommand extends i.m{constructor(){super()}}class MovePinCommand extends i.m{constructor(e,t,n){super(),this.payload={id:e,pos:t,previousPos:n}}}},65143:(e,t,n)=>{"use strict";var i,s,r,o;n.d(t,{Er:()=>i,K_:()=>s,V8:()=>r,Od:()=>o}),function(e){e.MATTERTAG="mattertag",e.NOTE="note",e.OBJECT="object"}(i||(i={})),function(e){e.DEFAULT="default",e.HIGHLIGHTED="highlighted",e.DIMMED="dimmed"}(s||(s={})),function(e){e.IDLE="idle",e.CREATING="creating",e.PRESSING="pressing",e.PLACING="placing",e.PLACED="placed"}(r||(r={})),function(e){e.UP="up",e.UP_LEFT="up-left",e.UP_RIGHT="up-right",e.DOWN="down",e.DOWN_LEFT="down-left",e.DOWN_RIGHT="down-right",e.LEFT="left",e.RIGHT="right"}(o||(o={}))},57183:(e,t,n)=>{"use strict";n.d(t,{tP:()=>PinHoverChangeMessage,F7:()=>PinClickedMessage,b0:()=>PinPlacedMessage,cd:()=>NewPinReadyMessage,pe:()=>PinPlacementCancelledMessage,bV:()=>PinMovedMessage,WM:()=>PinUnselectedMessage,hu:()=>PinAddCancelledMessage,Q4:()=>PinSelectedMessage});var i=n(4117);class PinHoverChangeMessage extends i.v{constructor(e,t,n){super(),this.id=e,this.hovering=t,this.pinType=n}}class PinClickedMessage extends i.v{constructor(e,t){super(),this.id=e,this.pinType=t}}class PinPlacedMessage extends i.v{constructor(e,t,n){super(),this.id=e,this.pinType=t,this.pinPos=n}}class NewPinReadyMessage extends i.v{}class PinPlacementCancelledMessage extends i.v{}class PinMovedMessage extends i.v{constructor(e,t,n,i){super(),this.id=e,this.pinType=t,this.pinPos=n,this.previousPos=i}}class PinUnselectedMessage extends i.v{constructor(e,t){super(),this.id=e,this.pinType=t}}class PinAddCancelledMessage extends i.v{constructor(e,t){super(),this.id=e,this.pinType=t}}class PinSelectedMessage extends i.v{constructor(e,t){super(),this.id=e,this.pinType=t}}},45877:(e,t,n)=>{"use strict";n.d(t,{l:()=>i,Z:()=>s});const i=1,s=Object.freeze({anchor:{size:.1},stem:{length:.23,width:1,opacity:1,transparent:!0,color:"white",alphaTest:.05},pinHeadMesh:{scale:{nearBound:1.5,farBound:4.8,maxSize:80,minSize:40,baseViewportSize:800,responsiveness:100}}})},20253:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>PreRendererModule});var i,s=n(57227),r=n(14877),o=n(53549),a=n(53491),l=n(97739),c=n(81402);!function(e){e[e.None=0]="None",e[e.Queued=1]="Queued",e[e.Rendering=2]="Rendering",e[e.Rendered=3]="Rendered"}(i||(i={}));class PreRenderer{constructor(e){this.statusMap={},this.active=[],this.queued=[],this.panoRenderer=e,this.disablePreRendering()}init(){}dispose(){}activate(e){}deactivate(e){this.disablePreRendering()}enablePreRendering(){this.enabled=!0}disablePreRendering(){this.enabled=!1}render(){}beforeRender(){this.enabled&&this.processQueued()}tryPreRender(e){return this.getPreRenderState(e)===i.None&&(this.queued.push(e),this.statusMap[e]=i.Queued,!0)}getPreRenderState(e){const t=this.statusMap[e];return void 0!==t?t:i.None}processQueued(){let e=0;for(const t of Object.keys(this.statusMap))this.statusMap[t]===i.Rendering&&e++;if(0===e&&this.queued.length>0){const e=this.queued.shift();if(e){this.active.push(e),this.statusMap[e]=i.Rendering;this.panoRenderer.activateSweep(e).then((()=>{this.onRendered(e)}))}}}cleanup(e=[]){const t=(0,c.ow)(e),n=[];for(const e of this.queued)t[e]?n.push(e):this.statusMap[e]=i.None;this.queued.length=0,this.queued.push.apply(this.queued,n);const s=[];for(const e of this.active)t[e]?s.push(e):this.statusMap[e]=i.None;this.active.length=0,this.active.push.apply(this.active,s)}onRendered(e){this.statusMap[e]=i.Rendered}}var d=n(87100);const u=Object.freeze({prerender:{preRenderTourPanos:(0,d.eY)("pre",1)}});class PreRendererModule extends s.Y{constructor(){super(...arguments),this.name="prerenderer-module",this.lastPrerendered=null}async init(e,t){if(u.prerender.preRenderTourPanos||e.preRenderTourPanos){this.sweepData=await t.market.waitForData(o.Z);const e=await t.getModuleBySymbol(r.y.SWEEP_PANO);this.panoRenderer=e.getRenderer(),this.preRenderer=new PreRenderer(this.panoRenderer),t.addComponent(this,this.preRenderer),this.bindings.push(t.subscribe(a.Z,(e=>{this.preRenderer.enablePreRendering(),this.lastPrerendered=null,e.sweepIds&&e.sweepIds.length>=3&&(this.lastPrerendered=e.sweepIds[2],this.preRenderer.tryPreRender(this.lastPrerendered)),this.cleanup(this.sweepData),this.currentRestrictedSweeps=e.sweepIds}))),this.bindings.push(t.subscribe(l.Z,(e=>{this.preRenderer.disablePreRendering(),this.cleanup(this.sweepData,!0),this.currentRestrictedSweeps=null})))}}getCurrentSweeps(){return this.currentRestrictedSweeps||[]}cleanup(e,t=!1){const n=[];e.transition.active?(e.transition.from&&n.push(e.transition.from),e.transition.to&&n.push(e.transition.to)):e.currentSweep&&n.push(e.currentSweep),this.lastPrerendered&&n.push(this.lastPrerendered),t&&this.panoRenderer.freeAllTextures(n),this.preRenderer.cleanup(n)}}},43402:(e,t,n)=>{"use strict";n.d(t,{n:()=>Snapcaster,x:()=>SurfaceEdgeFinderCompleteMessage});var i=n(69910),s=n(2212);class LegacyThreeGeometry{constructor(){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[],[]],this.boundingBox=null,this.boundingSphere=null}}class Face3{constructor(e,t,n,i,r,o=0){this.a=e,this.b=t,this.c=n,this.materialIndex=o,this.a=e,this.b=t,this.c=n,this.normal=i&&!Array.isArray(i)&&i.isVector3?i:new s.Vector3,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&!Array.isArray(r)&&r.isColor?r:new s.Color,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=o}clone(){return new Face3(this.a,this.b,this.c,this.normal,this.color).copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}}var r=n(5477),o=n(994);const a=new r.Z("surface-edge-finder"),l=new s.Triangle,c=["a","b","c"];class Face extends Face3{constructor(e,t,n,i){super(e.a,e.b,e.c,e.normal),this.va=t,this.vb=n,this.vc=i,this.area=l.set(this.va.vector,this.vb.vector,this.vc.vector).getArea(),this.midpoint=l.getMidpoint(new s.Vector3),this.vertices=[this.va,this.vb,this.vc],t.faces.push(this),n.faces.push(this),i.faces.push(this)}}class Vertex{constructor(e){this.vector=e,this.faces=[]}}class Surface{constructor(){this.area=0,this.normal=new s.Vector3,this.midpoint=new s.Vector3,this.faces=[],this.normalSum=new s.Vector3,this.midpointSum=new s.Vector3}add(e){e.surface&&e.surface.remove(e),this.faces.push(e),this.area+=e.area,this.midpointSum.add(e.midpoint),this.normalSum.add(e.normal),this.recalcFromSums(),e.surface=this}remove(e){e.surface&&(this.faces.splice(this.faces.indexOf(e),1),this.area-=e.area,this.midpointSum.sub(e.midpoint),this.normalSum.sub(e.normal),this.recalcFromSums()),e.surface=null}recalcFromSums(){this.normal.copy(this.normalSum).normalize(),this.midpoint.copy(this.midpointSum).divideScalar(this.faces.length)}mergeSurfaces(e){for(const t of e.faces)t.surface=this,this.faces.push(t);this.area+=e.area,this.normalSum.add(e.normalSum),this.midpointSum.add(e.midpointSum),this.recalcFromSums(),e.faces=[],e.area=0,e.normal.set(0,0,0),e.normalSum.set(0,0,0),e.midpointSum.set(0,0,0),e.midpoint.set(0,0,0)}getEdges(){const e={},t={};for(const t of this.faces)for(let n=0;n<3;n++){const i=t[c[n]],s=t[c[(n+1)%3]],r=Math.min(i,s)+","+Math.max(i,s);if(void 0===e[r]){const t={edge1:i,edge2:s,isEdge:!0};e[r]=t}else e[r].isEdge=!1}for(const{edge1:n,edge2:i,isEdge:s}of Object.values(e))s&&(t[n]||(t[n]=[]),t[n].push(i),t[i]||(t[i]=[]),t[i].push(n));return t}getCircularPaths(e){const t=this.getEdges(),n=new Set,i=[],s=Object.keys(t).map((e=>parseInt(e,10)));let r;for(;r=s.pop();){const s=[];for(;r;){let i;s.push(e[r]);let o=0;for(const s of t[r]){const t=Math.min(r,s)+","+Math.max(r,s);if(n.has(t))continue;const a=e[r].vector.distanceToSquared(this.midpoint);(void 0===i||a>o)&&(i=s,o=a)}if(!i)break;{const e=Math.min(r,i)+","+Math.max(r,i);n.add(e),r=i}}s.length>2&&i.push(s)}return i}}class SurfaceEdgeFinder{constructor(){this.surfaces=new Set,this.lines=[],this.points=[]}*run(e,t=[1,5,10],n=.2,r=.01,l=20){const c=function(e){const t=new LegacyThreeGeometry,n=null!==e.index?e.index:void 0,i=e.attributes;if(void 0===i.position)throw Error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion.");const r=i.position,o=i.normal,a=i.color,l=i.uv,c=i.uv2;void 0!==c&&(t.faceVertexUvs[1]=[]);for(let e=0;e<r.count;e++)t.vertices.push((new s.Vector3).fromBufferAttribute(r,e)),void 0!==a&&t.colors.push((new s.Color).fromBufferAttribute(a,e));function d(e,n,i,r=0){const d=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[i].clone()],u=void 0===o?[]:[(new s.Vector3).fromBufferAttribute(o,e),(new s.Vector3).fromBufferAttribute(o,n),(new s.Vector3).fromBufferAttribute(o,i)],h=new Face3(e,n,i,u,d,r);t.faces.push(h),void 0!==l&&t.faceVertexUvs[0].push((new s.Vector2).fromBufferAttribute(l,e),(new s.Vector2).fromBufferAttribute(l,n),(new s.Vector2).fromBufferAttribute(l,i)),void 0!==c&&t.faceVertexUvs[1].push((new s.Vector2).fromBufferAttribute(c,e),(new s.Vector2).fromBufferAttribute(c,n),(new s.Vector2).fromBufferAttribute(c,i))}const u=e.groups;if(u.length>0)for(let e=0;e<u.length;e++){const t=u[e],i=t.start;for(let e=i,s=i+t.count;e<s;e+=3)void 0!==n?d(n.getX(e),n.getX(e+1),n.getX(e+2),t.materialIndex):d(e,e+1,e+2,t.materialIndex)}else if(void 0!==n)for(let e=0;e<n.count;e+=3)d(n.getX(e),n.getX(e+1),n.getX(e+2));else for(let e=0;e<r.count;e+=3)d(e,e+1,e+2);return t}(e),d=c.vertices.map((e=>new Vertex(e))),u=[];for(const e of c.faces)u.push(new Face(e,d[e.a],d[e.b],d[e.c])),yield;for(let e=0,t=u.length;e<t;e++){const t=u[e];(new Surface).add(t)}for(const e of t)yield*this.mergeSurfacesByNormal(u,e);for(const e of u)this.surfaces.add(e.surface);let h=0;const p=[];for(const e of this.surfaces){if(e.area<=n)continue;const t=e.getCircularPaths(d);for(const e of t)this.cullPath(e,((e,t)=>{if(e.length()<r||t.length()<r)return h++,!1;const n=e.angleTo(t)*o.MN;return!(n<l||n>180-l)||(h++,!1)})),e.length>2&&p.push(e);yield}a.debug(`Culled ${h} path points`);const m=new Set,f=new Set,g=e=>`${e.x.toFixed(3)},${e.y.toFixed(3)},${e.z.toFixed(3)}`,v=e=>`${g(e.start)}:${g(e.end)}`,y=e=>`${g(e.end)}:${g(e.start)}`;for(const e of p)for(let t=0;t<e.length;t++){const n=e[t].vector,s=e[(t+1)%e.length].vector,r=new i.FM(n,s),o=v(r),a=y(r),l=g(n);f.has(o)||f.has(a)||(f.add(o),f.add(a),this.lines.push(r)),m.has(l)||(m.add(l),this.points.push(new i.UQ(n)))}yield}cullPath(e,t){const n=new s.Vector3,i=new s.Vector3;let r=!0;for(;r;){r=!1;for(let s=0;s<e.length&&e.length>2;s++){const o=e[0===s?e.length-1:s-1].vector,a=e[s].vector,l=e[(s+1)%e.length].vector;n.copy(o).sub(a),i.copy(l).sub(a),t(n,i)||(e.splice(s,1),r=!0,s--)}}}*mergeSurfacesByNormal(e,t,n=5){let i=-1,s=0;for(;0!==i&&s++<n;){a.debug(`Merging surfaces by normal angle threshold: ${t}`);const n=Math.cos(o.Ue*t);i=0;let s=0;for(const t of e){s++%1e3==0&&(yield);for(const e of t.vertices)for(const s of e.faces){const e=s.surface;t.surface!==e&&t.surface.normal.dot(e.normal)>=n&&(t.surface.faces.length>e.faces.length?t.surface.mergeSurfaces(e):e.mergeSurfaces(t.surface),i++)}}i&&a.debug(`Merged ${i} surfaces by normal...`)}}}var d=n(78767),u=n(19945),h=n(4117);const p=new r.Z("snapcaster");var m;!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.WORKING=1]="WORKING",e[e.READY=2]="READY"}(m||(m={}));class Snapcaster{constructor(e,t){this.cameraData=e,this.engine=t,this.meshes=new Map,this.newMeshes=new Set,this.raycaster=new s.Raycaster,this.filterSnapFeature=e=>{var t,n;const{meshName:i}=e;return!i||!1!==(null===(n=null===(t=this.meshes.get(i))||void 0===t?void 0:t.filter)||void 0===n?void 0:n.call(t,e))},this.cast=(e,t,n,r)=>{let o;n&&r&&(o=(new s.Plane).setFromNormalAndCoplanarPoint(r,n)),this.raycaster.set(e.origin,e.direction);const a=this.snappingOctree.raycast(this.raycaster,t,this.filterSnapFeature)||[],l=e=>{let t=(1+e.distance)*(1+e.distanceToRay)**2;return e.object instanceof i.UQ&&(t/=10),o&&o.distanceToPoint(e.point)<-.2&&(t+=10),t};return a.sort(((e,t)=>l(e)-l(t))),a},this.add=(...e)=>{for(const t of e)this.snappingOctree.add(t)},this.remove=(...e)=>{for(const t of e)this.snappingOctree.remove(t)}}get snappingOctree(){return this.preloadMeshSnapping(),this._snappingOctree}setupOctree(e){this._snappingOctree=new i.ZP(e)}async preloadMeshSnapping(){var e;!this.populateProcess&&this.newMeshes.size&&(this.populateProcess=await this.engine.commandBinder.issueCommand(new d.S("snapping",this.buildSnappingForMeshes(),6e4)),await(null===(e=this.populateProcess)||void 0===e?void 0:e.promise),this.populateProcess=null)}*buildSnappingForMeshes(){const e=new s.Vector3;for(;;){let t=null;for(const n of this.newMeshes){const i=this.meshes.get(n);if(i){const{geometry:s}=i;if(!s){p.error("No mesh to generate snapping information from!"),i.status=m.READY;continue}const r=(0,u.A5)(s).getCenter(e).distanceTo(this.cameraData.pose.position);(!t||r<t.distance)&&(t={meshName:n,geometry:s,distance:r,info:i})}}if(!t)break;this.newMeshes.delete(t.meshName),t.info.status=m.WORKING,yield*this.buildSnappingForGeometry(t.geometry,t.info),t.info.status=m.READY,t.info.geometry=null,yield}p.info(`Snapping found ${this._snappingOctree.pointCount} points and ${this._snappingOctree.lineCount} lines`)}*buildSnappingForGeometry(e,t){e.computeVertexNormals(),yield;const n=new SurfaceEdgeFinder;yield*n.run(e),p.debug(`Mesh done, added ${n.points.length} points and ${n.lines.length} lines`);for(const e of n.points)e.meshName=t.meshName,e.meta=t.meta,this._snappingOctree.add(e);for(const e of n.lines)e.meshName=t.meshName,e.meta=t.meta,this._snappingOctree.add(e);this.engine.broadcast(new SurfaceEdgeFinderCompleteMessage(n))}forEachSnapFeature(e,t=!1){this.snappingOctree.traverse((n=>{t&&!this.filterSnapFeature(n)||e(n)}))}addMeshGeometry(e,t,n,i){this.meshes.has(e)||(this.meshes.set(e,{meshName:e,geometry:t,status:m.UNINITIALIZED,meta:n,filter:i}),this.newMeshes.add(e))}removeMeshGeometry(e){const t=this.meshes.get(e);t&&t.status===m.UNINITIALIZED&&(this.meshes.delete(e),this.newMeshes.delete(e))}}class SurfaceEdgeFinderCompleteMessage extends h.v{constructor(e){super(),this.edgeFinder=e}}},368:(e,t,n)=>{"use strict";n.d(t,{P:()=>RaycasterData,E:()=>RaycastHit});var i=n(2212),s=n(35424);class RaycasterData extends s.V{constructor(){super(...arguments),this.name="pointer",this.hit=null,this.hits=[],this.pointerNdcPosition=new i.Vector2,this.pointerScreenPosition=new i.Vector2,this.pointerOrigin=new i.Vector3,this.pointerDirection=new i.Vector3,this.pointerRay=new i.Ray}}class RaycastHit{constructor(e,t,n,i){this.point=e,this.normal=t,this.object=n,this.intersection=i,this.face={normal:t}}}},26758:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>RaycasterModule});var i=n(57227),s=n(14877),r=n(2212),o=n(63387),a=n(19945);class ColliderNode{constructor(){this.parent=null,this.raycastDistance=1/0,this.distance=1/0}updateRaycastDistance(e){this.raycastDistance=this.bounds.distanceToPoint(e)}updateDistanceToBounds(e){this.distance=this.bounds.distanceToPoint(e)}}class ColliderMeshTarget extends ColliderNode{constructor(e){super(),this.mesh=e,this.bounds=(0,a.A5)(this.mesh.geometry).clone().applyMatrix4(this.mesh.matrixWorld),this.center=this.bounds.getCenter(new r.Vector3)}raycast(e,t){this.mesh.visible&&this.mesh.raycast(e,t)}nearestPointOnGeometry(e){const t=e.clone().applyMatrix4((new r.Matrix4).copy(this.mesh.matrixWorld).invert());let n;const i=this.mesh.geometry.boundsTree;return n=i?i.closestPointToPoint(t):(0,a.GO)(this.mesh.geometry,t),n?(n.point.applyMatrix4(this.mesh.matrixWorld),{object:this.mesh,point:n.point,distance:n.point.distanceTo(e),faceIndex:n.faceIndex}):null}}class ColliderOctreeNode extends ColliderNode{constructor(e,t,n){super(),this.level=t,this.leafMinSize=n,this.childNodes=[],this.children=[],this.listeners={},this.bounds=e.clone(),this.size=e.getSize(new r.Vector3),this.center=e.getCenter(new r.Vector3)}get depth(){return this.level}*addMeshes(e){e.updateMatrixWorld(!0);const t=[];e.traverse((e=>{e instanceof r.Mesh&&e.geometry&&t.push(e)}));for(const e of t)this.addMesh(new ColliderMeshTarget(e))}removeMeshes(e){let t=!1;for(let n=0;n<this.children.length;n++){const i=this.children[n];i instanceof ColliderMeshTarget&&i.mesh.id===e.id&&(i.parent=null,this.children.splice(n,1),this.emit("removed",this,i),t=!0)}if(!t)throw new Error("Mesh that is being attempted removed does not exist in this node.")}addMesh(e){let t=!1;if(this.size.length()>this.leafMinSize){0===this.childNodes.length&&this.buildChildNodes();for(const n of this.childNodes)n.bounds.containsBox(e.bounds)&&(t=!0,n.addMesh(e))}t||this.add(e)}add(e){if(e.parent)throw new Error("ColliderNode already has a parent, remove before trying to add in another node");e.parent=this,this.children.push(e),this.emit("added",this,e)}buildChildNodes(){const e=this.size.multiplyScalar(.5);for(let t=0;t<2;t++)for(let n=0;n<2;n++)for(let i=0;i<2;i++){const s=this.bounds.min.x+e.x*i,o=s+e.x,a=this.bounds.min.y+e.y*t,l=a+e.y,c=this.bounds.min.z+e.z*n,d=c+e.z,u=new r.Box3(new r.Vector3(s,a,c),new r.Vector3(o,l,d)),h=new ColliderOctreeNode(u,this.level+1,this.leafMinSize);this.childNodes.push(h),this.add(h)}}raycast(e,t){if(!0===e.ray.intersectsBox(this.bounds))for(const n of this.children)n.raycast(e,t)}pick(e,t,n){if(!e.ray.intersectsBox(this.bounds))return t;for(const t of this.children)t.updateRaycastDistance(e.ray.origin);this.children.sort(((e,t)=>e.raycastDistance-t.raycastDistance));for(const i of this.children){if(t&&t.distance<i.raycastDistance)break;if(n(i))if(i instanceof ColliderOctreeNode)t=i.pick(e,t,n);else{const n=[];i.raycast(e,n);for(const e of n)(!t||t.distance>e.distance)&&(t=e)}}return t}nearestTo(e,t,n=null){for(const t of this.children)t.updateDistanceToBounds(e);this.children.sort(((e,t)=>e.distance-t.distance));for(const i of this.children){if(0!==i.distance&&n&&n.distance<i.distance)break;if(t(i))if(i instanceof ColliderOctreeNode)n=i.nearestTo(e,t,n);else if(i instanceof ColliderMeshTarget){const t=i.nearestPointOnGeometry(e);if(t){(!n||n.distance>t.distance)&&(n=t)}}}return n}getAllBounds(e,t=0,n=1/0,i=!1){for(const s of this.children)this.level>=t&&this.level<=n&&(i||e.push(s.bounds.clone())),s instanceof ColliderOctreeNode&&s.getAllBounds(e,t,n,i)}emit(e,...t){const n=this.listeners[e]||[];for(const e of n)e(...t);this.parent&&this.parent.emit(e,...t)}on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}}class OctreeCollider{constructor(e,t){this.meshToNodes={},this._depth=0;const n=(0,o.rj)(e);this.root=new ColliderOctreeNode(n,0,t),this.root.on("added",((e,t)=>{e.depth>this._depth&&(this._depth=e.depth),t instanceof ColliderMeshTarget&&(this.meshToNodes[t.mesh.id]||(this.meshToNodes[t.mesh.id]=[]),this.meshToNodes[t.mesh.id].push(t))})),this.root.on("removed",((e,t)=>{if(t instanceof ColliderMeshTarget){const e=this.meshToNodes[t.mesh.id];for(let n=0;n<e.length;n++)e[n]===t&&e.splice(n,1)}}))}get depth(){return this._depth}*addMeshesAsync(e){yield*this.root.addMeshes(e)}addMeshes(e){for(const t of this.root.addMeshes(e));}removeMeshes(e){e.traverse((e=>{const t=this.meshToNodes[e.id]||[];for(const n of t)n.parent&&n.parent.removeMeshes(e)}))}raycast(e){const t=[];return this.root.raycast(e,t),t}getAllBounds(e=0,t=1/0,n=!1){const i=[];return this.root.getAllBounds(i,e,t,n),i}pick(e,t){const n=e.firstHitOnly;e.firstHitOnly=!0;const i=this.root.pick(e,null,(e=>!(t&&e instanceof ColliderMeshTarget)||t(e.mesh)));return e.firstHitOnly=n,i}nearestMeshTo(e,t){const n=this.root.bounds.clampPoint(e,new r.Vector3);return this.root.nearestTo(n,(e=>!(t&&e instanceof ColliderMeshTarget)||t(e.mesh)))}getDebugBoundsMesh(e=16777215,t=0,n=1/0,i=!1){const s=this.getAllBounds(t,n,i),o=new r.LineBasicMaterial({color:e});if(s.length>0){const e=[];for(const t of s){const n=new r.Box3Helper(t);n.updateMatrixWorld(!0),n.geometry.applyMatrix4(n.matrixWorld),e.push(n.geometry)}const t=(0,a.qf)(e);return new r.LineSegments(t,o)}return new r.LineSegments(new r.BufferGeometry,o)}}class Raycaster{constructor(e,t){this.camera=e,this.defaultRaycastFilter=t,this.meshes={},this.octreeEnabledMeshes={},this.meshFilters=new Map,this.raycaster=new r.Raycaster,this.prevRay=new r.Ray,this._hitCache=[],this.getOctree=()=>this.octree}init(){this.raycaster=new r.Raycaster,this.raycaster.camera=this.camera,this.raycaster.params.Line&&(this.raycaster.params.Line.threshold=.1)}dispose(){this._hitCache.length=0,this.meshes={}}cast(e,t,n){if(e&&t&&(this.prevRay.copy(this.raycaster.ray),this.raycaster.set(e,t)),!n&&this.prevRay.equals(this.raycaster.ray))return this._hitCache;if(this.raycaster.layers.mask=this.camera.layers.mask,this._hitCache.length=0,this.octree){const e=this.getRaycastFilter(l.OctreeMeshes,n),t=this.octree.pick(this.raycaster,e);t&&this._hitCache.push(t)}const i=this.getRaycastFilter(l.DynamicMeshes,n);for(const e in this.meshes){const t=this.meshes[e];if(i(t)){const e=this.raycaster.intersectObject(t,!0);this._hitCache=this._hitCache.concat(e)}}return this._hitCache.sort(this.sortIntersectionsByDistance),this.prevRay.copy(this.raycaster.ray),this._hitCache}pick(e,t,n){this.raycaster.set(e,t);const i=this.getRaycastFilter(l.OctreeMeshes,n);return this.octree.pick(this.raycaster,i)}nearest(e,t){return this.octree.nearestMeshTo(e,this.getRaycastFilter(l.OctreeMeshes,t))}setupOctree(e){this.octree=new OctreeCollider(e,.5);for(const e of Object.keys(this.meshes))if(this.octreeEnabledMeshes[e]){const t=this.meshes[e];this.octree.addMeshes(t)}return this.octree}addTarget(e,t,n){const i=e,s=i.collider?i.collider:e;this.meshes[e.id]=s,n&&this.meshFilters.set(s,n),this.octreeEnabledMeshes[e.id]=t,this.octree&&t&&(this.octree.addMeshes(e),e.traverse((e=>{e instanceof r.Mesh&&(this.octreeEnabledMeshes[e.id]=t,n&&this.meshFilters.set(e,n))})))}removeTarget(e){this.octree&&this.octreeEnabledMeshes[e.id]&&(this.octree.removeMeshes(e),this.octreeEnabledMeshes[e.id]=!1,e.traverse((e=>{e instanceof r.Mesh&&(this.octreeEnabledMeshes[e.id]=!1,this.meshFilters.delete(e))})));const t=this.meshes[e.id];t&&(this.meshFilters.delete(t),delete this.meshes[e.id])}getRaycastFilter(e,t){const n=t||this.defaultRaycastFilter,i=t=>{const n=this.octreeEnabledMeshes[t.id];switch(e){case l.DynamicMeshes:return!n;case l.OctreeMeshes:return n}};return e=>i(e)&&n(e)&&this.checkMeshSpecificFilter(e)}checkMeshSpecificFilter(e){const t=this.meshFilters.get(e);return!t||t(e)}sortIntersectionsByDistance(e,t){return e.distance>t.distance?1:e.distance<t.distance?-1:0}render(){}activate(){}deactivate(){}}var l;!function(e){e[e.OctreeMeshes=0]="OctreeMeshes",e[e.DynamicMeshes=1]="DynamicMeshes"}(l||(l={}));var c=n(368),d=n(43402),u=n(7692);class RaycastPointerScreen{constructor(e,t){this.raycaster=e,this.cameraData=t,this.lastHits=[],this.lastRay=new r.Ray(new r.Vector3(1,1,1),new r.Vector3(0,1,0)),this.currentRay=new r.Ray,this.pointer=new r.Vector2(-2,-2),this.origin=new r.Vector3,this.direction=new r.Vector3,this.cast=e=>{const t=this.pointerRay;return!e&&this.lastRay.equals(t)||(this.lastHits=this.raycaster.cast(t.origin,t.direction,e).slice(),this.lastRay.copy(t)),this.lastHits},this.updatePointer=e=>{this.pointer.distanceToSquared(e)>2e-5&&this.pointer.set(e.x,e.y)}}get pointerRay(){const{origin:e,direction:t}=this.updateDirections();return this.currentRay.set(e,t)}get ndcPosition(){return this.pointer}updateDirections(){return(0,u.Kh)(this.cameraData.pose,this.origin.set(this.pointer.x,this.pointer.y,-1),this.origin),(0,u.Kh)(this.cameraData.pose,this.direction.set(this.pointer.x,this.pointer.y,1),this.direction),this.direction.sub(this.origin).normalize(),{origin:this.origin,direction:this.direction}}}class RaycastPointerDataUpdate{constructor(e,t,n){this.raycaster=e,this.data=t,this.cameraData=n,this.cache={normal4:new r.Vector4,normal:new r.Vector3,rotationMatrix:new r.Matrix4,ndc3:new r.Vector3}}beforeRender(){if(this.raycaster.pointer.pointerRay.equals(this.data.pointerRay))return;this.data.pointerRay.copy(this.raycaster.pointer.pointerRay),this.data.pointerOrigin.copy(this.data.pointerRay.origin),this.data.pointerDirection.copy(this.data.pointerRay.direction);const e=this.raycaster.pointer.cast();if(this.data.hits.length=0,this.data.hits.push(...e),this.data.pointerNdcPosition.copy(this.raycaster.pointer.ndcPosition),this.cache.ndc3.set(this.data.pointerNdcPosition.x,this.data.pointerNdcPosition.y,.5),this.data.pointerScreenPosition.copy((0,u.fi)(this.cameraData.width,this.cameraData.height,this.cache.ndc3)),e.length>0){const t=e[0];if(t&&t.face){const e=t.face.normal;this.cache.normal4.set(e.x,e.y,e.z,0),this.cache.rotationMatrix.extractRotation(t.object.matrixWorld),this.cache.normal4.applyMatrix4(this.cache.rotationMatrix),this.cache.normal.set(this.cache.normal4.x,this.cache.normal4.y,this.cache.normal4.z),this.data.hit=new c.E(t.point.clone(),this.cache.normal.clone(),t.object,t)}}else this.data.hit=null;this.data.commit()}init(){}render(){}dispose(){}activate(){}deactivate(){}}var h=n(15099),p=n(43816),m=n(69524),f=n(14547);class RaycasterModule extends i.Y{constructor(){super(...arguments),this.name="raycaster",this.raycasterPointerData=new c.P,this.overridePointer=null,this.setOverridePointer=e=>{this.overridePointer=e}}async init(e,t){t.market.register(this,c.P,this.raycasterPointerData);const[n,i]=await Promise.all([t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.market.waitForData(h.M_)]),r=n.getCamera();this.raycaster=new Raycaster(r,p.Nr),t.addComponent(this,this.raycaster),this.defaultPointer=new RaycastPointerScreen(this.raycaster,i),this.snapcaster=new d.n(i,t);const o=new RaycastPointerDataUpdate(this,this.raycasterPointerData,i);t.addComponent(this,o),t.broadcast(new m.em(f.Y.Raycaster)),t.broadcast(new m.em(f.Y.Octree)),t.broadcast(new m.em(f.Y.Snapping))}dispose(){}setupOctree(e){this.raycaster.setupOctree(e),this.snapcaster.setupOctree(e)}getOctree(){return this.raycaster.getOctree()}get pointer(){return null!==this.overridePointer?this.overridePointer:this.defaultPointer}get targets(){return this.raycaster}get picking(){return this.raycaster}get snapping(){return this.snapcaster}}},93093:(e,t,n)=>{"use strict";n.d(t,{oM:()=>RequestRenderTargetCommand,sH:()=>Context2dCaptureCommand,vU:()=>ScreenCaptureCommand,sp:()=>RenderToCubemapCommand,fZ:()=>EquirectangularCommand,ep:()=>ComposeTargetsCommand});var i=n(93037);class RequestRenderTargetCommand extends i.m{constructor(){super(...arguments),this.id="RequestRenderTargetCommand"}}class Context2dCaptureCommand extends i.m{constructor(e,t){super(),this.payload={renderTarget:e,context:t}}}class ScreenCaptureCommand extends i.m{constructor(e,t,n){super(),this.payload={renderTarget:e,sceneObject:t,camera:n}}}class RenderToCubemapCommand extends i.m{constructor(e,t,n){super(),this.payload={renderTarget:e,sceneObject:t,camera:n}}}class EquirectangularCommand extends i.m{constructor(e,t,n=0){super(),this.payload={renderTarget:e,texture:t,heading:n}}}class ComposeTargetsCommand extends i.m{constructor(e,t){super(),this.payload={target1:e,target2:t}}}},56709:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>RenderToTexture});var i=n(57227),s=n(14877),r=n(33299),o=n(2212);const a={circle_projection:new o.RawShaderMaterial({uniforms:{textureSampleScale:{value:5},panoTexture:{value:null},borderSize:{value:0},borderColor:{value:new o.Vector4(1,1,1,1)}},depthWrite:!1,depthTest:!0,side:o.DoubleSide,vertexShader:n(96251),fragmentShader:n(41148)}),equirectangular:new o.RawShaderMaterial({uniforms:{cubemap:{value:null},yaw:{value:0}},depthWrite:!1,depthTest:!1,vertexShader:n(35726),fragmentShader:n(38988)}),compose:new o.RawShaderMaterial({uniforms:{mask:{value:null},bg:{value:null}},transparent:!0,vertexShader:n(22052),fragmentShader:n(5370)})};var l=n(25935),c=n(93093);class RenderTarget{constructor(e,t){this._renderer=e,this._renderTarget=t}get target(){return this._renderTarget}get width(){return this._renderTarget.width}get height(){return this._renderTarget.height}get bpp(){return 4}readRenderTargetData(e){const t=this._renderTarget.width,n=this._renderTarget.height;return e=e||new Uint8Array(t*n*4),this._renderer.readRenderTargetPixels(this._renderTarget,0,0,t,n,e),e}setSize(e,t){this._renderTarget.setSize(e,t)}dispose(){this._renderTarget.dispose()}}var d=n(70446),u=n(19945);const h=new o.DataTexture(new Uint8Array([255,255,255,255]),1,1);h.needsUpdate=!0;class RenderToTexture extends i.Y{constructor(){super(...arguments),this.name="render-to-texture",this.circleProjectionPlane=new l.E((0,u.fc)(),a.circle_projection),this.equirectProjectionPlane=new l.E((0,u.fc)(),a.equirectangular),this.composePlane=new l.E((0,u.fc)(),a.compose),this.cachedSize=new o.Vector2,this.cachedViewport=new o.Vector4,this.cachedViewport2=new o.Vector4,this.debugRenderOffset=0}async init(e,t){this.engine=t;const n=await t.getModuleBySymbol(s.y.WEBGL_RENDERER);this.cwfRenderer=n.cwfRenderer,this.renderer=n.cwfRenderer.renderer,this.camera=new o.Camera,this.orthoCamera=new o.OrthographicCamera(-.5,.5,.5,-.5,0,1),this.camera.layers.mask=r.o.ALL.mask,this.scene=new o.Scene,this.scene.name="rtt",this.scene.autoUpdate=!1,this.bindings.push(t.commandBinder.addBinding(c.oM,(async e=>new RenderTarget(this.renderer,this.createRenderTarget2D(0))))),this.bindings.push(t.commandBinder.addBinding(c.sH,(async e=>{this.renderContext(e.renderTarget.target,e.context)}))),this.bindings.push(t.commandBinder.addBinding(c.vU,(async e=>{this.render(e.renderTarget.target,e.sceneObject,e.camera)}))),this.bindings.push(t.commandBinder.addBinding(c.fZ,(async e=>{this.renderEquirectangular(e.texture,e.renderTarget.target,e.heading)}))),this.bindings.push(t.commandBinder.addBinding(c.sp,(async e=>{this.render(e.renderTarget,e.sceneObject,e.camera)}))),this.bindings.push(t.commandBinder.addBinding(c.ep,(async e=>{this.compose(e.target1.target,e.target2.target,e.target2.target)})))}getRenderSize(){const e=this.renderer.getPixelRatio(),t=this.renderer.getSize(this.cachedSize);return t.width*=e,t.height*=e,t}onUpdate(){this.debugRenderOffset=0}createRenderTarget2D(e,t=e,n,i=!0){const s=new o.WebGLRenderTarget(e,t,n);return s.texture.generateMipmaps=i,s}clearRenderTarget2D(e){this.renderer.setRenderTarget(e),this.renderer.clear(),this.renderer.setRenderTarget(null)}disposeRenderTarget2D(e){e.texture.dispose(),e.depthTexture&&e.depthTexture.dispose(),e.dispose()}getRenderTargetData(e,t){const n=e.width,i=e.height;return t=t||new Uint8Array(n*i*4),this.renderer.readRenderTargetPixels(e,0,0,n,i,t),t}compose(e,t,n=h){const{uniforms:i}=this.composePlane.material;i.bg.value=this.isRenderTarget(t)?t.texture:t,i.mask.value=this.isRenderTarget(n)?n.texture:n,this.scene.add(this.composePlane),this.overrideRenderTarget(e,(()=>{this.renderer.render(this.scene,this.orthoCamera)})),this.scene.remove(this.composePlane),i.bg.value=null,i.mask.value=null}copyTexture(e,t){return this.compose(e,t)}resizeTexture(e,t){const n=new o.WebGLRenderTarget(t,t);return e.isCompressedTexture?n.texture.format=o.RGBAFormat:n.texture.format=e.format,n.texture.addEventListener("dispose",n.dispose.bind(n)),this.copyTexture(n,e),n.texture}renderToScreen(e,t=!0,n,i){(t?Promise.resolve():this.engine.after(d.A.Render)).then((()=>{const t=this.isRenderTarget(e)?e.width:e.image.width,s=this.isRenderTarget(e)?e.height:e.image.height,r=n?n.x:this.debugRenderOffset,o=n?n.y:60;this.renderer.getViewport(this.cachedViewport),this.renderer.setViewport(r,o,t,s),this.compose(null,e,i),this.renderer.setViewport(this.cachedViewport),n||(this.debugRenderOffset+=t+4)}))}isRenderTarget(e){return e.hasOwnProperty("texture")}renderContext(e,t){e.texture.image=t.canvas,e.texture.needsUpdate=!0}render(e,t,n,i){const s=t.parent;if(s&&this.scene.applyMatrix4(s.matrixWorld),this.scene.add(t),e.isWebGLCubeRenderTarget){const t=new o.CubeCamera(.01,1e3,e);n.getWorldPosition(t.position),n.getWorldQuaternion(t.quaternion),this.scene.add(t),this.scene.updateMatrixWorld(),t.layers.mask=i?i.mask:n.layers.mask,t.update(this.renderer,this.scene),this.scene.remove(t)}else{n.getWorldPosition(this.camera.position),n.getWorldQuaternion(this.camera.quaternion),this.camera.projectionMatrix.copy(n.projectionMatrix),this.camera.layers.mask=i?i.mask:n.layers.mask;const t=this.renderer.getSize(this.cachedSize),s=t.width/t.height,r=e.width/e.height,o=this.camera.projectionMatrix;s>r?o.elements[0]=o.elements[5]/r:o.elements[5]=o.elements[0]*r,this.overrideRenderTarget(e,(()=>{this.renderer.clear(),this.renderer.render(this.scene,this.camera)}))}return s&&(s.add(t),this.scene.matrixWorld.identity()),this.scene.remove(t),e}setScissors(e,t){if(e){if(!t)throw Error("Rect to restrict rendering to required when enabling scissors.");this.renderer.setScissorTest(!0),this.renderer.setScissor(t.x,t.y,t.width,t.height)}else{const e=this.renderer.getSize(this.cachedSize);this.renderer.setScissor(0,0,e.width,e.height),this.renderer.setScissorTest(!1)}}renderSphericalProjection(e,t,n,i,s){const r=a.circle_projection;r.uniforms.borderColor.value.copy(s||new o.Vector4(1,1,1,1)),r.uniforms.borderSize.value=i||0,r.uniforms.textureSampleScale.value=n||5,r.uniforms.panoTexture.value=e,this.scene.add(this.circleProjectionPlane),this.circleProjectionPlane.position.z=0,this.overrideRenderTarget(t,(()=>{this.renderer.render(this.scene,this.orthoCamera)})),this.scene.remove(this.circleProjectionPlane),r.uniforms.panoTexture.value=null}renderEquirectangular(e,t,n=0){const i=this.equirectProjectionPlane.material;i.uniforms.cubemap.value=e,i.uniforms.yaw.value=n,this.scene.add(this.equirectProjectionPlane),this.equirectProjectionPlane.position.z=0,this.overrideRenderTarget(t,(()=>{this.renderer.render(this.scene,this.orthoCamera)})),this.scene.remove(this.equirectProjectionPlane),i.uniforms.cubemap.value=null,i.uniforms.yaw.value=0}overrideRenderTarget(e,t){const n=this.renderTargetSwap(e);t(),this.renderTargetRestore(n)}renderTargetSwap(e){const t=this.renderer.xr.enabled,n=this.renderer.getRenderTarget(),i=this.renderer.getViewport(this.cachedViewport2);return this.renderer.xr.enabled=!1,this.renderer.setRenderTarget(e),{xr:t,rtt:n,viewport:i}}renderTargetRestore(e){this.renderer.xr.enabled=e.xr,this.renderer.setRenderTarget(e.rtt),this.renderer.setViewport(e.viewport)}renderAndReadAsync(e,t,n){const i=n.buffer;if(!this.renderer.capabilities.isWebGL2)return this.log.debug("renderAsync call webgl2, falling back to sync render/read"),this.render(e.target,e.mesh,e.camera),Promise.resolve(this.getRenderTargetData(e.target,i));const s=this.renderTargetSwap(e.target),r=this.renderer.getContext(),o=n.webglBuffer||r.createBuffer();if(!o)throw Error("Unable to create pack buffer");return r.bindBuffer(r.PIXEL_PACK_BUFFER,o),r.bufferData(r.PIXEL_PACK_BUFFER,i.byteLength,r.DYNAMIC_READ),e.clear&&this.renderer.clear(),this.renderer.render(e.mesh,e.camera),r.readPixels(t.x,t.y,t.width,t.height,r.RGBA,r.UNSIGNED_BYTE,0),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),this.renderTargetRestore(s),this.cwfRenderer.fence(r).then((()=>(r.bindBuffer(r.PIXEL_PACK_BUFFER,o),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),n.webglBuffer||r.deleteBuffer(o),i)))}}},17566:(e,t,n)=>{"use strict";n.d(t,{vP:()=>r,Xk:()=>o,jJ:()=>a,fY:()=>l});var i=n(81402);let s=null;const r=async(e,t)=>{const i=new Uint8Array(e.width*e.height*4);if(e.readRenderTargetData(i),!s){const e=await Promise.all([n.e(764),n.e(564),n.e(718)]).then(n.bind(n,2564));s=e.createJpegEncodeWorker()}const r=i.buffer,o=await s.exec({data:r,width:e.width,height:e.height,options:{exif:t,quality:85,flipY:!0}},[r]);return new Uint8Array(o.data)},o=e=>new Blob([e],{type:"image/jpeg"}),a=e=>"data:image/jpg;base64,"+(0,i.$B)(e),l=(e,t,n,i)=>'http://ns.adobe.com/xap/1.0/\0<?xpacket begin="ï»¿" id="W5M0MpCehiHzreSzNTczkc9d"?><x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:GPano="http://ns.google.com/photos/1.0/panorama/"><GPano:CroppedAreaImageHeightPixels>'+t+"</GPano:CroppedAreaImageHeightPixels><GPano:CroppedAreaImageWidthPixels>"+e+"</GPano:CroppedAreaImageWidthPixels><GPano:CroppedAreaLeftPixels>0</GPano:CroppedAreaLeftPixels><GPano:CroppedAreaTopPixels>0</GPano:CroppedAreaTopPixels><GPano:FullPanoHeightPixels>"+t+"</GPano:FullPanoHeightPixels><GPano:FullPanoWidthPixels>"+e+"</GPano:FullPanoWidthPixels><GPano:ProjectionType>equirectangular</GPano:ProjectionType><GPano:UsePanoramaViewer>True</GPano:UsePanoramaViewer><GPano:InitialViewHeadingDegrees>"+n+"</GPano:InitialViewHeadingDegrees><GPano:InitialViewPitchDegrees>"+i+'</GPano:InitialViewPitchDegrees><GPano:CaptureSoftware>Matterport Camera</GPano:CaptureSoftware><GPano:StitchingSoftware>Matterport Cloud</GPano:StitchingSoftware></rdf:Description></rdf:RDF></x:xmpmeta><?xpacket end="w"?>'},29755:(e,t,n)=>{"use strict";n.d(t,{Z:()=>RoomData});var i=n(35424),s=n(67779);class RoomData extends i.V{constructor(e){if(super(),this.name="rooms",this.selected=new s.f(null),this._rooms={},this.floorToRoomsMap=new Map,e)for(const t of Object.values(e))this.add(t)}add(e){this._rooms[e.id]=e;const t=this.floorToRoomsMap.get(e.floorId);t?t.push(e):this.floorToRoomsMap.set(e.floorId,[e])}remove(e){const t=this.get(e);if(!t)return;const n=this.floorToRoomsMap.get(t.floorId);if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1)}delete this._rooms[e]}rooms(){const e=this._rooms,t=Object.keys(this._rooms);return function*(){for(const n of t)yield e[n]}()}get roomCount(){return Object.keys(this._rooms).length}get collection(){return this._rooms}get(e){return this._rooms[e]}getByMeshSubgroup(e){return Object.values(this._rooms).find((t=>t.meshSubgroup===e))}roomsByFloor(e){return this.floorToRoomsMap.get(e)||[]}}},86701:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>RoomDataModule});var i=n(57227),s=n(29755),r=n(53549),o=n(37363),a=n(38182),l=n(88655),c=n(66225),d=n(5477);class Room{constructor(e){this.tags=[],e&&Object.assign(this,e)}}const u=new d.Z("mds-floor-deserializer");class MdsRoomDeserializer{deserialize(e){if(!e||!this.validate(e))return u.debug("Deserialized invalid room data from MDS",e),null;const t=e.dimensions||{},{height:n,width:i,depth:s,areaFloor:r}=t;return new Room({id:e.id,meshSubgroup:e.meshId,floorId:e.floor.id,height:n,width:i,depth:s,areaFloor:r,tags:e.tags})}validate(e){const t=["id","meshId"].every((t=>t in e)),n=e.floor&&e.floor.id&&"number"==typeof e.floor.meshId;return t&&!!n}}class MdsRoomStore extends c.u{constructor(){super(...arguments),this.prefetchKey="data.model.rooms"}async read(e){const t=new MdsRoomDeserializer,n={modelId:this.getViewId()};return this.query(l.GetRooms,n,e).then((e=>{var n,i;const s=null===(i=null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.model)||void 0===i?void 0:i.rooms;if(!s||!Array.isArray(s))return null;return s.reduce(((e,n)=>{const i=t.deserialize(n);return i&&(e[i.id]=i),e}),{})}))}}class RoomDataModule extends i.Y{constructor(){super(...arguments),this.name="room-data",this.visitedRooms={}}async init(e,t){const{baseUrl:n}=e;this.store=new MdsRoomStore({baseUrl:n,readonly:!0});const i=await this.store.read();this.data=new s.Z(i||{}),t.market.register(this,s.Z,this.data);const l=await t.market.waitForData(o.O),c=this.data.roomCount,d=e=>{const n=l.closestMode;this.visitedRooms[e.id]||(this.visitedRooms[e.id]={visitCount:0}),this.visitedRooms[e.id].visitCount++;const i=this.visitedRooms[e.id].visitCount;t.broadcast(new a.D(e.id,e.meshSubgroup,n,i,c,""))},u=await t.market.waitForData(r.Z),h=u.makeSweepChangeSubscription((e=>{if(e){const t=u.getSweep(e);this.data.selected.value=t.roomId,this.data.commit()}})),p=this.data.selected.onChanged((e=>{if(null!==e){const t=this.data.get(e);t&&d(t)}}));this.bindings.push(h,p)}}},38182:(e,t,n)=>{"use strict";n.d(t,{D:()=>RoomVisitedMessage});var i=n(4117);class RoomVisitedMessage extends i.v{constructor(e,t,n,i,s,r){super(),this.roomId=e,this.meshSubgroup=t,this.viewmode=n,this.visitCount=i,this.roomCount=s,this.roomType=r}}},78767:(e,t,n)=>{"use strict";n.d(t,{S:()=>ScheduleProcessCommand});var i=n(93037);class ScheduleProcessCommand extends i.m{constructor(e,t,n,i=1){super(),this.id="SCHEDULE_PROCESS_COMMAND",this.payload={type:e,func:t,maxDelay:n,steps:i}}}},28180:(e,t,n)=>{"use strict";n.d(t,{_:()=>ScheduleTaskCommand});var i=n(93037);class ScheduleTaskCommand extends i.m{constructor(e,t,n){super(),this.id="SCHEDULE_TASK_COMMAND";const i=function*(){return t()}();this.payload={type:e,func:i,maxDelay:n,steps:1}}}},32227:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SchedulerModule});var i,s=n(57227),r=n(31117);class TaskType{constructor(e){this.name=e,this.taskDurations=new r.P(100),this.medianDuration=1}get typicalStepDuration(){return this.medianDuration}addTaskDuration(e){this.taskDurations.push(e),this.taskDurations.index%10==0&&(this.medianDuration=this.taskDurations.median())}}!function(e){e.WAITING="waiting",e.STARTED="started",e.DONE="done"}(i||(i={}));class Scheduler{constructor(){this.tasks=[],this.types={}}getType(e){return this.types[e]||(this.types[e]=new TaskType(e)),this.types[e]}addTask(e){this.tasks.push(e)}update(e){this.tasks=this.tasks.filter((e=>e.status!==i.DONE)),this.tasks.sort(((e,t)=>t.urgency-e.urgency));let t=0;e:for(const n of this.tasks)for(;n.status!==i.DONE;){const i=performance.now(),s=t+n.type.typicalStepDuration>e,r=i>=n.deadline;if(s&&!r)break e;const o=i;n.run();const a=performance.now()-o;n.type.addTaskDuration(a),t+=a}}}var o=n(28180),a=n(78767);class Task{constructor(e,t,n,s){this.type=e,this.func=t,this.deadline=n,this.steps=s,this.status=i.WAITING,this.promise=new Promise(((e,t)=>{this.onSuccess=e,this.onError=t}))}run(){let e;this.status=i.STARTED;try{e=this.func.next()}catch(e){return this.status=i.DONE,void this.onError(e)}this.steps-=1,e.done&&(this.status=i.DONE,this.onSuccess(e.value))}get estimatedDuration(){return this.steps*this.type.typicalStepDuration}get urgency(){const e=this.deadline-performance.now();return e<=0?1e6-e:this.estimatedDuration/e/e}}class SchedulerModule extends s.Y{constructor(){super(...arguments),this.name="scheduler-module",this.scheduler=new Scheduler}async init(e,t){this.engine=t,this.engine.commandBinder.addBinding(o._,(async e=>{const t=new Task(this.scheduler.getType(e.type),e.func,performance.now()+e.maxDelay,e.steps);return this.scheduler.addTask(t),t})),this.engine.commandBinder.addBinding(a.S,(async e=>{const t=new Task(this.scheduler.getType(e.type),e.func,performance.now()+e.maxDelay,e.steps);return this.scheduler.addTask(t),t}))}onUpdate(e){this.scheduler.update(4)}}},55210:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ScreenshotsModule});var i=n(57227),s=n(14877),r=n(82722),o=n(33299),a=n(2252),l=n(17566),c=n(42249),d=n(2212),u=n(56709),h=n(93093),p=n(37363),m=n(12622),f=n(14832),g=n(22878);class ScreenshotsModule extends i.Y{constructor(){super(...arguments),this.name="screenshots-module",this.capturer=new ScreenCapturer}async init(e,t){this.engine=t,[this.settingsModule,this.canvas,this.renderer,this.renderToTexture]=await Promise.all([t.getModuleBySymbol(s.y.SETTINGS),t.market.waitForData(r.W),t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.getModule(u.default)]),this.settingsModule.registerButton("Debug","Take screenshot",(async()=>{const e=Date.now();await this.takeAndDownloadScreenshot({height:this.canvas.height,width:this.canvas.width},`image_${e}.jpg`,o.o.ALL)})),this.settingsModule.registerButton("Debug","Take 4k screenshot",(async()=>{const e=Date.now();await this.takeAndDownloadScreenshot({height:2304,width:4096},`image_${e}.jpg`,o.o.ALL)})),this.settingsModule.registerButton("Debug","Take 8k screenshot",(async()=>{const e=Date.now();await this.takeAndDownloadScreenshot({height:4608,width:8192},`image_${e}.jpg`,o.o.ALL)})),this.settingsModule.registerButton("Debug","Take 16k screenshot",(async()=>{const e=Date.now();await this.takeAndDownloadScreenshot({height:9e3,width:16e3},`image_${e}.jpg`,o.o.ALL)})),this.settingsModule.registerButton("Debug","Take FB 3D screenshot",(async()=>{const e=Date.now(),t=this.engine.getRenderLayer("model-mesh"),n=this.engine.getRenderLayer("skybox"),i=t.clone();i.addLayers(n);const s=(await this.engine.market.waitForData(p.O)).currentMode;try{await this.takeAndDownloadScreenshot({height:this.canvas.height,width:this.canvas.width},`image_${e}.jpg`,i),await this.engine.commandBinder.issueCommand(new c.U(c.U.modes.Depth)),await this.engine.commandBinder.issueCommand(new m._i(m.BD.MESH,f.n.Instant)),await this.takeAndDownloadScreenshot({height:Math.floor(this.canvas.height/4),width:Math.floor(this.canvas.width/4)},`image_${e}_depth.jpg`,t)}catch(e){throw this.log.error("Could not take screenshot"),e}finally{await this.engine.commandBinder.issueCommand(new c.U(null)),await this.engine.commandBinder.issueCommand(new m._i(m.KP[s||g.Ey.Panorama]))}}))}async takeAndDownloadScreenshot(e,t,n){this.renderTarget||(this.renderTarget=await this.engine.commandBinder.issueCommandWhenBound(new h.oM));const i=await this.capturer.capture(n,e,this.renderer,this.renderToTexture,this.renderTarget);(0,a.Hx)((0,l.Xk)(i),t)}}class ScreenCapturer{constructor(){this.captureCamera=new d.Camera}async capture(e,t,n,i,s){const{camera:r,scene:o}=n.getScene();return r.getWorldPosition(this.captureCamera.position),r.getWorldQuaternion(this.captureCamera.quaternion),this.captureCamera.projectionMatrix.copy(r.projectionMatrix),this.captureCamera.layers.mask=e.mask,s.setSize(t.width,t.height),i.render(s.target,o,this.captureCamera),await(0,l.vP)(s)}}},91845:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i}),function(e){e.TYPE="type",e.FLOOR="floor"}(i||(i={}))},29686:(e,t,n)=>{"use strict";n.d(t,{K:()=>SearchResultItem});var i=n(64921),s=n(22149);const r=new i.v({});class SearchResultItem{constructor(e){this.enabled=!0,this.textParser=r,this.bindings=[],this.commandBinder=e}onSelect(){this.commandBinder.issueCommand(new s.IL(this))}registerBindings(){}cancelBindings(){this.bindings.forEach((e=>e.cancel()))}}},9740:(e,t,n)=>{"use strict";n.d(t,{r:()=>SearchResultsData});var i=n(35424),s=n(29984),r=n(67779),o=n(91845);const a=/(==|!=|>|<|>=|<=|~=)/;class SearchResultsData extends i.V{constructor(){super(...arguments),this.activated=!1,this.query="",this.queryKeywords=(0,s.C)(),this.grouping=o.l.TYPE,this.results=(0,s.C)([]),this.groups={},this.keywords=(0,r.Y)({}),this.validationError=null,this.isAdvancedSearchEnabled=!1,this.isKeywordSummaryEnabled=!1,this.selectedSearchResult=new r.f(null),this.getIsAdvancedQuery=()=>{const e=this.getQuery();return this.getIsAdvancedSearchEnabled()&&(e=>a.test(e||""))(e)},this.setSelectedSearchResult=e=>{this.selectedSearchResult.value=e}}getQuery(){return this.query}getQueryKeywords(){return this.queryKeywords.values()}hasActiveQuery(){return""!==this.query||this.queryKeywords.length>0}setQuery(e){this.query=e,this.commit()}setQueryKeywords(e){this.queryKeywords.replace(e),this.commit()}setKeywords(e){this.keywords.value=e,this.commit()}refreshResults(){this.commit()}getGrouping(){return this.grouping}setGrouping(e){this.grouping=e,this.commit()}getResults(){return this.results.values()}setResults(e){this.results.forEach((e=>e.cancelBindings())),this.results.replace(e),this.results.forEach((e=>e.registerBindings()))}getValidationError(){return this.validationError}setValidationError(e){this.validationError=e,this.commit()}setIsAdvancedSearchEnabled(e){this.isAdvancedSearchEnabled=e,this.commit()}getIsAdvancedSearchEnabled(){return this.isAdvancedSearchEnabled}setIsKeywordSummaryEnabled(e){this.isKeywordSummaryEnabled=e,this.commit()}getSelectedSearchResult(){return this.selectedSearchResult.value}getActivated(){return this.activated}setActivated(e){this.activated=e,this.commit()}onlyExecuteWhenActivated(e){let t=!1;const n=()=>{this.getActivated()?(e(),t=!1):t=!0};return this.onPropertyChanged("activated",(e=>{e&&t&&n()})),n}}},22149:(e,t,n)=>{"use strict";n.d(t,{Xv:()=>SearchModeToggleCommand,H1:()=>UpdateSearchQueryCommand,FZ:()=>UpdateSearchQueryKeywordsCommand,M8:()=>ToggleSearchQueryKeywordCommand,s7:()=>RefreshSearchResultsCommand,SN:()=>ChangeSearchGroupingCommand,Np:()=>UpdateGroupActionsCommand,IL:()=>SelectSearchResultCommand,c6:()=>RegisterSearchGroupCommand,Pe:()=>DeregisterSearchGroupCommand});var i=n(93037);class SearchModeToggleCommand extends i.m{constructor(e){super(),this.payload={opened:e}}}class UpdateSearchQueryCommand extends i.m{constructor(e){super(),this.payload={query:e}}}class UpdateSearchQueryKeywordsCommand extends i.m{constructor(e){super(),this.payload={keywords:e}}}class ToggleSearchQueryKeywordCommand extends i.m{constructor(e){super(),this.payload={keywordId:e}}}class RefreshSearchResultsCommand extends i.m{constructor(){super()}}class ChangeSearchGroupingCommand extends i.m{constructor(e){super(),this.payload={grouping:e}}}class UpdateGroupActionsCommand extends i.m{constructor(e,t){super(),this.payload={id:e,groupMenuActions:t}}}class SelectSearchResultCommand extends i.m{constructor(e){super(),this.payload={item:e}}}class RegisterSearchGroupCommand extends i.m{constructor(e){super(),this.payload=Object.assign({getSimpleMatches:()=>[],getAdvancedMatches:()=>[]},e)}}class DeregisterSearchGroupCommand extends i.m{constructor(e){super(),this.payload={id:e}}}},21546:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var i=n(67294),s=n(60405);var r=n(68077),o=n(8428),a=n(59867),l=n(23676);function c(){const{editMode:e}=(0,i.useContext)(s.I),t=function(e){const{toolsData:t}=(0,i.useContext)(s.I),[n,r]=(0,i.useState)(t.getTool(e));return(0,i.useEffect)((()=>{const n=()=>{r(t.getTool(e))},i=t.onToolsLoadedChanged(n);return n(),()=>i.cancel()}),[t,e]),n}(l.w1.SEARCH),n=(0,r.y)(a.B,!1),c=(0,r.y)(o.gx.SpaceSearch,!1);return n&&!!t&&(e||c)}},46803:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var i=n(20302),s=n(9740);const r=(0,i.u)(s.r)},59867:(e,t,n)=>{"use strict";n.d(t,{B:()=>i,l:()=>s});const i="features/space-search",s="features/space-search-advanced"},9544:(e,t,n)=>{"use strict";n.d(t,{K:()=>SensorModule});var i=n(57227),s=n(14877),r=n(95703),o=n(77280),a=n(2212);class SensorObserver{constructor(){this.needsUpdate=!0}notify(){this.needsUpdate=!0}}var l=n(97428);class SensorObservable{constructor(e){this.observable=new l.$,this.notifier=new class{constructor(e){this.sensorObservable=e}notify(){this.sensorObservable.observable.notify()}}(this),this.dependencySub=e.sub(this.notifier)}dispose(){this.dependencySub.cancel()}observe(e){return this.observable.observe(e)}}class CameraFrustumVolume{constructor(e){this.cameraData=e,this._forward=new a.Vector3,this.frustum=new a.Frustum,this.frustumTransform=new r.M,this.frustumProjection=new r.M,this.forwardObserver=new SensorObserver,this.frustumObserver=new SensorObserver,this.frustumObservable=new SensorObservable(new CameraDataSubsriber(e)),this.frustumObservable.observe(this.forwardObserver),this.frustumObservable.observe(this.frustumObserver)}dispose(){this.frustumObservable.dispose()}get fovx(){return this.cameraData.fovX()}get fovy(){return this.cameraData.fovY()}get forward(){return this.forwardObserver.needsUpdate&&(this.forwardObserver.needsUpdate=!1,this._forward.copy(o.f.FORWARD),this._forward.applyQuaternion(this.cameraData.pose.rotation)),this._forward}observe(e){return this.frustumObservable.observe(e)}get origin(){return this.cameraData.pose.position}containsPoint(e){return this.updateVolume(),this.frustum.containsPoint(e)}updateVolume(){if(this.frustumObserver.needsUpdate){this.frustumObserver.needsUpdate=!1;const e=this.cameraData.pose;this.frustumTransform.compose(e.position,e.rotation,o.f.UNIT).getInverse(this.frustumTransform),this.frustumProjection.copy(this.cameraData.pose.projection),this.frustum.setFromProjectionMatrix(this.frustumTransform.multiplyMatrices(this.frustumProjection,this.frustumTransform).asThreeMatrix4())}}}class CameraDataSubsriber{constructor(e){this.cameraData=e}sub(e){return this.cameraData.onChanged((()=>e.notify()))}}var c=n(15099);class SensorUpdater{constructor(){this.sensors=new Set}addSensor(e){this.sensors.add(e)}removeSensor(e){this.sensors.delete(e)}update(){for(const e of this.sensors)e.update()}}class SensorDecorator{constructor(e,t,n){this.frustum=e,this.raycaster=t,this.sensorDisposer=n,this.volumeObserver=new SensorObserver,this.sources=new Set,this.dirtySources=new Set,this.sourceWatchers=new Map,this.readingsCache=new Map,this.readingObservable=new l.$,this.raycastDirection=new a.Vector3,this.volumeSub=e.observe(this.volumeObserver)}get origin(){return this.frustum.origin}dispose(){this.volumeSub.cancel(),this.sensorDisposer.disposeSensor(this)}addSource(...e){for(const t of e)this.sources.add(t),this.dirtySources.add(t),this.sourceWatchers.set(t,new SourceWatcher(this.dirtySources,t))}get readings(){return this.readingsCache}update(){this.volumeObserver.needsUpdate?(this.volumeObserver.needsUpdate=!1,this.recomputeAllReadings(),this.readingObservable.notify()):this.dirtySources.size>0&&(this.recomputeDirtyReadings(),this.readingObservable.notify())}recomputeAllReadings(){for(const e of this.sources)this.recomputeReading(e);this.dirtySources.clear()}recomputeDirtyReadings(){for(const e of this.dirtySources)this.recomputeReading(e);this.dirtySources.clear()}recomputeReading(e){this.raycastDirection.copy(e.origin).sub(this.frustum.origin).normalize();const t=this.frustum.origin.distanceToSquared(e.origin),n=this.readingsCache.get(e)||{direction:new a.Vector3};n.inRange=function(e,t){return t.volume.containsPoint(e.origin)}(this,e),n.inView=n.inRange&&this.frustum.containsPoint(e.origin)&&!function(e,t){return!!t&&e>t.distance**2}(t,this.raycaster.picking.pick(this.frustum.origin,this.raycastDirection)),n.direction.copy(this.raycastDirection),n.distanceSq=t,this.readingsCache.set(e,n)}onReadingsUpdated(e){return this.readingObservable.observe(e)}}class SourceWatcher{constructor(e,t){this.sub=t.volume.observe({notify(){e.add(t)}})}dispose(){this.sub.cancel()}}var d=n(95847),u=n(3035),h=n(16493),p=n(36598);const m=(e,t)=>e.type===p.SourceType.BOX?g(t):e.type===p.SourceType.CYLINDER?function(e){const t=new a.CylinderBufferGeometry(.5,.5,1);t.translate(0,.5,0);const n=new a.Mesh(t,new a.MeshBasicMaterial);n.scale.set(.05,.1,.05);const i=new a.MeshBasicMaterial({transparent:!0,opacity:.1,side:a.DoubleSide,depthWrite:!1}),s=new a.Mesh(t,new a.MeshBasicMaterial({wireframe:!0})),r=new a.Mesh(t,i);return r.add(s),e.add(n),e.add(r),{interactionMesh:n,volumeMesh:r,dispose(){e.remove(n),e.remove(r),n.geometry.dispose(),n.material.dispose(),r.geometry.dispose(),r.material.dispose(),s.geometry.dispose(),s.material.dispose()},setColor(e){r.material.color.set(e),s.material.color.set(e)}}}(t):f(t),f=e=>{const t=new a.SphereBufferGeometry(1,20,20),n=new a.Mesh(t,new a.MeshBasicMaterial);n.scale.set(.5,.5,.5);const i=new a.Mesh(t,new a.MeshBasicMaterial({wireframe:!0})),s=new a.Mesh(t,new a.MeshBasicMaterial({transparent:!0,opacity:.1,side:a.DoubleSide,depthWrite:!1}));return s.add(i),e.add(n),e.add(s),{interactionMesh:n,volumeMesh:s,dispose:()=>{e.remove(n),e.remove(s),n.geometry.dispose(),n.material.dispose(),s.geometry.dispose(),s.material.dispose(),i.geometry.dispose(),i.material.dispose()},setColor:e=>{s.material.color.set(e),i.material.color.set(e)}}},g=e=>{const t=new a.BoxBufferGeometry(1,1,1),n=new a.Mesh(t,new a.MeshBasicMaterial);n.scale.set(.1,.1,.1);const i=new a.MeshBasicMaterial({transparent:!0,opacity:.1,side:a.DoubleSide,depthWrite:!1}),s=new a.Mesh(t,i),r=new a.LineSegments(new a.EdgesGeometry(t),new a.LineBasicMaterial);return s.add(r),e.add(n),e.add(s),{interactionMesh:n,volumeMesh:s,dispose:()=>{e.remove(n),e.remove(s),n.geometry.dispose(),n.material.dispose(),s.geometry.dispose(),s.material.dispose(),r.geometry.dispose(),r.material.dispose()},setColor:e=>{s.material.color.set(e),r.material.color.set(e)}}};const v=e=>{if(e.type===p.SourceType.BOX){const t=e;return Object.assign({},t.volume.size)}if(e.type===p.SourceType.CYLINDER){const t=e;return{x:t.volume.radius,y:t.volume.height,z:t.volume.radius}}{const t=e.volume.radius;return{x:t,y:t,z:t}}},y=(new a.Quaternion).identity();function b(e){if(e.type===p.SourceType.BOX){return e.volume.orientation}return y}class VolumeVisualizer{constructor(e,t,n){this.source=e,this.scene=t,this.inputIni=n,this.subs=[],this.stickyHover=!1,this.sourceDirty=!0,this.meshes=m(e,this.scene.scene),this.meshes.interactionMesh.scale.set(.1,.1,.1),this.meshes.interactionMesh.position.copy(this.source.origin),this.meshes.interactionMesh.material.color.set(16724312),this.meshes.volumeMesh.scale.set(0,0,0),this.meshes.volumeMesh.position.copy(this.source.origin),this.meshes.volumeMesh.visible=!1;const i=b(e);this.meshes.volumeMesh.quaternion.copy(i);this.mixer=new a.AnimationMixer(this.meshes.volumeMesh);const s=v(e),r=new a.VectorKeyframeTrack(".scale",[0,.4],[0,0,0,s.x,s.y,s.z],a.InterpolateSmooth),o=new a.AnimationClip(void 0,.4,[r]);this.onHoverAction=this.mixer.clipAction(o),this.onHoverAction.clampWhenFinished=!0,this.onHoverAction.loop=a.LoopOnce,this.subs.push(this.inputIni.registerMeshHandler(d.z,h.s.isValue(this.meshes.interactionMesh),(()=>{const e=this.onHoverAction.time;this.onHoverAction.reset(),this.meshes.volumeMesh.visible=!0,this.onHoverAction.timeScale=1,this.onHoverAction.time=e,this.onHoverAction.play()}))),this.subs.push(this.inputIni.registerMeshHandler(d.A,h.s.isValue(this.meshes.interactionMesh),(()=>{if(!this.stickyHover){const e=this.onHoverAction.time;this.onHoverAction.reset(),this.onHoverAction.time=e,this.onHoverAction.timeScale=-1,this.onHoverAction.play()}}))),this.subs.push(this.inputIni.registerMeshHandler(u.R,h.s.isValue(this.meshes.interactionMesh),(()=>{this.stickyHover=!this.stickyHover,this.stickyHover?this.meshes.interactionMesh.material.color.set(4473924):this.meshes.interactionMesh.material.color.set(16724312)}))),this.inputIni.registerMesh(this.meshes.interactionMesh,!1),this.subs.push(e.volume.observe(this))}notify(){this.sourceDirty=!0}update(e,t){if(this.sourceDirty){this.sourceDirty=!1,this.meshes.interactionMesh.position.copy(this.source.origin),this.meshes.volumeMesh.position.copy(this.source.origin),this.meshes.volumeMesh.quaternion.copy(b(this.source));const e=v(this.source),t=this.onHoverAction.getClip().tracks[0].values;t[3]=e.x,t[4]=e.y,t[5]=e.z}this.meshes.setColor(t.inRange?65280:16711680),this.mixer.update(e/1e3)}dispose(){this.meshes.dispose(),this.mixer.stopAllAction();for(const e of this.subs)e.cancel()}}class SensorRenderer{constructor(e,t,n){this.sensor=e,this.scene=t,this.inputIni=n,this.subs=[],this.visuals=new Map}init(){this.subs.push(this.sensor.onReadingsUpdated(this))}render(e){for(const[t,n]of this.sensor.readings){let i=this.visuals.get(t);i||(i=new VolumeVisualizer(t,this.scene,this.inputIni),this.visuals.set(t,i)),i.update(e,n)}}dispose(){}activate(){}deactivate(){for(const e of this.subs)e.cancel();for(const e of this.visuals.values())e.dispose();this.visuals.clear()}notify(){}}class SensorModule extends i.Y{constructor(){super(...arguments),this.name="sensor-module",this.sensorUpdater=new SensorUpdater,this.debugSensor=null,this.sensorDisposer=new class{constructor(e){this.sensors=e}disposeSensor(e){this.sensors.removeSensor(e)}}(this)}async init(e,t){[this.cameraData,this.raycaster,this.renderer,this.inputIni]=await Promise.all([await t.market.waitForData(c.M_),await t.getModuleBySymbol(s.y.RAYCASTER),await t.getModuleBySymbol(s.y.WEBGL_RENDERER),await t.getModuleBySymbol(s.y.INPUT)]),this.cameraVolume=new CameraFrustumVolume(this.cameraData);var n,i,r,o;this.sensorDebuggerFactory=(n=e=>{t.addComponent(this,e)},i=e=>{t.removeComponent(this,e)},r=this.renderer.getScene(),o=this.inputIni,e=>{const t=new SensorRenderer(e,r,o);return n(t),{dispose:()=>{i(t)}}})}dispose(){this.cameraVolume.dispose()}createSensor(e){const t=new SensorDecorator(e,this.raycaster,this.sensorDisposer);return this.sensorUpdater.addSensor(t),t}createCameraBoundSensor(){return this.createSensor(this.cameraVolume)}setDebugSensor(e){this.debugSensor&&(this.debugSensor.dispose(),this.debugSensor=null),e&&(this.debugSensor=this.sensorDebuggerFactory(e))}onUpdate(){this.sensorUpdater.update()}removeSensor(e){this.sensorUpdater.removeSensor(e)}}},36598:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a,SensorModule:()=>i.K,BoxVolume:()=>s.k,CylinderVolume:()=>r.X,SphereVolume:()=>o.b,SourceType:()=>l});var i=n(9544),s=n(39440),r=n(99160),o=n(7471);const a=i.K;var l;!function(e){e.SPHERE="sourcetype.sphere",e.BOX="sourcetype.box",e.CYLINDER="sourcetype.cylinder"}(l||(l={}))},39440:(e,t,n)=>{"use strict";n.d(t,{k:()=>BoxVolume});var i=n(2212),s=n(97428);class BoxVolume extends s.${constructor(){super(),this.box=new i.Box3,this.center=new i.Vector3,this.size=new i.Vector3(1/0,1/0,1/0),this.orientation=new i.Quaternion,this.inverseOrientation=new i.Quaternion,this.pointCache=new i.Vector3,this.transformNeedsUpdate=!1,this.box.setFromCenterAndSize(this.center,this.size)}get origin(){return this.center}updateCenter(e){this.center.copy(e),this.box.setFromCenterAndSize(this.center,this.size),this.transformNeedsUpdate=!0}updateDimensions(e){this.size.copy(e),this.box.setFromCenterAndSize(this.center,this.size)}updateOrientation(e){this.orientation.copy(e),this.transformNeedsUpdate=!0}containsPoint(e){return this.transformNeedsUpdate&&(this.transformNeedsUpdate=!1,this.inverseOrientation.copy(this.orientation).invert()),this.pointCache.copy(e).sub(this.center),this.pointCache.applyQuaternion(this.orientation),this.pointCache.add(this.center),this.box.containsPoint(this.pointCache)}}},99160:(e,t,n)=>{"use strict";n.d(t,{X:()=>CylinderVolume});var i=n(2212),s=n(97428);class CylinderVolume extends s.${constructor(){super(...arguments),this._basePoint=new i.Vector3,this._height=1/0,this._radius=1/0,this.pointCache=new i.Vector3}get origin(){return this._basePoint}get basePoint(){return this._basePoint}get height(){return this._height}get radius(){return this._radius}updateBasePoint(e){this.basePoint.set(e.x,e.y,e.z)}updateHeight(e){this._height=e}updateRadius(e){this._radius=e}containsPoint(e){return this.pointCache.set(e.x,this._basePoint.y,e.z),this._basePoint.distanceToSquared(this.pointCache)<=this.radius**2&&this._basePoint.y<=e.y&&e.y<=this._basePoint.y+this.height}}},7471:(e,t,n)=>{"use strict";n.d(t,{b:()=>SphereVolume});var i=n(2212),s=n(97428);class SphereVolume extends s.${constructor(){super(...arguments),this.origin=new i.Vector3,this.radius=1/0}updateRadius(e){this.radius=e}updateOrigin(e){this.origin.copy(e)}containsPoint(e){return this.origin.distanceToSquared(e)<=this.radius**2}}},91825:(e,t,n)=>{"use strict";n.d(t,{i:()=>SkySphereMesh});var i=n(2212);class SkySphereMesh extends i.Mesh{}},71271:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SkyboxModule});var i=n(57227),s=n(14877),r=n(2212);const o={sky:{uniforms:{topColor:{type:"v3",value:new r.Vector3(.094,.102,.11)},bottomColor:{type:"v3",value:new r.Vector3(.2,.216,.235)},radius:{type:"f",value:100}},vertexShader:n(11387),fragmentShader:n(75861)}};class SkyboxMaterial extends r.RawShaderMaterial{constructor(e={}){super(Object.assign({fragmentShader:o.sky.fragmentShader,vertexShader:o.sky.vertexShader,uniforms:r.UniformsUtils.clone(o.sky.uniforms),name:"SkyboxMaterial"},e))}}var a=n(33299),l=n(91825),c=n(99295),d=n(41674);class Skybox{constructor(e,t,n,i,s=a.o.ALL){this.scene=e,this.cameraData=t,this.addToRaycasting=n,this.removeFromRaycasting=i,this.renderLayer=s,this.bindings=[]}init(){const{visualMesh:e,colliderMesh:t}=this.setupSkysphere();this.skyVisual=e,this.material=this.skyVisual.material,this.skyCollider=t}dispose(){this.material.uniforms.pano0Map.value.dispose(),this.material.uniforms.pano1Map.value.dispose(),this.material.dispose(),this.skyVisual.geometry.dispose()}activate(e){this.scene.addChild(this.scene.ids.Root,this.skyVisual),this.skyVisual.updateMatrixWorld(!0),this.skyVisual.visible=!0,this.addToRaycasting(this.skyCollider,!1)}deactivate(e){for(const e of this.bindings)e.cancel();this.bindings=[],this.scene.removeChild(this.scene.ids.Root,this.skyVisual),this.scene.removeChild(this.scene.ids.CameraRig,this.skyCollider),this.removeFromRaycasting(this.skyCollider)}updateBackgroundColors(e,t){const n=new r.Color(e),i=new r.Color(t);this.material.uniforms.topColor.value.set(n.r,n.g,n.b),this.material.uniforms.bottomColor.value.set(i.r,i.g,i.b)}beforeRender(){this.skyVisual.position.copy(this.cameraData.pose.position),this.skyCollider.position.copy(this.cameraData.pose.position)}render(){}setupSkysphere(e){const t=new r.SphereBufferGeometry(1e4,5,5);t.computeBoundingBox();const n=d.oR.far-10,i=new r.SphereBufferGeometry(n,5,5);i.computeBoundingBox(),e||(e=new SkyboxMaterial({side:r.BackSide}));const s=new l.i(i,e);s.layers.mask=this.renderLayer.mask,s.name="Skysphere",s.renderOrder=c.z.boundingSkybox,s.updateMatrixWorld(!0),e.uniforms.radius.value=n,e.depthWrite=!1,e.depthTest=!1;return{visualMesh:s,colliderMesh:new l.i(t,new r.MeshBasicMaterial({opacity:0,depthWrite:!1,side:r.BackSide}))}}}var u=n(61903),h=n(95655),p=n(8428),m=n(15099);class SkyboxModule extends i.Y{constructor(){super(...arguments),this.name="skybox-module"}async init(e,t){const[n,i,r,o]=await Promise.all([t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.market.waitForData(u.e),t.getModuleBySymbol(s.y.INPUT),t.market.waitForData(m.M_)]),a=t.claimRenderLayer("skybox"),l=n.getScene();this.skybox=new Skybox(l,o,r.registerMesh,r.unregisterMesh,a),t.addComponent(this,this.skybox);const c=i.tryGetProperty(p.gx.BackgroundColor,h.z.default);this.skybox.updateBackgroundColors(h.K[c].bgPrimary,h.K[c].bgSecondary),this.bindings.push(i.onPropertyChanged(p.gx.BackgroundColor,(e=>{this.skybox.updateBackgroundColors(h.K[e].bgPrimary,h.K[e].bgSecondary)})))}}},9446:(e,t,n)=>{"use strict";n.d(t,{E:()=>CaptureSnapshotCommand,e:()=>EquirectSnapshotCommand});var i=n(23107),s=n(93037),r=n(36407),o=n(83773);class CaptureSnapshotCommand extends s.m{constructor(e){super(),this.id="CAPTURE_SNAPSHOT",this.payload={maxSize:e.maxSize||r.SL.ULTRAHIGH,aspect:e.aspect||o.g$,category:e.category||i.i.USER,onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}class EquirectSnapshotCommand extends s.m{constructor(e){super(),this.id="EQUIRECTANGULAR_SNAPSHOT",this.payload={onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}},72096:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SnapshotsEditor});var i=n(57227),s=n(14877),r=n(53549),o=n(15099),a=n(22878),l=n(37363),c=n(93093),d=n(17566),u=n(33357),h=n(22808),p=n(40386),m=n(33299),f=n(36407),g=n(994),v=n(9446),y=n(67779),b=n(21938),S=n(77280),E=n(83773),T=n(26517),w=n(81276),x=n(40603);class SnapshotCaptureError extends x.y{constructor(e,t="72002"){super(e),this.name="SnapshotCaptureError"}}class SnapshotUploadError extends x.y{constructor(e,t="73002"){super(e),this.name="SnapshotUploadError"}}var _,M=n(23107),O=n(56044),A=n(94772),C=n(81402),N=n(48730),D=n(2050);!function(e){e.CAPTURING="capturing",e.UPLOADING="uploading",e.ERROR="error",e.DONE="done"}(_||(_={}));var I=n(1129),L=n(13088);const P=p.Xd.uploadIntervalDelay;class SnapshotsEditor extends i.Y{constructor(){super(...arguments),this.name="snapshots-editor"}async init(e,t){this.engine=t,[this.renderer,this.sweepTilingModule]=await Promise.all([t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.getModuleBySymbol(s.y.SWEEP_PANO)]),[this.sweepData,this.viewmodeData,this.cameraData,this.floorsViewData]=await Promise.all([t.market.waitForData(r.Z),t.market.waitForData(l.O),t.market.waitForData(o.M_),t.market.waitForData(O.c),t.market.waitForData(b.P)]),[this.snapshotTarget,this.snapshotOverlayTarget]=await Promise.all([t.commandBinder.issueCommandWhenBound(new c.oM),t.commandBinder.issueCommandWhenBound(new c.oM)]),this.bindings.push(t.commandBinder.addBinding(v.E,(async e=>{const n=e.onProgress||(0,y.Y)(0);n.value=10,t.commandBinder.issueCommand(new N.ZK),t.commandBinder.issueCommand(new L.M);const i=await this.queryIdealResolution(e.maxSize,e.aspect);this.snapshotTarget.setSize(i.width,i.height),this.snapshotOverlayTarget.setSize(i.width,i.height),await this.fetchHighestAvailable(!1,e.maxSize,(e=>n.value=Math.max(10,e))),await(0,C.gw)(2*P),await this.takeScreenshot();const s=this.sweepData.getSweep(this.sweepData.currentSweep);this.viewmodeData.currentMode===a.Ey.Panorama&&await this.sweepTilingModule.resetSweep(s.id),t.commandBinder.issueCommand(new N.Lp),t.commandBinder.issueCommand(new L.I);let r=e.category;s&&(s.alignmentType===A.z9.UNALIGNED||s.placementType===A.hU.MANUAL)&&r===M.i.USER&&(r=M.i.UNALIGNED);const o=this.uploadAndAddSnapshot(r).then((e=>e&&e.sid)).catch((e=>{throw this.log.error(e),this.engine.broadcast(new w.q(e)),e}));return e.waitForUpload?o:null})));const n=S.f.FORWARD.clone(),i=S.f.FORWARD.clone();this.bindings.push(t.commandBinder.addBinding(v.e,(async e=>{const s=e.onProgress||(0,y.Y)(0);s.value=10,t.commandBinder.issueCommand(new N.ZK),await(0,C.gw)(50);const r=this.queryIdealEqResolution();this.snapshotTarget.setSize(r.width,r.height);const o=this.sweepData.getSweep(this.sweepData.currentSweep);n.copy(S.f.FORWARD).applyQuaternion(o.rotation).setY(0),i.copy(S.f.FORWARD).applyQuaternion(this.cameraData.pose.rotation).setY(0);const a=(0,T.k2)(n,i)+Math.PI;await this.fetchHighestAvailable(!0,f.SL.ULTRAHIGH,(e=>s.value=Math.max(10,e))),await this.takeEquirectangular(a),await this.sweepTilingModule.resetSweep(o.id),t.commandBinder.issueCommand(new N.Lp);const l=(0,d.fY)(this.snapshotTarget.width,this.snapshotTarget.height,a,0),c=this.uploadAndAddSnapshot(M.i.PANORAMA,l).then((e=>e&&e.sid)).catch((e=>{throw this.log.error(e),this.engine.broadcast(new w.q(e)),e}));return e.waitForUpload?c:null})))}async uploadAndAddSnapshot(e,t){const n=this.createSnapshot(e);n.state=_.CAPTURING,n.imageBlob=(0,d.Xk)(await(0,d.vP)(this.snapshotTarget,t)),n.state=_.UPLOADING;try{return await this.engine.commandBinder.issueCommand(new I.nM(n))}catch(e){throw n.state=_.ERROR,this.log.error(e),new SnapshotUploadError(e)}}createSnapshot(e){const t=this.viewmodeData.isInside();let n=(0,C.DZ)(new Date);if(t){const e=this.sweepData.getSweep(this.sweepData.currentSweep).name;e&&(n=e)}const i=new D.a;return i.name=n,i.category=e,i.is360=t&&!this.sweepData.currentAlignedSweepObject,i.metadata={cameraMode:this.viewmodeData.currentMode,cameraPosition:this.cameraData.pose.position.clone(),cameraQuaternion:this.cameraData.pose.rotation.clone(),orthoZoom:this.viewmodeData.currentMode===a.Ey.Floorplan?this.cameraData.zoom():-1,ssZoom:this.cameraData.zoom(),scanId:t?this.sweepData.currentSweep:void 0,floorId:this.floorsViewData.currentFloorId,floorVisibility:this.floorsViewData.getFloorsVisibility()},i}async queryIdealResolution(e=f.SL.ULTRAHIGH,t){let n=3840,i=n*E.LP;const s=this.renderer.maxTextureSize;if(n>s&&(this.log.warn(`The active gl context does not support 4k x 2k equirectangular capture\nCapture is limited to a max size of ${s}`),n=s,i=n*E.LP),this.viewmodeData.currentMode===a.Ey.Panorama){const r=await this.sweepTilingModule.availableResolution(this.sweepData.currentSweepObject,e),o=u.Z.getPanoSize(r)*(this.cameraData.fovY()*g.MN)/90;n=Math.min(Math.round(o*t),s),i=Math.round(n/t)}return Promise.resolve({width:n,height:i})}queryIdealEqResolution(){let e=4096,t=.5*e;if(this.viewmodeData.currentMode!==a.Ey.Panorama)throw new SnapshotCaptureError("Equirectangular capture is only supported in Panorama mode");const n=this.renderer.maxTextureSize;return e>n&&this.log.warn(`The active gl context does not support 4k x 2k equirectangular capture\nCapture is limited to a max size of ${n}`),e=Math.min(n,e),t=.5*e,{width:e,height:t}}fetchHighestAvailable(e,t=f.SL.ULTRAHIGH,n){if(this.viewmodeData.currentMode===a.Ey.Panorama){const i=this.sweepData.currentSweepObject,s=e?h.v.FullPanorama:h.v.CurrentView;return this.sweepTilingModule.requestResolution(i,t,s,!0).then((e=>{const t=this.sweepTilingModule.waitForQueue(s,e);return n&&t.progress((e=>n(e*SnapshotsEditor.captureProgressFudgeFactor))),t.nativePromise()}))}return n&&n(SnapshotsEditor.captureProgressFudgeFactor),Promise.resolve()}takeScreenshot(){const e=m.o.ALL;e.removeLayers(this.engine.getRenderLayer("grid-underlay")),e.removeLayers(this.engine.getRenderLayer("cursor-mesh")),e.removeLayers(this.engine.getRenderLayer("current-pano-marker"));const t=this.renderer.getScene().scene,n=this.renderer.getScene().camera,i=n.layers.mask;return n.layers.mask=e.mask,this.engine.commandBinder.issueCommand(new c.vU(this.snapshotTarget,t,n)).then((()=>{n.layers.mask=i}))}takeEquirectangular(e){const t=this.sweepData.currentSweep,n=this.sweepTilingModule.getRenderer(),i=n.useTexture(t),s=this.engine.commandBinder.issueCommand(new c.fZ(this.snapshotTarget,i,e));return n.freeTexture(t),s}}SnapshotsEditor.captureProgressFudgeFactor=90},81276:(e,t,n)=>{"use strict";n.d(t,{q:()=>SnapshotErrorMessage});var i=n(4117);class SnapshotErrorMessage extends i.v{constructor(e){super(),this.error=e}}},2050:(e,t,n)=>{"use strict";n.d(t,{a:()=>Snapshot});var i=n(98254),s=n(22878),r=n(23107);class Snapshot extends i.T{constructor(){super(),this.category=r.i.USER}clone(){return(new Snapshot).copy(this)}copy(e){return this.sid=e.sid,this.thumbnailUrl=e.thumbnailUrl,this.imageUrl=e.imageUrl,this.name=e.name,this.is360=e.is360,this.category=e.category,this.height=e.height,this.width=e.width,this.created=e.created,this.modified=e.modified,this.visionLabel=e.visionLabel,this.visionName=e.visionName,this.imageBlob=e.imageBlob,this.metadata={cameraMode:e.metadata.cameraMode,cameraPosition:e.metadata.cameraPosition.clone(),cameraQuaternion:e.metadata.cameraQuaternion.clone(),scanId:e.metadata.scanId,orthoZoom:e.metadata.orthoZoom,ssZoom:e.metadata.ssZoom,floorId:e.metadata.floorId,floorVisibility:e.metadata.floorVisibility},this.commit(),this}isInsidePano(){return this.metadata.cameraMode===s.Ey.Panorama&&""!==this.metadata.scanId}refresh(e){this.thumbnailUrl.refreshFrom(e.thumbnailUrl),this.imageUrl.refreshFrom(e.imageUrl)}}},23107:(e,t,n)=>{"use strict";var i;n.d(t,{i:()=>i}),function(e){e.USER="user",e.PANORAMA="panorama",e.UNALIGNED="unaligned",e.AUTO="auto",e.TOUR="tour"}(i||(i={}))},1129:(e,t,n)=>{"use strict";n.d(t,{yz:()=>RenameSnapshotCommand,Ad:()=>DeleteSnapshotCommand,nM:()=>UploadSnapshotCommand});var i=n(93037);class RenameSnapshotCommand extends i.m{constructor(e,t){super(),this.id="RENAME_SNAPSHOT",this.payload={id:e,name:t}}}class DeleteSnapshotCommand extends i.m{constructor(e){super(),this.id="DELETE_SNAPSHOT",this.payload={id:e}}}class UploadSnapshotCommand extends i.m{constructor(e){super(),this.id="UPLOAD_SNAPSHOT",this.payload={snapshot:e}}}},21938:(e,t,n)=>{"use strict";n.d(t,{P:()=>SnapshotsData});var i=n(35424),s=n(81402),r=n(28129);class SnapshotsData extends i.V{constructor(e){super(),this.name="snapshots",this.snapshots={};for(const t in e)this.snapshots[t]=e[t].clone()}get(e){return this.snapshots[e]}get collection(){return this.snapshots}add(e){e.sid=this.validateSid(e.sid),this.snapshots[e.sid]=e,this.updateOnStaleCallbacks(),this.commit()}remove(e){delete this.snapshots[e.sid],this.commit()}validateSid(e){for(;!e||this.snapshots[e];)e=(0,s.O1)(11);return e}set onStale(e){this.hydrate=e,this.updateOnStaleCallbacks()}updateOnStaleCallbacks(){this.hydrate&&(0,r.s)(this.snapshots,(async()=>{const e=await this.hydrate();for(const t in this.snapshots)e&&e[t]&&this.snapshots[t].refresh(e[t])}))}}},17698:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SnapshotsDataModule});var i=n(57227),s=n(22878),r=n(53549),o=n(21938),a=n(70778),l=n(66225),c=n(38636),d=n(10943),u=n(61233),h=n(50889),p=n(63387),m=n(65),f=n(23107);const g={[s.Ey.Dollhouse]:u.w.DOLLHOUSE,[s.Ey.Floorplan]:u.w.FLOORPLAN,[s.Ey.Panorama]:u.w.PANORAMA,[s.Ey.Outdoor]:u.w.PANORAMA,[s.Ey.Transition]:u.w.MESH,[s.Ey.Orthographic]:u.w.MESH,[s.Ey.Mesh]:u.w.MESH};class MdsSnapshotUploadSerializer{constructor(){}serialize(e,t){const n=[];for(const[i,s]of e.metadata.floorVisibility.entries())if(1===s){const e=t.floorsData.getFloorAtIndex(i);e&&n.push(e.id)}return{label:e.name,contents:{filename:`${e.name}.jpg`,blob:e.imageBlob},snapshotLocation:{anchorId:e.metadata.scanId,visibleFloorIds:n,position:(0,m.m)(p.ep.toVisionVector(e.metadata.cameraPosition)),rotation:(0,m.J5)(p.ep.toVisionCameraQuaternion(e.metadata.cameraQuaternion)),viewMode:g[e.metadata.cameraMode],zoom:e.metadata.cameraMode===s.Ey.Floorplan?e.metadata.orthoZoom:e.metadata.ssZoom},photoType:e.category===f.i.PANORAMA?h.B.EQUIRECTANGULAR:h.B.PHOTO2D}}}class MdsSnapshotStore extends l.u{constructor(){super(...arguments),this.deserializer=new d.f,this.serializer=new MdsSnapshotUploadSerializer,this.prefetchKey="data.model.assets.photos"}async read(e){const t={modelId:this.getViewId()};return this.query(a.GetSnapshots,t,e).then((e=>{var t,n,i;const s=((null===(i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.assets)||void 0===i?void 0:i.photos)||[]).map((e=>this.deserializer.deserialize(e))),r={};for(const e of s)e&&(r[e.sid]=e);return r}))}async refresh(){return this.refreshPromise||(this.refreshPromise=this.read({fetchPolicy:"no-cache"}).finally((()=>{this.refreshPromise=void 0}))),this.refreshPromise}async create(e,t){const n=l.u.baseViewId,i=e.category===f.i.TOUR,s=i?"UploadHighlightReelSnapshot":"UploadModelSnapshot",r=i?a.UploadHighlightReelSnapshot:a.UploadModelSnapshot,o=this.serializer.serialize(e,t);return this.client.upload(r,s,Object.assign(Object.assign({},o),{modelId:n})).then((e=>{var t;return this.deserializer.deserialize(null===(t=e.data)||void 0===t?void 0:t.snapshot)}))}async update(e){const t=l.u.baseViewId,n=await this.client.mutate(a.PatchPhoto,{modelId:t,photoId:e.sid,label:e.name}),i=(0,c.q)(n,"data.patchPhoto");return this.deserializer.deserialize(i)}async delete(e){const t=l.u.baseViewId,n=await this.client.mutate(a.DeletePhoto,{modelId:t,photoId:e});return(0,c.q)(n,"data.deletePhoto")||!1}}var v=n(1129),y=n(5773),b=n(39823);class SnapshotsDataModule extends i.Y{constructor(){super(...arguments),this.name="snapshots-data"}async init(e,t){const{readonly:n,baseUrl:i}=e;this.engine=t,this.store=new MdsSnapshotStore({readonly:n,baseUrl:i});const s=await this.store.read()||{};this.sweepData=await t.market.waitForData(r.Z);for(const e in s)this.processSnapshot(s[e]);this.snapshotsData=new o.P(s),this.snapshotsData.onStale=()=>this.store.read(),t.market.register(this,o.P,this.snapshotsData),n||this.bindings.push(t.commandBinder.addBinding(v.nM,(({snapshot:e})=>this.uploadSnapshot(e))),t.commandBinder.addBinding(v.yz,(({id:e,name:t})=>this.renameSnapshot(e,t))),t.commandBinder.addBinding(v.Ad,(({id:e})=>this.deleteSnapshot(e))))}async uploadSnapshot(e){const t=await this.engine.market.waitForData(b.i),n=await this.store.create(e,{floorsData:t});return n&&(this.processSnapshot(n),this.snapshotsData.add(n),this.engine.broadcast(new y.t(n))),n}async renameSnapshot(e,t){const n=this.snapshotsData.get(e);if(t!==n.name)return n.name=t,n.commit(),this.snapshotsData.commit(),this.store.update(n)}async deleteSnapshot(e){return this.store.delete(e)}processSnapshot(e){const t=e.metadata.cameraMode===s.Ey.Panorama,n=!this.sweepData.isSweepAligned(e.metadata.scanId);if(e.is360=t&&n,t){const t=this.sweepData.getSweep(e.metadata.scanId);t&&e.metadata.cameraPosition.copy(t.position)}e.name.match(/^[0-9.]+_[0-9.]+$/)&&(e.name="")}}},5773:(e,t,n)=>{"use strict";n.d(t,{t:()=>SnapshotCreatedMessage});var i=n(4117);class SnapshotCreatedMessage extends i.v{constructor(e){super(),this.snapshot=e}}},10943:(e,t,n)=>{"use strict";n.d(t,{f:()=>MdsSnapshotDeserializer});var i,s,r=n(2212);!function(e){e.SNAPSHOT="snapshot",e.TOUR="tour"}(i||(i={})),function(e){e.USER="user",e.VISION="vision"}(s||(s={}));var o=n(36886),a=n(61233),l=n(50889),c=n(22878),d=n(5477),u=n(63387),h=n(38636),p=n(63336),m=n(2050),f=n(23107),g=n(28129);const v=new d.Z("mds-snapshot-deserializer");class MdsSnapshotDeserializer{deserialize(e){if(!e||!this.validate(e))return v.debug("Deserialized invalid Snapshot data from MDS",e),null;const t=new m.a;t.sid=e.id,t.thumbnailUrl=new g.n(e.thumbnailUrl||"",(0,p.p)(e.validUntil,null)),t.imageUrl=new g.n(e.presentationUrl||"",(0,p.p)(e.validUntil,null)),t.name=e.label||"",t.category=this.getCwfSnapshotCategory(e)||f.i.USER,t.width=e.width||0,t.height=e.height||0,t.created=(0,p.p)(e.created),t.modified=(0,p.p)(e.modified),t.visionLabel=e.classification||"";const n=(0,h.q)(e,"snapshotLocation.anchor.pano.placement");t.is360=!(!n||n===o.b.AUTO);const{snapshotLocation:i}=e;if(i){const e=i.position?u.ep.fromVisionVector(i.position):new r.Vector3,n=i.rotation?u.ep.fromVisionCameraQuaternion(i.rotation):new r.Quaternion,s=this.getCwfViewmode(i.viewMode)||c.Ey.Panorama,o=[];for(const e of i.floorVisibility){for(let t=0;t<e.sequence;t++)o[t]=o[t]||0;o[e.sequence]=1}t.metadata={cameraMode:s,cameraPosition:e,cameraQuaternion:n,scanId:i.anchor&&i.anchor.id||"",orthoZoom:s===c.Ey.Floorplan?i.zoom:-1,ssZoom:i.zoom||1,floorId:i.floorVisibility.length>0?i.floorVisibility[0].id:null,floorVisibility:o}}return t}validate(e){var t;if(!(null===(t=e.snapshotLocation)||void 0===t?void 0:t.position))return!1;const n=["id","snapshotLocation","thumbnailUrl","presentationUrl"].every((t=>t in e)),i=null!==this.getCwfSnapshotCategory(e);return n&&i}getCwfViewmode(e){const t={[a.w.DOLLHOUSE]:c.Ey.Dollhouse,[a.w.PANORAMA]:c.Ey.Panorama,[a.w.FLOORPLAN]:c.Ey.Floorplan,[a.w.MESH]:c.Ey.Panorama};return e in t?t[e]:null}getCwfSnapshotCategory(e){if(e.category===i.TOUR)return f.i.TOUR;if(e.origin===s.VISION)return f.i.AUTO;if(e.type===l.B.EQUIRECTANGULAR)return f.i.PANORAMA;const t=(0,h.q)(e,"snapshotLocation.anchor.pano.placement");return e.type===l.B.PHOTO2D?t===o.b.MANUAL?f.i.UNALIGNED:f.i.USER:null}}},48697:(e,t,n)=>{"use strict";n.d(t,{Q:()=>StorageData});var i=n(35424),s=n(52012);class StorageData extends i.V{constructor(e={}){super(),this.lastPublished=null,this.hasRevertableChanges=!1,this.hasPublishableChanges=!1,this.publishEnabled=!1,this.revertEnabled=!1,this.transactionState=s.g.IDLE,this.dirtyTypes=new Set,this.publishableTypes=new Set,this.revertableTypes=new Set,Object.assign(this,e)}setTransactionState(e){if(e!==this.transactionState){if(![this.transactionState,e].includes(s.g.IDLE))throw new Error(`Cannot transition from ${this.transactionState} to ${e}`);this.transactionState=e,this.commit()}}getDirtyTypes(){return[...this.dirtyTypes]}setDirtyType(...e){for(const t of e)this.dirtyTypes.add(t);this.onDataTypesChanged()}clearDirtyType(...e){if(e.length)for(const t of e)this.dirtyTypes.delete(t);else this.dirtyTypes.clear();this.onDataTypesChanged()}getPublishableTypes(){return[...this.publishableTypes]}setPublishableType(...e){for(const t of e)this.publishableTypes.add(t);this.onDataTypesChanged()}clearPublishableType(...e){if(e.length)for(const t of e)this.publishableTypes.delete(t);else this.publishableTypes.clear();this.onDataTypesChanged()}getRevertableTypes(){return[...this.revertableTypes]}setRevertableType(...e){for(const t of e)this.revertableTypes.add(t);this.onDataTypesChanged()}clearRevertableType(...e){if(e.length)for(const t of e)this.revertableTypes.delete(t);else this.revertableTypes.clear();this.onDataTypesChanged()}onDataTypesChanged(){this.hasRevertableChanges=[...this.dirtyTypes].some((e=>this.revertableTypes.has(e))),this.hasPublishableChanges=[...this.dirtyTypes].some((e=>this.publishableTypes.has(e))),this.commit()}}},7819:(e,t,n)=>{"use strict";n.d(t,{F:()=>StorageModule});var i,s=n(57227),r=n(5673),o=n(96141),a=n(21396),l=n(67233),c=n(47063),d=n(7164),u=n(5005),h=n(90237),p=n(36154),m=n(53306),f=n(38636),g=n(87100),v=n(52549),y=n(5477);!function(e){e.IMAGE="image",e.FLOORS="floors",e.MEASUREMENT_PATHS="measurementPaths",e.MATTERTAGS="mattertags",e.LABELS="labels",e.HIGHLIGHT_REEL="highlightReel",e.SWEEPS="sweeps",e.PLAYER_OPTIONS="playerOptions",e.ORDERED_LISTS="orderedLists"}(i||(i={}));class ModelViewDiff{constructor(e={}){Object.assign(this,e)}}const b=new y.Z("mds-mergediff-deserializer"),S={[v.g.FLOORS]:i.FLOORS,[v.g.MEASUREMENTS]:i.MEASUREMENT_PATHS,[v.g.MATTERTAGS]:i.MATTERTAGS,[v.g.LABELS]:i.LABELS,[v.g.HIGHLIGHTS]:i.HIGHLIGHT_REEL,[v.g.SWEEPS]:i.SWEEPS,[v.g.SETTINGS]:i.PLAYER_OPTIONS,[v.g.START_LOCATION]:i.IMAGE,[v.g.ORDERED_LISTS]:i.ORDERED_LISTS,[v.g.BLURS]:void 0},E={[i.IMAGE]:v.g.START_LOCATION,[i.FLOORS]:v.g.FLOORS,[i.MEASUREMENT_PATHS]:v.g.MEASUREMENTS,[i.MATTERTAGS]:v.g.MATTERTAGS,[i.LABELS]:v.g.LABELS,[i.HIGHLIGHT_REEL]:v.g.HIGHLIGHTS,[i.SWEEPS]:v.g.SWEEPS,[i.PLAYER_OPTIONS]:v.g.SETTINGS,[i.ORDERED_LISTS]:v.g.ORDERED_LISTS};class MergeDiffDeserializer{deserialize(e){if(!(e&&e.src&&e.dest&&e.typesModified))return b.debug("Deserialized invalid merge diff from MDS",e),null;const t=[];for(const n of e.typesModified)n in E&&t.push(E[n]);return new ModelViewDiff({srcId:e.src,targetId:e.dest,dataTypes:t})}}class PublishingManager{constructor(e,t){this.modelId=e,this.client=t}async getMergeDiff(e){const t=new MergeDiffDeserializer,n=await this.client.query(m.GetMergeDiff,{viewId:e}).catch((e=>{throw new u.Zb(e)})),i=(0,f.q)(n,"data.model.mergeDiff");return t.deserialize(i)}async getUnpublishedDeletions(){const e=await this.client.query(m.GetSessionDiff,{modelId:this.modelId}).catch((e=>{throw new u.Zb(e)})),t=(0,f.q)(e,"data.model.base"),n=(0,f.q)(e,"data.model.view"),i=(e,t,n)=>{const i=t.map((e=>e[n]));return e.filter((e=>!i.includes(e[n])))},s=i(t.model.mattertags,n.model.mattertags,"id"),r=i(t.model.labels,n.model.labels,"id"),o=i(t.model.measurementPaths,n.model.measurementPaths,"id");return{[v.g.LABELS]:r,[v.g.MATTERTAGS]:s,[v.g.MEASUREMENTS]:o}}async revertView(e,t=[]){const n=t.map((e=>S[e])).filter((e=>!!e));if(!n.length)return;const i=await this.client.query(m.RevertView,{viewId:e,mergeTypes:n}).catch((e=>{throw new u.w0(e)})),s="53300"===(0,g.eY)("error","");if(!r.w.isOk(i)||s){const e=new u.w0(r.w.getErrorMessage(i));throw s&&(e.isMock=!0),e}}async mergeView(e){const t=await this.client.query(m.PublishView,{viewId:e}).catch((e=>{throw new u.w0(e)})),n="53200"===(0,g.eY)("error","");if(!r.w.isOk(t)||n){const e=new u.w0(r.w.getErrorMessage(t));throw n&&(e.isMock=!0),e}}}var T=n(48697),w=n(52012),x=n(91183);class StorageModule extends s.Y{constructor(){super(...arguments),this.name="storage",this.saveHandlers=new Set,this.revertHandlers=new Set,this.publishHandlers=new Set,this.lock=new o.H,this.updateForView=async()=>{const e=this.data,t=this.layersData.getCurrentView();if(t&&t.viewType===a.X.SESSION){e.publishEnabled=!0,e.revertEnabled=!0;const n=await this.publishingManager.getMergeDiff(t.id);n&&n.dataTypes&&this.data.setDirtyType(...n.dataTypes)}else e.publishEnabled=!1,e.revertEnabled=!1}}async init(e,t){const{baseUrl:n,modelId:i}=e;this.config=e,this.engine=t,this.client=new r.w({baseUrl:n}),this.publishingManager=new PublishingManager(i,this.client),this.data=new T.Q,this.layersData=await t.market.waitForData(l.R),this.updateForView(),this.bindings.push(this.layersData.onPropertyChanged("currentViewId",(()=>this.updateForView())),t.commandBinder.addBinding(c.R_,(e=>this.publish(e.dataTypes))),t.commandBinder.addBinding(c.qz,(e=>this.revert(e.dataTypes))),t.commandBinder.addBinding(c.VQ,(e=>this.save(e.dataTypes))),t.commandBinder.addBinding(c.ff,(()=>this.publishingManager.getUnpublishedDeletions()))),t.market.register(this,T.Q,this.data)}dispose(e){super.dispose(e)}onSave(e,t={}){const n={callback:e,dataType:t.dataType,phase:t.phase||w.Q.ON};return(0,x.k1)((()=>this.saveHandlers.add(n)),(()=>this.saveHandlers.delete(n)),!0)}onPublish(e,t={}){const n={callback:e,dataType:t.dataType,phase:t.phase||w.Q.ON};return(0,x.k1)((()=>this.publishHandlers.add(n)),(()=>this.publishHandlers.delete(n)),!0)}onRevert(e,t={}){const n={callback:e,dataType:t.dataType,phase:t.phase||w.Q.ON};return(0,x.k1)((()=>this.revertHandlers.add(n)),(()=>this.revertHandlers.delete(n)),!0)}async publish(e=[]){const t=await this.lock.lock(),n=n=>{this.log.error(n),t.unlock(),this.data.setTransactionState(w.g.IDLE);const s=i[0]?`532${(0,d.DT)(i[0])}`:"53200";if(n instanceof h.V2||n instanceof h.GT){const t=new d.lY(n,s);throw this.engine.broadcast(new p.hu(t,e)),t}const r=new d.gO(n,s);throw this.engine.broadcast(new p.aT(r,e)),r},i=e.length?[...e]:this.data.getPublishableTypes(),{before:s,on:r,after:o}=this.getCallbacksByPhase(this.publishHandlers,i),a=this.layersData.getWorkshopSessionView();a&&r.push((()=>this.publishingManager.mergeView(a.id))),this.log.debug(`Publishing ${[...i].join(", ")}...`),this.data.setTransactionState(w.g.PUBLISHING),await Promise.all(s.map((e=>e()))).catch(n),await Promise.all(r.map((e=>e()))).catch(n),this.data.lastPublished=Date.now(),this.data.commit(),this.data.clearDirtyType(...e),this.engine.broadcast(new p.zK),await Promise.all(o.map((e=>e()))).catch(n),t.unlock(),this.data.setTransactionState(w.g.IDLE),this.log.debug("Publishing completed")}async revert(e=[]){const t=await this.lock.lock(),n=n=>{t.unlock(),this.data.setTransactionState(w.g.IDLE);const i=e[0]?`531${(0,d.DT)(e[0])}`:"53100",s=new d.P8(n,i);throw this.engine.broadcast(new p.Kx(s,e)),s},{before:i,on:s,after:r}=this.getCallbacksByPhase(this.revertHandlers,e),o=this.layersData.getWorkshopSessionView();o?(s.push((()=>this.publishingManager.revertView(o.id,e))),this.log.debug(`Reverting ${[...e].join(", ")}...`),this.data.setTransactionState(w.g.REVERTING),await Promise.all(i.map((e=>e()))).catch(n),await Promise.all(s.map((e=>e()))).catch(n),this.engine.broadcast(new p.F1(e)),await Promise.all(r.map((e=>e()))).catch(n),t.unlock(),this.data.setTransactionState(w.g.IDLE),this.data.clearDirtyType(...e),this.log.debug(`Reverting ${[...e].join(", ")} completed`)):n(new u.SN("Workshop session view not found"))}async save(e){const{before:t,on:n,after:i}=this.getCallbacksByPhase(this.saveHandlers,e),s=await this.lock.lock(),r=t=>{this.log.error(t),s.unlock(),this.data.setTransactionState(w.g.IDLE);const n=e[0]?`531${(0,d.DT)(e[0])}`:"53100";if(t instanceof h.V2||t instanceof h.GT){const i=new d.lY(t,n);throw this.engine.broadcast(new p.hu(i,e)),i}const i=new d.pd(t,n);throw this.engine.broadcast(new p.dz(i,e)),i};this.log.debug(`Saving ${[...e].join(", ")}...`),this.data.setTransactionState(w.g.SAVING),await Promise.all(t.map((e=>e()))).catch(r),await Promise.all(n.map((e=>e()))).catch(r),this.engine.broadcast(new p.xj(e)),await Promise.all(i.map((e=>e()))).catch(r),this.data.setDirtyType(...e),s.unlock(),this.data.setTransactionState(w.g.IDLE),this.log.debug(`Saving ${[...e].join(", ")} completed`)}getCallbacksByPhase(e,t){const n=Array.isArray(t)?t:Object.values(v.g),i=[...e.values()].filter((e=>!e.dataType||n.includes(e.dataType))),s={[w.Q.BEFORE]:[],[w.Q.ON]:[],[w.Q.AFTER]:[]};return i.reduce(((e,t)=>(e[t.phase].push((()=>t.callback(n))),e)),s)}}},72021:(e,t,n)=>{"use strict";n.d(t,{T:()=>StorageAnalytics});var i=n(36154),s=n(96557);class StorageAnalytics{constructor(){this.handlers=[{msgType:i.Qq,func:(e,t)=>{const{dataType:n,message:i,mockError:s}=t,r="DataIntegrityError",o={error_type:r,error_dialog:"none",data_type:n,exception:{message:`${r}: ${i}`},mock_error:s};e.track("error_displayed",o)}},{msgType:i.dz,func:(e,t)=>{const{dataTypes:n,error:i}=t,r=i.name||"SaveError",o={error_code:(0,s.UX)(i).join(", "),error_type:r,error_dialog:"banner",data_type:n?n.join(", "):"",exception:{message:`${r}: ${i.message}`,stack:i.stack},mock_error:(0,s.Ad)(i)};e.track("error_displayed",o)}},{msgType:i.Kx,func:(e,t)=>{const{dataTypes:n,error:i}=t,r=i.name||"RevertError",o={error_code:(0,s.UX)(i).join(", "),error_type:r,error_dialog:"banner",data_type:n?n.join(", "):"",exception:{message:`${i.name||r}: ${i.message}`,stack:i.stack},mock_error:(0,s.Ad)(i)};e.track("error_displayed",o)}},{msgType:i.aT,func:(e,t)=>{const{dataTypes:n,error:i}=t,r=i.name||"PublishError",o={error_code:(0,s.UX)(i).join(", "),error_type:r,error_dialog:"banner",data_type:n?n.join(", "):"",exception:{message:`${r}: ${i.message}`,stack:i.stack},mock_error:(0,s.Ad)(i)};e.track("error_displayed",o)}}]}}},47063:(e,t,n)=>{"use strict";n.d(t,{R_:()=>PublishCommand,qz:()=>RevertCommand,VQ:()=>SaveCommand,ff:()=>GetUnpublishedDeletionsCommand});var i=n(93037);class PublishCommand extends i.m{constructor(e={}){super(),this.id="PUBLISH_COMMAND",this.payload=e}}class RevertCommand extends i.m{constructor(e){super(),this.id="REVERT_COMMAND",this.payload=e}}class SaveCommand extends i.m{constructor(e){super(),this.id="SAVE_COMMAND",this.payload=e}}class GetUnpublishedDeletionsCommand extends i.m{constructor(){super(...arguments),this.id="GET_UNPUBLISHED_DELETIONS_COMMAND"}}},52012:(e,t,n)=>{"use strict";var i,s;n.d(t,{g:()=>i,Q:()=>s}),function(e){e.IDLE="idle",e.REVERTING="reverting",e.PUBLISHING="publishing",e.SAVING="saving"}(i||(i={})),function(e){e.ON="on",e.BEFORE="before",e.AFTER="after"}(s||(s={}))},7164:(e,t,n)=>{"use strict";n.d(t,{AE:()=>StorageError,lY:()=>ForbiddenError,pd:()=>SaveError,gO:()=>PublishError,P8:()=>RevertError,DT:()=>r});var i=n(40603),s=n(52549);class StorageError extends i.y{constructor(e,t="50001"){super(e),this.name="StorageError",this.code=t}}class ForbiddenError extends i.y{constructor(e,t="53100"){super(e),this.name="ForbiddenError",this.code=t}}class SaveError extends i.y{constructor(e,t="53100"){super(e),this.name="SaveError",this.code=t}}class PublishError extends i.y{constructor(e,t="53200"){super(e),this.name="PublishError",this.code=t}}class RevertError extends i.y{constructor(e,t="53300"){super(e),this.name="RevertError",this.code=t}}function r(e){return{[s.g.BLUR_SUGGESTIONS]:"12",[s.g.BLURS]:"01",[s.g.FLOORS]:"02",[s.g.HIGHLIGHTS]:"03",[s.g.LABELS]:"04",[s.g.MATTERTAGS]:"05",[s.g.MEASUREMENTS]:"06",[s.g.NOTES]:"07",[s.g.ORDERED_LISTS]:"13",[s.g.PHOTOS]:"08",[s.g.SETTINGS]:"09",[s.g.START_LOCATION]:"10",[s.g.SWEEPS]:"11"}[e]||"99"}},99157:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GetUnpublishedDeletionsCommand:()=>i.ff,PublishCommand:()=>i.R_,RevertCommand:()=>i.qz,SaveCommand:()=>i.VQ,TransactionPhase:()=>s.Q,TransactionState:()=>s.g,ForbiddenError:()=>r.lY,PublishError:()=>r.gO,RevertError:()=>r.P8,SaveError:()=>r.pd,StorageError:()=>r.AE,getErrorCodeForDataType:()=>r.DT,DataIntegrityMessage:()=>o.Qq,DataPublishedMessage:()=>o.zK,DataRevertedMessage:()=>o.F1,DataSavedMessage:()=>o.xj,ForbiddenErrorMessage:()=>o.hu,PublishErrorMessage:()=>o.aT,RevertErrorMessage:()=>o.Kx,SaveErrorMessage:()=>o.dz,StorageAnalytics:()=>a.T,StorageData:()=>l.Q,default:()=>c.F});var i=n(47063),s=n(52012),r=n(7164),o=n(36154),a=n(72021),l=n(48697),c=n(7819)},36154:(e,t,n)=>{"use strict";n.d(t,{xj:()=>DataSavedMessage,zK:()=>DataPublishedMessage,F1:()=>DataRevertedMessage,Qq:()=>DataIntegrityMessage,dz:()=>SaveErrorMessage,Kx:()=>RevertErrorMessage,aT:()=>PublishErrorMessage,hu:()=>ForbiddenErrorMessage});var i=n(4117);class DataSavedMessage extends i.v{constructor(e){super(),this.dataTypes=e}}class DataPublishedMessage extends i.v{}class DataRevertedMessage extends i.v{constructor(e){super(),this.dataTypes=e}}class DataIntegrityMessage extends i.v{constructor(e,t,n=!1){super(),this.message=e,this.dataType=t,this.mockError=n}}class SaveErrorMessage extends i.v{constructor(e,t=[]){super(),this.error=e,this.dataTypes=t}}class RevertErrorMessage extends i.v{constructor(e,t=[]){super(),this.error=e,this.dataTypes=t}}class PublishErrorMessage extends i.v{constructor(e,t=[]){super(),this.error=e,this.dataTypes=t}}class ForbiddenErrorMessage extends i.v{constructor(e,t=[]){super(),this.error=e,this.dataTypes=t}}},76031:(e,t,n)=>{"use strict";n.d(t,{M3:()=>i,B_:()=>s,My:()=>r,ED:()=>o,ke:()=>a,FI:()=>l,pr:()=>c,gP:()=>d,Sm:()=>u});const i="subscriber_prompt",s="subscriber-prompt-active",r="subscriber-prompt-active",o=Object.freeze({popupDelay:14500,popupEnabled:!1,bannerEnabled:!1,domainDenylist:["ea4141d5b45bcfce5ac984955a7df9f74b323182","500ef59c0e9bd523a5e102d4b229b85df4c008c2","55d9b1786668eb25ce174aa06d46535054046935","44a68fb615814e263894da681018ed5687527b75","750514616c13561e878f04cd38cedc4bd3028f60","633e98d1f7cf36879e21d642068af2196d67a229","2566065b5d698efd82a16854185501ee2ea8eae6"]}),a={enabled:"spEnabled",forceBanner:"spBanner",forcePopup:"spPopup",forceReferrer:"spReferrer"},l="spaces.visitor.subscriber.prompt",c="mp/subscriber-prompt-dismissed",d="https://matterport.page.link/v2s-download",u="https://go.matterport.com/V2S_SignUp.html?utm_campaign=WF-Global-Visitor-To-Subscriber"},14385:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});const i=new(n(5477).Z)("subscriber-prompt")},65171:(e,t,n)=>{"use strict";n.d(t,{Z:()=>BeginMoveToSweepMessage});var i=n(12757);class BeginMoveToSweepMessage extends i.Z{}},38950:(e,t,n)=>{"use strict";n.d(t,{Z:()=>EndMoveToSweepMessage});var i=n(12757);class EndMoveToSweepMessage extends i.Z{constructor(e,t,n,i){super(e,i),this.alignmentType=t,this.placementType=n}}},12757:(e,t,n)=>{"use strict";n.d(t,{Z:()=>MoveToSweepMessage});var i=n(4117);class MoveToSweepMessage extends i.v{constructor(e,t){super(),this.fromSweep=t,this.toSweep=e,this.timestamp=Date.now()}}},94772:(e,t,n)=>{"use strict";n.d(t,{z9:()=>i,hU:()=>s,ZP:()=>Sweep});var i,s,r=n(2212),o=n(98254),a=n(36407);!function(e){e.ALIGNED="aligned",e.UNALIGNED="unaligned"}(i||(i={})),function(e){e.UNPLACED="unplaced",e.AUTO="auto",e.MANUAL="manual"}(s||(s={}));const l={[a.SL.BASE]:"512",[a.SL.STANDARD]:"1k",[a.SL.HIGH]:"2k",[a.SL.ULTRAHIGH]:"4k"},c={[a.SL.BASE]:"low",[a.SL.STANDARD]:"high",[a.SL.HIGH]:"2k",[a.SL.ULTRAHIGH]:"4k"};class Sweep extends o.T{constructor(e){super(),this.skyboxes={},e&&(e.id&&(this.id=e.id),void 0!==e.index&&(this.index=e.index),this.name=e.name||"",this.position=e.position||new r.Vector3,this.floorPosition=e.floorPosition||new r.Vector3,void 0!==e.floorId&&(this.floorId=e.floorId),this.roomId=e.roomId||null,this.rotation=e.rotation||new r.Quaternion,this.enabled=e.enabled||!1,this.vrenabled=e.vrenabled||!1,this.neighbours=e.neighbours||[],this.alignmentType=e.alignmentType||i.ALIGNED,this.placementType=e.placementType||s.UNPLACED,void 0!==e.uuid&&(this.uuid=e.uuid))}isAligned(){return this.alignmentType===i.ALIGNED}isUnplaced(){return this.placementType===s.UNPLACED}get sid(){return this.id}equals(e){return this.id===e.id&&this.index===e.index&&this.name===e.name&&this.position.equals(e.position)&&this.floorId===e.floorId&&this.roomId===e.roomId&&this.rotation.equals(e.rotation)&&this.enabled===e.enabled&&this.vrenabled===e.vrenabled&&this.alignmentType===e.alignmentType&&this.placementType===e.placementType}copy(e){return this.id=e.id,this.index=e.index,this.name=e.name,this.position=(new r.Vector3).copy(e.position),this.floorPosition=(new r.Vector3).copy(e.floorPosition),this.floorId=e.floorId,this.roomId=e.roomId,this.rotation=(new r.Quaternion).copy(e.rotation),this.enabled=e.enabled,this.vrenabled=e.vrenabled,this.neighbours=e.neighbours.slice(),this.alignmentType=e.alignmentType,this.placementType=e.placementType,this.resolutions=e.resolutions,this.skyboxes=Object.assign({},e.skyboxes),this}refresh(e){this.resolutions=e.resolutions;for(const t in this.skyboxes){const n=t;this.skyboxes[n].refreshFrom(e.skyboxes[n])}}async getTileUrl(e,t,n,i){const s=await this.getSkybox(e);let r;return r=s?s.tileUrlTemplate:`tiles/${this.id}/${l[e]}_face<face>_<x>_<y>.jpg`,r.replace("<face>",`${t}`).replace("<x>",`${n}`).replace("<y>",`${i}`)}async getFaceUrl(e,t){const n=await this.getSkybox(e);let i;return i=n?n.urlTemplate:`pan/${c[e]}/${this.id}_skybox${t}.jpg`,i.replace("<face>",`${t}`)}async getSkybox(e){const t=this.skyboxes[e];return t?t.get():t}}},51381:(e,t,n)=>{"use strict";n.d(t,{WY:()=>SweepStartedRotatingMessage,_G:()=>SweepFinishedRotatingMessage});var i=n(4117);class SweepStartedRotatingMessage extends i.v{constructor(e){super(),this.sweepId=e}}class SweepFinishedRotatingMessage extends i.v{constructor(e){super(),this.sweepId=e}}},28757:(e,t,n)=>{"use strict";n.d(t,{NO:()=>ClearCurrentSweepCommand,aK:()=>SetCurrentSweepCommand,iF:()=>SweepSelectCommand,kR:()=>SweepHoverCommand,e9:()=>ToggleNonPanoCurrentPuckCommand,zd:()=>EnableSweepSelectionCommand,ZD:()=>DisableSweepSelectionCommand});var i=n(93037);class ClearCurrentSweepCommand extends i.m{}class SetCurrentSweepCommand extends i.m{constructor(e){super(),this.sweepId=e,this.payload={sweepId:e}}}class SweepSelectCommand extends i.m{constructor(e,t,n=500){super(),this.id="SELECT_SWEEP",this.payload={id:e,selected:t,duration:n}}}class SweepHoverCommand extends i.m{constructor(e,t,n=500){super(),this.id="HOVER_SWEEP",this.payload={id:e,hovered:t,duration:n}}}class ToggleNonPanoCurrentPuckCommand extends i.m{constructor(e){super(),this.id="TOGGLE_NON_PANO_CURRENT_PUCK",this.payload={visible:e}}}class EnableSweepSelectionCommand extends i.m{constructor(){super(...arguments),this.id="ENABLE_SWEEP_SELECTION"}}class DisableSweepSelectionCommand extends i.m{constructor(){super(...arguments),this.id="DISABLE_SWEEP_SELECTION"}}},53549:(e,t,n)=>{"use strict";n.d(t,{Z:()=>SweepData});var i=n(94772),s=n(35424),r=n(29984),o=n(66910),a=n(41252);class SweepData extends s.V{constructor(e){if(super(),this.name="sweeps",this.transitionActive=!1,this.sweepList=new r.d,this.sweepMap={},e){const t=Object.values(e).sort(((e,t)=>e.index-t.index));for(const e of t)this.sweepMap[e.id]=e,this.sweepList.push(e)}this.transition={progress:new a.z(0),active:!1,from:void 0,to:void 0}}refresh(e){for(const t in this.sweepMap)e[t]&&this.sweepMap[t].refresh(e[t])}canTransition(){return!this.transition.active}get currentSweepIndex(){if(this.currentSweep)return this.sweepMap[this.currentSweep].index}get currentSweepObject(){if(this.currentSweep)return this.getSweep(this.currentSweep)}get currentAlignedSweepObject(){if(this.currentSweep&&!this.isSweepUnaligned(this.currentSweep))return this.getSweep(this.currentSweep)}makeSweepChangeSubscription(e){return this.onPropertyChanged("currentSweep",e)}getSweep(e){return this.sweepMap[e]}getSweepByIndex(e){return this.sweepList.find((t=>t.index===e))}getSweepByUuid(e){return this.sweepList.find((t=>t.uuid===e))}containsSweep(e){return e in this.sweepMap}getFirstSweep(){let e=-1;for(;++e<this.sweepList.length;){const t=this.sweepList.get(e);if(t.enabled)return t}}getStartSweep(e){const t=e&&e.pano&&e.pano.uuid?this.getSweep(e.pano.uuid):null;return t&&t.enabled?t:this.getFirstSweep()}getClosestSweep(e,t){let n=Number.MAX_VALUE,s=null;return this.iterate((r=>{if(r.enabled&&(!t||r.alignmentType===i.z9.ALIGNED)){const t=e.distanceTo(r.position);t<n&&(n=t,s=r)}})),s}getFirstAlignedSweep(){let e=-1;for(;++e<this.sweepList.length;){const t=this.sweepList.get(e);if(t.enabled&&t.alignmentType===i.z9.ALIGNED)return t}return null}activateTransition(e,t){this.transition.active=!0,this.transition.from=t,this.transition.to=e,this.transitionActive=!0}deactivateTransition(){this.transition.active=!1,this.transition.from=void 0,this.transition.to=void 0,this.transitionActive=!1}isSweepUnaligned(e){if(!e)return!1;const t=this.getSweep(e);return t&&!t.isAligned()}isSweepAligned(e){const t=this.getSweep(e);return t&&t.isAligned()}isSweepDisabled(e=this.currentSweep){if(!e)return!1;const t=this.getSweep(e);return t&&!t.enabled}*sweeps(){for(const e of this.sweepList)yield e}iterate(e){this.sweepList.forEach(((t,n)=>{e(t,n)}))}filter(e){return this.sweepList.filter(e)}sortByScore(e,t,n){return(n||this.sweepList).filter((t=>e.every((e=>e(t))))).map((e=>({sweep:e,score:t.reduce(((t,n)=>t+n(e)),0)}))).sort(((e,t)=>t.score-e.score))}getSweepList(){return this.sweepList.values()}getSweepNeighbours(e){const t=[];for(const n of e.neighbours)t.push(this.getSweep(n));return t}getCollection(){return(0,o.q)(this.sweepMap)}getConnectedSweeps(e,t){const n=[e],i=new Set;for(t=t||(e=>!0);n.length;){const e=n.pop(),s=this.getSweep(e);i.add(e);for(const e of s.neighbours){t(this.getSweep(e))&&!i.has(e)&&n.push(e)}}return i}equals(e){if(this.sweepMap.length!==e.sweepMap.length||this.currentSweep!==e.currentSweep||this.transition.active!==e.transition.active||this.transition.from!==e.transition.from||this.transition.to!==e.transition.to)return!1;for(const t in this.sweepMap){if(!e.containsSweep(t))return!1;if(!this.sweepMap[t].equals(e.getSweep(t)))return!1}return!0}}},78720:(e,t,n)=>{"use strict";n.d(t,{ff:()=>o,vO:()=>a,T3:()=>l,H7:()=>c,_T:()=>d,WO:()=>u,b1:()=>h,nK:()=>p,pI:()=>m,_k:()=>f,D5:()=>g,SF:()=>v,jN:()=>y});var i=n(94772),s=n(2212);const r=.25,o=e=>t=>t!==e,a=e=>t=>!!e.neighbours&&-1!==e.neighbours.indexOf(t.id),l=e=>t=>e===t||a(e)(t),c=e=>e.placementType===i.hU.MANUAL,d=()=>e=>e.alignmentType===i.z9.ALIGNED,u=()=>e=>e.alignmentType!==i.z9.ALIGNED,h=e=>t=>e.floorId===t.floorId,p=e=>t=>e===t.floorId,m=(()=>{const e=new s.Vector3,t=new s.Vector3;return(n,i,s=r)=>r=>e.copy(r.position).sub(n).normalize().dot(t.copy(i).normalize())>s})(),f=()=>e=>e.enabled,g=(e,t)=>{const n=new s.Vector3;return t=t.clone(),i=>n.copy(i.position).sub(e).normalize().dot(t)>0},v=(e,t)=>n=>e.distanceTo(n.position)<t,y=(e,t)=>n=>e.distanceToSquared(n.position)<t},31998:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SweepDataModule});var i=n(57227),s=n(14877),r=n(53549),o=n(14832),a=n(41674),l=n(38950),c=n(65171),d=n(31013),u=n(65270),h=n(15099),p=n(12757),m=n(28757),f=n(29474),g=n(15100),v=n(66225),y=n(5477);const b=new y.Z("mds-sweep-serializer");class MdsAnchorLocationUpdateSerializer{serialize(e){const t={};return void 0===e.enabled&&void 0===e.vrenabled||(t.tags=[],e.enabled&&t.tags.push("showcase"),e.vrenabled&&t.tags.push("vr")),this.validate(t)?t:null}validate(e){if(!e)return!1;const t=["tags"],n=t.some((t=>t in e)),i=0===Object.keys(e).filter((e=>!t.includes(e))).length,s=void 0===e.tags||Array.isArray(e.tags),r=s&&n&&i;return r||b.debug("Invalid AnchorPatch:",{tagsIsArrayIfPresent:s,hasSomeChanges:n,hasNoExtraChanges:i,mutableFields:t,data:e}),r}}var S,E=n(36886);!function(e){e.VISION="vision",e.UPLOAD="upload"}(S||(S={}));var T=n(94772),w=n(63387),x=n(36407),_=n(63336),M=n(28129),O=n(4951);const A=new y.Z("mds-sweep-serializer"),C={[E.b.AUTO]:T.hU.AUTO,[E.b.MANUAL]:T.hU.MANUAL,[E.b.UNPLACED]:T.hU.UNPLACED},N={[S.VISION]:T.z9.ALIGNED,[S.UPLOAD]:T.z9.UNALIGNED};class MdsSweepDeserializer{deserialize(e){var t,n;if(!e||!this.validate(e))return A.debug("Deserialized invalid Sweep data from MDS",e),null;const i=e,s=new T.ZP;s.id=i.id,s.index=i.index,s.enabled=i.tags.includes("showcase"),s.vrenabled=i.tags.includes("vr"),s.neighbours=i.neighbors||[],i.position&&(s.floorPosition=w.ep.fromVisionVector(i.position)),s.floorId=(null===(t=i.floor)||void 0===t?void 0:t.id)||null,s.roomId=(null===(n=i.room)||void 0===n?void 0:n.id)||null;const r=i.pano;if(s.name=r.label||"",s.alignmentType=N[r.source],s.uuid=r.sweepUuid||"",s.alignmentType===T.z9.ALIGNED?s.placementType=T.hU.AUTO:s.placementType=C[r.placement],r.position){const e=w.ep.fromVisionVector(r.position);s.placementType!==T.hU.AUTO&&e.distanceTo(s.floorPosition)>1e3&&(s.placementType=T.hU.UNPLACED),s.position=e}s.resolutions=[];const o=r.skyboxes||[];if(r.resolutions)for(const e of r.resolutions){const t=this.getPanoSizeClass(e),n=o.find((t=>t.resolution===e));t&&n?(s.resolutions.push(t),s.skyboxes[t]=this.makeSkybox(n)):A.debug(`Invalid pano size class ${e}`)}return r.rotation&&(s.rotation=w.ep.fromVisionQuaternion(r.rotation)),s.floorId||(s.alignmentType===T.z9.ALIGNED?A.warn(`Aligned sweep ${s.index} has no floor association`):s.placementType===T.hU.MANUAL&&A.debug(`Manually placed sweep ${s.index} has no floor association`)),s.roomId||s.alignmentType===T.z9.ALIGNED&&A.warn(`Aligned sweep ${s.index} has no room association`),s}validate(e){if(!e)return!1;const t=[],n=["id","index","tags"];if(t.push((()=>n.every((t=>t in e)))),t.push((()=>"number"==typeof e.index)),t.push((()=>!!e.position&&(0,O.u)(e.position))),t.push((()=>"pano"in e&&!!e.pano)),e.pano){const{placement:n,source:i,position:s}=e.pano;t.push((()=>!!n&&n in C)),t.push((()=>!!i&&i in N)),t.push((()=>!!s&&(0,O.u)(s)))}return t.every((e=>e()))}getPanoSizeClass(e){const t={low:x.SL.BASE,high:x.SL.STANDARD,"2k":x.SL.HIGH,"4k":x.SL.ULTRAHIGH};return e in t?t[e]:void 0}makeSkybox(e){return new M.n({tileUrlTemplate:e.tileUrlTemplate,tileResolution:parseInt(e.tileResolution,10),tileCount:e.tileCount,urlTemplate:e.urlTemplate},(0,_.p)(e.validUntil,null))}}var D=n(65);const I=new y.Z("mds-sweep-serializer");class MdsSweepPanoUpdateSerializer{serialize(e){const t={};return e.rotation&&(t.rotation=(0,D.J5)(w.ep.toVisionQuaternion(e.rotation))),e.position&&(t.position=(0,D.m)(w.ep.toVisionVector(e.position))),e.placementType&&e.placementType===T.hU.UNPLACED&&(t.resetPlacement=!0),"roomId"in e&&(e.roomId?t.roomId=e.roomId:t.resetRoom=!0),"floorId"in e&&(e.floorId?t.floorId=e.floorId:t.resetFloor=!0),"name"in e&&(t.label=e.name||""),this.validate(t)?t:null}validate(e){if(!e)return!1;const t=["resetPlacement","resetFloor","resetRoom","rotation","position","floorId","roomId","label"],n=t.some((t=>t in e)),i=0===Object.keys(e).filter((e=>!t.includes(e))).length,s=n&&i;return s||I.debug("Invalid PanoramaLocation:",{hasSomeChanges:n,hasNoExtraChanges:i,mutableFields:t,data:e}),s}}const L=new y.Z("mds-sweep-store");class MdsSweepStore extends v.u{constructor(){super(...arguments),this.deserializer=new MdsSweepDeserializer,this.panoSerializer=new MdsSweepPanoUpdateSerializer,this.anchorSerializer=new MdsAnchorLocationUpdateSerializer,this.prefetchKey="data.model.locations"}async read(e={}){const{readonly:t}=this.config,n={modelId:this.getViewId()},i=t?g.GetShowcaseSweeps:g.GetSweeps;return this.query(i,n,e).then((e=>{var t,n;const i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.model)||void 0===n?void 0:n.locations;if(!i||!Array.isArray(i))return null;const s={};for(const e of i){const t=this.deserializer.deserialize(e);t&&(s[t.id]=t)}return s}))}async refresh(){return this.refreshPromise||(this.refreshPromise=this.read({fetchPolicy:"no-cache"}).finally((()=>{this.refreshPromise=void 0}))),this.refreshPromise}async update(e){if(!e||0===e.length)return;const t=this.getViewId();let n="";const i={};i.modelId=t;let s="";for(const t of e){const r=this.panoSerializer.serialize(t),o=this.anchorSerializer.serialize(t);if(!r&&!o)throw L.error("No changes to update:",t,e),new Error("MdsSweepStore.update failed");n+=""+(r?`, $pano${t.id}: PanoramicImageLocationPatch!`:"")+` ${o?`, $anchor${t.id}: AnchorPatch!`:""} `,i[`pano${t.id}`]=r,i[`anchor${t.id}`]=o,s+=`\n        ${r?`\n          panoLocation${t.id}: patchPanoLocation(modelId: $modelId, , locationId: "${t.id}", patch: $pano${t.id}) {\n            id\n            placement\n          }`:""}\n        ${o?`\n          panoAnchor${t.id}: patchAnchor(modelId: $modelId, , anchorId: "${t.id}", patch: $anchor${t.id}) {\n            id\n            tags\n          }`:""}\n      `}const r=f.Ps`
      mutation sweepUpdate($modelId: ID! ${n}) {
        ${s}
      }
    `;return this.mutate(r,i).then((()=>{}))}}var P=n(67495),R=n(18537),k=n(60673),U=n(52549),B=n(7819),F=n(47063),V=n(48697),H=n(40603);class SweepTransitionError extends H.y{constructor(e="Failed to transition to sweep"){super(e),this.name="SweepTransition"}}class InvalidSweepError extends H.y{constructor(e="Invalid Sweep"){super(e),this.name="InvalidSweep"}}class SweepDataModule extends i.Y{constructor(){super(...arguments),this.name="sweep-data",this.internalProgress=!1,this.defaultEasing=u.qb,this.moveToSweep=e=>{const t=new d.Q;return e.prevSweepId=e.prevSweepId||this.sweepData.currentSweep,this.activateSweep(e).then((()=>(this.beginSweepTransition(e),this.defaultSweepCameraMove(t,e)))).then((()=>{this.endSweepTransition(e),t.resolve()})).catch((n=>{this.log.debug(`Failure moving to sweep ${e.sweepId}`,n),t.reject(n)})),t.promise()},this.activateSweep=async e=>{if(!this.sweepData.canTransition()||!this.cameraData.canTransition())throw new SweepTransitionError("Tried to start transition while another transition was active");if(!this.sweepData.containsSweep(e.sweepId))throw new InvalidSweepError(`Invalid sweep ${e.sweepId}`);return this.activateSweepUnsafe(e)},this.activateSweepUnsafe=async e=>{this.sweepPanoModule||(this.sweepPanoModule=await this.engine.getModuleBySymbol(s.y.SWEEP_PANO));return this.sweepPanoModule.getRenderer().activateSweep(e.sweepId)},this.instantSweepTransition=e=>{const t=this.sweepData.currentSweep;this.beginSweepTransition({sweepId:e,transitionTime:0,internalProgress:!0,prevSweepId:t}),this.sweepData.currentSweep=e,this.sweepData.commit(),this.engine.broadcast(new p.Z(e,t)),this.endSweepTransition({sweepId:e,prevSweepId:t})},this.beginSweepTransition=e=>{this.sweepData.activateTransition(e.sweepId,e.prevSweepId||this.sweepData.currentSweep),this.internalProgress=e.internalProgress||!1,this.sweepData.transition.progress.modifyAnimation(0,1,e.transitionTime||0,e.easing||this.defaultEasing),this.sweepData.commit(),this.engine.broadcast(new c.Z(e.sweepId,e.prevSweepId))},this.endSweepTransition=e=>{const t=this.sweepData.getSweep(e.sweepId);this.sweepData.deactivateTransition(),this.sweepData.currentSweep=e.sweepId,this.sweepData.transition.progress.stop(1),this.internalProgress=!1,this.sweepData.commit(),this.engine.broadcast(new l.Z(e.sweepId,t.alignmentType,t.placementType,e.prevSweepId))},this.defaultSweepCameraMove=async(e,t)=>{const n={position:this.sweepData.getSweep(t.sweepId).position,rotation:t.rotation},i=(0,a.AN)(this.cameraData.aspect());let s=o.n.Interpolate;void 0!==t.transitionType&&o.n[t.transitionType]&&(s=t.transitionType);const r=this.cameraModule.moveTo({transitionType:s,pose:n,transitionTime:t.transitionTime,transitionSpeedMultiplier:t.transitionSpeedMultiplier,projection:i,easing:t.easing,rotationDelay:t.rotationDelay});let l=!1;return r.progress((n=>{this.sweepData.transition.progress.updateProgress(n),e.notify(n),n>=.5&&!l&&(l=!0,this.sweepData.currentSweep=t.sweepId,this.sweepData.commit(),this.engine.broadcast(new p.Z(t.sweepId,t.prevSweepId)))})),r.nativePromise()},this.tryInferFloorIds=e=>{for(const t of Object.values(e))if(t.isAligned()&&null===t.floorId){this.log.warn(`Aligned sweep ${t.index} has no floor association`);const n=t.neighbours.map((n=>({id:n,floorId:e[n].floorId,distance:e[n].floorPosition.distanceToSquared(t.floorPosition)})));n.sort(((e,t)=>e.distance-t.distance));const i=n.find((e=>e.floorId));i&&(this.log.debug(`Inferred Sweep ${t.index} floor as ${i.floorId} from neighbors`),t.floorId=i.floorId)}}}async init(e,t){const{readonly:n,baseUrl:i}=e;this.engine=t,this.market=this.engine.market,this.store=new MdsSweepStore({readonly:n,baseUrl:i});const o=await this.store.read()||{};[this.filterSweepData,this.tryInferFloorIds].forEach((e=>e(o))),(0,M.s)(o,(async()=>{if(this.store.refresh){const e=await this.store.refresh();this.sweepData.refresh(e||{})}else this.log.debug("Can't refresh sweep URLs - operation not supported")})),this.sweepData=new r.Z(o),this.market.register(this,r.Z,this.sweepData);const a=await t.getModule(B.F);if(!1===n){this.monitor=new P.c(this.sweepData.getCollection(),{aggregationType:R.E.NextFrame,shallow:!0},t),this.monitor.onChanged((()=>this.engine.commandBinder.issueCommand(new F.VQ({dataTypes:[U.g.SWEEPS]}))));const e=await t.market.waitForData(V.Q);e.setRevertableType(U.g.SWEEPS),e.setPublishableType(U.g.SWEEPS)}this.cameraModule=await this.engine.getModuleBySymbol(s.y.CAMERA),this.cameraData=await t.market.waitForData(h.M_),this.bindings.push(t.commandBinder.addBinding(m.NO,(async()=>{this.sweepData.currentSweep=void 0,this.sweepData.commit()})),t.commandBinder.addBinding(m.aK,(async e=>{if(e.sweepId)try{const t=e.sweepId;await this.activateSweepUnsafe({sweepId:t});const n=this.sweepData.currentSweep;this.beginSweepTransition({sweepId:t,transitionTime:0,internalProgress:!0,prevSweepId:n}),this.sweepData.currentSweep=t,this.endSweepTransition({sweepId:t,prevSweepId:n}),this.sweepData.commit()}catch(e){this.log.error(e)}else this.sweepData.currentSweep=void 0,this.sweepData.commit()})),a.onSave((()=>this.save()),{dataType:U.g.SWEEPS}))}filterSweepData(e){for(const t in e){const n=e[t];n.neighbours=n.neighbours.filter((t=>t in e))}}onUpdate(e){this.internalProgress&&this.sweepData.transition.active&&this.sweepData.transition.progress.tick(e)}async save(){if(!this.store)throw Error("No store configured for saving sweep edits!");const e=this.monitor.getDiffRecord();this.monitor.clearDiffRecord();const t=e.filter((e=>e.action===k.KI.updated)).map((e=>{const t=this.sweepData.getSweep(e.index),n=Object.assign({id:e.index},e.diff);return("position"in n||"rotation"in n)&&(n.position=t.position,n.rotation=t.rotation),("enabled"in n||"vrenabled"in n)&&(n.enabled=t.enabled,n.vrenabled=t.vrenabled),n}));return this.store.update(t)}}},99931:(e,t,n)=>{"use strict";n.d(t,{Dv:()=>l,TE:()=>c,o7:()=>d,l0:()=>u,Bv:()=>h});var i=n(2212);const s=-1,r=10,o=5,a=-5,l=(e,t=s)=>n=>e.distanceToSquared(n.position)*t,c=(e,t=s)=>n=>e.distanceTo(n.position)*t,d=(e,t,n=r)=>{const s=new i.Vector3;return i=>s.copy(i.position).sub(e).normalize().dot(t)*n},u=(e,t=s)=>n=>e.distanceToSquared(n.floorPosition)*t,h=(e,t=o,n=a)=>i=>e===i.floorId?t:n},23714:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>s}),function(e){e[e.Center=0]="Center",e[e.UpperLeft=1]="UpperLeft",e[e.UpperRight=2]="UpperRight",e[e.LowerRight=3]="LowerRight",e[e.LowerLeft=4]="LowerLeft"}(i||(i={}));const s=i},33357:(e,t,n)=>{"use strict";n.d(t,{S:()=>c,Z:()=>PanoQualityManager});var i=n(36407),s=n(40386),r=n(53675),o=n(63901),a=n(31013);const l=new(n(5477).Z)("panoqualitymanager");var c;!function(e){e[e.Untested=0]="Untested",e[e.Testing=1]="Testing",e[e.Success=2]="Success",e[e.Fail=3]="Fail"}(c||(c={}));class PanoQualityManager{constructor(e,t,n,i){this.urls=e,this.maxCubemapSize=t,this.maxNavPanoSize=n,this.maxZoomPanoSize=i,this.overrideWindow=!1,this.devicePixelRatio=window.devicePixelRatio||1,this.navPanoSize=-1,this.zoomPanoSize=-1,this.windowHeight=window.innerHeight*this.devicePixelRatio,this.highQualityThreshold=s.Xd.windowHeightHighQualityThresholdOverride||s.Xd.windowHeightHighQualityThreshold,this.persistentStorage=new r.a,this.downloadTestResults={},this.updateMaximums()}setWindowSize(e,t){this.windowHeight=t*this.devicePixelRatio,this.updateMaximums()}overrideWindowMaximums(e){this.overrideWindow=e,this.updateMaximums()}updateNavPanoSize(e){this.maxNavPanoSize=e,this.updateMaximums()}getTestResults(e,t){const n=this.downloadTestResults[e];if(n){const e=n[t];if(e)return e}return c.Untested}ultraHighQualityModeEnabled(e){const t=i.Qf[this.getZoomPanoSize()],n=this.downloadTestResults[e];return!(!n||!n[t])&&n[t]===c.Success}updateMaximums(){this.windowHeight<this.highQualityThreshold&&!this.overrideWindow?(this.navPanoSize=Math.min(PanoQualityManager.getPanoSize(i.SL.STANDARD),this.maxNavPanoSize),this.zoomPanoSize=Math.min(PanoQualityManager.getPanoSize(i.SL.HIGH),this.maxZoomPanoSize)):(this.navPanoSize=this.maxNavPanoSize,this.zoomPanoSize=this.maxZoomPanoSize),this.zoomPanoSize<this.navPanoSize&&(this.navPanoSize=this.zoomPanoSize),this.zoomPanoSize=Math.min(this.maxCubemapSize,this.zoomPanoSize),this.navPanoSize=Math.min(this.maxCubemapSize,this.navPanoSize)}static getPanoSize(e){if(e in i.eE)return i.eE[e];throw new Error(`Not a panoSizeClass: ${e}`)}static getPanoSizeClass(e){if(e in i.Qf)return i.Qf[e];throw new Error(`Not a valid pano resolution: ${e}`)}getMaxPossiblePanoSize(){return PanoQualityManager.getPanoSize(i.SL.ULTRAHIGH)}getNavPanoSize(){return this.navPanoSize}getZoomPanoSize(){return this.zoomPanoSize}availableResolution(e,t){const n=new a.Q;if(!t)return n.reject(0);if(e.resolutions)return e.resolutions.includes(t)?n.resolve(t):this.availableResolution(e,this.getLowerResolution(t));switch(this.getTestResults(e.id,t)){case c.Success:n.resolve(t);break;case c.Fail:return this.availableResolution(e,this.getLowerResolution(t));case c.Untested:this.testDownload(e,t,o.I_).then((i=>{i?n.resolve(t):this.availableResolution(e,this.getLowerResolution(t)).then((e=>n.resolve(e)))}));break;case c.Testing:l.warn("resolution is already testing, do we need to handle this?")}return n}getLowerResolution(e){switch(e){case i.SL.ULTRAHIGH:return i.SL.HIGH;case i.SL.HIGH:return i.SL.STANDARD;case i.SL.STANDARD:return i.SL.BASE}return null}testDownload(e,t,n){if(!this.urls)throw new Error("Can't call testDownload without signed urls");const i=PanoQualityManager.getPanoSize(t),s=new a.Q,r=e.id;this.downloadTestResults[r]||(this.downloadTestResults[r]={});const o=this.downloadTestResults[r]&&this.downloadTestResults[r][t];if(o)o===c.Success?s.resolve(!0):o===c.Fail&&s.resolve(!1);else{this.downloadTestResults[r][t]=c.Testing;const o=e=>{this.downloadTestResults[r][t]=c.Success,s.resolve(!0)},a=()=>{this.downloadTestResults[r][t]=c.Fail,s.resolve(!1)};this.getTileUrl(e,i,n,0).then((e=>{this.urls.getImage(e).then(o,a)}))}return s}getTileUrl(e,t,n,i){const s=this.persistentStorage.get("getTileUrl:locationInfo",(()=>({face:-1,faceTileIndex:-1,tileX:-1,tileY:-1})));o.Tp(t,i,s);const r=Math.floor(t/n),a=r*r,l=Math.floor(i/a),c=PanoQualityManager.getPanoSizeClass(t);return e.getTileUrl(c,l,s.tileX,s.tileY)}}},63901:(e,t,n)=>{"use strict";n.d(t,{I_:()=>l,Hq:()=>c,P6:()=>d,R5:()=>u,Tp:()=>h,Tu:()=>p,ym:()=>m,oU:()=>f,eO:()=>v});var i=n(95891),s=n(2212),r=n(23714),o=n(98383),a=n(994);const l=512,c=6,d=(e,t,n,s,o,a,l,c)=>{const d=e/t,u=2*(t/e),h=u/2;let p=2*(s/d)-1+h,m=2*((o=d-1-o)/d)-1+h;switch(a=a||r.Z.Center){case r.Z.UpperLeft:p-=h,m+=h,p+=l*u;break;case r.Z.UpperRight:p+=h,m+=h,m-=l*u;break;case r.Z.LowerRight:p+=h,m-=h,p-=l*u;break;case r.Z.LowerLeft:p-=h,m-=h,m+=l*u;break;case r.Z.Center:}switch(n){case i.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_X:c.set(-1,m,-p);break;case i.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:c.set(1,m,p);break;case i.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:c.set(-p,1,-m);break;case i.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:c.set(-p,-1,m);break;case i.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:c.set(-p,m,1);break;case i.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:c.set(p,m,-1)}c.normalize()},u=(e,t)=>{let n=l;e<l&&(n=e);const i=Math.floor(e/n),s=i*i;return Math.floor(t/s)},h=(e,t,n)=>{let i=l;e<l&&(i=e);const s=u(e,t),r=Math.floor(e/i),o=t-s*(r*r);n.tileX=o%r,n.tileY=Math.floor(o/r),n.face=s,n.faceTileIndex=o},p=function(e){if(e<=l)return c;const t=Math.floor(e/l);return t*t*c},m=function(){const e=new s.Matrix4,t=new s.Quaternion;return(n,i)=>{t.copy(n),t.invert(),e.makeRotationFromQuaternion(t),i.applyMatrix4(e),i.normalize()}}(),f=function(){const e=new s.Vector3,t=new s.Vector3(0,0,-1),n=new s.Quaternion,i=function(e,t){e.push({face:t.face,faceTileIndex:t.faceTileIndex,tileX:t.tileX,tileY:t.tileY})},r=function(){const e={face:-1,faceTileIndex:-1,tileX:-1,tileY:-1};return(t,n,s)=>{const r=p(t);let o=0;for(let a=0;a<r;a++)h(t,a,e),n&&!n(e)||(o++,s&&i(s,e));return o}}();return(i,o,a,c,d=!1,u,h)=>{c.length=d?0:c.length;const p=o<l?o:l;if(!u&&!h)return r(o,null,c);const f=!!h;u=u||0,h=h||u,h=Math.max(0,Math.min(h,360)),u=Math.max(0,Math.min(u,360)),e.copy(a);const y=i.rotation||new s.Quaternion;if(m(y,e),f){n.setFromUnitVectors(e,t);return r(o,(function(e){return g(o,p,e.face,e.tileX,e.tileY,n,u||0,h||0)}),c)}return r(o,(function(t){return v(o,p,t.face,t.tileX,t.tileY,e,u||0)}),c)}}(),g=function(){const e=new s.Vector3;return(t,n,i,s,l,c,u,h)=>{const p=Math.tan(.5*h*a.Ue),m=-p,f=Math.tan(.5*u*a.Ue),g=-f,v=(0,o.m)(i);let y=0,b=0,S=0,E=0,T=0;for(let i=r.Z.Center;i<=r.Z.LowerLeft;i++){if(d(t,n,v,s,l,i,0,e),e.applyQuaternion(c),e.z>=-1e-5)continue;const r=-1/e.z,o=e.x*r,a=e.y*r;a>p?y++:a<m&&b++,o>f?S++:o<g&&E++,T++}return b!==T&&y!==T&&S!==T&&E!==T}}(),v=function(){const e=new s.Vector3,t=new s.Vector3(0,1,0),n=new s.Vector3(1,0,0);return(i,s,a,l,c,u,h)=>{const p=(0,o.m)(a);if(n.copy(u).cross(t),d(i,s,p,l,c,r.Z.Center,0,e),y(e,u,h))return!0;const m=h/360,f=Math.floor(1/m);let g=0;for(let t=0;t<f;t++){for(let t=r.Z.UpperLeft;t<=r.Z.LowerLeft;t++)if(d(i,s,p,l,c,t,g,e),y(e,u,h))return!0;g+=m}return!1}}(),y=function(){const e=new s.Vector3,t=new s.Vector3;return(n,i,s,r)=>{if(t.copy(n),r){e.copy(r),e.normalize();const i=e.dot(n);e.x*=i,e.y*=i,e.z*=i,t.sub(e)}const o=s/2*a.Ue,l=Math.cos(o);return t.dot(i)>=l}}()},41403:(e,t,n)=>{"use strict";n.d(t,{o:()=>TileDownloadedMessage});var i=n(4117);class TileDownloadedMessage extends i.v{constructor(){super()}}},40386:(e,t,n)=>{"use strict";n.d(t,{YS:()=>s,Xd:()=>r,k4:()=>TilingSettings});var i=n(87100);const s="settings/tiling/preload_quality",r=Object.freeze({overlayStyle:(0,i.eY)("tileoverlay",0),uploadIntervalDelay:(0,i.eY)("tileupdelay",50),highResUploadsPerFrame:(0,i.eY)("maxnbtpf",2),maxHighResUploadsPerFrame:100,loadIndicatorDelay:300,uploadsPerFrame:(0,i.eY)("maxbtpf",6),maxUploadsPerFrame:100,windowHeightHighQualityThreshold:800,windowHeightHighQualityThresholdOverride:(0,i.eY)("threshold2k",void 0),concurrentDownloads:(0,i.eY)("tileconc",3),maxConcurrentDownloads:12,navigation:{directionFactor:10,distanceFactor:-1}});class TilingSettings{constructor(){this.reset()}reset(){this.downloadFullPano=!1,this.concurrentDownloads=r.concurrentDownloads,this.uploadsPerFrame=r.uploadsPerFrame,this.highResUploadsPerFrame=r.highResUploadsPerFrame}}},22808:(e,t,n)=>{"use strict";var i;n.d(t,{v:()=>i}),function(e){e[e.CurrentView=0]="CurrentView",e[e.FullPanorama=1]="FullPanorama"}(i||(i={}))},97739:(e,t,n)=>{"use strict";n.d(t,{Z:()=>RestrictedSweepsClearedMessge});var i=n(4117);class RestrictedSweepsClearedMessge extends i.v{constructor(){super()}}},53491:(e,t,n)=>{"use strict";n.d(t,{Z:()=>RestrictedSweepsSetMessge});var i=n(4117);class RestrictedSweepsSetMessge extends i.v{constructor(e){super(),this.sweepIds=e}}},72953:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SweepPathModule});var i=n(2212),s=n(57227),r=n(53549),o=n(29497);const a=Object.freeze({sweeps:{maxNeighborDistance:50}});var l=n(53491),c=n(97739);class SweepPathModule extends s.Y{constructor(){super(...arguments),this.name="sweep-path"}async init(e,t){this.engine=t,this.sweepData=await t.market.waitForData(r.Z),this.validNeighbors={},this.maxNeighborDistance=e.maxNeighborDistance||a.sweeps.maxNeighborDistance,this.buildDistanceMap()}setRestrictedSweeps(e,t=0){if(this.restrictedSweeps=[],e){for(let n=t;n<e.length;n++)this.restrictedSweeps.push(e[n].id);this.engine.broadcast(new l.Z(this.restrictedSweeps))}else this.restrictedSweeps=void 0,this.engine.broadcast(new c.Z)}findShortestPath(e,t,n,i,s,r,a=5e3){const l=this.sweepData.getSweep(e),c=this.sweepData.getSweep(t),d=this,u=(0,o.K)({start:l,isEnd:e=>e===c,*neighbors(e){for(const t of e.neighbours)yield d.sweepData.getSweep(t)},distance:(e,t)=>d.getDistance(e.id,t.id),heuristic:(e,t)=>1,timeout:a});return u.status===o.h.Success&&u.path.length<s?(this.addSweepsNearPath(u.path,n),this.filterCloseSweepsFromPath(u.path,i)):null}addSweepsNearPath(e,t){const n=new i.Vector3,s=new i.Vector3,r=new i.Vector3,o=new i.Vector3,a=new i.Vector3,l=new i.Vector3,c=[],d=new i.Vector3,u=(e,t,n)=>(r.copy(t).sub(e),r.dot(n)),h=(e,t)=>u(d,e.position,n)-u(d,t.position,n);let p=0;for(;p<e.length-1;){const i=e[p].id,u=e[p+1].id,m=this.sweepData.getSweep(i),f=this.sweepData.getSweep(u);d.copy(m.position),c.length=0,n.copy(f.position).sub(d).normalize();const g=this.findConnectedSweeps(m,this.maxNeighborDistance),v=this.findConnectedSweeps(f,this.maxNeighborDistance),y=g.concat(v);for(const e of y){const i=r.copy(e.position).sub(d).dot(n);if(i>0){a.copy(n),a.multiplyScalar(i),o.copy(r),o.sub(a);if(o.length()<t){s.copy(n).negate(),l.copy(e.position).sub(f.position);l.dot(s)>0&&c.push(e)}}}if(c.length>0){c.sort(h);for(let t=e.length+c.length-1;t>=p+c.length;t--)e[t]=e[t-c.length];for(let t=0;t<c.length;t++)e[t+p+1]=c[t]}p+=c.length+1}}findConnectedSweeps(e,t,n=2){const i=[];return this._findConnectedSweeps(e,e,t,i,{},n,0),i}_findConnectedSweeps(e,t,n,i,s,r,o){const a=this.getValidNeighbors(e.id);for(const e of a)if(!s[e.id]){e.position.distanceTo(t.position)<n&&(i.push(e),s[e.id]=!0,o<r&&this._findConnectedSweeps(e,t,n,i,s,r,o+1))}}getValidNeighbors(e,t){let n=this.validNeighbors[e];if(!n){n=[],this.validNeighbors[e]=n;const i=this.sweepData.getSweep(e),s=i.neighbours;for(const r of s){const s=this.sweepData.getSweep(r),o=this.getDistance(e,r);if(!s.enabled)continue;if(o>this.maxNeighborDistance)continue;let a=!0;if(t){const e=s.position.clone().sub(i.position).normalize();a=0===t(i.position,e,o).length}a&&n.push(s)}}return n}filterCloseSweepsFromPath(e,t){const n=[];let i=null,s=!1;for(const r of e)s=i&&r.position.distanceTo(i.position)<t||!1,i&&s||(n.push(r),i=r);return n.length<2?e:(s&&e.length>1&&(n[n.length-1]=e[e.length-1]),n)}getCurveForPath(e){let t=0;const n=[0];for(let i=1;i<e.length;i++)t+=e[i-1].distanceTo(e[i]),n.push(t);const s=[0];for(let i=1;i<e.length;i++)s.push(n[i]/t);const r=new i.CatmullRomCurve3(e,!1);return{curve:new i.CatmullRomCurve3(r.getSpacedPoints(2*t).concat(e[e.length-1])),totalLength:t,sourceDistances:n,normalSourceDistances:s}}buildDistanceMap(){const e={},t=new i.Vector3(0,0,0);this.sweepData.iterate((n=>{const i={},s=n.neighbours;for(const e of s){const s=this.sweepData.getSweep(e);t.copy(n.position).sub(s.position);let r,o=Math.max(0,Math.abs(t.y)-.2),a=Math.sqrt(t.x*t.x+t.z*t.z);o>0?(o=Math.pow(4*o,2),a=Math.pow(a,2),r=Math.sqrt(o*o+a*a)):r=t.length(),i[s.id]=r}e[n.id]=i})),this.distanceMap=e}getDistance(e,t){return this.distanceMap[e][t]}}},35998:(e,t,n)=>{"use strict";n.d(t,{m1:()=>PinCollider,Vp:()=>PinMesh});var i=n(2212),s=n(36973),r=n.n(s),o=n(82410),a=n.n(o);class PinMaterial extends i.RawShaderMaterial{constructor(e,t){const n=i.UniformsUtils.clone(PinMaterial.uniforms);n.tMask.value=e,n.tPinHole.value=t,super({vertexShader:r(),fragmentShader:a(),uniforms:n,name:"PinMaterial",transparent:!0})}}PinMaterial.uniforms={tMask:{type:"t",value:null},tPinHole:{type:"t",value:null},pinColor:{type:"c",value:new i.Color},opacity:{type:"f",value:1}};var l=n(89034),c=n(74170),d=n(99295),u=n(77364),h=n(25935),p=n(48072);class PinCollider extends i.Mesh{}let m;const f=()=>m||(m=(0,l.p)(p),m);class PinMesh extends h.E{constructor(e,t,n,i){const s=new PinMaterial(f(),t);super(PinMesh.geometry,s),this.layers.mask=i.mask,this.name="PinMesh",this.cameraData=n,this._collider=new PinCollider(PinMesh.colliderGeometry,PinMesh.colliderMaterial),this._collider.name="PinMeshCollider",this._collider.material.visible=!1,this.add(this._collider),this.opacityProgress=0,this.shouldHide=!0,this.uniforms=s.uniforms,this.unhover(),this.selected=0,this.visible=!1,this.position.copy(e),this.renderOrder=d.z.pins360}updatePosition(e){this.position.copy(e)}get collider(){return this._collider}render(e){this.quaternion.copy(this.cameraData.pose.rotation),null===this.uniforms.tPinHole.value?this.opacityProgress=0:!this.shouldHide&&this.opacityProgress<1?this.opacityProgress+=e/PinMesh.FADE_DURATION:this.shouldHide&&this.opacityProgress>0&&(this.opacityProgress-=e/PinMesh.FADE_DURATION),this.opacityProgress=(0,c.uZ)(this.opacityProgress,0,1),this.uniforms.opacity.value=this.opacityProgress,this.visible=0!==this.opacityProgress}activate(){this.shouldHide=!1}deactivate(){this.shouldHide=!0}dispose(){this.collider.geometry.dispose(),this.collider.material.dispose()}setPinHover(e,t=!0,n=!0){const i=Math.min(Math.max(e,0),1);this.selected!==i&&(n&&this.uniforms.pinColor.value.copy(u.I.WHITE).lerp(u.I.MP_BRAND,i),t&&i>0&&i<=1&&(this.material.depthTest=!1),0===i&&(this.material.depthTest=!0),this.selected=i)}unhover(){this.uniforms.pinColor.value.copy(u.I.WHITE)}}PinMesh.FADE_DURATION=500,PinMesh.geometry=new i.PlaneBufferGeometry(1.5,1.5),PinMesh.colliderGeometry=new i.SphereBufferGeometry(1.5*.65),PinMesh.colliderMaterial=new i.MeshBasicMaterial({transparent:!0,opacity:.5,depthWrite:!1,color:16724312})},65917:(e,t,n)=>{"use strict";n.d(t,{O:()=>PinUnselectCommand});var i=n(93037);class PinUnselectCommand extends i.m{constructor(e){super(),this.id="PIN_UNSELECT",this.payload={id:e}}}},20323:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SweepPinMesh});var i=n(57227),s=n(14877),r=n(2212),o=n(35998),a=n(12918),l=n(94772),c=n(36407),d=n(78720),u=n(95847),h=n(5477),p=n(28757),m=n(16493);const f=new h.Z("pin-mesh");class PinMeshRenderer{constructor(e,t,n,i,s,o){this.sweepViewData=e,this.scene=t,this.sweepTextureLoader=n,this.input=i,this.layer=o,this.container=new r.Object3D,this.bindings=[],this.visibilityFilter=()=>!0,this.updatePlacementType=(e,t)=>{this.dataToMeshMap[e.id]||e.placementType!==l.hU.MANUAL?this.dataToMeshMap[e.id]&&e.placementType!==l.hU.MANUAL&&(this.removePinMesh(e),this.engine.broadcast(new a.h(e.id,t,!1))):(this.createPinMesh(e,this.cameraData),this.engine.broadcast(new a.h(e.id,t,!0)))},this.hoverSweep=(e,t)=>{this.issueCommand(new p.kR(e,t,0));const n=this.sweepViewData.selectedSweep===e;this.highlightPin(e,t||n)},this.meshes=[],this.meshToDataMap={},this.dataToMeshMap={},this.cameraData=s,e.iterate((t=>{t.alignmentType!==l.z9.ALIGNED&&(t.placementType===l.hU.MANUAL&&this.createPinMesh(t,s),this.bindings.push(t.onChanged((()=>{const n=e.getIndexByAlignment(!1,t.id);this.updatePlacementType(t,n),d.H7(t)&&this.updatePinMeshPosition(t.id,t.position)}))))}))}updatePinMeshPosition(e,t){this.mapSweepToMesh(e).updatePosition(t)}mapSweepToMesh(e){return this.dataToMeshMap[e]}mapColliderToSweep(e){const t=e.hasOwnProperty("collider")?e:e.parent;if(t){const e=this.meshToDataMap[t.id];if(e)return e.sweep}return null}filter(e){this.visibilityFilter=e;for(const e of this.meshes)this.filterMesh(e)}init(){}dispose(){for(const e in this.meshToDataMap){const t=this.meshToDataMap[e];this.removePinMesh(t.sweep)}}render(e){for(const t of this.meshes)t.render(e)}activate(e){this.engine=e,this.issueCommand=e.commandBinder.issueCommand.bind(e.commandBinder),this.bindings.push(this.input.registerMeshHandler(u.z,m.s.isType(o.m1),((e,t)=>this.onHoverEvent(t,!0)))),this.bindings.push(this.input.registerMeshHandler(u.A,m.s.isType(o.m1),((e,t)=>this.onHoverEvent(t,!1)))),this.scene.add(this.container)}deactivate(e){for(const e of this.bindings)e.cancel();this.bindings.length=0,this.scene.remove(this.container)}getMeshes(){return this.meshToDataMap}highlightPin(e,t){this.dataToMeshMap[e]&&this.dataToMeshMap[e].setPinHover(t?1:0,!1)}lockSelection(e,t){return t&&(this.engine.broadcast(new a.c(e.id,!0)),this.hoverSweep(e.id,!0)),!0}createPinMesh(e,t){const n=new o.Vp(e.position,null,t,this.layer);this.meshes.push(n),this.dataToMeshMap[e.id]=n,this.meshToDataMap[n.id]={id:n.id,sweep:e},this.container.add(n),this.filterMesh(n),this.sweepTextureLoader.loadFace(e,c.SL.BASE,1,{flipY:!0}).then((e=>{n.material.uniforms.tPinHole.value=e})).catch((t=>{f.error(`${e.id} failed to load texture: ${t}`)}))}removePinMesh(e){const t=this.dataToMeshMap[e.id],n=this.meshes.findIndex((e=>e.id===t.id));this.meshes.splice(n,1),this.container.remove(t),this.deactivateMesh(t),delete this.meshToDataMap[t.id],delete this.dataToMeshMap[e.id],t.dispose()}filterMesh(e){const t=this.meshToDataMap[e.id];if(t){const n=t.sweep;this.visibilityFilter(n)?this.activateMesh(e):this.deactivateMesh(e)}}onHoverEvent(e,t){const n=this.mapColliderToSweep(e);n&&this.hoverSweep(n.id,t)}activateMesh(e){this.input.registerMesh(e.collider,!1),e.activate()}deactivateMesh(e){this.input.unregisterMesh(e.collider);const t=this.meshToDataMap[e.id];t&&(this.hoverSweep(t.sweep.id,!1),e.deactivate())}}PinMeshRenderer.MENU_CLEAR_DEBOUNCE=100;var g=n(87393),v=n(65917),y=n(42374),b=n(9986),S=n(15099),E=n(37363),T=n(61903),w=n(22878),x=n(56044),_=n(60649),M=n(37123),O=n(64038),A=n(51381),C=n(24486);class SweepPinMesh extends i.Y{constructor(){super(...arguments),this.name="sweep-pin-mesh",this.onChange=()=>{const e=this.sweepViewData,t=e.selectedSweep,n=e.toolState===M._.ROTATING||e.toolState===M._.ROTATED;this.pinRenderer.filter((e=>{if(!this.settingsData.tryGetProperty(C.s,!0))return!1;if(n&&t===e.id)return!1;if(this.viewmodeData.transition.active&&(0,w.Bw)(this.viewmodeData.transition.to))return!1;const i=!this.nextFloor||this.nextFloor===e.floorId||!e.floorId,s=this.config.showPinsInFloorplanDollhouse||this.applicationData.application===b.Mx.WORKSHOP,r=this.viewmodeData.closestMode===w.Ey.Dollhouse||this.viewmodeData.closestMode===w.Ey.Floorplan;return i&&r&&s}))},this.onSelectedPinChange=()=>{const e=this.sweepViewData.selectedSweep;e&&(this.engine.commandBinder.issueCommand(new p.iF(e,!0,0)),this.pinRenderer.highlightPin(e,!0))}}async init(e,t){var n;[this.model,this.webglRenderer,this.input,this.sweepViewData,this.cameraData,this.settingsData,this.viewmodeData,this.floorsViewData,this.applicationData]=await Promise.all([t.getModule(y.default),t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.getModuleBySymbol(s.y.INPUT),t.market.waitForData(_.D),t.market.waitForData(S.M_),t.market.waitForData(T.e),t.market.waitForData(E.O),t.market.waitForData(x.c),t.market.waitForData(b.pu)]);const i=t.claimRenderLayer(this.name),r=this.webglRenderer.getScene().scene;this.config={showPinsInFloorplanDollhouse:null===(n=e&&e.showPinsInFloorplanDollhouse)||void 0===n||n},this.engine=t;const o=new g.Z(this.model.getSignedUrls());this.pinRenderer=new PinMeshRenderer(this.sweepViewData,r,o,this.input,this.cameraData,i),t.addComponent(this,this.pinRenderer),this.bindings.push(this.applicationData.onPropertyChanged("application",this.onChange),this.settingsData.onPropertyChanged(C.s,this.onChange),this.viewmodeData.onChanged(this.onChange),this.sweepViewData.onSelectedSweepChanged(this.onSelectedPinChange),t.subscribe(O.S,(e=>{this.nextFloor=e.to,this.onChange()})),t.subscribe(A.WY,this.onChange),t.subscribe(A._G,this.onChange),t.commandBinder.addBinding(v.O,(async e=>{this.pinRenderer.highlightPin(e.id,!1)}))),this.nextFloor=this.floorsViewData.currentFloorId,this.onChange()}mapColliderToSweep(e){return this.pinRenderer.mapColliderToSweep(e)}selectPinMesh(e,t){return this.pinRenderer.lockSelection(e,t)}highlightPinMesh(e,t){this.pinRenderer.highlightPin(e,t)}mapSweepToMesh(e){return this.pinRenderer.mapSweepToMesh(e)}updatePosition(e,t){this.pinRenderer.updatePinMeshPosition(e,t)}}},12918:(e,t,n)=>{"use strict";n.d(t,{c:()=>PinSelectMessage,h:()=>PinPlacementMessage});var i=n(4117);class PinSelectMessage extends i.v{constructor(e,t){super(),this.sweepId=e,this.selected=t}}class PinPlacementMessage extends i.v{constructor(e,t,n){super(),this.sweepId=e,this.pinIndex=t,this.placed=n}}},24486:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i="features/360_views"},89236:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SweepPinNavigation});var i=n(57227),s=n(20323),r=n(35998),o=n(10830),a=n(42226),l=n(22878),c=n(14832),d=n(98370),u=n(37363),h=n(2212),p=n(3035),m=n(95847),f=n(16493),g=n(14877);class SweepPinNavigation extends i.Y{constructor(){super(...arguments),this.name="sweep-pin-navigation"}async init(e,t){const[n,i,v,y]=await Promise.all([t.getModule(s.default),t.getModule(d.default),t.market.waitForData(u.O),t.getModuleBySymbol(g.y.INPUT)]),b=new h.Quaternion;this.bindings.push(y.registerMeshHandler(p.R,f.s.isType(r.m1),((e,t,s)=>{const r=n.mapColliderToSweep(t);return!(!r||v.transition.active)&&(b.set(0,0,0,1).multiply(r.rotation),o=r.id,a=b,v.currentMode&&v.currentMode!==l.Ey.Panorama&&i.switchToMode(l.Ey.Panorama,c.n.FadeToBlack,{sweepID:o,rotation:a}),!0);var o,a})),y.registerMeshHandler(m.z,f.s.isType(r.m1),((e,i)=>{n.mapColliderToSweep(i)&&t.commandBinder.issueCommand(new o.u(a.C.FINGER))})),y.registerMeshHandler(m.A,f.s.isType(r.m1),((e,i)=>{n.mapColliderToSweep(i)&&t.commandBinder.issueCommand(new o.u(null))})))}}},7365:(e,t,n)=>{"use strict";n.d(t,{p:()=>PortalPuckMesh,Y:()=>l});var i=n(2212),s=n(63069),r=n.n(s),o=n(58324),a=n.n(o);class PortalMaterial extends i.RawShaderMaterial{constructor(e,t){const n=i.UniformsUtils.clone(PortalMaterial.uniforms);n.tNoHover.value=e,n.tHover.value=t,n.tPortal.value=null,super({vertexShader:r(),fragmentShader:a(),uniforms:n,name:"PortalMaterial",transparent:!0})}}PortalMaterial.uniforms={tNoHover:{type:"t",value:null},tHover:{type:"t",value:null},tPortal:{type:"t",vlaue:null},progress:{type:"f",value:1},opacity:{type:"f",value:1}};var l,c=n(83834),d=n(74170),u=n(99295),h=n(75026);!function(e){e[e.HIDE=0]="HIDE",e[e.SHOW=1]="SHOW",e[e.ONTOP=2]="ONTOP"}(l||(l={}));class PortalPuckMesh extends i.Mesh{constructor(e,t){const n=new PortalMaterial(c.P.get().toInteriorTexture,c.P.get().toInteriorHoverTexture);super(PortalPuckMesh.geometry,n),this.layers.mask=t.mask,this.uniforms=n.uniforms,this.renderOrder=u.z.portals,this.setState(l.HIDE),this.update(e)}update(e){if(this.portalData=e,this.position.copy(e.position),null!==e.lookDirection){const t=e.lookDirection.clone().add(e.position);this.lookAt(t)}this.hoverProgress=0,this.hovered=!1,e.toExterior?(this.uniforms.tNoHover.value=c.P.get().toExteriorTexture,this.uniforms.tHover.value=c.P.get().toExteriorHoverTexture):(this.uniforms.tNoHover.value=c.P.get().toInteriorTexture,this.uniforms.tHover.value=c.P.get().toInteriorHoverTexture)}resetMesh(e=0,t=!1,n=!1){this.uniforms.opacity.value=e,this.visible=0!==e,this.material.depthTest=t,this.material.depthWrite=n}setHover(e){this.hovered=e}setState(e){switch(e){case l.HIDE:this.resetMesh(0,!0,!0);break;case l.SHOW:this.resetMesh(1,!0,!0);break;case l.ONTOP:this.resetMesh(1)}}render(e,t){var n;if(this.hovered&&this.hoverProgress<1?this.hoverProgress+=e/300:!this.hovered&&this.hoverProgress>0&&(this.hoverProgress-=e/300),this.hoverProgress=(0,d.uZ)(this.hoverProgress,0,1),this.uniforms.progress.value=this.hoverProgress,null===(n=this.portalData)||void 0===n?void 0:n.billboard){const e=t.pose.position,n=this.position.copy(this.portalData.position),i=e.distanceTo(n);i<h.nm?n.lerpVectors(e,n,h.nm/i):i>h.iz&&n.lerpVectors(e,n,h.iz/i),this.lookAt(t.pose.position)}}updatePortalTexture(e){this.uniforms.tPortal.value=e}raycast(e,t){if(!this.visible)return;const n=[];super.raycast(e,n),n.length>0&&(n[0].distance/=1e4,t.push(n[0]))}}PortalPuckMesh.geometry=new i.PlaneGeometry(h.vX,h.vX)},83834:(e,t,n)=>{"use strict";n.d(t,{P:()=>c});var i=n(89034),s=n(68444),r=n(85089),o=n(45545),a=n(64293);let l;const c={get:()=>l||(l={toExteriorTexture:(0,i.p)(s),toExteriorHoverTexture:(0,i.p)(r),toInteriorTexture:(0,i.p)(o),toInteriorHoverTexture:(0,i.p)(a)},l)}},63134:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>PortalPuckMeshModule});var i=n(57227),s=n(14877),r=n(36407),o=n(2212),a=n(80633),l=n.n(a),c=n(32172),d=n.n(c);class PortalViewportMaterial extends o.RawShaderMaterial{constructor(){const e=o.UniformsUtils.clone(PortalViewportMaterial.uniforms);super({vertexShader:l(),fragmentShader:d(),uniforms:e,name:"PortalViewportMaterial",side:o.BackSide})}updateTexture(e){this.uniforms.tMap.value=e}}PortalViewportMaterial.uniforms={tMap:{type:"t",value:null}};class PortalViewportLoader{constructor(e,t,n,i){this.tempLookDirection=new o.Vector3,this.worldCamera=i,this.camera=new o.Camera,this.renderSize=n,this.sweepTextureLoader=e,this.textureRenderer=t,this.renderTargets={},this.renderCube=new o.Mesh(new o.BoxGeometry(4,4,4),new PortalViewportMaterial)}async getPortalTexture(e,t,n){const i=this.renderTargets[e.id]||this.textureRenderer.createRenderTarget2D(this.renderSize,this.renderSize),s=await this.sweepTextureLoader.load(e,r.SL.BASE);return this.renderCube.material.updateTexture(s),this.renderCube.quaternion.copy(t),this.camera.projectionMatrix.copy(this.worldCamera.projectionMatrix),this.worldCamera.getWorldPosition(this.tempLookDirection),this.camera.lookAt(this.tempLookDirection.sub(n).negate()),this.textureRenderer.render(i,this.renderCube,this.camera),i.texture}releasePortalTexture(e){const t=this.renderTargets[e];t&&this.textureRenderer.disposeRenderTarget2D(t)}}var u=n(7365),h=n(85875),p=n(95847),m=n(3035),f=n(16493),g=n(55315);class PortalPuckRenderer{constructor(e,t,n,i,s){this.container=new o.Object3D,this.bindings=[],this.visibilityFilter=e=>u.Y.HIDE,this.scene=e,this.input=t,this.layer=i,this.cameraData=s,this.viewportLoader=n,this.meshes=[],this.activeMeshes={},this.meshToDataMap={},this.dataToMeshMap={},this.activeTexturePromises={},this.meshPool=new h.L}addPortal(e){let t;const n=this.meshPool.get();n?(t=n.object,t.update(e)):t=this.meshPool.add(new u.p(e,this.layer)).object,this.meshes.push(t),this.container.add(t),this.meshToDataMap[t.id]=e,this.dataToMeshMap[e.index]=t,this.activateMesh(t,this.visibilityFilter(e))}removePortal(e){const t=this.dataToMeshMap[e.index];if(t){this.meshPool.free(t);const n=this.meshes.findIndex((e=>e.id===t.id));this.meshes.splice(n,1),this.container.remove(t),this.deactivateMesh(t),delete this.meshToDataMap[t.id],delete this.dataToMeshMap[e.index]}}init(){}activate(e){this.broadcast=e.broadcast.bind(e),this.bindings.push(this.input.registerMeshHandler(p.z,f.s.isType(u.p),((e,t)=>{this.onPuckSelect(t)}))),this.bindings.push(this.input.registerMeshHandler(p.A,f.s.isType(u.p),((e,t)=>{this.onPuckDeselect(t)}))),this.bindings.push(this.input.registerMeshHandler(m.R,f.s.isType(u.p),((e,t)=>{this.onPuckClick(t)}))),this.scene.add(this.container)}dispose(){for(const e of Object.keys(this.meshToDataMap)){const t=this.meshToDataMap[e],n=this.dataToMeshMap[t.index];this.removePortal(t),n.material.dispose(),n.geometry.dispose()}}deactivate(e){for(const e of this.bindings)e.cancel();this.bindings.length=0,this.scene.remove(this.container)}render(e){for(const t of this.meshes)t.render(e,this.cameraData)}filter(e){this.visibilityFilter=e;for(const t of this.meshes){const n=e(this.meshToDataMap[t.id]);n===u.Y.HIDE?this.deactivateMesh(t):this.activateMesh(t,n)}}mapSweepToMesh(e){for(const t in this.meshToDataMap){const n=this.meshToDataMap[t];if(n.toSweep.id===e&&n.toExterior&&n.fromInterior)return this.dataToMeshMap[n.index]}return null}activateMesh(e,t=0){this.activeMeshes[e.id]||(this.input.registerMesh(e,!1),this.activeMeshes[e.id]=!0),e.setState(t)}deactivateMesh(e){this.input.unregisterMesh(e),this.activeMeshes[e.id]=!1,this.onPuckDeselect(e),e.setState(u.Y.HIDE)}onPuckClick(e){this.broadcast(new g.K(this.meshToDataMap[e.id]))}onPuckSelect(e){this.broadcast(new g.x(!0));const t=this.meshToDataMap[e.id].toSweep,n=this.viewportLoader.getPortalTexture(t,t.rotation,e.position);this.activeTexturePromises[e.id]=n,n.then((t=>{this.activeTexturePromises.hasOwnProperty(e.id)&&n===this.activeTexturePromises[e.id]&&(e.updatePortalTexture(t),e.setHover(!0))}))}onPuckDeselect(e){this.broadcast(new g.x(!1)),e.setHover(!1),this.viewportLoader.releasePortalTexture(this.meshToDataMap[e.id].toSweep.id),delete this.activeTexturePromises[e.id]}}var v=n(75026),y=n(42374),b=n(43816),S=n(56709),E=n(53549),T=n(15099),w=n(94772),x=n(87393),_=n(78720),M=n(99931);class PortalPuckMeshModule extends i.Y{constructor(){super(...arguments),this.name="sweep-portal-mesh",this.portalCount=0}async init(e,t){const[n,i,r,o,a,l,c]=await Promise.all([t.getModule(y.default),t.getModuleBySymbol(s.y.RAYCASTER),t.getModuleBySymbol(s.y.INPUT),t.getModule(S.default),t.getModuleBySymbol(s.y.WEBGL_RENDERER),t.market.waitForData(E.Z),t.market.waitForData(T.M_)]),d=t.claimRenderLayer(this.name);this.portalData={};const u=a.getScene().camera,h=new x.Z(n.getSignedUrls());this.raycaster=i;const p=new PortalViewportLoader(h,o,256,u),m=a.getScene().scene;this.portalRenderer=new PortalPuckRenderer(m,r,p,d,c),await Promise.all([t.getModuleBySymbol(s.y.MESH_API_FIXUP)]);const f=w.hU.MANUAL,g=l.filter((e=>_.H7(e)));l.iterate((e=>{this.portalData[e.id]||(this.portalData[e.id]=[]),_.H7(e)&&this.addPortals(e,this.portalRenderer,l,g);let t=e.placementType;this.bindings.push(e.onPropertyChanged("placementType",(n=>{t!==f&&n===f&&this.addPortals(e,this.portalRenderer,l,g),t===f&&n!==f&&this.removePortals(e.id,this.portalRenderer),t=n}))),this.bindings.push(e.onChanged((()=>{_.H7(e)&&(this.removePortals(e.id,this.portalRenderer),this.addPortals(e,this.portalRenderer,l,g))})))})),t.addComponent(this,this.portalRenderer)}filter(e){this.portalRenderer.filter(e)}getPortalToExterior(e){return this.portalRenderer.mapSweepToMesh(e)}removePortals(e,t){for(const n of this.portalData[e])t.removePortal(n);this.portalData[e]=[]}addPortals(e,t,n,i){const s=this.nearestAlignedSweep(e,n);if(s){const n=this.entryLinks(e,s),r=this.neighborLinks(e,i);this.portalData[e.id]=n.concat(r);for(const n of this.portalData[e.id])t.addPortal(n)}else this.log.debug(`Couldn't find the nearest sweep for a 360 on floor ${e.floorId}; not adding portals`)}nearestAlignedSweep(e,t){const n=[_.ff(e),_._k(),_._T(),_.b1(e)],i=[M.TE(e.position)],s=t.sortByScore(n,i)[0];return s?s.sweep:null}modelIntersection(e,t,n=1/0){const i=(new o.Vector3).copy(e.position).sub(t.position).setY(0).normalize(),s=this.raycaster.picking.pick(t.position,i,b.T0);return{intersect:s&&s.distance<=n?s:null,rayDirection:i}}entryLinks(e,t){const n=[],i=e.position.distanceTo(t.position),s=this.modelIntersection(e,t,i+v.vX);let r,a,l=!1;s.intersect&&s.intersect.face?(r=s.intersect.face.normal.clone().setY(0).normalize(),a=s.intersect.point.clone().addScaledVector(r,v.AF)):(r=null,l=!0,a=e.position.clone()),a.y=t.position.y,n.push({index:this.portalCount++,toSweep:e,fromSweep:t,position:a,lookDirection:r,billboard:l,toExterior:!0,fromInterior:!0});const c=(new o.Vector3).lerpVectors(e.position,t.position,2/i).setY(e.position.y);return n.push({index:this.portalCount++,toSweep:t,fromSweep:e,position:c,lookDirection:r?r.clone().negate():null,billboard:l,toExterior:!1,fromInterior:!1}),n}neighborLinks(e,t){const n=[];for(const i of t)if(e!==i&&i.floorId===e.floorId&&e.position.distanceTo(i.position)<v.M0){const t=e.position.distanceTo(i.position);if(this.modelIntersection(e,i,t).intersect||this.modelIntersection(i,e,t).intersect)continue;const s=e.position.clone().sub(i.position).setY(0).normalize(),r=i.position.clone(),o=v.iz;t>o&&r.addScaledVector(s,t-o),n.push({index:this.portalCount++,toSweep:i,fromSweep:e,position:r,lookDirection:s,billboard:!1,toExterior:!0,fromInterior:!1})}return n}}},55315:(e,t,n)=>{"use strict";n.d(t,{K:()=>PortalClickMessage,x:()=>PortalHoverMessage});var i=n(4117);class PortalClickMessage extends i.v{constructor(e){super(),this.toSweep=e.toSweep,this.toExterior=e.toExterior,this.fromInterior=e.fromInterior,this.meshPosition=e.position}}class PortalHoverMessage extends i.v{constructor(e){super(),this.hovered=e}}},75026:(e,t,n)=>{"use strict";n.d(t,{M0:()=>s,AF:()=>r,vX:()=>o,nm:()=>a,iz:()=>l});var i=n(87100);const s=(0,i.eY)("geond",15),r=(0,i.eY)("geowo",.1),o=.3,a=.75,l=4},72004:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SweepPortalNavigation});var i=n(87100),s=n(48558);const r=(0,i.eY)("geodist",(0,s._F)((0,i.eY)("geodistft",20)));var o=n(57227),a=n(63134),l=n(94772),c=n(22878),d=n(14832),u=n(15099),h=n(53549),p=n(98370),m=n(37363),f=n(7365),g=n(55315),v=n(48730),y=n(61903),b=n(24486),S=n(42226),E=n(10830);class SweepPortalNavigation extends o.Y{constructor(){super(...arguments),this.name="sweep-portal-navigation",this.onChange=()=>{this.portalRenderer.filter((e=>{if(!this.settingsData.tryGetProperty(b.s,!0))return f.Y.HIDE;if(!(0,c.Bw)(this.viewmodeData.closestMode))return f.Y.HIDE;const t=this.sweepData.getSweep(this.sweepData.currentSweep||"");if(t)if(t.alignmentType===l.z9.ALIGNED){if(e.fromInterior&&e.toExterior&&e.position.distanceTo(t.position)<r)return f.Y.SHOW}else if(t.placementType===l.hU.MANUAL&&e.fromSweep.id===t.id)return f.Y.ONTOP;return f.Y.HIDE}))}}async init(e,t){this.engine=t,[this.portalRenderer,this.cameraData,this.viewmodeModule,this.viewmodeData,this.sweepData,this.settingsData]=await Promise.all([t.getModule(a.default),t.market.waitForData(u.M_),t.getModule(p.default),t.market.waitForData(m.O),t.market.waitForData(h.Z),t.market.waitForData(y.e)]);const n=(e,n)=>{this.viewmodeData.currentMode&&this.cameraData.canTransition()&&(this.viewmodeData.currentMode!==c.Ey.Panorama?this.viewmodeModule.switchToMode(c.Ey.Panorama,d.n.FadeToBlack,{sweepID:e,rotation:n}):t.commandBinder.issueCommand(new v.ju({sweep:e,rotation:n,transition:d.n.FadeToBlack})))};this.settingsData.onPropertyChanged(b.s,this.onChange),this.bindings.push(t.subscribe(g.K,(e=>{n(e.toSweep.id)})),t.subscribe(g.x,(e=>this.onPortalHover(e.hovered))),this.viewmodeData.onChanged(this.onChange),this.sweepData.onChanged(this.onChange)),this.onChange()}onPortalHover(e){const t=e?S.C.FINGER:null;this.engine.commandBinder.issueCommand(new E.u(t))}}},1392:(e,t,n)=>{"use strict";n.d(t,{Z:()=>PuckClickedMessage});var i=n(4117);class PuckClickedMessage extends i.v{constructor(e,t,n){super(),this.sweepId=e,this.sweepIndex=t,this.totalSweeps=n}}},80567:(e,t,n)=>{"use strict";n.d(t,{Z:()=>PuckHoverMessage});var i=n(4117);class PuckHoverMessage extends i.v{constructor(e,t){super(),this.sweepId=e,this.hovered=t}}},26583:(e,t,n)=>{"use strict";n.d(t,{YY:()=>PuckCollider,C$:()=>PuckRenderer});var i=n(2212),s=n(28757),r=n(95847),o=n(3035),a=n(1392),l=n(33299),c=n(99295),d=n(94772),u=n(14279),h=n(80567);class PuckMesh extends i.Mesh{}class PuckCollider extends i.Mesh{}class PuckRenderer{constructor(e,t,n,s,r,o,a,c=new i.Color(16724312),d=new i.Color(16724312),u=.8,h=.8,p=300,m=.4,f=l.o.ALL){this.scene=e,this.input=t,this.settingsData=n,this.sweepViewData=s,this.puckImagery=r,this.onFloor=o,this.checkRenderModes=a,this.idleColor=c,this.selectionColor=d,this.idleOpacity=u,this.editingOpacity=h,this.selectionDuration=p,this.puckSize=m,this.layer=f,this.sweepToMesh={},this.colliderToSweep={},this.editingEnabled=!1,this.dummyMat=new i.MeshBasicMaterial,this.puckOffset=new i.Vector3(0,.05,0),this.bindings=[],this.wasDrawing=!1,this.renderPuckHighlight=(e,t)=>{if(!this.sweepViewData.isSweepAligned(e))return;const n=this.sweepToMesh[e].material.color;t?n.copy(this.selectionColor):n.copy(this.idleColor)},this.updateLookAt=e=>{this.sweepViewData.iterate((t=>{const n=this.sweepToMesh[t.id];n&&n.visible&&n.lookAt(e)}))}}init(){if(this.puckGeometry=new i.PlaneBufferGeometry(this.puckSize,this.puckSize),this.onFloor){const e=new i.Matrix4;e.makeRotationFromEuler(new i.Euler(-Math.PI/2,0,0,"XYZ")),this.puckGeometry.applyMatrix4(e)}this.sphereColliderGeometry=new i.SphereBufferGeometry(.5*this.puckSize,10,10),this.matParamsEnabled={color:this.idleColor.getHex(),opacity:this.idleOpacity,transparent:!0,depthWrite:!1,map:this.puckImagery.enabled},this.sweepViewData.iterate(this.createPuck.bind(this))}get displayDisabled(){return void 0!==this.puckImagery.disabled}onSweepStateAnimationChanged(e,t,n){const i=n.value,s=e.enabled?this.puckImagery.enabled:this.puckImagery.disabled,r=e.enabled?this.puckImagery.enabledHover:this.puckImagery.disabledHover,o=i>0&&this.editingEnabled,a=e.id===this.sweepViewData.selectedSweep,l=this.editingEnabled&&a?this.selectionColor:this.idleColor,c=this.editingEnabled?this.editingOpacity:this.idleOpacity;t.setValues({map:o?r:s}),t.color.copy(l),t.opacity=c*(1-i)+1*i}createMaterial(e){const t=new i.MeshBasicMaterial(this.matParamsEnabled);return this.puckImagery.disabled&&!e.enabled&&t.setValues({map:this.puckImagery.disabled}),this.bindings.push(e.onPropertyChanged("enabled",(()=>{t.setValues({map:e.enabled?this.puckImagery.enabled:this.puckImagery.disabled})}))),t}createMesh(e,t){const n=new PuckMesh(this.puckGeometry,t);this.onFloor?n.position.copy(e.floorPosition).add(this.puckOffset):(n.position.copy(e.position),n.rotation.setFromQuaternion(e.rotation)),n.name=e.id,n.updateMatrixWorld(!1),n.renderOrder=c.z.panoMarker;const i=this.sweepViewData.getState(e.id);return n.visible=i.visible,this.bindings.push(i.onPropertyChanged("visible",(e=>{n.visible=e}))),this.bindings.push(i.onPropertyChanged("animation",(n=>this.onSweepStateAnimationChanged(e,t,n)))),n.layers.mask=this.layer.mask,n}createCollider(e,t){let n;return n=this.onFloor?new PuckCollider(this.puckGeometry,this.dummyMat):new PuckCollider(this.sphereColliderGeometry,this.dummyMat),n.userData.sid=e.id,n.position.copy(t.position),n.rotation.copy(t.rotation),n.name=e.id,n.updateMatrixWorld(!1),n}createPuck(e){if(e.alignmentType!==d.z9.ALIGNED)return;const t=this.createMaterial(e),n=this.createMesh(e,t),i=this.createCollider(e,n);n.collider=i,this.sweepToMesh[e.id]=n,this.colliderToSweep[i.id]=e.id}toggleEditingEnabled(e){this.editingEnabled=e;for(const t in this.sweepToMesh){this.sweepToMesh[t].material.opacity=e?this.editingOpacity:this.idleOpacity}}getSweepId(e){return this.colliderToSweep[e]}updatePuckImagery(e){let t;this.displayDisabled||void 0===e.disabled?this.displayDisabled&&void 0===e.disabled&&(t=!1):t=!0,this.puckImagery=e,this.sweepViewData.iterate((e=>{if(e.alignmentType!==d.z9.ALIGNED)return;const n=this.sweepToMesh[e.id],i=this.sweepViewData.getState(e.id);n.visible=i.visible;let s=this.puckImagery.enabled;if(!e.enabled&&this.puckImagery.disabled&&(s=this.puckImagery.disabled),this.sweepToMesh[e.id].material.setValues({map:s}),void 0!==t){if(e.enabled)return;t?this.addSweepToScene(e.id):this.removeSweepFromScene(e.id)}}))}updateCheckRenderModes(e){this.checkRenderModes=e}removeSweepFromScene(e){const t=this.sweepToMesh[e];this.scene.remove(t),this.input.unregisterMesh(t.collider)}addSweepToScene(e){if(!this.sweepViewData.getSweep(e).enabled&&!this.displayDisabled)return;const t=this.sweepToMesh[e];this.scene.add(t),this.input.registerMesh(t.collider,!0)}render(){const e=this.checkRenderModes(),t=this.settingsData.tryGetProperty(u.U,!0);if(e&&t){if(!this.wasDrawing){for(const e in this.sweepToMesh)this.addSweepToScene(e);this.wasDrawing=!0}}else if(this.wasDrawing){for(const e in this.sweepToMesh)this.removeSweepFromScene(e);this.wasDrawing=!1}}dispose(){for(const e in this.sweepToMesh){const t=this.sweepToMesh[e];t.material.dispose(),t.geometry.dispose()}}activate(e){this.wasDrawing=!1;const t=new PuckComparator(this.sweepViewData);this.bindings.push(this.input.registerMeshHandler(r.z,t,((t,n)=>{e.commandBinder.issueCommand(new s.kR(this.getSweepId(n.id),!0,this.selectionDuration)),e.broadcast(new h.Z(this.getSweepId(n.id),!0))}))),this.bindings.push(this.input.registerMeshHandler(r.A,t,((t,n)=>{e.commandBinder.issueCommand(new s.kR(this.getSweepId(n.id),!1,this.selectionDuration)),e.broadcast(new h.Z(this.getSweepId(n.id),!1))}))),this.bindings.push(this.input.registerMeshHandler(o.R,t,((t,n)=>{const i=this.sweepViewData.getSweep(this.colliderToSweep[n.id]).index,s=this.sweepViewData.getAlignedSweeps(!0).length;e.broadcast(new a.Z(this.colliderToSweep[n.id],i,s))})))}deactivate(e){for(const e in this.sweepToMesh)this.removeSweepFromScene(e);for(const e of this.bindings)e.cancel();this.bindings.length=0}}class PuckComparator{constructor(e){this.sweepViewData=e}compare(e){if(e instanceof PuckCollider){return this.sweepViewData.getSweepVisibility(this.sweepViewData.getSweep(e.userData.sid))}return!1}}},14279:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});const i="features/sweep_pucks"},60649:(e,t,n)=>{"use strict";n.d(t,{D:()=>SweepViewData});var i=n(35424),s=n(67779),r=n(94772),o=n(78720),a=n(66910),l=n(98254),c=n(41252);class SweepState extends l.T{constructor(){super(...arguments),this.selected=!1,this.visible=!0,this.animation=new c.z(0)}}var d=n(37123);class SweepViewData extends i.V{constructor(e){super(),this.data=e,this.name="sweeps-view",this.states=new a.v,this.toolStateObservable=(0,s.Y)(d._.CLOSED),this.defaultSweepVisibilityRule=e=>e.enabled,this.sweepVisibilityRule=this.defaultSweepVisibilityRule,this.selectCurrentSweep=()=>{this.setSelectedSweep(this.data.currentSweep||null)},this.derivedData={},this.selectedSweepObservable=new s.f(null);const t=[d._.MOVING,d._.PLACING,d._.PRESSING,d._.ROTATING];e.makeSweepChangeSubscription((()=>{t.includes(this.toolState)||this.selectCurrentSweep()})),e.iterate((e=>{const t=new SweepState;this.states.set(e.id,t),t.commit()})),this.updateViewData()}updateViewData(){this.data.iterate(((e,t)=>{this.derivedData[e.id]=this.makeViewDataForSweep(e,t)})),this.commit()}updateSweepVisibilityRule(e){this.sweepVisibilityRule=e||this.defaultSweepVisibilityRule}getSweepVisibility(e){return this.sweepVisibilityRule(e)}get selectedSweep(){return this.selectedSweepObservable.value}setSelectedSweep(e){if(e===this.selectedSweep)return;const t=this.selectedSweep;if(this.selectedSweepObservable.value=e,null!==e){const t=this.getState(e);t.selected=!0,t.commit()}if(null!==t){const e=this.getState(t);e.selected=!1,e.commit()}}onSelectedSweepChanged(e){return this.selectedSweepObservable.onChanged(e)}setToolState(e){e===d._.PLACING&&this.selectedSweep&&this.setSelectedSweep(null),this.toolStateObservable.value=e}get toolState(){return this.toolStateObservable.value}onToolStateChanged(e){return this.toolStateObservable.onChanged(e)}getSweep(e){return this.data.getSweep(e)}makeViewDataForSweep(e,t){const n=this.derivedData[e.id];return n?(n.floorId=e.floorId,n.position=e.position,n.alignmentType=e.alignmentType,n.placed=e.placementType===r.hU.MANUAL,n.enabled=e.enabled,n.name=e.name,n):{id:e.id,floorId:e.floorId,position:e.position,index:e.index,alignmentType:e.alignmentType,dataIndex:t,placed:e.placementType===r.hU.MANUAL,enabled:e.enabled,name:e.name}}getViewData(e){const t=this.data.getSweep(e),n=this.derivedData[e];return t&&!n&&(this.derivedData[e]=this.makeViewDataForSweep(t,t.index)),this.derivedData[e]}isSweepAligned(e){return this.data.isSweepAligned(e)}iterate(e){this.data.iterate(e)}getState(e){return this.states.get(e)}isVisible(e){return this.states.get(e).visible}setVisible(e,t){const n=this.getState(e);n.visible!==t&&(n.visible=t,n.commit())}updateAnimations(e){for(const t of this.states)t.animation.tick(e)}modifySelectAnimation(e,t,n){const i=this.getState(e).animation,s=1===i.endValue;t!==s&&(s?i.modifyAnimation(i.value,0,n):i.modifyAnimation(0,1,n))}getIndexByAlignment(e,t){return this.getAlignedSweeps(e).findIndex((e=>e.id===t))}getAlignedSweeps(e){const t=Object.values(this.derivedData);return e?t.filter((0,o._T)()):t.filter((0,o.WO)())}}},37123:(e,t,n)=>{"use strict";var i;n.d(t,{_:()=>i}),function(e){e.CLOSED="closed",e.IDLE="idle",e.PRESSING="pressing",e.PLACING="placing",e.MOVING="moving",e.ROTATING="rotating",e.ROTATED="rotated"}(i||(i={}))},3637:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>SweepViewDataModule});var i=n(57227),s=n(53549),r=n(60649),o=n(28757),a=n(37363),l=n(32548),c=n(56044),d=n(41907),u=n(84586);class SweepViewDataModule extends i.Y{constructor(){super(...arguments),this.name="sweep-viewdata",this.selectionEnabled=!0,this.nonPanoCurrentPuckVisible=!1,this.sweepMap={},this.sweepIdList=[],this.enableSweepSelection=async e=>{this.selectionEnabled=!0},this.disableSweepSelection=async e=>{this.selectionEnabled=!1},this.toggleCurrentPuck=async e=>{this.nonPanoCurrentPuckVisible=e.visible,this.updateVisibility(this.viewData.data.currentSweep)},this.onSweepSelectCommand=async e=>{this.selectionEnabled&&this.viewData.modifySelectAnimation(e.id,e.selected,e.duration)},this.onSweepHoverCommand=async e=>{this.viewData.modifySelectAnimation(e.id,e.hovered,e.duration)},this.updateVisibility=async e=>{if(this.viewmodeData.isInside()){if(e){const t=this.viewData.getSweep(e).neighbours;this.viewData.iterate((e=>{const n=this.viewData.getSweepVisibility(e)&&-1!==t.indexOf(e.id);this.viewData.setVisible(e.id,n)})),this.viewData.setVisible(e,!1)}}else this.viewData.iterate((e=>{this.viewData.setVisible(e.id,this.floorsViewData.isCurrentOrAllFloors(e.floorId))})),e&&this.viewData.setVisible(e,this.nonPanoCurrentPuckVisible)}}async init(e,t){this.data=await t.market.waitForData(s.Z),this.viewData=t.market.tryGetData(r.D)||new r.D(this.data),t.market.register(this,r.D,this.viewData),this.bindings.push(t.commandBinder.addBinding(o.iF,this.onSweepSelectCommand),t.commandBinder.addBinding(o.kR,this.onSweepHoverCommand),t.commandBinder.addBinding(o.zd,this.enableSweepSelection),t.commandBinder.addBinding(o.ZD,this.disableSweepSelection),t.commandBinder.addBinding(o.e9,this.toggleCurrentPuck),this.data.onChanged((()=>this.viewData.updateViewData())),t.msgBus.subscribe(u.sY,(()=>this.viewData.updateViewData()))),this.viewmodeData=await t.market.waitForData(a.O),this.floorsViewData=await t.market.waitForData(c.c),this.bindings.push(this.data.onPropertyChanged("currentSweep",this.updateVisibility),t.subscribe(l.P,(()=>this.updateVisibility(this.viewData.data.currentSweep))),t.subscribe(d.bS,(()=>this.updateVisibility(this.viewData.data.currentSweep))),this.viewmodeData.makeModeChangeSubscription((()=>this.updateVisibility(this.viewData.data.currentSweep)))),this.updateVisibility(this.viewData.data.currentSweep)}onUpdate(e){this.viewData.updateAnimations(e)}}},69826:(e,t,n)=>{"use strict";n.d(t,{n:()=>TagsViewData});var i=n(2212),s=n(35424),r=n(67779),o=n(29984),a=n(77280),l=n(59483);function c(e,t,n,i,s){if(isNaN(t)||isNaN(n)||isNaN(i))return e;var r,o,a,l,c,d,u,h,p,m,f,g,v=e._root,y={data:s},b=e._x0,S=e._y0,E=e._z0,T=e._x1,w=e._y1,x=e._z1;if(!v)return e._root=y,e;for(;v.length;)if((h=t>=(o=(b+T)/2))?b=o:T=o,(p=n>=(a=(S+w)/2))?S=a:w=a,(m=i>=(l=(E+x)/2))?E=l:x=l,r=v,!(v=v[f=m<<2|p<<1|h]))return r[f]=y,e;if(c=+e._x.call(null,v.data),d=+e._y.call(null,v.data),u=+e._z.call(null,v.data),t===c&&n===d&&i===u)return y.next=v,r?r[f]=y:e._root=y,e;do{r=r?r[f]=new Array(8):e._root=new Array(8),(h=t>=(o=(b+T)/2))?b=o:T=o,(p=n>=(a=(S+w)/2))?S=a:w=a,(m=i>=(l=(E+x)/2))?E=l:x=l}while((f=m<<2|p<<1|h)==(g=(u>=l)<<2|(d>=a)<<1|c>=o));return r[g]=v,r[f]=y,e}function d(e,t,n,i,s,r,o){this.node=e,this.x0=t,this.y0=n,this.z0=i,this.x1=s,this.y1=r,this.z1=o}function u(e){return e[0]}function h(e){return e[1]}function p(e){return e[2]}function m(e,t,n,i){var s=new f(null==t?u:t,null==n?h:n,null==i?p:i,NaN,NaN,NaN,NaN,NaN,NaN);return null==e?s:s.addAll(e)}function f(e,t,n,i,s,r,o,a,l){this._x=e,this._y=t,this._z=n,this._x0=i,this._y0=s,this._z0=r,this._x1=o,this._y1=a,this._z1=l,this._root=void 0}function g(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var v=m.prototype=f.prototype;v.copy=function(){var e,t,n=new f(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),i=this._root;if(!i)return n;if(!i.length)return n._root=g(i),n;for(e=[{source:i,target:n._root=new Array(8)}];i=e.pop();)for(var s=0;s<8;++s)(t=i.source[s])&&(t.length?e.push({source:t,target:i.target[s]=new Array(8)}):i.target[s]=g(t));return n},v.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e),i=+this._z.call(null,e);return c(this.cover(t,n,i),t,n,i,e)},v.addAll=function(e){var t,n,i,s,r,o=e.length,a=new Array(o),l=new Array(o),d=new Array(o),u=1/0,h=1/0,p=1/0,m=-1/0,f=-1/0,g=-1/0;for(n=0;n<o;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(s=+this._y.call(null,t))||isNaN(r=+this._z.call(null,t))||(a[n]=i,l[n]=s,d[n]=r,i<u&&(u=i),i>m&&(m=i),s<h&&(h=s),s>f&&(f=s),r<p&&(p=r),r>g&&(g=r));if(u>m||h>f||p>g)return this;for(this.cover(u,h,p).cover(m,f,g),n=0;n<o;++n)c(this,a[n],l[n],d[n],e[n]);return this},v.cover=function(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var i=this._x0,s=this._y0,r=this._z0,o=this._x1,a=this._y1,l=this._z1;if(isNaN(i))o=(i=Math.floor(e))+1,a=(s=Math.floor(t))+1,l=(r=Math.floor(n))+1;else{for(var c,d,u=o-i||1,h=this._root;i>e||e>=o||s>t||t>=a||r>n||n>=l;)switch(d=(n<r)<<2|(t<s)<<1|e<i,(c=new Array(8))[d]=h,h=c,u*=2,d){case 0:o=i+u,a=s+u,l=r+u;break;case 1:i=o-u,a=s+u,l=r+u;break;case 2:o=i+u,s=a-u,l=r+u;break;case 3:i=o-u,s=a-u,l=r+u;break;case 4:o=i+u,a=s+u,r=l-u;break;case 5:i=o-u,a=s+u,r=l-u;break;case 6:o=i+u,s=a-u,r=l-u;break;case 7:i=o-u,s=a-u,r=l-u}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=s,this._z0=r,this._x1=o,this._y1=a,this._z1=l,this},v.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},v.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},v.find=function(e,t,n,i){var s,r,o,a,l,c,u,h,p,m=this._x0,f=this._y0,g=this._z0,v=this._x1,y=this._y1,b=this._z1,S=[],E=this._root;for(E&&S.push(new d(E,m,f,g,v,y,b)),null==i?i=1/0:(m=e-i,f=t-i,g=n-i,v=e+i,y=t+i,b=n+i,i*=i);h=S.pop();)if(!(!(E=h.node)||(r=h.x0)>v||(o=h.y0)>y||(a=h.z0)>b||(l=h.x1)<m||(c=h.y1)<f||(u=h.z1)<g))if(E.length){var T=(r+l)/2,w=(o+c)/2,x=(a+u)/2;S.push(new d(E[7],T,w,x,l,c,u),new d(E[6],r,w,x,T,c,u),new d(E[5],T,o,x,l,w,u),new d(E[4],r,o,x,T,w,u),new d(E[3],T,w,a,l,c,x),new d(E[2],r,w,a,T,c,x),new d(E[1],T,o,a,l,w,x),new d(E[0],r,o,a,T,w,x)),(p=(n>=x)<<2|(t>=w)<<1|e>=T)&&(h=S[S.length-1],S[S.length-1]=S[S.length-1-p],S[S.length-1-p]=h)}else{var _=e-+this._x.call(null,E.data),M=t-+this._y.call(null,E.data),O=n-+this._z.call(null,E.data),A=_*_+M*M+O*O;if(A<i){var C=Math.sqrt(i=A);m=e-C,f=t-C,g=n-C,v=e+C,y=t+C,b=n+C,s=E.data}}return s},v.remove=function(e){if(isNaN(r=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e))||isNaN(a=+this._z.call(null,e)))return this;var t,n,i,s,r,o,a,l,c,d,u,h,p,m,f,g=this._root,v=this._x0,y=this._y0,b=this._z0,S=this._x1,E=this._y1,T=this._z1;if(!g)return this;if(g.length)for(;;){if((u=r>=(l=(v+S)/2))?v=l:S=l,(h=o>=(c=(y+E)/2))?y=c:E=c,(p=a>=(d=(b+T)/2))?b=d:T=d,t=g,!(g=g[m=p<<2|h<<1|u]))return this;if(!g.length)break;(t[m+1&7]||t[m+2&7]||t[m+3&7]||t[m+4&7]||t[m+5&7]||t[m+6&7]||t[m+7&7])&&(n=t,f=m)}for(;g.data!==e;)if(i=g,!(g=g.next))return this;return(s=g.next)&&delete g.next,i?(s?i.next=s:delete i.next,this):t?(s?t[m]=s:delete t[m],(g=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&g===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!g.length&&(n?n[f]=g:this._root=g),this):(this._root=s,this)},v.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},v.root=function(){return this._root},v.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},v.visit=function(e){var t,n,i,s,r,o,a,l,c=[],u=this._root;for(u&&c.push(new d(u,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=c.pop();)if(!e(u=t.node,i=t.x0,s=t.y0,r=t.z0,o=t.x1,a=t.y1,l=t.z1)&&u.length){var h=(i+o)/2,p=(s+a)/2,m=(r+l)/2;(n=u[7])&&c.push(new d(n,h,p,m,o,a,l)),(n=u[6])&&c.push(new d(n,i,p,m,h,a,l)),(n=u[5])&&c.push(new d(n,h,s,m,o,p,l)),(n=u[4])&&c.push(new d(n,i,s,m,h,p,l)),(n=u[3])&&c.push(new d(n,h,p,r,o,a,m)),(n=u[2])&&c.push(new d(n,i,p,r,h,a,m)),(n=u[1])&&c.push(new d(n,h,s,r,o,p,m)),(n=u[0])&&c.push(new d(n,i,s,r,h,p,m))}return this},v.visitAfter=function(e){var t,n=[],i=[];for(this._root&&n.push(new d(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));t=n.pop();){var s=t.node;if(s.length){var r,o=t.x0,a=t.y0,l=t.z0,c=t.x1,u=t.y1,h=t.z1,p=(o+c)/2,m=(a+u)/2,f=(l+h)/2;(r=s[0])&&n.push(new d(r,o,a,l,p,m,f)),(r=s[1])&&n.push(new d(r,p,a,l,c,m,f)),(r=s[2])&&n.push(new d(r,o,m,l,p,u,f)),(r=s[3])&&n.push(new d(r,p,m,l,c,u,f)),(r=s[4])&&n.push(new d(r,o,a,f,p,m,h)),(r=s[5])&&n.push(new d(r,p,a,f,c,m,h)),(r=s[6])&&n.push(new d(r,o,m,f,p,u,h)),(r=s[7])&&n.push(new d(r,p,m,f,c,u,h))}i.push(t)}for(;t=i.pop();)e(t.node,t.x0,t.y0,t.z0,t.x1,t.y1,t.z1);return this},v.x=function(e){return arguments.length?(this._x=e,this):this._x},v.y=function(e){return arguments.length?(this._y=e,this):this._y},v.z=function(e){return arguments.length?(this._z=e,this):this._z};var y=n(63387),b=n(41674);class TagsViewData extends s.V{constructor(e,t,n,i,s,a,c,d,u,h){super(),this.data=e,this.floorsData=t,this.cameraStartData=n,this.sortOrder=i,this.textParser=s,this.linkHandler=a,this.tagDefaultTitle=c,this.backgroundTexture=d,this.maskTexture=u,this.keywordsEnabled=h,this.name="tags-view-data",this.alphabeticTagViewsObservable=(0,o.C)([]),this.enabledTagViewsObservable=(0,o.C)([]),this.sortedTagViewsObservable=(0,o.C)([]),this.openTagViewObservable=(0,r.Y)(null),this.tagsMode=l.U.DEFAULT,this.dirtyTagState=!1,this.creatingTag=!1,this.suspendVisibilityUpdates=!1,this.updateViewData()}getData(){return this.data}getTextParser(){return this.textParser}getLinkHandler(){return this.linkHandler}setTagsMode(e){this.tagsMode=e,this.commit()}get tagViewList(){return this.enabledTagViewsObservable}getAlphabeticTagViews(){return this.alphabeticTagViewsObservable}getSortedTagViewList(){return this.sortedTagViewsObservable}getTagCount(){return this.data.collection.length}setTagSortOrder(e){this.sortOrder=e,this.updateSortedTagViews()}hasSortOrder(){return this.sortOrder.length>0}getTagView(e){const t=this.alphabeticTagViewsObservable.findIndex((t=>t.id===e));return-1!==t?this.alphabeticTagViewsObservable.get(t):null}getTagViewByIndex(e){return-1!==e?this.enabledTagViewsObservable.get(e):null}getOpenTagFlatListIndex(e){if(!this.openTagView)return-1;return(e?this.sortedTagViewsObservable.values():this.enabledTagViewsObservable.values()).findIndex((e=>{var t;return e.id===(null===(t=this.openTagView)||void 0===t?void 0:t.id)}))}updateViewData(){const e=[];this.data.iterate((t=>{const n=this.createTagView(t);e.push(n)}));const t=this.sortByText(e);this.alphabeticTagViewsObservable.replace(t),this.updateSortedTagViews()}createTagView(e){return{id:e.sid,created:e.created,modified:e.modified,label:e.label,description:e.description,enabled:e.enabled,color:`#${e.color.getHexString()}`,anchorPosition:e.anchorPosition,floorId:e.floorId,roomId:e.roomId,stemNormal:e.stemVector,stemLength:e.stemHeight,stemEnabled:e.stemVisible,attachments:e.externalAttachments.concat(e.fileAttachments,e.sandboxAttachments),objectAnnotationId:e.objectAnnotationId,keywords:e.keywords,backgroundTexture:this.backgroundTexture,maskTexture:this.maskTexture,widgetFrame:void 0,preventPreview:!1,preventSelect:!1,preventDock:!1}}setOpenTagView(e){this.openTagViewObservable.value=e}get openTagView(){return this.openTagViewObservable.value}onOpenTagViewChanged(e){return this.openTagViewObservable.onChanged(e)}updateOpenTagView(e){const t=this.openTagView;t&&(Object.assign(t,e),this.setOpenTagView(t))}getAvailableKeywords(){return Array.from(new Set(this.data.getTagKeywords()))}updateSortedTagViews(){const e=this.sortByOrder(this.alphabeticTagViewsObservable.values()),t=e.filter((e=>!e.objectAnnotationId));this.sortedTagViewsObservable.replace(t),this.updateEnabledTagViews(e)}updateEnabledTagViews(e){const t=e.filter((e=>e.enabled&&!e.objectAnnotationId));this.enabledTagViewsObservable.replace(t)}sortByOrder(e){const{floorsData:t,cameraStartData:n,sortOrder:s}=this,r=n.pose.camera.position||a.f.ZERO,o=n.pose.camera.rotation||new i.Quaternion,l=t.getClosestFloorAtHeight(r.y).index,c=(0,y.xS)(r,o,(0,b.AN)(1)),d=new Map;let u=0;for(let n=0;n<t.getFloorCount();n++){const s=(l+n)%t.getFloorCount(),o=t.getFloorAtIndex(s);if(!o)continue;const a=e.filter((e=>e.floorId===o.id));if(0===a.length)continue;let h,p=1/0;const f=new i.Vector3,g=(new m).x((e=>e.x)).y((e=>e.y)).z((e=>e.z));g.addAll(a.map((e=>{f.copy(e.stemNormal).setLength(e.stemLength).add(e.anchorPosition);const t={id:e.id,x:f.x,y:f.y,z:f.z},n=f.distanceToSquared(r);return n<p&&c.containsPoint(f)&&(p=n,h=t),t})));let v=null!=h?h:g.find(r.x,r.y,r.z);d.set(v.id,u++),g.remove(v);let y=a.length-1;for(;y>0;)v=g.find(v.x,v.y,v.z),d.set(v.id,u++),g.remove(v),y--}const h=new Map;s.forEach(((e,t)=>h.set(e,t)));return e.sort(((e,t)=>{var n,i;const s=(null!==(n=h.get(e.id))&&void 0!==n?n:Number.MAX_SAFE_INTEGER)-(null!==(i=h.get(t.id))&&void 0!==i?i:Number.MAX_SAFE_INTEGER);if(s)return s;const r=d.get(e.id),o=d.get(t.id);if(void 0===r||void 0===o)throw new Error("All ids should exist in spatialPositions");return r-o}))}sortByText(e){return e.sort(((e,t)=>this.sortableText(e)<this.sortableText(t)?-1:1))}sortableText(e){return(e.label.trim()||e.description||this.tagDefaultTitle).toLowerCase()}}},19822:(e,t,n)=>{"use strict";n.d(t,{yU:()=>TagsToolToggleCommand,$J:()=>StartNewTagCommand,QG:()=>SaveTagCommand,bg:()=>SaveTagVisibilityCommand,$g:()=>CancelNewTagCommand,zt:()=>EditTagCommand,q4:()=>ToggleDirtyTagStateCommand,lt:()=>OpenTagCommand,sf:()=>DockLeftTagCommand,T3:()=>DeleteTagCommand,xb:()=>CloseTagCommand,Bz:()=>SaveTagOrderCommand,$D:()=>SuspendTagVisibilityUpdates,yo:()=>ResumeTagVisibilityUpdates,Li:()=>SetTagsModeCommand});var i=n(93037);class TagsToolToggleCommand extends i.m{constructor(e){super(),this.payload={opened:e}}}class StartNewTagCommand extends i.m{constructor(){super()}}class SaveTagCommand extends i.m{constructor(e,t,n,i,s){super(),this.payload={id:e,properties:t,pendingAttachments:n,removedAttachments:i,embed:s}}}class SaveTagVisibilityCommand extends i.m{constructor(e,t){super(),this.payload={id:e,visible:t}}}class CancelNewTagCommand extends i.m{constructor(){super()}}class EditTagCommand extends i.m{constructor(e){super(),this.id="TAG_EDIT",this.payload={tagId:e}}}class ToggleDirtyTagStateCommand extends i.m{constructor(e){super(),this.id="TAG_DIRTY_TOGGLE",this.payload={dirty:e}}}class OpenTagCommand extends i.m{constructor(e,t,n){super(),this.id="TAG_OPEN",this.payload={tagId:e,transition:t,dock:n}}}class DockLeftTagCommand extends i.m{constructor(e,t,n){super(),this.id="TAG_OPEN_LEFT",this.payload={tagId:e,transition:t,dock:n}}}class DeleteTagCommand extends i.m{constructor(e,t){super(),this.id="TAG_DELETE",this.payload={id:e,removalMethod:t}}}class CloseTagCommand extends i.m{constructor(){super()}}class SaveTagOrderCommand extends i.m{constructor(e){super(),this.payload={ids:e}}}class SuspendTagVisibilityUpdates extends i.m{}class ResumeTagVisibilityUpdates extends i.m{}class SetTagsModeCommand extends i.m{constructor(e){super(),this.payload={mode:e}}}},59483:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i}),function(e){e.DEFAULT="default",e.REORDERING="reordering"}(i||(i={}))},12366:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var i=n(67294),s=n(60787);const r=(0,n(59187).M)("creatingTag",(function(){const e=(0,s.w)(),[t,n]=(0,i.useState)(!!e&&e.creatingTag);return(0,i.useEffect)((()=>{if(!e)return()=>{};const t=e.onPropertyChanged("creatingTag",n);return n(e.creatingTag),()=>t.cancel()}),[e]),t}))},74715:(e,t,n)=>{"use strict";n.d(t,{P:()=>d});var i=n(56662),s=n(67294),r=n(20302),o=n(49315);const a=(0,r.u)(o.A);var l=n(59187);function c(){const e=a(),[t,n]=(0,s.useState)(e?e.dockedAnnotation:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){n(e?e.dockedAnnotation:null)}const i=e.onChanged(t);return t(),()=>i.cancel()}),[e]),t}(0,l.M)("dockedAnnotation",c);const d=(0,l.M)("dockedTag",(function(){const e=(0,i.P)(),t=c();return(null==e?void 0:e.id)===(null==t?void 0:t.id)?e:null}))},56662:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var i=n(67294),s=n(60787);function r(){const e=(0,s.w)(),[t,n]=(0,i.useState)(e?e.openTagView:null);return(0,i.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenTagViewChanged(n);return n(e.openTagView),()=>t.cancel()}),[e]),t}(0,n(59187).M)("openTagView",r)},86696:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var i=n(67294),s=n(60787);function r(e){return e?e.getLinkHandler():null}const o=(0,n(59187).M)("linkHandler",(function(){const e=(0,s.w)(),[t,n]=(0,i.useState)(r(e));return(0,i.useEffect)((()=>(t||n(r(e)),()=>{})),[e]),t}))},60787:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var i=n(20302),s=n(69826);const r=(0,i.u)(s.n)},34118:(e,t,n)=>{"use strict";n.d(t,{RY:()=>i,Qy:()=>s,i1:()=>r});const i="features/tags2",s="tags2",r="spaces.tags_v2";Object.freeze({colors:["#d44441","#f44336","#e91e63","#f78da7","#9c4b92","#673ab7","#03687d","#03a9f4","#00bcd4","#417505","#51a868","#37d67a","#cddc39","#fbcd00","#ffac17","#ff6900","#abb8c3","#607d8b"]})},29410:(e,t,n)=>{"use strict";n.d(t,{U:()=>Tool});var i=n(98254);class Tool extends i.T{constructor(e){super(),e&&Object.assign(this,e)}}},25986:(e,t,n)=>{"use strict";n.d(t,{t:()=>ToolsData});var i=n(35424),s=n(67779),r=n(66910),o=n(29984),a=n(20585),l=n(23676);class ToolsData extends i.V{constructor(){super(),this.name="tools-data",this.tools=(0,r.q)(),this.toolsLoadedObservable=(0,s.Y)(!1),this.assetDockedObservable=(0,s.Y)(!1),this.activeToolNameObservable=(0,s.Y)(null),this.toolHistoryObservable=(0,o.C)([]),this.openModalObservable=(0,s.Y)(null),this.toolAccessObservable=(0,s.Y)(l.X$.SCENE),this.panelLayoutObservable=(0,s.Y)((0,a.OR)()?l.wS.NORMAL:l.wS.NARROW),this.panelCollapsedObservable=(0,s.Y)(!1)}iterate(e){for(const t of this.tools)e(t)}get toolsMap(){return this.tools}hasTool(e){return this.toolsMap.has(e)}getTool(e){return this.tools.get(e)}addTool(...e){e.forEach((e=>this.tools.set(e.id,e))),this.onToolsAddedOrRemoved()}removeTool(...e){e.forEach((e=>this.tools.delete(e))),this.onToolsAddedOrRemoved()}removeAllTools(){this.tools.clear(),this.onToolsAddedOrRemoved()}get assetDocked(){return this.assetDockedObservable.value}setAssetDocked(e){this.assetDockedObservable.value=e}getActiveTool(){return this.activeToolName?this.getTool(this.activeToolName):null}get activeToolName(){return this.activeToolNameObservable.value}get previousToolName(){const e=this.toolHistory;return e[e.length-1]||null}setActiveTool(e,t=0){const n=this.toolHistoryObservable.length,i=this.previousToolName,s=this.activeToolNameObservable.value;t>0?this.toolHistoryObservable.splice(-1*t,t):s===i&&n||this.toolHistoryObservable.push(s),this.activeToolNameObservable.value=e}getPreviousToolName(){const e=this.toolHistory;return e[e.length-1]||null}onToolChanged(e){return this.activeToolNameObservable.onChanged(e)}get openModal(){return this.openModalObservable.value}setOpenModal(e){this.openModalObservable.value=e}onOpenModalChanged(e){return this.openModalObservable.onChanged(e)}onToolsLoadedChanged(e){return this.toolsLoadedObservable.onChanged(e)}get toolsLoaded(){return this.toolsLoadedObservable.value}get toolAccess(){return this.toolAccessObservable.value}setToolAccess(e){this.toolAccessObservable.value=e}onToolAssetAccessChanged(e){return this.toolAccessObservable.onChanged(e)}isPanelOpen(){return this.toolPanelLayout===l.wS.SIDE_PANEL||this.toolPanelLayout===l.wS.BOTTOM_PANEL}isPanelCollapsedToBottom(){return this.toolPanelLayout===l.wS.BOTTOM_PANEL&&this.panelCollapsed}setToolPanelLayout(e){this.panelLayoutObservable.value=e}get toolPanelLayout(){return this.panelLayoutObservable.value}onToolPanelLayoutChanged(e){return this.panelLayoutObservable.onChanged(e)}onPanelCollapsedChanged(e){return this.panelCollapsedObservable.onChanged(e)}setPanelCollapsed(e){this.panelCollapsedObservable.value=e}get panelCollapsed(){return this.panelCollapsedObservable.value}onToolsAddedOrRemoved(){this.toolsLoadedObservable.value=!this.toolsLoadedObservable.value}get toolHistory(){return this.toolHistoryObservable.values()}onToolHistoryChanged(e){return this.toolHistoryObservable.onChanged((()=>{e(this.toolHistoryObservable.values())}))}}},34612:(e,t,n)=>{"use strict";n.d(t,{zK:()=>PanelToggleCollapseCommand,tT:()=>ToggleToolCommand,Ye:()=>CloseAndRemoveToolsCommand,MV:()=>RegisterToolsCommand,cR:()=>OpenPreviousToolCommand,z2:()=>OpenToolCommand,eS:()=>CloseCurrentToolCommand,CH:()=>CloseToolCommand});var i=n(93037);class PanelToggleCollapseCommand extends i.m{constructor(e){super(),this.payload={collapse:e}}}PanelToggleCollapseCommand.id="TOOL_PANEL_TOGGLE_COLLAPSE";class ToggleToolCommand extends i.m{constructor(e,t){super(),this.payload={toolName:e,active:t}}}ToggleToolCommand.id="TOGGLE_TOOL";class CloseAndRemoveToolsCommand extends i.m{}CloseAndRemoveToolsCommand.id="CLOSE_REMOVE_TOOLS";class RegisterToolsCommand extends i.m{constructor(e){super(),this.payload={tools:e}}}RegisterToolsCommand.id="REGISTER_TOOLS";class OpenPreviousToolCommand extends i.m{}OpenPreviousToolCommand.id="OPEN_PREVIOUS_TOOL";class OpenToolCommand extends i.m{constructor(e){super(),this.payload={toolName:e}}}OpenToolCommand.id="OPEN_TOOL";class CloseCurrentToolCommand extends i.m{}CloseCurrentToolCommand.id="CLOSE_CURRENT_TOOL";class CloseToolCommand extends i.m{constructor(e){super(),this.payload={toolName:e}}}CloseToolCommand.id="CLOSE_TOOL"},91474:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});const i=55},23676:(e,t,n)=>{"use strict";var i,s,r;n.d(t,{w1:()=>i,wS:()=>s,X$:()=>r}),function(e){e.START_LOCATION="START_LOCATION",e.SCANS_3D="SCANS_3D",e.VIEW_360="VIEW_360",e.PHOTOS="PHOTOS",e.LABELS="LABELS",e.LAYERS="LAYERS",e.MEASUREMENTS="MEASUREMENTS",e.MATTERTAGS="MATTERTAGS",e.HLR="HLR",e.SETTINGS_PANEL="SETTINGS_PANEL",e.NOTES="NOTES",e.TAGS="TAGS",e.BLUR="BLUR",e.SEARCH="SEARCH",e.MESH_TRIM="MESH_TRIM",e.SUMMARY="SUMMARY"}(i||(i={})),function(e){e.NORMAL="normal",e.NARROW="narrow",e.SIDE_PANEL="side-panel",e.BOTTOM_PANEL="bottom-panel"}(s||(s={})),function(e){e.SCENE="scene",e.TOOL="tool",e.LIST="list"}(r||(r={}))},81661:(e,t,n)=>{"use strict";n.d(t,{x:()=>r});var i=n(67294),s=n(68850);function r(){const e=(0,s.w)(),[t,n]=(0,i.useState)(e.activeToolName);return(0,i.useEffect)((()=>{const t=e.onToolChanged(n);return()=>t.cancel()}),[e]),t}(0,n(59187).M)("activeTool",r)},47931:(e,t,n)=>{"use strict";n.d(t,{R:()=>r,W:()=>o});var i=n(67294),s=n(68850);function r(){const e=(0,s.w)(),[t,n]=(0,i.useState)(e.openModal);return(0,i.useEffect)((()=>{const t=e.onOpenModalChanged(n);return()=>t.cancel()}),[e]),t}const o=(0,n(59187).M)("openModal",r)},82289:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});var i=n(67294),s=n(68850);function r(){const e=(0,s.w)(),[t,n]=(0,i.useState)(e.toolPanelLayout);return(0,i.useEffect)((()=>{const t=e.onToolPanelLayoutChanged(n);return()=>t.cancel()}),[e]),t}},68850:(e,t,n)=>{"use strict";n.d(t,{w:()=>r,A:()=>o});var i=n(67294),s=n(60405);function r(){const{toolsData:e}=(0,i.useContext)(s.I);return e}const o=(0,n(59187).M)("toolsData",r)},95245:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AssetDockedMessage:()=>u.ro,AssetUndockedMessage:()=>u.A,CloseAndRemoveToolsCommand:()=>d.Ye,CloseCurrentToolCommand:()=>d.eS,CloseToolCommand:()=>d.CH,FullSizeEditorMessage:()=>u.Zi,OpenPreviousToolCommand:()=>d.cR,OpenToolCommand:()=>d.z2,PanelCollapseMessage:()=>u.U7,PanelToggleCollapseCommand:()=>d.zK,PanelTransitionEndMessage:()=>u.rh,RegisterToolsCommand:()=>d.MV,SetAppBarVisibleMessage:()=>u.bz,ToggleToolCommand:()=>d.tT,ToggleViewingControlsMessage:()=>u.ps,Tool:()=>y.U,ToolAccess:()=>l.X$,ToolPanelLayout:()=>l.wS,Tools:()=>l.w1,ToolsData:()=>c.t,default:()=>b});var i=n(57227),s=n(14877),r=n(9986),o=n(91474),a=n(33669),l=n(23676),c=n(25986);var d=n(34612),u=n(68168),h=n(71843),p=n(56829),m=n(20585),f=n(22122),g=n(41510),v=n(61903);class ToolsModule extends i.Y{constructor(){super(...arguments),this.name="tools-module",this.activeToolDurationMap={},this.keyboardTimeout=0,this.bottomPanelHeight=0,this.sidePanelWidth=0,this.sidePanelLeft=0,this.closeAndRemoveTools=async()=>{await this.deactivateCurrentTool(),this.toolsData.setActiveTool(null),this.toolsData.removeAllTools()},this.updateWorkshopBarVisibility=async()=>{const e=!this.isAppBarHidden();this.engine.broadcast(new u.bz(e))},this.onAssetDocked=()=>{this.toolsData.setAssetDocked(!0),this.adjustCanvasForPanel()},this.onAssetUndocked=()=>{this.toolsData.setAssetDocked(!1),this.adjustCanvasForPanel()},this.handleTextBoxFocus=e=>{window.clearTimeout(this.keyboardTimeout),e.focused?this.keyboardTimeout=window.setTimeout((()=>{document.documentElement.classList.add("keyboard-layout")}),500):document.documentElement.classList.remove("keyboard-layout")},this.onToggleModal=async e=>{this.toggleModal(e.modal,e.open)},this.closeModal=()=>{this.toolsData.openModal&&this.toggleModal(this.toolsData.openModal,!1)},this.toggleTool=async({toolName:e,active:t})=>{t?await this.activateToolName(e):await this.deactivateToolName(e)},this.openTool=async({toolName:e})=>{await this.activateToolName(e)},this.closeTool=async({toolName:e})=>{await this.deactivateToolName(e)},this.closeCurrentTool=async()=>{await this.deactivateCurrentTool(),this.toolsData.setActiveTool(null)},this.openPreviousTool=async()=>{const e=this.toolsData.getPreviousToolName();if(null===e)return;const t=this.toolsData.getTool(e)||null;null!==t?(await this.deactivateCurrentTool(t),await this.activateTool(t),this.toolsData.setActiveTool(e,1)):this.log.error(`Tool not loaded: ${e}`)},this.updateLayoutSize=()=>{const{toolPanelLayout:e}=this.toolsData;let t=e;const n=(0,m.OR)();switch(e){case l.wS.NORMAL:n||(t=l.wS.NARROW);break;case l.wS.SIDE_PANEL:n||(t=l.wS.BOTTOM_PANEL);break;case l.wS.NARROW:n&&(t=l.wS.NORMAL);break;case l.wS.BOTTOM_PANEL:n&&(t=l.wS.SIDE_PANEL)}this.toolsData.setToolPanelLayout(t),this.adjustCanvasForPanel()},this.handlePanelCollapse=async e=>{const{collapse:t}=e;t!==this.toolsData.panelCollapsed&&(this.toolsData.setPanelCollapsed(t),t||this.toolsData.toolPanelLayout!==l.wS.BOTTOM_PANEL||this.closeModal(),this.adjustCanvasForPanel(),this.engine.broadcast(new u.U7(t)))},this.adjustCanvasForPanel=()=>{const{toolPanelLayout:e,panelCollapsed:t,assetDocked:n,openModal:i}=this.toolsData,{sidePanelWidth:s,bottomPanelHeight:r,sidePanelLeft:a}=this,c=this.toolsData.getActiveTool(),d=this.isAppBarHidden()?0:o.B,u=e===l.wS.SIDE_PANEL,h=c&&u&&!t,p=h&&!!(null==c?void 0:c.panelLeft),g=h?-m.LH:0,v=g!==s?g:void 0,y=p?m.LH:0,b=y!==a?y:void 0,S=e===l.wS.BOTTOM_PANEL&&!i&&n,E=-Math.floor(50*(window.innerHeight-d)/100),T=S?E:0,w=T!==r?T:void 0,x=0===v||0===w?0:500;this.resizeCanvas((0,f.hf)(v,w,b,x)),this.bottomPanelHeight=T,this.sidePanelWidth=g,this.sidePanelLeft=y},this.resizeCanvas=async e=>{this.engine.commandBinder.issueCommand(new g.M(e))}}async init(e,t){this.engine=t,await t.getModuleBySymbol(s.y.SHOWCASE_ANALYTICS),this.analytics=await t.getModuleBySymbol(s.y.ANALYTICS),[this.settingsData,this.appData]=await Promise.all([t.market.waitForData(v.e),t.market.waitForData(r.pu)]),this.toolsData=new c.t,window.addEventListener("resize",this.updateLayoutSize),this.updateLayoutSize(),this.bindings.push(t.commandBinder.addBinding(d.tT,this.toggleTool),t.commandBinder.addBinding(d.cR,this.openPreviousTool),t.commandBinder.addBinding(d.z2,this.openTool),t.commandBinder.addBinding(d.CH,this.closeTool),t.commandBinder.addBinding(d.eS,this.closeCurrentTool),t.commandBinder.addBinding(h.Bz,this.onToggleModal),t.commandBinder.addBinding(h.rE,(async()=>this.closeModal())),t.commandBinder.addBinding(d.zK,this.handlePanelCollapse),t.subscribe(u.ro,this.onAssetDocked),t.subscribe(u.A,this.onAssetUndocked),t.subscribe(p.SN,this.handleTextBoxFocus),this.toolsData.onToolPanelLayoutChanged(this.adjustCanvasForPanel),this.toolsData.onToolChanged(this.adjustCanvasForPanel),this.toolsData.onToolChanged(this.updateWorkshopBarVisibility),t.commandBinder.addBinding(d.Ye,this.closeAndRemoveTools),t.commandBinder.addBinding(d.MV,(async({tools:e})=>this.registerTools(...e)))),t.market.register(this,c.t,this.toolsData)}dispose(e){this.closeAndRemoveTools(),window.removeEventListener("resize",this.updateLayoutSize),e.market.unregister(this,c.t)}registerTools(...e){e.forEach((e=>{e.featureFlag&&this.bindings.push(this.settingsData.onPropertyChanged(e.featureFlag,(()=>this.updateEnabledTools())))})),this.toolsData.addTool(...e)}closePanel(){const e=(0,m.OR)();this.toolsData.setToolPanelLayout(e?l.wS.NORMAL:l.wS.NARROW)}openPanel(){const e=(0,m.OR)();this.toolsData.setToolPanelLayout(e?l.wS.SIDE_PANEL:l.wS.BOTTOM_PANEL),e||this.toolsData.setPanelCollapsed(!0)}toggleModal(e,t){const{openModal:n,toolPanelLayout:i}=this.toolsData;if(t&&n===e||!t&&e!==n)return;const s=e.toLowerCase(),o=this.appData.application===r.Mx.WORKSHOP?"workshop_gui":"showcase_gui";this.analytics.track(o,{gui_action:`open_${s}`}),e&&this.analytics.track("modal_shown",{modal:e}),this.toolsData.setOpenModal(t?e:null),i===l.wS.BOTTOM_PANEL&&t!==!!n&&this.adjustCanvasForPanel(),this.engine.broadcast(new p.nV(e,t))}async activateTool(e){this.closeModal(),e.panel&&this.openPanel(),e.manager&&await e.manager.activate(),this.startTrackingTool(e)}async deactivateCurrentTool(e){const t=this.toolsData.getActiveTool();if(!t)return;e&&e.panel&&e.panel===t.panel&&e.panelLeft===t.panelLeft||this.closePanel(),this.closeModal(),t.manager&&await t.manager.deactivate(),this.stopTrackingTool(t)}async activateToolName(e){if(this.toolsData.activeToolName===e)return;const t=this.toolsData.getTool(e)||null;null!==t?(await this.deactivateCurrentTool(t),await this.activateTool(t),this.toolsData.setActiveTool(t.id)):this.log.error(`Tool not loaded: ${e}`)}async deactivateToolName(e,t){e===this.toolsData.activeToolName&&(await this.deactivateCurrentTool(t),this.toolsData.setActiveTool(null))}startTrackingTool(e){this.activeToolDurationMap[e.analytic]=Date.now()}stopTrackingTool(e){const{analytic:t}=e;this.activeToolDurationMap[t]=Date.now()-this.activeToolDurationMap[t];const n={tool:`${t}_session_time`,duration:this.activeToolDurationMap[t]};this.analytics.track("tool_session_time",n)}isAppBarHidden(){const e=this.toolsData.getActiveTool(),t=this.settingsData.tryGetProperty(a.In,!1);return!(!e||t)&&e.hidesAppBar}updateEnabledTools(){const e=this.toolsData.toolsMap;e.atomic((()=>{for(const t of e)if(t.featureFlag){const e=this.settingsData.tryGetProperty(t.featureFlag,!1);t.enabled!==e&&(t.enabled=e,t.commit())}}))}}var y=n(29410);const b=ToolsModule},68168:(e,t,n)=>{"use strict";n.d(t,{ro:()=>AssetDockedMessage,A:()=>AssetUndockedMessage,U7:()=>PanelCollapseMessage,Zi:()=>FullSizeEditorMessage,rh:()=>PanelTransitionEndMessage,ps:()=>ToggleViewingControlsMessage,bz:()=>SetAppBarVisibleMessage});var i=n(4117);class AssetDockedMessage extends i.v{}class AssetUndockedMessage extends i.v{}class PanelCollapseMessage extends i.v{constructor(e){super(),this.collapsed=e}}class FullSizeEditorMessage extends i.v{constructor(e){super(),this.fullSized=e}}class PanelTransitionEndMessage extends i.v{constructor(e,t){super(),this.active=e,this.collapsed=t}}class ToggleViewingControlsMessage extends i.v{constructor(e){super(),this.show=e}}class SetAppBarVisibleMessage extends i.v{constructor(e){super(),this.visible=e}}},61116:(e,t,n)=>{"use strict";n.d(t,{TH:()=>TourStartCommand,vy:()=>TourStopCommand,rU:()=>TourStepCommand,HW:()=>TourRelativeCommand});var i=n(93037);class TourStartCommand extends i.m{constructor(e={}){super(),this.id="TOUR_START",this.payload=e}}class TourStopCommand extends i.m{constructor(e={}){super(),this.id="TOUR_STOP",this.payload=e}}class TourStepCommand extends i.m{constructor(e,t=!1){super(),this.id="TOUR_STEP",this.payload={index:e,instant:t}}}class TourRelativeCommand extends i.m{constructor(e,t=!1){super(),this.id="TOUR_RELATIVE",this.payload={forward:e,instant:t}}}},4323:(e,t,n)=>{"use strict";n.d(t,{z:()=>TourTransitionError,Y:()=>TourStartError});var i=n(40603);class TourTransitionError extends i.y{constructor(e="Invalid tour transition"){super(e),this.name="TourTransition"}}class TourStartError extends i.y{constructor(e="Cannot start tour"){super(e),this.name="TourStart"}}},84347:(e,t,n)=>{"use strict";var i,s,r;n.d(t,{BZ:()=>i,kw:()=>s,Aq:()=>r}),function(e){e[e.Pan=0]="Pan",e[e.PanDollhouse=1]="PanDollhouse",e[e.Zoom=2]="Zoom",e[e.Delay=3]="Delay",e[e.None=4]="None"}(i||(i={})),function(e){e[e.Left=1]="Left",e[e.Auto=0]="Auto",e[e.Right=-1]="Right"}(s||(s={})),function(e){e[e.Move=0]="Move",e[e.Burns=1]="Burns",e[e.Zoom=2]="Zoom",e[e.Path=3]="Path",e[e.FloorChange=4]="FloorChange",e[e.Delay=5]="Delay",e[e.Nop=6]="Nop"}(r||(r={}))},84586:(e,t,n)=>{"use strict";n.d(t,{oR:()=>TourStartedMessage,Vx:()=>TourSteppedMessage,dW:()=>TourStartTransitionMessage,_3:()=>TourStartBurnsTransitionMessage,NR:()=>TourStoppedMessage,Mt:()=>TourEndedMessage,sY:()=>TourStopAddedMessage});var i=n(4117);class TourStartedMessage extends i.v{}class TourSteppedMessage extends i.v{constructor(e){super(),this.index=e}}class TourStartTransitionMessage extends i.v{constructor(e){super(),this.index=e}}class TourStartBurnsTransitionMessage extends i.v{constructor(e,t,n){super(),this.index=e,this.transitionType=t,this.duration=n}}class TourStoppedMessage extends i.v{constructor(e){super(),this.willResume=e}}class TourEndedMessage extends i.v{}class TourStopAddedMessage extends i.v{}},77866:(e,t,n)=>{"use strict";n.d(t,{WQ:()=>r,EU:()=>o,OJ:()=>a,BY:()=>l,Im:()=>c,LO:()=>d,N5:()=>u,Qo:()=>h,Pv:()=>p,Mk:()=>m,mL:()=>f,eu:()=>g,NY:()=>v,gS:()=>y,O2:()=>b,rM:()=>S,z8:()=>E,f7:()=>T,Cp:()=>w,_D:()=>x,HJ:()=>_,BA:()=>M,pn:()=>O,z$:()=>A,b_:()=>C,mS:()=>N,GS:()=>D,su:()=>I,_c:()=>L,Xd:()=>P});var i=n(87100),s=n(98370);const r="TourSpeed &wts",o="ToursMetersPerSecond",a=.4,l=10,c=1.25,d=.8,u=6,h=3,p=1e3*d,m=1e3*c,f=600,g=400,v=1200,y=1200,b=35,S=15,E=120,T=1200,w=75,x=400,_=s.DEFAULT_TRANSITION_TIME-f,M=35,O=M/3500*1e3,A=2,C=52,N=0,D=2e3,I=.2*O,L=3500,P=Object.freeze({panAtSnapshot:1===(0,i.eY)("kb",1),snapshotPanZoomDuration:(0,i.eY)("st",3500),snapshotPanAngle:(0,i.eY)("sspa",M),walkingTourIncludeExtraPanosDistance:.4,walkingStageMinimumDistance:.8,maxWalkingSweepsBetweenSnapshots:40,autoStartDelay:(0,i.eY)("ts",-1)})},18196:(e,t,n)=>{"use strict";n.d(t,{HG:()=>o,JG:()=>a,mf:()=>l,DA:()=>c});var i=n(63387),s=n(994),r=n(77866);const o=e=>{let t=r.Im;if(!isNaN(e)){const n=Math.min(Math.max(r.OJ,e),r.BY);t=(0,i.et)(n,r.OJ,r.BY,r.LO,r.Qo)}return t},a=e=>(0,i.et)(e,r.LO,r.N5,r.OJ,r.BY),l=e=>Math.min(Math.max(r.LO,e),r.N5),c=e=>(0,s.Id)(e)/1e3},3819:(e,t,n)=>{"use strict";n.d(t,{T:()=>ToursViewData});var i=n(35424),s=n(67779),r=n(8259);class ToursViewData extends i.V{constructor(e,t,n){super(),this.data=e,this.name="tours-view-data",this.reelOpenObservable=(0,s.Y)(!1),this.tourModeSettingObservable=(0,s.Y)(t),this.currentTourModeObservable=(0,s.Y)(n)}getPhotosForTour(){return this.data.getPhotosForTour()}isTourEmpty(){return 0===this.data.getSnapshotCount()}onReelChanged(e){return this.data.getReel().onChanged(e)}getTourStoryMode(){return this.currentTourMode===r.zz.STORIES}get currentTourMode(){return this.currentTourModeObservable.value}setCurrentTourMode(e){this.currentTourModeObservable.value=e}onCurrentTourModeChanged(e){return this.currentTourModeObservable.onChanged(e)}get tourModeSetting(){return this.tourModeSettingObservable.value}setTourModeSetting(e){this.tourModeSettingObservable.value=e}onTourModeSettingChanged(e){return this.tourModeSettingObservable.onChanged(e)}setReelOpen(e){this.reelOpenObservable.value=e}get reelOpen(){return this.reelOpenObservable.value}onReelOpenChanged(e){return this.reelOpenObservable.onChanged(e)}}},72699:(e,t,n)=>{"use strict";n.d(t,{b:()=>c,k:()=>TourData});var i=n(35424),s=n(84347),r=n(23688),o=n(67779),a=n(29984),l=n(8259);const c={active:!1,type:s.Aq.Move,promise:Promise.resolve(),stop:()=>Promise.resolve(),toIndex:-1,duration:0,started:-1,stopped:-1};class TourData extends i.V{constructor(e={},t,n,i,s){super(),this.snapshots=e,this.activeReel=t,this.allowedModes=n,this.modelSweeps=i,this.looping=s,this.name="tour",this.tourState=l.Vs.Inactive,this.transitionObservable=(0,o.Y)(c),this.tourCurrentSnapshot=-1,this.enabledTourStops=(0,a.C)([]),this.tourPlaying=!1,this.tourWillResume=!1,this.tourEnded=!1,this.updateEnabledStops=e=>{if(this.enabledTourStops.replace([]),this.activeReel&&this.activeReel.reel)for(const t of this.activeReel.reel)if(t&&t.sid in this.snapshots){const n=this.snapshots[t.sid],i=n.metadata.cameraMode,s=n.metadata.scanId,r=-1!==e.indexOf(i),o=this.modelSweeps.findIndex((e=>e.id===s)),a=void 0!==s&&-1!==o&&this.modelSweeps[o].enabled,l=!s;r&&(l||a)&&this.enabledTourStops.push(t.sid)}},this.updateEnabledStops(n),this.looping=s,this.commit()}addSnapshotToTour(e,t=l.VH.Current){this.snapshots[e.sid]=e;this.allowedModes.includes(e.metadata.cameraMode)&&this.enabledTourStops.push(e.sid);const n=this.tourCurrentSnapshotSid;switch(this.tourCurrentSnapshotSid=e.sid,t){case l.VH.Beginning:this.tourCurrentSnapshot=0,this.activeReel.reel.insert(0,{sid:e.sid});break;case l.VH.End:this.tourCurrentSnapshot=this.enabledTourStops.length-1,this.activeReel.reel.push({sid:e.sid});break;case l.VH.Current:if(void 0===n)this.tourCurrentSnapshot=this.enabledTourStops.length-1,this.activeReel.reel.push({sid:e.sid});else{let t=this.activeReel.reel.findIndex((e=>!!e&&e.sid===n))+1;(t<=0||t>this.activeReel.reel.length)&&(t=this.activeReel.reel.length-1),this.tourCurrentSnapshot=this.tourCurrentSnapshot+1,this.activeReel.reel.insert(t,{sid:e.sid})}break;default:throw new Error(`Tours.addSnapshotToTour not implemented: ${t}`)}this.commit()}clearHighlightOverrides(e,t,n){if(!t&&!n)return;const i={};t&&(i.transitionType=void 0),n&&(i.panDirection=void 0,i.panAngle=void 0),this.applyHighlightOverrides(e,i)}clearAllHighlightOverrides(){this.getReel().reel.forEach((e=>{e&&this.clearHighlightOverrides(e.sid,!0,!0)}))}resetAllTransitionTypeOverrides(){if(this.activeReel&&this.activeReel.reel){let e=!1;this.activeReel.reel.forEach(((t,n)=>{t&&t.overrides&&t.overrides.transitionType&&(delete t.overrides.transitionType,this.activeReel.reel.update(n,t),e=!0)})),e&&this.activeReel.setDirty()}}resetAllPanSettingOverrides(){if(this.activeReel&&this.activeReel.reel){let e=!1;this.activeReel.reel.forEach(((t,n)=>{t&&t.overrides&&(void 0===t.overrides.panAngle&&void 0===t.overrides.panDirection||(delete t.overrides.panAngle,delete t.overrides.panDirection,e=!0,this.activeReel.reel.update(n,t)))})),e&&this.activeReel.setDirty()}}applyHighlightOverrides(e,t){const n=this.activeReel.reel.findIndex((t=>!!t&&t.sid===e));this.setHighlightOverrides(n,t)}setHighlightOverrides(e,t){const n=this.activeReel.reel.get(e);if(!n)throw Error(`Highlight not found for ${e}`);const i={sid:n.sid};n.overrides?(i.overrides=Object.assign({},n.overrides),t.hasOwnProperty("panDirection")&&(i.overrides.panDirection=t.panDirection),t.hasOwnProperty("transitionType")&&(i.overrides.transitionType=t.transitionType),t.hasOwnProperty("panAngle")&&(i.overrides.panAngle=t.panAngle)):i.overrides={transitionType:t.transitionType,panDirection:t.panDirection,panAngle:t.panAngle},this.activeReel.reel.update(e,i)}updateReelEntry(e){const{sid:t}=e,n=this.activeReel.reel.findIndex((e=>!!e&&e.sid===t));if(-1===n)throw Error(`Reel entry not found for ${t}`);const i=this.activeReel.reel.get(n);if(!e)throw Error(`Reel entry not found for ${n}`);const s=Object.assign({},i,e);this.activeReel.reel.update(n,s)}moveTourStop(e,t){const n=this.activeReel.reel.findIndex((t=>!!t&&t.sid===e)),i=this.activeReel.reel.findIndex((e=>!!e&&e.sid===t));this.activeReel.reel.move(n,i)}clear(){this.resetEmptyReel(),this.enabledTourStops.replace([]),this.activeReel.reel.length=0,this.commit()}removeTourStop(e){const t=this.enabledTourStops.indexOf(e),n=this.activeReel.reel.findIndex((t=>!!t&&t.sid===e)),i=this.getTourIndexBySid(e);if(-1!==t&&this.enabledTourStops.splice(t,1),this.enabledTourStops.length>0){const e=i<=this.tourCurrentSnapshot?this.tourCurrentSnapshot-1:this.tourCurrentSnapshot;this.setTourCurrentSnapshotByIndex(Math.max(e,0))}else this.resetEmptyReel();this.activeReel.reel.remove(n)}getReel(){return this.activeReel}isLooping(){return this.looping}setLooping(e){this.looping=e}getActiveReelTourMode(){return this.activeReel.mode||r.Z.REEL}setActiveReelTourMode(e){this.activeReel.mode=e,this.activeReel.commit()}isTourActive(){return this.tourState!==l.Vs.Inactive}getCurrentTourState(){return{currentStep:this.getTourCurrentSnapshotIndex(),tourPlaying:this.tourPlaying||this.tourWillResume,totalSteps:this.getSnapshotCount(),tourEnded:this.tourEnded,activeStep:this.transition&&-1!==this.transition.toIndex?this.transition.toIndex:this.getTourCurrentSnapshotIndex(),highlights:this.getReelHighlights(),transition:this.transition}}get transition(){return this.transitionObservable.value}isTourTransitionActive(){return this.transition.active}getTourTransitionType(){return this.transition.type}useTransition(e){this.transitionObservable.value=e}async stopTourTransition(){await this.transition.stop()}iterateSnapshots(e){let t=0;this.activeReel.reel.forEach((n=>{if(n&&this.isEnabled(n.sid)){const i=this.snapshots[n.sid];e(i,t++)}}))}isSnapshotInTour(e){return-1!==this.activeReel.reel.findIndex((t=>!!t&&t.sid===e))}getEnabledSnapshots(){const e=[];return this.iterateSnapshots(((t,n)=>{e.push(t)})),e}updateSnapshots(e){this.snapshots=e}async getPhotosForTour(){const e=[];for(const t in this.snapshots){const n=this.snapshots[t];"tour"!==n.category&&"panorama"!==n.category&&e.push({name:n.name,sid:n.sid,thumbnailUrl:await n.thumbnailUrl.get(),inReel:-1!==this.activeReel.reel.findIndex((e=>!!e&&e.sid===t)),created:n.created})}return e.sort(((e,t)=>t.created.getTime()-e.created.getTime())),e}getSnapshot(e){return this.snapshots[e]}getTourStop(e){const t=this.activeReel.reel.findIndex((t=>!!t&&t.sid===e)),n=this.activeReel.reel.get(t);return{snapshot:this.getSnapshot(e),reelEntry:n}}getReelHighlights(){const e=[];return this.activeReel.reel.forEach((t=>{if(t&&this.isEnabled(t.sid)){const n=this.snapshots[t.sid],i=t.overrides&&t.overrides.panDirection,s=t.overrides&&t.overrides.panAngle;e.push({id:n.sid,snapshot:n,panDirection:i,panAngle:s,transitionType:t.overrides&&t.overrides.transitionType,title:t.title,description:t.description})}})),e}getSnapshotCount(){return this.enabledTourStops.length}getTourState(){return this.tourState}setTourState(e){this.tourState=e,this.commit()}getTourCurrentSnapshotIndex(){return this.tourCurrentSnapshot}getTourCurrentSnapshotSid(){return this.tourCurrentSnapshotSid}getTourSnapshotSid(e){let t=0;for(const n of this.activeReel.reel)if(n&&this.isEnabled(n.sid)){if(t===e)return n.sid;t++}throw new Error("getTourSnapshotSid() -> Invalid snapshot index.")}getTourSnapshotsWithSweepId(e){const t=[];for(const n of this.activeReel.reel)n&&n.sid in this.snapshots&&this.snapshots[n.sid].metadata.scanId===e&&t.push(n.sid);return t}setTourCurrentSnapshotByIndex(e){if(e<0||e>this.getSnapshotCount())throw new Error("setTourCurrentSnapshotByIndex() -> Invalid tour index.");let t=-1;for(const n of this.activeReel.reel)if(n&&this.isEnabled(n.sid)&&(t++,t===e)){this.tourCurrentSnapshot=e,this.tourCurrentSnapshotSid=n.sid;break}-1===t&&this.resetEmptyReel(),this.commit()}getTourIndexBySid(e){let t=-1;for(const n of this.activeReel.reel)if(n&&this.isEnabled(n.sid)&&(t++,n.sid===e))return t;return-1}isEnabled(e){return-1!==this.enabledTourStops.indexOf(e)}resetEmptyReel(){this.tourCurrentSnapshot=-1,this.tourCurrentSnapshotSid=void 0,this.useTransition(c),this.commit()}}},8259:(e,t,n)=>{"use strict";var i,s,r;n.d(t,{zz:()=>i,Vs:()=>s,VH:()=>r}),function(e){e.NONE="none",e.STORIES="stories",e.LEGACY="legacy"}(i||(i={})),function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.StopScheduled=2]="StopScheduled"}(s||(s={})),function(e){e[e.Beginning=0]="Beginning",e[e.Current=1]="Current",e[e.End=2]="End"}(r||(r={}))},4731:(e,t,n)=>{"use strict";n.d(t,{J:()=>p,j:()=>m});var i=n(67294),s=n(8259),r=n(53825),o=n(59187),a=n(95551),l=n(20302),c=n(3819);const d=(0,l.u)(c.T);const u=(0,n(67779).Y)(s.zz.NONE);var h=n(35318);function p(){const e=function(){const e=d();return(0,a.y)(e?e.currentTourModeObservable:u)}(),t=(0,h.s)(),n=(0,i.useRef)(0),[o,l]=(0,i.useState)(!1),c=t.active,p=e===s.zz.STORIES;return(0,r.rf)((()=>(l(!0),window.clearTimeout(n.current),c?()=>{}:(n.current=window.setTimeout((()=>{l(!1)}),3e3),()=>window.clearTimeout(n.current)))),[c]),p&&(c||o)}const m=(0,o.M)("showStoryTour",p)},17445:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});var i=n(20302),s=n(72699);const r=(0,i.u)(s.k)},35318:(e,t,n)=>{"use strict";n.d(t,{s:()=>o});var i=n(67294),s=n(17445),r=n(72699);function o(){const e=(0,s.o)(),[t,n]=(0,i.useState)(e?e.transition:r.b);return(0,i.useEffect)((()=>{if(!e)return()=>{};n(e.transition);const t=e.transitionObservable.onChanged(n);return()=>t.cancel()}),[e]),t}},49598:(e,t,n)=>{"use strict";n.d(t,{lj:()=>i,RN:()=>s,Un:()=>r,So:()=>o,vw:()=>a,kk:()=>l,rU:()=>c,Nu:()=>d,iL:()=>u});const i="features/tour-stories",s="gt",r=0,o=1,a=2,l=3,c="hr",d=0,u=1},36669:(e,t,n)=>{"use strict";n.d(t,{ir:()=>a,aW:()=>l,w7:()=>c,oI:()=>d});var i=n(8428),s=n(8259),r=n(49598),o=n(23688);function a(e){const t=e.tryGetProperty(i.gx.HighlightReel,!0),n=e.tryGetProperty(r.rU,r.iL);return t&&n!==r.Nu}function l(e,t){const n=function(e){const t=e.tryGetProperty(i.gx.TourButtons,!0),n=e.tryGetProperty(r.RN,r.So);return t&&n!==r.Un}(e),l=a(e);return n||l?function(e,t){if(!d(e))return!1;const n=e.tryGetProperty(r.RN,r.So);if(n===r.vw)return!0;if(n===r.kk)return!1;return t===o.Z.REEL}(e,t)?s.zz.STORIES:s.zz.LEGACY:s.zz.NONE}function c(e,t){const n=e.tryGetProperty(i.gx.TourButtons,!0),r=e.tryGetProperty(i.gx.HighlightReel,!0);return n||r?d(e)&&t===o.Z.REEL?s.zz.STORIES:s.zz.LEGACY:s.zz.NONE}function d(e){return e.tryGetProperty(r.lj,!1)}},18568:(e,t,n)=>{"use strict";n.d(t,{F:()=>DeletedObject});var i=n(98254),s=n(81402);class DeletedObject extends i.T{constructor(e){super(),this.id=(0,s.O1)(11),e&&Object.assign(this,e)}}},52903:(e,t,n)=>{"use strict";n.d(t,{B:()=>RegisterDeletedObjectTypeCommand,p:()=>RestoreDeletedObjectCommand});var i=n(93037);class RegisterDeletedObjectTypeCommand extends i.m{constructor(e){super(),this.id="REGISTER_DELETED_OBJECT_TYPE_COMMAND",this.payload=e}}class RestoreDeletedObjectCommand extends i.m{constructor(e){super(),this.id="RESTORE_DELETED_OBJECT_COMMAND",this.payload={id:e}}}},59114:(e,t,n)=>{"use strict";n.d(t,{m:()=>UserData});var i=n(35424),s=n(66910),r=n(92310),o=n(10969),a=n(94170),l=n(48342);class UserData extends i.V{constructor(e,t,n,i=[]){super(),this.orgAdmin=n,this.policies=i,this.name="users-data",this.users=(0,s.q)();const l=e.modelAccess||a.x.PUBLIC;this.currentUser=new r.a(Object.assign(Object.assign({},e),{modelAccess:l,userStatus:t?o.J.KNOWN:o.J.UNKNOWN})),this.addUser(this.currentUser)}loadSearchResults(e,t,n){this.atomic((()=>{e.forEach((e=>{this.loadUser(Object.assign(Object.assign({},e),{userStatus:o.J.KNOWN}))})),t.forEach((e=>{this.users.get(e)||this.loadUser({email:e,id:"",userStatus:n})}))}))}loadKnownUsers(e){this.atomic((()=>{e.forEach((e=>{this.loadKnownUser(e)}))}))}loadKnownUser(e){return this.loadUser(Object.assign(Object.assign({},e),{userStatus:o.J.KNOWN}))}loadContributor(e){const t=this.users.get(e.email);return t||this.loadUser(Object.assign(Object.assign({},e),{userStatus:o.J.CONTRIBUTOR}))}loadFailedUser(e){return this.loadUser(Object.assign(Object.assign({},e),{userStatus:o.J.FAILED}))}loadUser(e){let t=this.users.get(e.email);return e.email===this.currentUser.email||t&&t.userStatus===o.J.KNOWN&&t.modelAccess!==a.x.PUBLIC||(t=new r.a(e),t?this.users.set(e.email,t):this.addUser(t)),t}getUserInfoByEmail(e){return this.users.has(e)?this.users.get(e):null}getUserInfoById(e){return""===e?null:this.users.values.find((t=>t.id===e))||null}getUserDisplay(e){return this.users.has(e)?this.users.get(e):(0,l.Q)(e)}iterate(e){for(const t of this.users)e(t)}getUsersWhoMayNeedAccess(){const e={};return this.users.values.forEach((t=>{t.userStatus===o.J.KNOWN&&t.modelAccess!==a.x.PUBLIC||(e[t.email]=t)})),e}getKnownUsers(){return this.users.values.filter((e=>e.userStatus===o.J.KNOWN))}addUser(e){this.users.has(e.email)||this.users.set(e.email,e)}getCurrentUser(){return this.currentUser}isLoggedIn(){return!!this.currentUser.id}isPolicyFlagEnabled(e){return this.policies.includes(e)}isOrgAdmin(){return this.orgAdmin}isInviter(){return this.orgAdmin}isEditor(){return this.currentUser.modelAccess===a.x.FULL}isCommenter(){const{modelAccess:e}=this.currentUser;return e===a.x.VIEWER||e===a.x.FULL}getCurrentUserId(){return this.currentUser.id}onUsersChanged(e){return this.users.onChanged(e)}}},92310:(e,t,n)=>{"use strict";n.d(t,{a:()=>UserInfo});var i=n(10969),s=n(94170),r=n(48342);class UserInfo{constructor(e){this.email="",this.id="",this.firstName="",this.lastName="",this.modelAccess=s.x.PUBLIC,this.userStatus=i.J.UNKNOWN,this.name="",this.initials="",this.color="",e&&Object.assign(this,e);const t=this.id?this.getFullName(this.firstName,this.lastName):"";this.name=t||this.email||"",this.initials=this.getInitials(this.name),this.color=(0,r._)(this.id)}getFullName(e,t){return e&&t?`${e} ${t}`:e||t}getInitials(e){const t=e?e.split(" ").map((e=>e[0])).join(""):"?";return t.length<3?t:`${t[0]}${t[t.length-1]}`}}},76223:(e,t,n)=>{"use strict";n.d(t,{V1:()=>UserMentionSearchCommand,Vu:()=>ResolveUserMentionsCommand,JB:()=>InviteUsersCommand});var i=n(93037);class UserMentionSearchCommand extends i.m{constructor(e){super(),this.payload={search:e}}}class ResolveUserMentionsCommand extends i.m{constructor(e){super(),this.payload={userMentions:e}}}class InviteUsersCommand extends i.m{constructor(e,t,n,i){super(),this.payload={emails:e,message:t,modelAccess:n,noteId:i}}}},10969:(e,t,n)=>{"use strict";var i;n.d(t,{J:()=>i}),function(e){e.UNKNOWN="unknown",e.FAILED="failed",e.MENTIONED="mentioned",e.CONTRIBUTOR="contributor",e.KNOWN="known"}(i||(i={}))},74678:(e,t,n)=>{"use strict";n.r(t),n.d(t,{InviteUsersCommand:()=>p.JB,OrgUser:()=>OrgUser,ResolveUserMentionsCommand:()=>p.Vu,UserData:()=>h.m,UserInfo:()=>f.a,UserMentionSearchCommand:()=>p.V1,UserStatus:()=>u.J,default:()=>g,defaultUserColor:()=>m._,getUnknownUserInfo:()=>m.Q});var i=n(57227),s=n(5477),r=n(66225),o=n(38636),a=n(94170);class OrgUser{constructor(e){this.id="",this.email="",this.firstName="",this.lastName="",this.modelAccess=a.x.PUBLIC,Object.assign(this,e)}}const l=new s.Z("mds-user-deserializer");class MdsUserDeserializer{constructor(){this.validate=e=>{if(!e)return!1;const t=["id","email"].filter((t=>!(t in e))),n=0===t.length;return n||l.debug("OrgUserMetadata invalid:",{missingFields:t}),n}}deserialize(e){return e&&this.validate(e)?new OrgUser(e):(l.debug("Deserialized invalid OrgUserMetadata from MDS",e),null)}}var c=n(11820);const d=new s.Z("users-store");class MdsUserStore extends r.u{constructor(e){super(e),this.deserializer=new MdsUserDeserializer}static getEnabledPolicies(e){return(null==e?void 0:e.filter((e=>e.enabled||e.options&&e.options.length>0)).map((e=>e.name)))||[]}async fetchAccessForUser(e=""){const t=this.getViewId();return this.query(c.GetCurrentUserModelAccess,{modelId:t,userId:e}).then((t=>{const n=(0,o.q)(t,"data.model.policies"),i=MdsUserStore.getEnabledPolicies(n),s=(0,o.q)(t,"data.model.users.results");let r;return s&&Array.isArray(s)&&1===s.length?r=s[0].modelAccess:(d.debug(`fetchModelAccess failed for ${e}`),r=a.x.PUBLIC),{policies:i,modelAccess:r}}))}async fetchAccessForAnonymousUser(){const e=this.getViewId();return this.query(c.GetModelPolicies,{modelId:e}).then((e=>{const t=(0,o.q)(e,"data.model.policies");return{policies:MdsUserStore.getEnabledPolicies(t)}}))}async search(e,t,n){const i=this.getViewId();return this.query(c.GetUsers,{modelId:i,search:e,ids:n,emails:t}).then((e=>{const t=(0,o.q)(e,"data.model.users.results");if(!t||!Array.isArray(t))return[];const n=[];for(const e of t){const t=this.deserializer.deserialize(e);t&&n.push(t)}return n}))}}var u=n(10969),h=n(59114),p=n(76223);class Users extends i.Y{constructor(){super(...arguments),this.name="users-module",this.onUserMentionSearch=async e=>{const t=await this.store.search(e.search);this.userData.loadKnownUsers(t)},this.resolveUserMentions=async e=>{if(0===e.userMentions.length)return void this.log.debug("No user mentions to resolve");const t=[];if(e.userMentions.forEach((e=>{this.userData.getUserInfoByEmail(e.email)&&e.userStatus!==u.J.MENTIONED||t.push(e)})),t.length>0){const e=t.map((e=>e.email));return this.searchUsers(new Set(e),u.J.MENTIONED)}},this.inviteUsers=async e=>{const{emails:t,modelAccess:n,message:i,noteId:s}=e;if(0===t.length)return;const{baseUrl:r,modelId:o,queue:a}=this.config,l=`${r}/api/v2/shares/`,c={object_type:"model",object_id:o,role:n,inviter_message:i,note:s},d=new Set;return await Promise.all(e.emails.map((e=>a.post(l,{responseType:"json",body:Object.assign(Object.assign({},c),{email:e})}).then((e=>{const t=e.user;this.userData.loadKnownUser({id:t.sid,email:t.email,firstName:t.first_name,lastName:t.last_name,modelAccess:e.role})})).catch((()=>{this.log.debug(`User Invite failed: ${e}`),d.add(e)}))))),d.size>0?this.searchUsers(d,u.J.FAILED):void 0}}async init(e,t){this.config=e,this.store=new MdsUserStore({readonly:!0,baseUrl:e.baseUrl,viewId:e.modelId});const n=e.api.user;let i=a.x.PUBLIC,s=[],r=!1;if(n.loggedIn&&n.id){const t=await this.store.fetchAccessForUser(n.id);i=t.modelAccess,s=t.policies,e.organizationId&&(r=n.isOrganizationAdmin(e.organizationId))}else{s=(await this.store.fetchAccessForAnonymousUser()).policies}this.userData=new h.m({id:n.id,firstName:n.firstName,lastName:n.lastName,email:n.email,modelAccess:i},n.loggedIn,r,s),this.bindings.push(t.commandBinder.addBinding(p.V1,this.onUserMentionSearch),t.commandBinder.addBinding(p.Vu,this.resolveUserMentions),t.commandBinder.addBinding(p.JB,this.inviteUsers)),t.market.register(this,h.m,this.userData)}getUserData(){return this.userData}async searchUsers(e,t){const n=Array.from(e),i=await this.store.search(void 0,n);this.userData.loadSearchResults(i,n,t)}isPolicyFlagEnabled(e){return this.userData.isPolicyFlagEnabled(e)}}var m=n(48342),f=n(92310);const g=Users},48342:(e,t,n)=>{"use strict";n.d(t,{_:()=>a,Q:()=>l});var i=n(89142),s=n(10969),r=n(94170);const o=["#d44441","#f44336","#e91e63","#f78da7","#9c4b92","#673ab7","#5c7fff","#03a9f4","#417505","#00bcd4","#51a868","#37d67a","#cddc39","#fbcd00","#ffac17","#ff6900","#abb8c3","#607d8b"];function a(e){const t=o.length;return o[(0,i.Wm)(e||"",t)]}function l(e){return{email:e,id:"",firstName:"",lastName:"",name:"Unknown",initials:"?",color:a(e),userStatus:s.J.UNKNOWN,modelAccess:r.x.PUBLIC}}},12622:(e,t,n)=>{"use strict";n.d(t,{BD:()=>i,g:()=>a,KP:()=>l,ty:()=>c,_i:()=>ChangeViewmodeCommand});var i,s=n(93037),r=n(22878),o=n(14832);!function(e){e.INSIDE="mode.inside",e.OUTSIDE="mode.outside",e.DOLLHOUSE="mode.dollhouse",e.FLOORPLAN="mode.floorplan",e.TRANSITIONING="mode.transitioning",e.ORTHOGRAPHIC="mode.orthographic",e.MESH="mode.mesh"}(i||(i={}));const a=i.INSIDE,l=(i.INSIDE,r.Ey.Panorama,i.DOLLHOUSE,r.Ey.Dollhouse,i.FLOORPLAN,r.Ey.Floorplan,i.TRANSITIONING,r.Ey.Transition,i.OUTSIDE,r.Ey.Outdoor,i.ORTHOGRAPHIC,r.Ey.Orthographic,i.MESH,r.Ey.Mesh,{[r.Ey.Panorama]:i.INSIDE,[r.Ey.Dollhouse]:i.DOLLHOUSE,[r.Ey.Floorplan]:i.FLOORPLAN,[r.Ey.Transition]:i.TRANSITIONING,[r.Ey.Outdoor]:i.OUTSIDE,[r.Ey.Orthographic]:i.ORTHOGRAPHIC,[r.Ey.Mesh]:i.MESH}),c=e=>{const t=l[e];return void 0!==t?t:i.OUTSIDE};class ChangeViewmodeCommand extends s.m{constructor(e,t=o.n.Interpolate,n={}){super(),this.payload={mode:e,transitionType:t,pose:n}}}ChangeViewmodeCommand.id="CHANGE_VIEWMODE"},63316:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ViewmodeChange});var i=n(8428),s=n(57227),r=n(12622),o=n(98370),a=n(61903),l=n(22878),c=n(14832),d=n(39808),u=n(77280),h=n(2212),p=n(26517),m=n(53549),f=n(78720),g=n(99931),v=n(15099),y=n(48730),b=n(9986),S=n(41907),E=n(37363),T=n(56396),w=n(56044),x=n(14877);class ViewmodeChange extends s.Y{constructor(){super(...arguments),this.name="viewmode-change",this.dhDisabled=()=>!1,this.fpDisabled=()=>!1}async init(e,t){this.engine=t,this.viewmodesModule=await t.getModule(o.default),this.bindings.push(t.subscribe(S.bS,(e=>this.setEnabledModes(e.application))),t.commandBinder.addBinding(r._i,this.onChangeViewmodeCommand.bind(this))),Promise.all([t.market.waitForData(b.pu),t.market.waitForData(a.e)]).then((([e,t])=>{this.settings=t,this.setEnabledModes(e.application)}))}async setEnabledModes(e){if(e===b.Mx.SHOWCASE){if(this.dhDisabled=()=>this.settings.checkUrlParam("dh",0,1)||!this.settings.tryGetProperty(i.gx.Dollhouse,!1),this.fpDisabled=()=>this.settings.checkUrlParam("fp",0,1)||!this.settings.tryGetProperty(i.gx.FloorPlan,!1),!this.previousApp)return;const e=(await this.engine.market.waitForData(E.O)).currentMode;if(e===l.Ey.Dollhouse&&this.dhDisabled()||e===l.Ey.Floorplan&&this.fpDisabled()){const e=(await this.engine.market.waitForData(T.O)).pose;if(e&&(0,l.Bw)(e.mode))this.goToInsideMode(c.n.Interpolate,{position:e.camera.position},e.mode);else{const e=(await this.engine.market.waitForData(v.M_)).pose,t=(await this.engine.market.waitForData(m.Z)).getClosestSweep(e.position,!0),n=t?{position:t.position}:void 0;this.goToInsideMode(c.n.Interpolate,n,l.Ey.Panorama)}}}else e===b.Mx.WORKSHOP&&(this.dhDisabled=()=>!1,this.fpDisabled=()=>!1);this.previousApp=e}async onChangeViewmodeCommand(e){switch(e.mode){case r.BD.INSIDE:return this.goToInsideMode(e.transitionType,e.pose,l.Ey.Panorama);case r.BD.DOLLHOUSE:return this.goToDollhouse(e.transitionType,e.pose);case r.BD.FLOORPLAN:return this.goToFloorplan(e.transitionType,e.pose);case r.BD.ORTHOGRAPHIC:return this.goToOrthographic(e.transitionType,e.pose);case r.BD.MESH:return this.goToInsideMode(e.transitionType,e.pose,l.Ey.Mesh)}return Promise.reject(`viewmode-change => Could not move to ${e.mode}`)}async goToInsideMode(e=c.n.Interpolate,t={},n){const i=this.engine.market.tryGetData(m.Z);if(!i)return Promise.reject("Cannot go to inside mode");if(!(0,l.Bw)(n))return Promise.reject("Unsupport mode!");let s=t.sweepID||i.currentSweep;if(s||(s=await this.getLookAtSweep(i)),i.isSweepUnaligned(s)){const e=i.getFirstAlignedSweep();s=e?e.id:this.getFirstSweepId(i)}return(0,l.Bw)(this.viewmodesModule.currentMode)&&i.isSweepUnaligned(i.currentSweep)?this.engine.commandBinder.issueCommand(new y.ju({sweep:s,rotation:t.rotation,transition:c.n.FadeToBlack})):this.viewmodesModule.switchToMode(n,e,{sweepID:s,rotation:t.rotation},o.DEFAULT_TRANSITION_TIME)}async getLookAtSweep(e){const t=this.engine.market.tryGetData(v.M_);if(!t)return this.getFirstSweepId(e);const n=this.engine.market.tryGetData(w.c),i=(null==n?void 0:n.getFloorMin())||this.getModelMinHeight(),s=new h.Plane(u.f.DOWN,i),r=(0,p.Fe)(t.pose.position,t.pose.rotation,s);if(!r)return this.getFirstSweepId(e);const o=[f._T(),f._k(),e=>!n||n.isCurrentOrAllFloors(e.floorId)],a=[g.l0(r)],l=e.sortByScore(o,a).shift();if(l)return l.sweep.id;const c=e.getClosestSweep(r,!0);return c?c.id:this.getFirstSweepId(e)}getFirstSweepId(e){const t=e.getFirstSweep();if(void 0===t)throw new Error("First enabled sweep not found");return t.id}getModelMinHeight(){return this.meshData||(this.meshData=this.engine.market.tryGetData(d._)),this.meshData?this.meshData.extendedBounds.min.y:0}async goToDollhouse(e=c.n.Interpolate,t={}){return this.dhDisabled()?Promise.reject("Cannot go to dollhouse mode"):this.viewmodesModule.switchToMode(l.Ey.Dollhouse,e,t)}async goToFloorplan(e=c.n.Interpolate,t={}){if(this.fpDisabled())return Promise.reject("Cannot go to floorplan mode");const n=await this.engine.getModuleBySymbol(x.y.CANVAS);return n&&await n.getTransitionPromise(),this.viewmodesModule.switchToMode(l.Ey.Floorplan,e,t)}async goToOrthographic(e=c.n.Interpolate,t={}){const n=await this.engine.getModuleBySymbol(x.y.CANVAS);return n&&await n.getTransitionPromise(),this.viewmodesModule.switchToMode(l.Ey.Orthographic,e,t)}}},39468:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i="features/dollhouse-nudge"},13088:(e,t,n)=>{"use strict";n.d(t,{M:()=>LockViewmodeCommand,I:()=>UnlockViewmodeCommand});var i=n(93037);class LockViewmodeCommand extends i.m{constructor(){super()}}LockViewmodeCommand.id="LOCK_VIEWMODE";class UnlockViewmodeCommand extends i.m{constructor(){super()}}UnlockViewmodeCommand.id="UNLOCK_VIEWMODE"},92214:(e,t,n)=>{"use strict";n.d(t,{Z:()=>BeginSwitchViewmodeMessage});var i=n(46978);class BeginSwitchViewmodeMessage extends i.a{}},50084:(e,t,n)=>{"use strict";n.d(t,{Z:()=>EndSwitchViewmodeMessage});var i=n(46978);class EndSwitchViewmodeMessage extends i.a{}},46978:(e,t,n)=>{"use strict";n.d(t,{a:()=>SwitchViewmodeMessage});var i=n(4117);class SwitchViewmodeMessage extends i.v{constructor(e,t){super(),this.fromMode=t,this.toMode=e,this.timestamp=Date.now()}}},22878:(e,t,n)=>{"use strict";var i;n.d(t,{Ey:()=>i,Ae:()=>s,Bw:()=>r,vl:()=>o}),function(e){e[e.Panorama=1]="Panorama",e[e.Dollhouse=2]="Dollhouse",e[e.Floorplan=3]="Floorplan",e[e.Outdoor=4]="Outdoor",e[e.Orthographic=5]="Orthographic",e[e.Mesh=6]="Mesh",e[e.Transition=-1]="Transition"}(i||(i={}));const s=e=>{switch(e){case i.Panorama:return"Panorama";case i.Floorplan:return"Floorplan";case i.Dollhouse:return"Dollhouse";case i.Transition:return"Transition";case i.Orthographic:return"Orthographic";case i.Mesh:return"Mesh"}return"Unknown"};function r(e){return e===i.Panorama||e===i.Mesh}function o(e){return e===i.Panorama}},37363:(e,t,n)=>{"use strict";n.d(t,{O:()=>ViewmodeData});var i=n(35424),s=n(22878),r=n(67779);class ViewmodeData extends i.V{constructor(){super(),this.name="viewmode",this.viewmodeChangeEnabled=!0,this.currentModeObservable=(0,r.Y)(null),this.transition={active:!1,progress:0,from:null,to:null,startTime:0,transitionTime:0},this.isPano=this.isPano.bind(this),this.isFloorplan=this.isFloorplan.bind(this),this.isInside=this.isInside.bind(this),this.isDollhouse=this.isDollhouse.bind(this),this.isOrthographic=this.isOrthographic.bind(this)}get currentMode(){return this.currentModeObservable.value}set currentMode(e){e!==this.currentModeObservable.value&&(this.currentModeObservable.value=e)}get closestMode(){return this.currentMode===s.Ey.Transition?this.transition.progress<.5?this.transition.from:this.transition.to:this.currentMode}makeModeChangeSubscription(e){return this.currentModeObservable.onChanged(e)}activateTransition(e,t,n){this.transition.active=!0,this.transition.progress=0,this.transition.startTime=Date.now(),this.transition.transitionTime=n,this.transition.to=t,this.transition.from=e}deactivateTransition(){this.transition.active=!1}isPano(){return this.currentMode===s.Ey.Panorama}isInside(){return(0,s.Bw)(this.currentMode)}isMesh(){return this.currentMode===s.Ey.Mesh}isFloorplan(){return this.currentMode===s.Ey.Floorplan}isDollhouse(){return this.currentMode===s.Ey.Dollhouse}isOrthographic(){return this.currentMode===s.Ey.Orthographic}canStartTransition(){const e=this.transition.active,t=this.currentMode===s.Ey.Transition;return!e&&!t}transitionActive(){return!this.canStartTransition()}isAlreadyInMode(e){const t=this.transition.from===this.transition.to,n=this.currentMode===e;return this.transition.active&&t||n}canSwitchViewMode(e){return this.canStartTransition()&&this.viewmodeChangeEnabled&&!this.isAlreadyInMode(e)}}},98370:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_TRANSITION_TIME:()=>M,default:()=>ViewmodeModule});var i=n(14877),s=n(22878),r=n(14832),o=n(2212),a=n(77280),l=n(41674),c=n(57227),d=n(37363),u=n(15099),h=n(31998),p=n(53549),m=n(50084),f=n(92214),g=n(46978),v=n(40603);class ViewmodeActiveTransitionError extends v.y{constructor(e="Tried to start view-mode transition while another transition was active"){super(e),this.name="ViewmodeActiveTransition"}}class ViewmodeChangeLockedError extends v.y{constructor(e="Cannot change viewmode when locked"){super(e),this.name="ViewmodeChangeLockedError"}}var y=n(26517);var b=n(82722),S=n(95703),E=n(65270);const T={rotationDuration:1,rotationDelay:0,matrixDelay:0,matrixDuration:.5},w={[s.Ey.Dollhouse]:{matrixDelay:.5,matrixDuration:1},[s.Ey.Panorama]:{rotationDuration:.5}};var x=n(39808),_=n(13088);const M=1e3,O=Math.PI/2+Number.EPSILON,A=Math.PI-Number.EPSILON,C={[s.Ey.Panorama]:M,[s.Ey.Dollhouse]:M,[s.Ey.Floorplan]:M,[s.Ey.Orthographic]:M};class ViewmodeModule extends c.Y{constructor(){super(...arguments),this.viewmodeData=new d.O,this.name="viewmode",this.minDollhouseDistance=15,this.maxDollhouseDistance=50,this._orthoMatrix=new S.M,this.getFlyinStartPose=(e,t)=>{const n=t||this.cameraData.pose.position,i=e.position.y-n.y,s=(0,y.Ll)(e.position,n,this.meshData.meshCenter),r=a.f.FORWARD.clone().applyQuaternion(s);return{position:(0,y.D7)(e.position,n,Math.sign(r.y)*Math.PI/4,!0).setY(1.5*i)}},this.getFlyinEndPose=e=>{const t=e.position||this.sweepData.getSweep(e.sweepID).position,n=e.rotation||new o.Quaternion,i=Math.PI/180*l.oR.fov;return(0,y.YN)(t,n,-Math.PI/6,this.meshData.meshBounds,i,this.canvas.aspectRatio)}}async init(e,t){var n;this.engine=t,this.market=t.market,this.viewmodeData.currentMode=null!==(n=e.startingMode)&&void 0!==n?n:s.Ey.Dollhouse,this.market.register(this,d.O,this.viewmodeData),t.market.waitForData(x._).then((e=>{this.meshData=e,this.setDollhouseBounds()})),this.bindings.push(t.commandBinder.addBinding(_.M,this.lockViewmode.bind(this)),t.commandBinder.addBinding(_.I,this.unlockViewmode.bind(this)));const[r,o,a,l,c]=await Promise.all([t.getModuleBySymbol(i.y.CAMERA),t.getModule(h.default),t.market.waitForData(p.Z),t.market.waitForData(b.W),t.market.waitForData(u.M_)]);this.cameraModule=r,this.sweepModule=o,this.sweepData=a,this.canvas=l,this.cameraData=c}lockViewmode(){this.viewmodeData.viewmodeChangeEnabled=!1,this.viewmodeData.commit()}unlockViewmode(){this.viewmodeData.viewmodeChangeEnabled=!0,this.viewmodeData.commit()}get currentMode(){return this.viewmodeData.currentMode}async switchToMode(e,t=r.n.FadeToBlack,n,o){if(this.log.info(`switchToMode mode:${e} type:${t}`),this.meshData||e!==s.Ey.Floorplan&&e!==s.Ey.Dollhouse||await this.engine.getModuleBySymbol(i.y.MODEL_MESH),t===r.n.Instant&&(o=0),o=void 0!==o?o:C[e],!this.viewmodeData.canStartTransition()||!this.cameraData.canTransition())throw new ViewmodeActiveTransitionError;if(e!==this.currentMode&&!this.viewmodeData.viewmodeChangeEnabled)throw new ViewmodeChangeLockedError;const a=this.isAlreadyInMode(this.viewmodeData,e),l=n&&!ViewmodeModule.willPoseChange(this.cameraData,n);if(a&&l)return Promise.resolve();this.sweepData.currentSweep&&this.sweepData.isSweepUnaligned(this.sweepData.currentSweep)&&!(0,s.Bw)(e)&&(t=r.n.FadeToBlack);const c=null!==this.viewmodeData.currentMode?this.viewmodeData.currentMode:void 0;this.viewmodeData.activateTransition(this.viewmodeData.currentMode,e,o),this.viewmodeData.currentMode=s.Ey.Transition,this.viewmodeData.commit(),this.engine.broadcast(new f.Z(e,c));const d=this.moveCameraToViewmode(e,c,t,o,n);let u=!1;return d.progress((t=>{this.viewmodeData.transition.progress=t,this.viewmodeData.commit(),t>=.5&&!u&&(u=!0,this.engine.broadcast(new g.a(e,c)))})),d.then((()=>{this.viewmodeData.transition.progress=1,this.viewmodeData.currentMode=e,this.viewmodeData.deactivateTransition(),this.viewmodeData.commit(),this.engine.broadcast(new m.Z(e,c))})),d.nativePromise()}isAlreadyInMode(e,t){const n=e.transition.from===e.transition.to,i=e.currentMode===t;return e.transition.active&&n||i}static willPoseChange(e,t){return void 0!==t.position&&!e.pose.position.equals(t.position)||void 0!==t.rotation&&!e.pose.rotation.equals(t.rotation)||void 0!==t.zoom&&e.zoom()!==t.zoom}moveCameraToViewmode(e,t,n,i,r){switch(e){case s.Ey.Mesh:case s.Ey.Panorama:return this.moveCameraToPanorama(n,i,r);case s.Ey.Dollhouse:return this.moveCameraToDollhouse(t,n,i,r);case s.Ey.Floorplan:return this.moveCameraToFloorplan(t,n,i,r);case s.Ey.Orthographic:return this.moveCameraToOrthographic(t,n,i,r);default:throw Error(`moveCameraToViewmode(): Invalid view-mode to go to: ${e}`)}}moveCameraToPanorama(e,t,n){if(this.sweepData.canTransition()||this.cameraData.canTransition()){let i;if(n&&n.sweepID)i=n.sweepID;else{const e=this.sweepData.getFirstSweep();i=this.sweepData.currentSweep,!i&&e&&(i=e.id)}if(!i)throw new Error("moveCameraToPanorama(): Invalid target sweep!");this.sweepData.isSweepUnaligned(i)&&(e=r.n.FadeToBlack);let l=n&&n.rotation?n.rotation:void 0;if(!l){const e=(this.viewmodeData.transition.from===s.Ey.Floorplan?a.f.UP:a.f.FORWARD).clone().applyQuaternion(this.cameraData.pose.rotation).setY(0).normalize();l=(new o.Quaternion).setFromUnitVectors(a.f.FORWARD,e)}return this.sweepModule.moveToSweep({transitionType:e,sweepId:i,rotation:l,transitionTime:t,rotationDelay:.5})}throw new Error("Could not move to panorama mode because another transition was active")}moveCameraToDollhouse(e,t,n,i){const r=this.meshData.meshBounds,c={};let d;if(i&&(i.position||i.rotation)){if(i.position&&i.rotation){c.position=i.position,c.rotation=i.rotation;const e=new o.Plane(a.f.UP.clone(),this.meshData.meshCenter.y);let t=(0,y.Fe)(c.position,c.rotation,e);t||(t=new o.Vector3,t.copy(this.meshData.meshCenter)),r.containsPoint(t)&&(d=c.position.distanceTo(t))}else if(i.position)c.position=i.position,c.rotation=(0,y.n0)(i.position,this.meshData.meshCenter);else{c.rotation=i.rotation;const e=r.min.distanceTo(r.max);c.position=(0,y.fd)(c.rotation,this.meshData.meshCenter,e)}d||(d=this.meshData.meshCenter.clone().distanceTo(c.position))}else{let e,t;const n=this.sweepData.isSweepUnaligned(this.sweepData.currentSweep),i=n||this.viewmodeData.transition.from===s.Ey.Floorplan?this.meshData.meshCenter:this.cameraData.pose.position;if(n)t=new o.Vector3(0,0,0),e=new o.Vector3(15,10,15);else if(this.viewmodeData.transition.from!==s.Ey.Floorplan){const n=1.5,s=(0,y.YN)(this.cameraData.pose.position,this.cameraData.pose.rotation,-Math.PI/6,r,this.cameraData.fovY()*n,this.cameraData.pose.aspect()),l=((e,t)=>{const n=e.clone().add(new o.Vector3(0,6,0)),i=a.f.FORWARD.clone().applyQuaternion(t);return i.y>=.01&&(i.y=.01),{position:n.clone().add(i.clone().multiplyScalar(-10)),direction:i}})(i,this.cameraData.pose.rotation);[e,t]=[s.position,l.direction]}else{const n=((e,t)=>{const n=e.clone(),i=a.f.DOWN.clone().applyQuaternion(t).multiplyScalar(6),s=n.clone().add(i).setY(6),r=a.f.UP.clone().applyQuaternion(t);return r.setY(-.5).normalize(),{position:s,direction:r}})(i,this.cameraData.pose.rotation);[e,t]=[n.position,n.direction]}const l=i.clone().add(t).setY(this.meshData.meshCenter.y);c.position=(0,y.r0)(e,l,this.minDollhouseDistance,this.maxDollhouseDistance),c.position=(0,y.m$)(c.position,l,O,A),c.rotation=(0,y.n0)(c.position,l),d=l.distanceTo(c.position)}return this.cameraModule.moveTo({transitionType:t,pose:c,transitionTime:n,projection:(0,l.AN)(this.cameraData.aspect()),focalDistance:d,rotationDuration:.5})}setDollhouseBounds(){const e=this.meshData.extendedBounds,t=e.min.distanceTo(e.max);this.minDollhouseDistance=Math.min(t/2,this.minDollhouseDistance),this.maxDollhouseDistance=Math.max(t,this.maxDollhouseDistance)}moveCameraToFloorplan(e,t,n,i){const s={},r=this.meshData.meshCenter,c=this.meshData.meshSize,d=Math.max(c.x,c.z),u=this.canvas.aspectRatio,h=this.getDefaultFloorplanZoom(this.meshData.meshSize),p=i&&i.zoom?this.canvas.height/(2*i.zoom):h,m=(0,l.aH)(this.canvas.width,this.canvas.height,p),f=this.getDefaultFloorplanZoom(this.meshData.extendedSize),g=(0,l.aH)(this.canvas.width,this.canvas.height,f);if(this.cameraModule.setBaseProjection(g),i&&i.position)s.position=i.position;else{const e=a.f.UP.clone().multiplyScalar(d);s.position=r.clone().add(e)}if(i&&i.rotation)s.rotation=i.rotation;else{const e=(new S.M).setPosition(s.position);e.lookAt(s.position,r,a.f.FORWARD),s.rotation=(new o.Quaternion).setFromRotationMatrix(e.asThreeMatrix4());if(u<1!==c.x/c.z<1){const e=(new o.Quaternion).setFromUnitVectors(a.f.UP,a.f.LEFT);s.rotation.multiply(e)}}const v=s.position.y-this.meshData.meshCenter.y;let y=Object.assign(Object.assign({},T),{easing:E.hl,transitionType:t,pose:s,transitionTime:n,projection:m,focalDistance:v});return e&&e in w&&(y=Object.assign(Object.assign({},w[e]),y)),this.cameraModule.moveTo(y)}moveCameraToOrthographic(e,t,n,i){const s=i&&i.zoom?i.zoom:this.getDefaultFloorplanZoom(this.meshData.extendedSize),r=(0,l.aH)(this.canvas.width,this.canvas.height,s,this._orthoMatrix);this.cameraModule.setBaseProjection(r);const o={easing:E.hl,transitionType:t,pose:i||{},transitionTime:n,projection:r,focalDistance:2};return this.cameraModule.moveTo(o)}getDefaultFloorplanZoom(e){const t=Math.max(e.x,e.z),n=Math.min(e.x,e.z),i=this.canvas.aspectRatio,s=Math.max(t,n/i),r=Math.max(n,t/i),o=i<1?s:r;return this.canvas.height/(1.2*o)}}},66524:(e,t,n)=>{"use strict";function i(e){try{const t=e.getExtension("WEBGL_debug_renderer_info");if(t)return{vendor:e.getParameter(t.UNMASKED_VENDOR_WEBGL),renderer:e.getParameter(t.UNMASKED_RENDERER_WEBGL)}}catch(e){}return{vendor:"Unknown",renderer:"Unknown"}}function s(e){return/Apple A(9|1\d)/.test(e.renderer)||/Adreno \(TM\) (512|530|540|[6-9]\d\d)/.test(e.renderer)||/Mali-G(7[1-9]|[8-9]\d)/.test(e.renderer)}n.d(t,{t:()=>i,W:()=>s})},83804:(e,t,n)=>{"use strict";n.d(t,{a:()=>i,Z:()=>WebGLScene});var i,s=n(2212),r=n(41674),o=n(33299);class CameraRig extends s.Object3D{constructor(e){super(),this.anchor=this,this.update=e=>{this.anchor.position.copy(e.position),this.camera.quaternion.copy(e.rotation),this.camera.projectionMatrix.copy(e.projection.asThreeMatrix4()),this.camera.projectionMatrixInverse.copy(e.projection.asThreeMatrix4()),this.camera.projectionMatrixInverse.invert(),this.updateMatrixWorld(!0)},this.camera=new s.PerspectiveCamera(r.oR.fov,e,r.oR.near,r.oR.far),this.add(this.camera),this.camera.layers.mask=o.o.ALL.mask,this.name="CameraRig"}dispose(){this.remove(this.camera)}}!function(e){e[e.Root=0]="Root",e[e.CameraRig=1]="CameraRig"}(i||(i={}));class WebGLScene{constructor(e,t,n,r){this.scene=e,this.threeRenderer=t,this.cameraData=n,this.useEffectComposer=r,this.ids=i,this.rendering=!1,this.composer=null,this.cameraRigStale=!0,this.canvasSizeChanged=!0,this.updateComposer=(()=>{const e=new s.Vector2;return()=>{this.canvasSizeChanged&&this.composer&&(this.composer.setPixelRatio(this.composer.renderer.getPixelRatio()),this.composer.renderer.getSize(e),this.composer.setSize(e.x,e.y),this.canvasSizeChanged=!1)}})()}add(...e){for(const t of e)this.addChild(i.Root,t)}remove(...e){for(const t of e)this.removeChild(i.Root,t)}addChild(e,t){switch(e){case i.Root:this.scene.add(t);break;case i.CameraRig:this.cameraRig.add(t);break;default:return!1}return!0}removeChild(e,t){switch(e){case i.Root:this.scene.remove(t);break;case i.CameraRig:this.cameraRig.remove(t);break;default:return!1}return!0}get camera(){return this.updateCameraRig(),this.cameraRig.camera}get effectComposer(){return this.composer}init(){this.cameraRig=new CameraRig(this.cameraData.aspect()),this.useEffectComposer&&Promise.all([n.e(525).then(n.bind(n,32903)),n.e(525).then(n.bind(n,86426))]).then((([e,t])=>{this.composer=new e.EffectComposer(this.threeRenderer),this.composer.addPass(new t.RenderPass(this.scene,this.cameraRig.camera)),this.cameraRigStale=!0})),this.cameraRigStale=!0}dispose(){this.cameraRig.dispose()}startRender(e){this.rendering=e}activate(e){this.scene.add(this.cameraRig),this.cameraDataCallback=()=>this.cameraRigStale=!0,this.cameraData.pose.onChanged(this.cameraDataCallback)}deactivate(e){this.scene.remove(this.cameraRig),this.cameraData.pose.removeOnChanged(this.cameraDataCallback)}beforeRender(){this.updateCameraRig(),this.updateComposer()}updateCameraRig(){this.cameraRigStale&&(this.cameraRig.update(this.cameraData.pose),this.cameraRigStale=!1)}render(e){this.rendering&&(this.composer?this.composer.render(e):(this.threeRenderer.clear(),this.threeRenderer.render(this.scene,this.cameraRig.camera)))}setCameraDirty(){this.cameraRigStale=!0,this.cameraRig.camera.updateProjectionMatrix()}onCanvasSizeChanged(){this.canvasSizeChanged=!0}}},49807:(e,t,n)=>{"use strict";n.d(t,{b:()=>GetScreenPositionCommand});var i=n(93037);class GetScreenPositionCommand extends i.m{constructor(e){super(),this.payload=Object.assign({},e)}}},47725:(e,t,n)=>{"use strict";n.d(t,{v:()=>WebGLSupportException,G:()=>RendererCreationException});var i=n(40603);class WebGLSupportException extends i.y{constructor(e){super(e)}}class RendererCreationException extends i.y{constructor(e){super(e)}}},16056:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MAX_RESOLUTION:()=>M,default:()=>WebGLRendererModule});var i=n(57227),s=n(82722),r=n(83804),o=n(2212);const a={basicTextured:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:n(64656),fragmentShader:n(87686)},screenSpaceColored:{uniforms:{color:{type:"v3",value:new o.Vector3(0,0,0)},opacity:{type:"f",value:1}},vertexShader:n(79933),fragmentShader:n(60348)}};var l=n(47725),c=n(66524),d=n(95891);const u=(e,t)=>{switch(e){case d.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_X:t.set(0,-Math.PI/2,0);break;case d.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:t.set(0,Math.PI/2,0);break;case d.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:t.set(Math.PI/2,Math.PI,0);break;case d.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:t.set(-Math.PI/2,Math.PI,0);break;case d.Z.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:t.set(0,-Math.PI,0);break;case d.Z.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:t.set(0,0,0)}},h={copyCubeMap:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:n(49125),fragmentShader:n(30202)}};var p=n(81674);const m={0:[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0],1:[0,0,0,0,0,0,0,3e-6,229e-6,.005977,.060598,.24173,.382925,.24173,.060598,.005977,229e-6,3e-6,0,0,0,0,0,0,0],2:[0,0,1e-6,1e-5,78e-6,489e-6,.002403,.009245,.027835,.065591,.120978,.174666,.197413,.174666,.120978,.065591,.027835,.009245,.002403,489e-6,78e-6,1e-5,1e-6,0,0],3:[48e-6,169e-6,538e-6,.001532,.003907,.008921,.018247,.033432,.054867,.080658,.106212,.125283,.132372,.125283,.106212,.080658,.054867,.033432,.018247,.008921,.003907,.001532,538e-6,169e-6,48e-6],4:[.001133,.002316,.00445,.008033,.013627,.021724,.032542,.04581,.0606,.075333,.088001,.096603,.099654,.096603,.088001,.075333,.0606,.04581,.032542,.021724,.013627,.008033,.00445,.002316,.001133],5:[.004571,.00723,.010989,.016048,.022521,.03037,.039354,.049003,.058632,.067411,.074476,.079066,.080657,.079066,.074476,.067411,.058632,.049003,.039354,.03037,.022521,.016048,.010989,.00723,.004571],6:[.009379,.012899,.017256,.022453,.028417,.034983,.041888,.048784,.055264,.060893,.065262,.068032,.068981,.068032,.065262,.060893,.055264,.048784,.041888,.034983,.028417,.022453,.017256,.012899,.009379],7:[.014185,.01793,.022207,.02695,.032045,.037335,.042622,.047676,.052254,.056116,.059048,.06088,.061504,.06088,.059048,.056116,.052254,.047676,.042622,.037335,.032045,.02695,.022207,.01793,.014185]};class CWFWebGLRenderer{constructor(e){this.threeRenderer=e,this.cachedSize=new o.Vector2,this.renderToCubeMap=(()=>{let e,t,n,i,s,r=!1;const l=.5;return(c,d,u,h,p,m,f,g,v,y,b,S,E,T,w,x)=>{if(this.contextLost)return;r||(t=new o.OrthographicCamera(-.5,l,l,-.5,-200,200),t.position.z=150,e=new o.Scene,e.name="rttCube",e.add(t),n=new o.RawShaderMaterial({uniforms:{tDiffuse:{value:null},alpha:{value:1}},vertexShader:a.basicTextured.vertexShader,fragmentShader:a.basicTextured.fragmentShader,depthWrite:!1,depthTest:!1,side:o.DoubleSide}),i=new o.PlaneBufferGeometry(1,1),s=new o.Mesh(i,n),s.position.z=0,e.add(s),r=!0);const _=i.getAttribute("uv");_.setUsage(o.DynamicDrawUsage),_.needsUpdate=!0;const M=_.array,O=p/u,A=m/h,C=f/u,N=g/h;M[0]=O,M[1]=A+N,M[2]=O+C,M[3]=A+N,M[4]=O,M[5]=A,M[6]=O+C,M[7]=A;const D=i.getAttribute("position");D.setUsage(o.DynamicDrawUsage),D.needsUpdate=!0;const I=D.array,L=v/d.width-l,P=y/d.height-l,R=b/d.width,k=S/d.height;I[0]=L,I[1]=P+k,I[3]=L+R,I[4]=P+k,I[6]=L,I[7]=P,I[9]=L+R,I[10]=P,n.uniforms.tDiffuse.value=c,n.blending=T||o.NoBlending,n.transparent=!!w,null==x&&(x=1),n.uniforms.alpha.value=x,d.viewport.set(0,0,d.width,d.height);const U=this.threeRenderer.getRenderTarget(),B=this.threeRenderer.autoClear,F=this.threeRenderer.xr.enabled;this.threeRenderer.xr.enabled=!1,this.threeRenderer.autoClear=!1,this.threeRenderer.setRenderTarget(d,E),this.threeRenderer.render(e,t),this.threeRenderer.setRenderTarget(U),this.threeRenderer.autoClear=B,this.threeRenderer.xr.enabled=F}})(),this.copyCubemap=(()=>{let e,t,n,i,s,r=!1;const a=new o.Euler,l=this;return(c,d,p,m,f)=>{if(this.contextLost)return;if(!r){const a=2,l=a/2;t=new o.OrthographicCamera(-l,l,l,-l,0,200),t.position.set(0,0,0),e=new o.Scene,e.name="copyCube",e.add(t),n=new o.RawShaderMaterial({uniforms:{tDiffuse:{value:null},alpha:{value:1}},vertexShader:h.copyCubeMap.vertexShader,fragmentShader:h.copyCubeMap.fragmentShader,depthWrite:!1,depthTest:!1,side:o.DoubleSide}),i=new o.BoxGeometry(a,a,a),s=new o.Mesh(i,n),e.add(s),r=!0}const g=l.threeRenderer.getRenderTarget(),v=l.threeRenderer.autoClear,y=l.threeRenderer.xr.enabled;l.threeRenderer.xr.enabled=!1,l.threeRenderer.autoClear=!1;for(let i=0;i<6;i++)u(i,a),s.rotation.copy(a),s.matrixWorldNeedsUpdate=!0,s.updateMatrixWorld(!0),n.uniforms.tDiffuse.value=c,n.blending=p||o.NoBlending,n.transparent=!!m,null==f&&(f=1),n.uniforms.alpha.value=f,d.viewport.set(0,0,d.width,d.height),l.threeRenderer.setRenderTarget(d,i),l.threeRenderer.render(e,t);l.threeRenderer.setRenderTarget(g),l.threeRenderer.autoClear=v,l.threeRenderer.xr.enabled=y}})(),this.blurCubemap=(()=>{const e=e=>{const t=new o.WebGLCubeRenderTarget(e);return t.texture.image={},t.texture.image.width=e,t.texture.image.height=e,{renderTarget:t,cubeCamera:new o.CubeCamera(.1,1e3,t)}};class BlurCubeMesh extends o.Mesh{}const t={512:e(512)},n=new o.Scene,i=new BlurCubeMesh(new o.BoxGeometry(1,1,1));n.add(i);const s={};return(r,a,l=3,c=.005)=>{const d=a.renderTarget;t[d.width]||(t[d.width]=e(d.width)),i.material=function(e){if(!s[e]){const t=new o.RawShaderMaterial({uniforms:o.UniformsUtils.clone(p.Z.blurCube.uniforms),vertexShader:p.Z.blurCube.vertexShader,fragmentShader:p.Z.blurCube.fragmentShader,side:o.BackSide});t.defines={};const n=m[`${e}`];for(const[e,i]of n.entries())t.defines[`KERNEL_${e+1}`]=0===i||1===i?i.toFixed(1):i;s[e]=t}return s[e]}(l);const u=t[d.width];i.material.uniforms.map.value=r,i.material.uniforms.dir.value.set(c,0),u.cubeCamera.update(this.renderer,n),i.material.uniforms.map.value=u.renderTarget.texture,i.material.uniforms.dir.value.set(0,c),a.update(this.renderer,n)}})();try{const e=this.threeRenderer.getContext();this.contextLost=e.isContextLost(),this._maxCubemapSize=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this._gpuInfo=(0,c.t)(e)}catch(e){throw new l.G("Unable to create a WebGL rendering context")}}get renderer(){return this.threeRenderer}get maxCubemapSize(){return this._maxCubemapSize}get maxTextureSize(){return this._maxTextureSize}get gpuInfo(){return this._gpuInfo}getSize(){return this.threeRenderer.getSize(this.cachedSize)}getPixelRatio(){return this.threeRenderer.getPixelRatio()}dispose(){this.threeRenderer.dispose()}initSizedTexture2D(e,t){const n=new o.DataTexture(null,e,e);return t&&Object.assign(n,t),n.needsUpdate=!0,this.contextLost||this.threeRenderer.initTexture(n),n}initRenderTargetCube(e){const t=new o.WebGLCubeRenderTarget(e,{stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1});return t.texture.image={},t.texture.image.width=e,t.texture.image.height=e,t}uploadTexture2D(e,t,n,i){if(!this.contextLost){const s=new o.Texture;s.image=e,this.threeRenderer.copyTextureToTexture(new o.Vector2(n,i),s,t,0)}}fence(e){return new Promise(((t,n)=>{const i=this.contextLost?null:e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);if(null===i)return n();e.flush();const s=()=>{switch(e.getSyncParameter(i,e.SYNC_STATUS)){case e.TIMEOUT_EXPIRED:return void setTimeout(s,0);case e.WAIT_FAILED:return void n();case e.SIGNALED:return e.deleteSync(i),void t();default:return void setTimeout(s,0)}};setTimeout(s,0)}))}}var f=n(15099),g=n(20725),v=n(70446),y=n(62029),b=n(99295);class ScreenOverlayMesh extends o.Mesh{constructor(e){super(new o.PlaneBufferGeometry(2,2,1,1),new o.RawShaderMaterial({uniforms:o.UniformsUtils.clone(a.screenSpaceColored.uniforms),vertexShader:a.screenSpaceColored.vertexShader,fragmentShader:a.screenSpaceColored.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1})),this._opacity=1,this.material.uniforms.color.value=new o.Color(e),this.renderOrder=b.z.colorOverlay,this.name="ScreenOverlayMesh"}set opacity(e){this.visible=e>0,this._opacity=e,this.material.uniforms.opacity.value=e}get opacity(){return this._opacity}dispose(){this.material.dispose(),this.geometry.dispose()}}class ScreenOverlayComponent{constructor(e,t){this.scene=e,this.cameraData=t}init(){this.blackoutOverlayMesh=new ScreenOverlayMesh(0)}dispose(){this.blackoutOverlayMesh.dispose()}render(e){this.blackoutOverlayMesh.opacity=this.cameraData.transition.blackoutProgress.value}activate(e){this.scene.addChild(this.scene.ids.CameraRig,this.blackoutOverlayMesh)}deactivate(e){this.scene.removeChild(this.scene.ids.CameraRig,this.blackoutOverlayMesh)}}var S=n(7692),E=n(61903),T=n(49807),w=n(69524),x=n(14547),_=n(591);const M=3686400;class WebGLRendererModule extends i.Y{constructor(){super(...arguments),this.name="webgl-renderer",this.onContextLost=e=>{this.log.info(e),this._cwfRenderer.contextLost=!0,this.engine.broadcast(new y.zq(e)),e.preventDefault()},this.onContextRestored=e=>{var t;this.log.info(e),this._cwfRenderer.contextLost=!1,this.engine.broadcast(new y.Xq(e)),null===(t=this.canvas.parentNode)||void 0===t||t.insertBefore(this.canvas,this.canvas)},this.getPixelRatioFor=(e,t)=>{const n=window.devicePixelRatio||1;return e*t*n<=M?n:1}}async init(e,t){if(!("WebGLRenderingContext"in window))throw new l.v("WebGL not supported");let n;this.canvas=e.canvas,this.engine=t;try{const t={canvas:this.canvas,antialias:e.antialias,alpha:!0,powerPreference:"high-performance"};n=e.useWebGL2?new o.WebGLRenderer(t):new o.WebGL1Renderer(t),n.autoClear=!1,n.xr.enabled=!0}catch(e){throw new l.G("Unable to create a WebGL rendering context")}n.setOpaqueSort(this.painterSortStable),this._cwfRenderer=new CWFWebGLRenderer(n),[this.cameraData,this.settingsData]=await Promise.all([t.market.waitForData(f.M_),t.market.waitForData(E.e)]);const i=new o.Scene;i.name="main",this.scene=new r.Z(i,n,this.cameraData,e.useEffectComposer),t.addComponent(this,this.scene),t.addComponent(this,new ScreenOverlayComponent(this.scene,this.cameraData));const a=await t.market.waitForData(s.W);this.setSize(a.width,a.height),this.bindings.push(t.subscribe(g.a,(e=>this.setSize(e.width,e.height))),t.commandBinder.addBinding(T.b,(async e=>(0,S.q9)(this.cameraData,e.worldPosition).screenPosition)),new _.r(this.canvas,"webglcontextlost",this.onContextLost),new _.r(this.canvas,"webglcontextrestored",this.onContextRestored)),this.webGlMemoryTracker=n.getContext().getExtension("GMAN_webgl_memory"),this.webGlMemoryTracker||this.log.warn("Unable to find WebGL memory tracker!"),t.broadcast(new w.em(x.Y.WebGLRenderer))}get gpuInfo(){return this._cwfRenderer.gpuInfo}get maxCubemapSize(){return this._cwfRenderer.maxCubemapSize}get maxTextureSize(){return this._cwfRenderer.maxTextureSize}get maxVaryings(){return this._cwfRenderer.renderer.capabilities.maxVaryings}getScene(){return this.scene}getCamera(){return this.scene.camera}get cwfRenderer(){return this._cwfRenderer}get textureManager(){return this._cwfRenderer}get threeRenderer(){return this.cwfRenderer.renderer}async renderOnce(){return this.scene.startRender(!0),this.engine.after(v.A.Render).then((()=>this.scene.startRender(!1)))}startRender(e=!0){this.scene.startRender(e),this.engine.broadcast(new y.Vx(this.cwfRenderer.getPixelRatio()))}setSize(e,t){const n=this.getPixelRatioFor(e,t);n!==this.cwfRenderer.getPixelRatio()&&(this.log.debug(`Setting pixel ratio to ${n}`),this.engine.broadcast(new y.Vx(n))),this.threeRenderer.xr.isPresenting&&this.log.error("setting size while in xr is a no no, it resets the viewport",e,t),this.threeRenderer.setPixelRatio(n),this.threeRenderer.setSize(e,t,!1),this.scene.setCameraDirty()}supportsInstancing(){const{threeRenderer:e,settingsData:t}=this;return!t.checkUrlParam("noInstancing",1,0)&&(e.capabilities.isWebGL2||e.extensions.has("ANGLE_instanced_arrays"))}getCapabilities(){const{capabilities:e,extensions:t}=this.threeRenderer,n=e.isWebGL2;let i=!1;try{i=!!document.createElement("canvas").getContext("webgl2")}catch(e){}return{gl_v2:i,gl_max_textures:e.maxTextures,gl_max_texture_size:e.maxTextureSize,gl_max_cubemap_size:e.maxCubemapSize,gl_instancing:this.supportsInstancing(),gl_oes_texture_float:n||t.has("OES_texture_float"),gl_oes_texture_half_float:n||t.has("OES_texture_half_float"),gl_depth_texture:n||t.has("WEBGL_depth_texture"),gl_draw_buffers:n||t.has("WEBGL_draw_buffers"),gl_oes_fbo_render_mip_map:n||t.has("OES_fbo_render_mipmap"),gl_shader_texture_lod:n||t.has("EXT_shader_texture_lod"),gl_oes_vertex_array_obj:n||t.has("OES_vertex_array_object"),gl_ovr_multi_view:n&&t.has("OVR_multiview2"),gl_color_buffer_float:n&&t.has("EXT_color_buffer_float"),gl_astc_supported:t.has("WEBGL_compressed_texture_astc"),gl_etc1_supported:t.has("WEBGL_compressed_texture_etc1"),gl_etc2_supported:t.has("WEBGL_compressed_texture_etc"),gl_dxt_supported:t.has("WEBGL_compressed_texture_s3tc"),gl_bptc_supported:t.has("EXT_texture_compression_bptc"),gl_pvrtc_supported:t.has("WEBGL_compressed_texture_pvrtc")||t.has("WEBKIT_WEBGL_compressed_texture_pvrtc")}}estimatedGPUMemoryAllocated(){if(this.webGlMemoryTracker){return this.webGlMemoryTracker.getMemoryInfo().memory.total}return-1}painterSortStable(e,t){if(e.groupOrder!==t.groupOrder)return e.groupOrder-t.groupOrder;if(e.renderOrder!==t.renderOrder)return e.renderOrder-t.renderOrder;if(e.program!==t.program)return e.program.id-t.program.id;if(e.material.id!==t.material.id)return e.material.id-t.material.id;if(e.object.getSortKey&&t.object.getSortKey){const n=e.object.getSortKey()-t.object.getSortKey();if(0!==n)return n}return e.z!==t.z?e.z-t.z:e.id-t.id}}},62029:(e,t,n)=>{"use strict";n.d(t,{Vx:()=>PixelRatioChangedMessage,zq:()=>WebGLContextLostMessage,Xq:()=>WebGLContextRestoredMessage});var i=n(4117);class PixelRatioChangedMessage extends i.v{constructor(e){super(),this.pixelRatio=e}}class WebGLContextLostMessage extends i.v{constructor(e){super(),this.event=e}}class WebGLContextRestoredMessage extends i.v{constructor(e){super(),this.event=e}}},75783:(e,t,n)=>{"use strict";n.d(t,{j:()=>XRSessionRequestCommand});var i=n(93037);class XRSessionRequestCommand extends i.m{constructor(e){super(),this.id="XR_PRESENT",this.payload=Object.assign({},e)}}},24440:(e,t,n)=>{"use strict";n.d(t,{hX:()=>a,pl:()=>l,bk:()=>i});var i,s=n(2252),r=n(69920),o=n(16534);!function(e){e.webxr="webxr",e.unsupported="unsupported"}(i||(i={}));const a=e=>{const t=e.tryGetProperty("is_vr",!1),n=e.tryGetProperty(o.sX,!1),i=e.tryGetProperty("vr",1);return t&&!(!i||2===i&&!(0,s.Dt)())&&!n},l=async()=>{const e=await r.Z.isSessionSupported("immersive-vr");return r.Z.likelySupportsControllers()&&e?i.webxr:i.unsupported}},69920:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(5477),s=n(2252);const r=new i.Z("vr-platform-select"),o=()=>{const e="xr"in navigator&&"isSessionSupported"in navigator.xr&&"requestSession"in navigator.xr;return window.isSecureContext&&e},a={isSessionSupported:async(e="immersive-vr")=>{let t=!1;if(o())try{t=await navigator.xr.isSessionSupported(e)}catch(e){r.info("WebXR disabled",e)}return r.debug(`WebXR session type: ${e} supported: ${t}`),t},likelySupportsControllers:()=>window.isSecureContext&&((0,s.Ot)()||!(0,s.tq)()),apiExists:o}},49665:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ZoomMessage});var i=n(4117);class ZoomMessage extends i.v{constructor(e){super(),this.zoomLevel=e}}},19282:(e,t,n)=>{"use strict";n.d(t,{bj:()=>ZoomInCommand,KB:()=>ZoomOutCommand,ob:()=>ZoomResetCommand,_N:()=>ZoomGetMaxCommand,ts:()=>ZoomSetCommand});var i=n(93037);class ZoomInCommand extends i.m{constructor(e){super(),this.payload={step:e}}}ZoomInCommand.id="ZOOM_IN";class ZoomOutCommand extends i.m{constructor(e){super(),this.payload={step:e}}}ZoomOutCommand.id="ZOOM_OUT";class ZoomResetCommand extends i.m{}ZoomResetCommand.id="ZOOM_RESET";class ZoomGetMaxCommand extends i.m{}ZoomGetMaxCommand.id="ZOOM_MAX_VALUE";class ZoomSetCommand extends i.m{constructor(e){super(),this.payload={value:e}}}ZoomSetCommand.id="ZOOM_SET"},28260:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ZoomControls});var i=n(57227),s=n(14877),r=n(17921),o=n(69054),a=n(94113),l=n(43985),c=n(19926),d=n(15099),u=n(41674),h=n(37363),p=n(53549),m=n(74170),f=n(994),g=n(95703),v=n(27421),y=n(19282),b=n(49665),S=n(36407);class ZoomControls extends i.Y{constructor(){super(...arguments),this.name="zoom-controls",this.uhQuality={},this.config={enabled:!0,tiles:!0}}async init(e,t){if(this.config.enabled=!!e.enabled,this.config.tiles=!!e.tiles,this.config.tiles)try{this.sweepTilingModule=await t.getModuleBySymbol(s.y.SWEEP_PANO)}catch(e){this.log.debug(`Tiling not enabled for zoom controls - ${e}`)}this.config.enabled&&await this.registerControls(t),this.engine=t,this.cameraModule=await t.getModuleBySymbol(s.y.CAMERA),this.cameraData=await t.market.waitForData(d.M_),this.viewmodeData=await t.market.waitForData(h.O),this.sweepData=await t.market.waitForData(p.Z),this.bindings.push(t.commandBinder.addBinding(y.bj,(async e=>this.zoomBy(e.step))),t.commandBinder.addBinding(y.KB,(async e=>this.zoomBy(-e.step))),t.commandBinder.addBinding(y.ob,(async()=>this.zoomTo(1))),t.commandBinder.addBinding(y.ts,(async e=>this.zoomTo(e.value))),t.commandBinder.addBinding(y._N,this.getMaxZoomAvailable.bind(this)))}async registerControls(e){e.getModuleBySymbol(s.y.INPUT).then((e=>{this.bindings.push(e.registerHandler(r.a,(e=>this.zoomByInput(this.scrollToZoomDelta(e))))),this.bindings.push(e.registerHandler(o.G,(e=>this.zoomByInput(this.pinchToZoomDelta(e))))),this.bindings.push(e.registerHandler(a.e,(e=>this.keyHandler(e))))}))}zoomTo(e){const t=this.cameraData.zoom();if(!this.validateViewmode())return t;const n=this.sweepData.currentSweepObject;if(this.config.tiles&&this.checkTilingZoomLevels(e,n),(e=(0,m.uZ)(e,v.X.minZoom,v.X.maxHighResZoom))!==t){const t=(0,f.ZY)(this.cameraData.baseFovY/e),n=u.oR.near,i=u.oR.far;this.cameraModule.updateCameraProjection((new g.M).makePerspectiveFov(t,this.cameraData.aspect(),n,i))}return this.engine.broadcast(new b.Z(e)),e}checkTilingZoomLevels(e,t){e>=v.X.highResThreshold&&this.zoomedSweep!==t?(this.zoomedSweep=t,this.sweepTilingModule.enableZooming(!0,t).then((e=>{e?this.uhQuality[t.id]=!0:(this.uhQuality[t.id]=!1,this.zoomedSweep=void 0)}))):e<v.X.highResThreshold&&this.zoomedSweep&&this.zoomedSweep===t&&(this.sweepTilingModule.enableZooming(!1,this.zoomedSweep),this.zoomedSweep=void 0)}getMaxZoom(e){return this.uhQuality[e]?v.X.maxHighResZoom:v.X.maxZoom}zoomBy(e){const t=this.cameraData.zoom();return this.validateViewmode()?this.zoomTo(t+e):t}validateViewmode(){return this.viewmodeData.isInside()&&this.cameraData.canTransition()}scrollToZoomDelta(e){return-Math.sign(e.delta.y)*v.X.zoomStep}pinchToZoomDelta(e){return e.pinchDelta*(v.X.maxZoom-v.X.minZoom)}zoomByInput(e){const t=this.cameraData.zoom();if(!this.validateViewmode())return t;const n=this.sweepData.currentSweep,i=(0,m.uZ)(t+e,v.X.minZoom,this.getMaxZoom(n));return this.zoomTo(i)}keyHandler(e){if(e.state===c.M.DOWN)switch(e.key){case l.R.PLUSEQUALS:this.zoomByInput(v.X.zoomStep);break;case l.R.DASHUNDERSCORE:this.zoomByInput(-v.X.zoomStep);break;case l.R.OPENBRACKET:this.zoomTo(1)}}async getMaxZoomAvailable(){if(!this.sweepData.currentSweepObject)return v.X.maxZoom;const e=this.sweepData.currentSweepObject;return await this.sweepTilingModule.availableResolution(e,S.SL.ULTRAHIGH)>=S.SL.ULTRAHIGH?v.X.maxHighResZoom:v.X.maxZoom}}},27421:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});const i={zoomStep:.1,minZoom:.7,maxZoom:2,maxHighResZoom:3,highResThreshold:1.1}},14547:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});const i={Navigation:Symbol("Navigation"),Octree:Symbol("Octree"),PanoTiles:Symbol("PanoTiles"),Raycaster:Symbol("Raycaster"),Snapping:Symbol("Snapping"),StreamingTexture:Symbol("StreamingTexture"),StreamingMesh:Symbol("StreamingMesh"),WebGLRenderer:Symbol("WebGLRenderer")}},69524:(e,t,n)=>{"use strict";n.d(t,{em:()=>SymbolMessage,bc:()=>SymbolBind,z4:()=>SymbolUnbind,PD:()=>l});var i=n(4117),s=n(36032),r=n(91183);const o=new(n(5477).Z)("symbols"),a=[];class SymbolMessage extends i.v{constructor(e){super(),this.symbol=e}}class SymbolBind extends i.v{constructor(e){super(),this.payload=e}}class SymbolUnbind extends i.v{constructor(e){super(),this.payload=e}}function l(e){return new s.V((0,r.k1)((()=>null),(()=>a.length=0)),e.messageBus.subscribe(SymbolBind,(e=>{a.push(e.payload)})),e.messageBus.subscribe(SymbolUnbind,(e=>{const t=a.findIndex((t=>t.symbol===e.payload.symbol&&t.callback===e.payload.callback));t>=0&&a.splice(t,1)})),e.messageBus.subscribe(SymbolMessage,(e=>{a.forEach((t=>{if(t.symbol===e.symbol)try{t.callback()}catch(t){o.warn("Error handling SymbolMessage",e,t)}}))})))}},88807:(e,t,n)=>{"use strict";n.d(t,{b:()=>AdaptiveRawShaderMaterial});var i=n(2212);class AdaptiveRawShaderMaterial extends i.RawShaderMaterial{onBeforeCompile(e,t){super.onBeforeCompile(e,t),t.capabilities.isWebGL2&&this.glslVersion!==i.GLSL3&&(e.glslVersion=i.GLSL3,e.vertexShader=s+e.vertexShader,e.fragmentShader=r+e.fragmentShader)}}const s="\n#define attribute in\n#define varying out\n#define texture2D texture\n",r="\n#define varying in\nout highp vec4 pc_fragColor;\n#define gl_FragColor pc_fragColor\n#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n"},31117:(e,t,n)=>{"use strict";n.d(t,{P:()=>CircularBuffer});class CircularBuffer{constructor(e){this.size=e,this.index=0,this.buffer=[],this.sorted=!1}push(e){this.index>=this.size&&(this.index=0),this.buffer[this.index]=e,this.index++,this.sorted=!1}peek(){return this.buffer[this.index<=this.buffer.length?this.index-1:0]||null}getList(){return this.buffer}median(){const e=Math.floor(this.buffer.length/2);return this.sorted||this.buffer.sort(),this.buffer[e]}*[Symbol.iterator](){yield*this.buffer}clear(){this.buffer=[],this.index=0}}},16493:(e,t,n)=>{"use strict";n.d(t,{s:()=>Comparator});class Comparator{constructor(e){this.matcher=e}static isValue(e){return new Comparator(new ValueMatcher(e))}static isType(e){return new Comparator(new TypeMatcher(e))}static isInstanceOf(e){return new Comparator(new InstanceMatcher(e))}static is(e){return new Comparator(new PredicateMatcher(e))}static isAny(){return new Comparator(new AnyMatcher)}compare(e){return this.matcher.matches(e)}}class ValueMatcher{constructor(e){this.value=e}matches(e){return this.value===e}}class TypeMatcher{constructor(e){this.type=e}matches(e){return Object.getPrototypeOf(e).constructor===this.type}}class InstanceMatcher{constructor(e){this.type=e}matches(e){if("object"==typeof e)return e instanceof this.type;const t=this.type;switch(typeof e){case"number":return t===Number;case"string":return t===String;case"boolean":return t===Boolean;case"function":return t===Function}return!1}}class PredicateMatcher{constructor(e){this.predicate=e}matches(e){return this.predicate(e)}}class AnyMatcher{constructor(){}matches(){return!0}}},28129:(e,t,n)=>{"use strict";n.d(t,{s:()=>l,n:()=>ExpiringResource});var i=n(5477),s=n(73957),r=n(31013);const o=new i.Z("expiring-resource"),a=new WeakMap;function l(e,t){(0,s.y)(e,(e=>{e instanceof ExpiringResource&&(e.onStale=t)}))}class ExpiringResource{constructor(e,t){this.value=e,this.validUntil=t}refreshFrom(e){this.value=e.value,this.validUntil=e.validUntil;const t=a.get(this);t&&(t.resolve(),a.delete(this))}async get(){if(this.validUntil&&this.onStale){const e=Date.now();if(e+6e4+1e4>this.validUntil.getTime()){let t=a.get(this);t||(t=new r.Q,a.set(this,t),this.onStale()),e+6e4+1e3>this.validUntil.getTime()&&(o.info("Stale resource, waiting for refresh"),await t.nativePromise(),o.info("Refreshed resource"))}}return this.value}}},69910:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>LineOctree,FM:()=>SnapLine3,UQ:()=>SnapVector3});var i=n(2212);class LineOctreeNode{constructor(e,t){this.raycast=(()=>{const e=new i.Vector3,t=new i.Box3;return(n,i,s,r)=>{const o=t.copy(this.bounds).expandByScalar(i);if(n.ray.intersectsBox(o))for(const t of this.children)if(t instanceof LineOctreeNode)t.raycast(n,i,s,r);else if(t instanceof SnapLine3){if(!1===(null==r?void 0:r(t)))continue;const o=e,a=n.ray.distanceSqToSegment(t.start,t.end,void 0,e),l=Math.sqrt(a);l<i&&s.push({distance:n.ray.origin.distanceTo(o),object:t,distanceToRay:l,point:o.clone(),isLineOctreeIntersection:!0})}else if(t instanceof SnapVector3){if(!1===(null==r?void 0:r(t)))continue;const e=n.ray.distanceToPoint(t);e<i&&s.push({distance:n.ray.origin.distanceTo(t),object:t,distanceToRay:e,point:t.clone(),isLineOctreeIntersection:!0})}}})(),this.level=t,this.bounds=e.clone(),this.childNodes=[],this.children=[]}add(e){let t=!1;const n=e instanceof i.Line3?[e.start,e.end]:[e];if(this.level<4){0===this.childNodes.length&&this.buildChildNodes();for(const i of this.childNodes)n.every((e=>i.bounds.containsPoint(e)))&&(t=!0,i.add(e))}t||this.children.push(e)}remove(e){const t=e instanceof i.Line3?[e.start,e.end]:[e];for(let n=0;n<this.children.length;n++){const i=this.children[n];if(i instanceof LineOctreeNode){if(t.every((e=>i.bounds.containsPoint(e)))&&i.remove(e))return!0}else if(i===e)return this.children.splice(n,1),!0}return!1}buildChildNodes(){const e=this.bounds.max.clone().sub(this.bounds.min).clone().multiplyScalar(.5);for(let t=0;t<2;t++)for(let n=0;n<2;n++)for(let s=0;s<2;s++){const r=this.bounds.min.x+e.x*s,o=r+e.x,a=this.bounds.min.y+e.y*t,l=a+e.y,c=this.bounds.min.z+e.z*n,d=c+e.z,u=new i.Box3(new i.Vector3(r,a,c),new i.Vector3(o,l,d)),h=new LineOctreeNode(u,this.level+1);this.childNodes.push(h),this.children.push(h)}}spherecast(e,t){if(e.intersectsBox(this.bounds))for(const n of this.children)if(n instanceof LineOctreeNode)n.spherecast(e,t);else if(n instanceof SnapLine3){const s=n.closestPointToPoint(e.center,!0,new i.Vector3);s.distanceTo(e.center)<e.radius&&t.push(new SnapVector3(s))}else n instanceof i.Vector3&&n.distanceTo(e.center)<e.radius&&t.push(n)}traverse(e){for(const t of this.children)t instanceof LineOctreeNode?t.traverse(e):e(t)}}class LineOctree{constructor(e){this.pointCount=0,this.lineCount=0,this.root=new LineOctreeNode(e,0)}add(e){e instanceof i.Line3?this.lineCount++:e instanceof i.Vector3&&this.pointCount++,this.root.add(e)}remove(e){e instanceof SnapLine3?this.lineCount--:e instanceof SnapVector3&&this.pointCount--,this.root.remove(e)}traverse(e){this.root.traverse(e)}raycast(e,t,n){const i=[];return this.root.raycast(e,t,i,n),i}}class SnapLine3 extends i.Line3{constructor(e,t){super(e,t),this.start=e,this.end=t,this.isSnapLine3=!0}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}clone(){return new SnapLine3(this.start,this.end)}}class SnapVector3 extends i.Vector3{constructor(e){super(),this.point=e,this.isSnapVector3=!0,super.copy(e)}copy(e){return this.point.copy(e.point),this}clone(){return new SnapVector3(this.point)}}},96141:(e,t,n)=>{"use strict";n.d(t,{H:()=>Lock});class Lock{constructor(){this.activePromise=Promise.resolve(new Key)}async lock(){const e=new Promise((async e=>{(await this.activePromise).onUnlock((()=>e(new Key)))})),t=this.activePromise;return this.activePromise=e,t}}class Key{onUnlock(e){this.unlockCB=e}unlock(){this.unlockCB()}}},26517:(e,t,n)=>{"use strict";n.d(t,{Pp:()=>l,s1:()=>c,r0:()=>d,m$:()=>u,D7:()=>h,Ll:()=>p,n0:()=>m,fd:()=>f,Fe:()=>g,YN:()=>v,k2:()=>y,mY:()=>b,_U:()=>S,S3:()=>E,J2:()=>T});var i=n(2212),s=n(95703),r=n(77280),o=n(74566),a=n(85111);const l=e=>!!e&&1===e.elements[15],c=e=>!!e&&(e.elements[15]>0&&e.elements[15]<1),d=((()=>{const e=new i.Object3D,t=new i.Vector3})(),(()=>{const e=new i.Vector3;return(t,n,i,s)=>(e.copy(t).sub(n),e.clampLength(i,s),n.clone().add(e))})()),u=(()=>{const e=new i.Vector3;return(t,n,i,s)=>{e.copy(n).sub(t);const r=Math.atan2(Math.sqrt(Math.pow(e.x,2)+Math.pow(e.z,2)),e.y),o=Math.min(Math.max(i,r),s);return Math.abs(r-o)>Number.EPSILON?h(t,n,r-o,!1):t}})(),h=(()=>{const e=new i.Vector3,t=new i.Vector3;return(n,i,s,o)=>(e.copy(i).sub(n),o?t.copy(r.f.UP):t.copy(e).applyAxisAngle(r.f.UP,-1*Math.PI/2).setY(0).normalize(),e.applyAxisAngle(t,s),i.clone().sub(e))})(),p=(()=>{const e=new i.Vector3,t=new i.Vector3;return(n,s,r)=>(e.copy(n).sub(s).normalize(),t.copy(n).sub(r).normalize(),(new i.Quaternion).setFromUnitVectors(e,t))})(),m=(()=>{const e=new s.M;return(t,n)=>(e.setPosition(t),e.lookAt(t,n,r.f.UP),(new i.Quaternion).setFromRotationMatrix(e.asThreeMatrix4()))})(),f=(()=>{const e=new i.Vector3;return(t,n,i)=>(e.copy(r.f.FORWARD).applyQuaternion(t).normalize(),e.clone().multiplyScalar(-1*i).add(n))})(),g=(()=>{const e=new i.Ray,t=new i.Vector3,n=new i.Vector3;return(i,s,o)=>(n.set(0,0,0),t.copy(r.f.FORWARD).applyQuaternion(s),e.set(i,t),e.intersectPlane(o,n))})(),v=(()=>{const e=new i.Vector3,t=new i.Vector3,n=new i.Vector3,s=new i.Vector3,o=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3],a=new i.Vector3,l=new i.Vector3,c=new i.Vector3,d=new i.Vector3,u=new i.Plane,h=new i.Vector3,p=new i.Ray,f=new i.Vector3,g=new i.Vector3;return(i,v,y,b,S,E)=>{e.copy(r.f.FORWARD).applyQuaternion(v).setY(0),t.copy(e).setY(y).normalize(),s.copy(t).applyAxisAngle(r.f.UP,-Math.PI/2).setY(0).normalize(),n.copy(s).cross(t).normalize();let T=0;const w=b.max,x=b.min,_=[w,x];for(let e=0;e<2;e++){const t=_[e].x;for(let e=0;e<2;e++){const n=_[e].y;for(let e=0;e<2;e++){const i=_[e].z;o[T].set(t,n,i),T++}}}a.copy(x),c.copy(i).setY(x.y);let M=l.copy(a).sub(c).dot(t);o.forEach((e=>{if(e.y===w.y)return;const n=l.copy(e).sub(c).dot(t);n<M&&(a.copy(e),M=n)}));const O=Math.sign(a.dot(s));d.copy(a).setX(a.x===w.x?x.x:w.x),Math.sign(d.dot(s))!==O?u.set(h.set(0,0,-1*Math.sign(a.z)),Math.abs(a.z)):(d.copy(a).setZ(a.z===w.z?x.z:w.z),u.set(h.set(-1*Math.sign(a.x),0,0),Math.abs(a.x))),p.set(i,f.copy(t).multiplyScalar(-1)),p.intersectPlane(u,g);const A=Math.min(Math.abs(g&&g.dot(t)),M);let C=0,N=0;o.forEach((function(e){l.copy(e).sub(i);const t=Math.abs(l.dot(s)),r=Math.abs(l.dot(n));t>C&&(C=t),r>N&&(N=r)}));const D=C/Math.tan(S*E/2),I=N/Math.tan(S/2),L=Math.max(D,I)+Math.abs(A),P=i.clone().add(t.clone().multiplyScalar(1.1*-L));return{position:P,rotation:m(P,i)}}})(),y=((()=>{const e=new i.Matrix4})(),(()=>{const e=new i.Matrix4,t=new i.Vector4})(),(()=>{const e=new i.Vector3;return(t,n,i=r.f.UP)=>{const s=t.angleTo(n);return Math.sign(e.crossVectors(t,n).dot(i))*s}})()),b=((()=>{const e=new s.M,t=new i.Vector3})(),(e,t,n,i,s=1.5)=>{const r=1/e.elements[5];if(l(e))return s*i/(2*r);const o=t.distanceTo(n),a=Math.atan(r);return i*(s/(2*Math.tan(a)*o))}),S=function(){const e=new i.Vector3,t=new i.Matrix4;return(n,i,s)=>{const r=e.set(0,0,-n).applyMatrix4(i).z;return t.copy(i),t.invert(),e.set(2/s,0,r).applyMatrix4(t),e.x}}(),E=e=>1/e.elements[5],T=(()=>{const e=new i.Vector3;return(t,n,i)=>{const s=i.angleTo(r.f.UP),o=Math.abs(s-Math.PI);return s<.2||o<.2?(t.quaternion.setFromUnitVectors(r.f.FORWARD,i),!0):(t.lookAt(e.copy(n).add(i)),!1)}})();(()=>{const e=new i.Vector3,t=new i.Vector3(1e4,1e4,1e4),n=[new i.Line3,new i.Line3,new i.Line3,new i.Line3],s=[new i.Vector3,new i.Vector3,new i.Vector3,new i.Vector3]})()},94293:(e,t,n)=>{"use strict";n.d(t,{mB:()=>i});const i=e=>!e||!Object.values(e).filter((e=>0!==e)).length},994:(e,t,n)=>{"use strict";n.d(t,{Ue:()=>i,MN:()=>s,Id:()=>r,ZY:()=>o});const i=Math.PI/180,s=180/Math.PI;function r(e){return e*i}function o(e){return e*s}},74170:(e,t,n)=>{"use strict";n.d(t,{uZ:()=>i});const i=function(e,t,n){return Math.max(t,Math.min(e,n))}},74566:(e,t,n)=>{"use strict";n.d(t,{r6:()=>i,wo:()=>s});const i=(e,t,n=1e-5)=>Math.abs(e-t)<=n,s=(e,t,n=1e-5)=>((e,t,n=1e-5)=>i(e.x,t.x,n)&&i(e.y,t.y,n))(e,t,n)&&i(e.z,t.z,n)},34629:(e,t,n)=>{"use strict";function i(e,t,n){return(1-n)*e+n*t}n.d(t,{t:()=>i})},63387:(e,t,n)=>{"use strict";n.d(t,{ep:()=>d,tf:()=>u,r_:()=>h,zW:()=>p,xS:()=>m,cb:()=>f,rj:()=>g,jB:()=>v,et:()=>y,dS:()=>b,Z:()=>E,Rq:()=>T,Xe:()=>w,Xv:()=>x});var i=n(2212),s=n(95703),r=n(77280),o=n(74170),a=n(994);const l=new i.Frustum,c=new s.M;new i.Sphere;var d;!function(e){e.fromVisionVector=function(e){return new i.Vector3(e.x,e.z,-e.y)},e.toVisionVector=function(e){return new i.Vector3(e.x,-e.z,e.y)},e.fromVisionQuaternion=function(e){return new i.Quaternion(e.x,e.z,-e.y,e.w).multiply((new i.Quaternion).setFromAxisAngle(new i.Vector3(0,1,0),(0,a.Id)(90)))},e.fromVisionCameraQuaternion=function(e){return new i.Quaternion(-e.x,-e.z,e.y,-e.w).multiply((new i.Quaternion).setFromAxisAngle(new i.Vector3(1,0,0),(0,a.Id)(90)))},e.toVisionQuaternion=function(e){const t=new i.Quaternion(e.x,e.y,e.z,e.w).multiply((new i.Quaternion).setFromAxisAngle(new i.Vector3(0,1,0),(0,a.Id)(-90)));return t.set(t.x,-t.z,t.y,t.w),t},e.toVisionCameraQuaternion=function(e){return new i.Quaternion(e.x,-e.z,e.y,e.w).multiply(new i.Quaternion(-.70710678118,0,0,.70710678118))}}(d||(d={}));const u=function(e){return Math.cos((0,a.Id)(e/2))};function h(e,t,n){return Math.abs(t-e)<=n?t:e+Math.sign(t-e)*n}const p=function(e,t){const n=new i.Vector3(0,0,-1);return n.clone().applyQuaternion(e).angleTo(n.clone().applyQuaternion(t))};function m(e,t,n){return c.identity().makeRotationFromQuaternion(t).setPosition(e),c.getInverse(c),c.premultiply(n.asThreeMatrix4()),l.setFromProjectionMatrix(c.asThreeMatrix4()),l}const f=(e,t,n,i)=>m(e,t,n).intersectsBox(i),g=e=>{const t=e.getSize(new i.Vector3),n=Math.max(t.x,t.y,t.z);return(new i.Box3).setFromCenterAndSize(e.getCenter(new i.Vector3),new i.Vector3(n,n,n))},v=(e,t)=>{if(t.length<8)throw new Error("getPointsFromBox3: Result array to small!");t[0].copy(e.min),t[1].copy(e.min),t[1].x=e.max.x,t[2].copy(e.min),t[2].y=e.max.y,t[3].copy(e.min),t[3].z=e.max.z,t[4].copy(e.max),t[5].copy(e.max),t[5].x=e.min.x,t[6].copy(e.max),t[6].y=e.min.y,t[7].copy(e.max),t[7].z=e.min.z},y=(e,t,n,i,s)=>(s-i)*((e-t)/(n-t))+i,b=(e,t,n,i,s)=>{const r=y(e,t,n,i,s);return(0,o.uZ)(r,i,s)};function S(e){return 0===e.x&&0===e.y&&0===e.z}const E=(()=>{const e=new i.Vector3,t=new i.Matrix4;return n=>S(n)?n.clone():(e.copy(r.f.FORWARD).applyQuaternion(n),t.lookAt(r.f.ZERO,e,r.f.UP),(new i.Quaternion).setFromRotationMatrix(t))})(),T=(()=>{const e=new i.Vector3,t=new i.Matrix4;return(n,i)=>S(n)?i.copy(n):(e.copy(r.f.FORWARD).applyQuaternion(n).setY(0).normalize(),t.lookAt(r.f.ZERO,e,r.f.UP),i.setFromRotationMatrix(t))})(),w=(()=>{const e=new i.Vector3,t=new i.Ray;return(n,s,r,o)=>(o=o||new i.Vector3,t.origin.copy(n),t.lookAt(s),o.copy(t.at(r,e)))})(),x=(()=>{const e=new i.Vector3,t=new i.Ray;return(n,s,r,o)=>(o=o||new i.Vector3,t.set(n,s),o.copy(t.at(r,e)))})()},78261:(e,t,n)=>{"use strict";function i(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)}n.d(t,{C:()=>i})},85875:(e,t,n)=>{"use strict";n.d(t,{L:()=>ObjectPool});class ObjectPool{constructor(e){this.comparer=e||this.defaultComparer,this.poolArray=[]}add(e){const t=this.createObjectDescriptor(e);return t.object=e,t.inUse=!0,this.addObjectDescriptorToPool(t),t}get(e){for(const t of this.poolArray)if(!t.inUse&&this.comparer(t,e))return t.inUse=!0,t;return null}free(e){for(const t of this.poolArray)if(t.object===e)return t.inUse=!1,!0;return!1}all(){return this.poolArray}remove(e){const t=this.poolArray.findIndex((t=>t.object===e));return-1!==t&&(this.poolArray.splice(t,1),!0)}defaultComparer(e,t){return!0}createObjectDescriptor(e){return{object:e,inUse:!1}}addObjectDescriptorToPool(e){this.poolArray.push(e)}}},31013:(e,t,n)=>{"use strict";n.d(t,{Q:()=>OpenDeferred});class OpenDeferred{constructor(){this.base=new Promise(((e,t)=>{this.resolver=e,this.rejecter=t})),this._promise=new OpenPromise(this.base,this),this.progressCallbacks=[]}then(e,t){return this.base.then(e,t)}catch(e){return this.base.catch(e)}resolve(e){return this.resolver(e),this}reject(e){return this.rejecter(e),this}notify(e){for(const t of this.progressCallbacks)t(e)}progress(e){return this.progressCallbacks.push(e),this}promise(){return this._promise}nativePromise(){return this.base}static resolve(){const e=new OpenDeferred;return e.resolve(),e.promise()}static reject(e){const t=new OpenDeferred;return t.reject(e),t.promise()}static all(e){const t=[];for(const n of e)n.nativePromise?t.push(n.nativePromise()):t.push(n);const n=new OpenDeferred;return Promise.all(t).then((e=>n.resolve(e)),(e=>n.reject(e))),n.promise()}}class OpenPromise{constructor(e,t){this.basePromise=e,this.baseDeferred=t}then(e,t){return this.baseDeferred.then(e,t),this}catch(e){return this.baseDeferred.catch(e),this}progress(e){return this.baseDeferred.progress(e),this}nativePromise(){return this.basePromise}}},89741:(e,t,n)=>{"use strict";n.d(t,{Z:()=>OrderedMap});const i=e=>""+e;class OrderedMap{constructor(e=i){this.mappingFunction=e,this.list=[],this.map={}}add(e){const t=this.mappingFunction(e);return!this.map[t]&&(this.list.push(e),this.map[t]=e,!0)}set(e){const t=this.mappingFunction(e);return this.map[t]?(this.map[t]=e,!0):(this.add(e),!0)}count(){return this.list.length}*[Symbol.iterator](){for(const e of this.list)yield e}getByIndex(e){return this.list[e]}get(e){return this.map[e]}copyToList(e){return e.push.apply(e,this.list),e}clear(){this.list=[],this.map={}}mapElements(e){return this.list.map(e)}}},53675:(e,t,n)=>{"use strict";n.d(t,{a:()=>PersistentStorage});class VariableContainer{constructor(e){this._value=e}value(){return this._value}set(e){this._value=e}}class PersistentStorage{constructor(){this.storage={}}get(e,t){let n=this.storage[e];return n||(n=t(),this.storage[e]=n),n}getNumber(e){return this.get(e,(()=>new VariableContainer(0)))}getString(e){return this.get(e,(()=>new VariableContainer("")))}getArray(e){return this.get(e,(()=>[]))}getNumberMap(e){return this.get(e,(()=>({})))}getStringMap(e){return this.get(e,(()=>({})))}}},65:(e,t,n)=>{"use strict";function i(e){return{x:e.x,y:e.y,z:e.z}}function s(e){return{x:e.x||e._x,y:e.y||e._y,z:e.z||e._z,w:e.w||e._w}}n.d(t,{m:()=>i,J5:()=>s})},25935:(e,t,n)=>{"use strict";n.d(t,{E:()=>TypedMesh});var i=n(2212);class TypedMesh extends i.Mesh{constructor(e,t){super(e,t)}}},41252:(e,t,n)=>{"use strict";n.d(t,{z:()=>AnimatedNumber});var i=n(65270),s=n(98254);const r=new(n(5477).Z)("animation");class AnimatedNumber extends s.T{constructor(e,t,n,s=i.vG,r=0){super(),this._easing=i.vG,void 0===t&&(t=e),void 0===n&&(this._active=!1,n=0,this._elapsed=0,this._duration=0),this.modifyAnimation(e,t,n,s,0,r)}get active(){return this._active}get duration(){return this._duration}get endValue(){return this._endValue}get easing(){return this._easing}get elapsed(){return this._elapsed}get delay(){return this._delay}tick(e){if(!this._active)return this.endValue;if(this._delay>0)return this._delay-=e,this.startValue;const t=(this._elapsed+e)/Math.max(this._duration,1e-5);return this.updateProgress(t),this.value}updateProgress(e){if(isNaN(e))return void r.error(`Invalid progress value: ${e}`);const t=Math.max(0,Math.min(e,1)),n=this.active,i=this.value;if(t>=1)return this.activate(!1),this.value=this._easing(1,this.startValue,this._endValue-this.startValue,1),this._elapsed=this.duration,this.commit(),void(this._onComplete&&this._onComplete());this.activate(!0),this.value=this._easing(t,this.startValue,this._endValue-this.startValue,1),this._elapsed=t*this.duration,i===this.value&&n===this.active||this.commit()}updateAbsolute(e){const t=e/Math.max(this._duration,1e-5);this.updateProgress(t)}modifyAnimation(e,t,n,s=i.vG,r=0,o=0){return this._easing=s,this._endValue=t,this._duration=n,this.activate(this._duration>=0&&e!==t),this._elapsed=r,this._delay=o,this.startValue=e,this.value=e,this.commit(),this}onComplete(e){return this._onComplete=e,this}activate(e){this._active=e}copy(e){this._endValue=e.endValue,this._duration=e.duration,this._active=e.active,this._easing=e.easing,this._elapsed=e.elapsed,this.startValue=e.startValue,this.value=e.value,this.commit()}clone(){const e=new AnimatedNumber(0);return e.copy(this),e}stop(e){this._active=!1,this._elapsed=this._duration,this.value=e,this._endValue=e,this.commit()}equals(e){return this._active===e._active&&this.duration===e.duration&&this.easing===e.easing&&this.elapsed===e.elapsed&&this.endValue===e.endValue&&this.startValue===e.startValue&&this.value===e.value}}},95987:(e,t,n)=>{"use strict";n.d(t,{bX:()=>i,E8:()=>s});const i=(e,t)=>{if(0!==e.length)for(let n=0;n<e.length;n++){e[n]===t&&e.splice(n,1)}};const s=(e=[],t=[])=>e.length===t.length&&(e=e.slice().sort(),t=t.slice().sort(),e.every(((e,n)=>t[n]===e)))},83773:(e,t,n)=>{"use strict";n.d(t,{g$:()=>i,LP:()=>s,lZ:()=>r});const i=16/9,s=1/i,r=function(e,t){return Math.min(Math.max(t/e,s),1)*e}},29497:(e,t,n)=>{"use strict";n.d(t,{h:()=>i,K:()=>s});class Heap{constructor(e){this.comparator=e,this.nodes=[]}push(e){return this.nodes.push(e),this.siftdown(0,this.nodes.length-1)}pop(){let e,t;return this.nodes.length&&(e=this.nodes.pop(),e)?(this.nodes.length?(t=this.nodes[0],this.nodes[0]=e,this.siftup(0)):t=e,t):null}peek(){return this.nodes[0]}contains(e){return-1!==this.nodes.indexOf(e)}replace(e){if(this.nodes.length){const t=this.nodes[0];return this.nodes[0]=e,this.siftup(0),t}return null}_pushpop(e,t,n){let i;const s=n||this.defaultCompare;return e.length&&s(e[0],t)<0&&(i=[e[0],t],t=i[0],e[0]=i[1],this._siftup(e,0,s)),t}pushpop(e){return this._pushpop(this.nodes,e,this.comparator)}_heapify(e,t){let n,i,s,r,o,a;const l=Math.floor(e.length/2),c=function(){for(a=[],s=0,o=l;0<=o?s<o:s>o;0<=o?s++:s--)a.push(s);return a}.apply(this).reverse(),d=[];for(i=0,r=c.length;i<r;i++)n=c[i],d.push(this._siftup(e,n,t));return d}heapify(){let e,t,n,i,s,r;const o=Math.floor(this.nodes.length/2),a=function(){for(r=[],n=0,s=o;0<=s?n<s:n>s;0<=s?n++:n--)r.push(n);return r}.apply(this).reverse(),l=[];for(t=0,i=a.length;t<i;t++)e=a[t],l.push(this.siftup(e));return l}updateItem(e){const t=this.nodes.indexOf(e);return-1===t?null:(this.siftdown(0,t),this.siftup(t))}clear(){return this.nodes=[]}empty(){return 0===this.nodes.length}size(){return this.nodes.length}clone(){const e=new Heap(this.comparator);return e.nodes=this.nodes.slice(0),e}toArray(){return this.nodes.slice(0)}insert(e){return this.push(e)}top(){return this.peek()}front(){return this.peek()}has(e){return this.contains(e)}copy(){return this.clone()}nlargest(e){let t,n,i;const s=this.nodes.slice(0,e);if(!s.length)return s;this._heapify(s,this.comparator);const r=this.nodes.slice(e);for(n=0,i=r.length;n<i;n++)t=r[n],this._pushpop(s,t,this.comparator);return s.sort(this.comparator).reverse()}defaultCompare(e,t){return e<t?-1:e>t?1:0}_siftdown(e,t,n,i){let s,r;const o=i||this.defaultCompare,a=e[n];for(;n>t&&(r=n-1>>1,s=e[r],o(a,s)<0);)e[n]=s,n=r;return e[n]=a}siftdown(e,t){return this._siftdown(this.nodes,e,t,this.comparator)}_siftup(e,t,n){let i,s;const r=n||this.defaultCompare,o=e.length,a=t,l=e[t];for(i=2*t+1;i<o;)s=i+1,s<o&&!(r(e[i],e[s])<0)&&(i=s),e[t]=e[i],i=2*(t=i)+1;return e[t]=l,this._siftdown(e,a,t,r)}siftup(e){return this._siftup(this.nodes,e,this.comparator)}}var i;function s(e){void 0===e.timeout&&(e.timeout=1/0);const t={data:e.start,g:0,heuristicValue:e.heuristic(e.start)};let n=t;t.f=t.heuristicValue;const s=new Set,a=new Heap(o),l=new Map;a.push(t),l.set(t.data,t);const c=Date.now();for(;a.size();){if(Date.now()-c>e.timeout)return{status:i.Timeout,cost:n.g,path:r(n)};const t=a.pop();if(l.delete(t.data),t&&e.isEnd(t.data))return{status:i.Success,cost:t.g,path:r(t)};s.add(t.data);const o=e.neighbors(t.data);for(const i of o){if(s.has(i))continue;const r=t.g+e.distance(t.data,i);let o=l.get(i),c=!1;if(void 0===o)o={data:i,g:0,heuristicValue:0,f:0},l.set(i,o);else{if(o.g<r)continue;c=!0}o.parent=t||void 0,o.g=r,o.heuristicValue=e.heuristic(i),o.f=r+o.heuristicValue,o.heuristicValue<n.heuristicValue&&(n=o),c?a.heapify():a.push(o)}}return{status:i.NoPath,cost:n.g,path:r(n)}}function r(e){if(void 0!==e.parent){const t=r(e.parent);return t.push(e.data),t}return[e.data]}function o(e,t){if(e.f&&t.f)return e.f-t.f;throw new Error('heapComparator() -> Property "f" is undefined.')}!function(e){e[e.Success=0]="Success",e[e.NoPath=1]="NoPath",e[e.Timeout=2]="Timeout"}(i||(i={}))},28861:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i=function(e,t){if(t.setLength(0),0===e.length)return t;let n=0;for(const i of e)t.add(i),n++;return t.divideScalar(n),t}},2252:(e,t,n)=>{"use strict";n.d(t,{dy:()=>a,tq:()=>l,jx:()=>c,_1:()=>u,Tt:()=>h,V5:()=>p,Kr:()=>m,Dt:()=>f,vU:()=>g,rI:()=>v,Ot:()=>y,Q0:()=>b,Jm:()=>S,J1:()=>E,yL:()=>T,SP:()=>w,UD:()=>x,Vf:()=>_,Hx:()=>M,rm:()=>O,O6:()=>A,Zx:()=>C,Qg:()=>N,PI:()=>D,ht:()=>I});var i=n(5477),s=n(14909),r=n(87100);const o=new i.Z("util-browser"),a=()=>{const e=window.innerWidth/window.innerHeight;return isFinite(e)?e:1},l=function(){const e=navigator.userAgent||navigator.vendor,t=new RegExp("(android|bbd+|meego).+mobile|android|avantgo|bada/|blackberry|blazer|compal|elaine|fennec|\n    hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|\n    palm( os)?|phone|p(ixi|re)/|plucker|pocket|psp|series(4|6)0|symbian|treo|up.(browser|link)|vodafone|\n    wap|windows ce|xda|xiino","i"),n=new RegExp("1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|\n    amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|\n    br(e|v)w|bumb|bw-(n|u)|c55/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|\n    devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|\n    g560|gene|gf-5|g-mo|go(.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|\n    a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|\n    jemu|jigs|kddi|keji|kgt( |/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|/(k|l|u)|50|54|-[a-w])|libw|lynx|\n    m1-w|m3ga|m50/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|\n    zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|\n    nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|\n    po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55/|\n    sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|\n    sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|\n    tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|\n    vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|\n    zeto|zte-","i");return(t.test(e)||n.test(e.substr(0,4))||u())&&!y()},c=/([\s\{\}\"\']|[^\x00-\x7F]|%[^0-9a-fA-F]{2})+/g,d=(e,t)=>{let n=window.navigator.userAgent.match(e);return n=n?n[1].split(t):[],{major:parseInt(n[0],10)||0,minor:parseInt(n[1],10)||0,patch:parseInt(n[2],10)||0}},u=()=>{const e=window.navigator.userAgent;return/iPad/.test(e)||p()&&navigator.maxTouchPoints>1},h=()=>{const e=window.navigator.userAgent;return/iPod|iPhone/.test(e)||p()&&navigator.maxTouchPoints>1},p=()=>{const e=window.navigator.platform;return/MAC/.test(e.toUpperCase())},m=()=>{const e=window.navigator.platform;return/WIN/.test(e.toUpperCase())},f=()=>-1!==window.navigator.userAgent.indexOf("Android"),g=()=>-1!==window.navigator.userAgent.indexOf("Firefox"),v=()=>{if(!g())throw new Error("Not a Firefox browser");return d(/Firefox\/((?:\d+\.?){1,3})/,".")},y=()=>-1!==window.navigator.userAgent.indexOf("OculusBrowser"),b=()=>{switch((0,r.eY)("bot",2)){case 0:return!1;case 1:return!0;case 2:return-1!==navigator.userAgent.indexOf("Googlebot");default:return!1}},S=()=>"ontouchstart"in window,E=()=>"share"in navigator&&(l()||u()),T=()=>window.parent!==window,w=()=>T()&&(()=>{const e=new URL(document.referrer);return s.yx.some((t=>t.test(e.hostname)))})(),x=()=>window.location.search.substr(1).split("&"),_=(e,t=!1)=>{const n=`${window.location.origin}${window.location.pathname}?${e}`;t?window.history.pushState({},"",n):window.location.replace(n)},M=function(){const e=window.URL||window.webkitURL,t=document.createElement("a");return document.body.appendChild(t),t.style.display="none",(n,i)=>{const s=e.createObjectURL(n);t.href=s,t.download=i,t.click(),e.revokeObjectURL(s)}}(),O=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},A=function(){return!u()&&!h()&&!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled)},C=function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()},N=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};function D(e){try{return document.featurePolicy.allowsFeature(e)}catch(t){return o.warn(t),o.warn(`Feature Policy check failed, defaulting ${e} to false.`),!1}}const I=()=>{var e,t;return(e=>{const t={language:"en",region:void 0,script:void 0,ext:void 0},n=new RegExp([/^([a-z]{2,3})/,/(?:[_-]([ut]{1}[_-][a-z\-\_]+))?/,/(?:[_-]([a-z]{4}))?/,/(?:[_-]([a-z]{2}))?$/].map((e=>e.source)).join(""),"i").exec(e);if(n){const[,e,i,s,r]=n;Object.assign(t,{language:e,ext:i,script:s,region:r})}return t})((null===(t=null===(e=null===Intl||void 0===Intl?void 0:Intl.DateTimeFormat())||void 0===e?void 0:e.resolvedOptions())||void 0===t?void 0:t.locale)||navigator.language).language||""}},28124:(e,t,n)=>{"use strict";n.d(t,{G1:()=>a,rn:()=>l,D5:()=>c,Ex:()=>d});var i=n(2212),s=n(81402);const r=()=>Math.random(),o={},a=(e,t=r())=>(o[t]||(o[t]=new i.Vector4(r(),r(),r(),e)),o[t]),l=()=>new i.Color(r(),r(),r()),c=e=>"object"==typeof e&&"r"in e&&"g"in e&&"b"in e;function d(e){return`#${(0,s.Q_)(255*e.r,2,"0",16)}${(0,s.Q_)(255*e.g,2,"0",16)}${(0,s.Q_)(255*e.b,2,"0",16)}`}},19718:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i=function(e,t){const n=new RegExp(e+"=([^;]+)|$").exec(document.cookie);if(!n)return t;const i=n[1];return"boolean"==typeof t?"true"===i||"1"===i:"number"==typeof t?parseFloat(i):i}},11334:(e,t,n)=>{"use strict";function i(e){const t=document.createElement("input");t.type="text",t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}n.d(t,{v:()=>i})},63336:(e,t,n)=>{"use strict";n.d(t,{U:()=>s,p:()=>r});const i=new Object,s=e=>{if(e){const t=e.valueOf();if(!isNaN(t))return e.toISOString()}return(new Date).toISOString()},r=(e,t=i)=>{if(e){const t=new Date(e);if(!isNaN(t.valueOf()))return t}return t===i?new Date:t}},83233:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(e,t=250)=>{let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout((()=>e.apply(null,i)),t)}}},48558:(e,t,n)=>{"use strict";n.d(t,{_F:()=>s,zy:()=>r,XJ:()=>o});const i=.3048,s=e=>e*i,r=e=>e/i,o=e=>{const t=e/i;let n=Math.floor(t),s=12*t%12;return 12===Math.round(s)?(n+=1,s=0):s=Math.round(s),{feet:n,inches:s}}},65270:(e,t,n)=>{"use strict";n.d(t,{vG:()=>r,FG:()=>o,hl:()=>a,to:()=>l,Q9:()=>c,w2:()=>d,qb:()=>u,Fs:()=>h,e3:()=>p,tf:()=>m,aB:()=>f});var i=n(69436),s=n.n(i);const r=function(e,t,n,i){return n*e/i+t},o=function(e,t,n,i){return n*(e/=i)*e+t},a=function(e,t,n,i){return-n*(e/=i)*(e-2)+t},l=function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},c=function(e,t,n,i){return n*(e/=i)*e*e+t},d=function(e,t,n,i){return e/=i,n*(--e*e*e+1)+t},u=function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},h=function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t},p=(e,t,n,i,s)=>{let r=t;if(s>0){const t=(1-Math.max(s,0))*Math.abs(i);r=n<=t?0:e(n-t,0,1,t)}return r};function m(e,t,n,i){const r=new(s())(e,t,n,i);return(e,t,n,i)=>{const s=e/i;return t+n*r.solve(s)}}const f=function(e,t,n,i){return-4*n*Math.pow(e/i-(.5+t),2)+1}},5314:(e,t,n)=>{"use strict";n.d(t,{bX:()=>i,z6:()=>s});const i=e=>void 0!==e.pointerId,s=e=>void 0!==e.changedTouches},19945:(e,t,n)=>{"use strict";n.d(t,{qf:()=>r,A5:()=>l,GO:()=>c,fc:()=>u});var i=n(2212),s=n(77280);function r(e){if(0===e.length)throw Error("Can't merge empty list of geometries");if(1===e.length)return e[0];let t=0,n=0,s=0,r=0;const a=new i.Box3;for(const i of e)i.index&&(t+=i.index.count,n+=i.getAttribute("position").count,i.getAttribute("uv")&&(s+=i.getAttribute("uv").count),i.boundingBox&&(a.union(i.boundingBox),r++));const c=new i.BufferGeometry;r!==e.length||a.isEmpty()?c.computeBoundingBox():c.boundingBox=a,a.copy(l(c)),c.boundingSphere=a.getBoundingSphere(new i.Sphere);const d=o(new Float32Array(3*n),"position",e);c.setAttribute("position",new i.BufferAttribute(d,3));const u=function(e,t){let n=0,i=0;for(const s of t){const t=s.index;for(let s=0;s<t.array.length;s++)e[n+s]=t.array[s]+i;n+=t.array.length,i+=s.getAttribute("position").count}return e}(new Uint32Array(t),e);if(c.setIndex(new i.BufferAttribute(u,1)),s){const t=o(new Float32Array(2*s),"uv",e);c.setAttribute("uv",new i.BufferAttribute(t,2))}return c}function o(e,t,n){let i=0;for(const s of n){const n=s.getAttribute(t);e.set(n.array,i),i+=n.array.length}return e}const a=new i.Box3(s.f.ZERO,s.f.UNIT);function l(e){return e.boundingBox||e.computeBoundingBox(),e.boundingBox||a}function c(e,t){let n=1/0;const s=t.clone(),r=new i.Vector3,o=new i.Vector3(1/0,1/0,1/0);let a=-1;const l=new i.Triangle;return function(e,t){var n;const i=null===(n=e.index)||void 0===n?void 0:n.array,s=e.getAttribute("position");if(!s)return;const r=e.groups.length>0?e.groups:[{start:0,count:i?i.length:s.count,materialIndex:0}];let o=0;for(const e of r)for(let n=e.start;n<e.start+e.count;n+=3){let r=n,a=n+1,l=n+2;i&&(r=i[r],a=i[a],l=i[l]),t(s.getX(r),s.getY(r),s.getZ(r),s.getX(a),s.getY(a),s.getZ(a),s.getX(l),s.getY(l),s.getZ(l),o++,e.materialIndex||0)}}(e,((e,t,i,c,d,u,h,p,m,f)=>{l.a.set(e,t,i),l.b.set(c,d,u),l.c.set(h,p,m),l.closestPointToPoint(s,r);const g=s.distanceToSquared(r);g<n&&(o.copy(r),n=g,a=f)})),{point:o,distance:Math.sqrt(n),faceIndex:a}}const d=new i.PlaneBufferGeometry(1,1);function u(){return d}},81402:(e,t,n)=>{"use strict";n.d(t,{gw:()=>s,Ig:()=>r,Y8:()=>o,XN:()=>a,Yv:()=>l,TH:()=>c,Jq:()=>d,Pe:()=>u,DZ:()=>h,Q_:()=>p,O1:()=>m,$B:()=>f,ow:()=>g,aS:()=>v,lY:()=>y});var i=n(18050);const s=function(e){return new Promise(((t,n)=>{setTimeout(t,e)}))},r=e=>{let t,n=-1;return{promise:new Promise(((i,s)=>{t=i,n=window.setTimeout(i,e)})).then((()=>{n=-1})),cancel:()=>{-1!==n&&(window.clearTimeout(n),t())}}},o=function(e,t){if(0===e.length)return null;let n=0,i=0;for(let s of e)s=t?s[t]:s,n+=s,i++;return n/i},a=function(e){const t={};for(const n of e)t[n]=n;return t},l=function(e){return!e.replace(/\n/g,"").trim().length},c=function(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0},d=function(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0},u=function(e,t,n=!0){if(0===e.length)return null;n&&e.sort((function(e,t){return e-t}));const i=t/100;return e[Math.floor(e.length*i)]},h=function(e){return[p(e.getMonth()+1),".",p(e.getDate()),".",e.getFullYear(),"_",p(e.getHours()),".",p(e.getMinutes()),".",p(e.getSeconds())].join("")},p=function(e,t=2,n="0",i=10){const s=e.toString(i),r=t-s.length+1;return r>0?new Array(r).join(n)+s:s},m=function(e){let t="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},f=e=>{const t=[];for(let n=0;n<e.length;n+=8192)t.push(String.fromCharCode.apply(null,e.subarray(n,n+8192)));return btoa(t.join(""))},g=(e=[])=>{const t={};for(const n of e)t[n]=!0;return t};const v=(e,t,n="...")=>e.length<t?e:`${e.substr(0,t)}${n}`,y=(e,t,n)=>{if(!(Math.abs(e)<4294967295)||!(t<32)||!(n<32))throw new i.Z("argument out of range");const s=1&(e>>>t^e>>>n);return(e^=s<<t|s<<n)>>>0};(()=>{const e={}})()},37917:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});const i=new(n(5477).Z)("passive-support"),s=(()=>{let e=!1;try{const t=Object.defineProperty({},"passive",{get:()=>{e=!0}});return window.addEventListener("testPassive",(()=>{}),t),window.removeEventListener("testPassive",(()=>{}),t),e}catch(e){return i.warn(`Passive Option for addEventListener is not supported, Safari zoom may not perform as expected: ${e}`),!1}})()},253:(e,t,n)=>{"use strict";n.d(t,{fp:()=>s,m8:()=>r});const i=new(n(5477).Z)("util-browser"),s=function(e,t){if(!("localStorage"in window))return t;let n;try{n=window.localStorage.getItem(e)}catch(e){return i.debug(e),t}return null===n?t:"boolean"==typeof t?"true"===n:"number"==typeof t?parseFloat(n):n},r=function(e,t){try{window.localStorage.setItem(e,t)}catch(e){i.error(e)}}},5477:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Logger});const i=window.navigationStart||Date.now();var s;!function(e){e[e.ERROR=0]="ERROR",e[e.WARN=1]="WARN",e[e.INFO=2]="INFO",e[e.DEBUG=3]="DEBUG"}(s||(s={}));class Logger{constructor(e){this.timers={},this.handlers={[s.DEBUG]:console.debug,[s.INFO]:console.info,[s.WARN]:console.warn,[s.ERROR]:console.error};const t=e.split(new RegExp("/|\\\\"));this.prefix="["+t[t.length-1].replace(".js","")+"]"}message(e){if(Logger.level>=e&&console){return(this.handlers[e]?this.handlers[e]:console.log).bind(console,this.getPrefix())}return()=>{}}get debug(){return this.message(s.DEBUG)}get debugWarn(){return this.message(Logger.level>=s.DEBUG?s.WARN:s.DEBUG)}get info(){return this.message(s.INFO)}get warn(){return this.message(s.WARN)}get error(){return this.message(s.ERROR)}time(e){Logger.level>=s.DEBUG&&(this.timers[e]=Date.now())}timeEnd(e){if(Logger.level>=s.DEBUG){const t=this.timers[e];if(!t)return;const n=(Date.now()-t)/1e3;this.debug(e,n+"s")}}getPrefix(){const e=(Date.now()-i)/1e3+"s";return`${this.prefix} ${e}`}}Logger.level=s.INFO},73957:(e,t,n)=>{"use strict";function i(e){const t={};for(const n in e)t[e[n]]=n;return t}function s(e,t){if(null!==e&&"object"==typeof e)for(const n in e)t(e[n],n,e),s(e[n],t)}n.d(t,{S:()=>i,y:()=>s})},89142:(e,t,n)=>{"use strict";function i(e=11){let t="";const n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*n.length));return t}function s(e,t){return function(e,t){return(e%t+t)%t}(r(e),t)}function r(e){let t,n=0;for(let i=0;i<e.length;i++)t=e.charCodeAt(i),n=(n<<5)-n+t,n|=0;return n}n.d(t,{fV:()=>i,Wm:()=>s,un:()=>r})},36507:(e,t,n)=>{"use strict";n.d(t,{m5:()=>r,an:()=>o});const i="referrer";let s="";function r(e){let t;try{t=new URL(e)}catch(t){return e}return t.searchParams.set(i,o()),t.href}function o(){return(function(){if(!window.document.referrer)return!1;let e;try{e=new URL(window.document.referrer)}catch(e){return!1}return e.origin===window.location.origin}()?function(){const e=new URL(window.location.href);if(!e.searchParams.has(i))return s;const t=e.searchParams.get(i)||"";try{new URL(t),s=t}catch(e){}return e.searchParams.delete(i),window.history.replaceState(null,"",e.href),s}():"")||window.document.referrer}},44450:(e,t,n)=>{"use strict";n.d(t,{g_:()=>s,i5:()=>r,T8:()=>h,kp:()=>f});var i=n(91183);var s,r;!function(e){e[e.RESIZE=1]="RESIZE",e[e.ORIENTATION_CHANGED=2]="ORIENTATION_CHANGED"}(s||(s={})),function(e){e[e.PORTRAIT=1]="PORTRAIT",e[e.LANDSCAPE=2]="LANDSCAPE"}(r||(r={}));let o=[],a=[];const l=window.visualViewport,c=()=>({w:l?l.width:window.innerWidth,h:l?l.height:window.innerHeight}),d=c(),u=new i.ne((()=>d),(e=>o.push(e)),(e=>{o=o.filter((t=>t!==e))})),h=()=>({orientation:window.innerWidth>window.innerHeight?r.LANDSCAPE:r.PORTRAIT});let p=h();const m=new i.ne((()=>p),(e=>a.push(e)),(e=>{a=a.filter((t=>t!==e))}));function f(e,t){switch(e){case s.RESIZE:return u.createSubscription(t);case s.ORIENTATION_CHANGED:return m.createSubscription(t)}}const g=(()=>{let e,t;return()=>{const n=c(),i=()=>{window.clearInterval(e),window.clearTimeout(t)};i();const s=()=>{d.w===n.w&&d.h===n.h||(d.w=n.w,d.h=n.h,(()=>{if(o.length>0&&o.forEach((e=>e(d))),a.length>0){const e=h();e!==p&&(p=e,a.forEach((t=>t(e))))}})())};e=window.setInterval(s,100),t=window.setTimeout(i,1e3),s()}})();l?l.addEventListener("resize",g):window.addEventListener("resize",g)},55356:(e,t,n)=>{"use strict";n.d(t,{f:()=>ReticleMesh});var i=n(2212);const s={extensions:{derivatives:!0},defines:{RING_COUNT:0,USE_TEXTURE:!1},uniforms:{discRadius:{value:.2},discNormal:{value:new i.Vector3(0,0,1)},ringRadii:{value:[]},ringColors:{value:[]},opacity:{value:1},texture:{value:null}},vertexShader:n(20094),fragmentShader:n(89130),side:i.FrontSide,transparent:!0};var r=n(88807);const o=new i.Color,a=[{outerRadius:1,innerRadius:.75,color:16777215,opacity:1}];class ReticleMaterial extends r.b{constructor(e=a){super(Object.assign(Object.assign({},s),{defines:Object.assign({},s.defines),uniforms:i.UniformsUtils.clone(s.uniforms)})),this.setRings(e),Object.defineProperty(this,"opacity",{set(e){this.uniforms.opacity.value=e},get(){return this.uniforms.opacity.value}})}setDiscNormal(e){this.uniforms.discNormal.value.copy(e)}setDiscRadius(e){this.uniforms.discRadius.value=e}setRings(e){e=e||[],this.defines.RING_COUNT!==e.length&&(this.defines.RING_COUNT=e.length,this.needsUpdate=!0),this.uniforms.ringRadii.value=e.map((({innerRadius:e,outerRadius:t})=>new i.Vector2(e||-1,t))),this.uniforms.ringColors.value=e.map((({color:e,opacity:t})=>(o.set(e),new i.Vector4(o.r,o.g,o.b,t))))}setTexture(e){this.defines.USE_TEXTURE!==!!e&&(this.defines.USE_TEXTURE=!!e,this.needsUpdate=!0),this.uniforms.texture.value=e}getTexture(){return this.uniforms.texture.value}}class ReticleMesh extends i.Mesh{constructor(e){super(new i.SphereGeometry(Math.sqrt(2),8,6),new ReticleMaterial),e&&this.configure(e)}configure(e){const{radius:t,normal:n,rings:i,texture:s,opacity:r}=e,{material:o}=this;void 0!==t&&(this.scale.setScalar(t),o.setDiscRadius(t)),void 0!==n&&o.setDiscNormal(n),void 0!==i&&o.setRings(i),void 0!==s&&o.setTexture(s),void 0!==r&&(o.opacity=r)}dispose(){var e;null===(e=this.material.getTexture())||void 0===e||e.dispose(),this.geometry.dispose()}}},13508:(e,t,n)=>{"use strict";function i(e,t,n){const s=Math.ceil(t/2);return n(e)?t<=1?e:i(e+s,s,n):0===e?-1:i(Math.max(0,e-s),s,n)}function s(e,t){if(e<0)return-1;if(t(e))return e;const n=Math.ceil(e/2);return i(e-n,n,t)}n.d(t,{$:()=>s})},16752:(e,t,n)=>{"use strict";var i;n.d(t,{o:()=>i}),function(e){function t(e){return e.split(".").reduce(((e,t)=>{const n=parseInt(t,10);return isNaN(n)||e.push(n),e}),[])}function n(e,n){const i=t(e),s=t(n);for(let e=0;e<i.length;e++){if(e>=s.length)return 1;if(i[e]!==s[e])return i[e]>s[e]?1:-1}return s.length>i.length?-1:0}e.parse=t,e.gt=function(e,t){return 1===n(e,t)},e.lt=function(e,t){return-1===n(e,t)},e.eq=function(e,t){return 0===n(e,t)},e.compare=n}(i||(i={}))},89034:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});var i=n(2212);const s=new(n(5477).Z)("texture"),r=(e,t,n)=>{const r=new i.TextureLoader;return r.crossOrigin="anonymous",r.load(e,t,void 0,(t=>{s.error(`Failed to load ${e}`),n&&n(t)}))}},37796:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});const i=(e,t)=>{let n,i=Date.now()-t;return(...s)=>{const r=Date.now()-i,o=()=>{e.apply(null,s),i=Date.now()};if(n&&clearTimeout(n),r>=t)o();else{const e=t-r;n=window.setTimeout(o,e)}}}},14909:(e,t,n)=>{"use strict";n.d(t,{sU:()=>s,bf:()=>r,QY:()=>o,yx:()=>a,KK:()=>c,rI:()=>d,on:()=>u});var i=n(8575);const s=function(e="",t){let n,s,r;if(e.match(/^https?/)){const t=(0,i.Qc)(e);n=t.protocol+"//"+t.host,s=e,r=e.match(/[^/]*$/)[0]}else{if(t.match(/^https?/)){const e=(0,i.Qc)(t);n=e.protocol+"//"+e.host}else n=window.location.protocol+"//"+t;s=n+"/api/player/models/"+e,r=e}return{sid:r,urlBase:n,urlModel:s,urlFiles:s+(s.match(/\/$/)?"files":"/files"),urlThumb:s+(s.match(/\/$/)?"thumb":"/thumb")}},r=function(e,t={}){for(const n in t){const i=t[n];e+=(-1===e.indexOf("?")?"?":"&")+`${n}=${i}`}return e},o=e=>e.replace(/^https?:\/\/(?:www.)?/i,"").replace(/\/(.*)/,""),a=[/^([a-z0-9\-]*\.)*matterport\.com$/,/^([a-z0-9\-]*\.)*matterportvr\.cn$/,/^localhost$/];function l(e){const t=new URL(e).hostname;for(const e of a)if(t.match(e))return!0;return!1}const c=e=>{if(l(e)){return new URL(e).origin}return null};function d(e=window.location.href){let t=e;return l(t)&&(t=t.replace(/\/work\/(\?.*)?$/,"/show/$1")),new URL(t)}function u(e){["q","qK","tag","note","comment","pin-pos"].forEach((t=>e.delete(t)))}},87100:(e,t,n)=>{"use strict";n.d(t,{FU:()=>r,kD:()=>o,eY:()=>a});n(1939);const i=new URLSearchParams(window.location.search),s={};function r(){return Object.assign({},s)}function o(){return new URLSearchParams(i.toString())}function a(e,t=null){const n=i.get(e),s=typeof t;return null===n?t:"boolean"===s?"true"===n||"1"===n:"number"===s?+n:n}i.forEach(((e,t)=>{s[t]=e}))},83535:(e,t,n)=>{"use strict";n.d(t,{D:()=>s});const i=[];for(let e=0;e<256;e++)i[e]=(e<16?"0":"")+e.toString(16);function s(){let e;const t=window.crypto||window.msCrypto;return e=t?t.getRandomValues(new Uint8Array(16)):new Uint8Array(16).map((()=>255*Math.random())),e[6]=15&e[6]|64,e[8]=63&e[8]|128,i[e[0]]+i[e[1]]+i[e[2]]+i[e[3]]+"-"+i[e[4]]+i[e[5]]+"-"+i[e[6]]+i[e[7]]+"-"+i[e[8]]+i[e[9]]+"-"+i[e[10]]+i[e[11]]+i[e[12]]+i[e[13]]+i[e[14]]+i[e[15]]}},30581:(e,t,n)=>{"use strict";n.d(t,{y:()=>X});const i=Symbol("analytics"),s=Symbol("automation-support"),r=Symbol("blur-data"),o=Symbol("blur-editor"),a=Symbol("blur-suggestions"),l=Symbol("camera"),c=Symbol("canvas"),d=Symbol("cursor-controller"),u=Symbol("deep-links"),h=Symbol("gui"),p=Symbol("input"),m=Symbol("label-data"),f=Symbol("label-render"),g=Symbol("layers"),v=Symbol("layers-tool"),y=Symbol("measurement-mode"),b=Symbol("mesh-query"),S=Symbol("mesh-api-fixup"),E=Symbol("mesh-trim-data"),T=Symbol("mesh-trim-editor-module"),w=Symbol("model-mesh"),x=Symbol("model-rating"),_=Symbol("object-tag-suggestions"),M=Symbol("object-tag-suggestions-data"),O=Symbol("orthographic-controls"),A=Symbol("pins"),C=Symbol("raycaster"),N=Symbol("scan-info"),D=Symbol("scene"),I=Symbol("sdk"),L=Symbol("search"),P=Symbol("settings"),R=Symbol("pano"),k=Symbol("pucks"),U=Symbol("tags"),B=Symbol("tours-controls"),F=Symbol("tours-data"),V=Symbol("transform-gizmo"),H=Symbol("trash"),j=Symbol("video"),G=Symbol("vision-catalog"),z=Symbol("webgl-renderer"),W=(Symbol("webvr"),Symbol("webxr")),K=Symbol("dwell-analytics"),Y=Symbol("show-analytics"),q=Symbol("showcase-webgl-context-loss"),Z=Symbol("model-mesh-quality"),$=Symbol("view-ui"),Q=Symbol("edit-ui"),X={ANALYTICS:i,AUTOMATION_SUPPORT:s,BLUR_DATA:r,BLUR_EDITOR:o,BLUR_SUGGESTIONS:a,CAMERA:l,CANVAS:c,CURSOR_CONTROLLER:d,DEEP_LINKS:u,DWELL_ANALYTICS:K,GUI:h,INPUT:p,LOADING_GUI:Symbol("init-ui"),LABEL_DATA:m,LABEL_RENDERER:f,LAYERS:g,LAYERS_TOOL:v,MEASUREMENT_MODE:y,MODEL_MESH:w,MODEL_MESH_QUALITY:Z,MESH_API_FIXUP:S,MESH_QUERY:b,MESH_TRIM_DATA:E,MESH_TRIM_EDITOR:T,MODEL_RATING:x,OBJECT_TAG_SUGGESTIONS:_,OBJECT_TAG_SUGGESTIONS_DATA:M,ORTHOGRAPHIC_CONTROLS:O,PINS:A,RAYCASTER:C,SCAN_INFO:N,SCENE:D,SDK:I,SEARCH:L,SETTINGS:P,SHOWCASE_GUI:$,SHOWCASE_ANALYTICS:Y,SHOWCASE_WEBGL_CONTEXT_LOSS:q,SWEEP_PANO:R,SWEEP_PUCKS:k,TAGS:U,TOUR_CONTROLS:B,TOUR_DATA:F,TRANSFORM_GIZMO:V,TRASH:H,VIDEO_RECORDER:j,VISION_CATALOG:G,WEBGL_RENDERER:z,WEBXR:W,WORKSHOP_GUI:Q}},14877:(e,t,n)=>{"use strict";n.d(t,{y:()=>o.y,m:()=>ModuleLoader});var i=n(31013);const s=new(n(5477).Z)("module-loader");var r;!function(e){e[e.Registered=0]="Registered",e[e.Loading=1]="Loading",e[e.Initialized=2]="Initialized",e[e.Unloaded=3]="Unloaded"}(r||(r={}));class ModuleLoader{constructor(){this.symbolMap=new Map}registerModule(e,t){if(this.symbolMap.has(e))throw Error(`Type ${String(e)} already registered`);this.symbolMap.set(e,{es6ModulePromise:t,ctorPromise:new i.Q,initPromise:new i.Q,state:r.Registered})}moduleRegistered(e){return this.symbolMap.has(e)}moduleLoaded(e){const t=this.symbolMap.get(e);return!!t&&![r.Registered,r.Unloaded].includes(t.state)}getModule(e){const t=this.symbolMap.get(e);if(!t)throw Error(`Trying to get ${String(e)} before it was registered!`);if(t.state===r.Unloaded)throw Error(`${String(e)} module unloaded`);return t.initPromise.nativePromise()}getModuleSync(e){const t=this.symbolMap.get(e);return t?t.state!==r.Initialized?null:t.module:null}loadModule(e,t,n={}){const i=this.symbolMap.get(t);if(!i)throw Error(`${String(t)} not found`);if(i.state===r.Initialized)return i;if(i.state!==r.Registered&&i.state!==r.Unloaded)throw Error(`${String(t)} already loading`);i.state=r.Loading;const o=String(t);return i.es6ModulePromise(o).then((o=>{if(!o.default)throw new Error(`${String(t)} has no default export during module loading`);const a=new o.default;i.ctorPromise.resolve(a).then((()=>{const t=Date.now();let o=!1;setTimeout((()=>{o||s.debug(`${a.name} init took over 2 seconds`)}),2e3),a.init(n,e).then((()=>{s.debug(`${a.name} init took ${(Date.now()-t)/1e3} secs.`),o=!0,i.state=r.Initialized,i.module=a,i.initPromise.resolve(a)})).catch((e=>{i.initPromise.reject(e)}))}))})).catch((e=>{s.error(`Failed to load es6Module for ${String(t)}: ${e}`),i.initPromise.reject(e)})),i}whenQueueEmpties(){const e=[];for(const[,t]of this.symbolMap)t.state===r.Loading&&e.push(t.initPromise);return i.Q.all(e).nativePromise()}unloadModule(e){const t=this.symbolMap.get(e);if(!t)throw Error("Attempting to unload unregistered module");if(t.state===r.Unloaded||t.state===r.Registered)throw Error("Attempting to unload not-loaded module");t.state=r.Unloaded,t.ctorPromise=new i.Q,t.initPromise=new i.Q,t.module=void 0}}var o=n(30581)},38636:(e,t,n)=>{"use strict";function i(e={},t){return t.split(".").reduce(((e,t)=>e&&e[t]),e)}n.d(t,{q:()=>i})},1154:(e,t,n)=>{"use strict";n.d(t,{M:()=>DynamicLibLoader});class DynamicLibLoader{constructor(){this.libraryCache=new Map}load(e,t){const n=this.libraryCache.get(e)||new ScriptFetcher(e,t);return this.libraryCache.set(e,n),n.library}}class ScriptFetcher{constructor(e,t){this._libraryPromise=new Promise(((e,t)=>{this.libraryResolver=e,this.libraryRejecter=t})),this.fetch(e,t)}async fetch(e,t){let n;try{const t=new Request(e),i=new URL(t.url);if(!i.hostname.endsWith(window.location.hostname)&&!i.host.endsWith("matterport.com")&&!i.host.endsWith("matterportvr.cn"))return void this.libraryRejecter(`Request made for ${i.href} does not have the same origin as the request origin ${window.location.origin}`);n=await fetch(new Request(e,{}))}catch(e){return void this.libraryRejecter(e)}if(!n.ok)return void this.libraryRejecter("Script not found.");const i={},s=await n.text();if(new Function(s).call(i),t&&t in window){const e=window[t]||{};Object.assign(i,e),delete window[t]}this.libraryResolver(i)}get library(){return this._libraryPromise}}},54119:(e,t,n)=>{"use strict";n.d(t,{zx:()=>_e,hE:()=>Me,do:()=>xt,qE:()=>xe,Wu:()=>we,Q5:()=>Mt,JO:()=>a,w0:()=>Ce,jr:()=>vt,oi:()=>pt,rR:()=>Pt,no:()=>Ct});var i=n(85893),s=n(94184),r=n.n(s),o=n(67294);(0,o.createContext)({intersectionRef:null,GroupRenderer:()=>null,ItemRenderer:()=>null,itemRendererProps:{},toggleGroup:()=>{},isCollapsed:()=>!1});function a({name:e,style:t,size:n,className:s}){const o=r()("nova-icon",`icon-${e}`,s,{[`nova-icon-${n}`]:void 0!==n});return(0,i.jsx)("span",{className:o,style:t})}var l;function c(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function d(e){return e instanceof c(e).Element||e instanceof Element}function u(e){return e instanceof c(e).HTMLElement||e instanceof HTMLElement}function h(e){return"undefined"!=typeof ShadowRoot&&(e instanceof c(e).ShadowRoot||e instanceof ShadowRoot)}!function(e){e.SMALL="small",e.MEDIUM="medium",e.LARGE="large"}(l||(l={}));var p=Math.max,m=Math.min,f=Math.round;function g(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),i=1,s=1;if(u(e)&&t){var r=e.offsetHeight,o=e.offsetWidth;o>0&&(i=f(n.width)/o||1),r>0&&(s=f(n.height)/r||1)}return{width:n.width/i,height:n.height/s,top:n.top/s,right:n.right/i,bottom:n.bottom/s,left:n.left/i,x:n.left/i,y:n.top/s}}function v(e){var t=c(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function y(e){return e?(e.nodeName||"").toLowerCase():null}function b(e){return((d(e)?e.ownerDocument:e.document)||window.document).documentElement}function S(e){return g(b(e)).left+v(e).scrollLeft}function E(e){return c(e).getComputedStyle(e)}function T(e){var t=E(e),n=t.overflow,i=t.overflowX,s=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+s+i)}function w(e,t,n){void 0===n&&(n=!1);var i,s,r=u(t),o=u(t)&&function(e){var t=e.getBoundingClientRect(),n=f(t.width)/e.offsetWidth||1,i=f(t.height)/e.offsetHeight||1;return 1!==n||1!==i}(t),a=b(t),l=g(e,o),d={scrollLeft:0,scrollTop:0},h={x:0,y:0};return(r||!r&&!n)&&(("body"!==y(t)||T(a))&&(d=(i=t)!==c(i)&&u(i)?{scrollLeft:(s=i).scrollLeft,scrollTop:s.scrollTop}:v(i)),u(t)?((h=g(t,!0)).x+=t.clientLeft,h.y+=t.clientTop):a&&(h.x=S(a))),{x:l.left+d.scrollLeft-h.x,y:l.top+d.scrollTop-h.y,width:l.width,height:l.height}}function x(e){var t=g(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function _(e){return"html"===y(e)?e:e.assignedSlot||e.parentNode||(h(e)?e.host:null)||b(e)}function M(e){return["html","body","#document"].indexOf(y(e))>=0?e.ownerDocument.body:u(e)&&T(e)?e:M(_(e))}function O(e,t){var n;void 0===t&&(t=[]);var i=M(e),s=i===(null==(n=e.ownerDocument)?void 0:n.body),r=c(i),o=s?[r].concat(r.visualViewport||[],T(i)?i:[]):i,a=t.concat(o);return s?a:a.concat(O(_(o)))}function A(e){return["table","td","th"].indexOf(y(e))>=0}function C(e){return u(e)&&"fixed"!==E(e).position?e.offsetParent:null}function N(e){for(var t=c(e),n=C(e);n&&A(n)&&"static"===E(n).position;)n=C(n);return n&&("html"===y(n)||"body"===y(n)&&"static"===E(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&u(e)&&"fixed"===E(e).position)return null;for(var n=_(e);u(n)&&["html","body"].indexOf(y(n))<0;){var i=E(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}(e)||t}var D="top",I="bottom",L="right",P="left",R="auto",k=[D,I,L,P],U="start",B="end",F="viewport",V="popper",H=k.reduce((function(e,t){return e.concat([t+"-"+U,t+"-"+B])}),[]),j=[].concat(k,[R]).reduce((function(e,t){return e.concat([t,t+"-"+U,t+"-"+B])}),[]),G=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function z(e){var t=new Map,n=new Set,i=[];function s(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&s(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||s(e)})),i}var W={placement:"bottom",modifiers:[],strategy:"absolute"};function K(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Y(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,s=t.defaultOptions,r=void 0===s?W:s;return function(e,t,n){void 0===n&&(n=r);var s,o,a={placement:"bottom",orderedModifiers:[],options:Object.assign({},W,r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},l=[],c=!1,u={state:a,setOptions:function(n){var s="function"==typeof n?n(a.options):n;h(),a.options=Object.assign({},r,a.options,s),a.scrollParents={reference:d(e)?O(e):e.contextElement?O(e.contextElement):[],popper:O(t)};var o=function(e){var t=z(e);return G.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(i,a.options.modifiers)));return a.orderedModifiers=o.filter((function(e){return e.enabled})),a.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,s=e.effect;if("function"==typeof s){var r=s({state:a,name:t,instance:u,options:i}),o=function(){};l.push(r||o)}})),u.update()},forceUpdate:function(){if(!c){var e=a.elements,t=e.reference,n=e.popper;if(K(t,n)){a.rects={reference:w(t,N(n),"fixed"===a.options.strategy),popper:x(n)},a.reset=!1,a.placement=a.options.placement,a.orderedModifiers.forEach((function(e){return a.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<a.orderedModifiers.length;i++)if(!0!==a.reset){var s=a.orderedModifiers[i],r=s.fn,o=s.options,l=void 0===o?{}:o,d=s.name;"function"==typeof r&&(a=r({state:a,options:l,name:d,instance:u})||a)}else a.reset=!1,i=-1}}},update:(s=function(){return new Promise((function(e){u.forceUpdate(),e(a)}))},function(){return o||(o=new Promise((function(e){Promise.resolve().then((function(){o=void 0,e(s())}))}))),o}),destroy:function(){h(),c=!0}};if(!K(e,t))return u;function h(){l.forEach((function(e){return e()})),l=[]}return u.setOptions(n).then((function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)})),u}}var q={passive:!0};function Z(e){return e.split("-")[0]}function $(e){return e.split("-")[1]}function Q(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function X(e){var t,n=e.reference,i=e.element,s=e.placement,r=s?Z(s):null,o=s?$(s):null,a=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(r){case D:t={x:a,y:n.y-i.height};break;case I:t={x:a,y:n.y+n.height};break;case L:t={x:n.x+n.width,y:l};break;case P:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var c=r?Q(r):null;if(null!=c){var d="y"===c?"height":"width";switch(o){case U:t[c]=t[c]-(n[d]/2-i[d]/2);break;case B:t[c]=t[c]+(n[d]/2-i[d]/2)}}return t}var J={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ee(e){var t,n=e.popper,i=e.popperRect,s=e.placement,r=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,d=e.adaptive,u=e.roundOffsets,h=e.isFixed,p=o.x,m=void 0===p?0:p,g=o.y,v=void 0===g?0:g,y="function"==typeof u?u({x:m,y:v}):{x:m,y:v};m=y.x,v=y.y;var S=o.hasOwnProperty("x"),T=o.hasOwnProperty("y"),w=P,x=D,_=window;if(d){var M=N(n),O="clientHeight",A="clientWidth";if(M===c(n)&&"static"!==E(M=b(n)).position&&"absolute"===a&&(O="scrollHeight",A="scrollWidth"),M=M,s===D||(s===P||s===L)&&r===B)x=I,v-=(h&&_.visualViewport?_.visualViewport.height:M[O])-i.height,v*=l?1:-1;if(s===P||(s===D||s===I)&&r===B)w=L,m-=(h&&_.visualViewport?_.visualViewport.width:M[A])-i.width,m*=l?1:-1}var C,R=Object.assign({position:a},d&&J),k=!0===u?function(e){var t=e.x,n=e.y,i=window.devicePixelRatio||1;return{x:f(t*i)/i||0,y:f(n*i)/i||0}}({x:m,y:v}):{x:m,y:v};return m=k.x,v=k.y,l?Object.assign({},R,((C={})[x]=T?"0":"",C[w]=S?"0":"",C.transform=(_.devicePixelRatio||1)<=1?"translate("+m+"px, "+v+"px)":"translate3d("+m+"px, "+v+"px, 0)",C)):Object.assign({},R,((t={})[x]=T?v+"px":"",t[w]=S?m+"px":"",t.transform="",t))}var te={left:"right",right:"left",bottom:"top",top:"bottom"};function ne(e){return e.replace(/left|right|bottom|top/g,(function(e){return te[e]}))}var ie={start:"end",end:"start"};function se(e){return e.replace(/start|end/g,(function(e){return ie[e]}))}function re(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&h(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function oe(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function ae(e,t){return t===F?oe(function(e){var t=c(e),n=b(e),i=t.visualViewport,s=n.clientWidth,r=n.clientHeight,o=0,a=0;return i&&(s=i.width,r=i.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=i.offsetLeft,a=i.offsetTop)),{width:s,height:r,x:o+S(e),y:a}}(e)):d(t)?function(e){var t=g(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):oe(function(e){var t,n=b(e),i=v(e),s=null==(t=e.ownerDocument)?void 0:t.body,r=p(n.scrollWidth,n.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),o=p(n.scrollHeight,n.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-i.scrollLeft+S(e),l=-i.scrollTop;return"rtl"===E(s||n).direction&&(a+=p(n.clientWidth,s?s.clientWidth:0)-r),{width:r,height:o,x:a,y:l}}(b(e)))}function le(e,t,n){var i="clippingParents"===t?function(e){var t=O(_(e)),n=["absolute","fixed"].indexOf(E(e).position)>=0&&u(e)?N(e):e;return d(n)?t.filter((function(e){return d(e)&&re(e,n)&&"body"!==y(e)})):[]}(e):[].concat(t),s=[].concat(i,[n]),r=s[0],o=s.reduce((function(t,n){var i=ae(e,n);return t.top=p(i.top,t.top),t.right=m(i.right,t.right),t.bottom=m(i.bottom,t.bottom),t.left=p(i.left,t.left),t}),ae(e,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function ce(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function de(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function ue(e,t){void 0===t&&(t={});var n=t,i=n.placement,s=void 0===i?e.placement:i,r=n.boundary,o=void 0===r?"clippingParents":r,a=n.rootBoundary,l=void 0===a?F:a,c=n.elementContext,u=void 0===c?V:c,h=n.altBoundary,p=void 0!==h&&h,m=n.padding,f=void 0===m?0:m,v=ce("number"!=typeof f?f:de(f,k)),y=u===V?"reference":V,S=e.rects.popper,E=e.elements[p?y:u],T=le(d(E)?E:E.contextElement||b(e.elements.popper),o,l),w=g(e.elements.reference),x=X({reference:w,element:S,strategy:"absolute",placement:s}),_=oe(Object.assign({},S,x)),M=u===V?_:w,O={top:T.top-M.top+v.top,bottom:M.bottom-T.bottom+v.bottom,left:T.left-M.left+v.left,right:M.right-T.right+v.right},A=e.modifiersData.offset;if(u===V&&A){var C=A[s];Object.keys(O).forEach((function(e){var t=[L,I].indexOf(e)>=0?1:-1,n=[D,I].indexOf(e)>=0?"y":"x";O[e]+=C[n]*t}))}return O}function he(e,t,n){return p(e,m(t,n))}function pe(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function me(e){return[D,L,I,P].some((function(t){return e[t]>=0}))}var fe=Y({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,i=e.options,s=i.scroll,r=void 0===s||s,o=i.resize,a=void 0===o||o,l=c(t.elements.popper),d=[].concat(t.scrollParents.reference,t.scrollParents.popper);return r&&d.forEach((function(e){e.addEventListener("scroll",n.update,q)})),a&&l.addEventListener("resize",n.update,q),function(){r&&d.forEach((function(e){e.removeEventListener("scroll",n.update,q)})),a&&l.removeEventListener("resize",n.update,q)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=X({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,i=n.gpuAcceleration,s=void 0===i||i,r=n.adaptive,o=void 0===r||r,a=n.roundOffsets,l=void 0===a||a,c={placement:Z(t.placement),variation:$(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:s,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,ee(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,ee(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},{name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},s=t.elements[e];u(s)&&y(s)&&(Object.assign(s.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?s.removeAttribute(e):s.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],s=t.attributes[e]||{},r=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});u(i)&&y(i)&&(Object.assign(i.style,r),Object.keys(s).forEach((function(e){i.removeAttribute(e)})))}))}},requires:["computeStyles"]},{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,i=e.name,s=n.offset,r=void 0===s?[0,0]:s,o=j.reduce((function(e,n){return e[n]=function(e,t,n){var i=Z(e),s=[P,D].indexOf(i)>=0?-1:1,r="function"==typeof n?n(Object.assign({},t,{placement:e})):n,o=r[0],a=r[1];return o=o||0,a=(a||0)*s,[P,L].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}(n,t.rects,r),e}),{}),a=o[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=o}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var s=n.mainAxis,r=void 0===s||s,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,c=n.padding,d=n.boundary,u=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,m=void 0===p||p,f=n.allowedAutoPlacements,g=t.options.placement,v=Z(g),y=l||(v===g||!m?[ne(g)]:function(e){if(Z(e)===R)return[];var t=ne(e);return[se(e),t,se(t)]}(g)),b=[g].concat(y).reduce((function(e,n){return e.concat(Z(n)===R?function(e,t){void 0===t&&(t={});var n=t,i=n.placement,s=n.boundary,r=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?j:l,d=$(i),u=d?a?H:H.filter((function(e){return $(e)===d})):k,h=u.filter((function(e){return c.indexOf(e)>=0}));0===h.length&&(h=u);var p=h.reduce((function(t,n){return t[n]=ue(e,{placement:n,boundary:s,rootBoundary:r,padding:o})[Z(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:n,boundary:d,rootBoundary:u,padding:c,flipVariations:m,allowedAutoPlacements:f}):n)}),[]),S=t.rects.reference,E=t.rects.popper,T=new Map,w=!0,x=b[0],_=0;_<b.length;_++){var M=b[_],O=Z(M),A=$(M)===U,C=[D,I].indexOf(O)>=0,N=C?"width":"height",B=ue(t,{placement:M,boundary:d,rootBoundary:u,altBoundary:h,padding:c}),F=C?A?L:P:A?I:D;S[N]>E[N]&&(F=ne(F));var V=ne(F),G=[];if(r&&G.push(B[O]<=0),a&&G.push(B[F]<=0,B[V]<=0),G.every((function(e){return e}))){x=M,w=!1;break}T.set(M,G)}if(w)for(var z=function(e){var t=b.find((function(t){var n=T.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return x=t,"break"},W=m?3:1;W>0;W--){if("break"===z(W))break}t.placement!==x&&(t.modifiersData[i]._skip=!0,t.placement=x,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,i=e.name,s=n.mainAxis,r=void 0===s||s,o=n.altAxis,a=void 0!==o&&o,l=n.boundary,c=n.rootBoundary,d=n.altBoundary,u=n.padding,h=n.tether,f=void 0===h||h,g=n.tetherOffset,v=void 0===g?0:g,y=ue(t,{boundary:l,rootBoundary:c,padding:u,altBoundary:d}),b=Z(t.placement),S=$(t.placement),E=!S,T=Q(b),w="x"===T?"y":"x",_=t.modifiersData.popperOffsets,M=t.rects.reference,O=t.rects.popper,A="function"==typeof v?v(Object.assign({},t.rects,{placement:t.placement})):v,C="number"==typeof A?{mainAxis:A,altAxis:A}:Object.assign({mainAxis:0,altAxis:0},A),R=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,k={x:0,y:0};if(_){if(r){var B,F="y"===T?D:P,V="y"===T?I:L,H="y"===T?"height":"width",j=_[T],G=j+y[F],z=j-y[V],W=f?-O[H]/2:0,K=S===U?M[H]:O[H],Y=S===U?-O[H]:-M[H],q=t.elements.arrow,X=f&&q?x(q):{width:0,height:0},J=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},ee=J[F],te=J[V],ne=he(0,M[H],X[H]),ie=E?M[H]/2-W-ne-ee-C.mainAxis:K-ne-ee-C.mainAxis,se=E?-M[H]/2+W+ne+te+C.mainAxis:Y+ne+te+C.mainAxis,re=t.elements.arrow&&N(t.elements.arrow),oe=re?"y"===T?re.clientTop||0:re.clientLeft||0:0,ae=null!=(B=null==R?void 0:R[T])?B:0,le=j+se-ae,ce=he(f?m(G,j+ie-ae-oe):G,j,f?p(z,le):z);_[T]=ce,k[T]=ce-j}if(a){var de,pe="x"===T?D:P,me="x"===T?I:L,fe=_[w],ge="y"===w?"height":"width",ve=fe+y[pe],ye=fe-y[me],be=-1!==[D,P].indexOf(b),Se=null!=(de=null==R?void 0:R[w])?de:0,Ee=be?ve:fe-M[ge]-O[ge]-Se+C.altAxis,Te=be?fe+M[ge]+O[ge]-Se-C.altAxis:ye,we=f&&be?function(e,t,n){var i=he(e,t,n);return i>n?n:i}(Ee,fe,Te):he(f?Ee:ve,fe,f?Te:ye);_[w]=we,k[w]=we-fe}t.modifiersData[i]=k}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,i=e.name,s=e.options,r=n.elements.arrow,o=n.modifiersData.popperOffsets,a=Z(n.placement),l=Q(a),c=[P,L].indexOf(a)>=0?"height":"width";if(r&&o){var d=function(e,t){return ce("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:de(e,k))}(s.padding,n),u=x(r),h="y"===l?D:P,p="y"===l?I:L,m=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],f=o[l]-n.rects.reference[l],g=N(r),v=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=m/2-f/2,b=d[h],S=v-u[c]-d[p],E=v/2-u[c]/2+y,T=he(b,E,S),w=l;n.modifiersData[i]=((t={})[w]=T,t.centerOffset=T-E,t)}},effect:function(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=t.elements.popper.querySelector(i)))&&re(t.elements.popper,i)&&(t.elements.arrow=i)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,i=t.rects.reference,s=t.rects.popper,r=t.modifiersData.preventOverflow,o=ue(t,{elementContext:"reference"}),a=ue(t,{altBoundary:!0}),l=pe(o,i),c=pe(a,s,r),d=me(l),u=me(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:d,hasPopperEscaped:u},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":u})}}]}),ge=n(69590),ve=n.n(ge),ye=function(e){return e.reduce((function(e,t){var n=t[0],i=t[1];return e[n]=i,e}),{})},be="undefined"!=typeof window&&window.document&&window.document.createElement?o.useLayoutEffect:o.useEffect,Se=[],Ee=function(e,t,n){void 0===n&&(n={});var i=o.useRef(null),s={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||Se},r=o.useState({styles:{popper:{position:s.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),a=r[0],l=r[1],c=o.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,n=Object.keys(t.elements);l({styles:ye(n.map((function(e){return[e,t.styles[e]||{}]}))),attributes:ye(n.map((function(e){return[e,t.attributes[e]]})))})},requires:["computeStyles"]}}),[]),d=o.useMemo((function(){var e={onFirstUpdate:s.onFirstUpdate,placement:s.placement,strategy:s.strategy,modifiers:[].concat(s.modifiers,[c,{name:"applyStyles",enabled:!1}])};return ve()(i.current,e)?i.current||e:(i.current=e,e)}),[s.onFirstUpdate,s.placement,s.strategy,s.modifiers,c]),u=o.useRef();return be((function(){u.current&&u.current.setOptions(d)}),[d]),be((function(){if(null!=e&&null!=t){var i=(n.createPopper||fe)(e,t,d);return u.current=i,function(){i.destroy(),u.current=null}}}),[e,t,n.createPopper]),{state:u.current?u.current.state:null,styles:a.styles,attributes:a.attributes,update:u.current?u.current.update:null,forceUpdate:u.current?u.current.forceUpdate:null}};const Te=({children:e,offset:t=[0,8],placement:n="top",strategy:s="absolute",target:r,title:a,trigger:l="hover"})=>{const[c,d]=(0,o.useState)(null),[u,h]=(0,o.useState)(null),[p,m]=(0,o.useState)("static"===l),{styles:f,attributes:g}=Ee(r,c,{placement:n,strategy:s,modifiers:[{name:"arrow",options:{element:u,padding:4}},{name:"offset",options:{offset:t}}]}),v=()=>{m(!0)},y=()=>{m(!1)};return(0,o.useEffect)((()=>{if(r&&"hover"===l)return r.addEventListener("mouseenter",v),r.addEventListener("mouseleave",y),()=>{r.removeEventListener("mouseenter",v),r.removeEventListener("mouseleave",y)}}),[r,l]),p?(0,i.jsxs)("div",Object.assign({className:"nova-tooltip",ref:d,role:"tooltip",style:f.popper},g.popper,{children:[a||e,(0,i.jsx)("div",{className:"nova-tooltip-arrow",ref:h,style:f.arrow})]})):null};var we,xe;function _e({ariaLabel:e,children:t,className:n,disabled:s=!1,icon:l,reverse:c,label:d,onClick:u,onKeyDown:h,size:p,style:m,theme:f="light",tooltip:g,tooltipOptions:v={},variant:y}){const[b,S]=(0,o.useState)(null),E=void 0===d&&void 0===t,T=l&&(d||t),w=r()(n,"mp-nova-btn",{[`mp-nova-btn-${y}`]:void 0!==y},{[`mp-nova-btn-${f}`]:void 0!==f},{[`mp-nova-btn-${p}`]:void 0!==p},{"mp-nova-btn-icon":E},{"mp-nova-btn-multi":T},{"mp-nova-btn-reverse":c},{"mp-nova-btn-disabled":s}),x=(0,o.useCallback)((e=>{e.stopPropagation(),h&&h(e)}),[h]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",Object.assign({"aria-label":e||d,className:w,onClick:u,disabled:s,ref:g?S:null,style:m,onKeyDown:x,tabIndex:-1},{children:[l&&(0,i.jsx)(a,{name:l}),void 0!==d?d:t]})),g&&(0,i.jsx)(Te,Object.assign({target:b,title:g},v))]})}function Me({children:e,spacing:t,className:n}){const s=r()("mp-nova-btn-group",n,{[`mp-nova-btn-group-${t}`]:void 0!==t});return(0,i.jsx)("div",Object.assign({className:s},{children:e}))}!function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.TERTIARY="tertiary",e.FAB="fab"}(we||(we={})),function(e){e.SMALL="small",e.LARGE="large"}(xe||(xe={}));var Oe;!function(e){e.i360="360",e.AddLink="add-link",e.Arrows="arrows",e.Attach="attach",e.Back="back",e.Blocked="blocked",e.BlurOutline="blur-outline",e.BrushOutline="brush-outline",e.Checkmark="checkmark",e.ChevronLeft="chevron-left",e.ChevronRight="chevron-right",e.Close="close",e.CommentOutline="comment-outline",e.Comment="comment",e.Delete="delete",e.Dock="dock",e.Dollhouse="dollhouse",e.Download="download",e.DpadDown="dpad-down",e.DpadLeft="dpad-left",e.DpadRight="dpad-right",e.DpadUp="dpad-up",e.DragEdit="drag-edit",e.DrawLines="draw-lines",e.Email="email",e.Error="error",e.EscapeKey="escape-key",e.Expand="expand",e.ExtLink="ext-link",e.EyeHide="eye-hide",e.EyeShow="eye-show",e.Facebook="facebook",e.File="file",e.FingerDrag="finger-drag",e.FloorControlsAll="floor-controls-all",e.FloorControls="floor-controls",e.Floorplan="floorplan",e.FullscreenExit="fullscreen-exit",e.Fullscreen="fullscreen",e.Fullscreen2="fullscreen2",e.Help="help",e.HlrBadge="hlr-badge",e.Hlr="hlr",e.Info="info",e.Layers="layers",e.Link="link",e.Linkedin="linkedin",e.List="list",e.Location="location",e.MagnifyingGlass="magnifying-glass",e.MediaMix="media-mix",e.MeshTrim="mesh-trim",e.Mesh="mesh",e.Minus="minus",e.MoreVert="more-vert",e.Notes="notes",e.PanoramaDisable="panorama-disable",e.Panorama="panorama",e.PaperClip="paper-clip",e.PauseOutline="pause-outline",e.Pause="pause",e.Photo_2d="photo-2d",e.Photo_360="photo-360",e.PhotoAdd="photo-add",e.Pin="pin",e.Pinterest="pinterest",e.PlayUnicode="play-unicode",e.Play="play",e.Plus="plus",e.Position_3d="position-3d",e.PressHold="press-hold",e.Question="question",e.Reorder="reorder",e.Reply="reply",e.Revert="revert",e.RotateLeft="rotate-left",e.RotateRight="rotate-right",e.Rotate="rotate",e.Rotation_3d="rotation-3d",e.Scale_3d="scale-3d",e.Settings="settings",e.Share="share",e.SimpleTag="simple-tag",e.Snap="snap",e.StartLocation="start-location",e.StemHeight="stem-height",e.TapeMeasure="tape-measure",e.TogglePencil="toggle-pencil",e.Toolbar_360View="toolbar-360-view",e.ToolbarEditVr="toolbar-edit-vr",e.ToolbarHlr="toolbar-hlr",e.ToolbarLabels="toolbar-labels",e.ToolbarMattertags="toolbar-mattertags",e.ToolbarMeasurements="toolbar-measurements",e.ToolbarMoreHoriz="toolbar-more-horiz",e.ToolbarPhotos="toolbar-photos",e.ToolbarScanMgmt="toolbar-scan-mgmt",e.ToolbarStartLocation="toolbar-start-location",e.Transitions="transitions",e.TrimKeep="trim-keep",e.TrimRemove="trim-remove",e.Twitter="twitter",e.User="user",e.Vr="vr",e.ZoomReset="zoom-reset"}(Oe||(Oe={}));const Ae={[Oe.i360]:"61697",[Oe.AddLink]:"61698",[Oe.Arrows]:"61699",[Oe.Attach]:"61700",[Oe.Back]:"61701",[Oe.Blocked]:"61702",[Oe.BlurOutline]:"61703",[Oe.BrushOutline]:"61704",[Oe.Checkmark]:"61705",[Oe.ChevronLeft]:"61706",[Oe.ChevronRight]:"61707",[Oe.Close]:"61708",[Oe.CommentOutline]:"61709",[Oe.Comment]:"61710",[Oe.Delete]:"61711",[Oe.Dock]:"61712",[Oe.Dollhouse]:"61713",[Oe.Download]:"61714",[Oe.DpadDown]:"61715",[Oe.DpadLeft]:"61716",[Oe.DpadRight]:"61717",[Oe.DpadUp]:"61718",[Oe.DragEdit]:"61719",[Oe.DrawLines]:"61720",[Oe.Email]:"61721",[Oe.Error]:"61722",[Oe.EscapeKey]:"61723",[Oe.Expand]:"61724",[Oe.ExtLink]:"61725",[Oe.EyeHide]:"61726",[Oe.EyeShow]:"61727",[Oe.Facebook]:"61728",[Oe.File]:"61729",[Oe.FingerDrag]:"61730",[Oe.FloorControlsAll]:"61731",[Oe.FloorControls]:"61732",[Oe.Floorplan]:"61733",[Oe.FullscreenExit]:"61734",[Oe.Fullscreen]:"61735",[Oe.Fullscreen2]:"61736",[Oe.Help]:"61737",[Oe.HlrBadge]:"61738",[Oe.Hlr]:"61739",[Oe.Info]:"61740",[Oe.Layers]:"61741",[Oe.Link]:"61742",[Oe.Linkedin]:"61743",[Oe.List]:"61744",[Oe.Location]:"61745",[Oe.MagnifyingGlass]:"61746",[Oe.MediaMix]:"61747",[Oe.MeshTrim]:"61748",[Oe.Mesh]:"61749",[Oe.Minus]:"61750",[Oe.MoreVert]:"61751",[Oe.Notes]:"61752",[Oe.PanoramaDisable]:"61753",[Oe.Panorama]:"61754",[Oe.PaperClip]:"61755",[Oe.PauseOutline]:"61756",[Oe.Pause]:"61757",[Oe.Photo_2d]:"61758",[Oe.Photo_360]:"61759",[Oe.PhotoAdd]:"61760",[Oe.Pin]:"61761",[Oe.Pinterest]:"61762",[Oe.PlayUnicode]:"61763",[Oe.Play]:"61764",[Oe.Plus]:"61765",[Oe.Position_3d]:"61766",[Oe.PressHold]:"61767",[Oe.Question]:"61768",[Oe.Reorder]:"61769",[Oe.Reply]:"61770",[Oe.Revert]:"61771",[Oe.RotateLeft]:"61772",[Oe.RotateRight]:"61773",[Oe.Rotate]:"61774",[Oe.Rotation_3d]:"61775",[Oe.Scale_3d]:"61776",[Oe.Settings]:"61777",[Oe.Share]:"61778",[Oe.SimpleTag]:"61779",[Oe.Snap]:"61780",[Oe.StartLocation]:"61781",[Oe.StemHeight]:"61782",[Oe.TapeMeasure]:"61783",[Oe.TogglePencil]:"61784",[Oe.Toolbar_360View]:"61785",[Oe.ToolbarEditVr]:"61786",[Oe.ToolbarHlr]:"61787",[Oe.ToolbarLabels]:"61788",[Oe.ToolbarMattertags]:"61789",[Oe.ToolbarMeasurements]:"61790",[Oe.ToolbarMoreHoriz]:"61791",[Oe.ToolbarPhotos]:"61792",[Oe.ToolbarScanMgmt]:"61793",[Oe.ToolbarStartLocation]:"61794",[Oe.Transitions]:"61795",[Oe.TrimKeep]:"61796",[Oe.TrimRemove]:"61797",[Oe.Twitter]:"61798",[Oe.User]:"61799",[Oe.Vr]:"61800",[Oe.ZoomReset]:"61801"};Object.keys(Ae).sort(((e,t)=>e.localeCompare(t)));function Ce({className:e="",children:t}){const n=r()("mp-nova-list-controls",e);return(0,i.jsx)("div",Object.assign({className:n},{children:t}))}var Ne=n(73935);"undefined"!=typeof window&&void 0!==window.document&&window.document.createElement;function De(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function Ie(e){return"nodeType"in e}function Le(e){var t,n;return e?De(e)?e:Ie(e)&&null!=(t=null==(n=e.ownerDocument)?void 0:n.defaultView)?t:window:window}function Pe(e){return e?De(e)?e.document:Ie(e)?function(e){const{Document:t}=Le(e);return e instanceof t}(e)?e:!De(t=e)&&t instanceof Le(t).HTMLElement?e.ownerDocument:document:document:document;var t}function Re(e){return(t,...n)=>n.reduce(((t,n)=>{const i=Object.entries(n);for(const[n,s]of i){const i=t[n];null!=i&&(t[n]=i+e*s)}return t}),{...t})}const ke=Re(1),Ue=Re(-1);function Be(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=Le(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}var Fe;!function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"}(Fe||(Fe={}));Map;const Ve=Object.freeze({x:0,y:0});const He={ignoreTransform:!1};function je(e,t=He){let n=e.getBoundingClientRect();if(t.ignoreTransform){const{getComputedStyle:t}=Le(e),{transform:i,transformOrigin:s}=t(e);i&&(n=function(e,t,n){let i,s,r,o,a;if(t.startsWith("matrix3d("))i=t.slice(9,-1).split(/, /),s=+i[0],r=+i[5],o=+i[12],a=+i[13];else{if(!t.startsWith("matrix("))return e;i=t.slice(7,-1).split(/, /),s=+i[0],r=+i[3],o=+i[4],a=+i[5]}const l=e.left-o-(1-s)*parseFloat(n),c=e.top-a-(1-r)*parseFloat(n.slice(n.indexOf(" ")+1)),d=s?e.width/s:e.width,u=r?e.height/r:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}(n,i,s))}const{top:i,left:s,width:r,height:o,bottom:a,right:l}=n;return{top:i,left:s,width:r,height:o,bottom:a,right:l}}function Ge(e){return je(e,{ignoreTransform:!0})}var ze;function We(e){const t={x:0,y:0},n={x:e.scrollWidth-e.clientWidth,y:e.scrollHeight-e.clientHeight};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=n.y,isRight:e.scrollLeft>=n.x,maxScroll:n,minScroll:t}}!function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"}(ze||(ze={}));function Ke(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:n,right:i,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:i,bottom:s,width:e.clientWidth,height:e.clientHeight}}var Ye,qe,Ze,$e;!function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"}(Ye||(Ye={})),function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"}(qe||(qe={})),function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"}(Ze||(Ze={})),function(e){e.Optimized="optimized"}($e||($e={}));Ze.WhileDragging,$e.Optimized;class Listeners{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach((e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)}))},this.target=e}add(e,t,n){var i;null==(i=this.target)||i.addEventListener(e,t,n),this.listeners.push([e,t,n])}}function Qe(e,t){const n=Math.abs(e.x),i=Math.abs(e.y);return"number"==typeof t?Math.sqrt(n**2+i**2)>t:"x"in t&&"y"in t?n>t.x&&i>t.y:"x"in t?n>t.x:"y"in t&&i>t.y}var Xe,Je;function et(e){e.preventDefault()}function tt(e){e.stopPropagation()}!function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"}(Xe||(Xe={})),function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter"}(Je||(Je={}));const nt={start:[Je.Space,Je.Enter],cancel:[Je.Esc],end:[Je.Space,Je.Enter]},it=(e,{currentCoordinates:t})=>{switch(e.code){case Je.Right:return{...t,x:t.x+25};case Je.Left:return{...t,x:t.x-25};case Je.Down:return{...t,y:t.y+25};case Je.Up:return{...t,y:t.y-25}}};class KeyboardSensor{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.coordinates=Ve,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new Listeners(Pe(t)),this.windowListeners=new Listeners(Le(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Xe.Resize,this.handleCancel),this.windowListeners.add(Xe.VisibilityChange,this.handleCancel),setTimeout((()=>this.listeners.add(Xe.Keydown,this.handleKeyDown)))}handleStart(){const{activeNode:e,onStart:t}=this.props;if(!e.node.current)throw new Error("Active draggable node is undefined");const n=Ge(e.node.current),i={x:n.left,y:n.top};this.coordinates=i,t(i)}handleKeyDown(e){if(function(e){if(!e)return!1;const{KeyboardEvent:t}=Le(e.target);return t&&e instanceof t}(e)){const{coordinates:t}=this,{active:n,context:i,options:s}=this.props,{keyboardCodes:r=nt,coordinateGetter:o=it,scrollBehavior:a="smooth"}=s,{code:l}=e;if(r.end.includes(l))return void this.handleEnd(e);if(r.cancel.includes(l))return void this.handleCancel(e);const c=o(e,{active:n,context:i.current,currentCoordinates:t});if(c){const n={x:0,y:0},{scrollableAncestors:s}=i.current;for(const i of s){const s=e.code,r=Ue(c,t),{isTop:o,isRight:l,isLeft:d,isBottom:u,maxScroll:h,minScroll:p}=We(i),m=Ke(i),f={x:Math.min(s===Je.Right?m.right-m.width/2:m.right,Math.max(s===Je.Right?m.left:m.left+m.width/2,c.x)),y:Math.min(s===Je.Down?m.bottom-m.height/2:m.bottom,Math.max(s===Je.Down?m.top:m.top+m.height/2,c.y))},g=s===Je.Right&&!l||s===Je.Left&&!d,v=s===Je.Down&&!u||s===Je.Up&&!o;if(g&&f.x!==c.x){if(s===Je.Right&&i.scrollLeft+r.x<=h.x||s===Je.Left&&i.scrollLeft+r.x>=p.x)return void i.scrollBy({left:r.x,behavior:a});n.x=s===Je.Right?i.scrollLeft-h.x:i.scrollLeft-p.x,i.scrollBy({left:-n.x,behavior:a});break}if(v&&f.y!==c.y){if(s===Je.Down&&i.scrollTop+r.y<=h.y||s===Je.Up&&i.scrollTop+r.y>=p.y)return void i.scrollBy({top:r.y,behavior:a});n.y=s===Je.Down?i.scrollTop-h.y:i.scrollTop-p.y,i.scrollBy({top:-n.y,behavior:a});break}}this.handleMove(e,ke(c,n))}}}handleMove(e,t){const{onMove:n}=this.props;e.preventDefault(),n(t),this.coordinates=t}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function st(e){return Boolean(e&&"distance"in e)}function rt(e){return Boolean(e&&"delay"in e)}KeyboardSensor.activators=[{eventName:"onKeyDown",handler:(e,{keyboardCodes:t=nt,onActivation:n})=>{const{code:i}=e.nativeEvent;return!!t.start.includes(i)&&(e.preventDefault(),null==n||n({event:e.nativeEvent}),!0)}}];class AbstractPointerSensor{constructor(e,t,n=function(e){const{EventTarget:t}=Le(e);return e instanceof t?e:Pe(e)}(e.event.target)){var i;this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:s}=e,{target:r}=s;this.props=e,this.events=t,this.document=Pe(r),this.documentListeners=new Listeners(this.document),this.listeners=new Listeners(n),this.windowListeners=new Listeners(Le(r)),this.initialCoordinates=null!=(i=Be(s))?i:Ve,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),this.windowListeners.add(Xe.Resize,this.handleCancel),this.windowListeners.add(Xe.DragStart,et),this.windowListeners.add(Xe.VisibilityChange,this.handleCancel),this.windowListeners.add(Xe.ContextMenu,et),this.documentListeners.add(Xe.Keydown,this.handleKeydown),t){if(st(t))return;if(rt(t))return void(this.timeoutId=setTimeout(this.handleStart,t.delay))}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Xe.Click,tt,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Xe.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:n,initialCoordinates:i,props:s}=this,{onMove:r,options:{activationConstraint:o}}=s;if(!i)return;const a=null!=(t=Be(e))?t:Ve,l=Ue(i,a);if(!n&&o){if(rt(o))return Qe(l,o.tolerance)?this.handleCancel():void 0;if(st(o))return null!=o.tolerance&&Qe(l,o.tolerance)?this.handleCancel():Qe(l,o.distance)?this.handleStart():void 0}e.cancelable&&e.preventDefault(),r(a)}handleEnd(){const{onEnd:e}=this.props;this.detach(),e()}handleCancel(){const{onCancel:e}=this.props;this.detach(),e()}handleKeydown(e){e.code===Je.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const ot={move:{name:"pointermove"},end:{name:"pointerup"}};class PointerSensor extends AbstractPointerSensor{constructor(e){const{event:t}=e,n=Pe(t.target);super(e,ot,n)}}PointerSensor.activators=[{eventName:"onPointerDown",handler:({nativeEvent:e},{onActivation:t})=>!(!e.isPrimary||0!==e.button)&&(null==t||t({event:e}),!0)}];const at={move:{name:"mousemove"},end:{name:"mouseup"}};var lt;!function(e){e[e.RightClick=2]="RightClick"}(lt||(lt={}));(class core_esm_MouseSensor extends AbstractPointerSensor{constructor(e){super(e,at,Pe(e.event.target))}}).activators=[{eventName:"onMouseDown",handler:({nativeEvent:e},{onActivation:t})=>e.button!==lt.RightClick&&(null==t||t({event:e}),!0)}];const ct={move:{name:"touchmove"},end:{name:"touchend"}};(class core_esm_TouchSensor extends AbstractPointerSensor{constructor(e){super(e,ct)}static setup(){return window.addEventListener(ct.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(ct.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:({nativeEvent:e},{onActivation:t})=>{const{touches:n}=e;return!(n.length>1)&&(null==t||t({event:e}),!0)}}];Je.Down,Je.Right,Je.Up,Je.Left;const dt=9,ut=13,ht=27,pt=(0,o.forwardRef)((({text:e,type:t="text",readonly:n,focused:s,placeholder:a,className:l,maxLength:c,onInput:d,onBlur:u,onFocus:h,onKeyDown:p,onKeyUp:m,onReturn:f,onCancel:g,onPaste:v},y)=>{const b=(0,o.useRef)(null),[S,E]=(0,o.useState)(e),[T,w]=(0,o.useState)(!1);(0,o.useImperativeHandle)(y,(()=>({focus:()=>{var e,t;b.current===document.activeElement&&(null===(e=b.current)||void 0===e||e.blur()),null===(t=b.current)||void 0===t||t.focus()},blur:()=>{var e;null===(e=b.current)||void 0===e||e.blur()}})),[b]),(0,o.useEffect)((()=>(E(e),w(!1),()=>{})),[e]),(0,o.useEffect)((()=>(b.current&&s&&b.current.focus(),()=>{})),[s,b]),(0,o.useEffect)((()=>(T&&f&&b.current&&b.current.blur(),()=>{})),[T,b,f]);const x=(0,o.useCallback)((e=>{const t=e.target;E(t.value),d(t.value)}),[d,E]),_=(0,o.useCallback)((e=>{const t=e.target.value;T&&f?(w(!1),f(t)):u&&u(t)}),[u,f,T]),M=(0,o.useCallback)((e=>{e.stopPropagation();const t=e.which||e.keyCode;t===ut&&w(!0);const n=[dt,ut,ht];if("keydown"===e.type&&!n.includes(t))return!1;const i=e.target.value;switch(c&&i.length>c&&e.preventDefault(),t){case ht:g&&g()}return!1}),[g,c]),O=(0,o.useCallback)((e=>{let t=!1;p&&(t=p(e)),t||M(e)}),[M,p]),A=(0,o.useCallback)((e=>{let t=e.clipboardData.getData("text/plain").trim();c&&(t=t.substring(0,Math.min(c,t.length))),v&&v(t)}),[v,c]),C=r()("mp-text-input",l);return(0,i.jsx)("input",{ref:b,className:C,type:t,value:S,placeholder:a,maxLength:c,onInput:x,onBlur:_,onFocus:h,onKeyPress:M,onKeyDown:O,onKeyUp:m,onPaste:A,readOnly:n})}));function mt({isSelected:e,isActive:t,option:n,onSelect:s,onHover:l}){const c=(0,o.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),s(n)}),[s,n]),d=(0,o.useCallback)((()=>{l(n)}),[l,n]);return(0,i.jsxs)("div",Object.assign({className:r()("nova-select-option",{"is-selected":e,"is-active":t}),onMouseDown:c,onTouchStart:c,onMouseEnter:d},{children:[n.icon&&(0,i.jsx)(a,{className:"select-menu-icon",name:n.icon,style:n.iconStyle}),n.text]}))}const ft=Object.freeze({white:"#FFF",moonrock:"#F5F4F3",mirror:"#DADADA",sine:"#B5B4B3",cosine:"#999",tangent:"#6D6D6D",lens:"#444",portal:"#222",laser:"#FF3158"}),gt=Object.freeze({neutron:"#5C7FFF",naiad:"#8BBBFF",neptune:"#385DFF",triton:"#0000EA",proton:"#00A170",sputnik:"#00CC8C",earth:"#007D57",iss:"#006644",electron:"#FFBB00",ring:"#FFDD55",saturn:"#C99100",titan:"#906900",gamma:"#FA5300",deimos:"#FF9955",mars:"#C74200",phobos:"#AA3300"});Object.freeze({heliosphere:"#CA003D",mesosphere:"#990033",exosphere:"#660022",thermosphere:"#D22288",troposphere:"#A727D7",noosphere:"#7733F3",atmosphere:"#1A298C",stratosphere:"#1333CC",hydrosphere:"#1444FF",biosphere:"#006EE1",geosphere:"#0090C0",ecosphere:"#00AFAA",lithosphere:"#00705D",athenosphere:"#004844"}),Object.freeze({primary:ft,semantic:gt});var vt;!function(e){e.JUSTIFY="justify",e.LEFT="left",e.RIGHT="right"}(vt||(vt={}));const yt=document.getElementById("react-overlay-root")||document.body,bt=({target:e,className:t,isOpen:n,onCancel:s,onChange:a,options:l=[],selectedOptionId:c="",focusedOptionId:d="",setFocusedOptionId:u,autoFocus:h,filterText:p,onKeyDown:m,align:f=vt.JUSTIFY})=>{const[g,v]=(0,o.useState)(null),[y,b]=(0,o.useState)(0),{styles:S,attributes:E}=Ee(e,g,{placement:f===vt.RIGHT?"bottom-end":"bottom-start",strategy:"fixed",modifiers:[{name:"flip"},{name:"hide"},{name:"offset",options:{offset:[0,8]}}]}),[T,w]=(0,o.useState)(!1),x=f===vt.JUSTIFY,_=(0,o.useCallback)((e=>{a(e)}),[a]),M=(0,o.useCallback)((e=>{u&&u(e.id)}),[u]),O=(0,o.useCallback)((()=>{w(!0)}),[w]),A=(0,o.useCallback)((()=>{w(!1)}),[w]);(0,o.useLayoutEffect)((()=>{if(x&&n&&e){const{width:t}=e.getBoundingClientRect();b(t)}return()=>{}}),[n,x,e]),(0,o.useEffect)((()=>{const t=t=>{!!e&&!t.composedPath().includes(e)&&s()};return n&&g?window.addEventListener("click",t):window.removeEventListener("click",t),()=>{window.removeEventListener("click",t)}}),[n,g,e,s]),(0,o.useEffect)((()=>(n&&h&&g&&g.focus(),()=>{})),[h,n,g]);const C=(0,o.useMemo)((()=>p?l.filter((e=>-1!==e.text.toLowerCase().indexOf(p.toLowerCase()))):l),[l,p]),N=x?Math.min(y,280):void 0;return(0,i.jsx)(i.Fragment,{children:(0,Ne.createPortal)(n&&C.length&&(0,i.jsx)("div",Object.assign({style:Object.assign(Object.assign({},S.popper),{width:N})},E.popper,{ref:v,tabIndex:-1,onKeyDown:m,className:r()("nova-select-menu",t,{"has-focus":T}),onFocus:O,onBlur:A},{children:C.map((e=>(0,i.jsx)(mt,{option:e,isSelected:e.id===c,isActive:e.id===d,onSelect:_,onHover:M},e.id)))})),yt)})},St=({items:e=[],focusedItemId:t,selectedItemId:n,onItemFocused:i,onItemSelected:s,onCancel:r})=>{const a=(0,o.useMemo)((()=>e.map((e=>e.id))),[e]),l=e.length;(0,o.useEffect)((()=>{i(e.length>0?e[0].id:"")}),[e,i]);const c=(0,o.useCallback)(((e=!1)=>{let s=(a.indexOf(t||n||"")+(e?1:-1))%l;s<0&&(s=l-1),i(a[s])}),[t,n,i,a,l]);return(0,o.useCallback)((e=>{let n=!1;switch(e.code){case"ArrowDown":c(!0),n=!0;break;case"ArrowUp":c(!1),n=!0;break;case"Escape":r(),n=!0;break;case"Enter":t&&(s(t),n=!0)}return n&&e.preventDefault(),n}),[t,c,s,r])};var Et=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};const Tt=(0,o.forwardRef)(((e,t)=>{var{options:n=[],onChange:s,clearOnSelect:a=!1,insertOnSelect:l=!1,onBlur:c,onFocus:d,onKeyDown:u,onKeyUp:h,onPaste:p}=e,m=Et(e,["options","onChange","clearOnSelect","insertOnSelect","onBlur","onFocus","onKeyDown","onKeyUp","onPaste"]);const[f,g]=(0,o.useState)(null),v=(0,o.useRef)(null),y=(0,o.useRef)(null),[b,S]=(0,o.useState)(""),[E,T]=(0,o.useState)(""),[w,x]=(0,o.useState)(!1);(0,o.useImperativeHandle)(t,(()=>({focus:()=>{var e;null===(e=v.current)||void 0===e||e.focus()},blur:()=>{var e;null===(e=v.current)||void 0===e||e.blur()},clear:()=>{S("")}})),[v,S]);const _=(0,o.useMemo)((()=>b?n.filter((e=>-1!==e.text.toLowerCase().indexOf(b.toLowerCase()))):n),[n,b]),M=(0,o.useCallback)((e=>{const t="string"==typeof e;t&&0===e.trim().length||(s(e),x(!1),a?S(""):!t&&l&&S(e.text),cancelAnimationFrame(y.current||0),y.current=requestAnimationFrame((()=>{var e;null===(e=v.current)||void 0===e||e.focus()})))}),[s,a,l]),O=(0,o.useCallback)((e=>{if(e){const t=_.find((t=>t.id===e));t&&M(t)}}),[M,_]),A=(0,o.useCallback)((()=>{var e;x(!1),null===(e=v.current)||void 0===e||e.blur()}),[v]),C=St({items:_,focusedItemId:E,onItemFocused:T,onItemSelected:O,onCancel:A}),N=(0,o.useCallback)((e=>{let t=!1;return u&&(t=u(e)),t||(t=C(e)),t}),[u,C]),D=(0,o.useCallback)((e=>{x(!0),d&&d(e)}),[d]),I=(0,o.useCallback)((e=>{c&&c(e),A()}),[c,A]),L=(0,o.useCallback)((e=>{p&&p(e),S(e)}),[p,S]),P=(0,o.useCallback)((e=>{O(e.id)}),[O]);return(0,i.jsxs)("div",Object.assign({className:r()("nova-typeahead-input"),ref:g},{children:[(0,i.jsx)(pt,Object.assign({},m,{ref:v,text:b,onInput:S,onReturn:M,onCancel:A,onFocus:D,onBlur:I,onKeyDown:N,onKeyUp:h,onPaste:L})),(0,i.jsx)(bt,{options:_,target:f,isOpen:w,onCancel:A,onChange:P,filterText:b,focusedOptionId:E,setFocusedOptionId:T,autoFocus:!1})]}))}));var wt=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};const xt=e=>{var{className:t,buttonClassName:n="button-select-anchor",onChange:s,selectedOptionId:l="",options:c=[],children:d,placeholder:u="Choose an option...",selectMenuClassName:h,align:p=vt.LEFT}=e,m=wt(e,["className","buttonClassName","onChange","selectedOptionId","options","children","placeholder","selectMenuClassName","align"]);const[f,g]=(0,o.useState)(null),[v,y]=(0,o.useState)(!1),[b,S]=(0,o.useState)(""),E=(0,o.useCallback)((e=>{null==e||e.stopPropagation(),y(!1),S("")}),[]),T=(0,o.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),y(!v)}),[v]),w=(0,o.useCallback)((e=>{s(e),E()}),[E,s]),x=(0,o.useCallback)((e=>{const t=c.find((t=>t.id===e));t&&w(t)}),[c,w]),_=St({items:c,focusedItemId:b,selectedItemId:l,onItemFocused:S,onItemSelected:x,onCancel:E}),M=(0,o.useMemo)((()=>l&&c.find((e=>e.id===l))),[l,c]);return(0,i.jsxs)("div",Object.assign({className:r()("nova-button-select",t),ref:g},{children:[(0,i.jsxs)(_e,Object.assign({},m,{onClick:T,className:r()(n,{"is-open":v}),onKeyDown:_},{children:[M?(0,i.jsxs)(i.Fragment,{children:[M.icon&&(0,i.jsx)(a,{className:"select-menu-icon",name:M.icon,style:M.iconStyle}),(0,i.jsx)("span",Object.assign({className:"selection-text"},{children:M.text}))]}):(0,i.jsx)("span",Object.assign({className:"select-placeholder"},{children:u})),(0,i.jsx)(a,{className:"select-caret",name:"dpad-down"})]})),(0,i.jsx)(bt,{target:f,isOpen:v,className:h,onCancel:E,onChange:w,onKeyDown:_,selectedOptionId:l,focusedOptionId:b,setFocusedOptionId:S,align:p,options:c,autoFocus:!1})]}))};var _t=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};const Mt=e=>{var{selectedColor:t,options:n,onChange:s,noSelectionText:r="Choose a color..."}=e,a=_t(e,["selectedColor","options","onChange","noSelectionText"]);const l=(0,o.useMemo)((()=>n.map((e=>Object.assign(Object.assign({},e),{icon:"simple-tag",iconStyle:{color:`${e.value}`}})))),[n]),c=(0,o.useCallback)((e=>{s(e.id)}),[s]);return(0,i.jsx)(xt,Object.assign({className:"nova-color-select",options:l,onChange:c,selectMenuClassName:"color-select-menu",selectedOptionId:t},a,{children:t||r}))};var Ot=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};const At=(0,o.forwardRef)(((e,t)=>{var{allowSelect:n,isSelected:s,isFocused:c,onClick:d,onFocus:u,onRemoveClick:h,className:p,size:m="standard",theme:f="light"}=e,g=Ot(e,["allowSelect","isSelected","isFocused","onClick","onFocus","onRemoveClick","className","size","theme"]);const v=(0,o.useRef)(null);(0,o.useImperativeHandle)(t,(()=>({focus:()=>{var e;null===(e=v.current)||void 0===e||e.focus()}})),[v]);const y=(0,o.useCallback)((()=>{h&&h(g)}),[h,g]),b=(0,o.useCallback)((e=>{var t;null===(t=v.current)||void 0===t||t.focus(),d&&d(g,e)}),[d,g]),S=(0,o.useCallback)((e=>{u&&u(g)}),[u,g]),E=void 0!==g.count;return(0,i.jsxs)("div",Object.assign({className:r()("nova-token",`token-size-${m}`,`token-theme-${f}`,p,{"is-selected":s,"is-focused":c,"has-count":E,"can-select":n,"can-remove":!!h}),title:g.text,onClick:b,onFocus:S,tabIndex:0,ref:v,"data-token-id":g.id},{children:[n&&s&&(0,i.jsx)(a,{size:l.SMALL,name:"checkmark"}),(0,i.jsx)("div",Object.assign({className:"token-text"},{children:g.text})),E&&(0,i.jsx)("div",Object.assign({className:"token-count"},{children:g.count})),!!h&&(0,i.jsx)(_e,{onClick:y,icon:"close",size:"small"})]}))})),Ct=({tokens:e,className:t,allowSelect:n,maxVisibleTruncated:s,selectedTokenIds:a=[],onTokenClick:l,tokenSize:c,tokenTheme:d})=>{const[u,h]=(0,o.useState)(!1),p=(0,o.useCallback)(((e,t)=>{h(!u)}),[h,u]),m=!!s,f=(0,o.useMemo)((()=>m&&e.length-s),[e,s,m]),g=(0,o.useMemo)((()=>u?e:e.slice(0,s)),[e,s,u]);return g.length>0?(0,i.jsxs)("div",Object.assign({className:r()("nova-token-list",t,{"is-viewing-all":u})},{children:[g.map((e=>(0,o.createElement)(At,Object.assign({},e,{isSelected:e.isSelected||a.includes(e.id),key:e.id,onClick:l,allowSelect:n,size:c,theme:d})))),m&&e.length>s&&(0,i.jsx)(At,{className:"view-more-btn",onClick:p,size:c,theme:d,id:"_token_list_view_more_btn",text:u?`Hide ${f}...`:`View ${f} more...`})]})):null};var Nt=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};const Dt=function*(){let e=0;for(;;)yield e++}(),It=["Backspace","Delete","ArrowLeft","ArrowRight"],Lt=()=>{},Pt=(0,o.forwardRef)(((e,t)=>{var{initialTokens:n=[],options:s=[],placeholder:a="+ Add",onChange:l,maxTokens:c,maxTokensValidationMsg:d="Maximum tokens added",helpMessage:u,tokenDisplayName:h="Token",validateNewToken:p=Lt}=e,m=Nt(e,["initialTokens","options","placeholder","onChange","maxTokens","maxTokensValidationMsg","helpMessage","tokenDisplayName","validateNewToken"]);const f=(0,o.useRef)(null),g=(0,o.useRef)(null),[v,y]=(0,o.useState)(),[b,S]=(0,o.useState)(n),[E,T]=(0,o.useState)(),[w,x]=(0,o.useState)(!1),_=(0,o.useMemo)((()=>b.findIndex((e=>e.id===v))),[v,b]);(0,o.useImperativeHandle)(t,(()=>({focus:()=>{var e;null===(e=g.current)||void 0===e||e.focus()},blur:()=>{var e;null===(e=g.current)||void 0===e||e.blur()}})),[g]);const M=(0,o.useCallback)((()=>{var e;null===(e=g.current)||void 0===e||e.focus()}),[g]),O=(0,o.useCallback)((e=>b.some((t=>e===t.text))?`${h} "${e}" would duplicate an existing value.`:void 0),[b,h]),A=(0,o.useCallback)((e=>{const t=O(e)||p(e);return T(t),!t}),[p,O,T]),C=(0,o.useCallback)((e=>{var t;let n=!1;"string"==typeof e?(n=A(e),n&&S([...b,{text:e,id:`new_token_${Dt.next().value}`}])):(n=!0,S([...b,e])),n&&(null===(t=g.current)||void 0===t||t.clear())}),[b,A]),N=(0,o.useCallback)((e=>{S(b.filter((t=>t.id!==e)))}),[b]),D=(0,o.useCallback)((e=>{if(f.current){f.current.querySelector(`[data-token-id="${e}"]`).focus()}}),[f]),I=(0,o.useCallback)((e=>{var t,n,i;e.stopPropagation();const s=b.length-1,r=e.code,o="Backspace"===r||"Delete"===r,a="ArrowLeft"===r,l="ArrowRight"===r;if(v){if(o){N(v),y("");const e=_-1;e>-1&&D(b[e].id)}else if(l)if(_===s)M();else{D(b[_+1].id)}else if(a){const e=_-1;-1===e?null===(n=(t=document.activeElement).blur)||void 0===n||n.call(t):D(b[e].id)}}else b.length>0&&(o||a)&&D(b[b.length-1].id);"Escape"===r&&(null===(i=f.current)||void 0===i||i.blur())}),[N,v,b,_,M,D]),L=(0,o.useCallback)((e=>{const{selectionStart:t,selectionEnd:n}=e.target,i=0===t&&t===n;return e.stopPropagation(),It.includes(e.code)&&i&&I(e),!1}),[I]),P=(0,o.useCallback)((e=>{const{value:t}=e.target;A(t)}),[A]),R=(0,o.useCallback)((e=>{A(e)}),[A]),k=(0,o.useCallback)((e=>{N(e.id)}),[N]),U=(0,o.useCallback)((e=>{const{id:t}=e;y(t),x(!0)}),[]),B=(0,o.useCallback)((()=>{y(""),x(!0)}),[]),F=(0,o.useCallback)((()=>{x(!1),y("")}),[]);(0,o.useEffect)((()=>(l&&l(b),()=>{})),[b,l]);const V=(0,o.useMemo)((()=>{const e=b.map((e=>e.id));return s.filter((t=>!e.includes(t.id)))}),[s,b]),H=void 0!==c&&b.length>=c,j=H&&d?d:E||u;return(0,i.jsxs)("div",Object.assign({className:r()("nova-token-input",{"has-focus":w,"has-warning":H,"has-error":!!E}),onKeyDown:I,onBlur:F,tabIndex:2,ref:f},{children:[(0,i.jsxs)("div",Object.assign({className:"nova-token-input-container"},{children:[b.map((e=>(0,i.jsx)(At,Object.assign({isFocused:e.id===v,onFocus:U,onRemoveClick:k},e),e.id))),!H&&(0,i.jsx)(Tt,Object.assign({},m,{ref:g,options:V,onChange:C,placeholder:a,onFocus:B,onBlur:F,onKeyDown:L,onKeyUp:P,onPaste:R}))]})),(0,i.jsxs)("div",Object.assign({className:"nova-input-help"},{children:[(0,i.jsxs)("span",Object.assign({className:"nova-input-counter"},{children:[b.length,void 0!==c&&c>0&&(0,i.jsxs)(i.Fragment,{children:["/",c]})]})),j&&(0,i.jsx)("span",Object.assign({className:"nova-helper-text"},{children:j}))]}))]}))}))},72187:(e,t,n)=>{"use strict";var i,s;n.d(t,{a_:()=>OEmbedConsumer,t1:()=>OEmbedLinkError,HF:()=>OEmbedProviderError,ht:()=>s,V0:()=>m}),function(e){e.Behance="behance",e.DailyMotion="dailymotion",e.FaceBook="facebook",e.Flickr="flickr",e.Giphy="giphy",e.GoogleMaps="google maps",e.Instagram="instagram",e.LinkedIn="linkedin",e.Matterport="matterport",e.MixCloud="mixcloud",e.Pinterest="pinterest",e.Reddit="reddit",e.SoundCloud="soundcloud",e.SketchFab="sketchfab",e.Spotify="spotify",e.Tenor="tenor",e.TikTok="tiktok",e.Twitter="twitter",e.Tumblr="tumblr",e.Vimeo="vimeo",e.YouTube="youtube"}(i||(i={})),function(e){e.PHOTO="photo",e.VIDEO="video",e.LINK="link",e.RICH="rich"}(s||(s={}));class OEmbedConsumerError extends Error{constructor(e,t,n){super(e),this.status=t,this.type=n,Error.captureStackTrace&&Error.captureStackTrace(this,OEmbedConsumerError)}}class OEmbedUrlError extends OEmbedConsumerError{constructor(e){super(`Cannot request OEmbed data because no configuration matches the url ${e}`,200,"OEmbedUrl")}}class OEmbedProviderError extends OEmbedConsumerError{constructor(e="unknown provider"){super(`Content from OEmbed provider ${e} is not currently supported`,200,"OEmbedProvider")}}class OEmbedLinkError extends OEmbedConsumerError{constructor(e="unknown provider"){super(`Content from ${e} is type "link", which Link content is not currently supported`,200,"OEmbedLink")}}function r(e){const t=Math.max(window.screen.height,window.screen.width);return{queryParams:new URLSearchParams({maxWidth:`${t}`,maxHeight:`${t}`,url:e}),headers:{responseType:"json"}}}const o=/^https:\/\/www.instagram.com/;const a=/^https:\/\/www.facebook.com/,l=/^https:\/\/www.facebook.com\/(.*\/)?(posts\/|activity\/|photo\.php|photos\/|permalink\.php|media\/set|questions\/|notes\/)/,c=/^https:\/\/www.facebook.com\/(video\.php|.*\/videos\/)/;const d=[{testUrl:function(e){return o.test(e)},request:async function(e,t,n,i){const{queryParams:s,headers:o}=r(e);n&&i&&s.append("access_token",`${n}|${i}`);const a=new URL(`https://graph.facebook.com/v10.0/instagram_oembed?${s.toString()}`);try{return await t.get(a.toString(),o)}catch(e){const t=e;throw new OEmbedConsumerError(t.error.message,t.status_code,t.error.type)}},apiKeys:["instagramAppId","instagramClientToken"]},{testUrl:function(e){return a.test(e)},request:async function(e,t,n,i){const{queryParams:s,headers:o}=r(e);n&&i&&s.append("access_token",`${n}|${i}`);const a=function(e){return l.test(e)?"https://graph.facebook.com/v10.0/oembed_post":c.test(e)?"https://graph.facebook.com/v10.0/oembed_video":"https://graph.facebook.com/v10.0/oembed_page"}(e),d=new URL(`${a}?${s.toString()}`);try{return await t.get(d.toString(),o)}catch(e){const t=e;throw new OEmbedConsumerError(t.error.message,t.status_code,t.error.type)}},apiKeys:["instagramAppId","instagramClientToken"]},{testUrl:()=>!0,request:async function(e,t,n){const{queryParams:i,headers:s}=r(e);n&&i.append("key",n);const o=new URL(`https://api.embed.ly/1/oembed?${i.toString()}`);try{return await t.get(o.toString(),s)}catch(e){const t=e;throw new OEmbedConsumerError(t.error_message,t.status_code,t.type)}},apiKeys:["embedlyKey"]}];const u={[i.GoogleMaps]:function(e,t){return e.thumbnail_url&&(e.thumbnail_url=`${e.thumbnail_url}&key=${t.googleMapsApiKey}`),e}};const h={[i.Behance]:!1,[i.FaceBook]:!1,[i.GoogleMaps]:"googleMapsApiKey",[i.Instagram]:["instagramAppId","instagramClientToken"],[i.LinkedIn]:!1,[i.MixCloud]:!1,[i.Pinterest]:!1,[i.Reddit]:!1,[i.TikTok]:!1,[i.Twitter]:!1};class OEmbedConsumer{constructor(e,t){this.cache={},this.queue=e,this.apiKeys=t}async getOEmbedData(e){if(this.cache[e])return this.validate(this.cache[e]);const t=await function(e,t,n){for(const i of d)if(i.testUrl(e)){const s=i.apiKeys.map((e=>n[e]));return i.request(e,t,...s)}throw new OEmbedUrlError(e)}(e,this.queue,this.apiKeys);return this.cache[e]=t,this.validate(t)}clearCache(){this.cache={}}validate(e){if(!((e,t)=>{const n=void 0===e.provider_name?void 0:h[e.provider_name.toLowerCase()];return"string"==typeof n?!!t[n]:Array.isArray(n)?n.every((e=>!!t[e])):!1!==n})(e,this.apiKeys))throw new OEmbedProviderError(e.provider_name);if(e.type===s.LINK)throw new OEmbedLinkError(e.provider_name);return function(e,t){if(void 0===e.provider_name)return e;const n=u[e.provider_name.toLowerCase()];return n?n(e,t):e}(e,this.apiKeys)}}const p=/[^]*youtube.com\/shorts\//gi,m=e=>{if(p.test(e)){return`https://youtube.com/watch?v=${e.replace(p,"").replace(/\?(.*)/g,"")}`}return e}},40470:(e,t,n)=>{"use strict";n.d(t,{U7:()=>AcceptMessage,fE:()=>AcceptObserver_AcceptObserver,HE:()=>ConnectMessage_ConnectMessage,OR:()=>ConnectMessageObserver,RS:()=>HandshakeMessage,tK:()=>i,pP:()=>s,HX:()=>RejectMessage,MJ:()=>RejectObserver_RejectObserver});n(6015);var i,s,r,o,a=n(1154);!function(e){const t=new a.M;e.connect=async function(e,n,i){let s;try{s=await e.connect()}finally{e.cancelConnecting()}return function(e,t,n,i){return new t(n,e).build(i)}(i,await async function(e){if(!e)throw new Error("Unabled to load the sdk");try{const n=await t.load(e,"sdk-client");if(n&&n.SdkBuilder&&"function"==typeof n.SdkBuilder)return n.SdkBuilder}catch(e){}throw Error(`Could not load the sdk from ${e}`)}(s.scriptUrl),n.getFactory(s),s.serializedInterface)}}(i||(i={})),function(e){e.CONNECT="postmessage.connect"}(s||(s={})),function(e){e.HANDSHAKE="postmessage.handshake",e.ACCEPT="postmessage.accept",e.REJECT="postmessage.reject"}(r||(r={}));class ConnectMessage_ConnectMessage{constructor(e,t){this.type=s.CONNECT,this.payload={bootstrapVersion:e,applicationKey:t.applicationKey,options:{auth:t.auth}}}}class AcceptObserver_AcceptObserver{constructor(e){this.receiver=e,this.messageType=r.ACCEPT}notify(e,t,n){const{sourceId:i,scriptUrl:s,targetId:r,targetOrigin:o}=e,a=e.interface;this.receiver.accept(i,s,a,r,o)}}class RejectObserver_RejectObserver{constructor(e){this.receiver=e,this.messageType=r.REJECT}notify(e,t,n){this.receiver.reject(e.reason)}}!function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.HANDSHAKE=2]="HANDSHAKE",e[e.CONNECTED=3]="CONNECTED",e[e.REJECTED=4]="REJECTED"}(o||(o={}));class HandshakeMessage{constructor(){this.type=r.HANDSHAKE,this.payload={}}}class AcceptMessage{constructor(e,t,n,i,s){this.type=r.ACCEPT,this.payload={scriptUrl:e,interface:t,sourceId:n,targetId:i,targetOrigin:s},this.interface=t}}class RejectMessage{constructor(e){this.type=r.REJECT,this.payload={reason:e},this.reason=e}}class ConnectMessageObserver{constructor(e){this.receiver=e,this.messageType=s.CONNECT}notify(e,t){this.receiver.onConnectionReceived(e,t)}}},6157:(e,t,n)=>{"use strict";n(84759);var i;n(66745);!function(e){e[e.POSTMESSAGE=1]="POSTMESSAGE"}(i||(i={}))},66745:(e,t,n)=>{"use strict";var i;!function(e){e.LOADED="inject.loaded",e.SETUP="inject.setup",e.RESOLVE="inject.resolve"}(i||(i={}))},90614:(e,t,n)=>{"use strict";var i;n.d(t,{dE:()=>i}),function(e){e.CAMERA="sensor.sensortype.camera"}(i||(i={}))},44155:(e,t,n)=>{"use strict";n.d(t,{PO:()=>i});var i;!function(e){e.SPHERE="sensor.sourcetype.sphere",e.BOX="sensor.sourcetype.box",e.CYLINDER="sensor.sourcetype.cylinder"}(i||(i={}))},6015:(e,t,n)=>{"use strict";n.d(t,{UX:()=>DirectMessageFactory,tY:()=>DirectMessageListener,Ej:()=>DirectMessageNode,l:()=>PostMessageFactory,R9:()=>PostMessageListener,TY:()=>UndirectedMessenger});class BridgeObserver{constructor(e){this.messageReceiver=e}notify(e,t){this.messageReceiver.onMessageReceived(e,t)}}var i=n(84759);class ErrorMessageBridge{listen(){}stopListening(){}send(){throw Error("The sdk has been disconnected and can't make any new calls")}}class Messenger{constructor(e,t,n){this.sourceId=e,this.targetId=t,this.messageBridge=n,this.observers=new i.X}init(){const e=new class MessengerFacade{constructor(e){this.messenger=e}onMessageReceived(e,t){this.messenger.onMessageReceived(e,t)}}(this),t=new BridgeObserver(e);this.messageBridge.listen(t)}dispose(){this.messageBridge.stopListening(),this.messageBridge=new ErrorMessageBridge}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e){const t=this.sourceId,n=this.targetId;this.messageBridge.send(Object.assign(Object.assign({},e),{fromId:t,toId:n,timestamp:Date.now()}))}onMessageReceived(e,t){if(!this.filterMessageId(e))return;const n=e.type,i=this.observers.getValuesAtKey(n);if(i)for(const n of i){const i=e.payload||e;n.notify(i,t,e.timestamp)}}filterMessageId(e){const t=e.toId,n=e.fromId;return t instanceof Array?t.indexOf(this.sourceId)>-1:(void 0===t||t===this.sourceId)&&n===this.targetId}}class UndirectedMessenger{constructor(e,t){this.sourceId=e,this.listenerBridge=t,this.observers=new i.X}init(){const e=new class UndirectedFacade{constructor(e){this.messenger=e}onMessageReceived(e,t){this.messenger.onMessageReceived(e,t)}}(this),t=new BridgeObserver(e);this.listenerBridge.listen(t)}dispose(){this.listenerBridge.stopListening()}addObserver(e){this.observers.add(e.messageType,e)}removeObserver(e){this.observers.remove(e.messageType,e)}send(e,t,n,i){n.send(Object.assign(Object.assign({},e),{fromId:this.sourceId,toId:t,timestamp:Date.now()}),i)}onMessageReceived(e,t){const n=e.type,i=this.observers.getValuesAtKey(n);if(i)for(const n of i){const i=e.payload||e;n.notify(i,t,e.timestamp)}}}class PostMessageListener{constructor(e){this.targetWindow=e,this.messageObserver=null,this.onMessage=e=>{if(this.messageObserver){const t=e.data;this.messageObserver.notify(Object.assign({},t),{id:t.fromId,origin:e.origin,source:e.source},e.data.timestamp)}}}listen(e){this.messageObserver||(this.messageObserver=e,this.targetWindow.addEventListener("message",this.onMessage))}stopListening(){this.targetWindow.removeEventListener("message",this.onMessage),this.messageObserver=null}}class PostMessageSender{constructor(e,t="*"){this.targetWindow=e,this.targetOrigin=t}send(e,t){this.targetWindow.postMessage(e,this.targetOrigin)}}class PostMessageBridge{constructor(e,t,n="*"){this.sourceWindow=e,this.listener=new PostMessageListener(e),this.sender=new PostMessageSender(t,n)}listen(e){this.listener.listen(e)}stopListening(){this.listener.stopListening()}send(e){this.sender.send(e,this.sourceWindow)}}class PostMessageFactory{constructor(e,t,n,i,s="*"){this.sourceId=e,this.sourceWindow=t,this.targetId=n,this.targetWindow=i,this.targetOrigin=s}createMessenger(){const e=new PostMessageBridge(this.sourceWindow,this.targetWindow,this.targetOrigin);return new Messenger(this.sourceId,this.targetId,e)}}class DirectMessageBridge{constructor(e,t){this.source=e,this.target=t,this.messageObserver=null}listen(e){this.messageObserver||(this.messageObserver=e,this.source.addObserver(e))}stopListening(){this.messageObserver&&this.source.removeObserver(this.messageObserver)}send(e){const t=this.target;t&&t.post(Object.assign({},e),this.source)}}class DirectMessageFactory{constructor(e,t,n,i){this.sourceId=e,this.sourceNode=t,this.targetId=n,this.targetNode=i}createMessenger(){const e=new DirectMessageBridge(this.sourceNode,this.targetNode);return new Messenger(this.sourceId,this.targetId,e)}}class DirectMessageNode{constructor(e){this.origin=e,this.observers=new Set}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}post(e,t){for(const n of this.observers)n.notify(e,t)}}class DirectMessageListener{constructor(e){this.targetNode=e,this.messageObserver=null,this.onMessage=(e,t)=>{this.messageObserver&&this.messageObserver.notify({payload:Object.assign({},e.payload),type:e.type},{id:e.fromId,source:t},e.timestamp)}}listen(e){this.messageObserver||(this.messageObserver=e,this.targetNode.addObserver({notify:(e,t)=>{this.onMessage(e,t)}}))}stopListening(){this.messageObserver=null}}},31511:(e,t,n)=>{"use strict";var i,s,r,o,a,l,c,d,u,h,p,m,f,g,v;n.d(t,{kJ:()=>o,Uv:()=>c,AR:()=>d}),function(e){let t,n,i;!function(e){e.PHASE_CHANGE="application.phasechange"}(t=e.Event||(e.Event={})),function(e){e.UNINITIALIZED="appphase.uninitialized",e.WAITING="appphase.waiting",e.LOADING="appphase.loading",e.STARTING="appphase.starting",e.PLAYING="appphase.playing",e.ERROR="appphase.error"}(n=e.Phase||(e.Phase={})),function(e){e.SHOWCASE="application.showcase"}(i=e.Application||(e.Application={}))}(i||(i={})),function(e){let t,n;!function(e){e.MOVE="camera.move"}(t=e.Event||(e.Event={})),function(e){e.FORWARD="FORWARD",e.LEFT="LEFT",e.RIGHT="RIGHT",e.BACK="BACK",e.UP="UP",e.DOWN="DOWN"}(n=e.Direction||(e.Direction={}))}(s||(s={})),function(e){let t;!function(e){e.CHANGE_START="floors.changestart",e.CHANGE_END="floors.changeend"}(t=e.Event||(e.Event={}))}(r||(r={})),function(e){let t;!function(e){e.SUCCESS="astar.status.success",e.NO_PATH="astar.status.no_path",e.TIMEOUT="astar.status.timeout",e.NO_START_VERTEX="astar.status.no_start",e.NO_END_VERTEX="astar.status.no_end"}(t=e.AStarStatus||(e.AStarStatus={}))}(o||(o={})),function(e){let t;!function(e){e.POSITION_UPDATED="label.positionupdated"}(t=e.Event||(e.Event={}))}(a||(a={})),function(e){let t,n;!function(e){e.WINDOW="link.creationpolicy.window",e.REFERRER="link.creationpolicy.referrer",e.MATTERPORT="link.creationpolicy.matterport"}(t=e.CreationPolicy||(e.CreationPolicy={})),function(e){e.DEFAULT="link.openpolicy.deafult",e.NEW_WINDOW="link.openpolicy.newwindow",e.SAME_FRAME="link.openpolicy.sameframe",e.CURRENT_WINDOW="link.openpolicy.current"}(n=e.OpenPolicy||(e.OpenPolicy={}))}(l||(l={})),function(e){let t,n,i,s,r;!function(e){e.INSTANT="transition.instant",e.FLY="transition.fly",e.FADEOUT="transition.fade"}(t=e.Transition||(e.Transition={})),function(e){e.NAVIGATION="tag.link.nav",e.MODEL="tag.link.model",e.EXT_LINK="tag.link.ext"}(n=e.LinkType||(e.LinkType={})),function(e){e.NONE="tag.chunk.none",e.TEXT="tag.chunk.text",e.LINK="tag.chunk.link"}(i=e.DescriptionChunkType||(e.DescriptionChunkType={})),function(e){e.HOVER="tag.hover",e.CLICK="tag.click",e.LINK_OPEN="tag.linkopen"}(s=e.Event||(e.Event={})),function(e){e.NONE="mattertag.media.none",e.PHOTO="mattertag.media.photo",e.VIDEO="mattertag.media.video",e.RICH="mattertag.media.rich"}(r=e.MediaType||(e.MediaType={}))}(c||(c={})),function(e){let t,n,i;!function(e){e.INSIDE="mode.inside",e.OUTSIDE="mode.outside",e.DOLLHOUSE="mode.dollhouse",e.FLOORPLAN="mode.floorplan",e.TRANSITIONING="mode.transitioning"}(t=e.Mode||(e.Mode={})),function(e){e.CHANGE_START="viewmode.changestart",e.CHANGE_END="viewmode.changeend"}(n=e.Event||(e.Event={})),function(e){e.INSTANT="transition.instant",e.FLY="transition.fly",e.FADEOUT="transition.fade"}(i=e.TransitionType||(e.TransitionType={}))}(d||(d={})),function(e){let t;!function(e){e.MODEL_LOADED="model.loaded"}(t=e.Event||(e.Event={}))}(u||(u={})),function(e){let t;!function(e){e.NONE="intersectedobject.none",e.MODEL="intersectedobject.model",e.TAG="intersectedobject.tag",e.SWEEP="intersectedobject.sweep",e.UNKNOWN="intersectedobject.unknown"}(t=e.Colliders||(e.Colliders={}))}(h||(h={})),function(e){let t,n;!function(e){e.CLICK="INTERACTION.CLICK",e.HOVER="INTERACTION.HOVER",e.DRAG="INTERACTION.DRAG",e.DRAG_BEGIN="INTERACTION.DRAG_BEGIN",e.DRAG_END="INTERACTION.DRAG_END",e.POINTER_MOVE="INTERACTION.POINTER_MOVE",e.POINTER_BUTTON="INTERACTION.POINTER_BUTTON",e.SCROLL="INTERACTION.SCROLL",e.KEY="INTERACTION.KEY",e.LONG_PRESS_START="INTERACTION.LONG_PRESS_START",e.LONG_PRESS_END="INTERACTION.LONG_PRESS_END",e.MULTI_SWIPE="INTERACTION.MULTI_SWIPE",e.MULTI_SWIPE_END="INTERACTION.MULTI_SWIPE_END",e.PINCH="INTERACTION.PINCH",e.PINCH_END="INTERACTION.PINCH_END",e.ROTATE="INTERACTION.ROTATE",e.ROTATE_END="INTERACTION.ROTATE_END"}(t=e.InteractionType||(e.InteractionType={})),function(e){e.INPUT="input",e.OUTPUT="output",e.EVENT="event",e.EMIT="emit"}(n=e.PathType||(e.PathType={}))}(p||(p={})),function(e){let t,n;!function(e){e.CAMERA="sensor.sensortype.camera"}(t=e.SensorType||(e.SensorType={})),function(e){e.SPHERE="sensor.sourcetype.sphere",e.BOX="sensor.sourcetype.box",e.CYLINDER="sensor.sourcetype.cylinder"}(n=e.SourceType||(e.SourceType={}))}(m||(m={})),function(e){let t,n,i,s;!function(e){e.ENTER="sweep.enter",e.EXIT="sweep.exit"}(t=e.Event||(e.Event={})),function(e){e.INSTANT="transition.instant",e.FLY="transition.fly",e.FADEOUT="transition.fade"}(n=e.Transition||(e.Transition={})),function(e){e.ALIGNED="aligned",e.UNALIGNED="unaligned"}(i=e.Alignment||(e.Alignment={})),function(e){e.UNPLACED="unplaced",e.AUTO="auto",e.MANUAL="manual"}(s=e.Placement||(e.Placement={}))}(f||(f={})),function(e){let t,n;!function(e){e.UNKNOWN="tag.attachment.unknown",e.APPLICATION="tag.attachment.application",e.AUDIO="tag.attachment.audio",e.IMAGE="tag.attachment.image",e.MODEL="tag.attachment.model",e.PDF="tag.attachment.pdf",e.RICH="tag.attachment.rich",e.TEXT="tag.attachment.text",e.VIDEO="tag.attachment.video",e.ZIP="tag.attachment.zip",e.SANDBOX="tag.attachment.sandbox"}(t=e.AttachmentType||(e.AttachmentType={})),function(e){e.IMAGE="tag.attachment.image",e.RICH="tag.attachment.rich",e.VIDEO="tag.attachment.video"}(n=e.AttachmentDescriptorType||(e.AttachmentDescriptorType={}))}(g||(g={})),function(e){let t,n;!function(e){e.STARTED="tour.started",e.STOPPED="tour.stopped",e.ENDED="tour.ended",e.STEPPED="tour.stepped"}(t=e.Event||(e.Event={})),function(e){e.INACTIVE="tour.inactive",e.ACTIVE="tour.active",e.STOP_SCHEDULED="tour.stopscheduled"}(n=e.PlayState||(e.PlayState={}))}(v||(v={}))},84759:(e,t,n)=>{"use strict";n.d(t,{X:()=>DictArray});class DictArray{constructor(){this.values={}}add(e,t){this.getValuesAtKey(e).push(t)}remove(e,t){const n=this.values[e];if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1)}}removeKey(e){delete this.values[e]}getValuesAtKey(e){const t=this.values[e]||[];return this.values[e]=t,t}valuesPerKey(e){return this.getValuesAtKey(e).length}find(e,t){return this.values[e]&&this.values[e].find(t)}get keys(){return Object.keys(this.values)}hasKey(e){return e in this.values}has(e,t){return this.hasKey(e)&&this.values[e].includes(t)}*[Symbol.iterator](){for(const e in this.values)for(const t of this.values[e])yield[e,t]}}},28732:(e,t,n)=>{"use strict";function i(e){return"number"==typeof e&&!isNaN(e)}n.d(t,{hj:()=>i})},13855:(e,t,n)=>{"use strict";function i(e,t){return Object.values(e).includes(t)}n.d(t,{p:()=>i})},4951:(e,t,n)=>{"use strict";n.d(t,{u:()=>s});var i=n(28732);function s(e){if(e&&"object"==typeof e&&"x"in e&&"y"in e&&"z"in e){const t=e;return(0,i.hj)(t.x)&&(0,i.hj)(t.y)&&(0,i.hj)(t.z)}return!1}},42238:function(e,t,n){var i;!function(s,r){"use strict";var o="function",a="undefined",l="object",c="model",d="name",u="type",h="vendor",p="version",m="architecture",f="console",g="mobile",v="tablet",y="smarttv",b="wearable",S={extend:function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:r},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={rgx:function(e,t){for(var n,i,s,a,c,d,u=0;u<t.length&&!c;){var h=t[u],p=t[u+1];for(n=i=0;n<h.length&&!c;)if(c=h[n++].exec(e))for(s=0;s<p.length;s++)d=c[++i],typeof(a=p[s])===l&&a.length>0?2==a.length?typeof a[1]==o?this[a[0]]=a[1].call(this,d):this[a[0]]=a[1]:3==a.length?typeof a[1]!==o||a[1].exec&&a[1].test?this[a[0]]=d?d.replace(a[1],a[2]):r:this[a[0]]=d?a[1].call(this,d,a[2]):r:4==a.length&&(this[a[0]]=d?a[3].call(this,d.replace(a[1],a[2])):r):this[a]=d||r;u+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(S.has(t[n][i],e))return"?"===n?r:n}else if(S.has(t[n],e))return"?"===n?r:n;return e}},T={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},w={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6}).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[d,p],[/(opios)[\/\s]+([\w\.]+)/i],[[d,"Opera Mini"],p],[/\s(opr)\/([\w\.]+)/i],[[d,"Opera"],p],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[d,p],[/(konqueror)\/([\w\.]+)/i],[[d,"Konqueror"],p],[/(trident).+rv[:\s]([\w\.]{1,9}).+like\sgecko/i],[[d,"IE"],p],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[d,"Edge"],p],[/(yabrowser)\/([\w\.]+)/i],[[d,"Yandex"],p],[/(Avast)\/([\w\.]+)/i],[[d,"Avast Secure Browser"],p],[/(AVG)\/([\w\.]+)/i],[[d,"AVG Secure Browser"],p],[/(puffin)\/([\w\.]+)/i],[[d,"Puffin"],p],[/(focus)\/([\w\.]+)/i],[[d,"Firefox Focus"],p],[/(opt)\/([\w\.]+)/i],[[d,"Opera Touch"],p],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[d,"UCBrowser"],p],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],p],[/(windowswechat qbcore)\/([\w\.]+)/i],[[d,"WeChat(Win) Desktop"],p],[/(micromessenger)\/([\w\.]+)/i],[[d,"WeChat"],p],[/(brave)\/([\w\.]+)/i],[[d,"Brave"],p],[/(whale)\/([\w\.]+)/i],[[d,"Whale"],p],[/(qqbrowserlite)\/([\w\.]+)/i],[d,p],[/(QQ)\/([\d\.]+)/i],[d,p],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[d,p],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[d,p],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[d,p],[/(MetaSr)[\/\s]?([\w\.]+)/i],[d],[/(LBBROWSER)/i],[d],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[p,[d,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[p,[d,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[d,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[d,p],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[p,[d,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[d,/(.+)/,"$1 WebView"],p],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[d,/(.+(?:g|us))(.+)/,"$1 $2"],p],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[p,[d,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[d,"Sailfish Browser"],p],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[d,p],[/(dolfin)\/([\w\.]+)/i],[[d,"Dolphin"],p],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[d,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[d,"Chrome"],p],[/(coast)\/([\w\.]+)/i],[[d,"Opera Coast"],p],[/fxios\/([\w\.-]+)/i],[p,[d,"Firefox"]],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[p,[d,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[p,d],[/webkit.+?(gsa)\/([\w\.]+)\s.*(mobile\s?safari|safari)(\/[\w\.]+)/i],[[d,"GSA"],p],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[d,[p,E.str,T.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[d,p],[/(navigator|netscape)\/([\w\.-]+)/i],[[d,"Netscape"],p],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[d,p]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,S.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",S.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[m,S.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[c,h,[u,v]],[/applecoremedia\/[\w\.]+ \((ipad)/],[c,[h,"Apple"],[u,v]],[/(apple\s{0,1}tv)/i],[[c,"Apple TV"],[h,"Apple"],[u,y]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[h,c,[u,v]],[/(kf[A-z]+)(\sbuild\/|\)).+silk\//i],[c,[h,"Amazon"],[u,v]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[c,E.str,T.device.amazon.model],[h,"Amazon"],[u,g]],[/android.+aft([bms])\sbuild/i],[c,[h,"Amazon"],[u,y]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[c,h,[u,g]],[/\((ip[honed|\s\w*]+);/i],[c,[h,"Apple"],[u,g]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[h,c,[u,g]],[/\(bb10;\s(\w+)/i],[c,[h,"BlackBerry"],[u,g]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[c,[h,"Asus"],[u,v]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[h,"Sony"],[c,"Xperia Tablet"],[u,v]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[h,"Sony"],[u,g]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[h,c,[u,f]],[/android.+;\s(shield)\sbuild/i],[c,[h,"Nvidia"],[u,f]],[/(playstation\s[34portablevi]+)/i],[c,[h,"Sony"],[u,f]],[/(sprint\s(\w+))/i],[[h,E.str,T.device.sprint.vendor],[c,E.str,T.device.sprint.model],[u,g]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[h,[c,/_/g," "],[u,g]],[/(nexus\s9)/i],[c,[h,"HTC"],[u,v]],[/d\/huawei([\w\s-]+)[;\)]/i,/android.+\s(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?)/i],[c,[h,"Huawei"],[u,g]],[/android.+(bah2?-a?[lw]\d{2})/i],[c,[h,"Huawei"],[u,v]],[/(microsoft);\s(lumia[\s\w]+)/i],[h,c,[u,g]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[c,[h,"Microsoft"],[u,f]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[h,"Microsoft"],[u,g]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[c,[h,"Motorola"],[u,g]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[c,[h,"Motorola"],[u,v]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[h,S.trim],[c,S.trim],[u,y]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[h,"Samsung"],[u,y]],[/\(dtv[\);].+(aquos)/i],[c,[h,"Sharp"],[u,y]],[/android.+((sch-i[89]0\d|shw-m380s|SM-P605|SM-P610|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[h,"Samsung"],c,[u,v]],[/smart-tv.+(samsung)/i],[h,[u,y],c],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[h,"Samsung"],c,[u,g]],[/sie-(\w*)/i],[c,[h,"Siemens"],[u,g]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[h,"Nokia"],c,[u,g]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[c,[h,"Acer"],[u,v]],[/android.+([vl]k\-?\d{3})\s+build/i],[c,[h,"LG"],[u,v]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[h,"LG"],c,[u,v]],[/linux;\snetcast.+smarttv/i,/lg\snetcast\.tv-201\d/i],[[h,"LG"],c,[u,y]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[c,[h,"LG"],[u,g]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[h,c,[u,v]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[c,[h,"Lenovo"],[u,v]],[/(lenovo)[_\s-]?([\w-]+)/i],[h,c,[u,g]],[/linux;.+((jolla));/i],[h,c,[u,g]],[/((pebble))app\/[\d\.]+\s/i],[h,c,[u,b]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[h,c,[u,g]],[/crkey/i],[[c,"Chromecast"],[h,"Google"],[u,y]],[/android.+;\s(glass)\s\d/i],[c,[h,"Google"],[u,b]],[/android.+;\s(pixel c)[\s)]/i],[c,[h,"Google"],[u,v]],[/android.+;\s(pixel( [2-9]a?)?( xl)?)[\s)]/i],[c,[h,"Google"],[u,g]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/android.+(redmi[\s\-_]?(?:note|k)?(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i,/android.+(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[c,/_/g," "],[h,"Xiaomi"],[u,g]],[/android.+(mi[\s\-_]?(?:pad)(?:[\s_]?[\w\s]+))(?:\sbuild|\))/i],[[c,/_/g," "],[h,"Xiaomi"],[u,v]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[c,[h,"Meizu"],[u,g]],[/(mz)-([\w-]{2,})/i],[[h,"Meizu"],c,[u,g]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[c,[h,"OnePlus"],[u,g]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[c,[h,"RCA"],[u,v]],[/android.+[;\/\s](Venue[\d\s]{2,7})\s+build/i],[c,[h,"Dell"],[u,v]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[c,[h,"Verizon"],[u,v]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[h,"Barnes & Noble"],c,[u,v]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[c,[h,"NuVision"],[u,v]],[/android.+;\s(k88)\sbuild/i],[c,[h,"ZTE"],[u,v]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[c,[h,"Swiss"],[u,g]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[c,[h,"Swiss"],[u,v]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[c,[h,"Zeki"],[u,v]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[h,"Dragon Touch"],c,[u,v]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[c,[h,"Insignia"],[u,v]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[c,[h,"NextBook"],[u,v]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[h,"Voice"],c,[u,g]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[h,"LvTel"],c,[u,g]],[/android.+;\s(PH-1)\s/i],[c,[h,"Essential"],[u,g]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[c,[h,"Envizen"],[u,v]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[h,c,[u,v]],[/android.+[;\/]\s*(Trio[\s\w\-\.]+)\s+build/i],[c,[h,"MachSpeed"],[u,v]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[h,c,[u,v]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[c,[h,"Rotor"],[u,v]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[h,c,[u,v]],[/android .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[c,[u,g]],[/android .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[c,[u,v]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,S.lowerize],h,c],[/[\s\/\(](smart-?tv)[;\)]/i],[[u,y]],[/(android[\w\.\s\-]{0,9});.+build/i],[c,[h,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[p,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[d,p],[/rv\:([\w\.]{1,9}).+(gecko)/i],[p,d]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[d,p],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[d,[p,E.str,T.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[d,"Windows"],[p,E.str,T.os.windows.version]],[/\((bb)(10);/i],[[d,"BlackBerry"],p],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[d,p],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[d,"Symbian"],p],[/\((series40);/i],[d],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[d,"Firefox OS"],p],[/crkey\/([\d\.]+)/i],[p,[d,"Chromecast"]],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[d,p],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[d,"Chromium OS"],p],[/(sunos)\s?([\w\.\d]*)/i],[[d,"Solaris"],p],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[d,p],[/(haiku)\s(\w+)/i],[d,p],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[p,/_/g,"."],[d,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[d,"Mac OS"],[p,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[d,p]]},x=function(e,t){if("object"==typeof e&&(t=e,e=r),!(this instanceof x))return new x(e,t).getResult();var n=e||(s&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:""),i=t?S.extend(w,t):w;return this.getBrowser=function(){var e={name:r,version:r};return E.rgx.call(e,n,i.browser),e.major=S.major(e.version),e},this.getCPU=function(){var e={architecture:r};return E.rgx.call(e,n,i.cpu),e},this.getDevice=function(){var e={vendor:r,model:r,type:r};return E.rgx.call(e,n,i.device),e},this.getEngine=function(){var e={name:r,version:r};return E.rgx.call(e,n,i.engine),e},this.getOS=function(){var e={name:r,version:r};return E.rgx.call(e,n,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};x.VERSION="0.7.23",x.BROWSER={NAME:d,MAJOR:"major",VERSION:p},x.CPU={ARCHITECTURE:m},x.DEVICE={MODEL:c,VENDOR:h,TYPE:u,CONSOLE:f,MOBILE:g,SMARTTV:y,TABLET:v,WEARABLE:b,EMBEDDED:"embedded"},x.ENGINE={NAME:d,VERSION:p},x.OS={NAME:d,VERSION:p},typeof t!==a?(e.exports&&(t=e.exports=x),t.UAParser=x):(i=function(){return x}.call(t,n,t,e))===r||(e.exports=i);var _=s&&(s.jQuery||s.Zepto);if(_&&!_.ua){var M=new x;_.ua=M.getResult(),_.ua.get=function(){return M.getUA()},_.ua.set=function(e){M.setUA(e);var t=M.getResult();for(var n in t)_.ua[n]=t[n]}}}("object"==typeof window?window:this)},69436:e=>{function t(e,t,n,i){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(i-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=n,this.p2y=i}e.exports=t,t.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},t.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},t.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},t.prototype.solveCurveX=function(e,t){var n,i,s,r,o;for(void 0===t&&(t=1e-6),s=e,o=0;o<8;o++){if(r=this.sampleCurveX(s)-e,Math.abs(r)<t)return s;var a=this.sampleCurveDerivativeX(s);if(Math.abs(a)<1e-6)break;s-=r/a}if((s=e)<(n=0))return n;if(s>(i=1))return i;for(;n<i;){if(r=this.sampleCurveX(s),Math.abs(r-e)<t)return s;e>r?n=s:i=s,s=.5*(i-n)+n}return s},t.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}},52511:function(e,t,n){var i;e=n.nmd(e),function(s){t&&t.nodeType,e&&e.nodeType;var r="object"==typeof n.g&&n.g;r.global!==r&&r.window!==r&&r.self;var o,a=2147483647,l=36,c=/^xn--/,d=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,m=String.fromCharCode;function f(e){throw RangeError(h[e])}function g(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function v(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),i+g((e=e.replace(u,".")).split("."),t).join(".")}function y(e){for(var t,n,i=[],s=0,r=e.length;s<r;)(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<r?56320==(64512&(n=e.charCodeAt(s++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),s--):i.push(t);return i}function b(e){return g(e,(function(e){var t="";return e>65535&&(t+=m((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=m(e)})).join("")}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function E(e,t,n){var i=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;i+=l)e=p(e/35);return p(i+36*e/(e+38))}function T(e){var t,n,i,s,r,o,c,d,u,h,m,g=[],v=e.length,y=0,S=128,T=72;for((n=e.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&f("not-basic"),g.push(e.charCodeAt(i));for(s=n>0?n+1:0;s<v;){for(r=y,o=1,c=l;s>=v&&f("invalid-input"),((d=(m=e.charCodeAt(s++))-48<10?m-22:m-65<26?m-65:m-97<26?m-97:l)>=l||d>p((a-y)/o))&&f("overflow"),y+=d*o,!(d<(u=c<=T?1:c>=T+26?26:c-T));c+=l)o>p(a/(h=l-u))&&f("overflow"),o*=h;T=E(y-r,t=g.length+1,0==r),p(y/t)>a-S&&f("overflow"),S+=p(y/t),y%=t,g.splice(y++,0,S)}return b(g)}function w(e){var t,n,i,s,r,o,c,d,u,h,g,v,b,T,w,x=[];for(v=(e=y(e)).length,t=128,n=0,r=72,o=0;o<v;++o)(g=e[o])<128&&x.push(m(g));for(i=s=x.length,s&&x.push("-");i<v;){for(c=a,o=0;o<v;++o)(g=e[o])>=t&&g<c&&(c=g);for(c-t>p((a-n)/(b=i+1))&&f("overflow"),n+=(c-t)*b,t=c,o=0;o<v;++o)if((g=e[o])<t&&++n>a&&f("overflow"),g==t){for(d=n,u=l;!(d<(h=u<=r?1:u>=r+26?26:u-r));u+=l)w=d-h,T=l-h,x.push(m(S(h+w%T,0))),d=p(w/T);x.push(m(S(d,0))),r=E(n,b,i==s),n=0,++i}++n,++t}return x.join("")}o={version:"1.3.2",ucs2:{decode:y,encode:b},decode:T,encode:w,toASCII:function(e){return v(e,(function(e){return d.test(e)?"xn--"+w(e):e}))},toUnicode:function(e){return v(e,(function(e){return c.test(e)?T(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i)}()},27225:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,n,i,s){n=n||"&",i=i||"=";var r={};if("string"!=typeof e||0===e.length)return r;var o=/\+/g;e=e.split(n);var a=1e3;s&&"number"==typeof s.maxKeys&&(a=s.maxKeys);var l=e.length;a>0&&l>a&&(l=a);for(var c=0;c<l;++c){var d,u,h,p,m=e[c].replace(o,"%20"),f=m.indexOf(i);f>=0?(d=m.substr(0,f),u=m.substr(f+1)):(d=m,u=""),h=decodeURIComponent(d),p=decodeURIComponent(u),t(r,h)?Array.isArray(r[h])?r[h].push(p):r[h]=[r[h],p]:r[h]=p}return r}},44066:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,n,i,s){return n=n||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(s){var r=encodeURIComponent(t(s))+i;return Array.isArray(e[s])?e[s].map((function(e){return r+encodeURIComponent(t(e))})).join(n):r+encodeURIComponent(t(e[s]))})).join(n):s?encodeURIComponent(t(s))+i+encodeURIComponent(t(e)):""}},36254:(e,t,n)=>{"use strict";t.decode=t.parse=n(27225),t.encode=t.stringify=n(44066)},8575:(e,t,n)=>{"use strict";var i=n(52511),s=n(62502);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.Qc=b;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(c),u=["%","/","?",";","#"].concat(d),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(36254);function b(e,t,n){if(e&&s.isObject(e)&&e instanceof r)return e;var i=new r;return i.parse(e,t,n),i}r.prototype.parse=function(e,t,n){if(!s.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),a=-1!==r&&r<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(a);if(b=b.trim(),!n&&1===e.split("#").length){var S=l.exec(b);if(S)return this.path=b,this.href=b,this.pathname=S[1],S[2]?(this.search=S[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=o.exec(b);if(E){var T=(E=E[0]).toLowerCase();this.protocol=T,b=b.substr(E.length)}if(n||E||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var w="//"===b.substr(0,2);!w||E&&g[E]||(b=b.substr(2),this.slashes=!0)}if(!g[E]&&(w||E&&!v[E])){for(var x,_,M=-1,O=0;O<h.length;O++){-1!==(A=b.indexOf(h[O]))&&(-1===M||A<M)&&(M=A)}-1!==(_=-1===M?b.lastIndexOf("@"):b.lastIndexOf("@",M))&&(x=b.slice(0,_),b=b.slice(_+1),this.auth=decodeURIComponent(x)),M=-1;for(O=0;O<u.length;O++){var A;-1!==(A=b.indexOf(u[O]))&&(-1===M||A<M)&&(M=A)}-1===M&&(M=b.length),this.host=b.slice(0,M),b=b.slice(M),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var N=this.hostname.split(/\./),D=(O=0,N.length);O<D;O++){var I=N[O];if(I&&!I.match(p)){for(var L="",P=0,R=I.length;P<R;P++)I.charCodeAt(P)>127?L+="x":L+=I[P];if(!L.match(p)){var k=N.slice(0,O),U=N.slice(O+1),B=I.match(m);B&&(k.push(B[1]),U.unshift(B[2])),U.length&&(b="/"+U.join(".")+b),this.hostname=k.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=i.toASCII(this.hostname));var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!f[T])for(O=0,D=d.length;O<D;O++){var H=d[O];if(-1!==b.indexOf(H)){var j=encodeURIComponent(H);j===H&&(j=escape(H)),b=b.split(H).join(j)}}var G=b.indexOf("#");-1!==G&&(this.hash=b.substr(G),b=b.slice(0,G));var z=b.indexOf("?");if(-1!==z?(this.search=b.substr(z),this.query=b.substr(z+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,z)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var W=this.search||"";this.path=F+W}return this.href=this.format(),this},r.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(o=y.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),t+r+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i},r.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},r.prototype.resolveObject=function(e){if(s.isString(e)){var t=new r;t.parse(e,!1,!0),e=t}for(var n=new r,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var d=l[c];"protocol"!==d&&(n[d]=e[d])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var u=Object.keys(e),h=0;h<u.length;h++){var p=u[h];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),n.pathname=m.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var f=n.pathname||"",y=n.search||"";n.path=f+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),S=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=S||b||n.host&&e.pathname,T=E,w=n.pathname&&n.pathname.split("/")||[],x=(m=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(x&&(n.hostname="",n.port=null,n.host&&(""===w[0]?w[0]=n.host:w.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),E=E&&(""===m[0]||""===w[0])),S)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,w=m;else if(m.length)w||(w=[]),w.pop(),w=w.concat(m),n.search=e.search,n.query=e.query;else if(!s.isNullOrUndefined(e.search)){if(x)n.hostname=n.host=w.shift(),(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift());return n.search=e.search,n.query=e.query,s.isNull(n.pathname)&&s.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!w.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var _=w.slice(-1)[0],M=(n.host||e.host||w.length>1)&&("."===_||".."===_)||""===_,O=0,A=w.length;A>=0;A--)"."===(_=w[A])?w.splice(A,1):".."===_?(w.splice(A,1),O++):O&&(w.splice(A,1),O--);if(!E&&!T)for(;O--;O)w.unshift("..");!E||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),M&&"/"!==w.join("/").substr(-1)&&w.push("");var C,N=""===w[0]||w[0]&&"/"===w[0].charAt(0);x&&(n.hostname=n.host=N?"":w.length?w.shift():"",(C=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=C.shift(),n.host=n.hostname=C.shift()));return(E=E||n.host&&w.length)&&!N&&w.unshift(""),w.length?n.pathname=w.join("/"):(n.pathname=null,n.path=null),s.isNull(n.pathname)&&s.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},62502:e=>{"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},42473:e=>{"use strict";var t=function(){};e.exports=t},55512:(e,t,n)=>{var i,s;void 0===(s="function"==typeof(i=function(){"use strict";const e=6406,t=6407,n=6408,i=6409,s=6410,r=6402,o=34041,a=33321,l=36756,c=33325,d=33326,u=33330,h=33329,p=33338,m=33337,f=33340,g=33339,v=33323,y=36757,b=33327,S=33328,E=33336,T=33335,w=33332,x=33331,_=33334,M=33333,O=32849,A=35905,C=36194,N=36758,D=35898,I=35901,L=34843,P=34837,R=36221,k=36239,U=36215,B=36233,F=36209,V=36227,H=32856,j=35907,G=36759,z=32855,W=32854,K=32857,Y=34842,q=34836,Z=36220,$=36238,Q=36975,X=36214,J=36232,ee=36226,te=36208,ne=33189,ie=33190,se=36012,re=36013,oe=35056,ae=5121,le=5123,ce=5125,de=5126,ue=32819,he=32820,pe=33635,me=5131,fe=36193,ge=35906;let ve;function ye(ye){if(!ve){const ye={};ye[e]={bytesPerElement:[1,2,2,4],type:[ae,me,fe,de]},ye[i]={bytesPerElement:[1,2,2,4],type:[ae,me,fe,de]},ye[s]={bytesPerElement:[2,4,4,8],type:[ae,me,fe,de]},ye[t]={bytesPerElement:[3,6,6,12,2],type:[ae,me,fe,de,pe]},ye[n]={bytesPerElement:[4,8,8,16,2,2],type:[ae,me,fe,de,ue,he]},ye[ge]={bytesPerElement:[4,8,8,16,2,2],type:[ae,me,fe,de,ue,he]},ye[r]={bytesPerElement:[2,4],type:[ce,le]},ye[o]={bytesPerElement:[4]},ye[a]={bytesPerElement:[1]},ye[l]={bytesPerElement:[1]},ye[c]={bytesPerElement:[2]},ye[d]={bytesPerElement:[4]},ye[u]={bytesPerElement:[1]},ye[h]={bytesPerElement:[1]},ye[w]={bytesPerElement:[2]},ye[x]={bytesPerElement:[2]},ye[_]={bytesPerElement:[4]},ye[M]={bytesPerElement:[4]},ye[v]={bytesPerElement:[2]},ye[y]={bytesPerElement:[2]},ye[b]={bytesPerElement:[4]},ye[S]={bytesPerElement:[8]},ye[E]={bytesPerElement:[2]},ye[T]={bytesPerElement:[2]},ye[p]={bytesPerElement:[4]},ye[m]={bytesPerElement:[4]},ye[f]={bytesPerElement:[8]},ye[g]={bytesPerElement:[8]},ye[O]={bytesPerElement:[3]},ye[A]={bytesPerElement:[3]},ye[C]={bytesPerElement:[2]},ye[N]={bytesPerElement:[3]},ye[D]={bytesPerElement:[4]},ye[I]={bytesPerElement:[4]},ye[L]={bytesPerElement:[6]},ye[P]={bytesPerElement:[12]},ye[R]={bytesPerElement:[3]},ye[k]={bytesPerElement:[3]},ye[U]={bytesPerElement:[6]},ye[B]={bytesPerElement:[6]},ye[F]={bytesPerElement:[12]},ye[V]={bytesPerElement:[12]},ye[H]={bytesPerElement:[4]},ye[j]={bytesPerElement:[4]},ye[G]={bytesPerElement:[4]},ye[z]={bytesPerElement:[2]},ye[W]={bytesPerElement:[2]},ye[K]={bytesPerElement:[4]},ye[Y]={bytesPerElement:[8]},ye[q]={bytesPerElement:[16]},ye[Z]={bytesPerElement:[4]},ye[$]={bytesPerElement:[4]},ye[Q]={bytesPerElement:[4]},ye[X]={bytesPerElement:[8]},ye[J]={bytesPerElement:[8]},ye[ee]={bytesPerElement:[16]},ye[te]={bytesPerElement:[16]},ye[ne]={bytesPerElement:[2]},ye[ie]={bytesPerElement:[4]},ye[se]={bytesPerElement:[4]},ye[oe]={bytesPerElement:[4]},ye[re]={bytesPerElement:[4]},ve=ye}return ve[ye]}function be(e,t,n){return function(i,s,r){return((i+e-1)/e|0)*((s+t-1)/t|0)*n*r}}function Se(e,t,n){return function(i,s,r){return(Math.max(i,e)*Math.max(s,t)/n|0)*r}}const Ee=33777,Te=33778,we=33779,xe=36196,_e=35840,Me=35841,Oe=35842,Ae=35843,Ce=37488,Ne=37489,De=37490,Ie=37491,Le=37492,Pe=37493,Re=37494,ke=37495,Ue=37496,Be=37497,Fe=37808,Ve=37809,He=37810,je=37811,Ge=37812,ze=37813,We=37814,Ke=37815,Ye=37816,qe=37817,Ze=37818,$e=37819,Qe=37820,Xe=37821,Je=37840,et=37841,tt=37842,nt=37843,it=37844,st=37845,rt=37846,ot=37847,at=37848,lt=37849,ct=37850,dt=37851,ut=37852,ht=37853,pt=35916,mt=35917,ft=35918,gt=35919,vt=36492,yt=36493,bt=36494,St=36495,Et=36283,Tt=36284,wt=36285,xt=36286,_t=new Map([[33776,be(4,4,8)],[Ee,be(4,4,8)],[Te,be(4,4,16)],[we,be(4,4,16)],[xe,be(4,4,8)],[_e,Se(8,8,2)],[Oe,Se(8,8,2)],[Me,Se(16,8,4)],[Ae,Se(16,8,4)],[Ce,be(4,4,8)],[Ne,be(4,4,8)],[Le,be(4,4,8)],[Pe,be(4,4,8)],[Re,be(4,4,8)],[ke,be(4,4,8)],[De,be(4,4,16)],[Ie,be(4,4,16)],[Ue,be(4,4,16)],[Be,be(4,4,16)],[Fe,be(4,4,16)],[Je,be(4,4,16)],[Ve,be(5,4,16)],[et,be(5,4,16)],[He,be(5,5,16)],[tt,be(5,5,16)],[je,be(6,5,16)],[nt,be(6,5,16)],[Ge,be(6,6,16)],[it,be(6,6,16)],[ze,be(8,5,16)],[st,be(8,5,16)],[We,be(8,6,16)],[rt,be(8,6,16)],[Ke,be(8,8,16)],[ot,be(8,8,16)],[Ye,be(10,5,16)],[at,be(10,5,16)],[qe,be(10,6,16)],[lt,be(10,6,16)],[Ze,be(10,8,16)],[ct,be(10,8,16)],[$e,be(10,10,16)],[dt,be(10,10,16)],[Qe,be(12,10,16)],[ut,be(12,10,16)],[Xe,be(12,12,16)],[ht,be(12,12,16)],[pt,be(4,4,8)],[mt,be(4,4,8)],[ft,be(4,4,16)],[gt,be(4,4,16)],[vt,be(4,4,16)],[yt,be(4,4,16)],[bt,be(4,4,16)],[St,be(4,4,16)],[Et,be(4,4,8)],[Tt,be(4,4,8)],[wt,be(4,4,16)],[xt,be(4,4,16)]]);function Mt(e,t){const n=ye(e);if(!n)throw"unknown internal format";if(n.type){const i=n.type.indexOf(t);if(i<0)throw new Error(`unsupported type ${t} for internalformat ${e}`);return n.bytesPerElement[i]}return n.bytesPerElement[0]}function Ot(e,t,n,i,s){return t*n*i*Mt(e,s)}function At(e,t,n,i,s){const r=_t.get(e);return r?r(t,n,i):Ot(e,t,n,i,s)}function Ct(e){return e&&e.buffer&&e.buffer instanceof ArrayBuffer}function Nt(e){return Ct(e)||e instanceof ArrayBuffer}function Dt(e){return{samples:e.getParameter(e.SAMPLES),depthBits:e.getParameter(e.DEPTH_BITS),contextAttributes:e.getContextAttributes()}}function It(e,t){const{samples:n,depthBits:i,contextAttributes:s}=t,{width:r,height:o}=e.canvas,a=r*o*4,l=s.depth?1:0,c=s.stencil?1:0;return a+a*n+a*l*Math.min(c+i>16?4:2,4)}function Lt(e){return"number"==typeof e}const Pt=new Set;function Rt(e,t,n={}){if(Pt.has(e))return e;Pt.add(e);const i=n.origGLErrorFn||e.getError;function s(e){const t=Dt(e),i={baseContext:e,config:n,apis:{gman_webgl_memory:{ctx:{getMemoryInfo(){const n=It(e,t);return{memory:{...d,drawingbuffer:n,total:n+d.buffer+d.texture+d.renderbuffer},resources:{...u}}}}}},resources:{},memory:{texture:0,buffer:0,renderbuffer:0},bindings:new Map,defaultVertexArray:{},webglObjectToMemory:new Map},s=new Set(["webgl","webgl2","webgl_lose_context"]);function r(){i.bindings.clear(),i.webglObjectToMemory.clear(),i.webglObjectToMemory.set(i.defaultVertexArray,{}),i.currentVertexArray=i.defaultVertexArray,[i.resources,i.memory].forEach((function(e){for(let t in e)e[t]=0}))}function a(){r(),i.isContextLost=!0;for(const[e,{ctx:t,origFuncs:n}]of[...Object.entries(i.apis)])if(!s.has(e)&&n){Pt.delete(t);for(const[e,i]of Object.entries(n))t[e]=i;delete o[e]}}function l(){i.isContextLost=!1}return e.canvas&&(e.canvas.addEventListener("webglcontextlost",a),e.canvas.addEventListener("webglcontextrestored",l)),r(),i}const r=n.sharedState||s(e);n.sharedState=r;const{apis:o,baseContext:a,bindings:l,config:c,memory:d,resources:u,webglObjectToMemory:h}=r,p={};function m(){}function f(e,t,n){if(e[n||`create${t[0].toUpperCase()}${t.substr(1)}`])return u[t]=0,function(e,n,i,s){if(r.isContextLost)return null;++u[t],h.set(s,{size:0})}}function g(t,n=m,i){const s=i||`delete${t[0].toUpperCase()}${t.substr(1)}`;if(e[s])return function(e,i,s){if(r.isContextLost)return;const[o]=s,a=h.get(o);a&&(--u[t],n(o,a),h.delete(o))}}function v(e,t,n,i,s){if(r.isContextLost)return;const o=l.get(e);if(!o)throw new Error(`no renderbuffer bound to ${e}`);const a=h.get(o);if(!a)throw new Error(`unknown renderbuffer ${o}`);const c=At(n,i,s,1)*t;d.renderbuffer-=a.size,a.size=c,d.renderbuffer+=c}const y=34963,b=5121,S=34067,E=35866,T=34069,w=33084,x=33085,_=new Set([T,34070,34071,34072,34073,34074]);function M(e){return _.has(e)}function O(e){e=M(e)?S:e;const t=l.get(e);if(!t)throw new Error(`no texture bound to ${e}`);const n=h.get(t);if(!n)throw new Error(`unknown texture ${t}`);return n}function A(e,t,n,i,s,r,o,a){const l=e.size,c=At(i,s,r,o,a),u=M(t)?t-T:0;e.mips=e.mips||[],e.mips[n]=e.mips[n]||[];const h=e.mips[n][u]||{};e.size-=h.size||0,h.size=c,h.internalFormat=i,h.type=a,h.width=s,h.height=r,h.depth=o,e.mips[n][u]=h,e.size+=c,d.texture-=l,d.texture+=e.size}function C(e,t,n,i,s,r){const o=O(e),a=e===S?6:1,l=e===S?T:e;for(let c=0;c<t;++c){for(let e=0;e<a;++e)A(o,l+e,c,n,i,s,r);i=Math.ceil(Math.max(i/2,1)),s=Math.ceil(Math.max(s/2,1)),r=e===E?r:Math.ceil(Math.max(r/2,1))}}function N(e,t,n){if(r.isContextLost)return;const[i]=n;r.currentVertexArray=i||r.defaultVertexArray}function D(e,t){if(!r.isContextLost)switch(e){case y:h.get(r.currentVertexArray).elementArrayBuffer=t;break;default:l.set(e,t)}}const I={},L={bufferData(e,t,n){if(r.isContextLost)return;const[i,s,,o=0,a]=n;let c;switch(i){case y:c=h.get(r.currentVertexArray).elementArrayBuffer;break;default:c=l.get(i)}if(!c)throw new Error(`no buffer bound to ${i}`);let u=0;if(void 0!==a)u=a*s.BYTES_PER_ELEMENT;else if(Nt(s))u=s.byteLength;else{if(!Lt(s))throw new Error(`unsupported bufferData src type ${s}`);u=s}const p=h.get(c);if(!p)throw new Error(`unknown buffer ${c}`);d.buffer-=p.size,p.size=u,d.buffer+=u},bindVertexArray:N,bindVertexArrayOES:N,bindBuffer(e,t,n){const[i,s]=n;D(i,s)},bindBufferBase(e,t,n){const[i,s,r]=n;D(i,r)},bindBufferRange(e,t,n){const[i,s,r,o,a]=n;D(i,r)},bindRenderbuffer(e,t,n){if(r.isContextLost)return;const[i,s]=n;l.set(i,s)},bindTexture(e,t,n){if(r.isContextLost)return;const[i,s]=n;l.set(i,s)},copyTexImage2D(e,t,n){if(r.isContextLost)return;const[i,s,o,a,l,c,d,u]=n;A(O(i),i,s,o,c,d,1,b)},createBuffer:f(e,"buffer"),createFramebuffer:f(e,"framebuffer"),createRenderbuffer:f(e,"renderbuffer"),createProgram:f(e,"program"),createQuery:f(e,"query"),createShader:f(e,"shader"),createSampler:f(e,"sampler"),createTexture:f(e,"texture"),createTransformFeedback:f(e,"transformFeedback"),createVertexArray:f(e,"vertexArray"),createVertexArrayOES:f(e,"vertexArray","createVertexArrayOES"),compressedTexImage2D(e,t,n){if(r.isContextLost)return;const[i,s,o,a,l]=n;A(O(i),i,s,o,a,l,1,b)},compressedTexImage3D(e,t,n){if(r.isContextLost)return;const[i,s,o,a,l,c]=n;A(O(i),i,s,o,a,l,c,b)},deleteBuffer:g("buffer",(function(e,t){d.buffer-=t.size})),deleteFramebuffer:g("framebuffer"),deleteProgram:g("program"),deleteQuery:g("query"),deleteRenderbuffer:g("renderbuffer",(function(e,t){d.renderbuffer-=t.size})),deleteSampler:g("sampler"),deleteShader:g("shader"),deleteSync:g("sync"),deleteTexture:g("texture",(function(e,t){d.texture-=t.size})),deleteTransformFeedback:g("transformFeedback"),deleteVertexArray:g("vertexArray"),deleteVertexArrayOES:g("vertexArray",m,"deleteVertexArrayOES"),fenceSync:function(e){if(!r.isContextLost&&e.fenceSync)return u.sync=0,function(e,t,n,i){++u.sync,h.set(i,{size:0})}}(e),generateMipmap(e,t,n){if(r.isContextLost)return;const[i]=n,s=O(i),o=s.parameters&&s.parameters.get(w)||0,a=s.parameters&&s.parameters.get(x)||1024;let{width:l,height:c,depth:d,internalFormat:u,type:h}=s.mips[o][0],p=o+1;const m=i===S?6:1,f=i===S?T:i;for(;p<=a&&(1!==l||1!==c||1!==d&&i!==E);){l=Math.ceil(Math.max(l/2,1)),c=Math.ceil(Math.max(c/2,1)),d=i===E?d:Math.ceil(Math.max(d/2,1));for(let e=0;e<m;++e)A(s,f+e,p,u,l,c,d,h);++p}},getSupportedExtensions(e,t,n,i){r.isContextLost||i.push("GMAN_webgl_memory")},renderbufferStorage(e,t,n){const[i,s,r,o]=n;v(i,1,s,r,o)},renderbufferStorageMultisample(e,t,n){const[i,s,r,o,a]=n;v(i,s,r,o,a)},texImage2D(e,t,n){if(r.isContextLost)return;let i,s,o,[a,l,c]=n;if(6==n.length){const e=n[5];i=e.width,s=e.height,o=n[4]}else i=n[3],s=n[4],o=n[7];A(O(a),a,l,c,i,s,1,o)},texImage3D(e,t,n){if(r.isContextLost)return;let[i,s,o,a,l,c,d,u,h]=n;A(O(i),i,s,o,a,l,c,h)},texParameteri(e,t,n){if(r.isContextLost)return;let[i,s,o]=n;const a=O(i);a.parameters=a.parameters||new Map,a.parameters.set(s,o)},texStorage2D(e,t,n){let[i,s,r,o,a]=n;C(i,s,r,o,a,1)},texStorage3D(e,t,n){let[i,s,r,o,a,l]=n;C(i,s,r,o,a,l)}},P={getExtension(e,t){if(r.isContextLost)return null;const s=e[t];e[t]=function(...t){const r=t[0].toLowerCase(),a=o[r];if(a)return a.ctx;const l=s.call(e,...t);return l&&Rt(l,r,{...n,origGLErrorFn:i}),l}}};function R(e,t){const n=e[t],s=I[t]||m,r=L[t]||m;if(s===m&&L===m)return;e[t]=function(...i){s(e,t,i);const o=n.call(e,...i);return r(e,t,i,o),o};const o=P[t];o&&o(e,t,i)}for(const t in e)"function"==typeof e[t]&&(p[t]=e[t],R(e,t));o[t.toLowerCase()]={ctx:e,origFuncs:p}}function kt(e){const t=e.prototype.getContext;e.prototype.getContext=function(e,...n){const i=t.call(this,e,...n);return i&&i.bindTexture&&(Rt(i,e,{}),i.getExtension("GMAN_webgl_memory")),i}}"undefined"!=typeof HTMLCanvasElement&&kt(HTMLCanvasElement),"undefined"!=typeof OffscreenCanvas&&kt(OffscreenCanvas)})?i.call(t,n,t,e):i)||(e.exports=s)},33404:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform float opacity;uniform vec3 color;uniform sampler2D bg;varying vec2 vUv;void main(){vec4 bgColor=texture2D(bg,vUv);gl_FragColor=vec4(bgColor.rgb,bgColor.a*opacity);}"},42154:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform vec3 diffuse;uniform float opacity;uniform sampler2D mask;\n#ifdef USE_DASH\nuniform float dashSize;uniform float gapSize;\n#endif\nvarying float vLineDistance;\n#include <common>\nvarying vec2 vUv;void main(){\n#ifdef USE_DASH\nif(vUv.y<-1.||vUv.y>1.)discard;if(mod(vLineDistance,dashSize+gapSize)>dashSize)discard;\n#endif\n#ifdef USE_MASK\nvec2 modUv=vec2(vUv);modUv*=2.;vec4 texelColor=texture2D(mask,modUv);gl_FragColor=vec4(texelColor.rgb,min(texelColor.a,opacity));\n#else\ngl_FragColor=vec4(diffuse,opacity);\n#endif\n}"},86676:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;\n#include <common>\nuniform float linewidth;uniform vec2 resolution;attribute vec3 instanceStart;attribute vec3 instanceEnd;attribute vec3 instanceColorStart;attribute vec3 instanceColorEnd;varying vec2 vUv;\n#ifdef USE_DASH\nuniform float dashScale;attribute float instanceDistanceStart;attribute float instanceDistanceEnd;varying float vLineDistance;\n#endif\nvoid trimSegment(const in vec4 start,inout vec4 end){float a=projectionMatrix[2][2];float b=projectionMatrix[3][2];float nearEstimate=-0.5*b/a;float alpha=(nearEstimate-start.z)/(end.z-start.z);end.xyz=mix(start.xyz,end.xyz,alpha);}void main(){\n#ifdef USE_COLOR\nvColor.xyz=(position.y<0.5)?instanceColorStart:instanceColorEnd;\n#endif\n#ifdef USE_DASH\nvLineDistance=(position.y<0.5)?dashScale*instanceDistanceStart:dashScale*instanceDistanceEnd;\n#endif\nfloat aspect=resolution.x/resolution.y;vUv=uv;vec4 start=modelViewMatrix*vec4(instanceStart,1.);vec4 end=modelViewMatrix*vec4(instanceEnd,1.);bool perspective=(projectionMatrix[2][3]==-1.);if(perspective){if(start.z<0.&&end.z>=0.){trimSegment(start,end);}else if(end.z<0.&&start.z>=0.){trimSegment(end,start);}}vec4 clipStart=projectionMatrix*start;vec4 clipEnd=projectionMatrix*end;vec2 ndcStart=clipStart.xy/clipStart.w;vec2 ndcEnd=clipEnd.xy/clipEnd.w;vec2 dir=ndcEnd-ndcStart;dir.x*=aspect;dir=normalize(dir);vec2 offset=vec2(dir.y,-dir.x);dir.x/=aspect;offset.x/=aspect;if(position.x<0.)offset*=-1.;offset*=linewidth;offset/=resolution.y;vec4 clip=(position.y<0.5)?clipStart:clipEnd;\n#ifdef USE_MASK\noffset*=(clipEnd.w+clipStart.w)*0.5;\n#else\noffset*=clip.w;\n#endif\nclip.xy+=offset;gl_Position=clip;\n#include <worldpos_vertex>\n}"},81254:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform samplerCube map;uniform vec2 dir;varying vec3 vWorldPosition;vec3 sphereToUnit(float x,float y){return vec3(sin(x)*cos(y),cos(x),sin(x)*sin(y));}vec2 unitToSphere(vec3 unit){return vec2(atan(sqrt(pow(unit.x,2.)+pow(unit.z,2.)),unit.y),atan(unit.z,unit.x));}void main(){vec2 coord=unitToSphere(vWorldPosition);vec4 sum=textureCube(map,sphereToUnit(coord.x-12.*dir.x,coord.y-12.*dir.y))*KERNEL_1;sum+=textureCube(map,sphereToUnit(coord.x-11.*dir.x,coord.y-11.*dir.y))*KERNEL_2;sum+=textureCube(map,sphereToUnit(coord.x-10.*dir.x,coord.y-10.*dir.y))*KERNEL_3;sum+=textureCube(map,sphereToUnit(coord.x-9.*dir.x,coord.y-9.*dir.y))*KERNEL_4;sum+=textureCube(map,sphereToUnit(coord.x-8.*dir.x,coord.y-8.*dir.y))*KERNEL_5;sum+=textureCube(map,sphereToUnit(coord.x-7.*dir.x,coord.y-7.*dir.y))*KERNEL_6;sum+=textureCube(map,sphereToUnit(coord.x-6.*dir.x,coord.y-6.*dir.y))*KERNEL_7;sum+=textureCube(map,sphereToUnit(coord.x-5.*dir.x,coord.y-5.*dir.y))*KERNEL_8;sum+=textureCube(map,sphereToUnit(coord.x-4.*dir.x,coord.y-4.*dir.y))*KERNEL_9;sum+=textureCube(map,sphereToUnit(coord.x-3.*dir.x,coord.y-3.*dir.y))*KERNEL_10;sum+=textureCube(map,sphereToUnit(coord.x-2.*dir.x,coord.y-2.*dir.y))*KERNEL_11;sum+=textureCube(map,sphereToUnit(coord.x-1.*dir.x,coord.y-1.*dir.y))*KERNEL_12;sum+=textureCube(map,sphereToUnit(coord.x,coord.y))*KERNEL_13;sum+=textureCube(map,sphereToUnit(coord.x+1.*dir.x,coord.y+1.*dir.y))*KERNEL_14;sum+=textureCube(map,sphereToUnit(coord.x+2.*dir.x,coord.y+2.*dir.y))*KERNEL_15;sum+=textureCube(map,sphereToUnit(coord.x+3.*dir.x,coord.y+3.*dir.y))*KERNEL_16;sum+=textureCube(map,sphereToUnit(coord.x+4.*dir.x,coord.y+4.*dir.y))*KERNEL_17;sum+=textureCube(map,sphereToUnit(coord.x+5.*dir.x,coord.y+5.*dir.y))*KERNEL_18;sum+=textureCube(map,sphereToUnit(coord.x+6.*dir.x,coord.y+6.*dir.y))*KERNEL_19;sum+=textureCube(map,sphereToUnit(coord.x+7.*dir.x,coord.y+7.*dir.y))*KERNEL_20;sum+=textureCube(map,sphereToUnit(coord.x+8.*dir.x,coord.y+8.*dir.y))*KERNEL_21;sum+=textureCube(map,sphereToUnit(coord.x+9.*dir.x,coord.y+9.*dir.y))*KERNEL_22;sum+=textureCube(map,sphereToUnit(coord.x+10.*dir.x,coord.y+10.*dir.y))*KERNEL_23;sum+=textureCube(map,sphereToUnit(coord.x+11.*dir.x,coord.y+11.*dir.y))*KERNEL_24;sum+=textureCube(map,sphereToUnit(coord.x+12.*dir.x,coord.y+12.*dir.y))*KERNEL_25;gl_FragColor=sum;}"},64937:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec3 vWorldPosition;void main(){vWorldPosition=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},56128:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform samplerCube map;uniform float opacity;varying vec3 vWorldPosition;void main(){vec4 color=textureCube(map,vec3(-vWorldPosition.x,vWorldPosition.yz));gl_FragColor=vec4(color.rgb,opacity);}"},65723:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec3 vWorldPosition;void main(){vWorldPosition=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},51095:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform vec3 color;uniform float opacity;uniform float maxDistance;varying vec3 vWorldPosition;void main(){float distanceToCamera=distance(cameraPosition,vWorldPosition);float distanceBucketed=1.-clamp(distanceToCamera/maxDistance,0.,1.);if(opacity<1.){discard;}gl_FragColor=vec4(distanceBucketed,distanceBucketed,distanceBucketed,1.);}"},2835:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec3 vWorldPosition;void main(){vWorldPosition=(modelMatrix*vec4(position,1.)).xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},14522:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform sampler2D map;uniform float opacity;uniform vec4 colorOverlay;varying vec2 vUv;vec4 white=vec4(0.8,0.8,0.8,1.);vec4 black=vec4(0.,0.,0.,1.);void main(){vec4 colorFromTexture=texture2D(map,vUv);float whiteness=1.-smoothstep(0.1,0.2,opacity);colorFromTexture=mix(colorFromTexture,vec4(colorOverlay.rgb,1.),colorOverlay.a);colorFromTexture=mix(colorFromTexture,white,whiteness);gl_FragColor=vec4(colorFromTexture.rgb,opacity);}"},68842:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},36328:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;\n#define MAX_TRIMS_PER_FLOOR  10\n#ifdef PANO_TEXTURE\nuniform vec3 pano0Position;uniform samplerCube pano0Map;varying vec3 pano0SweepDirection;uniform float panoOpacity;\n#endif\n#ifdef PANO_TEXTURE_TRANSITION\nuniform float progress;uniform vec3 pano1Position;uniform samplerCube pano1Map;varying vec3 pano1SweepDirection;\n#endif\n#ifdef PANO_OVERLAY\nuniform samplerCube overlay0Map;varying vec3 overlay0WorldPos;\n#endif\n#ifdef PANO_OVERLAY_TRANSITION\nuniform samplerCube overlay1Map;varying vec3 overlay1WorldPos;\n#endif\n#ifdef MESH_PREVIEW_SPHERE\nuniform vec3 meshPreviewCenter;uniform float meshPreviewSize;\n#endif\n#ifdef MESH_TEXTURE\nvarying vec2 vUv;uniform sampler2D map;uniform float meshOpacity;uniform float opacity;uniform float transparentDiscardDist;varying vec3 worldPos;\n#ifdef MESH_TRIM_VERTEX\nvarying vec3 trimPos[MAX_TRIMS_PER_FLOOR];uniform bool meshTrimsDiscardContents[MAX_TRIMS_PER_FLOOR];uniform bool hasKeepVolume;\n#endif\n#ifdef MESH_TRIM_PIXEL\nuniform mat4 meshTrimMatrices[MAX_TRIMS_PER_FLOOR];uniform bool meshTrimsDiscardContents[MAX_TRIMS_PER_FLOOR];uniform bool hasKeepVolume;\n#endif\n#endif\n#ifdef COLOR_OVERLAY\nuniform vec4 colorOverlay;\n#endif\n#ifdef WIREFRAME\nvarying vec3 vBarycentric;uniform float time;uniform float thickness;uniform float secondThickness;uniform float dashRepeats;uniform float dashLength;uniform bool dashOverlap;uniform bool dashEnabled;uniform bool dashAnimate;uniform bool fillEnabled;uniform bool insideAltColor;uniform bool dualStroke;uniform bool squeeze;uniform float squeezeMin;uniform float squeezeMax;uniform float wireframeOpacity;uniform vec3 stroke;uniform vec3 fill;float aastep(float threshold,float dist){float afwidth=fwidth(dist)*0.5;return smoothstep(threshold-afwidth,threshold+afwidth,dist);}float computeScreenSpaceWireframe(vec3 barycentric,float lineWidth){vec3 dist=fwidth(barycentric);vec3 smoothed=smoothstep(dist*((lineWidth*0.5)-0.5),dist*((lineWidth*0.5)+0.5),barycentric);return 1.-min(min(smoothed.x,smoothed.y),smoothed.z);}vec4 getStyledWireframe(vec3 barycentric){float PI=3.14159265359;float d=min(min(barycentric.x,barycentric.y),barycentric.z);float positionAlong=max(barycentric.x,barycentric.y);if(barycentric.y<barycentric.x&&barycentric.y<barycentric.z){positionAlong=1.-positionAlong;}float computedThickness=thickness;if(squeeze){computedThickness*=mix(squeezeMin,squeezeMax,(1.-sin(positionAlong*PI)));}if(dashEnabled){float offset=1./dashRepeats*dashLength/2.;if(!dashOverlap){offset+=1./dashRepeats/2.;}if(dashAnimate){offset+=time*0.22;}float pattern=fract((positionAlong+offset)*dashRepeats);computedThickness*=1.-aastep(dashLength,pattern);}float edge=computeScreenSpaceWireframe(barycentric,computedThickness);vec4 outColor=vec4(0.,0.,0.,0.);if(!fillEnabled){outColor=vec4(stroke,edge);if(insideAltColor&&!gl_FrontFacing){outColor.rgb=fill;}}else{outColor.a=1.;if(dualStroke){float inner=1.-aastep(secondThickness,d);vec3 wireColor=mix(fill,stroke,abs(inner-edge));outColor.rgb=wireColor;}else{outColor.rgb=mix(fill,stroke,edge);}}outColor.a*=wireframeOpacity;return outColor;}\n#endif\n#ifdef FLAT_SHADING\nvarying vec3 vNormal;\n#endif\nvoid main(){\n#ifdef PANO_TEXTURE_TRANSITION\nvec4 colorFromPano0=textureCube(pano0Map,pano0SweepDirection.xyz);vec4 colorFromPano1=textureCube(pano1Map,pano1SweepDirection.xyz);\n#ifdef PANO_OVERLAY_TRANSITION\nvec4 colorFromOverlay0=textureCube(overlay0Map,overlay0WorldPos.xyz);vec4 colorFromOverlay1=textureCube(overlay1Map,overlay1WorldPos.xyz);colorFromPano0.rgb=mix(colorFromPano0.rgb,colorFromOverlay0.rgb,colorFromOverlay0.a);colorFromPano1.rgb=mix(colorFromPano1.rgb,colorFromOverlay1.rgb,colorFromOverlay1.a);\n#endif\nvec4 color=mix(colorFromPano0,colorFromPano1,progress);color.a=panoOpacity;\n#elif defined(PANO_TEXTURE)\nvec4 color=textureCube(pano0Map,pano0SweepDirection.xyz);\n#ifdef PANO_OVERLAY\nvec4 colorFromOverlay0=textureCube(overlay0Map,overlay0WorldPos.xyz);color.rgb=mix(color.rgb,colorFromOverlay0.rgb,colorFromOverlay0.a);\n#endif\ncolor.a=panoOpacity;\n#else\nvec4 color=vec4(0.,0.,0.,0.);\n#endif\n#ifdef MESH_TEXTURE\nvec4 colorFromTexture=texture2D(map,vUv);float depth=distance(cameraPosition,worldPos.xyz);if(opacity<1.&&depth<transparentDiscardDist){discard;}\n#endif\n#ifdef MESH_PREVIEW_SPHERE\nfloat previewDistance=distance(worldPos.xyz,meshPreviewCenter.xyz);float inSphere=step(previewDistance,meshPreviewSize);colorFromTexture+=colorFromTexture*(0.2*inSphere);color=mix(color,colorFromTexture,max(meshOpacity,inSphere));\n#elif defined(MESH_TEXTURE)\ncolor=mix(color,colorFromTexture,meshOpacity);\n#endif\n#ifdef FLAT_SHADING\nfloat ao=0.9-abs(vNormal.y)*0.1-abs(vNormal.x)*0.05+abs(vNormal.z)*0.05;color.rgb=vec3(ao,ao*1.025,ao*1.05);\n#endif\n#ifdef COLOR_OVERLAY\ncolor=mix(color,vec4(colorOverlay.rgb,1.),colorOverlay.a);\n#endif\n#ifdef WIREFRAME\nvec4 colorFromWireframe=getStyledWireframe(vBarycentric);color=mix(color,vec4(colorFromWireframe.rgb,1.),colorFromWireframe.a);\n#endif\n#ifdef MESH_TEXTURE\ncolor.a=opacity;\n#if defined(MESH_TRIM_VERTEX) || defined(MESH_TRIM_PIXEL)\nbool isWithinVolume=false;bool doKeepFragment=true;bool enabled=true;vec4 worldPos4=vec4(worldPos.xyz,1);vec3 compare=vec3(0.5);\n#pragma unroll_loop_start\nfor(int i=0;i<10;i++){\n#ifdef MESH_TRIM_VERTEX\nenabled=!all(equal(trimPos[UNROLLED_LOOP_INDEX],vec3(0.)));if(enabled){if(all(lessThan(abs(trimPos[UNROLLED_LOOP_INDEX]),compare))){isWithinVolume=true;if(meshTrimsDiscardContents[UNROLLED_LOOP_INDEX]){doKeepFragment=false;}}}\n#endif\n#ifdef MESH_TRIM_PIXEL\nenabled=meshTrimMatrices[UNROLLED_LOOP_INDEX][3][3]>0.;if(enabled){if(all(lessThan(abs((meshTrimMatrices[UNROLLED_LOOP_INDEX]*worldPos4).xyz),compare))){isWithinVolume=true;if(meshTrimsDiscardContents[UNROLLED_LOOP_INDEX]){doKeepFragment=false;}}}\n#endif\n}\n#pragma unroll_loop_end\nif(!isWithinVolume&&hasKeepVolume){discard;}else if(isWithinVolume&&!doKeepFragment){discard;}\n#endif\n#endif\ngl_FragColor=color;}"},17513:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;\n#define MAX_TRIMS_PER_FLOOR  10\n#ifdef PANO_TEXTURE\nuniform vec3 pano0Position;uniform mat4 pano0Matrix1;uniform mat4 pano0Matrix2;varying vec3 pano0SweepDirection;\n#endif\n#ifdef PANO_TEXTURE_TRANSITION\nuniform vec3 pano1Position;uniform mat4 pano1Matrix1;uniform mat4 pano1Matrix2;varying vec3 pano1SweepDirection;\n#endif\n#ifdef PANO_OVERLAY\nvarying vec3 overlay0WorldPos;uniform mat4 overlay0Matrix;\n#endif\n#ifdef PANO_OVERLAY_TRANSITION\nvarying vec3 overlay1WorldPos;uniform mat4 overlay1Matrix;\n#endif\n#ifdef MESH_PREVIEW_SPHERE\n#endif\n#ifdef MESH_TEXTURE\nvarying vec2 vUv;varying vec3 worldPos;\n#ifdef MESH_TRIM_VERTEX\nuniform mat4 meshTrimMatrices[MAX_TRIMS_PER_FLOOR];varying vec3 trimPos[MAX_TRIMS_PER_FLOOR];\n#endif\n#endif\n#ifdef WIREFRAME\nattribute vec3 barycentric;varying vec3 vBarycentric;\n#endif\n#ifdef FLAT_SHADING\nvarying vec3 vNormal;\n#endif\nvoid main(){vec4 worldPosition=modelMatrix*vec4(position,1.);\n#ifdef MESH_TEXTURE\nvUv=uv;worldPos=worldPosition.xyz;\n#ifdef MESH_TRIM_VERTEX\n#pragma unroll_loop_start\nfor(int i=0;i<10;i++){trimPos[UNROLLED_LOOP_INDEX]=(meshTrimMatrices[UNROLLED_LOOP_INDEX]*vec4(worldPos,1.)).xyz;}\n#pragma unroll_loop_end    \n#endif\n#endif\n#ifdef WIREFRAME\nvBarycentric=barycentric;\n#endif\n#ifdef FLAT_SHADING\nvNormal=normal;\n#endif\n#ifdef PANO_TEXTURE\nvec3 positionLocalToPanoCenter0=worldPosition.xyz-pano0Position;pano0SweepDirection=(pano0Matrix2*pano0Matrix1*vec4(positionLocalToPanoCenter0,1.)).xyz;\n#ifdef PANO_OVERLAY\noverlay0WorldPos=(overlay0Matrix*vec4(positionLocalToPanoCenter0,1.)).xyz;\n#endif\n#endif\n#ifdef PANO_TEXTURE_TRANSITION\nvec3 positionLocalToPanoCenter1=worldPosition.xyz-pano1Position;pano1SweepDirection=(pano1Matrix2*pano1Matrix1*vec4(positionLocalToPanoCenter1,1.)).xyz;\n#ifdef PANO_OVERLAY_TRANSITION\noverlay1WorldPos=(overlay1Matrix*vec4(positionLocalToPanoCenter1,1.)).xyz;\n#endif\n#endif\nvec4 projectedPosition=projectionMatrix*modelViewMatrix*vec4(position,1.);gl_Position=projectedPosition;}"},12944:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;\n#ifdef INSTANCED\nvarying float alpha;varying vec3 color;\n#else\nuniform float alpha;uniform vec3 color;\n#endif\nuniform sampler2D bg;uniform sampler2D mask;varying vec2 vUv;void main(){vec4 bgColor=texture2D(bg,vUv);if(bgColor.a*alpha<0.1){discard;}vec4 maskColor=texture2D(mask,vUv);vec3 mappedColor=mix(color,maskColor.rgb,maskColor.a);gl_FragColor=vec4(mappedColor,bgColor.a*alpha);}"},27662:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec2 vUv;\n#ifdef INSTANCED\nattribute mat4 instanceMatrix;attribute float instanceAlpha;attribute vec3 instanceColor;varying float alpha;varying vec3 color;\n#endif\nvoid main(){vUv=uv;\n#ifdef INSTANCED\nalpha=instanceAlpha;color=instanceColor;gl_Position=projectionMatrix*modelViewMatrix*instanceMatrix*vec4(position,1.);\n#else\ngl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n#endif\n}"},6182:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;varying vec2 vUv;void main(){float dist=length(vUv);float alpha=(1.-smoothstep(0.95,1.,dist))*0.3;gl_FragColor=vec4(1.,1.,1.,alpha);}"},36257:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec2 vUv;void main(){vUv=(uv*2.)-1.;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);gl_Position.z*=1.00001;}"},6324:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;\n#ifdef INSTANCED\nvarying float alpha;\n#else\nuniform float alpha;\n#endif\nvoid main(){gl_FragColor=vec4(1.,1.,1.,alpha);}"},43934:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;uniform vec2 resolution;\n#ifdef INSTANCED\nattribute mat4 instanceMatrix;attribute vec3 stemVector;attribute vec4 pinHeadMatrixCol0;attribute vec4 pinHeadMatrixCol1;attribute vec4 pinHeadMatrixCol2;attribute vec4 pinHeadMatrixCol3;attribute float instanceAlpha;varying float alpha;\n#else\nuniform mat4 pinHeadMatrix;\n#endif\n#define PI  3.1415926538\nvoid main(){\n#ifdef INSTANCED\nvec3 pos=position*stemVector;mat4 modelViewProjMatrix=projectionMatrix*modelViewMatrix*instanceMatrix;mat4 pinHeadMatrix=mat4(pinHeadMatrixCol0,pinHeadMatrixCol1,pinHeadMatrixCol2,pinHeadMatrixCol3);alpha=instanceAlpha;\n#else\nvec3 pos=position;mat4 modelViewProjMatrix=projectionMatrix*modelViewMatrix;\n#endif\nvec3 fromOrigin=(vec3(0.,0.,0.)-pos);if(length(fromOrigin)<1e-6){gl_Position=modelViewProjMatrix*vec4(pos,1.);}else{mat4 noteViewProj=projectionMatrix*viewMatrix*pinHeadMatrix;vec4 noteNDC=noteViewProj*vec4(0.,0.,0.,1.);noteNDC.xyz/=abs(noteNDC.w);vec4 discEdgeNDC=noteViewProj*vec4(0.5,0.,0.,1.);discEdgeNDC.xyz/=abs(discEdgeNDC.w);float noteSizeNDC=length(discEdgeNDC.xy-noteNDC.xy);vec4 anchorNDC=modelViewProjMatrix*vec4(0.,0.,0.,1.);anchorNDC.xyz/=abs(anchorNDC.w);vec4 vectorNDC=modelViewProjMatrix*vec4(pos,1.);vectorNDC.xyz/=abs(vectorNDC.w);vectorNDC-=anchorNDC;float lineLengthNDC=length(vectorNDC.xy);float vertDot=abs(dot(normalize(vectorNDC.xy),vec2(0,1)));float angle=acos(vertDot)/(PI/2.);float aspect=mix(resolution.x/resolution.y,1.,angle);vec2 vector2d=normalize(vectorNDC.xy)*max(lineLengthNDC-noteSizeNDC*aspect,0.);vectorNDC.xy=vector2d.xy;vectorNDC+=anchorNDC;gl_Position=vec4(vectorNDC.xyz,1.);}}"},41148:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform float borderSize;uniform float textureSampleScale;uniform samplerCube panoTexture;uniform vec4 borderColor;varying vec2 vUv;const vec4 transparent=vec4(0.,0.,0.,0.);const float PI=3.14159265359;const float HALF_PI=PI/2.;void main(){float fadeDist=0.1;float r=1.;vec2 uv=(vUv*2.)-vec2(1.,1.);float d=length(uv);float p=d*PI-HALF_PI;float y=sin(p);float h=cos(p)*textureSampleScale;vec3 sampleVec=vec3(uv.x*h,y,uv.y*h);vec4 panoColor=textureCube(panoTexture,sampleVec);panoColor.a=clamp(((1.-d)/d)/fadeDist,0.,1.);vec4 outColor=mix(panoColor,transparent,step(1.,d));float isBorder=max(sign(borderSize),0.)*step(1.-borderSize,d)*step(d,1.);gl_FragColor=mix(outColor,borderColor,isBorder);}"},96251:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec2 vUv;void main(){vUv=uv;vec4 projectedPosition=projectionMatrix*viewMatrix*modelMatrix*vec4(position,1.);gl_Position=projectedPosition;}"},5370:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform sampler2D bg;uniform sampler2D mask;varying vec2 vUv;void main(){vec4 existingColor=texture2D(bg,vUv);vec4 maskColor=texture2D(mask,vUv);gl_FragColor=vec4(existingColor.rgb*maskColor.rgb,maskColor.a);}"},22052:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*vec4(position,1.);}"},38988:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;\n#define M_PI  3.14159265359\nuniform samplerCube cubemap;uniform float yaw;varying vec2 vUv;void main(){vec2 uv=vUv;float theta=uv.x*2.*M_PI+yaw;float phi=uv.y*M_PI;vec3 longitude=vec3(sin(theta),1.,-cos(theta));vec3 latitude=vec3(sin(phi),-cos(phi),sin(phi));vec3 dir=longitude*latitude;normalize(dir);gl_FragColor=vec4(textureCube(cubemap,dir).rgb,1.);}"},35726:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec2 vUv;void main(){vUv=vec2(1.-uv.x,uv.y);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},75861:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform vec3 topColor;uniform vec3 bottomColor;uniform float radius;varying vec4 worldPosition;\n#define SRGB_TO_LINEAR(c)pow((c),vec3(2.2))\n#define LINEAR_TO_SRGB(c)pow((c),vec3(1./2.2))\n#define USE_DITHER \nfloat gradientNoise(in vec2 uv){const vec3 magic=vec3(0.06711056,0.00583715,52.9829189);return fract(magic.z*fract(dot(uv,magic.xy)));}void main(){float normalizedHeight=(worldPosition.y+radius)/(radius*2.);float ratio=smoothstep(0.,0.5,normalizedHeight);vec3 colorFromGradient=mix(SRGB_TO_LINEAR(bottomColor),SRGB_TO_LINEAR(topColor),ratio);vec3 color=LINEAR_TO_SRGB(colorFromGradient);\n#if defined (USE_DITHER)\ncolor+=(1./255.)*gradientNoise(gl_FragCoord.xy)-(0.5/255.);\n#endif\ngl_FragColor=vec4(color,1.);}"},11387:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec4 worldPosition;void main(){worldPosition=modelMatrix*vec4(position,1.);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},82410:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;uniform sampler2D tMask;uniform sampler2D tPinHole;uniform vec3 pinColor;uniform float opacity;void main(){vec4 maskColor=texture2D(tMask,vUv);vec4 pinHoleColor=vec4(texture2D(tPinHole,vec2(vUv.x,vUv.y-0.11)).xyz,1.);float redness=maskColor.r-maskColor.b;vec4 mixedPinColor=mix(vec4(pinColor,1.),pinHoleColor,redness);mixedPinColor.a=min(mixedPinColor.a,maskColor.a)*opacity;gl_FragColor=mixedPinColor;}"},36973:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},32172:e=>{e.exports="precision highp float;precision highp int;uniform samplerCube tMap;varying vec3 vUvw;void main(){vec4 color=textureCube(tMap,vec3(-vUvw.x,vUvw.yz));gl_FragColor=vec4(color.rgb,1.);}"},80633:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;attribute vec3 position;varying vec3 vUvw;void main(){vUvw=position;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},58324:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;uniform float progress;uniform float opacity;uniform sampler2D tNoHover;uniform sampler2D tHover;uniform sampler2D tPortal;void main(){vec4 noHoverColor=texture2D(tNoHover,vUv);vec4 hoverColor=texture2D(tHover,vUv);vec4 portalColor=texture2D(tPortal,vUv);float xToCtr=2.*vUv.x-1.;float yToCtr=2.*vUv.y-1.;float withinRadius=step(xToCtr*xToCtr+yToCtr*yToCtr,0.9);vec4 mixedPortalColor=mix(hoverColor,portalColor,withinRadius);mixedPortalColor=mix(mixedPortalColor,hoverColor,hoverColor.a);mixedPortalColor=mix(noHoverColor,mixedPortalColor,progress);mixedPortalColor.a=min(mixedPortalColor.a,opacity);gl_FragColor=mixedPortalColor;}"},63069:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},30202:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;varying vec3 vWorldPos;uniform float alpha;uniform samplerCube tDiffuse;void main(){vec4 texColor=textureCube(tDiffuse,vWorldPos);gl_FragColor=vec4(texColor.rgb,texColor.a*alpha);}"},49125:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec3 vWorldPos;void main(){vWorldPos=vec3(-position.x,-position.y,position.z);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},87686:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;varying vec2 vUv;uniform sampler2D tDiffuse;\n#ifdef INSTANCED\nvarying float alpha;\n#else\nuniform float alpha;\n#endif\nvoid main(){vec4 texColor=texture2D(tDiffuse,vUv);gl_FragColor=vec4(texColor.rgb,texColor.a*alpha);}"},64656:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;\n#ifdef INSTANCED\nattribute mat4 instanceMatrix;attribute float instanceAlpha;varying float alpha;\n#endif\nvarying vec2 vUv;void main(){vUv=uv;\n#ifdef INSTANCED\nmat4 mvp=projectionMatrix*modelViewMatrix*instanceMatrix;alpha=instanceAlpha;\n#else\nmat4 mvp=projectionMatrix*modelViewMatrix;\n#endif\ngl_Position=mvp*vec4(position,1.);}"},60348:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform vec3 color;uniform float opacity;void main(){gl_FragColor=vec4(color,opacity);}"},79933:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;void main(){gl_Position=vec4(position,1.);}"},89130:e=>{e.exports="precision highp float;precision highp int;uniform mat4 viewMatrix;uniform vec3 cameraPosition;uniform float opacity;uniform float discRadius;uniform vec3 discNormal;varying vec3 vFragWorldPos;varying vec3 vCenterWorldPos;\n#ifdef USE_TEXTURE\nuniform sampler2D texture;\n#else\nuniform vec2 ringRadii[RING_COUNT];uniform vec4 ringColors[RING_COUNT];\n#endif\nfloat rayDistToPlane(vec3 rayOrigin,vec3 rayDir,vec3 planeOrigin,vec3 planeNormal){float planeConstant=-dot(planeOrigin,planeNormal);float denom=dot(planeNormal,rayDir);return denom==0.?-1e9:-(dot(rayOrigin,planeNormal)+planeConstant)/denom;}vec4 getColorAtRay(vec3 rayOrigin,vec3 rayDir){vec4 color=vec4(0.);float intersectDist=rayDistToPlane(rayOrigin,rayDir,vCenterWorldPos,discNormal);vec3 intersect=rayOrigin+rayDir*intersectDist;\n#ifdef USE_TEXTURE\nif(intersectDist>0.){vec3 stableDir=abs(discNormal.y)>0.8?normalize((vCenterWorldPos-rayOrigin)*vec3(1.,0.,1.))*sign(discNormal.y):vec3(0.,1.,0.);vec3 xAxis=normalize(cross(stableDir,discNormal));vec3 yAxis=normalize(cross(discNormal,xAxis));intersect-=vCenterWorldPos;vec2 uv=vec2(dot(xAxis,intersect),dot(yAxis,intersect))/discRadius/2.+0.5;if(clamp(uv,vec2(0.),vec2(1.))==uv){color=texture2D(texture,uv);}}\n#else\nfloat fragRadius=intersectDist>0.?distance(intersect,vCenterWorldPos):1e9;if(fragRadius<=discRadius*2.){for(int i=0;i<RING_COUNT;i++){vec2 radii=ringRadii[i]*discRadius;vec4 ringColor=ringColors[i];float ringDist=min(fragRadius-radii[0],radii[1]-fragRadius);\n#if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\nfloat delta=length(vec2(dFdx(fragRadius),dFdy(fragRadius)))*0.70710678;ringColor.a*=smoothstep(-delta,delta,ringDist);\n#else\nringColor.a*=step(0.,ringDist);\n#endif\ncolor=vec4(color.rgb,1.)*color.a+ringColor*(1.-color.a);}}\n#endif\nreturn color;}void main(){vec3 rayDir=normalize(vFragWorldPos-cameraPosition);gl_FragColor=getColorAtRay(cameraPosition,rayDir);gl_FragColor.a*=opacity;if(gl_FragColor.a==0.){discard;}}"},20094:e=>{e.exports="precision highp float;precision highp int;uniform mat4 modelMatrix;uniform mat4 modelViewMatrix;uniform mat4 projectionMatrix;uniform mat4 viewMatrix;uniform mat3 normalMatrix;uniform vec3 cameraPosition;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;varying vec3 vCenterWorldPos;varying vec3 vFragWorldPos;void main(){vCenterWorldPos=(modelMatrix*vec4(0.,0.,0.,1.)).xyz;vFragWorldPos=(modelMatrix*vec4(position,1.)).xyz;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"},49329:(e,t,n)=>{e.exports=n(60516).Observable},60516:(e,t)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}t.Observable=void 0;var r=function(){return"function"==typeof Symbol},o=function(e){return r()&&Boolean(Symbol[e])},a=function(e){return o(e)?Symbol[e]:"@@"+e};r()&&!o("observable")&&(Symbol.observable=Symbol("observable"));var l=a("iterator"),c=a("observable"),d=a("species");function u(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function h(e){var t=e.constructor;return void 0!==t&&null===(t=t[d])&&(t=void 0),void 0!==t?t:T}function p(e){return e instanceof T}function m(e){m.log?m.log(e):setTimeout((function(){throw e}))}function f(e){Promise.resolve().then((function(){try{e()}catch(e){m(e)}}))}function g(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=u(t,"unsubscribe");n&&n.call(t)}}catch(e){m(e)}}function v(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function y(e,t,n){e._state="running";var i=e._observer;try{var s=u(i,t);switch(t){case"next":s&&s.call(i,n);break;case"error":if(v(e),!s)throw n;s.call(i,n);break;case"complete":v(e),s&&s.call(i)}}catch(e){m(e)}"closed"===e._state?g(e):"running"===e._state&&(e._state="ready")}function b(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void f((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var n=0;n<t.length&&(y(e,t[n].type,t[n].value),"closed"!==e._state);++n);}}(e)}))):void y(e,t,n);e._queue.push({type:t,value:n})}}var S=function(){function e(t,i){n(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var s=new E(this);try{this._cleanup=i.call(void 0,s)}catch(e){s.error(e)}"initializing"===this._state&&(this._state="ready")}return s(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(v(this),g(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),E=function(){function e(t){n(this,e),this._subscription=t}return s(e,[{key:"next",value:function(e){b(this._subscription,"next",e)}},{key:"error",value:function(e){b(this._subscription,"error",e)}},{key:"complete",value:function(){b(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),T=function(){function e(t){if(n(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return s(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new S(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise((function(n,i){if("function"==typeof e)var s=t.subscribe({next:function(t){try{e(t,r)}catch(e){i(e),s.unsubscribe()}},error:i,complete:n});else i(new TypeError(e+" is not a function"));function r(){s.unsubscribe(),n()}}))}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(h(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(h(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=h(this),i=arguments.length>1,s=!1,r=arguments[1],o=r;return new n((function(n){return t.subscribe({next:function(t){var r=!s;if(s=!0,!r||i)try{o=e(o,t)}catch(e){return n.error(e)}else o=t},error:function(e){n.error(e)},complete:function(){if(!s&&!i)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(o),n.complete()}})}))}},{key:"concat",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var s=h(this);return new s((function(t){var i,r=0;return function e(o){i=o.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){r===n.length?(i=void 0,t.complete()):e(s.from(n[r++]))}})}(e),function(){i&&(i.unsubscribe(),i=void 0)}}))}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=h(this);return new n((function(i){var s=[],r=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return i.error(e)}var r=n.from(t).subscribe({next:function(e){i.next(e)},error:function(e){i.error(e)},complete:function(){var e=s.indexOf(r);e>=0&&s.splice(e,1),o()}});s.push(r)},error:function(e){i.error(e)},complete:function(){o()}});function o(){r.closed&&0===s.length&&i.complete()}return function(){s.forEach((function(e){return e.unsubscribe()})),r.unsubscribe()}}))}},{key:c,value:function(){return this}}],[{key:"from",value:function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var i=u(t,c);if(i){var s=i.call(t);if(Object(s)!==s)throw new TypeError(s+" is not an object");return p(s)&&s.constructor===n?s:new n((function(e){return s.subscribe(e)}))}if(o("iterator")&&(i=u(t,l)))return new n((function(e){f((function(){if(!e.closed){var n=!0,s=!1,r=void 0;try{for(var o,a=i.call(t)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(e.next(l),e.closed)return}}catch(e){s=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(s)throw r}}e.complete()}}))}));if(Array.isArray(t))return new n((function(e){f((function(){if(!e.closed){for(var n=0;n<t.length;++n)if(e.next(t[n]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var s="function"==typeof this?this:e;return new s((function(e){f((function(){if(!e.closed){for(var t=0;t<n.length;++t)if(e.next(n[t]),e.closed)return;e.complete()}}))}))}},{key:d,get:function(){return this}}]),e}();t.Observable=T,r()&&Object.defineProperty(T,Symbol("extensions"),{value:{symbol:c,hostReportError:m},configurable:!0})},98443:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FileAttachments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fileAttachmentsByModelId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"results"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileAttachmentDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteExternalAttachment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParentType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteExternalAttachment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"attachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}},{kind:"Argument",name:{kind:"Name",value:"parentType"},value:{kind:"Variable",name:{kind:"Name",value:"parentType"}}},{kind:"Argument",name:{kind:"Name",value:"parentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RemoveFileAttachment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ParentType"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"removeFileAttachment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"attachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}},{kind:"Argument",name:{kind:"Name",value:"parentType"},value:{kind:"Variable",name:{kind:"Name",value:"parentType"}}},{kind:"Argument",name:{kind:"Name",value:"parentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteFileAttachment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteFileAttachment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadFileAttachmentToModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"organizationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contents"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileUpload"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filename"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uploadFileAttachmentToModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"organizationId"},value:{kind:"Variable",name:{kind:"Name",value:"organizationId"}}},{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"contents"},value:{kind:"Variable",name:{kind:"Name",value:"contents"}}},{kind:"Argument",name:{kind:"Name",value:"filename"},value:{kind:"Variable",name:{kind:"Name",value:"filename"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileAttachmentDetails"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"FileAttachmentDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FileAttachment"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validUntil"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"bytes"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mimeType"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ImageFileAttachment"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageWidth"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"imageHeight"},arguments:[],directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"ExternalAttachmentDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExternalAttachment"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mediaType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"category"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parentDetails"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"parent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:1683}};t.loc.source={body:"\n# read all attachments for the specified model\nquery FileAttachments($modelId: ID!) {\n  fileAttachmentsByModelId(modelId: $modelId) {\n    results { ...FileAttachmentDetails }\n  }\n}\n\n# Deletes a single external attachment\nmutation DeleteExternalAttachment($modelId: ID!, $attachmentId: ID!, $parentType: ParentType!, $parentId: ID!) {\n  deleteExternalAttachment(modelId: $modelId, , attachmentId: $attachmentId, parentType: $parentType, parentId: $parentId)\n}\n\n# Removes a file attachment association from the annotation it is attached to.\n# Can delete the file attachment completely if the 'cascadeDelete' flag is set to true (not currently used)\nmutation RemoveFileAttachment($modelId: ID!, $attachmentId: ID!, $parentType: ParentType!, $parentId: ID!) {\n  removeFileAttachment(modelId: $modelId, , attachmentId: $attachmentId, parentType: $parentType, parentId: $parentId)\n}\n\nmutation DeleteFileAttachment($id: ID!) {\n  deleteFileAttachment(id: $id)\n}\n\nmutation UploadFileAttachmentToModel($organizationId: ID!, $modelId: ID!, $contents: FileUpload!, $filename: String!) {\n  uploadFileAttachmentToModel(organizationId: $organizationId, modelId: $modelId,\n                              contents: $contents, filename: $filename) {\n    ...FileAttachmentDetails\n  }\n}\n\nfragment FileAttachmentDetails on FileAttachment {\n  id\n  created\n  filename\n  url\n  validUntil\n  bytes\n  mimeType\n  ...on ImageFileAttachment {\n      imageWidth\n      imageHeight\n  }\n}\n\n# common External Attachment properties\nfragment ExternalAttachmentDetails on ExternalAttachment {\n  id\n  created\n  modified\n  thumbnailUrl\n  url\n  mediaType\n  width\n  height\n  category\n  parentDetails { type, parent { id } }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.FileAttachments=r(t,"FileAttachments"),e.exports.DeleteExternalAttachment=r(t,"DeleteExternalAttachment"),e.exports.RemoveFileAttachment=r(t,"RemoveFileAttachment"),e.exports.DeleteFileAttachment=r(t,"DeleteFileAttachment"),e.exports.UploadFileAttachmentToModel=r(t,"UploadFileAttachmentToModel"),e.exports.FileAttachmentDetails=r(t,"FileAttachmentDetails"),e.exports.ExternalAttachmentDetails=r(t,"ExternalAttachmentDetails")},70129:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddCommentAttachments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"externalAttachments"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ExternalAttachmentDetails"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileAttachments"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addCommentAttachments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"commentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"Argument",name:{kind:"Name",value:"externalAttachments"},value:{kind:"Variable",name:{kind:"Name",value:"externalAttachments"}}},{kind:"Argument",name:{kind:"Name",value:"fileAttachments"},value:{kind:"Variable",name:{kind:"Name",value:"fileAttachments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CommentAttachments"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"commentId"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"commentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CommentPatch"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"commentId"},value:{kind:"Variable",name:{kind:"Name",value:"commentId"}}},{kind:"Argument",name:{kind:"Name",value:"patch"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CommentDetails"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"CommentDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Comment"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"edited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"text"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"firstName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"externalAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ExternalAttachmentDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"fileAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileAttachmentDetails"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"CommentAttachments"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Comment"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"externalAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ExternalAttachmentDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"fileAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileAttachmentDetails"},directives:[]}]}}]}}],loc:{start:0,end:1211}};i.loc.source={body:'#import "./attachments.gql"\n\n# Add comment attachments\nmutation AddCommentAttachments($modelId: ID!, $parentId: ID!, $externalAttachments: [ExternalAttachmentDetails!], $fileAttachments: [ID!]) {\n  addCommentAttachments(modelId: $modelId, , commentId: $parentId,\n                        externalAttachments: $externalAttachments,\n                        fileAttachments: $fileAttachments) {\n    ...CommentAttachments\n  }\n}\n\n# Deletes a single comment\nmutation DeleteComment ($modelId: ID!, $commentId: ID!) {\n  deleteComment(modelId: $modelId, , commentId: $commentId)\n}\n\n# Update a single comment\nmutation PatchComment($modelId: ID!, $commentId: ID!, $data: CommentPatch!) {\n  patchComment(modelId: $modelId, , commentId: $commentId, patch: $data) {\n    ...CommentDetails\n  }\n}\n\n# common Comment properties\nfragment CommentDetails on Comment {\n  id\n  created\n  modified\n  edited\n  text\n  createdBy { id, firstName, lastName, email }\n  externalAttachments { ...ExternalAttachmentDetails }\n  fileAttachments { ...FileAttachmentDetails }\n}\n\n# Attachments on a Comment\nfragment CommentAttachments on Comment {\n  externalAttachments { ...ExternalAttachmentDetails }\n  fileAttachments { ...FileAttachmentDetails }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){r(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){r(e,t)})),e.definitions&&e.definitions.forEach((function(e){r(e,t)}))}i.definitions=i.definitions.concat(n(98443).definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)})));var o={};function a(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function l(e,t){var n={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=o[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){s.has(e)||(s.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=a(e,t);i&&n.definitions.push(i)})),n}i.definitions.forEach((function(e){if(e.name){var t=new Set;r(e,t),o[e.name.value]=t}})),e.exports=i,e.exports.AddCommentAttachments=l(i,"AddCommentAttachments"),e.exports.DeleteComment=l(i,"DeleteComment"),e.exports.PatchComment=l(i,"PatchComment"),e.exports.CommentDetails=l(i,"CommentDetails"),e.exports.CommentAttachments=l(i,"CommentAttachments")},81047:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetFloors"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FloorDetails"},directives:[]}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"FloorDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ModelFloor"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"classification"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sequence"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dimensions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"areaFloor"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchFloor"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"floorId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FloorPatch"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchFloor"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"floorId"},value:{kind:"Variable",name:{kind:"Name",value:"floorId"}}},{kind:"Argument",name:{kind:"Name",value:"patch"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:380}};t.loc.source={body:"query GetFloors($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    floors { ...FloorDetails }\n  }\n}\n\nfragment FloorDetails on ModelFloor {\n  id\n  meshId\n  classification\n  label\n  sequence\n  dimensions {\n    areaFloor\n  }\n}\n\nmutation PatchFloor($modelId: ID!, $floorId: ID!, $data: FloorPatch!) {\n  patchFloor(modelId: $modelId, , floorId: $floorId, patch: $data) {\n    id\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetFloors=r(t,"GetFloors"),e.exports.FloorDetails=r(t,"FloorDetails"),e.exports.PatchFloor=r(t,"PatchFloor")},95162:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetLabels"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"labels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"LabelDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddLabel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"labelId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LabelDetails"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addLabel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"labelId"},value:{kind:"Variable",name:{kind:"Name",value:"labelId"}}},{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"LabelDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchLabel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"labelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"LabelPatch"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchLabel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"labelId"},value:{kind:"Variable",name:{kind:"Name",value:"labelId"}}},{kind:"Argument",name:{kind:"Name",value:"patch"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"LabelDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteLabel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"labelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteLabel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"labelId"},value:{kind:"Variable",name:{kind:"Name",value:"labelId"}}}],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"LabelDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Label"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"floor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"room"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]}]}}],loc:{start:0,end:929}};t.loc.source={body:"# Read all labels for the given model\nquery GetLabels($modelId: ID!, $includeDisabled: Boolean!) {\n  model(id: $modelId) {\n    id,\n    labels (includeDisabled: $includeDisabled) {\n      ...LabelDetails\n    }\n  }\n}\n\n# Create a new label\nmutation AddLabel ($modelId: ID!, $labelId: ID, $data: LabelDetails!) {\n  addLabel(modelId: $modelId, labelId: $labelId, label: $data) {\n    ...LabelDetails\n  }\n}\n\n# Update a single label\nmutation PatchLabel ($modelId: ID!, $labelId: ID!, $data: LabelPatch!) {\n  patchLabel(modelId: $modelId, , labelId: $labelId, patch: $data) {\n    ...LabelDetails\n  }\n}\n\n# Deletes a single label\nmutation DeleteLabel ($modelId: ID!, ,$labelId: ID!) {\n  deleteLabel(modelId: $modelId, ,labelId: $labelId)\n}\n\n# Default Label properties used by Showcase and Workshop\nfragment LabelDetails on Label {\n  id\n  position { x y z }\n  floor { id meshId }\n  room { id meshId }\n  label\n  enabled\n  created\n  modified\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetLabels=r(t,"GetLabels"),e.exports.AddLabel=r(t,"AddLabel"),e.exports.PatchLabel=r(t,"PatchLabel"),e.exports.DeleteLabel=r(t,"DeleteLabel"),e.exports.LabelDetails=r(t,"LabelDetails")},60344:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetOrderedLists"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orderedLists"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"ListValue",values:[]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"EntryDetails"},directives:[]}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetOrderedListByName"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"label"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orderedLists"},arguments:[{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"label"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"EntryDetails"},directives:[]}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddOrderedList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"label"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entries"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntryInput"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addOrderedList"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"label"}}},{kind:"Argument",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"Argument",name:{kind:"Name",value:"entries"},value:{kind:"Variable",name:{kind:"Name",value:"entries"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"EntryDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchOrderedList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"orderedListId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"label"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"entries"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EntryInput"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchOrderedList"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"orderedListId"},value:{kind:"Variable",name:{kind:"Name",value:"orderedListId"}}},{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"label"}}},{kind:"Argument",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"Argument",name:{kind:"Name",value:"entries"},value:{kind:"Variable",name:{kind:"Name",value:"entries"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"OrderedListDetails"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"OrderedListDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OrderedList"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"entries"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"EntryDetails"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"EntryDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Entry"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]}]}}],loc:{start:0,end:1337}};t.loc.source={body:"\n# get the ordered lists for the specified model\nquery GetOrderedLists($modelId: ID!) {\n  model(id: $modelId) {\n    orderedLists(ids: []) {\n      label\n      id\n      entries {\n        ...EntryDetails\n      }\n    }\n  }\n}\n\n# get an ordered list by name for the specified view\nquery GetOrderedListByName($modelId: ID!, $label: String!) {\n  model(id: $modelId) {\n    orderedLists(label: $label) {\n      label\n      id\n      entries {\n        ...EntryDetails\n      }\n    }\n  }\n}\n\n# add a new ordered list\nmutation AddOrderedList($modelId: ID!, $label: String!, $description: String!, $entries: [EntryInput!]) {\n  addOrderedList(modelId: $modelId, , label: $label, description: $description, entries: $entries) {\n    id\n    label\n    entries {\n      ...EntryDetails\n    }\n  }\n}\n\n# patch an existing ordered list\nmutation PatchOrderedList($modelId: ID!, $orderedListId: ID!, $label: String!, $description: String!, $entries: [EntryInput!]) {\n  patchOrderedList(modelId: $modelId, , orderedListId: $orderedListId, label: $label, description: $description, entries: $entries) {\n    ...OrderedListDetails\n  }\n}\n\n# Default OrderedList properties used by Showcase and Workshop\nfragment OrderedListDetails on OrderedList {\n  id\n  label\n  entries {\n    ...EntryDetails\n  }\n}\n\n# Default Entry properties\nfragment EntryDetails on Entry {\n  id\n  type\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetOrderedLists=r(t,"GetOrderedLists"),e.exports.GetOrderedListByName=r(t,"GetOrderedListByName"),e.exports.AddOrderedList=r(t,"AddOrderedList"),e.exports.PatchOrderedList=r(t,"PatchOrderedList"),e.exports.OrderedListDetails=r(t,"OrderedListDetails"),e.exports.EntryDetails=r(t,"EntryDetails")},6850:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetMattertags"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mattertags"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MattertagDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"RefreshTagFileAttachments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mattertags"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fileAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileAttachmentDetails"},directives:[]}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddMattertag"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mattertagId"}},type:{kind:"NamedType",name:{kind:"Name",value:"ID"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MattertagDetails"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addMattertag"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"mattertagId"},value:{kind:"Variable",name:{kind:"Name",value:"mattertagId"}}},{kind:"Argument",name:{kind:"Name",value:"mattertag"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteMattertag"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mattertagId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteMattertag"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"mattertagId"},value:{kind:"Variable",name:{kind:"Name",value:"mattertagId"}}}],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"MattertagDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Mattertag"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"color"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"room"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anchorPosition"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"stemEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"stemNormal"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"stemLength"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"media"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mediaType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"externalAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ExternalAttachmentDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"fileAttachments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FileAttachmentDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"objectAnnotation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"classification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultKeywords"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"keywords"},arguments:[],directives:[]}]}}],loc:{start:0,end:1451}};i.loc.source={body:'#import "./attachments.gql"\n\n# read all mattertags for the specified model\nquery GetMattertags($modelId: ID!, $includeDisabled: Boolean!) {\n  model(id: $modelId) {\n    id,\n    mattertags(includeDisabled: $includeDisabled) {\n      ...MattertagDetails\n    }\n  }\n}\n\n# refresh file attachment expiring resources for all mattertags\nquery RefreshTagFileAttachments($modelId: ID!, $includeDisabled: Boolean!) {\n  model(id: $modelId) {\n    id,\n    mattertags(includeDisabled: $includeDisabled) {\n      id\n      fileAttachments { ...FileAttachmentDetails }\n    }\n  }\n}\n\n# add a new mattertag\nmutation AddMattertag($modelId:ID!, $mattertagId: ID, $data: MattertagDetails!) {\n  addMattertag(modelId: $modelId, mattertagId: $mattertagId, mattertag: $data) {\n    id\n    created\n    modified\n  }\n}\n\n# delete an existing tag by id\nmutation DeleteMattertag($modelId: ID!, $mattertagId: ID!) {\n  deleteMattertag(modelId: $modelId, mattertagId: $mattertagId)\n}\n\n# common Mattertag properties used by Showcase and Workshop\nfragment MattertagDetails on Mattertag {\n  id\n  label\n  description\n  color\n  enabled\n  floor { id, meshId }\n  room { id, meshId }\n  anchorPosition { x y z }\n  stemEnabled\n  stemNormal { x, y, z }\n  stemLength\n  media\n  mediaType\n  created\n  modified\n  externalAttachments { ...ExternalAttachmentDetails }\n  fileAttachments { ...FileAttachmentDetails }\n  objectAnnotation {\n    id\n    classification {\n      defaultKeywords\n    }\n  }\n  keywords\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){r(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){r(e,t)})),e.definitions&&e.definitions.forEach((function(e){r(e,t)}))}i.definitions=i.definitions.concat(n(98443).definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)})));var o={};function a(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function l(e,t){var n={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=o[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){s.has(e)||(s.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=a(e,t);i&&n.definitions.push(i)})),n}i.definitions.forEach((function(e){if(e.name){var t=new Set;r(e,t),o[e.name.value]=t}})),e.exports=i,e.exports.GetMattertags=l(i,"GetMattertags"),e.exports.RefreshTagFileAttachments=l(i,"RefreshTagFileAttachments"),e.exports.AddMattertag=l(i,"AddMattertag"),e.exports.DeleteMattertag=l(i,"DeleteMattertag"),e.exports.MattertagDetails=l(i,"MattertagDetails")},37946:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetMeasurements"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"measurementPaths"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"Variable",name:{kind:"Name",value:"includeDisabled"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MeasurementDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddMeasurement"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MeasurementPathDetails"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addMeasurementPath"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"path"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchMeasurement"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pathId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MeasurementPathPatch"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchMeasurementPath"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"pathId"},value:{kind:"Variable",name:{kind:"Name",value:"pathId"}}},{kind:"Argument",name:{kind:"Name",value:"patch"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteMeasurement"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pathId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteMeasurementPath"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"pathId"},value:{kind:"Variable",name:{kind:"Name",value:"pathId"}}}],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"MeasurementDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeasurementPath"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lineType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"points"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"floor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"room"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]}]}}],loc:{start:0,end:835}};t.loc.source={body:"\nquery GetMeasurements($modelId: ID!, $includeDisabled: Boolean!) {\n  model(id: $modelId) {\n    id,\n    measurementPaths(includeDisabled: $includeDisabled) {\n      ...MeasurementDetails\n    }\n  }\n}\n\nmutation AddMeasurement($modelId: ID!, $data: MeasurementPathDetails!) {\n  addMeasurementPath(modelId: $modelId, , path: $data) {\n    id\n  }\n}\n\nmutation PatchMeasurement($modelId: ID!, $pathId: ID!, $data: MeasurementPathPatch!) {\n  patchMeasurementPath(modelId: $modelId, , pathId: $pathId, patch: $data) {\n    id\n  }\n}\n\nmutation DeleteMeasurement($modelId: ID!, $pathId: ID!) {\n  deleteMeasurementPath(modelId: $modelId, , pathId: $pathId)\n}\n\nfragment MeasurementDetails on MeasurementPath {\n  id\n  lineType\n  label\n  enabled\n  points {\n    position { x y z }\n    floor { id meshId }\n    room { id meshId }\n  }\n  created\n  modified\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetMeasurements=r(t,"GetMeasurements"),e.exports.AddMeasurement=r(t,"AddMeasurement"),e.exports.PatchMeasurement=r(t,"PatchMeasurement"),e.exports.DeleteMeasurement=r(t,"DeleteMeasurement"),e.exports.MeasurementDetails=r(t,"MeasurementDetails")},97997:e=>{var t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ModelAvailableAssets"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Model"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"assets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meshes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"formats"},value:{kind:"StringValue",value:"dam",block:!1}},{kind:"Argument",name:{kind:"Name",value:"resolutions"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"50k",block:!1},{kind:"StringValue",value:"500k",block:!1}]}},{kind:"Argument",name:{kind:"Name",value:"compressions"},value:{kind:"EnumValue",value:"none"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MeshDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"textures"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TextureDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"tilesets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"TilesetDetails"},directives:[]}]}}]}},{kind:"Field",alias:{kind:"Name",value:"lod"},name:{kind:"Name",value:"policy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"StringValue",value:"spaces.chunked.mesh.lod",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PolicyOptions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"ModelStatus"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Model"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"MeshDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Mesh"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validUntil"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"TextureDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Texture"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"quality"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"urlTemplate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validUntil"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"TilesetDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Tileset"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tilesetVersion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"urlTemplate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validUntil"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tilesetDepth"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tilesetPreset"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PublicationDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ModelPublicationDetails"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"address"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"published"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastPublished"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"presentedBy"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"summary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"externalUrl"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"contact"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"phoneNumber"},arguments:[],directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"ModelOptions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ModelOptions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"backgroundColor"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dollhouseEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dollhouseLabelsEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floorSelectEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floorplanEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"highlightReelEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"labelsEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"measurements"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"socialSharingEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"spaceSearchEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourButtonsEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourDollhousePanSpeed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourFastTransitionsEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourPanAngle"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourPanDirection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourPanSpeed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourTransitionSpeed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourTransitionTime"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tourZoomDuration"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unitType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"vrEnabled"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"PublicationOptions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ModelPublicationOptions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"contactEmail"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"contactName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"contactPhone"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelSummary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"presentedBy"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"address"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"externalUrl"},arguments:[],directives:[]}]}}],loc:{start:0,end:1582}};t.loc.source={body:'fragment ModelAvailableAssets on Model {\n  assets {\n    meshes(formats: "dam", resolutions: ["50k", "500k"], compressions: none) { ...MeshDetails }\n    textures { ...TextureDetails }\n    tilesets { ...TilesetDetails }\n  }\n  lod: policy(name: "spaces.chunked.mesh.lod") {\n    ... on PolicyOptions {\n      options\n    }\n  }\n}\n\nfragment ModelStatus on Model {\n  state\n}\n\nfragment MeshDetails on Mesh {\n  id\n  status\n  filename\n  format\n  resolution\n  url\n  validUntil\n}\n\nfragment TextureDetails on Texture {\n  id\n  status\n  format\n  resolution\n  quality\n  urlTemplate\n  validUntil\n}\n\nfragment TilesetDetails on Tileset {\n  status\n  tilesetVersion\n  url\n  urlTemplate\n  validUntil\n  tilesetDepth\n  tilesetPreset\n}\n\nfragment PublicationDetails on ModelPublicationDetails {\n  address\n  published\n  lastPublished\n  presentedBy\n  summary\n  externalUrl\n  contact {\n    name\n    email\n    phoneNumber\n  }\n}\n\nfragment ModelOptions on ModelOptions {\n  backgroundColor\n  dollhouseEnabled\n  dollhouseLabelsEnabled\n  floorSelectEnabled\n  floorplanEnabled\n  highlightReelEnabled\n  labelsEnabled\n  measurements\n  socialSharingEnabled\n  spaceSearchEnabled\n  tourButtonsEnabled\n  tourDollhousePanSpeed\n  tourFastTransitionsEnabled\n  tourPanAngle\n  tourPanDirection\n  tourPanSpeed\n  tourTransitionSpeed\n  tourTransitionTime\n  tourZoomDuration\n  unitType\n  vrEnabled\n  # disable until platform 21.9.2 release\n  # urlBrandingEnabled\n}\n\nfragment PublicationOptions on ModelPublicationOptions {\n  contactEmail\n  contactName\n  contactPhone\n  modelName\n  modelSummary\n  presentedBy\n  address\n  externalUrl\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.ModelAvailableAssets=r(t,"ModelAvailableAssets"),e.exports.ModelStatus=r(t,"ModelStatus"),e.exports.MeshDetails=r(t,"MeshDetails"),e.exports.TextureDetails=r(t,"TextureDetails"),e.exports.TilesetDetails=r(t,"TilesetDetails"),e.exports.PublicationDetails=r(t,"PublicationDetails"),e.exports.ModelOptions=r(t,"ModelOptions"),e.exports.PublicationOptions=r(t,"PublicationOptions")},91985:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelOptions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"publication"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PublicationOptions"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelOptions"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"organization"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"visibility"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"discoverable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ModelStatus"},directives:[]},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"publication"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PublicationDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelOptions"},directives:[]}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"ModelAvailableAssets"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchModel"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"patch"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ModelPatch"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchModel"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"patch"},value:{kind:"Variable",name:{kind:"Name",value:"patch"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:653}};i.loc.source={body:'#import "./model-fragments.gql"\n#import "./photo-fragments.gql"\n\nquery GetModelOptions($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    publication {\n      options { ...PublicationOptions }\n    }\n    options { ...ModelOptions }\n  }\n}\n\nquery GetModelDetails($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    name\n    organization\n    visibility\n    discoverable\n    created\n    ...ModelStatus\n    image { ...PhotoDetails }\n    publication { ...PublicationDetails }\n    options { ...ModelOptions }\n    ...ModelAvailableAssets\n  }\n}\n\nmutation PatchModel($modelId: ID!, $patch: ModelPatch!) {\n  patchModel(id: $modelId, , patch: $patch) {\n    id\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)}))}function o(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,t)})),e.definitions&&e.definitions.forEach((function(e){o(e,t)}))}i.definitions=i.definitions.concat(r(n(97997).definitions)),i.definitions=i.definitions.concat(r(n(22164).definitions));var a={};function l(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function c(e,t){var n={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=a[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(a[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=l(e,t);i&&n.definitions.push(i)})),n}i.definitions.forEach((function(e){if(e.name){var t=new Set;o(e,t),a[e.name.value]=t}})),e.exports=i,e.exports.GetModelOptions=c(i,"GetModelOptions"),e.exports.GetModelDetails=c(i,"GetModelDetails"),e.exports.PatchModel=c(i,"PatchModel")},11764:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetNotes"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"notes"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"NoteDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NoteDetails"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"note"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"NoteDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddNoteComment"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"noteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CommentDetails"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addNoteComment"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"noteId"},value:{kind:"Variable",name:{kind:"Name",value:"noteId"}}},{kind:"Argument",name:{kind:"Name",value:"comment"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CommentDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"noteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"noteId"},value:{kind:"Variable",name:{kind:"Name",value:"noteId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"noteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"data"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"NotePatch"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"noteId"},value:{kind:"Variable",name:{kind:"Name",value:"noteId"}}},{kind:"Argument",name:{kind:"Name",value:"patch"},value:{kind:"Variable",name:{kind:"Name",value:"data"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"NoteDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ReopenNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"noteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"reopenNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"noteId"},value:{kind:"Variable",name:{kind:"Name",value:"noteId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ResolveNote"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"noteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolveNote"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"noteId"},value:{kind:"Variable",name:{kind:"Name",value:"noteId"}}}],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"NoteDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Note"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"createdBy"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"firstName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"color"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"room"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anchorPosition"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"stemEnabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"stemNormal"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"stemLength"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastCommentAt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"comments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"results"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CommentDetails"},directives:[]}]}}]}}]}}],loc:{start:0,end:1499}};i.loc.source={body:'#import "./attachments.gql"\n#import "./comments.gql"\n\n# read all notes for the specified model\nquery GetNotes($modelId: ID!, $ids: [ID!]) {\n  model(id: $modelId) {\n    id\n    notes(ids: $ids) {\n      ...NoteDetails\n    }\n  }\n}\n\n# Create a new note\nmutation AddNote($modelId: ID!, $data: NoteDetails!) {\n  addNote(modelId: $modelId, , note: $data) {\n    ...NoteDetails\n  }\n}\n\n# Add a comment to the note\nmutation AddNoteComment($modelId: ID!, $noteId: ID!, $data: CommentDetails!) {\n  addNoteComment(modelId: $modelId, , noteId: $noteId, comment: $data) {\n    ...CommentDetails\n  }\n}\n\n# Deletes a single note\nmutation DeleteNote ($modelId: ID!, $noteId: ID!) {\n  deleteNote(modelId: $modelId, , noteId: $noteId)\n}\n\n# Update a single note\nmutation PatchNote($modelId: ID!, $noteId: ID!, $data: NotePatch!) {\n  patchNote(modelId: $modelId, , noteId: $noteId, patch: $data) {\n    ...NoteDetails\n  }\n}\n\n# Reopen a note\nmutation ReopenNote ($modelId: ID!, $noteId: ID!) {\n  reopenNote(modelId: $modelId, , noteId: $noteId)\n}\n\n# Resolve a note\nmutation ResolveNote($modelId: ID!, $noteId: ID!) {\n  resolveNote(modelId: $modelId, , noteId: $noteId)\n}\n\n# common Note properties\nfragment NoteDetails on Note {\n  id\n  createdBy { id, firstName, lastName, email }\n  color\n  enabled\n  floor { id, meshId }\n  room { id, meshId }\n  anchorPosition { x, y, z }\n  stemEnabled\n  stemNormal { x, y, z }\n  stemLength\n  resolution\n  created\n  modified\n  lastCommentAt\n  comments {\n    results { ...CommentDetails }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)}))}function o(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,t)})),e.definitions&&e.definitions.forEach((function(e){o(e,t)}))}i.definitions=i.definitions.concat(r(n(98443).definitions)),i.definitions=i.definitions.concat(r(n(70129).definitions));var a={};function l(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function c(e,t){var n={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=a[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(a[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=l(e,t);i&&n.definitions.push(i)})),n}i.definitions.forEach((function(e){if(e.name){var t=new Set;o(e,t),a[e.name.value]=t}})),e.exports=i,e.exports.GetNotes=c(i,"GetNotes"),e.exports.AddNote=c(i,"AddNote"),e.exports.AddNoteComment=c(i,"AddNoteComment"),e.exports.DeleteNote=c(i,"DeleteNote"),e.exports.PatchNote=c(i,"PatchNote"),e.exports.ReopenNote=c(i,"ReopenNote"),e.exports.ResolveNote=c(i,"ResolveNote"),e.exports.NoteDetails=c(i,"NoteDetails")},22164:e=>{var t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"PhotoDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Photo"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"classification"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"category"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"filename"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"format"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolutions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"origin"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validUntil"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"thumbnailUrl"},name:{kind:"Name",value:"resizeUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolution"},value:{kind:"EnumValue",value:"thumbnail"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"presentationUrl"},name:{kind:"Name",value:"resizeUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resolution"},value:{kind:"EnumValue",value:"presentation"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"snapshotLocation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"viewMode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"rotation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"w"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"zoom"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floorVisibility"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sequence"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anchor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"pano"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"placement"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:535}};t.loc.source={body:"\nfragment PhotoDetails on Photo {\n  id\n  label\n  classification\n  category\n  height\n  width\n  created\n  modified\n  status\n  filename\n  format\n  url\n  resolutions\n  type\n  origin\n  validUntil\n  thumbnailUrl: resizeUrl(resolution: thumbnail)\n  presentationUrl: resizeUrl(resolution: presentation)\n  snapshotLocation {\n    viewMode\n    position { x y z }\n    rotation { x y z w }\n    zoom\n    floorVisibility {\n      id\n      meshId\n      sequence\n    }\n    anchor {\n      id\n      pano {\n        id\n        placement\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.PhotoDetails=function(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}(t,"PhotoDetails")},70778:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetSnapshots"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assets"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"photos"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PatchPhoto"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"photoId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"label"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"patchPhoto"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"photoId"},value:{kind:"Variable",name:{kind:"Name",value:"photoId"}}},{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"label"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeletePhoto"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"photoId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deletePhoto"},arguments:[{kind:"Argument",name:{kind:"Name",value:"modelId"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"photoId"},value:{kind:"Variable",name:{kind:"Name",value:"photoId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadHighlightReelSnapshot"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contents"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileUpload"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"label"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"snapshotLocation"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SnapshotLocationInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"snapshot"},name:{kind:"Name",value:"uploadHighlightReelSnapshot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"contents"},value:{kind:"Variable",name:{kind:"Name",value:"contents"}}},{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"label"}}},{kind:"Argument",name:{kind:"Name",value:"snapshotLocation"},value:{kind:"Variable",name:{kind:"Name",value:"snapshotLocation"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UploadModelSnapshot"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"contents"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FileUpload"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"label"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"snapshotLocation"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SnapshotLocationInput"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"photoType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PhotoType"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"snapshot"},name:{kind:"Name",value:"uploadModelSnapshot"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"contents"},value:{kind:"Variable",name:{kind:"Name",value:"contents"}}},{kind:"Argument",name:{kind:"Name",value:"label"},value:{kind:"Variable",name:{kind:"Name",value:"label"}}},{kind:"Argument",name:{kind:"Name",value:"snapshotLocation"},value:{kind:"Variable",name:{kind:"Name",value:"snapshotLocation"}}},{kind:"Argument",name:{kind:"Name",value:"photoType"},value:{kind:"Variable",name:{kind:"Name",value:"photoType"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}}]}}],loc:{start:0,end:1048}};i.loc.source={body:'#import "./photo-fragments.gql"\nquery GetSnapshots($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    assets {\n      photos { ...PhotoDetails }\n    }\n  }\n}\n\nmutation PatchPhoto($modelId: ID!, $photoId: ID!, $label: String!) {\n  patchPhoto(modelId: $modelId, photoId: $photoId, label: $label) {\n    ...PhotoDetails\n  }\n}\n\nmutation DeletePhoto($modelId: ID!, $photoId: ID!) {\n  deletePhoto(modelId: $modelId, photoId: $photoId)\n}\n\nmutation UploadHighlightReelSnapshot($modelId: ID!, $contents: FileUpload!, $label: String!, $snapshotLocation: SnapshotLocationInput!) {\n  snapshot: uploadHighlightReelSnapshot(id: $modelId, contents: $contents, label: $label, snapshotLocation: $snapshotLocation) {\n    ...PhotoDetails\n  }\n}\n\nmutation UploadModelSnapshot($modelId: ID!, $contents: FileUpload!, $label: String!, $snapshotLocation: SnapshotLocationInput!, $photoType: PhotoType!) {\n  snapshot: uploadModelSnapshot(id: $modelId, contents: $contents, label: $label, snapshotLocation: $snapshotLocation, photoType: $photoType) {\n    ...PhotoDetails\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){r(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){r(e,t)})),e.definitions&&e.definitions.forEach((function(e){r(e,t)}))}i.definitions=i.definitions.concat(n(22164).definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)})));var o={};function a(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function l(e,t){var n={kind:e.kind,definitions:[a(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=o[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var l=r;r=new Set,l.forEach((function(e){s.has(e)||(s.add(e),(o[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=a(e,t);i&&n.definitions.push(i)})),n}i.definitions.forEach((function(e){if(e.name){var t=new Set;r(e,t),o[e.name.value]=t}})),e.exports=i,e.exports.GetSnapshots=l(i,"GetSnapshots"),e.exports.PatchPhoto=l(i,"PatchPhoto"),e.exports.DeletePhoto=l(i,"DeletePhoto"),e.exports.UploadHighlightReelSnapshot=l(i,"UploadHighlightReelSnapshot"),e.exports.UploadModelSnapshot=l(i,"UploadModelSnapshot")},83531:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelPrefetch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ModelStatus"},directives:[]},{kind:"FragmentSpread",name:{kind:"Name",value:"ModelAvailableAssets"},directives:[]},{kind:"Field",name:{kind:"Name",value:"floors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FloorDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"image"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PhotoDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tags"},value:{kind:"StringValue",value:"showcase",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AnchorLocationDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ModelOptions"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"organization"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"publication"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PublicationDetails"},directives:[]},{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PublicationOptions"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"rooms"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"RoomDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"views"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"visibility"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"discoverable"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:876}};i.loc.source={body:'#import "./model-fragments.gql"\n#import "./photo-fragments.gql"\n#import "./floors.gql"\n#import "./rooms.gql"\n#import "./sweeps.gql"\n\n\n# Preloaded model data to be embedded into Showcase HTML page,\n# only load data that is required for Showcase to start,\n# not varied by user, and safe for long-term-cache type behavior.\n# Includes the default view.\n# (ie. NO Mattertags)\nquery GetModelPrefetch($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    ...ModelStatus\n    ...ModelAvailableAssets\n    floors { ...FloorDetails }\n    image { ...PhotoDetails }\n    locations(tags:"showcase") { ...AnchorLocationDetails }\n    name\n    options { ...ModelOptions }\n    organization\n    publication {\n      ...PublicationDetails\n      options { ...PublicationOptions }\n    }\n    rooms { ...RoomDetails }\n    views {\n      id\n      type\n      name\n    }\n    visibility\n    discoverable\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)}))}function o(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,t)})),e.definitions&&e.definitions.forEach((function(e){o(e,t)}))}i.definitions=i.definitions.concat(r(n(97997).definitions)),i.definitions=i.definitions.concat(r(n(22164).definitions)),i.definitions=i.definitions.concat(r(n(81047).definitions)),i.definitions=i.definitions.concat(r(n(88655).definitions)),i.definitions=i.definitions.concat(r(n(15100).definitions));var a={};function l(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}i.definitions.forEach((function(e){if(e.name){var t=new Set;o(e,t),a[e.name.value]=t}})),e.exports=i,e.exports.GetModelPrefetch=function(e,t){var n={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=a[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(a[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=l(e,t);i&&n.definitions.push(i)})),n}(i,"GetModelPrefetch")},88655:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetRooms"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"rooms"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"RoomDetails"},directives:[]}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"RoomDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ModelRoom"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"dimensions"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"height"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"width"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"depth"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"areaFloor"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"tags"},arguments:[],directives:[]}]}}],loc:{start:0,end:266}};t.loc.source={body:"\nquery GetRooms ($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    rooms {\n      ...RoomDetails\n    }\n  }\n}\n\nfragment RoomDetails on ModelRoom {\n  id\n  meshId\n  floor {\n    id\n    meshId\n  }\n  dimensions {\n    height\n    width\n    depth\n    areaFloor\n  }\n  tags\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetRooms=r(t,"GetRooms"),e.exports.RoomDetails=r(t,"RoomDetails")},15100:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetSweeps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AnchorLocationDetails"},directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetShowcaseSweeps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"locations"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tags"},value:{kind:"StringValue",value:"showcase",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AnchorLocationDetails"},directives:[]}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"SkyboxDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SkyboxPanorama"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"urlTemplate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tileResolution"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tileCount"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tileUrlTemplate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validUntil"},arguments:[],directives:[]}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"SkyboxUrlDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PanoramicImageLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolutions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"skyboxes"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"SkyboxDetails"},directives:[]}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"AnchorLocationDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AnchorLocation"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"index"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"floor"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"room"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"meshId"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"neighbors"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tags"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"pano"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sweepUuid"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"placement"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"source"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"rotation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"x"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"y"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"z"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"w"},arguments:[],directives:[]}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"SkyboxUrlDetails"},directives:[]}]}}]}}],loc:{start:0,end:954}};t.loc.source={body:'\nquery GetSweeps($modelId: ID!) {\n  model(id: $modelId) {\n    id,\n    locations {\n      ...AnchorLocationDetails\n    }\n  }\n}\n\nquery GetShowcaseSweeps($modelId: ID!) {\n  model(id: $modelId) {\n    id,\n    locations(tags: "showcase") {\n      ...AnchorLocationDetails\n    }\n  }\n}\n\nfragment SkyboxDetails on SkyboxPanorama {\n  # TODO(PL-5928) all SkyboxDetail results have the same non-unique id,\n  # using it as a map key will yield unexpected results\n  # id\n  resolution\n  status\n  urlTemplate\n  tileResolution\n  tileCount\n  tileUrlTemplate\n  validUntil\n}\n\nfragment SkyboxUrlDetails on PanoramicImageLocation {\n  id\n  resolutions\n  skyboxes { ...SkyboxDetails }\n}\n\nfragment AnchorLocationDetails on AnchorLocation {\n  id\n  index\n  floor { id, meshId }\n  room { id, meshId }\n  neighbors\n  tags\n  position { x y z }\n  pano {\n    id\n    sweepUuid\n    label\n    placement\n    source\n    position { x y z }\n    rotation { x y z w }\n    ...SkyboxUrlDetails\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetSweeps=r(t,"GetSweeps"),e.exports.GetShowcaseSweeps=r(t,"GetShowcaseSweeps"),e.exports.SkyboxDetails=r(t,"SkyboxDetails"),e.exports.SkyboxUrlDetails=r(t,"SkyboxUrlDetails"),e.exports.AnchorLocationDetails=r(t,"AnchorLocationDetails")},11820:e=>{var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetCurrentUserModelAccess"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"users"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"ListValue",values:[{kind:"Variable",name:{kind:"Name",value:"userId"}}]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"results"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"modelAccess"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PolicyFlag"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PolicyOptions"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"options"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"search"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"emails"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"users"},arguments:[{kind:"Argument",name:{kind:"Name",value:"search"},value:{kind:"Variable",name:{kind:"Name",value:"search"}}},{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"Argument",name:{kind:"Name",value:"emails"},value:{kind:"Variable",name:{kind:"Name",value:"emails"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"results"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"firstName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"lastName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modelAccess"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetModelPolicies"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"policies"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PolicyFlag"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:861}};t.loc.source={body:"# get access for the current user\nquery GetCurrentUserModelAccess($modelId: ID!, $userId: ID!) {\n  model(id: $modelId) {\n    users(ids: [$userId]) {\n      results {\n        modelAccess\n      }\n    }\n    policies {\n      name\n      ...on PolicyFlag {\n        enabled\n      }\n      ... on PolicyOptions {\n        options\n      }\n    }\n  }\n}\n\n# get users with access to the specified model\nquery GetUsers($modelId: ID!, $search: String, $ids: [ID!], $emails: [String!]) {\n  model(id: $modelId) {\n    users(search: $search, ids: $ids, emails: $emails) {\n      results {\n        id\n        email\n        firstName\n        lastName\n        modelAccess\n      }\n    }\n  }\n}\n\n# get model policies available to all users\nquery GetModelPolicies($modelId: ID!) {\n  model(id: $modelId) {\n    policies {\n      name\n      ...on PolicyFlag {\n        enabled\n      }\n    }\n  }\n}",name:"GraphQL request",locationOffset:{line:1,column:1}};function n(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var i=e.type;"NamedType"===i.kind&&t.add(i.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){n(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){n(e,t)})),e.definitions&&e.definitions.forEach((function(e){n(e,t)}))}var i={};function s(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function r(e,t){var n={kind:e.kind,definitions:[s(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var r=i[t]||new Set,o=new Set,a=new Set;for(r.forEach((function(e){a.add(e)}));a.size>0;){var l=a;a=new Set,l.forEach((function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach((function(e){a.add(e)})))}))}return o.forEach((function(t){var i=s(e,t);i&&n.definitions.push(i)})),n}t.definitions.forEach((function(e){if(e.name){var t=new Set;n(e,t),i[e.name.value]=t}})),e.exports=t,e.exports.GetCurrentUserModelAccess=r(t,"GetCurrentUserModelAccess"),e.exports.GetUsers=r(t,"GetUsers"),e.exports.GetModelPolicies=r(t,"GetModelPolicies")},53306:(e,t,n)=>{var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetMergeDiff"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"viewId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"mergeDiff"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"src"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"dest"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"typesModified"},arguments:[],directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetViews"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"views"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddUserView"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addView"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteUserView"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteView"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}},{kind:"Argument",name:{kind:"Name",value:"viewId"},value:{kind:"Variable",name:{kind:"Name",value:"viewId"}}}],directives:[]}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"PublishView"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mergeMutator"},arguments:[{kind:"Argument",name:{kind:"Name",value:"src"},value:{kind:"Variable",name:{kind:"Name",value:"viewId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"merge"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"RevertView"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mergeTypes"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MergeableType"}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mergeMutator"},arguments:[{kind:"Argument",name:{kind:"Name",value:"src"},value:{kind:"Variable",name:{kind:"Name",value:"viewId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"revert"},arguments:[{kind:"Argument",name:{kind:"Name",value:"types"},value:{kind:"Variable",name:{kind:"Name",value:"mergeTypes"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}},{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetSessionDiff"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modelId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"model"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"modelId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"base"},name:{kind:"Name",value:"view"},arguments:[{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"StringValue",value:"matterport.model.default",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"model"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"labels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"LabelDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"mattertags"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MattertagDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"measurementPaths"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MeasurementDetails"},directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"orderedLists"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"ListValue",values:[]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"OrderedListDetails"},directives:[]}]}}]}}]}},{kind:"Field",alias:{kind:"Name",value:"view"},name:{kind:"Name",value:"view"},arguments:[{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"StringValue",value:"matterport.workshop.session",block:!1}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"model"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"labels"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"mattertags"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"measurementPaths"},arguments:[{kind:"Argument",name:{kind:"Name",value:"includeDisabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"modified"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"orderedLists"},arguments:[{kind:"Argument",name:{kind:"Name",value:"ids"},value:{kind:"ListValue",values:[]}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"OrderedListDetails"},directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:2041}};i.loc.source={body:'#import "./labels.gql"\n#import "./lists.gql"\n#import "./mattertags.gql"\n#import "./measurements.gql"\n\n# Gets the data types that have changed between a view and the base model\nquery GetMergeDiff($viewId: ID!) {\n  model(id: $viewId) {\n    id\n    mergeDiff {\n      src\n      dest\n      typesModified\n    }\n  }\n}\n\n# Get available views for a model\nquery GetViews($modelId: ID!) {\n  model(id: $modelId) {\n    id\n    views {\n      id\n      type\n      name\n    }\n  }\n}\n\n# Adds a new User View using the base Model ID.\n# By default, it masks view-based data layer items\nmutation AddUserView($modelId: ID!, $name: String!) {\n  addView(id: $modelId, name: $name) {\n    id\n    type\n    name\n  }\n}\n\n# Deletes a User View using the base Model ID and the viewId to delete\nmutation DeleteUserView($modelId: ID!, $viewId: ID!) {\n  deleteView(id: $modelId, viewId: $viewId)\n}\n\n# Merges the given view into the base model view\nmutation PublishView($viewId: ID!) {\n  mergeMutator(src: $viewId) {\n    merge {\n      id\n    }\n  }\n}\n\n# Resets the provided view to be the same as the base model view\nmutation RevertView($viewId: ID!, $mergeTypes: [MergeableType!]) {\n  mergeMutator(src: $viewId) {\n    revert(types: $mergeTypes ) {\n      id\n    }\n  }\n}\n\n# Gets the data that has changed between the Workshop session and base model\nquery GetSessionDiff($modelId: ID!) {\n  model(id: $modelId) {\n    base: view(type: "matterport.model.default") {\n      id\n      model {\n        labels(includeDisabled: true) { ...LabelDetails }\n        mattertags(includeDisabled: true) { ...MattertagDetails }\n        measurementPaths(includeDisabled: true) { ...MeasurementDetails }\n        orderedLists(ids: []) { ...OrderedListDetails }\n      }\n    }\n    view: view(type: "matterport.workshop.session") {\n      id\n      model {\n        labels(includeDisabled: true) { id modified }\n        mattertags(includeDisabled: true) { id modified }\n        measurementPaths(includeDisabled: true) { id modified }\n        orderedLists(ids: []) { ...OrderedListDetails }\n      }\n    }\n  }\n}\n',name:"GraphQL request",locationOffset:{line:1,column:1}};var s={};function r(e){return e.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var t=e.name.value;return!s[t]&&(s[t]=!0,!0)}))}function o(e,t){if("FragmentSpread"===e.kind)t.add(e.name.value);else if("VariableDefinition"===e.kind){var n=e.type;"NamedType"===n.kind&&t.add(n.name.value)}e.selectionSet&&e.selectionSet.selections.forEach((function(e){o(e,t)})),e.variableDefinitions&&e.variableDefinitions.forEach((function(e){o(e,t)})),e.definitions&&e.definitions.forEach((function(e){o(e,t)}))}i.definitions=i.definitions.concat(r(n(95162).definitions)),i.definitions=i.definitions.concat(r(n(60344).definitions)),i.definitions=i.definitions.concat(r(n(6850).definitions)),i.definitions=i.definitions.concat(r(n(37946).definitions));var a={};function l(e,t){for(var n=0;n<e.definitions.length;n++){var i=e.definitions[n];if(i.name&&i.name.value==t)return i}}function c(e,t){var n={kind:e.kind,definitions:[l(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var i=a[t]||new Set,s=new Set,r=new Set;for(i.forEach((function(e){r.add(e)}));r.size>0;){var o=r;r=new Set,o.forEach((function(e){s.has(e)||(s.add(e),(a[e]||new Set).forEach((function(e){r.add(e)})))}))}return s.forEach((function(t){var i=l(e,t);i&&n.definitions.push(i)})),n}i.definitions.forEach((function(e){if(e.name){var t=new Set;o(e,t),a[e.name.value]=t}})),e.exports=i,e.exports.GetMergeDiff=c(i,"GetMergeDiff"),e.exports.GetViews=c(i,"GetViews"),e.exports.AddUserView=c(i,"AddUserView"),e.exports.DeleteUserView=c(i,"DeleteUserView"),e.exports.PublishView=c(i,"PublishView"),e.exports.RevertView=c(i,"RevertView"),e.exports.GetSessionDiff=c(i,"GetSessionDiff")}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={id:e,loaded:!1,exports:{}};return s[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=s,o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var s=Object.create(null);o.r(s);var r={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,o.d(s,r),s},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>"js/"+e+".js",o.miniCssF=e=>"css/"+({66:"control-kit",136:"late",143:"font",316:"menus",321:"core",376:"vr",458:"showcase",521:"late-stream",525:"sdk-bundle",718:"encoders",833:"split",932:"lib-lottie"}[e]||e)+".css",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},i="mp_webgl:",o.l=(e,t,s,r)=>{if(n[e])n[e].push(t);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==i+s){a=u;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",i+s),a.src=e),n[e]=[t];var h=(t,i)=>{a.onerror=a.onload=null,clearTimeout(p);var s=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((e=>e(i))),t)return t(i)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=458,o.p="",(()=>{var e={458:0};o.f.j=(t,n)=>{var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise(((n,s)=>i=e[t]=[n,s]));n.push(i[2]=s);var r=o.p+o.u(t),a=new Error;o.l(r,(n=>{if(o.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+r+")",a.name="ChunkLoadError",a.type=s,a.request=r,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,s,[r,a,l]=n,c=0;for(i in a)o.o(a,i)&&(o.m[i]=a[i]);if(l)l(o);for(t&&t(n);c<r.length;c++)s=r[c],o.o(e,s)&&e[s]&&e[s][0](),e[r[c]]=0},n=self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";var e=o(15697);class EngineContext{constructor(e,t){this.fetchedModules=[],this.engine=e,this.moduleLookup=t,this.messageBus=e.msgBus,this.market=new MarketContext(e.market),this.commandBinder=e.commandBinder,this.getModuleSync=e.getModuleSync.bind(e),this.getModuleBySymbolSync=e.getModuleBySymbolSync.bind(e),this.addComponent=e.addComponent.bind(e),this.getComponentByType=e.getComponentByType.bind(e),this.getComponents=e.getComponents.bind(e),this.removeComponent=e.removeComponent.bind(e),this.subscribe=e.subscribe.bind(e),this.unsubscribe=e.unsubscribe.bind(e),this.broadcast=e.broadcast.bind(e),this.claimRenderLayer=e.claimRenderLayer.bind(e),this.getRenderLayer=e.getRenderLayer.bind(e),this.disposeRenderLayer=e.disposeRenderLayer.bind(e),this.startGenerator=e.startGenerator.bind(e),this.stopGenerator=e.stopGenerator.bind(e),this.after=e.after.bind(e),this.toggleRendering=e.toggleRendering.bind(e),this.getXrFrame=e.getXrFrame.bind(e)}getModule(e){const t=Date.now();return this.engine.getModule(e).then((e=>{const n=Date.now();return this.fetchedModules.push({moduleName:e.name,isModule:!0,startAwait:t,finishAwait:n}),e}))}getModuleBySymbol(e){const t=Date.now();return this.engine.getModuleBySymbol(e).then((e=>{const n=Date.now();return this.fetchedModules.push({moduleName:this.getModuleName(e),isModule:!0,startAwait:t,finishAwait:n}),e}))}getLoadedDependencies(){return[...this.fetchedModules,...this.market.getLoadedDependencies()]}get msgBus(){return this.messageBus}getModuleName(e){for(const t in this.moduleLookup)if(e===this.moduleLookup[t].module)return t;return"[Unknown module]"}}class MarketContext{constructor(e){this.fetchedData=[],this.market=e,this.register=e.register.bind(e),this.unregister=e.unregister.bind(e),this.tryGetData=e.tryGetData.bind(e),this.getModuleNameFromData=e.getModuleNameFromData.bind(e)}waitForData(t){const n=Date.now();return this.market.waitForData(t).then((t=>{const i=Date.now();return this.fetchedData.push({moduleName:this.getModuleNameFromData((0,e.oL)(t)),isModule:!1,startAwait:n,finishAwait:i}),t}))}getLoadedDependencies(){return this.fetchedData}}var t=o(31013),n=o(5477);const i=new n.Z("module-loader");var s;!function(e){e[e.Registered=0]="Registered",e[e.Loading=1]="Loading",e[e.Initialized=2]="Initialized",e[e.Unloaded=3]="Unloaded"}(s||(s={}));class ModuleLoader{constructor(){this.registeredModules={},this.typeLookup=new e.cj}registerModule(e,n){const i=this.typeLookup.addType(e),r={es6ModulePromise:n,ctorPromise:new t.Q,initPromise:new t.Q,state:s.Registered};this.registeredModules[i]=r}getTypeID(e){const t=this.typeLookup.getKeyByType(e);if(!t)throw Error("Trying to access unregistered Module");return t}getTypeFromTypeID(e){return this.typeLookup.getTypeByKey(e)}moduleRegistered(e){return!!this.typeLookup.getKeyByType(e)}moduleLoaded(e){if(!this.moduleRegistered(e))return!1;const t=this.typeLookup.getKeyByType(e),n=this.registeredModules[t].state;return![s.Registered,s.Unloaded].includes(n)}getModule(t){const n=this.typeLookup.getKeyByType(t);if(!n)throw Error(`Trying to get ${(0,e.HS)(t)} before it was registered!`);if(this.registeredModules[n].state===s.Unloaded)throw Error(`${(0,e.HS)(t)} module unloaded`);return this.registeredModules[n].initPromise.nativePromise()}getModuleSync(t){const n=this.typeLookup.getKeyByType(t);if(!n)throw new Error(`Trying to get ${(0,e.HS)(t)} before it was registered!`);const i=this.registeredModules[n];if(i.state!==s.Initialized||void 0===i.module)throw Error(`${(0,e.HS)(t)} module not loaded!`);return i.module}loadModule(t,n,r={}){const o=this.typeLookup.getKeyByType(n);if(!o)throw Error(`Attempting to load an unregistered module ${(0,e.HS)(n)}`);const a=this.registeredModules[o];if(a.state===s.Initialized)return a;if(a.state!==s.Registered&&a.state!==s.Unloaded)throw Error(`${(0,e.HS)(n)} already loading`);a.state=s.Loading;const l=(0,e.HS)(n);return a.es6ModulePromise(l).then((o=>{if(!o.default)throw new Error(`${(0,e.HS)(n)} has no default export during module loading`);const l=new o.default;a.ctorPromise.resolve(l).then((()=>{const e=Date.now();let n=!1;setTimeout((()=>{n||i.debug(`${l.name} init took over 2 seconds`)}),2e3),l.init(r,t).then((()=>{i.debug(`${l.name} init took ${(Date.now()-e)/1e3} secs.`),n=!0,a.state=s.Initialized,a.module=l,a.initPromise.resolve(l)})).catch((e=>{a.initPromise.reject(e)}))}))})).catch((t=>{i.error(`Failed to load es6Module for ${(0,e.HS)(n)}: ${t}`),a.initPromise.reject(t)})),a}whenQueueEmpties(){const e=[];for(const t in this.registeredModules){const n=this.registeredModules[t];n.state===s.Loading&&e.push(n.initPromise)}return t.Q.all(e).nativePromise()}unloadModule(e){const n=this.typeLookup.getKeyByType(e);if(!n)throw Error("Attempting to unload unregistered module");const i=this.registeredModules[n];if(i.state===s.Unloaded||i.state===s.Registered)throw Error("Attempting to unload not-loaded module");i.state=s.Unloaded,i.ctorPromise=new t.Q,i.initPromise=new t.Q,i.module=void 0}}const r="Data not present.",a=new n.Z("market");class Market{constructor(){this.typeLookup=new e.cj,this.store={},this.moduleRegistry={},this.firstUpdatePromises={}}register(e,t,n){const i=this.typeLookup.getKeyByType(t,!0);if(this.moduleRegistry[i])throw Error("Data can only be registered to one Module");this.moduleRegistry[i]=e,this.store[i]=n,n.commit(),i in this.firstUpdatePromises&&(this.firstUpdatePromises[i].resolve(this.store[i]),delete this.firstUpdatePromises[i])}unregister(e,t){const n=this.typeLookup.getKeyByType(t,!0);if(!this.moduleRegistry[n])throw Error("No Data was registered to the Module");delete this.moduleRegistry[n],delete this.store[n]}getData(e){const t=this.typeLookup.getKeyByType(e);if(t in this.store)return this.store[t];throw Error(r)}waitForData(e){const i=this.typeLookup.getKeyByType(e,!0);return i in this.store?Promise.resolve(this.store[i]):(this.firstUpdatePromises[i]||(this.firstUpdatePromises[i]=new t.Q,setTimeout((()=>{n.Z.level>=3&&!(i in this.store)&&a.debug(`still waiting for ${e.name}-data after 5 seconds`)}),5e3)),this.firstUpdatePromises[i].nativePromise())}tryGetData(e){try{return this.getData(e)}catch(e){if(e.message!==r)throw a.error("tryGetData",e.message),e}return null}debugData(){const e={};for(const t in this.moduleRegistry){const n=this.moduleRegistry[t];n&&(e[n.name]||(e[n.name]=[]),e[n.name].push(this.store[t]))}return Object.freeze(e)}getModuleNameFromData(e){const t=this.typeLookup.getKeyByType(e);if(t){const e=this.moduleRegistry[t];if(e)return e.name}throw Error(r)}}var l=o(79013),c=o(64177),d=o(70446),u=o(37008),h=o(33299),p=o(9986);class Profiler{constructor(){this.phaseTimes=[],this.modules={},this.addAppPhase(p.nh.UNINITIALIZED),window.profilingData={phaseTimes:this.phaseTimes,modules:this.modules}}addAppPhase(e){this.phaseTimes[e]=Date.now()}addModuleLoadTime(e,t,n,i){const s=i.map((e=>e.moduleName)).join(","),r=i.reduce(((e,t)=>e+t.finishAwait-t.startAwait),0)/(n-t)*100;this.modules[e]=[e,e,null,t,n,null,r,s]}}var m=o(41907),f=o(14877);const g=new n.Z("engine");let v=d.A.End;class Engine{constructor(){this.moduleLookup={},this.componentLookup={},this.deactivatedHack=!1,this.currentApplication=null,this.moduleProfiler=new Profiler,this.commandBinder=new c.B,this.market=new Market,this.messageBus=new l.Y,this.engineGenerators=new u.ZP,this.layers=new h.o,this.moduleLoader=new ModuleLoader,this.symbolLoader=new f.m,this.afterPhasePromises=[],this.afterPhaseListenerCount=[],this.resetPromises(),this.subscribe(m.LZ,(e=>this.moduleProfiler.addAppPhase(e.phase)))}async loadApplication(e,t,n){if(e===this.currentApplication)throw Error("Application already loaded");const i=(this.currentApplication?this.currentApplication.getManifest():[]).map((e=>e.type)),s=e.getManifest(),r=s.map((e=>e.type)),o=this.currentApplication;this.currentApplication=null;const a=i.filter((e=>-1===r.indexOf(e))),l=a.filter((e=>"symbol"!=typeof e)),c=a.filter((e=>"symbol"==typeof e)),d=[...l.map((e=>this.unloadModule(e))),...c.map((e=>this.unloadModuleBySymbol(e)))];o&&d.push(o.unload(this));const u=s.filter((e=>-1===i.indexOf(e.type)));for(const e of u)"symbol"==typeof e.type?this.symbolLoader.moduleRegistered(e.type)||this.registerModule(e):this.moduleLoader.moduleRegistered(e.type)||this.registerModule(e);if(d.length)try{await Promise.all(d)}catch(e){g.error(e),t&&t(e)}try{this.currentApplication=e,await e.load(this,{coldStart:null===o,autoPlay:n})}catch(e){g.error(e),t&&t(e)}}registerModule(e){if(this.currentApplication)throw Error("Cannot register modules while application is running");"symbol"==typeof e.type?this.symbolLoader.registerModule(e.type,e.promise):this.moduleLoader.registerModule(e.type,e.promise)}loadModule(e){const t=e;this.moduleLoadInjectionHook&&(t.config=this.moduleLoadInjectionHook(t.type,t.config||{}));const n=new EngineContext(this,this.moduleLookup),i=Date.now(),s=this.moduleLoader.loadModule(n,t.type,t.config);return s.ctorPromise.then((e=>this.moduleLookup[this.moduleLoader.getTypeID(t.type)]={module:e,initialized:!1})),s.initPromise.then((e=>{this.moduleProfiler.addModuleLoadTime(e.name,i,Date.now(),n.getLoadedDependencies()),this.moduleLookup[this.moduleLoader.getTypeID(t.type)].initialized=!0})),s.initPromise.nativePromise()}loadModuleBySymbol(e){const t=e,n=String(t.type);this.moduleLoadInjectionHook&&(t.config=this.moduleLoadInjectionHook(n,t.config||{}));const i=new EngineContext(this,this.moduleLookup),s=Date.now(),r=this.symbolLoader.loadModule(i,t.type,t.config);return r.ctorPromise.then((e=>this.moduleLookup[n]={symbol:t.type,module:e,initialized:!1,initPromise:r.initPromise.nativePromise()})),r.initPromise.then((e=>{this.moduleProfiler.addModuleLoadTime(e.name,s,Date.now(),i.getLoadedDependencies()),this.moduleLookup[n].initialized=!0})),r.initPromise.nativePromise()}setLoadInjection(e){if(void 0!==this.moduleLoadInjectionHook)throw Error("Hook already registered");this.moduleLoadInjectionHook=e}async unloadModule(t){if(!this.moduleLoader.moduleLoaded(t))return void g.debug(`${(0,e.HS)(t)} module already unloaded`);g.debug(`Unloading ${(0,e.HS)(t)} module`);const n=await this.getModule(t),i=this.getModuleIndex(n);this.componentLookup[i]&&(await Promise.all(this.componentLookup[i].map((async e=>{await this.removeComponent(n,e.component),e.component.dispose()}))),this.componentLookup[i]=[]),this.moduleLoader.unloadModule(t),n.dispose(this)}async unloadModuleBySymbol(e){if(!this.symbolLoader.moduleLoaded(e))return void g.debug(`${String(e)} module already unloaded`);g.debug(`Unloading ${String(e)} module`);const{module:t,initPromise:n}=this.moduleLookup[String(e)];await n;const i=this.getModuleIndex(t);this.componentLookup[i]&&(await Promise.all(this.componentLookup[i].map((async e=>{await this.removeComponent(t,e.component),e.component.dispose()}))),this.componentLookup[i]=[]),this.symbolLoader.unloadModule(e),t.dispose(this)}async waitForLoadingModules(){await Promise.all([this.moduleLoader.whenQueueEmpties(),this.symbolLoader.whenQueueEmpties()])}async getModule(e){return this.moduleLoader.getModule(e)}getModuleBySymbol(e){return this.symbolLoader.getModule(e)}getModuleSync(e){return this.moduleLoader.getModuleSync(e)}tryGetModuleSync(e){try{return this.getModuleSync(e)}catch(e){return null}}getModuleBySymbolSync(e){return this.symbolLoader.getModuleSync(e)}tryGetModuleBySymbolSync(e){try{return this.getModuleBySymbolSync(e)}catch(e){return null}}getComponentByType(e){for(const t in this.moduleLookup){const n=this.moduleLookup[t].module,i=this.getModuleIndex(n),s=this.componentLookup[i]||[];for(const t of s)if(t.component instanceof e)return t.component}return null}async addComponent(e,t){const n=this.getModuleIndex(e);let i=this.componentLookup[n];i||(this.componentLookup[n]=i=[]);let s=-1;for(let e=0;e<i.length;e++)if(i[e].component===t){s=e;break}if(-1===s&&(s=i.push({component:t,active:!1})-1,t.init()),i[s].active)throw Error("Tried to add already active component: "+typeof t);await t.activate(this),i[s].active=!0}async removeComponent(e,t){const n=this.getModuleIndex(e),i=this.componentLookup[n];if(i){let e=null;for(const n of i)if(n.component===t){e=n;break}e&&e.active&&(await t.deactivate(this),e.active=!1)}}tick(){if(this.deactivatedHack)return;if(v!==d.A.End)throw Error("Engine.tick called outside of waiting. Did the engine get called recursively?!");v=d.A.Begin,this.resolveAfterPhase(d.A.Begin);const e=performance.now(),t=this.lastTick?e-this.lastTick:16;this.lastTick=e,v=d.A.Logic;try{for(const e in this.moduleLookup){const n=this.moduleLookup[e];n&&n.initialized&&n.module.onUpdate(t)}}catch(e){throw g.error(e),e}this.resolveAfterPhase(d.A.Logic),this.engineGenerators.processGenerators(u.p3.Phase,d.A.Logic);try{this.renderComponents(t)}catch(e){throw g.error(e),e}try{v=d.A.Render,this.resolveAfterPhase(d.A.Render),this.engineGenerators.processGenerators(u.p3.Phase,d.A.Render),v=d.A.End,this.resolveAfterPhase(d.A.End),this.engineGenerators.processGenerators(u.p3.None),this.engineGenerators.processGenerators(u.p3.Promise),this.engineGenerators.processGenerators(u.p3.Duration)}catch(e){throw g.error(e),e}}subscribe(e,t,n=l.Q.PERMANENT){return this.messageBus.subscribe(e,t,n)}unsubscribe(e,t){this.messageBus.unsubscribe(e,t)}broadcast(e){this.messageBus.broadcast(e)}claimRenderLayer(e){return this.layers.claimLayer(e)}getRenderLayer(e){return this.layers.getLayer(e)}disposeRenderLayer(e){this.layers.disposeLayer(e)}startGenerator(e){this.engineGenerators.startGenerator(e)}stopGenerator(e){this.engineGenerators.stopGenerator(e)}after(e){return this.afterPhaseListenerCount[e]++,this.afterPhasePromises[e].nativePromise()}getModuleIndex(e){for(const t in this.moduleLookup)if(this.moduleLookup[t]&&this.moduleLookup[t].module===e)return t;return""}*getComponents(){for(const e in this.moduleLookup){const t=this.componentLookup[e];if(t)for(const e of t)yield e}}toggleRendering(e,t){const n=this.getModuleIndex(e),i=this.componentLookup[n];if(i)for(const e of i)e.active=t}renderComponents(e){for(const t in this.moduleLookup){const n=this.componentLookup[t];if(n)for(const t of n)t.active&&t.component.beforeRender&&t.component.beforeRender(e)}for(const t in this.moduleLookup){if(!t)continue;const n=this.componentLookup[t];if(n)for(const t of n)t.active&&t.component.render(e)}}resetPromises(){this.resetAfterPhasePromises()}resetAfterPhasePromises(){this.resetAfterPhasePromise(d.A.Logic),this.resetAfterPhasePromise(d.A.Render),this.resetAfterPhasePromise(d.A.Begin),this.resetAfterPhasePromise(d.A.End)}resetAfterPhasePromise(e){this.afterPhasePromises[e]=new t.Q,this.afterPhaseListenerCount[e]=0}resolveAfterPhase(e){this.afterPhaseListenerCount[e]>0&&(this.afterPhasePromises[e].resolve(),this.resetAfterPhasePromise(e))}setXrFrame(e){this.xrFrame=e}getXrFrame(){return this.xrFrame}get msgBus(){return this.messageBus}}o(55512);var y=o(87278),b=o(2252),S=o(87100),E=o(42374),T=o(97966),w=o(74678),x=o(2153),_=o(17698),M=o(72096),O=o(24849),A=o(98226),C=o(13350),N=o(17403),D=o(67233),I=o(31998),L=o(3637),P=o(72953),R=o(95998),k=o(22299),U=o(81637),B=o(94139),F=o(645),V=o(17423),H=o(81242),j=o(72699),G=o(49598),z=o(71271),W=o(98370),K=o(97358),Y=o(27086),q=o(86701),Z=o(18961),$=o(35784),Q=o(58193),X=o(82702),J=o(93314),ee=o(11542),te=o(62630),ne=o(63452),ie=o(46446),se=o(4400),re=o(24673),oe=o(36598),ae=o(28260),le=o(39142),ce=o(14909),de=o(94805),ue=o(22878),he=o(20253),pe=o(40529),me=o(46977),fe=o(72004),ge=o(63134),ve=o(89236),ye=o(20323),be=o(68860),Se=o(56709),Ee=o(63316),Te=o(3837),we=o(37363),xe=o(95245),_e=o(23676),Me=o(89673),Oe=o(38117),Ae=o(59227),Ce=o(92165),Ne=o(28452),De=o(88770),Ie=o(47725);const Le=new n.Z("AB");class AB{constructor(e){this.values={};for(const t in e){const n=e[t];if(n&&n.ab)try{this.values[t]=Pe(n.ab)}catch(e){Le.warn(`Skipping key ${t}, could not pick: ${e}`)}}}get(e){return this.values[e]}serialize(){return Object.keys(this.values).map((e=>`${e}:${this.values[e]}`))}}function Pe(e){if(0===e.length)throw Error("A/B cannot choose from an empty choice array");let t=0;for(const n of e){if(void 0===n.value||void 0===n.weight||n.weight<0)throw Error(`Malformed AB choice: ${n}`);t+=n.weight}const n=Math.random()*t;let i=0;for(const t of e)if(i+=t.weight,n<=i)return t.value}var Re=o(56483),ke=o(18253),Ue=o(65453),Be=o(34118),Fe=o(73156),Ve=o(54068),He=o(24486),je=o(14279),Ge=o(77866),ze=o(32683),We=o(59867),Ke=o(18196),Ye=o(73694),qe=o(83229),Ze=o(66524),$e=o(36407);const Qe=new n.Z("showcase-settings/quality");var Xe=o(55210),Je=o(40386),et=o(61116),tt=o(48730),nt=o(81402),it=o(90237),st=o(81052),rt=o(32227);class EngineTick{constructor(e,t,n){this.engine=e,this.onErrorCallback=n,this.ticking=!1,this.start=()=>{this.ticking=!0},this.stop=()=>{this.ticking=!1},this.tick=(e,t)=>{if(this.ticking)try{this.engine.setXrFrame(t),this.engine.tick()}catch(e){this.stop(),this.onErrorCallback(e)}},t.setAnimationLoop(this.tick)}}var ot,at=o(66225);!function(e){e.CACHE="cache",e.PRELOAD="preload",e.NONE="none"}(ot||(ot={}));var lt=o(83531);class PrefetchedData{static get hasPassword(){const{model:e}=window.MP_PREFETCHED_MODELDATA||{};return e&&e.has_public_access_password}static getQuery(e){var t;return((null===(t=window.MP_PREFETCHED_MODELDATA)||void 0===t?void 0:t.queries)||{})[e]}static get config(){var e;return null===(e=window.MP_PREFETCHED_MODELDATA)||void 0===e?void 0:e.config}}var ct=o(5673),dt=o(38636);const ut=new n.Z("PrefetchedQueryCache");class PrefetchedQueryCache{constructor(e){const{initialData:t,baseUrl:n}=e;this.client=new ct.w({baseUrl:n}),this.config=e,t&&(this.data=t)}async read(e,t,n={}){const{prefetchKey:i,prefetchPolicy:s=this.config.prefetchPolicy}=n;if(!i||s===ot.NONE)return;s!==ot.PRELOAD||this.preloadPromise||(this.preloadPromise=this.preload()),void 0===this.data&&this.preloadPromise&&await this.preloadPromise;const r=this.has(i);return ut.debug(`Cache ${r?"hit":"miss"} for ${i}`),r?this.data:void 0}clear(){this.data=void 0}async preload(){const{query:e,variables:t}=this.config;return this.client.query(e,t).then((e=>{this.data=e})).catch((e=>{ut.info(e),this.data={}}))}has(e){return void 0!==(0,dt.q)(this.data,e)}}var ht=o(7819),pt=o(91183);class ControllerProxy{constructor(e,t){this.proxy=e,this.target=t}beginExternalTransition(){this.proxy.activeSession(this)&&this.target.beginExternalTransition()}endExternalTransition(){this.proxy.activeSession(this)&&this.target.endExternalTransition()}updateCameraPosition(e){this.proxy.activeSession(this)&&this.target.updateCameraPosition(e)}updateCameraRotation(e){this.proxy.activeSession(this)&&this.target.updateCameraRotation(e)}updateCameraFocus(e){this.proxy.activeSession(this)&&this.target.updateCameraFocus(e)}moveTo(e){return this.proxy.activeSession(this)?this.target.moveTo(e):t.Q.resolve()}}class CameraPoseProxy{constructor(e,t){this.controller=e,this.data=t,this.proxies=[]}get pose(){return this.data}activeSession(e){if(0===this.proxies.length)return!1;return this.proxies[this.proxies.length-1].controller===e}newSession(e){let t=null;if(-1!==this.proxies.findIndex((t=>t.requester===e)))throw new Error("Cannot create two sessions with the same requester");return(0,pt.k1)((()=>{if(!t){if(this.proxies.length>0){const e=this.proxies[this.proxies.length-1];e.requester.onAccessRevoked(e.controller)}t=new ControllerProxy(this,this.controller),this.proxies.push({controller:t,requester:e}),e.onAccessGranted(t)}}),(()=>{if(t){const e=this.proxies.findIndex((e=>e.controller===t));if(-1!==e){const t=this.proxies[e],n=e===this.proxies.length-1;if(n&&t.requester.onAccessRevoked(t.controller),this.proxies.splice(e,1),this.proxies.length>0&&n){const e=this.proxies[this.proxies.length-1];e.requester.onAccessGranted(e.controller)}}}}))}}var mt=o(15099),ft=o(12621),gt=o(76576),vt=o(64969),yt=o(93510);var bt=o(7765),St=o(76031);async function Et(e,t){if(!e||!window.crypto||!window.crypto.subtle)return!1;const n=new URL(e),i=(0,ce.QY)(n.hostname),s=await(async e=>Array.prototype.map.call(new Uint8Array(await crypto.subtle.digest("SHA-1",(new TextEncoder).encode(e))),(e=>("0"+e.toString(16)).slice(-2))).join(""))(i);return!t.includes(s)}var Tt=o(14385);var wt=o(16534);async function xt({urlValues:e,settingsData:t,flags:n,loggedIn:i,inWorkshop:s,isPolicyFlagEnabled:r,domainDenylist:o}){const a=null!=(0,gt.gM)(),l=e[St.ke.enabled],c=n.has(St.M3)?"0"!==l:"1"===l,d=r(St.FI),u=!i,h=t.tryGetProperty(wt.sX,!1),p=e[St.ke.forceReferrer]||document.referrer,m=!!p&&await Et(p,o);Tt.L.debug("referrer eligible: ",m.toString());const f=!a&&!s,g=(0,S.eY)("lang",(0,b.ht)()).startsWith("en"),v=c&&!h&&m&&f&&g&&u;return{popupAllowed:v&&d,bannerAllowed:v}}var _t=o(69524),Mt=o(14547);var Ot=o(45301),At=o(74170),Ct=o(91988),Nt=o(39468);const Dt=new n.Z("showcase"),It=window.MP_PREFETCHED_MODELDATA;class Showcase{constructor(e,n={},i=!1){this.inWorkshop=e,this.settingOverrides=n,this.editModePreferred=i,this.bindings=[],this.externalCanvas=!1,this.urlValues=(0,S.FU)(),this.storeQueue=new N.RequestQueue,this.apiQueue=new N.RequestQueue,this.analyticsQueue=new N.RequestQueue({concurrency:1}),this.errorPromise=new t.Q,this.quickstart="1"===this.urlValues.qs||void 0!==this.urlValues.note||void 0!==this.urlValues.tag,this.autoplay=!1,this.forceLogin=!1,this.openingTool=null,this.needsFramebustToPlayXR=!0,this.uiLoading=Promise.resolve(),this.newTagPolicyPromise=new t.Q,this.sceneLoader=new Ot.LazyLoader,this.stopTourHook=async e=>{const t=e.market.tryGetData(j.k);t&&t.tourPlaying&&(await e.commandBinder.issueCommand(new et.vy),await(0,nt.gw)(10))};const{container:s}=this.settingOverrides;(0,gt.P8)(this.urlValues.applicationKey||n.applicationKey||null),this.apiHost=((e,t)=>{const n=e.apiHost||t.apiHost;if(n){const e=(0,ce.KK)(n);if(e)return e}return window.location.origin})(this.urlValues,this.settingOverrides),n.canvas&&(this.externalCanvas=!0,this.canvas=n.canvas),this.apiHost!==window.location.origin&&(this.settingOverrides.apiHost=this.apiHost),this.container=s||document.body,this.modelUrls=(0,ce.sU)(this.urlValues.m||this.urlValues.model,this.apiHost),this.initialViewId=this.modelUrls.sid}getManifest(){const e=[{type:f.y.GUI,promise:()=>Promise.resolve().then(o.bind(o,79805))},{type:f.y.LOADING_GUI,promise:()=>Promise.resolve().then(o.bind(o,32389))},{type:f.y.SHOWCASE_GUI,promise:()=>Promise.resolve().then(o.bind(o,66728))},{type:y.default,promise:()=>Promise.resolve().then(o.bind(o,87278))},{type:f.y.SETTINGS,promise:()=>Promise.resolve().then(o.bind(o,81242))},{type:f.y.ANALYTICS,promise:()=>Promise.resolve().then(o.bind(o,29782))},{type:f.y.SDK,promise:()=>Promise.resolve().then(o.bind(o,29819))},{type:k.default,promise:()=>Promise.resolve().then(o.bind(o,22299))},{type:R.default,promise:()=>Promise.resolve().then(o.bind(o,95998))},{type:C.default,promise:()=>Promise.resolve().then(o.bind(o,13350))},{type:E.default,promise:()=>Promise.resolve().then(o.bind(o,42374))},{type:f.y.RAYCASTER,promise:()=>Promise.resolve().then(o.bind(o,26758))},{type:x.default,promise:()=>Promise.resolve().then(o.bind(o,2153))},{type:_.default,promise:()=>Promise.resolve().then(o.bind(o,17698))},{type:le.default,promise:()=>Promise.resolve().then(o.bind(o,39142))},{type:I.default,promise:()=>Promise.resolve().then(o.bind(o,31998))},{type:f.y.SHOWCASE_ANALYTICS,promise:()=>Promise.resolve().then(o.bind(o,1390))},{type:f.y.WEBGL_RENDERER,promise:()=>Promise.resolve().then(o.bind(o,16056))},this.externalCanvas?{type:f.y.CANVAS,promise:()=>Promise.resolve().then(o.bind(o,99145))}:{type:f.y.CANVAS,promise:()=>Promise.resolve().then(o.bind(o,3555))},{type:f.y.INPUT,promise:()=>Promise.resolve().then(o.bind(o,51573))},{type:pe.default,promise:()=>Promise.resolve().then(o.bind(o,40529))},{type:f.y.SHOWCASE_WEBGL_CONTEXT_LOSS,promise:()=>Promise.resolve().then(o.bind(o,21284))},{type:f.y.CAMERA,promise:()=>Promise.resolve().then(o.bind(o,49702))},{type:rt.default,promise:()=>Promise.resolve().then(o.bind(o,32227))},{type:f.y.LAYERS,promise:()=>Promise.resolve().then(o.bind(o,76061))},{type:ht.F,promise:()=>Promise.resolve().then(o.bind(o,99157))},{type:w.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,74678))},{type:L.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,3637))},{type:z.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,71271))},{type:W.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,98370))},{type:Ee.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,63316))},{type:K.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,97358))},{type:Se.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,56709))},{type:xe.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,95245))},{type:re.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,24673))},{type:X.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,82702))},{type:De.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,88770))},{type:Y.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,27086))},{type:q.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,86701))},{type:Z.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,18961))},{type:J.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,93314))},{type:ee.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,11542))},{type:ae.default,promise:()=>Promise.resolve().then(o.bind(o,28260))},{type:be.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,68860))},{type:B.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,94139))},{type:F.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,645))},{type:A.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,98226))},{type:Ne.default,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,28452))},{type:f.y.MODEL_MESH,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,9245))},{type:f.y.MODEL_MESH_QUALITY,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,39173))},{type:f.y.MESH_QUERY,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,60137))},{type:f.y.MESH_API_FIXUP,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,83012))},{type:f.y.MESH_TRIM_DATA,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,52327))},{type:f.y.ORTHOGRAPHIC_CONTROLS,promise:()=>Promise.all([o.e(47),o.e(670),o.e(674),o.e(321)]).then(o.bind(o,79846))},{type:f.y.SWEEP_PUCKS,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,51201))},{type:$.default,promise:()=>o.e(136).then(o.bind(o,35784))},{type:Q.default,promise:()=>o.e(136).then(o.bind(o,58193))},{type:f.y.CURSOR_CONTROLLER,promise:()=>o.e(136).then(o.bind(o,63820))},{type:te.default,promise:()=>o.e(136).then(o.bind(o,62630))},{type:f.y.PINS,promise:()=>o.e(136).then(o.bind(o,98865))},{type:ne.default,promise:()=>o.e(136).then(o.bind(o,63452))},{type:ie.default,promise:()=>o.e(136).then(o.bind(o,46446))},{type:P.default,promise:()=>o.e(136).then(o.bind(o,72953))},{type:he.default,promise:()=>o.e(136).then(o.bind(o,20253))},{type:f.y.DEEP_LINKS,promise:()=>o.e(300).then(o.bind(o,78300))},{type:me.default,promise:()=>o.e(136).then(o.bind(o,46977))},{type:M.default,promise:()=>o.e(136).then(o.bind(o,72096))},{type:Te.default,promise:()=>o.e(136).then(o.bind(o,3837))},{type:se.default,promise:()=>o.e(136).then(o.bind(o,4400))},{type:Xe.default,promise:()=>o.e(136).then(o.bind(o,55210))},{type:Ce.default,promise:()=>o.e(136).then(o.bind(o,92165))},{type:O.default,promise:()=>o.e(136).then(o.bind(o,24849))},{type:Oe.default,promise:()=>o.e(136).then(o.bind(o,38117))},{type:Me.default,promise:()=>o.e(136).then(o.bind(o,89673))},{type:f.y.TAGS,promise:()=>o.e(136).then(o.bind(o,10634))},{type:Ae.default,promise:()=>o.e(136).then(o.bind(o,59227))},{type:fe.default,promise:()=>o.e(136).then(o.bind(o,72004))},{type:ge.default,promise:()=>o.e(136).then(o.bind(o,63134))},{type:ve.default,promise:()=>o.e(136).then(o.bind(o,89236))},{type:ye.default,promise:()=>o.e(136).then(o.bind(o,20323))},{type:oe.default,promise:()=>o.e(136).then(o.bind(o,36598))},{type:f.y.OBJECT_TAG_SUGGESTIONS_DATA,promise:()=>o.e(136).then(o.bind(o,81653))},{type:f.y.DWELL_ANALYTICS,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,7441))},{type:f.y.LABEL_DATA,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,61731))},{type:f.y.LABEL_RENDERER,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,37099))},{type:f.y.MODEL_RATING,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,28307))},{type:f.y.SEARCH,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,69667))},{type:f.y.SCAN_INFO,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,58517))},{type:f.y.MEASUREMENT_MODE,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,20357))},{type:f.y.TOUR_CONTROLS,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,57981))},{type:f.y.TOUR_DATA,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,79436))},{type:f.y.VIDEO_RECORDER,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,98154))},{type:f.y.WEBXR,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,8588))},{type:f.y.TRASH,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,59807))},{type:f.y.AUTOMATION_SUPPORT,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,94639))},{type:f.y.SCENE,promise:()=>Promise.all([o.e(47),o.e(764),o.e(633),o.e(670),o.e(376),o.e(309),o.e(564),o.e(769)]).then(o.bind(o,76769))}];return"0"!==this.urlValues.tiles?e.push({type:f.y.SWEEP_PANO,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,84885))}):e.push({type:f.y.SWEEP_PANO,promise:()=>Promise.all([o.e(856),o.e(934),o.e(393),o.e(833)]).then(o.bind(o,49873))}),e}getAppPhases(e){return{[p.nh.UNINITIALIZED]:[],[p.nh.WAITING]:[(async()=>{await e.getModuleBySymbol(f.y.LOADING_GUI)})()],[p.nh.LOADING]:[(async()=>(await e.getModuleBySymbol(f.y.LOADING_GUI)).waitForPlaying)()],[p.nh.STARTING]:[(async()=>(await e.getModule(B.default)).waitForFirstRender)()],[p.nh.PLAYING]:[(async()=>(await e.getModule(B.default)).waitForFlyin)()],[p.nh.ERROR]:[this.errorPromise.nativePromise()]}}setError(e){this.errorPromise.reject(e),this.engineTick&&this.engineTick.stop()}async load(e,t){var i,s,r;if(this.engine=e,this.engine.loadModule({type:y.default,config:{tasks:this.getAppPhases(e)}}),this.engine.loadModuleBySymbol({type:f.y.SETTINGS,config:{useGUI:!0}}),this.loadAnalytics(),e.getModule(y.default).then((n=>{n.updateActiveApp(p.Mx.SHOWCASE),t.coldStart||e.broadcast(new m.pB(p.Mx.SHOWCASE))})),e.market.waitForData(p.pu).then((t=>{t.onChanged((async()=>{const n=this.urlValues.oops;if(t.phase===p.nh.ERROR||n){const i=t.error,s=await e.getModule(pe.default);throw i instanceof Ie.v||"unsupported"===n?s.showError(pe.ErrorType.UNSUPPORTED):i instanceof Ie.G||"webgl"===n?s.showError(pe.ErrorType.WEBGL):s.showError(pe.ErrorType.GENERIC),i}}))})),this.bindings.push((0,_t.PD)({messageBus:this.engine.msgBus}),function(e){const t=[];return e.urlValues.debug&&t.push(new _t.bc({symbol:Mt.Y.Navigation,callback:()=>Promise.all([o.e(856),o.e(393),o.e(316)]).then(o.bind(o,25416)).then((t=>t.default(e.engine)))}),new _t.bc({symbol:Mt.Y.Octree,callback:()=>Promise.all([o.e(856),o.e(393),o.e(316)]).then(o.bind(o,59333)).then((t=>t.default(e.engine)))}),new _t.bc({symbol:Mt.Y.PanoTiles,callback:()=>Promise.all([o.e(856),o.e(393),o.e(316)]).then(o.bind(o,48082)).then((t=>t.default(e.engine)))}),new _t.bc({symbol:Mt.Y.Raycaster,callback:()=>Promise.all([o.e(856),o.e(393),o.e(316)]).then(o.bind(o,55744)).then((t=>t.default(e.engine)))}),new _t.bc({symbol:Mt.Y.Snapping,callback:()=>Promise.all([o.e(856),o.e(393),o.e(316)]).then(o.bind(o,21413)).then((t=>t.default(e.engine)))}),new _t.bc({symbol:Mt.Y.WebGLRenderer,callback:()=>Promise.all([o.e(856),o.e(393),o.e(316)]).then(o.bind(o,83387)).then((t=>t.default(e.engine)))})),e.urlValues.tiledmesh&&t.push(new _t.bc({symbol:Mt.Y.StreamingMesh,callback:()=>o.e(521).then(o.bind(o,96286)).then((t=>t.default(e.engine)))}),new _t.bc({symbol:Mt.Y.StreamingTexture,callback:()=>o.e(521).then(o.bind(o,40212)).then((t=>t.default(e.engine)))})),t.forEach((t=>e.messageBus.broadcast(t))),(0,pt.k1)((()=>null),(()=>t.forEach((t=>e.messageBus.broadcast(new _t.z4(t.payload))))))}({engine:this.engine,messageBus:this.engine.msgBus,urlValues:this.urlValues})),!t.coldStart)return void(this.uiLoading=this.loadUI(!0));let a;Dt.info("Showcase app version: 3.1.69.3-0-g204b0700e6"),this.externalCanvas||(this.canvas=document.createElement("canvas"),this.canvas.className="webgl-canvas",a=document.querySelector("#canvas-container"));const l=document.querySelector("#app-container"),c=document.querySelector("main")||document.body,d=document.querySelector("#react-render-root")||document.body,u=parseInt(this.urlValues.log,10);this.urlValues.hasOwnProperty("log")&&!isNaN(u)&&(n.Z.level=u),this.quickstart&&Dt.info("Quickstart engaged. Hold on to your knickers. "+performance.now());const h=this.engine.loadModule({type:C.default,config:{baseUrl:this.modelUrls.urlBase,apiQueue:this.apiQueue,storeQueue:this.storeQueue,prefetchedData:It,preloadConfig:"showcase"}}),g=(await h).getApi(),v=this.urlValues.applicationKey||this.settingOverrides.applicationKey,S=this.loadSdkModule(g,this.sceneLoader,this.newTagPolicyPromise.nativePromise(),v),E=!!v&&await S;if(E)try{await g.modelIsAccessible(this.initialViewId)}catch(e){Dt.error(e),this.engine.loadModule({type:le.default,config:{isLoggedIn:!1,queue:this.apiQueue}}),this.engine.loadModule({type:pe.default});throw(await this.engine.getModule(pe.default)).showError(pe.ErrorType.GENERIC),e}this.engine.loadModuleBySymbol({type:f.y.WEBGL_RENDERER,config:{canvas:this.canvas,useWebGL2:"1"===this.urlValues.gl2,antialias:"1"===this.urlValues.aa,useEffectComposer:!(!this.settingOverrides||!this.settingOverrides.hasOwnProperty("useEffectComposer"))&&!!this.settingOverrides.useEffectComposer}}),this.engine.loadModuleBySymbol({type:f.y.CAMERA}),this.engine.loadModuleBySymbol({type:f.y.CANVAS,config:{canvas:this.canvas,container:a}}),this.engine.loadModule({type:rt.default}),this.engine.loadModule({type:oe.default});const[_,O,N,D]=await Promise.all([e.getModule(C.default),e.getModuleBySymbol(f.y.WEBGL_RENDERER),e.getModuleBySymbol(f.y.SETTINGS),e.getModuleBySymbol(f.y.CAMERA)]);this.engineTick=new EngineTick(this.engine,O.threeRenderer,(e=>{this.engine.getModule(pe.default).then((t=>{this.setError(e),t.showError(pe.ErrorType.GENERIC)}))}));const I=_.getApi();this.apiConfig=await I.getConfigs("showcase");const R=new AB(this.apiConfig),k=!this.urlValues.applicationKey&&("roomnav_ab"in this.urlValues?"1"===this.urlValues.roomnav_ab:R.get("roomnav_ab_1"));Dt.debug("Roomnav AB "+(k?"enabled":"disabled"));const U=I.user.getFlags("showcase/"),F=U.has(ft.AR);this.loadPrefetchedData(this.initialViewId,F);const X=(0,Ke.HG)(parseFloat(this.urlValues.wts)),{labels:re,mt:ce,roomnav:Me,play:Ae,search:Le,q:Pe,qK:Be,allowRating:Fe,tiledmesh:nt,newtags:it,advancedSearch:st,stories:ot}=this.urlValues,at=I.user.loggedIn;this.engine.loadModule({type:le.default,config:{isLoggedIn:at,queue:this.apiQueue}}),this.engine.loadModule({type:pe.default}),this.engine.loadModuleBySymbol({type:f.y.SHOWCASE_WEBGL_CONTEXT_LOSS,config:{notificationDelayFrames:60}}),this.openingTool=(0,de.u)(N.settingsData,"0"!==it,!0),this.forceLogin=this.openingTool===_e.w1.NOTES&&!at&&!b.yL();let lt=this.editModePreferred;lt&&this.forceLogin&&(Dt.warn("Cannot start in edit mode. Need to login to view note."),lt=!1);const ct=U.has(Ve.b),dt=(0,yt.z)(navigator.language),ut=U.has(We.B)&&"0"!==Le,ht=U.has(We.l)?"0"!==st:"1"===st,gt=U.has(bt.i)?"0"!==Fe:"1"===Fe,Et=this.inWorkshop&&at&&gt,Tt=Et&&U.has(bt.j)?"0"!==Fe:"1"===Fe,xt="1"===this.urlValues.modelRatingDebug,Ot=U.has(Re.iT)?"0"!==nt:"1"===nt,Ct=U.has(G.lj)?"0"!==ot:"1"===ot,Lt=this.urlValues.minConfidence?(0,At.uZ)(parseFloat(this.urlValues.minConfidence),.01,1):void 0,Pt=!("1"!==Ae&&!t.autoPlay&&!this.openingTool);this.needsFramebustToPlayXR=b.Ot()&&!b.PI("xr-spatial-tracking"),this.autoplay=!this.forceLogin&&(!b.yL()||Pt&&!this.needsFramebustToPlayXR);const Rt={Features:{[je.U]:!0,[He.s]:!0,[Re.iT]:Ot,[G.lj]:Ct,[Ue.Nj]:"0"!==re,[ke.re]:"0"!==ce,[ze.ws]:"0"!==this.urlValues.f,[ze.Q5]:void 0===Me&&U.has(ze.Q5)||void 0!==Me&&"0"!==Me,[Ge.EU]:X,[Ve.b]:ct,[Nt.I]:U.has(Nt.I),[bt.i]:Et,[bt.j]:Tt,[We.B]:ut,[We.l]:ht,[St.B_]:!1,[ft.AR]:F,[ze.u_]:!k,[vt.o]:!k,[ze.gu]:!k},"User Preferences":{[V.F.UnitType]:dt,[V.F.MeasurementSnapping]:!0,[V.F.MeasurementContinuousLines]:!0,[V.F.MeasurementUserNudgeSeen]:!1,[V.F.DollhouseUserNudgeSeen]:!1,[V.F.NotesModeNudgeSeen]:!1,[V.F.NotesIntroModalSeen]:!1,[V.F.LastRatingPromptTime]:null,[V.F.SubscriberPromptDismissed]:!1}};for(const e in Rt)for(const t in Rt[e]){if(void 0===Rt[e][t])continue;const n="User Preferences"===e?H.SettingPersistence.LOCAL_STORAGE:H.SettingPersistence.NONE;N.registerSetting(e,t,Rt[e][t],!0,n)}const kt={[Je.YS]:null,quickstart:this.quickstart,lang:this.urlValues.lang,perf:this.urlValues.perf,perfInterval:this.urlValues.perfInterval,[wt.r4]:(null===(i=this.apiConfig)||void 0===i?void 0:i.discover_space_url)||""};for(const e in kt)N.updateSetting(e,kt[e]);if(this.settingOverrides)for(const e in this.settingOverrides)N.updateSetting(e,this.settingOverrides[e]);const Ut=null!==(s=null==R?void 0:R.serialize())&&void 0!==s?s:[];if(this.loadInitialAppModules(Ut,O.gpuInfo,Rt),!E)try{await this.loginToModel(this.initialViewId,I)}catch(e){return void this.setError(e)}this.baseModelId=await this.loadViewsAndStorage(this.initialViewId),this.forceLogin&&this.openingTool===_e.w1.NOTES&&await this.loginToNote(this.baseModelId),N.hasProperty(ke.lc)||N.updateSetting(ke.lc,this.apiConfig.embedly_key),this.loadInitialDataModules(Rt);const Bt=((e,t)=>new CameraPoseProxy(e,t))(D,(await e.market.waitForData(mt.M_)).pose);e.commandBinder.hookCommand(tt.ju,!0,(()=>this.stopTourHook(e))),e.commandBinder.hookCommand(et.rU,!0,(()=>this.stopTourHook(e)));try{await e.waitForLoadingModules()}catch(t){this.setError(t),e.tick()}const[Ft,Vt]=await Promise.all([e.market.waitForData(T.T),e.getModule(x.default)]),{details:Ht,organizationId:jt}=Ft.model;document.title=Ht.name;const Gt=Vt.getStartingPose();!this.quickstart||Gt&&(0,ue.vl)(Gt.mode)||(Dt.warn("Disabling quickstart. No panorama start position."),this.quickstart=!1,N.updateSetting("quickstart",!1));const zt=this.engine.loadModule({type:w.default,config:{baseUrl:this.modelUrls.urlBase,api:I,modelId:this.baseModelId,organizationId:jt||void 0,queue:this.apiQueue}}),Wt=zt.then((e=>{const t=this.setUserPolicySettings(e,at,N,U);return this.newTagPolicyPromise.resolve(),t})),{maxMeshQuality:Kt,navPanoSize:Yt,zoomPanoSize:qt,textureLODThreshold:Zt}=((e,t)=>{let n,i,s,r;(0,b.tq)()?(0,b.tq)()&&(0,Ze.W)(t)?(n=qe.S7.ULTRA,i=$e.eE[$e.SL.STANDARD],s=$e.eE[$e.SL.HIGH],r=10):(n=qe.S7.MEDIUM,i=$e.eE[$e.SL.STANDARD],s=$e.eE[$e.SL.HIGH],r=6):(n=qe.S7.ULTRA,i=$e.eE[$e.SL.HIGH],s=$e.eE[$e.SL.ULTRAHIGH],r=20);try{n=e.maxmeshq?(0,qe.Pm)(parseInt(e.maxmeshq,10)):n}catch(t){Qe.warn(`Not a valid texture size: ${e.maxmeshq}`)}return i=e.maxtileq?parseInt(e.maxtileq,10):i,s=e.maxztileq?parseInt(e.maxztileq,10):s,r=e.texlodthreshold?parseInt(e.texlodthreshold,10):r,{maxMeshQuality:n,navPanoSize:i,zoomPanoSize:s,textureLODThreshold:r}})(this.urlValues,O.gpuInfo);Dt.info({maxMeshQuality:Kt,navPanoSize:Yt,zoomPanoSize:qt,textureLODThreshold:Zt,gpuInfo:O.gpuInfo}),this.sceneLoader.setLoader((async()=>{const t=await e.loadModuleBySymbol({type:f.y.SCENE,config:{cameraPoseProxy:Bt}});return t.startLoading(),t})),await this.engine.loadModuleBySymbol({type:f.y.SWEEP_PANO,config:{navPanoSize:Yt,zoomPanoSize:qt}}),await this.engine.loadModule({type:z.default}),this.quickstart&&(this.loadPanoControls(lt),this.engineTick.start()),await(await e.getModuleBySymbol(f.y.LOADING_GUI)).waitForPlaying,this.engine.loadModule({type:De.default,config:{container:this.container}});const $t=U.has("features/meshtrim")&&"0"!==this.urlValues.allowMeshTrim;$t&&this.engine.loadModuleBySymbol({type:f.y.MESH_TRIM_DATA,config:{modelId:this.baseModelId,baseUrl:this.modelUrls.urlBase,queue:this.storeQueue}});const Qt="2"===this.urlValues.texlod?Ye.l.RAYCAST:"0"===this.urlValues.texlod?Ye.l.NONE:Ye.l.RAYCAST;this.engine.loadModuleBySymbol({type:f.y.MODEL_MESH,config:{startingMode:this.quickstart?Gt.mode:null,textureLOD:Qt,textureLODThreshold:Zt,colorizeRooms:"1"===this.urlValues.colorizeRooms,colorizeChunks:"1"===this.urlValues.colorizeChunks,wireframe:"1"===this.urlValues.wireframe,meshTrimEnabled:$t}}),this.engine.loadModuleBySymbol({type:f.y.MODEL_MESH_QUALITY,config:{maxQuality:Kt,textureLOD:Qt,textureLODThreshold:Zt,meshTrimEnabled:$t}}),this.engine.loadModule({type:Ee.default}),this.engine.loadModule({type:W.default,config:{startingMode:this.quickstart?Gt.mode:null}}),this.engine.loadModule({type:q.default,config:{baseUrl:this.modelUrls.urlBase}}),this.engine.loadModule({type:L.default}),this.engine.loadModule({type:K.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue}}),this.engine.loadModule({type:Y.default,config:{startingFloorsVisibility:this.quickstart?Gt.floorVisibility:void 0,allowFloorChanges:Rt.Features[ze.ws],focusBasedNav:Rt.Features[ze.Q5]}}),this.engine.loadModule({type:Se.default}),Promise.all([zt,Wt]).then((([e,t])=>this.loadUserPolicyModules(this.initialViewId,e,at,N,U,R,t,jt||void 0))),this.engine.loadModuleBySymbol({type:f.y.GUI,config:{workshopApp:this.inWorkshop,container:l,mainDiv:c,reactContainer:d,queue:this.apiQueue}}),this.engine.loadModule({type:xe.default}),this.engine.loadModuleBySymbol({type:f.y.SHOWCASE_GUI}),this.engine.loadModule({type:Z.default}),this.engine.loadModule({type:J.default,config:{cameraPoseProxy:Bt}}),this.engine.loadModule({type:ee.default}),this.engine.loadModuleBySymbol({type:f.y.ORTHOGRAPHIC_CONTROLS}),this.engine.loadModule({type:ae.default,config:{enabled:"1"!==this.urlValues.nozoom,tiles:"0"!==this.urlValues.tiles}}),this.engine.loadModule({type:B.default}),this.engine.loadModule({type:A.default,config:{enableWheel:"1"===this.urlValues.nozoom,focusBasedNav:Rt.Features[ze.Q5]}}),this.engine.loadModule({type:Ne.default}),this.engine.loadModuleBySymbol({type:f.y.MESH_QUERY}),this.engine.loadModuleBySymbol({type:f.y.MESH_API_FIXUP}),this.engine.loadModule({type:be.default}),this.quickstart||(this.engineTick.start(),this.loadPanoControls(lt)),await this.engine.waitForLoadingModules(),"0"!==this.urlValues.portal&&(this.engine.loadModule({type:ge.default}),this.engine.loadModule({type:fe.default})),this.engine.loadModule({type:ye.default,config:{showPinsInFloorplanDollhouse:"0"!==this.urlValues.pin}}),this.engine.loadModule({type:ve.default});const{newTagsEnabled:Xt,objectTagsEnabled:Jt}=await Wt;this.engine.loadModuleBySymbol({type:f.y.SWEEP_PUCKS,config:{checkRenderModes:()=>{const t=e.market.tryGetData(j.k);if(t&&t.isTourActive())return!1;const n=e.market.tryGetData(we.O);return!!n&&n.isInside()}}}),this.engine.loadModuleBySymbol({type:f.y.LABEL_DATA,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue}}),this.engine.loadModuleBySymbol({type:f.y.LABEL_RENDERER}),this.engine.loadModuleBySymbol({type:f.y.PINS,config:{newTagsEnabled:Xt}}),this.engine.loadModule({type:Oe.default}),this.engine.loadModule({type:Ce.default,config:{debug:"1"===this.urlValues.fcdbg}}),this.engine.loadModule({type:se.default}),this.engine.loadModule({type:te.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,parserOptions:{model:this.initialViewId,supportLinks:!this.urlValues.mls||"0"===this.urlValues.mls,keepLinkLabels:!0},queue:this.storeQueue,newTagsEnabled:Xt}}),this.engine.loadModule({type:ne.default}),this.engine.loadModule({type:ie.default}),this.engine.loadModule({type:P.default}),this.engine.loadModuleBySymbol({type:f.y.TOUR_DATA,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,looping:"1"===this.urlValues.lp,queue:this.storeQueue}}),this.engine.loadModuleBySymbol({type:f.y.TOUR_CONTROLS}),this.engine.loadModule({type:he.default}),this.engine.loadModule({type:$.default}),this.engine.loadModule({type:Q.default}),this.engine.loadModuleBySymbol({type:f.y.CURSOR_CONTROLLER}),this.engine.loadModuleBySymbol({type:f.y.SCAN_INFO,config:{baseUrl:this.modelUrls.urlBase}}),this.engine.loadModuleBySymbol({type:f.y.DEEP_LINKS}),this.engine.loadModule({type:me.default}),this.engine.loadModule({type:Te.default}),this.engine.loadModule({type:Xe.default}),this.engine.loadModuleBySymbol({type:f.y.VIDEO_RECORDER}),this.engine.loadModuleBySymbol({type:f.y.MEASUREMENT_MODE,config:{baseUrl:this.modelUrls.urlBase,readonly:!0}}),this.engine.loadModule({type:M.default}),this.engine.loadModuleBySymbol({type:f.y.DWELL_ANALYTICS}),ut&&this.engine.loadModuleBySymbol({type:f.y.SEARCH,config:{urlQuery:Pe||((0,b.Q0)()?"":Pe),urlQueryKeywords:Be,keywordsEnabled:Jt&&Xt,workshop:this.inWorkshop,advancedSearchEnabled:ht}}),Jt&&this.engine.loadModuleBySymbol({type:f.y.OBJECT_TAG_SUGGESTIONS_DATA,config:{debug:!!this.urlValues.debug,baseUrl:this.modelUrls.urlBase,modelId:this.baseModelId,minConfidence:Lt}}),this.inWorkshop&&e.loadModuleBySymbol({type:f.y.TRASH,config:{modelId:this.baseModelId,queue:this.storeQueue,baseUrl:this.modelUrls.urlBase}}),this.engine.loadModuleBySymbol({type:f.y.WEBXR,config:{enableEventPositions:!1,framebufferScaling:Math.min(this.urlValues.xrframebuffer?parseFloat(this.urlValues.xrframebuffer):0,1),tracking:+(null!==(r=this.urlValues.xrtracking)&&void 0!==r?r:0),navPanoSize:Yt}}),Et&&this.engine.loadModuleBySymbol({type:f.y.MODEL_RATING,config:{modelId:this.baseModelId,baseUrl:this.modelUrls.urlBase,queue:this.storeQueue,promptEnabled:Tt,debug:xt}}),this.engine.loadModuleBySymbol({type:f.y.AUTOMATION_SUPPORT})}setUserPolicySettings(e,t,n,i){let s=!1;if(t){const t=e.isPolicyFlagEnabled(Fe.uE),r=e.getUserData().isCommenter();s=t&&r,s&&(n.updateSetting(Fe.IA,s),n.updateSetting(Fe.Mp,s),n.updateSetting(Fe.pE,s&&i.has(Fe.pE)))}const r=(0,S.eY)("newtags"),o="1"===r||"0"!==r&&e.isPolicyFlagEnabled(Be.i1),a=this.urlValues.objectTagSuggestions,l=e.isPolicyFlagEnabled(Ct.M)?"0"!==a:"1"===a;return n.updateSetting(Be.RY,o),this.engine.getModuleBySymbol(f.y.ANALYTICS).then((e=>{e.trackFeatures(`${Be.Qy}:${o}`)})),{newTagsEnabled:o,notesEnabled:s,objectTagsEnabled:l}}loadUserPolicyModules(e,t,n,i,s,r,o,a){const{notesEnabled:l,newTagsEnabled:c,objectTagsEnabled:d}=o;!async function(e,t,n,i,s,r,o,a){const l=t.subscriber_prompt_denylist||St.ED.domainDenylist,{popupAllowed:c,bannerAllowed:d}=await xt({urlValues:n,settingsData:e.settingsData,flags:i,loggedIn:s,inWorkshop:o,isPolicyFlagEnabled:r.isPolicyFlagEnabled.bind(r),domainDenylist:l});if(Tt.L.debug(`popupAllowed: ${c}, bannerAllowed: ${d}`),c||d){e.updateSetting(St.B_,!0);const i=c&&("1"===n[St.ke.forcePopup]||!!a.get("subscriber_prompt_a_popup")),s=d&&("1"===n[St.ke.forceBanner]||!!a.get("subscriber_prompt_b_banner")),r=t.subscriber_prompt_a_delay_ms||St.ED.popupDelay;Tt.L.debug(`popupEnabled: ${i}, bannerEnabled: ${s}`),e.registerSetting("Subscriber Prompt",St.My,{popupDelay:r,popupEnabled:i,bannerEnabled:s},!1,H.SettingPersistence.NONE)}}(i,this.apiConfig,this.urlValues,s,n,t,this.inWorkshop,r),(l||c)&&(this.engine.loadModule({type:O.default,config:{apiConfig:this.apiConfig,baseUrl:this.modelUrls.urlBase,viewId:e,organizationId:a,queue:this.apiQueue}}),l&&this.engine.loadModule({type:Me.default,config:{workshop:this.inWorkshop,baseUrl:this.modelUrls.urlBase,viewId:e,readonly:!1}}),c&&(this.engine.loadModuleBySymbol({type:f.y.TAGS,config:{keywordsEnabled:d,viewId:e}}),this.engine.loadModule({type:Ae.default,config:{workshop:this.inWorkshop,baseUrl:this.modelUrls.urlBase}})))}async unload(e){at.u.removeSharedCache(this.prefetchCache);try{await e.commandBinder.issueCommand(new et.vy)}catch(e){Dt.debug("showcase unload called before tour controls registered, ignoring stopTour",e)}await this.uiLoading,await this.showcaseGui.unloadUi().catch((e=>{Dt.error(e)})),e.commandBinder.resetHooks(),this.bindings.forEach((e=>e.cancel())),this.bindings.length=0}async loginToModel(e,t){Dt.info(`Loading model view: ${e}`);const n=this.forceLogin;await t.modelExists(e,{ignorePrefetch:n}).catch((async t=>{if(n&&(t instanceof it.GT||t instanceof it.V2))await this.showLoginScreen(e);else{if(!(t instanceof it.GT))throw t;await this.login()}}))}async loginToNote(e){this.forceLogin&&await this.showLoginScreen(e)}loadInitialAppModules(e,t,n){this.engine.loadModuleBySymbol({type:f.y.RAYCASTER}),this.engine.loadModuleBySymbol({type:f.y.INPUT,config:{disableWheel:"0"===this.urlValues.wh,pointerPreventDefault:!this.settingOverrides||!this.settingOverrides.hasOwnProperty("pointerPreventDefault")||!!this.settingOverrides.pointerPreventDefault}}),this.engine.getModuleBySymbol(f.y.ANALYTICS).then((n=>{n.setOptions({gpu:t}),n.trackFeatures(...e)}))}loadPrefetchedData(e,t){let n=t?ot.CACHE:ot.NONE;const i=this.urlValues.prefetch;i&&Object.values(ot).includes(i)&&(n=i),this.prefetchCache=new PrefetchedQueryCache({baseUrl:this.apiHost,prefetchPolicy:n,initialData:PrefetchedData.getQuery("GetModelPrefetch"),query:lt.GetModelPrefetch,variables:{modelId:e}}),at.u.addSharedCache(this.prefetchCache)}async loadViewsAndStorage(e){await this.engine.loadModuleBySymbol({type:f.y.LAYERS,config:{viewId:e,baseUrl:this.apiHost,inWorkshop:this.inWorkshop}});const t=(await this.engine.market.waitForData(D.R)).getBaseModelId();return this.engine.loadModule({type:ht.F,config:{modelId:t,baseUrl:this.apiHost}}),t}async loadAnalytics(){this.engine.loadModuleBySymbol({type:f.y.ANALYTICS}),this.engine.loadModuleBySymbol({type:f.y.SHOWCASE_ANALYTICS,config:{appName:this.settingOverrides&&this.settingOverrides.appName||"showcase",provider:this.urlValues.analytics,apiQueue:this.apiQueue,analyticsQueue:this.analyticsQueue}})}loadInitialDataModules(e){this.engine.loadModule({type:F.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue}}),this.engine.loadModule({type:E.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue,tiledMeshEnabled:e.Features[Re.iT]}});const t=!(b.tq()||this.needsFramebustToPlayXR),n=!!this.openingTool||void 0,i=!!this.openingTool||void 0,s=!!this.openingTool||void 0;this.engine.loadModuleBySymbol({type:f.y.LOADING_GUI,config:{noUi:this.forceLogin,inWorkshop:this.inWorkshop,viewId:this.initialViewId,baseUrl:this.modelUrls.urlBase,quickstart:this.quickstart,autoplay:this.autoplay,allowPlayInIframe:t,startNewTab:"1"===this.urlValues.nt,hideTitle:i,hideBranding:s,hidePoweredBy:n}}),this.engine.loadModule({type:_.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue}}),this.engine.loadModule({type:x.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue}}),this.engine.loadModule({type:I.default,config:{baseUrl:this.modelUrls.urlBase,readonly:!0,queue:this.storeQueue}})}loadPanoControls(e){this.uiLoading=this.loadUI(!(e||this.forceLogin)),this.engine.loadModule({type:re.default}),this.engine.loadModule({type:X.default})}async loadSdkModule(e,t,n,i){const s=this.engine;async function r(){return await e.getAppKey("showcase","sdk_version")||""}async function a(i){const r=await Promise.resolve().then(o.bind(o,45301));await n,await r.loadInterface(i,s,e,t)}return new Promise((async e=>{await s.loadModuleBySymbol({type:f.y.SDK,config:{applicationKey:i||null,validationUrl:this.apiHost+"/api/v1/user/",getClientScriptUrl:r,setupExternalSdk:a,onClientConnect(t){t&&st.w.setToken(t),e(!!t)},queue:this.apiQueue}})}))}loadUI(e){return Promise.all([this.engine.getModuleBySymbol(f.y.GUI),this.engine.getModuleBySymbol(f.y.SHOWCASE_GUI)]).then((([t,n])=>{this.guiModule=t,this.showcaseGui=n,e&&t.loadUi(n.loadUi)}))}async showLoginScreen(e){var t,n;this.engine.loadModule({type:R.default,config:{loginUrl:(null===(t=this.apiConfig)||void 0===t?void 0:t.authn_login_url)||"",registerUrl:(null===(n=this.apiConfig)||void 0===n?void 0:n.account_register_url)||"",modelId:e,baseUrl:this.modelUrls.urlBase,container:this.container}});return(await this.engine.getModule(R.default)).loadUi()}login(){return new Promise((async e=>{this.engine.loadModule({type:k.default,config:{modelId:this.initialViewId,baseUrl:this.modelUrls.urlBase,container:this.container}});const t=await this.engine.getModule(k.default);this.engine.subscribe(U.L,(()=>{t.hidePasswordScreen(),e()})),t.showPasswordScreen()}))}}var Lt=o(40470);window.addEventListener("app-start",(e=>{!function(e){const t=new Engine,n=new Showcase(!1,e);t.loadApplication(n,n.setError.bind(n)),b.Jm()||document.body.classList.add("no-touch");!function(e){class BundleSdkBootstrap{constructor(e){this.windowContext=e}async connect(t,n={applicationKey:""}){const i=await e.getModuleBySymbol(f.y.SDK);return Lt.tK.connect(new BundleConnector(i,n),new BundleMessengerFactoryFetcher,this.windowContext)}}Object.defineProperty(window,"MP_SDK",{get(){let e=window;return window!==window.top&&(e=window.parent),window.opener&&(e=window.opener),new BundleSdkBootstrap(e)}})}(t)}(e.detail.config||{})}),!0);class BundleConnector{constructor(e,t){this.sdk=e,this.options=t}connect(){return this.sdk.connect(`${window.location.protocol}//${window.location.host}`,this.options)}cancelConnecting(){}}class BundleMessengerFactoryFetcher{getFactory(e){return e.messengerFactory}}})()})();